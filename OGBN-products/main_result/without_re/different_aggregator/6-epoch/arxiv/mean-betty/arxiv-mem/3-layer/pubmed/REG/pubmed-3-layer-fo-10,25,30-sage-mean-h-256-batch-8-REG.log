main start at this time 1657074165.788164
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002763986587524414
global_2_local spend time (sec) 6.008148193359375e-05
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00030493736267089844
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 293, 1: 26, 3: 6, 2: 6, 6: 4, 4: 3, 8: 3, 5: 2, 17: 2, 7: 1, 18: 1, 22: 1, 9: 1, 30: 1, 11: 1, 10: 1, 29: 1})

A = g.adjacency_matrix() spent  0.0003032684326171875
auxiliary_graph
Graph(num_nodes=353, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0003509521484375
remove nodes length  293

auxiliary_graph.remove_nodes spent  0.0013990402221679688
after remove non output nodes the auxiliary_graph
Graph(num_nodes=60, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007071495056152344

the counter of shared neighbor distribution
Counter({1.0: 6})
6
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.00267791748046875
7
7
8
8
7
8
7
8
total k batches seeds list generation spend  0.008987188339233398
after graph partition
graph partition algorithm spend time 0.010286092758178711
7
7
8
8
7
8
7
8
partition_len_list
[26, 46, 54, 42, 41, 51, 45, 50]
REG selection method  spend 0.010460615158081055
time for parepare:  3.600120544433594e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  1.6689300537109375e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  1.430511474609375e-06
local_in_edges_tensor generation:  8.559226989746094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.001398324966430664
generate_one_block  0.0021109580993652344
generate_one_block  0.0010104179382324219
generate_one_block  0.0009646415710449219
generate_one_block  0.0010411739349365234
generate_one_block  0.0009815692901611328
generate_one_block  0.000997781753540039
generate_one_block  0.0009970664978027344
generate_one_block  0.0010120868682861328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012860298156738281
gen group dst list time:  6.532669067382812e-05
time for parepare:  0.00021195411682128906
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.000152587890625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00020074844360351562
----------------------check_connections_block total spend ----------------------------- 0.0030689239501953125
generate_one_block  0.0010654926300048828
generate_one_block  0.001062154769897461
generate_one_block  0.0012433528900146484
generate_one_block  0.0011281967163085938
generate_one_block  0.0010879039764404297
generate_one_block  0.001262664794921875
generate_one_block  0.0012183189392089844
generate_one_block  0.001222848892211914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008194446563720703
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0005152225494384766
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002942085266113281
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002799034118652344
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.000606536865234375
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.00044846534729003906
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004754066467285156
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0007715225219726562
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0009260177612304688
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0008313655853271484
----------------------check_connections_block total spend ----------------------------- 0.008738279342651367
generate_one_block  0.0016510486602783203
generate_one_block  0.0013949871063232422
generate_one_block  0.0018019676208496094
generate_one_block  0.0015230178833007812
generate_one_block  0.001552581787109375
generate_one_block  0.002061128616333008
generate_one_block  0.003026247024536133
generate_one_block  0.002065896987915039
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

connection checking time:  0.013205528259277344
block generation total time  0.03348350524902344
average batch blocks generation time:  0.0013951460520426433
block dataloader generation time/epoch 0.06864476203918457
pseudo mini batch 0 input nodes size: 702
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0027556419372558594  GigaBytes
Max Memory Allocated: 0.0027556419372558594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0027561187744140625  GigaBytes
Max Memory Allocated: 0.0027561187744140625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0027561187744140625  GigaBytes
Max Memory Allocated: 0.0027561187744140625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0027666091918945312  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0027666091918945312  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

first layer input nodes number: 702
first layer output nodes number: 159
edges number: 960
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002773284912109375  GigaBytes
Max Memory Allocated: 0.002777099609375  GigaBytes

torch.Size([702, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.002773284912109375  GigaBytes
Max Memory Allocated: 0.002777099609375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0032300949096679688  GigaBytes
Max Memory Allocated: 0.003376007080078125  GigaBytes

torch.Size([159, 256])
torch.Size([159, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033817291259765625  GigaBytes
Max Memory Allocated: 0.0035333633422851562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0032300949096679688  GigaBytes
Max Memory Allocated: 0.0035333633422851562  GigaBytes

torch.Size([159, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033817291259765625  GigaBytes
Max Memory Allocated: 0.0035333633422851562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034198760986328125  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

input nodes number: 159
output nodes number: 26
edges number: 188
----------------------------------------before model layer 1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003421783447265625  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

torch.Size([159, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003421783447265625  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034742355346679688  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

torch.Size([26, 256])
torch.Size([26, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034990310668945312  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034742355346679688  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

torch.Size([26, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0034990310668945312  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003505229949951172  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------input nodes number: 26
----------------output nodes number: 7
----------------edges number: 19
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003506183624267578  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035152435302734375  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

torch.Size([7, 3])
torch.Size([7, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035157203674316406  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035152435302734375  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

torch.Size([7, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035157203674316406  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00351715087890625  GigaBytes
Max Memory Allocated: 0.0035715103149414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004241943359375  GigaBytes
Max Memory Allocated: 0.0046901702880859375  GigaBytes

pseudo mini batch 1 input nodes size: 471
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004205226898193359  GigaBytes
Max Memory Allocated: 0.0046901702880859375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004205226898193359  GigaBytes
Max Memory Allocated: 0.0046901702880859375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005082607269287109  GigaBytes
Max Memory Allocated: 0.005082607269287109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050830841064453125  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037746429443359375  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037832260131835938  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037832260131835938  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

first layer input nodes number: 471
first layer output nodes number: 175
edges number: 735
----------------------------------------before model layer 0
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003788471221923828  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([471, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.003788471221923828  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004288196563720703  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([175, 256])
torch.Size([175, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004455089569091797  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004288196563720703  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([175, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004455089569091797  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004497051239013672  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

input nodes number: 175
output nodes number: 46
edges number: 252
----------------------------------------before model layer 1
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004498958587646484  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([175, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004498958587646484  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004589557647705078  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([46, 256])
torch.Size([46, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004633426666259766  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004589557647705078  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([46, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004633426666259766  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0046443939208984375  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------input nodes number: 46
----------------output nodes number: 7
----------------edges number: 39
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004645347595214844  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004654407501220703  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([7, 3])
torch.Size([7, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004654884338378906  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004654407501220703  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

torch.Size([7, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004654407501220703  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004655361175537109  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0038061141967773438  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

pseudo mini batch 2 input nodes size: 1161
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037746429443359375  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037746429443359375  GigaBytes
Max Memory Allocated: 0.0050830841064453125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0059375762939453125  GigaBytes
Max Memory Allocated: 0.0059375762939453125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005938053131103516  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050792694091796875  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0050792694091796875  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

first layer input nodes number: 1161
first layer output nodes number: 348
edges number: 1837
----------------------------------------before model layer 0
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005091190338134766  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

torch.Size([1161, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005091190338134766  GigaBytes
Max Memory Allocated: 0.005938053131103516  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006087303161621094  GigaBytes
Max Memory Allocated: 0.006405353546142578  GigaBytes

torch.Size([348, 256])
torch.Size([348, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006419181823730469  GigaBytes
Max Memory Allocated: 0.006751060485839844  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006087303161621094  GigaBytes
Max Memory Allocated: 0.006751060485839844  GigaBytes

torch.Size([348, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006419181823730469  GigaBytes
Max Memory Allocated: 0.006751060485839844  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0065021514892578125  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

input nodes number: 348
output nodes number: 54
edges number: 448
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006505489349365234  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

torch.Size([348, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006505489349365234  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006613254547119141  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

torch.Size([54, 256])
torch.Size([54, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006664752960205078  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006613254547119141  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

torch.Size([54, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006664752960205078  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0066776275634765625  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------input nodes number: 54
----------------output nodes number: 8
----------------edges number: 47
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006678581237792969  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006688594818115234  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0066890716552734375  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006688594818115234  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006688594818115234  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006689548492431641  GigaBytes
Max Memory Allocated: 0.0068340301513671875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005123615264892578  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

pseudo mini batch 3 input nodes size: 988
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006900787353515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006901264190673828  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00473785400390625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004752159118652344  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004752159118652344  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

first layer input nodes number: 988
first layer output nodes number: 234
edges number: 1323
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004761695861816406  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([988, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004761695861816406  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005432605743408203  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([234, 256])
torch.Size([234, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005655765533447266  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005432605743408203  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([234, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005655765533447266  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005711555480957031  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

input nodes number: 234
output nodes number: 42
edges number: 267
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005713939666748047  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([234, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005713939666748047  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005797863006591797  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([42, 256])
torch.Size([42, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005837917327880859  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005797863006591797  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([42, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005837917327880859  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005847930908203125  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------input nodes number: 42
----------------output nodes number: 8
----------------edges number: 34
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005848884582519531  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005858898162841797  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005859375  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005858898162841797  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005858898162841797  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005859851837158203  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.004786491394042969  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

pseudo mini batch 4 input nodes size: 1053
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00473785400390625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00473785400390625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006900787353515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006901264190673828  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050754547119140625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050754547119140625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

first layer input nodes number: 1053
first layer output nodes number: 267
edges number: 1455
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005085945129394531  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([1053, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005085945129394531  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005850791931152344  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([267, 256])
torch.Size([267, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0061054229736328125  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005850791931152344  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([267, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0061054229736328125  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006169319152832031  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

input nodes number: 267
output nodes number: 41
edges number: 317
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00617218017578125  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([267, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00617218017578125  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0062541961669921875  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([41, 256])
torch.Size([41, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006293296813964844  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0062541961669921875  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([41, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006293296813964844  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006303310394287109  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------input nodes number: 41
----------------output nodes number: 7
----------------edges number: 34
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006304264068603516  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006313323974609375  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([7, 3])
torch.Size([7, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006313800811767578  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006313323974609375  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

torch.Size([7, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006313323974609375  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006314277648925781  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005113124847412109  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

pseudo mini batch 5 input nodes size: 1376
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0050601959228515625  GigaBytes
Max Memory Allocated: 0.007183074951171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007623195648193359  GigaBytes
Max Memory Allocated: 0.007623195648193359  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0076236724853515625  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005460262298583984  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005486011505126953  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005486011505126953  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

first layer input nodes number: 1376
first layer output nodes number: 426
edges number: 2630
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005499839782714844  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

torch.Size([1376, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005499839782714844  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006721973419189453  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

torch.Size([426, 256])
torch.Size([426, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007128238677978516  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.006721973419189453  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

torch.Size([426, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007128238677978516  GigaBytes
Max Memory Allocated: 0.0076236724853515625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007229804992675781  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

input nodes number: 426
output nodes number: 51
edges number: 605
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007233619689941406  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

torch.Size([426, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007233619689941406  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007336616516113281  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

torch.Size([51, 256])
torch.Size([51, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00738525390625  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007336616516113281  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

torch.Size([51, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00738525390625  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007397651672363281  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------input nodes number: 51
----------------output nodes number: 8
----------------edges number: 43
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0073986053466796875  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007408618927001953  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007409095764160156  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007408618927001953  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007408618927001953  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007409572601318359  GigaBytes
Max Memory Allocated: 0.007636070251464844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005541324615478516  GigaBytes
Max Memory Allocated: 0.008062362670898438  GigaBytes

pseudo mini batch 6 input nodes size: 1517
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005460262298583984  GigaBytes
Max Memory Allocated: 0.008062362670898438  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005460262298583984  GigaBytes
Max Memory Allocated: 0.008062362670898438  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008285999298095703  GigaBytes
Max Memory Allocated: 0.008285999298095703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008286476135253906  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005722999572753906  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005753517150878906  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005753517150878906  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

first layer input nodes number: 1517
first layer output nodes number: 447
edges number: 3114
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005768299102783203  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([1517, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005768299102783203  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([447, 256])
torch.Size([447, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007479667663574219  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007053375244140625  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007479667663574219  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007586479187011719  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

input nodes number: 447
output nodes number: 45
edges number: 718
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007590293884277344  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([447, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007590293884277344  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00768280029296875  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([45, 256])
torch.Size([45, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007725715637207031  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00768280029296875  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([45, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007725715637207031  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007736682891845703  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------input nodes number: 45
----------------output nodes number: 7
----------------edges number: 38
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007737636566162109  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007746696472167969  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([7, 3])
torch.Size([7, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007747173309326172  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007746696472167969  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

torch.Size([7, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007746696472167969  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007747650146484375  GigaBytes
Max Memory Allocated: 0.008286476135253906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0058155059814453125  GigaBytes
Max Memory Allocated: 0.00846099853515625  GigaBytes

pseudo mini batch 7 input nodes size: 1523
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005722999572753906  GigaBytes
Max Memory Allocated: 0.00846099853515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005722999572753906  GigaBytes
Max Memory Allocated: 0.00846099853515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0085601806640625  GigaBytes
Max Memory Allocated: 0.0085601806640625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008560657501220703  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005734443664550781  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005761146545410156  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005761146545410156  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

first layer input nodes number: 1523
first layer output nodes number: 531
edges number: 2628
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005776882171630859  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([1523, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005776882171630859  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007295131683349609  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([531, 256])
torch.Size([531, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007801532745361328  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007295131683349609  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([531, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.007801532745361328  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00792837142944336  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

input nodes number: 531
output nodes number: 50
edges number: 669
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00793313980102539  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([531, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00793313980102539  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00803518295288086  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([50, 256])
torch.Size([50, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008082866668701172  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00803518295288086  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([50, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008082866668701172  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00809478759765625  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------input nodes number: 50
----------------output nodes number: 8
----------------edges number: 42
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008095741271972656  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008105754852294922  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008106231689453125  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008105754852294922  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008105754852294922  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008106708526611328  GigaBytes
Max Memory Allocated: 0.008560657501220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.005822181701660156  GigaBytes
Max Memory Allocated: 0.00896453857421875  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008717536926269531  GigaBytes
Max Memory Allocated: 0.010148048400878906  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008717536926269531  GigaBytes
Max Memory Allocated: 0.010148048400878906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002740621566772461 |0.04344075918197632 |0.10797092318534851 |0.00013682246208190918 |0.002395153045654297 |0.0013899803161621094 |
----------------------------------------------------------pseudo_mini_loss sum 1.1080636978149414
Total (block generation + training)time/epoch 1.3467450141906738
Training time/epoch 1.2778639793395996
Training time without block to device /epoch 0.9303379058837891
Training time without total dataloading part /epoch 0.8854131698608398
load block tensor time/epoch 0.021924972534179688
block to device time/epoch 0.34752607345581055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11733
Number of first layer input nodes during this epoch:  8791
Number of first layer output nodes during this epoch:  2587
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  388608
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([3, 256])
layers.2.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
