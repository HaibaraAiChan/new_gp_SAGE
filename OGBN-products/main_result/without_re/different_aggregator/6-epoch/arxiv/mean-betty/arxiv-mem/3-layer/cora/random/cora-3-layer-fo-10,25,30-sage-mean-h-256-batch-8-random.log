main start at this time 1657074104.0160174
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009541511535644531
number of batches is  8
batch size is  18
random selection method spend 0.0005228519439697266
time for parepare:  6.461143493652344e-05
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.001293182373046875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.0994415283203125e-05
----------------------check_connections_block total spend ----------------------------- 0.003356456756591797
generate_one_block  0.002825021743774414
generate_one_block  0.0011222362518310547
generate_one_block  0.0010640621185302734
generate_one_block  0.0010652542114257812
generate_one_block  0.0010826587677001953
generate_one_block  0.0010416507720947266
generate_one_block  0.001062154769897461
generate_one_block  0.0010385513305664062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005316734313964844
gen group dst list time:  6.413459777832031e-05
time for parepare:  0.00014209747314453125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00016880035400390625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003097057342529297
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017881393432617188
----------------------check_connections_block total spend ----------------------------- 0.004050493240356445
generate_one_block  0.001306772232055664
generate_one_block  0.0012791156768798828
generate_one_block  0.0012183189392089844
generate_one_block  0.001322031021118164
generate_one_block  0.0013883113861083984
generate_one_block  0.0011873245239257812
generate_one_block  0.001291513442993164
generate_one_block  0.0012736320495605469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005755424499511719
gen group dst list time:  9.632110595703125e-05
time for parepare:  0.0002238750457763672
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005812644958496094
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006186962127685547
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005180835723876953
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0006763935089111328
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0008299350738525391
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00040793418884277344
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0006291866302490234
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005562305450439453
----------------------check_connections_block total spend ----------------------------- 0.008704900741577148
generate_one_block  0.0017278194427490234
generate_one_block  0.0017879009246826172
generate_one_block  0.0016407966613769531
generate_one_block  0.0017731189727783203
generate_one_block  0.0018284320831298828
generate_one_block  0.0014314651489257812
generate_one_block  0.0016055107116699219
generate_one_block  0.0015363693237304688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

connection checking time:  0.012755393981933594
block generation total time  0.023598432540893555
average batch blocks generation time:  0.0029498040676116943
block dataloader generation time/epoch 0.05971884727478027
pseudo mini batch 0 input nodes size: 776
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00737762451171875  GigaBytes
Max Memory Allocated: 0.00737762451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007378101348876953  GigaBytes
Max Memory Allocated: 0.007378101348876953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007378101348876953  GigaBytes
Max Memory Allocated: 0.007378101348876953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007396221160888672  GigaBytes
Max Memory Allocated: 0.007396221160888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007396221160888672  GigaBytes
Max Memory Allocated: 0.007396221160888672  GigaBytes

first layer input nodes number: 776
first layer output nodes number: 335
edges number: 1605
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007405281066894531  GigaBytes
Max Memory Allocated: 0.007411479949951172  GigaBytes

torch.Size([776, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007405281066894531  GigaBytes
Max Memory Allocated: 0.007411479949951172  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009527206420898438  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([335, 256])
torch.Size([335, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009527206420898438  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([335, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009926795959472656  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

input nodes number: 335
output nodes number: 98
edges number: 600
----------------------------------------before model layer 1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009930610656738281  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([335, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009930610656738281  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010123252868652344  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([98, 256])
torch.Size([98, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010216712951660156  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010123252868652344  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([98, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010216712951660156  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01024007797241211  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------input nodes number: 98
----------------output nodes number: 18
----------------edges number: 91
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010241508483886719  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010261058807373047  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01026153564453125  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010261058807373047  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01026153564453125  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01026296615600586  GigaBytes
Max Memory Allocated: 0.010997772216796875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011096954345703125  GigaBytes
Max Memory Allocated: 0.01320505142211914  GigaBytes

pseudo mini batch 1 input nodes size: 926
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011036396026611328  GigaBytes
Max Memory Allocated: 0.01320505142211914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011036396026611328  GigaBytes
Max Memory Allocated: 0.01320505142211914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015979766845703125  GigaBytes
Max Memory Allocated: 0.015979766845703125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015980243682861328  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011837005615234375  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0118560791015625  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0118560791015625  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

first layer input nodes number: 926
first layer output nodes number: 380
edges number: 1760
----------------------------------------before model layer 0
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011866092681884766  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

torch.Size([926, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011866092681884766  GigaBytes
Max Memory Allocated: 0.015980243682861328  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014272212982177734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([380, 256])
torch.Size([380, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01463460922241211  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014272212982177734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([380, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01463460922241211  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014725208282470703  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

input nodes number: 380
output nodes number: 87
edges number: 561
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014729022979736328  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([380, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014729022979736328  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014900684356689453  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([87, 256])
torch.Size([87, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014983654022216797  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014900684356689453  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([87, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014983654022216797  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015004634857177734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------input nodes number: 87
----------------output nodes number: 18
----------------edges number: 74
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015006065368652344  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015025615692138672  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015026092529296875  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015025615692138672  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015025615692138672  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01190042495727539  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

pseudo mini batch 2 input nodes size: 779
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011837005615234375  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011837005615234375  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01599597930908203  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015996456146240234  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011052608489990234  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011067867279052734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011067867279052734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

first layer input nodes number: 779
first layer output nodes number: 318
edges number: 1391
----------------------------------------before model layer 0
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01107645034790039  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([779, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01107645034790039  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013089656829833984  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([318, 256])
torch.Size([318, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013392925262451172  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013089656829833984  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([318, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013392925262451172  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013468742370605469  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

input nodes number: 318
output nodes number: 69
edges number: 419
----------------------------------------before model layer 1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01347208023071289  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([318, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01347208023071289  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013608455657958984  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([69, 256])
torch.Size([69, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013674259185791016  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013608455657958984  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([69, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013674259185791016  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013690948486328125  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------input nodes number: 69
----------------output nodes number: 18
----------------edges number: 54
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013692378997802734  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013711929321289062  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013712406158447266  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013711929321289062  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013711929321289062  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013712882995605469  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011105537414550781  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

pseudo mini batch 3 input nodes size: 974
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011052608489990234  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011052608489990234  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016252517700195312  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016252994537353516  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012093544006347656  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012114524841308594  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012114524841308594  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

first layer input nodes number: 974
first layer output nodes number: 408
edges number: 1918
----------------------------------------before model layer 0
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012125492095947266  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

torch.Size([974, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012125492095947266  GigaBytes
Max Memory Allocated: 0.01667928695678711  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014708995819091797  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([408, 256])
torch.Size([408, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015098094940185547  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014708995819091797  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([408, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015098094940185547  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015195369720458984  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

input nodes number: 408
output nodes number: 112
edges number: 644
----------------------------------------before model layer 1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015199661254882812  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([408, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015199661254882812  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015419960021972656  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([112, 256])
torch.Size([112, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015526771545410156  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015419960021972656  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([112, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015526771545410156  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015553474426269531  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------input nodes number: 112
----------------output nodes number: 18
----------------edges number: 95
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01555490493774414  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015574455261230469  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015574932098388672  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015574455261230469  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015574455261230469  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015575408935546875  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012164115905761719  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

pseudo mini batch 4 input nodes size: 1085
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012093544006347656  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012093544006347656  GigaBytes
Max Memory Allocated: 0.01683330535888672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017885684967041016  GigaBytes
Max Memory Allocated: 0.017885684967041016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01788616180419922  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012685775756835938  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012711524963378906  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012711524963378906  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

first layer input nodes number: 1085
first layer output nodes number: 493
edges number: 2370
----------------------------------------before model layer 0
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012723445892333984  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

torch.Size([1085, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012723445892333984  GigaBytes
Max Memory Allocated: 0.01788616180419922  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015845775604248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([493, 256])
torch.Size([493, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016315937042236328  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015845775604248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([493, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016315937042236328  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0164337158203125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

input nodes number: 493
output nodes number: 135
edges number: 857
----------------------------------------before model layer 1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016438961029052734  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([493, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016438961029052734  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016705036163330078  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([135, 256])
torch.Size([135, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016705036163330078  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([135, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016833782196044922  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016866207122802734  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------input nodes number: 135
----------------output nodes number: 18
----------------edges number: 120
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016868114471435547  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016887664794921875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016888141632080078  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016887664794921875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016887664794921875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01688861846923828  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01277017593383789  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

pseudo mini batch 5 input nodes size: 595
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012685775756835938  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012685775756835938  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016828536987304688  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01682901382446289  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011036396026611328  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01104879379272461  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01104879379272461  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

first layer input nodes number: 595
first layer output nodes number: 227
edges number: 1112
----------------------------------------before model layer 0
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011055469512939453  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([595, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011055469512939453  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([227, 256])
torch.Size([227, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012710094451904297  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012493610382080078  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012710094451904297  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012764453887939453  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

input nodes number: 227
output nodes number: 76
edges number: 370
----------------------------------------before model layer 1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012767314910888672  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([227, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012767314910888672  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012916088104248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([76, 256])
torch.Size([76, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012988567352294922  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012916088104248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([76, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012988567352294922  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01300668716430664  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------input nodes number: 76
----------------output nodes number: 18
----------------edges number: 59
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01300811767578125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013027667999267578  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013028144836425781  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013027667999267578  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013027667999267578  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013028621673583984  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01107931137084961  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

pseudo mini batch 6 input nodes size: 813
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011036396026611328  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011036396026611328  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015376567840576172  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015377044677734375  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011233806610107422  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011252880096435547  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011252880096435547  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

first layer input nodes number: 813
first layer output nodes number: 376
edges number: 1774
----------------------------------------before model layer 0
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011261940002441406  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([813, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011261940002441406  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01364278793334961  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([376, 256])
torch.Size([376, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01400136947631836  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01364278793334961  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([376, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01400136947631836  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014091014862060547  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

input nodes number: 376
output nodes number: 98
edges number: 621
----------------------------------------before model layer 1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014094829559326172  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([376, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014094829559326172  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014287471771240234  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([98, 256])
torch.Size([98, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014380931854248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014287471771240234  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([98, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014380931854248047  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014404296875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------input nodes number: 98
----------------output nodes number: 18
----------------edges number: 84
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01440572738647461  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014425277709960938  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01442575454711914  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014425277709960938  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014425277709960938  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014426231384277344  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011296272277832031  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

pseudo mini batch 7 input nodes size: 811
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011233806610107422  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011233806610107422  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015563488006591797  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01556396484375  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011223316192626953  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011240482330322266  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011240482330322266  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

first layer input nodes number: 811
first layer output nodes number: 335
edges number: 1565
----------------------------------------before model layer 0
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011249542236328125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([811, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011249542236328125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013371467590332031  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([335, 256])
torch.Size([335, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013690948486328125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013371467590332031  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([335, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013690948486328125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01377105712890625  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

input nodes number: 335
output nodes number: 65
edges number: 474
----------------------------------------before model layer 1
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013774871826171875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([335, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013774871826171875  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013903617858886719  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([65, 256])
torch.Size([65, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013965606689453125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013903617858886719  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([65, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013965606689453125  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013981342315673828  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------input nodes number: 65
----------------output nodes number: 14
----------------edges number: 53
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013982772827148438  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01399850845336914  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([14, 7])
torch.Size([14, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013998985290527344  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01399850845336914  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

torch.Size([14, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01399850845336914  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013999462127685547  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.011281013488769531  GigaBytes
Max Memory Allocated: 0.018009662628173828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.018215656280517578  GigaBytes
Max Memory Allocated: 0.022315502166748047  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.018215656280517578  GigaBytes
Max Memory Allocated: 0.022315502166748047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036019980907440186 |0.04323399066925049 |0.10734432935714722 |0.00014075636863708496 |0.002820611000061035 |0.0015180110931396484 |
----------------------------------------------------------pseudo_mini_loss sum 1.9513863325119019
Total (block generation + training)time/epoch 1.3433117866516113
Training time/epoch 1.2832436561584473
Training time without block to device /epoch 0.9373717308044434
Training time without total dataloading part /epoch 0.8839635848999023
load block tensor time/epoch 0.02881598472595215
block to device time/epoch 0.3458719253540039
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10371
Number of first layer input nodes during this epoch:  6759
Number of first layer output nodes during this epoch:  2872
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  868352
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([7, 256])
layers.2.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
