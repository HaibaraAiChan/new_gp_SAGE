main start at this time 1657098209.0576766
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.45345520973205566
global_2_local spend time (sec) 0.05840325355529785
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0538182258605957
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({40: 128251, 0: 72233, 1: 1391, 2: 1221, 3: 1053, 4: 986, 5: 920, 6: 875, 7: 814, 8: 799, 11: 702, 9: 695, 13: 691, 10: 690, 12: 684, 14: 652, 15: 643, 16: 607, 19: 606, 17: 598, 18: 563, 21: 562, 22: 556, 23: 543, 20: 538, 28: 532, 27: 528, 25: 525, 26: 521, 24: 521, 32: 520, 29: 511, 30: 509, 31: 480, 33: 467, 37: 465, 38: 459, 34: 458, 36: 447, 35: 444, 39: 404})

A = g.adjacency_matrix() spent  0.0849606990814209
auxiliary_graph
Graph(num_nodes=225664, num_edges=327958581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.11935567855834961
remove nodes length  72233

auxiliary_graph.remove_nodes spent  18.557467937469482
after remove non output nodes the auxiliary_graph
Graph(num_nodes=153431, num_edges=327958581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  12.993109226226807

the counter of shared neighbor distribution
Counter({1.0: 289477776, 2.0: 29084900, 3.0: 5471040, 4.0: 1661006, 5.0: 743546, 6.0: 411060, 7.0: 256134, 8.0: 168238, 9.0: 115996, 10.0: 83578, 11.0: 62060, 12.0: 47414, 13.0: 37292, 14.0: 29470, 15.0: 23804, 16.0: 20196, 17.0: 16566, 18.0: 14276, 19.0: 12164, 20.0: 9978, 21.0: 8368, 22.0: 7312, 23.0: 5784, 24.0: 4890, 25.0: 4824, 26.0: 3954, 27.0: 3586, 28.0: 2934, 30.0: 2712, 29.0: 2696, 31.0: 2294, 32.0: 2068, 33.0: 1608, 35.0: 1520, 34.0: 1506, 36.0: 1012, 37.0: 674, 38.0: 532, 39.0: 382})
327805150
Convert a graph into a bidirected graph: 25.449 seconds
Metis partitioning: 80.936 seconds
Split the graph: 9.625 seconds
Construct subgraphs: 0.078 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  116.22281169891357
19142
18647
18658
19721
19593
19688
19265
18717
total k batches seeds list generation spend  195.64678263664246
after graph partition
graph partition algorithm spend time 196.21387195587158
19142
18647
18658
19721
19593
19688
19265
18717
partition_len_list
[67554, 84164, 70474, 74706, 81502, 44402, 67649, 76169]
REG selection method  spend 196.35732984542847
time for parepare:  0.02978801727294922
local_output_nid generation:  0.0040013790130615234
local_in_edges_tensor generation:  0.008865594863891602
mini_batch_src_global generation:  0.026445865631103516
r_  generation:  0.19808459281921387
local_output_nid generation:  0.004583597183227539
local_in_edges_tensor generation:  0.015063762664794922
mini_batch_src_global generation:  0.02936863899230957
r_  generation:  0.20017743110656738
local_output_nid generation:  0.004777669906616211
local_in_edges_tensor generation:  0.009095430374145508
mini_batch_src_global generation:  0.026428937911987305
r_  generation:  0.19864153861999512
local_output_nid generation:  0.004946470260620117
local_in_edges_tensor generation:  0.009050607681274414
mini_batch_src_global generation:  0.026221513748168945
r_  generation:  0.20057439804077148
local_output_nid generation:  0.004946470260620117
local_in_edges_tensor generation:  0.01871013641357422
mini_batch_src_global generation:  0.04169130325317383
r_  generation:  0.21616911888122559
local_output_nid generation:  0.004686117172241211
local_in_edges_tensor generation:  0.02146172523498535
mini_batch_src_global generation:  0.029564857482910156
r_  generation:  0.23079371452331543
local_output_nid generation:  0.0047724246978759766
local_in_edges_tensor generation:  0.010461568832397461
mini_batch_src_global generation:  0.03433394432067871
r_  generation:  0.21376943588256836
local_output_nid generation:  0.005728244781494141
local_in_edges_tensor generation:  0.007552623748779297
mini_batch_src_global generation:  0.028780698776245117
r_  generation:  0.20580220222473145
----------------------check_connections_block total spend ----------------------------- 2.4052231311798096
generate_one_block  0.33474087715148926
generate_one_block  0.33422160148620605
generate_one_block  0.3283684253692627
generate_one_block  0.3310415744781494
generate_one_block  0.2948141098022461
generate_one_block  0.30367231369018555
generate_one_block  0.35219836235046387
generate_one_block  0.34693169593811035
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.8312468528747559
gen group dst list time:  0.019928932189941406
time for parepare:  0.03300285339355469
local_output_nid generation:  0.015140056610107422
local_in_edges_tensor generation:  0.059537410736083984
mini_batch_src_global generation:  0.07117080688476562
r_  generation:  0.6504786014556885
local_output_nid generation:  0.0347597599029541
local_in_edges_tensor generation:  0.0626363754272461
mini_batch_src_global generation:  0.09425735473632812
r_  generation:  0.8500382900238037
local_output_nid generation:  0.02639913558959961
local_in_edges_tensor generation:  0.03359365463256836
mini_batch_src_global generation:  0.09281325340270996
r_  generation:  0.6733264923095703
local_output_nid generation:  0.026892900466918945
local_in_edges_tensor generation:  0.03508424758911133
mini_batch_src_global generation:  0.0828847885131836
r_  generation:  0.7171046733856201
local_output_nid generation:  0.0304105281829834
local_in_edges_tensor generation:  0.09712553024291992
mini_batch_src_global generation:  0.10187101364135742
r_  generation:  0.8191149234771729
local_output_nid generation:  0.023073434829711914
local_in_edges_tensor generation:  0.017416954040527344
mini_batch_src_global generation:  0.058553457260131836
r_  generation:  0.4116039276123047
local_output_nid generation:  0.01927638053894043
local_in_edges_tensor generation:  0.0240938663482666
mini_batch_src_global generation:  0.06893372535705566
r_  generation:  0.6280927658081055
local_output_nid generation:  0.02215123176574707
local_in_edges_tensor generation:  0.0424799919128418
mini_batch_src_global generation:  0.08691549301147461
r_  generation:  0.7333076000213623
----------------------check_connections_block total spend ----------------------------- 7.798162937164307
generate_one_block  1.056307077407837
generate_one_block  1.130162239074707
generate_one_block  0.9810147285461426
generate_one_block  1.0178489685058594
generate_one_block  0.9988827705383301
generate_one_block  0.5285706520080566
generate_one_block  0.8127257823944092
generate_one_block  0.9302520751953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.7229082584381104
gen group dst list time:  0.05593061447143555
time for parepare:  0.0384063720703125
local_output_nid generation:  0.04970288276672363
local_in_edges_tensor generation:  0.14053702354431152
mini_batch_src_global generation:  0.1414048671722412
r_  generation:  1.5638306140899658
local_output_nid generation:  0.0657186508178711
local_in_edges_tensor generation:  0.1686868667602539
mini_batch_src_global generation:  0.2091076374053955
r_  generation:  1.530860424041748
local_output_nid generation:  0.06033921241760254
local_in_edges_tensor generation:  0.12713170051574707
mini_batch_src_global generation:  0.1913611888885498
r_  generation:  1.5768771171569824
local_output_nid generation:  0.05519723892211914
local_in_edges_tensor generation:  0.10471057891845703
mini_batch_src_global generation:  0.17153024673461914
r_  generation:  1.3953876495361328
local_output_nid generation:  0.0554506778717041
local_in_edges_tensor generation:  0.11174845695495605
mini_batch_src_global generation:  0.1772003173828125
r_  generation:  1.617767095565796
local_output_nid generation:  0.046941518783569336
local_in_edges_tensor generation:  0.09641122817993164
mini_batch_src_global generation:  0.16134071350097656
r_  generation:  1.1834437847137451
local_output_nid generation:  0.04939079284667969
local_in_edges_tensor generation:  0.10158729553222656
mini_batch_src_global generation:  0.15880894660949707
r_  generation:  1.4244751930236816
local_output_nid generation:  0.05431675910949707
local_in_edges_tensor generation:  0.11210417747497559
mini_batch_src_global generation:  0.1781752109527588
r_  generation:  1.485004186630249
----------------------check_connections_block total spend ----------------------------- 16.84295415878296
generate_one_block  2.238246440887451
generate_one_block  2.0848841667175293
generate_one_block  1.9396693706512451
generate_one_block  1.9173126220703125
generate_one_block  2.118446111679077
generate_one_block  1.5678675174713135
generate_one_block  1.8074924945831299
generate_one_block  2.2690627574920654
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.29080986976623535
gen group dst list time:  0.08411121368408203
time for parepare:  0.029491424560546875
local_output_nid generation:  0.05371904373168945
local_in_edges_tensor generation:  0.08680272102355957
mini_batch_src_global generation:  0.06294631958007812
r_  generation:  0.7875888347625732
local_output_nid generation:  0.056821346282958984
local_in_edges_tensor generation:  0.09020829200744629
mini_batch_src_global generation:  0.08317208290100098
r_  generation:  0.8264925479888916
local_output_nid generation:  0.054807424545288086
local_in_edges_tensor generation:  0.0725412368774414
mini_batch_src_global generation:  0.07919812202453613
r_  generation:  0.9059743881225586
local_output_nid generation:  0.06380081176757812
local_in_edges_tensor generation:  0.07017946243286133
mini_batch_src_global generation:  0.08373379707336426
r_  generation:  0.7994048595428467
local_output_nid generation:  0.05671405792236328
local_in_edges_tensor generation:  0.0630338191986084
mini_batch_src_global generation:  0.07566404342651367
r_  generation:  0.8255019187927246
local_output_nid generation:  0.055879831314086914
local_in_edges_tensor generation:  0.06592249870300293
mini_batch_src_global generation:  0.08765888214111328
r_  generation:  0.8467268943786621
local_output_nid generation:  0.05845808982849121
local_in_edges_tensor generation:  0.061771392822265625
mini_batch_src_global generation:  0.08853769302368164
r_  generation:  0.8079197406768799
local_output_nid generation:  0.056169748306274414
local_in_edges_tensor generation:  0.061031341552734375
mini_batch_src_global generation:  0.08266711235046387
r_  generation:  0.8184220790863037
----------------------check_connections_block total spend ----------------------------- 9.726499795913696
generate_one_block  1.372006893157959
generate_one_block  0.9710304737091064
generate_one_block  0.9751465320587158
generate_one_block  1.0465590953826904
generate_one_block  1.0878973007202148
generate_one_block  1.1211333274841309
generate_one_block  0.9653494358062744
generate_one_block  0.9798703193664551
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

connection checking time:  36.77284002304077
block generation total time  34.54372811317444
average batch blocks generation time:  1.0794915035367012
block dataloader generation time/epoch 271.93112301826477
pseudo mini batch 0 input nodes size: 223395
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.5041561126708984  GigaBytes
Max Memory Allocated: 0.5041561126708984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.5042991638183594  GigaBytes
Max Memory Allocated: 0.5042991638183594  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.5042991638183594  GigaBytes
Max Memory Allocated: 0.5042991638183594  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.5742826461791992  GigaBytes
Max Memory Allocated: 0.5742826461791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.5742826461791992  GigaBytes
Max Memory Allocated: 0.5742826461791992  GigaBytes

first layer input nodes number: 223395
first layer output nodes number: 219760
edges number: 2174351
----------------------------------------before model layer 0
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.5780496597290039  GigaBytes
Max Memory Allocated: 0.5861501693725586  GigaBytes

torch.Size([223395, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6795654296875 GB
    Memory Allocated: 0.5780496597290039  GigaBytes
Max Memory Allocated: 0.5861501693725586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.4061279296875 GB
    Memory Allocated: 1.2974882125854492  GigaBytes
Max Memory Allocated: 1.5815668106079102  GigaBytes

torch.Size([219760, 256])
torch.Size([219760, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.5070676803588867  GigaBytes
Max Memory Allocated: 1.7166471481323242  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.2974882125854492  GigaBytes
Max Memory Allocated: 1.7166471481323242  GigaBytes

torch.Size([219760, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.5070676803588867  GigaBytes
Max Memory Allocated: 1.7166471481323242  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.559462547302246  GigaBytes
Max Memory Allocated: 1.7690420150756836  GigaBytes

input nodes number: 219760
output nodes number: 180799
edges number: 4435903
----------------------------------------before model layer 1
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.5625133514404297  GigaBytes
Max Memory Allocated: 1.7690420150756836  GigaBytes

torch.Size([219760, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 1.5625133514404297  GigaBytes
Max Memory Allocated: 1.7690420150756836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.8240966796875 GB
    Memory Allocated: 1.941758155822754  GigaBytes
Max Memory Allocated: 1.941758155822754  GigaBytes

torch.Size([180799, 256])
torch.Size([180799, 256])
----------------------------------------after rst
 Nvidia-smi: 4.1717529296875 GB
    Memory Allocated: 2.1141815185546875  GigaBytes
Max Memory Allocated: 2.286604881286621  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.1717529296875 GB
    Memory Allocated: 1.941758155822754  GigaBytes
Max Memory Allocated: 2.286604881286621  GigaBytes

torch.Size([180799, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.1717529296875 GB
    Memory Allocated: 2.1141815185546875  GigaBytes
Max Memory Allocated: 2.286604881286621  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.15728759765625  GigaBytes
Max Memory Allocated: 2.3297109603881836  GigaBytes

input nodes number: 180799
output nodes number: 67554
edges number: 1978068
----------------------------------------before model layer 2
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.159195899963379  GigaBytes
Max Memory Allocated: 2.3297109603881836  GigaBytes

torch.Size([180799, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.159195899963379  GigaBytes
Max Memory Allocated: 2.3297109603881836  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.2166748046875 GB
    Memory Allocated: 2.303286552429199  GigaBytes
Max Memory Allocated: 2.3297109603881836  GigaBytes

torch.Size([67554, 256])
torch.Size([67554, 256])
----------------------------------------after rst
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.367739677429199  GigaBytes
Max Memory Allocated: 2.432192802429199  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.3033151626586914  GigaBytes
Max Memory Allocated: 2.432192802429199  GigaBytes

torch.Size([67554, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.367739677429199  GigaBytes
Max Memory Allocated: 2.432192802429199  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.3838744163513184  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

----------------input nodes number: 67554
----------------output nodes number: 19142
----------------edges number: 714955
----------------------------------------before mean aggregator
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.384521007537842  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.4120635986328125  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

torch.Size([19142, 41])
torch.Size([19142, 41])
----------------------------------------after rst
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.414987564086914  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.411170482635498  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

torch.Size([19142, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.414987564086914  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.417912483215332  GigaBytes
Max Memory Allocated: 2.448298931121826  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1834716796875 GB
    Memory Allocated: 0.7156691551208496  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

pseudo mini batch 1 input nodes size: 224477
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1834716796875 GB
    Memory Allocated: 0.5103201866149902  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1834716796875 GB
    Memory Allocated: 0.5103201866149902  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 1.0142264366149902  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 1.0143656730651855  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 0.5122694969177246  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 0.5879874229431152  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 0.5879874229431152  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

first layer input nodes number: 224477
first layer output nodes number: 221965
edges number: 2193184
----------------------------------------before model layer 0
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 0.5913143157958984  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([224477, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.6873779296875 GB
    Memory Allocated: 0.5913143157958984  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.3182120323181152  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([221965, 256])
torch.Size([221965, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.5298943519592285  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.3182120323181152  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([221965, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.5298943519592285  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.582815170288086  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

input nodes number: 221965
output nodes number: 196915
edges number: 4819517
----------------------------------------before model layer 1
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.5860462188720703  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([221965, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.5860462188720703  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.9990081787109375  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([196915, 256])
torch.Size([196915, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.186800956726074  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 1.9990081787109375  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([196915, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.186800956726074  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.2337493896484375  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

input nodes number: 196915
output nodes number: 84164
edges number: 2463324
----------------------------------------before model layer 2
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.2359538078308105  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([196915, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.2359538078308105  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.4154648780822754  GigaBytes
Max Memory Allocated: 2.5504531860351562  GigaBytes

torch.Size([84164, 256])
torch.Size([84164, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.495729923248291  GigaBytes
Max Memory Allocated: 2.5759949684143066  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.4154648780822754  GigaBytes
Max Memory Allocated: 2.5759949684143066  GigaBytes

torch.Size([84164, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.495729923248291  GigaBytes
Max Memory Allocated: 2.5759949684143066  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.515796184539795  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

----------------input nodes number: 84164
----------------output nodes number: 18647
----------------edges number: 686416
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.5165629386901855  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.542969226837158  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

torch.Size([18647, 41])
torch.Size([18647, 41])
----------------------------------------after rst
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.5458173751831055  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.542969226837158  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

torch.Size([18647, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.5420002937316895  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1893310546875 GB
    Memory Allocated: 2.544848918914795  GigaBytes
Max Memory Allocated: 2.5960612297058105  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.7360920906066895  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 2 input nodes size: 223502
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5113005638122559  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5113005638122559  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.0132536888122559  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.0133929252624512  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5093474388122559  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5811667442321777  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5811667442321777  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 223502
first layer output nodes number: 220113
edges number: 2177161
----------------------------------------before model layer 0
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5853066444396973  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([223502, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5853066444396973  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.3064055442810059  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([220113, 256])
torch.Size([220113, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5163216590881348  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.3064055442810059  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([220113, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5163216590881348  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.568800926208496  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 220113
output nodes number: 186512
edges number: 4575829
----------------------------------------before model layer 1
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.571831226348877  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([220113, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.571831226348877  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.9630579948425293  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([186512, 256])
torch.Size([186512, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.140929698944092  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.9630579948425293  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([186512, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.140929698944092  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.185851573944092  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 186512
output nodes number: 70474
edges number: 2059349
----------------------------------------before model layer 2
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.1877670288085938  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([186512, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.1877670288085938  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.338054656982422  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([70474, 256])
torch.Size([70474, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.405263900756836  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.338054656982422  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([70474, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.405263900756836  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4220662117004395  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 70474
----------------output nodes number: 18658
----------------edges number: 684092
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4227309226989746  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.449355125427246  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([18658, 41])
torch.Size([18658, 41])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.452205181121826  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.449355125427246  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([18658, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.449357032775879  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4527206420898438  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.7222061157226562  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 3 input nodes size: 224307
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5093493461608887  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5093493461608887  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.0132555961608887  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.0134029388427734  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5113105773925781  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5809454917907715  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5809454917907715  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 224307
first layer output nodes number: 219721
edges number: 2166558
----------------------------------------before model layer 0
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.584254264831543  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([224307, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.584254264831543  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.3035101890563965  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([219721, 256])
torch.Size([219721, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5130524635314941  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.3035101890563965  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([219721, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5130524635314941  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5654382705688477  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 219721
output nodes number: 179138
edges number: 4340659
----------------------------------------before model layer 1
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5684642791748047  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([219721, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.5684642791748047  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.9438190460205078  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([179138, 256])
torch.Size([179138, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.1146583557128906  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 1.9438190460205078  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([179138, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.1146583557128906  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.1573681831359863  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 179138
output nodes number: 74706
edges number: 2121777
----------------------------------------before model layer 2
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.15932035446167  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([179138, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.15932035446167  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.318176746368408  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([74706, 256])
torch.Size([74706, 256])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.3894219398498535  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.318176746368408  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([74706, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.3894219398498535  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.407233238220215  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 74706
----------------output nodes number: 19721
----------------edges number: 674287
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.407937526702881  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4362311363220215  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19721, 41])
torch.Size([19721, 41])
----------------------------------------after rst
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4392433166503906  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.435882568359375  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19721, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4363932609558105  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 2.4397544860839844  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.7188210487365723  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 4 input nodes size: 224626
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5118212699890137  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.1912841796875 GB
    Memory Allocated: 0.5118212699890137  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.0157275199890137  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.015873908996582  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5118203163146973  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.586181640625  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.586181640625  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 224626
first layer output nodes number: 221557
edges number: 2183704
----------------------------------------before model layer 0
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5895061492919922  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([224626, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5895061492919922  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.3147649765014648  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221557, 256])
torch.Size([221557, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5260581970214844  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.3147649765014648  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221557, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5260581970214844  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5788817405700684  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 221557
output nodes number: 185647
edges number: 4492128
----------------------------------------before model layer 1
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.582021713256836  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221557, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.582021713256836  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.970968246459961  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([185647, 256])
torch.Size([185647, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.148015022277832  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.970968246459961  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([185647, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.148015022277832  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.192936897277832  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 185647
output nodes number: 81502
edges number: 2313672
----------------------------------------before model layer 2
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1951541900634766  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([185647, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1951541900634766  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.368453025817871  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([81502, 256])
torch.Size([81502, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4461793899536133  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.368453025817871  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([81502, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4461793899536133  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.465634346008301  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 81502
----------------output nodes number: 19593
----------------edges number: 653875
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.46638822555542  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4934635162353516  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19593, 41])
torch.Size([19593, 41])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4964561462402344  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.493445873260498  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19593, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4930953979492188  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4964566230773926  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.7273454666137695  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 5 input nodes size: 220736
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.511469841003418  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.511469841003418  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.006497859954834  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.0066447257995605  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5025920867919922  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.561124324798584  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.561124324798584  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 220736
first layer output nodes number: 214372
edges number: 2126244
----------------------------------------before model layer 0
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5644574165344238  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([220736, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5644574165344238  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.2664380073547363  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([214372, 256])
torch.Size([214372, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.470879077911377  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.2664380073547363  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([214372, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.470879077911377  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.521989345550537  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 214372
output nodes number: 150129
edges number: 3689515
----------------------------------------before model layer 1
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5253920555114746  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([214372, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5253920555114746  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.840348720550537  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([150129, 256])
torch.Size([150129, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.983522891998291  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.840348720550537  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([150129, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.983522891998291  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.0193166732788086  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 150129
output nodes number: 44402
edges number: 1277039
----------------------------------------before model layer 2
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.020766258239746  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([150129, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.020766258239746  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.115302085876465  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([44402, 256])
torch.Size([44402, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.157647132873535  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.115302085876465  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([44402, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.157647132873535  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1682333946228027  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 44402
----------------output nodes number: 19688
----------------edges number: 715717
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1687111854553223  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1964306831359863  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19688, 41])
torch.Size([19688, 41])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1994380950927734  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.19610595703125  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19688, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.196427822113037  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.200258255004883  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.6740207672119141  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 6 input nodes size: 223196
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5029139518737793  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5029139518737793  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.0034589767456055  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.0036029815673828  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5084280967712402  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.576169490814209  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.576169490814209  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 223196
first layer output nodes number: 218827
edges number: 2165683
----------------------------------------before model layer 0
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5799860954284668  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([223196, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5799860954284668  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.2970819473266602  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([218827, 256])
torch.Size([218827, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5057716369628906  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.2970819473266602  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([218827, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5057716369628906  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5579442977905273  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 218827
output nodes number: 171429
edges number: 4206311
----------------------------------------before model layer 1
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5616002082824707  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([218827, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5616002082824707  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.9211926460266113  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([171429, 256])
torch.Size([171429, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.0846800804138184  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.9211926460266113  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([171429, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.0846800804138184  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.125552177429199  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 171429
output nodes number: 67649
edges number: 1981232
----------------------------------------before model layer 2
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1274986267089844  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([171429, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1274986267089844  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.2717952728271484  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([67649, 256])
torch.Size([67649, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.336310386657715  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.2717952728271484  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([67649, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.336310386657715  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.3524394035339355  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 67649
----------------output nodes number: 19265
----------------edges number: 721384
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.353087902069092  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.3813600540161133  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19265, 41])
torch.Size([19265, 41])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.385221481323242  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.381819248199463  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([19265, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.3818893432617188  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.385751247406006  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.711026668548584  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

pseudo mini batch 7 input nodes size: 224211
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5084981918334961  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5084981918334961  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.011319637298584  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.0114593505859375  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.510770320892334  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.584113597869873  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.584113597869873  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

first layer input nodes number: 224211
first layer output nodes number: 221162
edges number: 2186868
----------------------------------------before model layer 0
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5874323844909668  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([224211, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.5874323844909668  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.3114709854125977  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221162, 256])
torch.Size([221162, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5223875045776367  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.3114500045776367  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221162, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5223875045776367  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5751166343688965  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 221162
output nodes number: 188684
edges number: 4626413
----------------------------------------before model layer 1
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5783543586730957  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([221162, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.5783543586730957  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.9741168022155762  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([188684, 256])
torch.Size([188684, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.154059886932373  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 1.9741168022155762  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([188684, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.154059886932373  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.1990456581115723  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

input nodes number: 188684
output nodes number: 76169
edges number: 2237651
----------------------------------------before model layer 2
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.2019100189208984  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([188684, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.2019100189208984  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.364431381225586  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([76169, 256])
torch.Size([76169, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4370718002319336  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.364431381225586  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([76169, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4370718002319336  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4552321434020996  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------input nodes number: 76169
----------------output nodes number: 18717
----------------edges number: 700794
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.455939769744873  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4832873344421387  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([18717, 41])
torch.Size([18717, 41])
----------------------------------------after rst
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4861464500427246  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.482787609100342  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

torch.Size([18717, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4822444915771484  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 2.4856038093566895  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6951904296875 GB
    Memory Allocated: 0.7279372215270996  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.7010498046875 GB
    Memory Allocated: 0.7323431968688965  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.7010498046875 GB
    Memory Allocated: 0.7323431968688965  GigaBytes
Max Memory Allocated: 2.6873674392700195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18181771039962769 |0.10014781355857849 |0.15521854162216187 |0.00016102194786071777 |0.011749595403671265 |0.006357669830322266 |
----------------------------------------------------------pseudo_mini_loss sum 19.319236755371094
Total (block generation + training)time/epoch 275.5986316204071
Training time/epoch 3.667191743850708
Training time without block to device /epoch 2.86600923538208
Training time without total dataloading part /epoch 1.343390941619873
load block tensor time/epoch 1.4545416831970215
block to device time/epoch 0.8011825084686279
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5551800
Number of first layer input nodes during this epoch:  1788450
Number of first layer output nodes during this epoch:  1757477
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  591360
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([41, 256])
layers.3.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
