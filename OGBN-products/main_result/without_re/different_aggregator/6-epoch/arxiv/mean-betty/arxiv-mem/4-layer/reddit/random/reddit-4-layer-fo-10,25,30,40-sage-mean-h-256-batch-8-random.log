main start at this time 1657100002.077749
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.4552788734436035
number of batches is  8
batch size is  19179
random selection method spend 0.010967016220092773
time for parepare:  0.02790069580078125
local_output_nid generation:  0.00831747055053711
local_in_edges_tensor generation:  0.0222012996673584
mini_batch_src_global generation:  0.020234107971191406
r_  generation:  0.2225503921508789
local_output_nid generation:  0.010699033737182617
local_in_edges_tensor generation:  0.009700298309326172
mini_batch_src_global generation:  0.027472734451293945
r_  generation:  0.23321080207824707
local_output_nid generation:  0.029368877410888672
local_in_edges_tensor generation:  0.011788129806518555
mini_batch_src_global generation:  0.026692867279052734
r_  generation:  0.2424764633178711
local_output_nid generation:  0.010742664337158203
local_in_edges_tensor generation:  0.015561819076538086
mini_batch_src_global generation:  0.02496194839477539
r_  generation:  0.2513411045074463
local_output_nid generation:  0.010844945907592773
local_in_edges_tensor generation:  0.011792421340942383
mini_batch_src_global generation:  0.026343345642089844
r_  generation:  0.2552042007446289
local_output_nid generation:  0.010793447494506836
local_in_edges_tensor generation:  0.013657569885253906
mini_batch_src_global generation:  0.028461456298828125
r_  generation:  0.2628448009490967
local_output_nid generation:  0.010825157165527344
local_in_edges_tensor generation:  0.011722803115844727
mini_batch_src_global generation:  0.02835226058959961
r_  generation:  0.26210570335388184
local_output_nid generation:  0.01069021224975586
local_in_edges_tensor generation:  0.013606786727905273
mini_batch_src_global generation:  0.02863931655883789
r_  generation:  0.26548337936401367
----------------------check_connections_block total spend ----------------------------- 2.8280189037323
generate_one_block  0.2959563732147217
generate_one_block  0.29504895210266113
generate_one_block  0.2994060516357422
generate_one_block  0.30222535133361816
generate_one_block  0.3001823425292969
generate_one_block  0.29985475540161133
generate_one_block  0.31051087379455566
generate_one_block  0.2997708320617676
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5677549839019775
gen group dst list time:  0.03780627250671387
time for parepare:  0.028842926025390625
local_output_nid generation:  0.039588212966918945
local_in_edges_tensor generation:  0.14162731170654297
mini_batch_src_global generation:  0.16008281707763672
r_  generation:  1.5345733165740967
local_output_nid generation:  0.044394493103027344
local_in_edges_tensor generation:  0.12619900703430176
mini_batch_src_global generation:  0.19769573211669922
r_  generation:  1.5773625373840332
local_output_nid generation:  0.04495573043823242
local_in_edges_tensor generation:  0.12621736526489258
mini_batch_src_global generation:  0.1956195831298828
r_  generation:  1.593116283416748
local_output_nid generation:  0.04432559013366699
local_in_edges_tensor generation:  0.12676215171813965
mini_batch_src_global generation:  0.21013951301574707
r_  generation:  1.5918035507202148
local_output_nid generation:  0.04925704002380371
local_in_edges_tensor generation:  0.12831473350524902
mini_batch_src_global generation:  0.19998908042907715
r_  generation:  1.5838253498077393
local_output_nid generation:  0.045139312744140625
local_in_edges_tensor generation:  0.12711429595947266
mini_batch_src_global generation:  0.19983601570129395
r_  generation:  1.6232306957244873
local_output_nid generation:  0.045375823974609375
local_in_edges_tensor generation:  0.13821697235107422
mini_batch_src_global generation:  0.19869256019592285
r_  generation:  1.5850093364715576
local_output_nid generation:  0.04506969451904297
local_in_edges_tensor generation:  0.13857269287109375
mini_batch_src_global generation:  0.20172977447509766
r_  generation:  1.606205940246582
----------------------check_connections_block total spend ----------------------------- 18.074904918670654
generate_one_block  2.083406925201416
generate_one_block  2.108402729034424
generate_one_block  2.11771297454834
generate_one_block  2.205700159072876
generate_one_block  2.3179564476013184
generate_one_block  2.1648831367492676
generate_one_block  2.4181618690490723
generate_one_block  2.085758924484253
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.6621224880218506
gen group dst list time:  0.07410025596618652
time for parepare:  0.03264760971069336
local_output_nid generation:  0.0505523681640625
local_in_edges_tensor generation:  0.156266450881958
mini_batch_src_global generation:  0.16928768157958984
r_  generation:  1.685030221939087
local_output_nid generation:  0.06411314010620117
local_in_edges_tensor generation:  0.13571715354919434
mini_batch_src_global generation:  0.2286207675933838
r_  generation:  1.7878913879394531
local_output_nid generation:  0.09321999549865723
local_in_edges_tensor generation:  0.17973017692565918
mini_batch_src_global generation:  0.42009782791137695
r_  generation:  1.8826253414154053
local_output_nid generation:  0.08756566047668457
local_in_edges_tensor generation:  0.18730378150939941
mini_batch_src_global generation:  0.25219011306762695
r_  generation:  1.805182695388794
local_output_nid generation:  0.07196998596191406
local_in_edges_tensor generation:  0.1513509750366211
mini_batch_src_global generation:  0.21275877952575684
r_  generation:  1.7290470600128174
local_output_nid generation:  0.0645136833190918
local_in_edges_tensor generation:  0.13543319702148438
mini_batch_src_global generation:  0.22708606719970703
r_  generation:  1.7191674709320068
local_output_nid generation:  0.06123852729797363
local_in_edges_tensor generation:  0.15056872367858887
mini_batch_src_global generation:  0.23930668830871582
r_  generation:  1.7415904998779297
local_output_nid generation:  0.06200838088989258
local_in_edges_tensor generation:  0.15056180953979492
mini_batch_src_global generation:  0.20417547225952148
r_  generation:  1.7178375720977783
----------------------check_connections_block total spend ----------------------------- 20.601541757583618
generate_one_block  2.6453769207000732
generate_one_block  2.2455642223358154
generate_one_block  2.673279285430908
generate_one_block  2.9465880393981934
generate_one_block  2.6165871620178223
generate_one_block  2.1923277378082275
generate_one_block  2.179464817047119
generate_one_block  2.1950459480285645
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.2916114330291748
gen group dst list time:  0.07920074462890625
time for parepare:  0.046378135681152344
local_output_nid generation:  0.06987142562866211
local_in_edges_tensor generation:  0.10257124900817871
mini_batch_src_global generation:  0.06690049171447754
r_  generation:  0.834416389465332
local_output_nid generation:  0.08064484596252441
local_in_edges_tensor generation:  0.07920527458190918
mini_batch_src_global generation:  0.08572530746459961
r_  generation:  0.8532454967498779
local_output_nid generation:  0.07778668403625488
local_in_edges_tensor generation:  0.0626521110534668
mini_batch_src_global generation:  0.08242940902709961
r_  generation:  0.8119089603424072
local_output_nid generation:  0.07928252220153809
local_in_edges_tensor generation:  0.06722831726074219
mini_batch_src_global generation:  0.09478259086608887
r_  generation:  0.8290822505950928
local_output_nid generation:  0.07104802131652832
local_in_edges_tensor generation:  0.08440256118774414
mini_batch_src_global generation:  0.08490228652954102
r_  generation:  0.8605165481567383
local_output_nid generation:  0.06815147399902344
local_in_edges_tensor generation:  0.07143545150756836
mini_batch_src_global generation:  0.1056821346282959
r_  generation:  0.842965841293335
local_output_nid generation:  0.06354045867919922
local_in_edges_tensor generation:  0.06722760200500488
mini_batch_src_global generation:  0.07609176635742188
r_  generation:  0.8626742362976074
local_output_nid generation:  0.061357736587524414
local_in_edges_tensor generation:  0.06008172035217285
mini_batch_src_global generation:  0.07782912254333496
r_  generation:  0.8482098579406738
----------------------check_connections_block total spend ----------------------------- 10.03795862197876
generate_one_block  1.3375260829925537
generate_one_block  1.0852634906768799
generate_one_block  1.1252813339233398
generate_one_block  1.2271203994750977
generate_one_block  0.9703872203826904
generate_one_block  0.9633321762084961
generate_one_block  0.9887790679931641
generate_one_block  0.9816293716430664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

connection checking time:  48.71440529823303
block generation total time  45.87553644180298
average batch blocks generation time:  5.734442055225372
block dataloader generation time/epoch 104.74639225006104
pseudo mini batch 0 input nodes size: 226347
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.5100154876708984  GigaBytes
Max Memory Allocated: 0.5100154876708984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.5101585388183594  GigaBytes
Max Memory Allocated: 0.5101585388183594  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.5101585388183594  GigaBytes
Max Memory Allocated: 0.5101585388183594  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.610832691192627  GigaBytes
Max Memory Allocated: 0.610832691192627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.610832691192627  GigaBytes
Max Memory Allocated: 0.610832691192627  GigaBytes

first layer input nodes number: 226347
first layer output nodes number: 225349
edges number: 2218590
----------------------------------------before model layer 0
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.6143012046813965  GigaBytes
Max Memory Allocated: 0.6225662231445312  GigaBytes

torch.Size([226347, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.6143012046813965  GigaBytes
Max Memory Allocated: 0.6225662231445312  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.4744873046875 GB
    Memory Allocated: 1.352860927581787  GigaBytes
Max Memory Allocated: 1.6446504592895508  GigaBytes

torch.Size([225349, 256])
torch.Size([225349, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.5677704811096191  GigaBytes
Max Memory Allocated: 1.7826800346374512  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.352860927581787  GigaBytes
Max Memory Allocated: 1.7826800346374512  GigaBytes

torch.Size([225349, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.5677704811096191  GigaBytes
Max Memory Allocated: 1.7826800346374512  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.6214981079101562  GigaBytes
Max Memory Allocated: 1.8364076614379883  GigaBytes

input nodes number: 225349
output nodes number: 219489
edges number: 5301527
----------------------------------------before model layer 1
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.625020980834961  GigaBytes
Max Memory Allocated: 1.8364076614379883  GigaBytes

torch.Size([225349, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6912841796875 GB
    Memory Allocated: 1.625020980834961  GigaBytes
Max Memory Allocated: 1.8364076614379883  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.0272216796875 GB
    Memory Allocated: 2.084798812866211  GigaBytes
Max Memory Allocated: 2.084798812866211  GigaBytes

torch.Size([219489, 256])
torch.Size([219489, 256])
----------------------------------------after rst
 Nvidia-smi: 4.4490966796875 GB
    Memory Allocated: 2.2941198348999023  GigaBytes
Max Memory Allocated: 2.5034408569335938  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4490966796875 GB
    Memory Allocated: 2.084798812866211  GigaBytes
Max Memory Allocated: 2.5034408569335938  GigaBytes

torch.Size([219489, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4490966796875 GB
    Memory Allocated: 2.2941198348999023  GigaBytes
Max Memory Allocated: 2.5034408569335938  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.5018310546875 GB
    Memory Allocated: 2.3468542098999023  GigaBytes
Max Memory Allocated: 2.5561752319335938  GigaBytes

input nodes number: 219489
output nodes number: 174010
edges number: 5104478
----------------------------------------before model layer 2
 Nvidia-smi: 4.5018310546875 GB
    Memory Allocated: 2.3502049446105957  GigaBytes
Max Memory Allocated: 2.5561752319335938  GigaBytes

torch.Size([219489, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.5018310546875 GB
    Memory Allocated: 2.3502049446105957  GigaBytes
Max Memory Allocated: 2.5561752319335938  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.6697998046875 GB
    Memory Allocated: 2.722013473510742  GigaBytes
Max Memory Allocated: 2.722013473510742  GigaBytes

torch.Size([174010, 256])
torch.Size([174010, 256])
----------------------------------------after rst
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.888029098510742  GigaBytes
Max Memory Allocated: 3.054044723510742  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.7220802307128906  GigaBytes
Max Memory Allocated: 3.054044723510742  GigaBytes

torch.Size([174010, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.8880958557128906  GigaBytes
Max Memory Allocated: 3.054044723510742  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.929516315460205  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

----------------input nodes number: 174010
----------------output nodes number: 19179
----------------edges number: 692586
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.9312758445739746  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.958799362182617  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.961729049682617  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.9587206840515137  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.961729049682617  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0018310546875 GB
    Memory Allocated: 2.9646596908569336  GigaBytes
Max Memory Allocated: 3.095531940460205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.4080810546875 GB
    Memory Allocated: 0.8166022300720215  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

pseudo mini batch 1 input nodes size: 226325
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.4080810546875 GB
    Memory Allocated: 0.5153708457946777  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.4080810546875 GB
    Memory Allocated: 0.5153708457946777  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231833457946777  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0233263969421387  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5153708457946777  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6156191825866699  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6156191825866699  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

first layer input nodes number: 226325
first layer output nodes number: 225331
edges number: 2218790
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190943717956543  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([226325, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190943717956543  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3566913604736328  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([225331, 256])
torch.Size([225331, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5715837478637695  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3566913604736328  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([225331, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5715837478637695  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6253070831298828  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

input nodes number: 225331
output nodes number: 219417
edges number: 5300681
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6291160583496094  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([225331, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6291160583496094  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.088749885559082  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([219417, 256])
torch.Size([219417, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298002243041992  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.088749885559082  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([219417, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298002243041992  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.350736618041992  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

input nodes number: 219417
output nodes number: 174266
edges number: 5114565
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3539438247680664  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([219417, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3539438247680664  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726691246032715  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([174266, 256])
torch.Size([174266, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8928842544555664  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726691246032715  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([174266, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8928842544555664  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9344325065612793  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------input nodes number: 174266
----------------output nodes number: 19179
----------------edges number: 692586
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.93626070022583  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.964609146118164  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.967538833618164  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9643449783325195  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9645304679870605  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9674606323242188  GigaBytes
Max Memory Allocated: 3.2783565521240234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8180727958679199  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 2 input nodes size: 226280
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5155563354492188  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5155563354492188  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0233688354492188  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0235118865966797  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5155563354492188  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6158065795898438  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6158065795898438  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226280
first layer output nodes number: 225256
edges number: 2218226
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6192913055419922  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226280, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6192913055419922  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3573379516601562  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225256, 256])
torch.Size([225256, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5721588134765625  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3573379516601562  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225256, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5721588134765625  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.625864028930664  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225256
output nodes number: 219324
edges number: 5299442
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6298160552978516  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225256, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6298160552978516  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089262008666992  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219324, 256])
torch.Size([219324, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.2984256744384766  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089262008666992  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219324, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.2984256744384766  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3511600494384766  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219324
output nodes number: 173654
edges number: 5097941
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3546762466430664  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219324, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3546762466430664  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7270641326904297  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173654, 256])
torch.Size([173654, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8926734924316406  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7266578674316406  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173654, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8926734924316406  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9340758323669434  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173654
----------------output nodes number: 19179
----------------edges number: 694738
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.93599271774292  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962585926055908  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.965515613555908  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9625325202941895  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962268352508545  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.965251922607422  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8169193267822266  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 3 input nodes size: 226367
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231046676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0232477188110352  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.61553955078125  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.61553955078125  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226367
first layer output nodes number: 225381
edges number: 2219003
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190185546875  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226367, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190185546875  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3571906089782715  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225381, 256])
torch.Size([225381, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5721306800842285  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3571906089782715  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225381, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5721306800842285  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6258659362792969  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225381
output nodes number: 219455
edges number: 5300101
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295795440673828  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225381, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295795440673828  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.0892820358276367  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219455, 256])
torch.Size([219455, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.2985706329345703  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.0892820358276367  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219455, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.2985706329345703  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3513050079345703  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219455
output nodes number: 173886
edges number: 5101751
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.354602813720703  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219455, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.354602813720703  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726992607116699  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173886, 256])
torch.Size([173886, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8928232192993164  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7268075942993164  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173886, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8928232192993164  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9342808723449707  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173886
----------------output nodes number: 19179
----------------edges number: 692767
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.936072826385498  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9631690979003906  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9660987854003906  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.963118553161621  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.963118553161621  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9660487174987793  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8172087669372559  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 4 input nodes size: 226288
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231046676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0232477188110352  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155543327331543  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155543327331543  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226288
first layer output nodes number: 225296
edges number: 2218568
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190371513366699  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226288, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190371513366699  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3571252822875977  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225296, 256])
torch.Size([225296, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719842910766602  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.3571252822875977  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225296, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719842910766602  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6256990432739258  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225296
output nodes number: 219321
edges number: 5299587
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295747756958008  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225296, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295747756958008  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089016914367676  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219321, 256])
torch.Size([219321, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298177719116211  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089016914367676  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219321, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298177719116211  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.350912094116211  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219321
output nodes number: 173585
edges number: 5096171
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3541831970214844  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219321, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3541831970214844  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7265710830688477  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173585, 256])
torch.Size([173585, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8921146392822266  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7260990142822266  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173585, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8921146392822266  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9335007667541504  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173585
----------------output nodes number: 19179
----------------edges number: 695530
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.935420513153076  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9622302055358887  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9651598930358887  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.961966037750244  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.961966037750244  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9648962020874023  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8173813819885254  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 5 input nodes size: 226318
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231046676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0232477188110352  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155219078063965  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155219078063965  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226318
first layer output nodes number: 225282
edges number: 2218077
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190314292907715  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226318, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190314292907715  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357102394104004  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225282, 256])
torch.Size([225282, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719480514526367  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357102394104004  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225282, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719480514526367  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.625659465789795  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225282
output nodes number: 219190
edges number: 5296004
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295619010925293  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225282, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295619010925293  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.08872652053833  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219190, 256])
torch.Size([219190, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.297762393951416  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.08872652053833  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219190, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.297762393951416  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.350496768951416  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219190
output nodes number: 173616
edges number: 5095828
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3538079261779785  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219190, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.3538079261779785  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726195812225342  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173616, 256])
torch.Size([173616, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8917689323425293  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.7257533073425293  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173616, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.8917689323425293  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.933162212371826  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173616
----------------output nodes number: 19179
----------------edges number: 694831
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.935206890106201  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9625797271728516  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9655094146728516  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962315559387207  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962315559387207  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9652457237243652  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8180580139160156  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 6 input nodes size: 226311
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231046676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0232477188110352  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155357360839844  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155357360839844  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226311
first layer output nodes number: 225304
edges number: 2218476
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190242767333984  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226311, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6190242767333984  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357119083404541  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225304, 256])
torch.Size([225304, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719857215881348  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357119083404541  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225304, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5719857215881348  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6257023811340332  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225304
output nodes number: 219360
edges number: 5298834
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295628547668457  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225304, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295628547668457  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089073657989502  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219360, 256])
torch.Size([219360, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298271656036377  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.089073657989502  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219360, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.298271656036377  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.351006031036377  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219360
output nodes number: 173903
edges number: 5102230
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.354280948638916  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219360, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.354280948638916  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726670742034912  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173903, 256])
torch.Size([173903, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.892517566680908  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726501941680908  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173903, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.892517566680908  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9339795112609863  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173903
----------------output nodes number: 19179
----------------edges number: 694127
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9358620643615723  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9630775451660156  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9660072326660156  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962813377380371  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962813377380371  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.966007709503174  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8173913955688477  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

pseudo mini batch 7 input nodes size: 226257
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0231046676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.0232477188110352  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.5152921676635742  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155252456665039  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.6155252456665039  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

first layer input nodes number: 226257
first layer output nodes number: 225259
edges number: 2218106
----------------------------------------before model layer 0
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.619023323059082  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([226257, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.619023323059082  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357071876525879  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225259, 256])
torch.Size([225259, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5718955993652344  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.357071876525879  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225259, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.5718955993652344  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6256017684936523  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 225259
output nodes number: 219221
edges number: 5297642
----------------------------------------before model layer 1
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295480728149414  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([225259, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 1.6295480728149414  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.0887832641601562  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219221, 256])
torch.Size([219221, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.297848701477051  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.0887832641601562  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219221, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.297848701477051  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.350583076477051  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

input nodes number: 219221
output nodes number: 173949
edges number: 5106549
----------------------------------------before model layer 2
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.353877067565918  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([219221, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.353877067565918  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726266860961914  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173949, 256])
torch.Size([173949, 256])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.892157554626465  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.726141929626465  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([173949, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.892157554626465  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9336304664611816  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------input nodes number: 173949
----------------output nodes number: 19178
----------------edges number: 694355
----------------------------------------before mean aggregator
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.935645580291748  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.962446689605713  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19178, 41])
torch.Size([19178, 41])
----------------------------------------after rst
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9653759002685547  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9621810913085938  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

torch.Size([19178, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9621806144714355  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 2.9651107788085938  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9158935546875 GB
    Memory Allocated: 0.8175449371337891  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8219509124755859  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.9217529296875 GB
    Memory Allocated: 0.8219509124755859  GigaBytes
Max Memory Allocated: 3.281435012817383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.16660597920417786 |0.13008448481559753 |0.17458924651145935 |0.00018510222434997559 |0.016385912895202637 |0.006613731384277344 |
----------------------------------------------------------pseudo_mini_loss sum 19.315961837768555
Total (block generation + training)time/epoch 108.74349522590637
Training time/epoch 3.996840238571167
Training time without block to device /epoch 2.9561643600463867
Training time without total dataloading part /epoch 1.535895824432373
load block tensor time/epoch 1.3328478336334229
block to device time/epoch 1.0406758785247803
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6758597
Number of first layer input nodes during this epoch:  1810493
Number of first layer output nodes during this epoch:  1802458
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  591360
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([41, 256])
layers.3.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
