main start at this time 1657104971.8810914
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001171112060546875
global_2_local spend time (sec) 0.00011777877807617188
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00041484832763671875
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 504, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 10: 3, 8: 3, 12: 2, 21: 1, 11: 1, 36: 1, 19: 1, 32: 1})

A = g.adjacency_matrix() spent  0.00033473968505859375
auxiliary_graph
Graph(num_nodes=644, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004792213439941406
remove nodes length  504

auxiliary_graph.remove_nodes spent  0.0010502338409423828
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008211135864257812

the counter of shared neighbor distribution
Counter({1.0: 252, 2.0: 30, 3.0: 14, 4.0: 2})
298
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0023050308227539062
35
34
36
35
total k batches seeds list generation spend  0.00925302505493164
after graph partition
graph partition algorithm spend time 0.05621790885925293
35
34
36
35
partition_len_list
[181, 184, 174, 118]
REG selection method  spend 0.056600332260131836
time for parepare:  0.00012922286987304688
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00011396408081054688
----------------------check_connections_block total spend ----------------------------- 0.0023810863494873047
generate_one_block  0.003106355667114258
generate_one_block  0.002231597900390625
generate_one_block  0.0021228790283203125
generate_one_block  0.0021185874938964844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001050710678100586
gen group dst list time:  8.320808410644531e-05
time for parepare:  0.00034999847412109375
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0008752346038818359
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0005743503570556641
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004730224609375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00029158592224121094
----------------------check_connections_block total spend ----------------------------- 0.004712343215942383
generate_one_block  0.0019838809967041016
generate_one_block  0.001851797103881836
generate_one_block  0.0018160343170166016
generate_one_block  0.0016210079193115234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006885528564453125
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.00019931793212890625
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0011456012725830078
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0010237693786621094
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0008161067962646484
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006735324859619141
----------------------check_connections_block total spend ----------------------------- 0.00625157356262207
generate_one_block  0.0024178028106689453
generate_one_block  0.0022516250610351562
generate_one_block  0.0020270347595214844
generate_one_block  0.0018227100372314453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000789642333984375
gen group dst list time:  0.00010919570922851562
time for parepare:  0.00019741058349609375
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.002146005630493164
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.002102375030517578
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016214847564697266
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0016748905181884766
----------------------check_connections_block total spend ----------------------------- 0.011881113052368164
generate_one_block  0.0034859180450439453
generate_one_block  0.0032036304473876953
generate_one_block  0.002656698226928711
generate_one_block  0.002648591995239258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008552074432373047
gen group dst list time:  0.00017023086547851562
time for parepare:  0.00019741058349609375
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0004813671112060547
mini_batch_src_global generation:  0.00027179718017578125
r_  generation:  0.002826213836669922
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0002887248992919922
r_  generation:  0.002765655517578125
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.0025000572204589844
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.002490997314453125
----------------------check_connections_block total spend ----------------------------- 0.016612529754638672
generate_one_block  0.0042684078216552734
generate_one_block  0.003688335418701172
generate_one_block  0.003431081771850586
generate_one_block  0.003503084182739258
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

connection checking time:  0.041838645935058594
block generation total time  0.05225706100463867
average batch blocks generation time:  0.0026128530502319337
block dataloader generation time/epoch 0.16522765159606934
pseudo mini batch 0 input nodes size: 2309
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.02367877960205078  GigaBytes
Max Memory Allocated: 0.02367877960205078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.023679256439208984  GigaBytes
Max Memory Allocated: 0.023679256439208984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.023679256439208984  GigaBytes
Max Memory Allocated: 0.023679256439208984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.023822307586669922  GigaBytes
Max Memory Allocated: 0.023822307586669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.023822307586669922  GigaBytes
Max Memory Allocated: 0.023822307586669922  GigaBytes

first layer input nodes number: 2309
first layer output nodes number: 2000
edges number: 7890
----------------------------------------before model layer 0
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.023855209350585938  GigaBytes
Max Memory Allocated: 0.02388477325439453  GigaBytes

torch.Size([2309, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.023855209350585938  GigaBytes
Max Memory Allocated: 0.02388477325439453  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03841352462768555  GigaBytes
Max Memory Allocated: 0.04528331756591797  GigaBytes

torch.Size([2000, 512])
torch.Size([2000, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04250288009643555  GigaBytes
Max Memory Allocated: 0.04631757736206055  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03868818283081055  GigaBytes
Max Memory Allocated: 0.04631757736206055  GigaBytes

torch.Size([2000, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04250288009643555  GigaBytes
Max Memory Allocated: 0.04631757736206055  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.0434565544128418  GigaBytes
Max Memory Allocated: 0.0472712516784668  GigaBytes

input nodes number: 2000
output nodes number: 1351
edges number: 6235
----------------------------------------before model layer 1
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.043482303619384766  GigaBytes
Max Memory Allocated: 0.0472712516784668  GigaBytes

torch.Size([2000, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.043482303619384766  GigaBytes
Max Memory Allocated: 0.0472712516784668  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.048693180084228516  GigaBytes
Max Memory Allocated: 0.048693180084228516  GigaBytes

torch.Size([1351, 512])
torch.Size([1351, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0512700080871582  GigaBytes
Max Memory Allocated: 0.05384683609008789  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.048693180084228516  GigaBytes
Max Memory Allocated: 0.05384683609008789  GigaBytes

torch.Size([1351, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0512700080871582  GigaBytes
Max Memory Allocated: 0.05384683609008789  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.051914215087890625  GigaBytes
Max Memory Allocated: 0.05449104309082031  GigaBytes

input nodes number: 1351
output nodes number: 683
edges number: 3373
----------------------------------------before model layer 2
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05192995071411133  GigaBytes
Max Memory Allocated: 0.05449104309082031  GigaBytes

torch.Size([1351, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05192995071411133  GigaBytes
Max Memory Allocated: 0.05449104309082031  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.055002689361572266  GigaBytes
Max Memory Allocated: 0.055002689361572266  GigaBytes

torch.Size([683, 512])
torch.Size([683, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.0563054084777832  GigaBytes
Max Memory Allocated: 0.05760812759399414  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05456686019897461  GigaBytes
Max Memory Allocated: 0.05760812759399414  GigaBytes

torch.Size([683, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05586957931518555  GigaBytes
Max Memory Allocated: 0.05760812759399414  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05663108825683594  GigaBytes
Max Memory Allocated: 0.057933807373046875  GigaBytes

input nodes number: 683
output nodes number: 181
edges number: 1225
----------------------------------------before model layer 3
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05663776397705078  GigaBytes
Max Memory Allocated: 0.057933807373046875  GigaBytes

torch.Size([683, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05663776397705078  GigaBytes
Max Memory Allocated: 0.057933807373046875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05733966827392578  GigaBytes
Max Memory Allocated: 0.057933807373046875  GigaBytes

torch.Size([181, 512])
torch.Size([181, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.057684898376464844  GigaBytes
Max Memory Allocated: 0.058030128479003906  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.05733966827392578  GigaBytes
Max Memory Allocated: 0.058030128479003906  GigaBytes

torch.Size([181, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.057684898376464844  GigaBytes
Max Memory Allocated: 0.058030128479003906  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.05777120590209961  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

----------------input nodes number: 181
----------------output nodes number: 35
----------------edges number: 186
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.05777311325073242  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.05784463882446289  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.057843685150146484  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.05784463882446289  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.0578465461730957  GigaBytes
Max Memory Allocated: 0.05811643600463867  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03552055358886719  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

pseudo mini batch 1 input nodes size: 2246
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0350337028503418  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0350337028503418  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.047023773193359375  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04702425003051758  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.034697532653808594  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03483390808105469  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.03483390808105469  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

first layer input nodes number: 2246
first layer output nodes number: 1967
edges number: 7765
----------------------------------------before model layer 0
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0348658561706543  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

torch.Size([2246, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0348658561706543  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.049184322357177734  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

torch.Size([1967, 512])
torch.Size([1967, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05297374725341797  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04922199249267578  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

torch.Size([1967, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05297374725341797  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.053911685943603516  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

input nodes number: 1967
output nodes number: 1308
edges number: 6126
----------------------------------------before model layer 1
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05393648147583008  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

torch.Size([1967, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05393648147583008  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05898237228393555  GigaBytes
Max Memory Allocated: 0.06125497817993164  GigaBytes

torch.Size([1308, 512])
torch.Size([1308, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0614771842956543  GigaBytes
Max Memory Allocated: 0.06397199630737305  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.05898237228393555  GigaBytes
Max Memory Allocated: 0.06397199630737305  GigaBytes

torch.Size([1308, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0614771842956543  GigaBytes
Max Memory Allocated: 0.06397199630737305  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.062100887298583984  GigaBytes
Max Memory Allocated: 0.06459569931030273  GigaBytes

input nodes number: 1308
output nodes number: 559
edges number: 2974
----------------------------------------before model layer 2
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06211519241333008  GigaBytes
Max Memory Allocated: 0.06459569931030273  GigaBytes

torch.Size([1308, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06211519241333008  GigaBytes
Max Memory Allocated: 0.06459569931030273  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06435632705688477  GigaBytes
Max Memory Allocated: 0.06459569931030273  GigaBytes

torch.Size([559, 512])
torch.Size([559, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06571245193481445  GigaBytes
Max Memory Allocated: 0.06696939468383789  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06464338302612305  GigaBytes
Max Memory Allocated: 0.06696939468383789  GigaBytes

torch.Size([559, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06571245193481445  GigaBytes
Max Memory Allocated: 0.06696939468383789  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06616687774658203  GigaBytes
Max Memory Allocated: 0.06723594665527344  GigaBytes

input nodes number: 559
output nodes number: 184
edges number: 980
----------------------------------------before model layer 3
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06617259979248047  GigaBytes
Max Memory Allocated: 0.06723594665527344  GigaBytes

torch.Size([559, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06617259979248047  GigaBytes
Max Memory Allocated: 0.06723594665527344  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06688404083251953  GigaBytes
Max Memory Allocated: 0.06723594665527344  GigaBytes

torch.Size([184, 512])
torch.Size([184, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06723499298095703  GigaBytes
Max Memory Allocated: 0.06758594512939453  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06688404083251953  GigaBytes
Max Memory Allocated: 0.06758594512939453  GigaBytes

torch.Size([184, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06723499298095703  GigaBytes
Max Memory Allocated: 0.06758594512939453  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0673227310180664  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

----------------input nodes number: 184
----------------output nodes number: 34
----------------edges number: 170
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06732463836669922  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06739330291748047  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

torch.Size([34, 7])
torch.Size([34, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06739425659179688  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06739330291748047  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

torch.Size([34, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06739330291748047  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06739473342895508  GigaBytes
Max Memory Allocated: 0.0676736831665039  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.035160064697265625  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

pseudo mini batch 2 input nodes size: 2159
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034697532653808594  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034697532653808594  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.046416282653808594  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.0464167594909668  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034426212310791016  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034543514251708984  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034543514251708984  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

first layer input nodes number: 2159
first layer output nodes number: 1716
edges number: 7048
----------------------------------------before model layer 0
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034572601318359375  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([2159, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.034572601318359375  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.047066688537597656  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1716, 512])
torch.Size([1716, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.050339698791503906  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.047066688537597656  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1716, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.050339698791503906  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05170917510986328  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 1716
output nodes number: 964
edges number: 4750
----------------------------------------before model layer 1
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.051729679107666016  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1716, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.051729679107666016  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.0554509162902832  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([964, 512])
torch.Size([964, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05728960037231445  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.0554509162902832  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([964, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05728960037231445  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.057749271392822266  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 964
output nodes number: 434
edges number: 2318
----------------------------------------before model layer 2
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05776023864746094  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([964, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05776023864746094  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05943775177001953  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([434, 512])
torch.Size([434, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.060265541076660156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.05943775177001953  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([434, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.060265541076660156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.06047248840332031  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 434
output nodes number: 174
edges number: 971
----------------------------------------before model layer 3
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.060477256774902344  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([434, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.060477256774902344  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.061150550842285156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([174, 512])
torch.Size([174, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06148242950439453  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061150550842285156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([174, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06148242950439453  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061565399169921875  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------input nodes number: 174
----------------output nodes number: 36
----------------edges number: 174
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06156730651855469  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06163978576660156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([36, 7])
torch.Size([36, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06164073944091797  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06163978576660156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([36, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06163978576660156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06164121627807617  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03481912612915039  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

pseudo mini batch 3 input nodes size: 2164
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.034426212310791016  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.034426212310791016  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.045978546142578125  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.04597902297973633  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.034259796142578125  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03436851501464844  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03436851501464844  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

first layer input nodes number: 2164
first layer output nodes number: 1718
edges number: 7006
----------------------------------------before model layer 0
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03439760208129883  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([2164, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03439760208129883  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0469050407409668  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1718, 512])
torch.Size([1718, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05018186569213867  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0469050407409668  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1718, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05018186569213867  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05153036117553711  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 1718
output nodes number: 987
edges number: 4839
----------------------------------------before model layer 1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.051550865173339844  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([1718, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.051550865173339844  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.055989742279052734  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([987, 512])
torch.Size([987, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05787229537963867  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.055359840393066406  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([987, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.057242393493652344  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.058342933654785156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 987
output nodes number: 338
edges number: 1909
----------------------------------------before model layer 2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.058353424072265625  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([987, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.058353424072265625  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05965995788574219  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([338, 512])
torch.Size([338, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06030464172363281  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05965995788574219  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([338, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06030464172363281  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06046581268310547  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

input nodes number: 338
output nodes number: 118
edges number: 543
----------------------------------------before model layer 3
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.060469627380371094  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([338, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.060469627380371094  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06092548370361328  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([118, 512])
torch.Size([118, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061150550842285156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06092548370361328  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([118, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061150550842285156  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061206817626953125  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------input nodes number: 118
----------------output nodes number: 35
----------------edges number: 108
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061208248138427734  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06127786636352539  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0612788200378418  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06127786636352539  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06127786636352539  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061279296875  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03462409973144531  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05732917785644531  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.05732917785644531  GigaBytes
Max Memory Allocated: 0.06833410263061523  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00831526517868042 |0.08666914701461792 |0.210953950881958 |0.00015032291412353516 |0.006047070026397705 |0.003010988235473633 |
----------------------------------------------------------pseudo_mini_loss sum 1.9844673871994019
Total (block generation + training)time/epoch 1.4298326969146729
Training time/epoch 1.264420747756958
Training time without block to device /epoch 0.9177441596984863
Training time without total dataloading part /epoch 0.8716163635253906
load block tensor time/epoch 0.03326106071472168
block to device time/epoch 0.3466765880584717
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  23560
Number of first layer input nodes during this epoch:  8878
Number of first layer output nodes during this epoch:  7401
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=512, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  3047424
trainable parameters
layers.0.fc_self.weight, torch.Size([512, 1433])
layers.0.fc_neigh.weight, torch.Size([512, 1433])
layers.1.fc_self.weight, torch.Size([512, 512])
layers.1.fc_neigh.weight, torch.Size([512, 512])
layers.2.fc_self.weight, torch.Size([512, 512])
layers.2.fc_neigh.weight, torch.Size([512, 512])
layers.3.fc_self.weight, torch.Size([512, 512])
layers.3.fc_neigh.weight, torch.Size([512, 512])
layers.4.fc_self.weight, torch.Size([7, 512])
layers.4.fc_neigh.weight, torch.Size([7, 512])
----------------------------------------
un-trainable parameters
