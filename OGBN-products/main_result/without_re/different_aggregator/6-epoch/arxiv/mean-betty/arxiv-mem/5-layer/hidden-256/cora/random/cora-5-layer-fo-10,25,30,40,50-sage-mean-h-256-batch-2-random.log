main start at this time 1657102969.9263842
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001138925552368164
number of batches is  2
batch size is  70
random selection method spend 0.0008034706115722656
time for parepare:  6.508827209472656e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.002606630325317383
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014019012451171875
----------------------check_connections_block total spend ----------------------------- 0.003533601760864258
generate_one_block  0.0038285255432128906
generate_one_block  0.0012481212615966797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005116462707519531
gen group dst list time:  3.5762786865234375e-05
time for parepare:  0.00013780593872070312
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006546974182128906
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0006785392761230469
----------------------check_connections_block total spend ----------------------------- 0.0025179386138916016
generate_one_block  0.0018312931060791016
generate_one_block  0.0018334388732910156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.00019097328186035156
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0017349720001220703
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.0017085075378417969
----------------------check_connections_block total spend ----------------------------- 0.005567312240600586
generate_one_block  0.0030307769775390625
generate_one_block  0.0031223297119140625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006201267242431641
gen group dst list time:  8.797645568847656e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0004315376281738281
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.0027701854705810547
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.00029778480529785156
r_  generation:  0.0026917457580566406
----------------------check_connections_block total spend ----------------------------- 0.008562564849853516
generate_one_block  0.004044532775878906
generate_one_block  0.0038137435913085938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00080108642578125
gen group dst list time:  0.0001068115234375
time for parepare:  0.0001900196075439453
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.003065824508666992
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0029904842376708984
----------------------check_connections_block total spend ----------------------------- 0.009323596954345703
generate_one_block  0.0043146610260009766
generate_one_block  0.0040853023529052734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

connection checking time:  0.025971412658691406
block generation total time  0.026076078414916992
average batch blocks generation time:  0.013038039207458496
block dataloader generation time/epoch 0.07319283485412598
pseudo mini batch 0 input nodes size: 2451
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01729583740234375  GigaBytes
Max Memory Allocated: 0.01729583740234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.017296791076660156  GigaBytes
Max Memory Allocated: 0.017296791076660156  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.017296791076660156  GigaBytes
Max Memory Allocated: 0.017296791076660156  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01748371124267578  GigaBytes
Max Memory Allocated: 0.01748371124267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01748371124267578  GigaBytes
Max Memory Allocated: 0.01748371124267578  GigaBytes

first layer input nodes number: 2451
first layer output nodes number: 2324
edges number: 8846
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01751995086669922  GigaBytes
Max Memory Allocated: 0.017553329467773438  GigaBytes

torch.Size([2451, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01751995086669922  GigaBytes
Max Memory Allocated: 0.017553329467773438  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03221845626831055  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

torch.Size([2324, 256])
torch.Size([2324, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03443479537963867  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03221845626831055  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

torch.Size([2324, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.03443479537963867  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.0349888801574707  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

input nodes number: 2324
output nodes number: 1902
edges number: 8297
----------------------------------------before model layer 1
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

torch.Size([2324, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.039127349853515625  GigaBytes
Max Memory Allocated: 0.04241752624511719  GigaBytes

torch.Size([1902, 256])
torch.Size([1902, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04094123840332031  GigaBytes
Max Memory Allocated: 0.042755126953125  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.03872489929199219  GigaBytes
Max Memory Allocated: 0.042755126953125  GigaBytes

torch.Size([1902, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.040538787841796875  GigaBytes
Max Memory Allocated: 0.042755126953125  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.041394710540771484  GigaBytes
Max Memory Allocated: 0.04320859909057617  GigaBytes

input nodes number: 1902
output nodes number: 1073
edges number: 5325
----------------------------------------before model layer 2
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04141712188720703  GigaBytes
Max Memory Allocated: 0.04320859909057617  GigaBytes

torch.Size([1902, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04141712188720703  GigaBytes
Max Memory Allocated: 0.04320859909057617  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.044228553771972656  GigaBytes
Max Memory Allocated: 0.044228553771972656  GigaBytes

torch.Size([1073, 256])
torch.Size([1073, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04525184631347656  GigaBytes
Max Memory Allocated: 0.04706573486328125  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04398632049560547  GigaBytes
Max Memory Allocated: 0.04706573486328125  GigaBytes

torch.Size([1073, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.04525184631347656  GigaBytes
Max Memory Allocated: 0.04706573486328125  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.046056270599365234  GigaBytes
Max Memory Allocated: 0.04732179641723633  GigaBytes

input nodes number: 1073
output nodes number: 336
edges number: 1999
----------------------------------------before model layer 3
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.046067237854003906  GigaBytes
Max Memory Allocated: 0.04732179641723633  GigaBytes

torch.Size([1073, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.046067237854003906  GigaBytes
Max Memory Allocated: 0.04732179641723633  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.046726226806640625  GigaBytes
Max Memory Allocated: 0.04732179641723633  GigaBytes

torch.Size([336, 256])
torch.Size([336, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.047046661376953125  GigaBytes
Max Memory Allocated: 0.047367095947265625  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.046726226806640625  GigaBytes
Max Memory Allocated: 0.047367095947265625  GigaBytes

torch.Size([336, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.047046661376953125  GigaBytes
Max Memory Allocated: 0.047367095947265625  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04712677001953125  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

----------------input nodes number: 336
----------------output nodes number: 70
----------------edges number: 297
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.047130584716796875  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04720497131347656  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04720306396484375  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04720497131347656  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.04720783233642578  GigaBytes
Max Memory Allocated: 0.04744720458984375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02228546142578125  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

pseudo mini batch 1 input nodes size: 2397
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02164173126220703  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02164173126220703  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03531360626220703  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03531455993652344  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02222919464111328  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02241230010986328  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02241230010986328  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

first layer input nodes number: 2397
first layer output nodes number: 2264
edges number: 8619
----------------------------------------before model layer 0
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022447586059570312  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([2397, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022447586059570312  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03676652908325195  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([2264, 256])
torch.Size([2264, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0389256477355957  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03676652908325195  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([2264, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0389256477355957  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03946542739868164  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

input nodes number: 2264
output nodes number: 1830
edges number: 7987
----------------------------------------before model layer 1
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.039496421813964844  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([2264, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.039496421813964844  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.04347515106201172  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([1830, 256])
torch.Size([1830, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.045220375061035156  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.043061256408691406  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([1830, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.044806480407714844  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.045656681060791016  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

input nodes number: 1830
output nodes number: 1068
edges number: 5192
----------------------------------------before model layer 2
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.04567861557006836  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([1830, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.04567861557006836  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.048526763916015625  GigaBytes
Max Memory Allocated: 0.048908233642578125  GigaBytes

torch.Size([1068, 256])
torch.Size([1068, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05025959014892578  GigaBytes
Max Memory Allocated: 0.051278114318847656  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.049204349517822266  GigaBytes
Max Memory Allocated: 0.051278114318847656  GigaBytes

torch.Size([1068, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05022287368774414  GigaBytes
Max Memory Allocated: 0.051278114318847656  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05051422119140625  GigaBytes
Max Memory Allocated: 0.051532745361328125  GigaBytes

input nodes number: 1068
output nodes number: 348
edges number: 2078
----------------------------------------before model layer 3
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05052518844604492  GigaBytes
Max Memory Allocated: 0.051532745361328125  GigaBytes

torch.Size([1068, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.05052518844604492  GigaBytes
Max Memory Allocated: 0.051532745361328125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0512080192565918  GigaBytes
Max Memory Allocated: 0.051532745361328125  GigaBytes

torch.Size([348, 256])
torch.Size([348, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05187177658081055  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.0512080192565918  GigaBytes
Max Memory Allocated: 0.05187177658081055  GigaBytes

torch.Size([348, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05153989791870117  GigaBytes
Max Memory Allocated: 0.05187177658081055  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.051622867584228516  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

----------------input nodes number: 348
----------------output nodes number: 70
----------------edges number: 341
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05162668228149414  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.051699161529541016  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05170106887817383  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.051699161529541016  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.051699161529541016  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.05170154571533203  GigaBytes
Max Memory Allocated: 0.05195474624633789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.022860050201416016  GigaBytes
Max Memory Allocated: 0.0526123046875  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.031282901763916016  GigaBytes
Max Memory Allocated: 0.0526123046875  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.031282901763916016  GigaBytes
Max Memory Allocated: 0.0526123046875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016309738159179688 |0.17132747173309326 |0.39925074577331543 |0.00022780895233154297 |0.007427692413330078 |0.004857301712036133 |
----------------------------------------------------------pseudo_mini_loss sum 1.9635257720947266
Total (block generation + training)time/epoch 1.2751054763793945
Training time/epoch 1.201568841934204
Training time without block to device /epoch 0.8589138984680176
Training time without total dataloading part /epoch 0.8186697959899902
load block tensor time/epoch 0.032619476318359375
block to device time/epoch 0.3426549434661865
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  15993
Number of first layer input nodes during this epoch:  4848
Number of first layer output nodes during this epoch:  4588
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  1130496
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([256, 256])
layers.3.fc_neigh.weight, torch.Size([256, 256])
layers.4.fc_self.weight, torch.Size([7, 256])
layers.4.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
