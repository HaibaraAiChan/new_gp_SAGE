main start at this time 1657096941.1189091
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.1900789737701416
pseudo mini batch 0 input nodes size: 167922
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.0813751220703125  GigaBytes
Max Memory Allocated: 0.0813751220703125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.08205270767211914  GigaBytes
Max Memory Allocated: 0.08205270767211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.08205270767211914  GigaBytes
Max Memory Allocated: 0.08205270767211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11983633041381836  GigaBytes
Max Memory Allocated: 0.11983633041381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11983633041381836  GigaBytes
Max Memory Allocated: 0.11983633041381836  GigaBytes

first layer input nodes number: 167922
first layer output nodes number: 167727
edges number: 1043753
----------------------------------------before model layer 0
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12236499786376953  GigaBytes
Max Memory Allocated: 0.12625360488891602  GigaBytes

torch.Size([167922, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12236499786376953  GigaBytes
Max Memory Allocated: 0.12625360488891602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.3710904121398926  GigaBytes
Max Memory Allocated: 0.3710904121398926  GigaBytes

torch.Size([167727, 256])
torch.Size([167727, 256])
----------------------------------------after rst
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.5312466621398926  GigaBytes
Max Memory Allocated: 0.6914029121398926  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.3710904121398926  GigaBytes
Max Memory Allocated: 0.6914029121398926  GigaBytes

torch.Size([167727, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.5312466621398926  GigaBytes
Max Memory Allocated: 0.6914029121398926  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.5712361335754395  GigaBytes
Max Memory Allocated: 0.7313923835754395  GigaBytes

input nodes number: 167727
output nodes number: 166594
edges number: 1567716
----------------------------------------before model layer 1
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.5737276077270508  GigaBytes
Max Memory Allocated: 0.7313923835754395  GigaBytes

torch.Size([167727, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.5737276077270508  GigaBytes
Max Memory Allocated: 0.7313923835754395  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 0.9044027328491211  GigaBytes
Max Memory Allocated: 0.9044027328491211  GigaBytes

torch.Size([166594, 256])
torch.Size([166594, 256])
----------------------------------------after rst
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 1.063279151916504  GigaBytes
Max Memory Allocated: 1.2221555709838867  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 0.9044027328491211  GigaBytes
Max Memory Allocated: 1.2221555709838867  GigaBytes

torch.Size([166594, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 1.063279151916504  GigaBytes
Max Memory Allocated: 1.2221555709838867  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 1.103367805480957  GigaBytes
Max Memory Allocated: 1.2622442245483398  GigaBytes

input nodes number: 166594
output nodes number: 157308
edges number: 1603362
----------------------------------------before model layer 2
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 1.1059274673461914  GigaBytes
Max Memory Allocated: 1.2622442245483398  GigaBytes

torch.Size([166594, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6990966796875 GB
    Memory Allocated: 1.1059274673461914  GigaBytes
Max Memory Allocated: 1.2622442245483398  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.8787841796875 GB
    Memory Allocated: 1.4194574356079102  GigaBytes
Max Memory Allocated: 1.4194574356079102  GigaBytes

torch.Size([157308, 256])
torch.Size([157308, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5698480606079102  GigaBytes
Max Memory Allocated: 1.7202386856079102  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.4198274612426758  GigaBytes
Max Memory Allocated: 1.7202386856079102  GigaBytes

torch.Size([157308, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.5698480606079102  GigaBytes
Max Memory Allocated: 1.7202386856079102  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 1.6077232360839844  GigaBytes
Max Memory Allocated: 1.7577438354492188  GigaBytes

----------------input nodes number: 157308
----------------output nodes number: 90941
----------------edges number: 846279
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2186279296875 GB
    Memory Allocated: 1.6096806526184082  GigaBytes
Max Memory Allocated: 1.7577438354492188  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.717245101928711  GigaBytes
Max Memory Allocated: 1.7903013229370117  GigaBytes

torch.Size([90941, 40])
torch.Size([90941, 40])
----------------------------------------after rst
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.7307968139648438  GigaBytes
Max Memory Allocated: 1.7903013229370117  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.7171249389648438  GigaBytes
Max Memory Allocated: 1.7903013229370117  GigaBytes

torch.Size([90941, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.7307968139648438  GigaBytes
Max Memory Allocated: 1.7903013229370117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3065185546875 GB
    Memory Allocated: 1.7444696426391602  GigaBytes
Max Memory Allocated: 1.7903013229370117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.9490966796875 GB
    Memory Allocated: 0.21642112731933594  GigaBytes
Max Memory Allocated: 1.9377202987670898  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 0.21901512145996094  GigaBytes
Max Memory Allocated: 1.9377202987670898  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.9510498046875 GB
    Memory Allocated: 0.21901512145996094  GigaBytes
Max Memory Allocated: 1.9377202987670898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0637814998626709 |0.3325638771057129 |0.8017873764038086 |0.0002703666687011719 |0.04386162757873535 |0.004430055618286133 |
----------------------------------------------------------pseudo_mini_loss sum 6.4876203536987305
Total (block generation + training)time/epoch 1.4437282085418701
Training time/epoch 1.2532145977020264
Training time without block to device /epoch 0.9206507205963135
Training time without total dataloading part /epoch 0.8503494262695312
load block tensor time/epoch 0.0637814998626709
block to device time/epoch 0.3325638771057129
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.1175870895385742e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  659551
Number of first layer input nodes during this epoch:  167922
Number of first layer output nodes during this epoch:  167727
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  348160
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([40, 256])
layers.3.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
