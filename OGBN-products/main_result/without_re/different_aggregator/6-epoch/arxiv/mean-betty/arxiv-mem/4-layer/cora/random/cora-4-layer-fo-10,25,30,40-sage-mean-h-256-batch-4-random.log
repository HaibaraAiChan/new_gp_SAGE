main start at this time 1657101306.289237
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001003265380859375
number of batches is  4
batch size is  35
random selection method spend 0.0005931854248046875
time for parepare:  7.748603820800781e-05
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0014290809631347656
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.556510925292969e-05
----------------------check_connections_block total spend ----------------------------- 0.0028715133666992188
generate_one_block  0.003759145736694336
generate_one_block  0.0011653900146484375
generate_one_block  0.0011067390441894531
generate_one_block  0.0010726451873779297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005056858062744141
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.00017404556274414062
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003693103790283203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00041604042053222656
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003476142883300781
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.000415802001953125
----------------------check_connections_block total spend ----------------------------- 0.00310516357421875
generate_one_block  0.0014617443084716797
generate_one_block  0.0015454292297363281
generate_one_block  0.0014638900756835938
generate_one_block  0.0014786720275878906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000583648681640625
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.00017714500427246094
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0010454654693603516
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0012989044189453125
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.001111745834350586
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0012021064758300781
----------------------check_connections_block total spend ----------------------------- 0.007581472396850586
generate_one_block  0.0022869110107421875
generate_one_block  0.0024993419647216797
generate_one_block  0.002329111099243164
generate_one_block  0.0023202896118164062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007636547088623047
gen group dst list time:  0.0001361370086669922
time for parepare:  0.0001838207244873047
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.00040435791015625
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.002054452896118164
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0021734237670898438
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.002105236053466797
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.002161264419555664
----------------------check_connections_block total spend ----------------------------- 0.013365983963012695
generate_one_block  0.003257274627685547
generate_one_block  0.0034637451171875
generate_one_block  0.0031976699829101562
generate_one_block  0.0031919479370117188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

connection checking time:  0.02405261993408203
block generation total time  0.02849602699279785
average batch blocks generation time:  0.007124006748199463
block dataloader generation time/epoch 0.0732724666595459
pseudo mini batch 0 input nodes size: 1978
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.014282703399658203  GigaBytes
Max Memory Allocated: 0.014282703399658203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.014283180236816406  GigaBytes
Max Memory Allocated: 0.014283180236816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.014283180236816406  GigaBytes
Max Memory Allocated: 0.014283180236816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014364242553710938  GigaBytes
Max Memory Allocated: 0.014364242553710938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014364242553710938  GigaBytes
Max Memory Allocated: 0.014364242553710938  GigaBytes

first layer input nodes number: 1978
first layer output nodes number: 1385
edges number: 5933
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014389514923095703  GigaBytes
Max Memory Allocated: 0.01441192626953125  GigaBytes

torch.Size([1978, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014389514923095703  GigaBytes
Max Memory Allocated: 0.01441192626953125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.023154258728027344  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([1385, 256])
torch.Size([1385, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02525615692138672  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.023935317993164062  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([1385, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02525615692138672  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.025586605072021484  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

input nodes number: 1385
output nodes number: 637
edges number: 3360
----------------------------------------before model layer 1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.025601863861083984  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([1385, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.025601863861083984  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.026847362518310547  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([637, 256])
torch.Size([637, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027454853057861328  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.026847362518310547  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([637, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027454853057861328  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027606964111328125  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

input nodes number: 637
output nodes number: 181
edges number: 1135
----------------------------------------before model layer 2
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027613162994384766  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([637, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027613162994384766  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027968883514404297  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([181, 256])
torch.Size([181, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028141498565673828  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027968883514404297  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([181, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028141498565673828  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028184890747070312  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------input nodes number: 181
----------------output nodes number: 35
----------------edges number: 158
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028186798095703125  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02822399139404297  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028224945068359375  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02822399139404297  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028224945068359375  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028226852416992188  GigaBytes
Max Memory Allocated: 0.029232501983642578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019008159637451172  GigaBytes
Max Memory Allocated: 0.02935934066772461  GigaBytes

pseudo mini batch 1 input nodes size: 2100
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.018743515014648438  GigaBytes
Max Memory Allocated: 0.02935934066772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.018743515014648438  GigaBytes
Max Memory Allocated: 0.02935934066772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02995443344116211  GigaBytes
Max Memory Allocated: 0.02995443344116211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.029954910278320312  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019394874572753906  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019484519958496094  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019484519958496094  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

first layer input nodes number: 2100
first layer output nodes number: 1556
edges number: 6550
----------------------------------------before model layer 0
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

torch.Size([2100, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019512176513671875  GigaBytes
Max Memory Allocated: 0.029954910278320312  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.029358386993408203  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1556, 256])
torch.Size([1556, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03126239776611328  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.029778480529785156  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1556, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03126239776611328  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03163337707519531  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 1556
output nodes number: 750
edges number: 3801
----------------------------------------before model layer 1
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03165102005004883  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1556, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03165102005004883  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03311586380004883  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([750, 256])
torch.Size([750, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.033831119537353516  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03311586380004883  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([750, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.033831119537353516  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03400993347167969  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 750
output nodes number: 189
edges number: 1236
----------------------------------------before model layer 2
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034017086029052734  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([750, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034017086029052734  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03438901901245117  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([189, 256])
torch.Size([189, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03456926345825195  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03438901901245117  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([189, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03456926345825195  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03461456298828125  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------input nodes number: 189
----------------output nodes number: 35
----------------edges number: 165
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03461647033691406  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034653663635253906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03465461730957031  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034653663635253906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034653663635253906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.034655094146728516  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019689083099365234  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

pseudo mini batch 2 input nodes size: 2035
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019394874572753906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019394874572753906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030258655548095703  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030259132385253906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01913166046142578  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01913166046142578  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

first layer input nodes number: 2035
first layer output nodes number: 1464
edges number: 6238
----------------------------------------before model layer 0
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019157886505126953  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([2035, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019157886505126953  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.028421878814697266  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1464, 256])
torch.Size([1464, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.028421878814697266  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1464, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.029818058013916016  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03085041046142578  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 1464
output nodes number: 658
edges number: 3483
----------------------------------------before model layer 1
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030866622924804688  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1464, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030866622924804688  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032154083251953125  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([658, 256])
torch.Size([658, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03278160095214844  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032154083251953125  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([658, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03278160095214844  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032938480377197266  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 658
output nodes number: 163
edges number: 1041
----------------------------------------before model layer 2
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03294515609741211  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([658, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03294515609741211  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033266544342041016  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([163, 256])
torch.Size([163, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033421993255615234  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033266544342041016  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([163, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033421993255615234  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03346109390258789  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------input nodes number: 163
----------------output nodes number: 35
----------------edges number: 140
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0334630012512207  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03350019454956055  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03350114822387695  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03350019454956055  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03350019454956055  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033501625061035156  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019323348999023438  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

pseudo mini batch 3 input nodes size: 2025
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01904773712158203  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.029858112335205078  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02985858917236328  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01899433135986328  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01908111572265625  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01908111572265625  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

first layer input nodes number: 2025
first layer output nodes number: 1500
edges number: 6380
----------------------------------------before model layer 0
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019107818603515625  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([2025, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.019107818603515625  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.028599262237548828  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1500, 256])
torch.Size([1500, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030610084533691406  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02917957305908203  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1500, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.030610084533691406  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03096771240234375  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 1500
output nodes number: 700
edges number: 3703
----------------------------------------before model layer 1
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03098440170288086  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([1500, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03098440170288086  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03235292434692383  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([700, 256])
torch.Size([700, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03235292434692383  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([700, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0330204963684082  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0331873893737793  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

input nodes number: 700
output nodes number: 205
edges number: 1221
----------------------------------------before model layer 2
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033194541931152344  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([700, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033194541931152344  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03359699249267578  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([205, 256])
torch.Size([205, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03379249572753906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03359699249267578  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([205, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03379249572753906  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033841609954833984  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------input nodes number: 205
----------------output nodes number: 35
----------------edges number: 175
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033843994140625  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033881187438964844  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03388214111328125  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033881187438964844  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033881187438964844  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03388261795043945  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.01927947998046875  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02749776840209961  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02749776840209961  GigaBytes
Max Memory Allocated: 0.036187171936035156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006889045238494873 |0.08804285526275635 |0.20859754085540771 |0.0001633763313293457 |0.004037261009216309 |0.004083156585693359 |
----------------------------------------------------------pseudo_mini_loss sum 1.9402741193771362
Total (block generation + training)time/epoch 1.3226327896118164
Training time/epoch 1.2490615844726562
Training time without block to device /epoch 0.8968901634216309
Training time without total dataloading part /epoch 0.8552758693695068
load block tensor time/epoch 0.027556180953979492
block to device time/epoch 0.3521714210510254
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17526
Number of first layer input nodes during this epoch:  8138
Number of first layer output nodes during this epoch:  5905
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  999424
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([7, 256])
layers.3.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
