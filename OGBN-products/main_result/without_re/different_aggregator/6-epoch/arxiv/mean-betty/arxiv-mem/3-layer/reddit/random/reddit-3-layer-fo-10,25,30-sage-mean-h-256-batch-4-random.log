main start at this time 1657073416.4557939
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33419156074523926
number of batches is  4
batch size is  38358
random selection method spend 0.012598276138305664
time for parepare:  0.028043746948242188
local_output_nid generation:  0.016448974609375
local_in_edges_tensor generation:  0.027590274810791016
mini_batch_src_global generation:  0.030559062957763672
r_  generation:  0.36519789695739746
local_output_nid generation:  0.020421504974365234
local_in_edges_tensor generation:  0.026330232620239258
mini_batch_src_global generation:  0.04271817207336426
r_  generation:  0.38406825065612793
local_output_nid generation:  0.020499229431152344
local_in_edges_tensor generation:  0.022976398468017578
mini_batch_src_global generation:  0.03700613975524902
r_  generation:  0.38872575759887695
local_output_nid generation:  0.02034616470336914
local_in_edges_tensor generation:  0.014788389205932617
mini_batch_src_global generation:  0.04373311996459961
r_  generation:  0.40517735481262207
----------------------check_connections_block total spend ----------------------------- 2.1832220554351807
generate_one_block  0.5075104236602783
generate_one_block  0.5028386116027832
generate_one_block  0.4935276508331299
generate_one_block  0.4963846206665039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.48928093910217285
gen group dst list time:  0.02228832244873047
time for parepare:  0.028673171997070312
local_output_nid generation:  0.04188370704650879
local_in_edges_tensor generation:  0.13384175300598145
mini_batch_src_global generation:  0.15656185150146484
r_  generation:  1.4656543731689453
local_output_nid generation:  0.04756903648376465
local_in_edges_tensor generation:  0.11669564247131348
mini_batch_src_global generation:  0.17883563041687012
r_  generation:  1.4714841842651367
local_output_nid generation:  0.05022382736206055
local_in_edges_tensor generation:  0.11771655082702637
mini_batch_src_global generation:  0.18011784553527832
r_  generation:  1.4925510883331299
local_output_nid generation:  0.047637939453125
local_in_edges_tensor generation:  0.12041211128234863
mini_batch_src_global generation:  0.1822950839996338
r_  generation:  1.4795019626617432
----------------------check_connections_block total spend ----------------------------- 8.473478317260742
generate_one_block  2.0248773097991943
generate_one_block  1.9084982872009277
generate_one_block  1.9107251167297363
generate_one_block  1.9600625038146973
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.2503690719604492
gen group dst list time:  0.038573265075683594
time for parepare:  0.03280138969421387
local_output_nid generation:  0.08065199851989746
local_in_edges_tensor generation:  0.10156655311584473
mini_batch_src_global generation:  0.06929850578308105
r_  generation:  0.7881021499633789
local_output_nid generation:  0.0711827278137207
local_in_edges_tensor generation:  0.09334111213684082
mini_batch_src_global generation:  0.08656430244445801
r_  generation:  0.8072307109832764
local_output_nid generation:  0.07323932647705078
local_in_edges_tensor generation:  0.06818938255310059
mini_batch_src_global generation:  0.07619738578796387
r_  generation:  0.8592591285705566
local_output_nid generation:  0.07145929336547852
local_in_edges_tensor generation:  0.06310367584228516
mini_batch_src_global generation:  0.08158040046691895
r_  generation:  0.819220781326294
----------------------check_connections_block total spend ----------------------------- 4.945099592208862
generate_one_block  1.324650526046753
generate_one_block  1.223726511001587
generate_one_block  1.1106247901916504
generate_one_block  1.018683910369873
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

connection checking time:  13.418577909469604
block generation total time  12.481848955154419
average batch blocks generation time:  3.1204622387886047
block dataloader generation time/epoch 32.22966384887695
pseudo mini batch 0 input nodes size: 224253
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.5046300888061523  GigaBytes
Max Memory Allocated: 0.5046300888061523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.5049161911010742  GigaBytes
Max Memory Allocated: 0.5049161911010742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.5049161911010742  GigaBytes
Max Memory Allocated: 0.5049161911010742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.5642452239990234  GigaBytes
Max Memory Allocated: 0.5642452239990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.5642452239990234  GigaBytes
Max Memory Allocated: 0.5642452239990234  GigaBytes

first layer input nodes number: 224253
first layer output nodes number: 221418
edges number: 2184155
----------------------------------------before model layer 0
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.56756591796875  GigaBytes
Max Memory Allocated: 0.5757026672363281  GigaBytes

torch.Size([224253, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.56756591796875  GigaBytes
Max Memory Allocated: 0.5757026672363281  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.3983154296875 GB
    Memory Allocated: 1.2923827171325684  GigaBytes
Max Memory Allocated: 1.5786046981811523  GigaBytes

torch.Size([221418, 256])
torch.Size([221418, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.5035433769226074  GigaBytes
Max Memory Allocated: 1.7147040367126465  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.2923827171325684  GigaBytes
Max Memory Allocated: 1.7147040367126465  GigaBytes

torch.Size([221418, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.5035433769226074  GigaBytes
Max Memory Allocated: 1.7147040367126465  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.5563335418701172  GigaBytes
Max Memory Allocated: 1.7674942016601562  GigaBytes

input nodes number: 221418
output nodes number: 193163
edges number: 4703227
----------------------------------------before model layer 1
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.5595526695251465  GigaBytes
Max Memory Allocated: 1.7674942016601562  GigaBytes

torch.Size([221418, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6112060546875 GB
    Memory Allocated: 1.5595526695251465  GigaBytes
Max Memory Allocated: 1.7674942016601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.8690185546875 GB
    Memory Allocated: 1.9645781517028809  GigaBytes
Max Memory Allocated: 1.9645781517028809  GigaBytes

torch.Size([193163, 256])
torch.Size([193163, 256])
----------------------------------------after rst
 Nvidia-smi: 4.2401123046875 GB
    Memory Allocated: 2.1487927436828613  GigaBytes
Max Memory Allocated: 2.333007335662842  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.2401123046875 GB
    Memory Allocated: 1.9645781517028809  GigaBytes
Max Memory Allocated: 2.333007335662842  GigaBytes

torch.Size([193163, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.2401123046875 GB
    Memory Allocated: 2.1487927436828613  GigaBytes
Max Memory Allocated: 2.333007335662842  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.1956677436828613  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

----------------input nodes number: 193163
----------------output nodes number: 38358
----------------edges number: 1060210
----------------------------------------before mean aggregator
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.197540760040283  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.248166084289551  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.2540249824523926  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.248166084289551  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.2540249824523926  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2869873046875 GB
    Memory Allocated: 2.259884834289551  GigaBytes
Max Memory Allocated: 2.379882335662842  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 0.6858501434326172  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

pseudo mini batch 1 input nodes size: 224174
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 0.5124907493591309  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 0.5124907493591309  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 1.0152292251586914  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 1.0155153274536133  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 0.5123138427734375  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 0.5724620819091797  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 0.5724620819091797  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

first layer input nodes number: 224174
first layer output nodes number: 221344
edges number: 2183642
----------------------------------------before model layer 0
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 0.5757818222045898  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([224174, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 0.5757818222045898  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.3003582954406738  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([221344, 256])
torch.Size([221344, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5114483833312988  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.3003582954406738  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([221344, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5114483833312988  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.564220905303955  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

input nodes number: 221344
output nodes number: 193254
edges number: 4706904
----------------------------------------before model layer 1
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5674614906311035  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([221344, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5674614906311035  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.9725737571716309  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([193254, 256])
torch.Size([193254, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1568751335144043  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.9725737571716309  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([193254, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1568751335144043  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2037501335144043  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------input nodes number: 193254
----------------output nodes number: 38358
----------------edges number: 1062393
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2060327529907227  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2576193809509277  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2634782791137695  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2576193809509277  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2576193809509277  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2634787559509277  GigaBytes
Max Memory Allocated: 2.5885696411132812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.6878094673156738  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

pseudo mini batch 2 input nodes size: 224228
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5123138427734375  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5123138427734375  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.0151734352111816  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.0154595375061035  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5124349594116211  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5717706680297852  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5717706680297852  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

first layer input nodes number: 224228
first layer output nodes number: 221429
edges number: 2184044
----------------------------------------before model layer 0
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5750913619995117  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([224228, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5750913619995117  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.2999424934387207  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221429, 256])
torch.Size([221429, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5111136436462402  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.2999424934387207  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221429, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5111136436462402  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5639066696166992  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

input nodes number: 221429
output nodes number: 193065
edges number: 4699776
----------------------------------------before model layer 1
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5670905113220215  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221429, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5670905113220215  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.9719281196594238  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([193065, 256])
torch.Size([193065, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1560492515563965  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.9719281196594238  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([193065, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1560492515563965  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2029242515563965  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------input nodes number: 193065
----------------output nodes number: 38358
----------------edges number: 1061191
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2047929763793945  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2554259300231934  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.261284828186035  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2554259300231934  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2554259300231934  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2612853050231934  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.6857748031616211  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

pseudo mini batch 3 input nodes size: 224172
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5124349594116211  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5124349594116211  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.0151686668395996  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.0154547691345215  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5123090744018555  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5716695785522461  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5716695785522461  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

first layer input nodes number: 224172
first layer output nodes number: 221319
edges number: 2183466
----------------------------------------before model layer 0
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5749969482421875  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([224172, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.5749969482421875  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.299492359161377  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221319, 256])
torch.Size([221319, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5105586051940918  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.299492359161377  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221319, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5105586051940918  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.5633254051208496  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

input nodes number: 221319
output nodes number: 192868
edges number: 4698845
----------------------------------------before model layer 1
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.566545009613037  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([221319, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.566545009613037  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.970858097076416  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([192868, 256])
torch.Size([192868, 256])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1547913551330566  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 1.970858097076416  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([192868, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.1547913551330566  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2016663551330566  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------input nodes number: 192868
----------------output nodes number: 38357
----------------edges number: 1064998
----------------------------------------before mean aggregator
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.203566074371338  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2542266845703125  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([38357, 41])
torch.Size([38357, 41])
----------------------------------------after rst
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2600855827331543  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2542266845703125  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

torch.Size([38357, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2542266845703125  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 2.2600860595703125  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 0.6856517791748047  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.5936279296875 GB
    Memory Allocated: 0.6890811920166016  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.5936279296875 GB
    Memory Allocated: 0.6890811920166016  GigaBytes
Max Memory Allocated: 2.5922751426696777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.18571561574935913 |0.141867995262146 |0.24704468250274658 |0.00016689300537109375 |0.013873934745788574 |0.003505706787109375 |
----------------------------------------------------------pseudo_mini_loss sum 10.795354843139648
Total (block generation + training)time/epoch 34.640700817108154
Training time/epoch 2.410701274871826
Training time without block to device /epoch 1.8432292938232422
Training time without total dataloading part /epoch 1.0478477478027344
load block tensor time/epoch 0.7428624629974365
block to device time/epoch 0.567471981048584
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2554687
Number of first layer input nodes during this epoch:  896827
Number of first layer output nodes during this epoch:  885510
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  460288
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([41, 256])
layers.2.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
