main start at this time 1657005406.4608402
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.814697265625e-05  GigaBytes
Max Memory Allocated: 3.814697265625e-05  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.814697265625e-05  GigaBytes
Max Memory Allocated: 3.814697265625e-05  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.814697265625e-05  GigaBytes
Max Memory Allocated: 3.814697265625e-05  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.06255745887756348
pseudo mini batch 0 input nodes size: 145054
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.814697265625e-05  GigaBytes
Max Memory Allocated: 3.814697265625e-05  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.814697265625e-05  GigaBytes
Max Memory Allocated: 3.814697265625e-05  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.06920528411865234  GigaBytes
Max Memory Allocated: 0.06920528411865234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.06988286972045898  GigaBytes
Max Memory Allocated: 0.06988286972045898  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0877685546875 GB
    Memory Allocated: 0.06988286972045898  GigaBytes
Max Memory Allocated: 0.06988286972045898  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.07370901107788086  GigaBytes
Max Memory Allocated: 0.07370901107788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.07370901107788086  GigaBytes
Max Memory Allocated: 0.07370901107788086  GigaBytes

torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.1487431526184082  GigaBytes
Max Memory Allocated: 0.1653428077697754  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.16229581832885742  GigaBytes
Max Memory Allocated: 0.1653428077697754  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.09186649322509766  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.09194278717041016  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.09194278717041016  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032903194427490234 |0.349834680557251 |0.766211748123169 |0.00033402442932128906 |0.004640102386474609 |0.00205230712890625 |
----------------------------------------------------------pseudo_mini_loss sum 3.8569300174713135
Total (block generation + training)time/epoch 1.2239291667938232
Training time/epoch 1.1606287956237793
Training time without block to device /epoch 0.8107941150665283
Training time without total dataloading part /epoch 0.7732381820678711
load block tensor time/epoch 0.032903194427490234
block to device time/epoch 0.349834680557251
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  145054
Number of first layer input nodes during this epoch:  145054
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.09194231033325195  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.09194231033325195  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0628814697265625
pseudo mini batch 0 input nodes size: 145011
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.08354902267456055  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5037841796875 GB
    Memory Allocated: 0.08354902267456055  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1526956558227539  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.15337324142456055  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08352851867675781  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08735466003417969  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08735466003417969  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.14855575561523438  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1621084213256836  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09164094924926758  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09164094924926758  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09164094924926758  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024689912796020508 |0.0020585060119628906 |0.0016388893127441406 |0.00015592575073242188 |0.0028722286224365234 |0.0007903575897216797 |
----------------------------------------------------------pseudo_mini_loss sum 3.5328550338745117
Total (block generation + training)time/epoch 0.6615132093429565
Training time/epoch 0.035665273666381836
Training time without block to device /epoch 0.033606767654418945
Training time without total dataloading part /epoch 0.005457401275634766
load block tensor time/epoch 0.024689912796020508
block to device time/epoch 0.0020585060119628906
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  145011
Number of first layer input nodes during this epoch:  145011
Number of first layer output nodes during this epoch:  90941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09164047241210938  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09164047241210938  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.05722371737162272
pseudo mini batch 0 input nodes size: 145027
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.083648681640625  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.083648681640625  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1528029441833496  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.15348052978515625  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08365631103515625  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08748245239257812  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.08748245239257812  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.14844322204589844  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.16211605072021484  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09152841567993164  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09152841567993164  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09152841567993164  GigaBytes
Max Memory Allocated: 0.18963956832885742  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025735139846801758 |0.002554655075073242 |0.0018961429595947266 |0.00018930435180664062 |0.0011916160583496094 |0.0009374618530273438 |
----------------------------------------------------------pseudo_mini_loss sum 3.307651996612549
Total (block generation + training)time/epoch 0.4688731829325358
Training time/epoch 0.037462472915649414
Training time without block to device /epoch 0.03490781784057617
Training time without total dataloading part /epoch 0.00421452522277832
load block tensor time/epoch 0.025735139846801758
block to device time/epoch 0.002554655075073242
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  145027
Number of first layer input nodes during this epoch:  145027
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  10240
trainable parameters
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
