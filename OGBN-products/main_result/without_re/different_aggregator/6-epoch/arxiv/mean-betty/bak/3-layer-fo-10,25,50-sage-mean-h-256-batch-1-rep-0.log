main start at this time 1657004915.4905899
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.3920159339904785
pseudo mini batch 0 input nodes size: 167472
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.0808868408203125  GigaBytes
Max Memory Allocated: 0.0808868408203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.08156442642211914  GigaBytes
Max Memory Allocated: 0.08156442642211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.08156442642211914  GigaBytes
Max Memory Allocated: 0.08156442642211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10772562026977539  GigaBytes
Max Memory Allocated: 0.10772562026977539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.10772562026977539  GigaBytes
Max Memory Allocated: 0.10772562026977539  GigaBytes

first layer input nodes number: 167472
first layer output nodes number: 166580
edges number: 1041108
torch.Size([167472, 128])
torch.Size([166580, 256])
input nodes number: 166580
output nodes number: 158287
edges number: 1529231
torch.Size([166580, 256])
torch.Size([158287, 256])
torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.183204174041748  GigaBytes
Max Memory Allocated: 1.2428288459777832  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.1967568397521973  GigaBytes
Max Memory Allocated: 1.2428288459777832  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5330810546875 GB
    Memory Allocated: 0.1739187240600586  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1755361557006836  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1755361557006836  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02959609031677246 |0.3318054676055908 |0.7703616619110107 |0.0002658367156982422 |0.035620927810668945 |0.00417327880859375 |
----------------------------------------------------------pseudo_mini_loss sum 4.600042819976807
Total (block generation + training)time/epoch 1.5694599151611328
Training time/epoch 1.1768476963043213
Training time without block to device /epoch 0.8450422286987305
Training time without total dataloading part /epoch 0.8104217052459717
load block tensor time/epoch 0.02959609031677246
block to device time/epoch 0.3318054676055908
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  492339
Number of first layer input nodes during this epoch:  167472
Number of first layer output nodes during this epoch:  166580
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1755356788635254  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1755356788635254  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.40060508251190186
pseudo mini batch 0 input nodes size: 167472
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.17762041091918945  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1782979965209961  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1237034797668457  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5350341796875 GB
    Memory Allocated: 0.1237034797668457  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

first layer input nodes number: 167472
first layer output nodes number: 166599
edges number: 1041213
torch.Size([167472, 128])
torch.Size([166599, 256])
input nodes number: 166599
output nodes number: 158234
edges number: 1528511
torch.Size([166599, 256])
torch.Size([158234, 256])
torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 1.1852765083312988  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 1.198829174041748  GigaBytes
Max Memory Allocated: 1.3917908668518066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17530012130737305  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17530012130737305  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17530012130737305  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027869224548339844 |0.012358903884887695 |0.01044011116027832 |0.0001289844512939453 |0.03413558006286621 |0.0025093555450439453 |
----------------------------------------------------------pseudo_mini_loss sum 4.1740546226501465
Total (block generation + training)time/epoch 1.0387401580810547
Training time/epoch 0.09835362434387207
Training time without block to device /epoch 0.08599472045898438
Training time without total dataloading part /epoch 0.04721403121948242
load block tensor time/epoch 0.027869224548339844
block to device time/epoch 0.012358903884887695
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  492305
Number of first layer input nodes during this epoch:  167472
Number of first layer output nodes during this epoch:  166599
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17529964447021484  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17529964447021484  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.3633849620819092
pseudo mini batch 0 input nodes size: 167480
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17762041091918945  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.1782979965209961  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.09754228591918945  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.1242671012878418  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.1242671012878418  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

first layer input nodes number: 167480
first layer output nodes number: 166592
edges number: 1041089
torch.Size([167480, 128])
torch.Size([166592, 256])
input nodes number: 166592
output nodes number: 158259
edges number: 1528733
torch.Size([166592, 256])
torch.Size([158259, 256])
torch.Size([90941, 40])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 1.1864595413208008  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 1.20001220703125  GigaBytes
Max Memory Allocated: 1.3936858177185059  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17764902114868164  GigaBytes
Max Memory Allocated: 1.3952088356018066  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17764902114868164  GigaBytes
Max Memory Allocated: 1.3952088356018066  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.5369873046875 GB
    Memory Allocated: 0.17764902114868164  GigaBytes
Max Memory Allocated: 1.3952088356018066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027597665786743164 |0.011920452117919922 |0.01034092903137207 |0.00013494491577148438 |0.0038394927978515625 |0.002447843551635742 |
----------------------------------------------------------pseudo_mini_loss sum 3.6643764972686768
Total (block generation + training)time/epoch 0.8202895323435465
Training time/epoch 0.09418225288391113
Training time without block to device /epoch 0.08226180076599121
Training time without total dataloading part /epoch 0.01676321029663086
load block tensor time/epoch 0.027597665786743164
block to device time/epoch 0.011920452117919922
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  492331
Number of first layer input nodes during this epoch:  167480
Number of first layer output nodes during this epoch:  166592
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  217088
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
