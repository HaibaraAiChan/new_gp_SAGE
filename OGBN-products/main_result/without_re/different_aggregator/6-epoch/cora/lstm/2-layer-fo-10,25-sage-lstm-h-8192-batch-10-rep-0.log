main start at this time 1656401018.1166039
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001211404800415039
global_2_local spend time (sec) 0.0001475811004638672
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0005528926849365234
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 488, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0003783702850341797
auxiliary_graph
Graph(num_nodes=628, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0006203651428222656
remove nodes length  488

auxiliary_graph.remove_nodes spent  0.0010590553283691406
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0009522438049316406

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0035600662231445312
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.011951208114624023
after graph partition
graph partition algorithm spend time 0.06286334991455078
14
14
14
14
14
14
14
14
14
14
partition_len_list
[57, 56, 87, 69, 90, 79, 44, 51, 63, 62]
REG selection method  spend 0.06331706047058105
time for parepare:  0.00014352798461914062
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  4.315376281738281e-05
----------------------check_connections_block total spend ----------------------------- 0.004488229751586914
generate_one_block  0.0022139549255371094
generate_one_block  0.0017037391662597656
generate_one_block  0.0017192363739013672
generate_one_block  0.0016837120056152344
generate_one_block  0.0015819072723388672
generate_one_block  0.0013086795806884766
generate_one_block  0.0012323856353759766
generate_one_block  0.0010974407196044922
generate_one_block  0.0010459423065185547
generate_one_block  0.0010151863098144531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006022453308105469
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.00015544891357421875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015473365783691406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012373924255371094
----------------------check_connections_block total spend ----------------------------- 0.003767728805541992
generate_one_block  0.001194000244140625
generate_one_block  0.0012176036834716797
generate_one_block  0.0012426376342773438
generate_one_block  0.0012309551239013672
generate_one_block  0.0012614727020263672
generate_one_block  0.0012450218200683594
generate_one_block  0.001150369644165039
generate_one_block  0.0011508464813232422
generate_one_block  0.0012316703796386719
generate_one_block  0.0011849403381347656
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

connection checking time:  0.008255958557128906
block generation total time  0.026711702346801758
average batch blocks generation time:  0.001335585117340088
block dataloader generation time/epoch 0.10632181167602539
pseudo mini batch 0 input nodes size: 158
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1515212059020996  GigaBytes
Max Memory Allocated: 2.1515212059020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.151521682739258  GigaBytes
Max Memory Allocated: 2.151521682739258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.151521682739258  GigaBytes
Max Memory Allocated: 2.151521682739258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2342529296875 GB
    Memory Allocated: 2.1515254974365234  GigaBytes
Max Memory Allocated: 2.1515254974365234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2342529296875 GB
    Memory Allocated: 2.1515254974365234  GigaBytes
Max Memory Allocated: 2.1515254974365234  GigaBytes

first layer input nodes number: 158
first layer output nodes number: 57
edges number: 266
torch.Size([158, 1433])
torch.Size([57, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 2.200784206390381  GigaBytes
Max Memory Allocated: 2.203385353088379  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.4022216796875 GB
    Memory Allocated: 2.2007856369018555  GigaBytes
Max Memory Allocated: 2.203385353088379  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.300911903381348  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

pseudo mini batch 1 input nodes size: 149
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.300899982452393  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.300899982452393  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.301695823669434  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.301696300506592  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.3008551597595215  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.3008551597595215  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

first layer input nodes number: 149
first layer output nodes number: 56
edges number: 230
torch.Size([149, 1433])
torch.Size([56, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.345775604248047  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4041748046875 GB
    Memory Allocated: 4.345776557922363  GigaBytes
Max Memory Allocated: 6.199044704437256  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.3008623123168945  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

pseudo mini batch 2 input nodes size: 230
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.300852298736572  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.302080154418945  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.3020806312561035  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.301284313201904  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.301289081573486  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4041748046875 GB
    Memory Allocated: 4.301289081573486  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

first layer input nodes number: 230
first layer output nodes number: 87
edges number: 392
torch.Size([230, 1433])
torch.Size([87, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 4.381679058074951  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 4.381680011749268  GigaBytes
Max Memory Allocated: 8.343638896942139  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301299095153809  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

pseudo mini batch 3 input nodes size: 246
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301284313201904  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301284313201904  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.302597999572754  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.302598476409912  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301370143890381  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301374912261963  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301374912261963  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

first layer input nodes number: 246
first layer output nodes number: 69
edges number: 391
torch.Size([246, 1433])
torch.Size([69, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.370908737182617  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.370909690856934  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301384925842285  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

pseudo mini batch 4 input nodes size: 255
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301370143890381  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301370143890381  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.302731513977051  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.302731990814209  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301417827606201  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301422595977783  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4334716796875 GB
    Memory Allocated: 4.301422595977783  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

first layer input nodes number: 255
first layer output nodes number: 90
edges number: 478
torch.Size([255, 1433])
torch.Size([90, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 4.390966892242432  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4393310546875 GB
    Memory Allocated: 4.390967845916748  GigaBytes
Max Memory Allocated: 8.378596305847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3014326095581055  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

pseudo mini batch 5 input nodes size: 197
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301417827606201  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301417827606201  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.302608013153076  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.302608489990234  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301251411437988  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301251411437988  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

first layer input nodes number: 197
first layer output nodes number: 79
edges number: 420
torch.Size([197, 1433])
torch.Size([79, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.387743949890137  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.387744903564453  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3012614250183105  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

pseudo mini batch 6 input nodes size: 105
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301807403564453  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301807880401611  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300617218017578  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300620079040527  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300620079040527  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

first layer input nodes number: 105
first layer output nodes number: 44
edges number: 185
torch.Size([105, 1433])
torch.Size([44, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.343146324157715  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.343147277832031  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300626754760742  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

pseudo mini batch 7 input nodes size: 116
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300617218017578  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300617218017578  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301236629486084  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301237106323242  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300675868988037  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300678730010986  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300678730010986  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

first layer input nodes number: 116
first layer output nodes number: 51
edges number: 192
torch.Size([116, 1433])
torch.Size([51, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.341179847717285  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.341180801391602  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300685405731201  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

pseudo mini batch 8 input nodes size: 204
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300675868988037  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300675868988037  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301866054534912  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.30186653137207  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301250457763672  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301250457763672  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

first layer input nodes number: 204
first layer output nodes number: 63
edges number: 299
torch.Size([204, 1433])
torch.Size([63, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.357375621795654  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.357376575469971  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3012590408325195  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

pseudo mini batch 9 input nodes size: 155
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.301246643066406  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.302074432373047  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.302074909210205  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300884246826172  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3008880615234375  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.3008880615234375  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

first layer input nodes number: 155
first layer output nodes number: 62
edges number: 258
torch.Size([155, 1433])
torch.Size([62, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.351818084716797  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.351819038391113  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 4.300896167755127  GigaBytes
Max Memory Allocated: 8.387792587280273  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599649906158447  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599649906158447  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5179908752441407 |0.036391830444335936 |0.16808102130889893 |0.00013928413391113282 |0.2286314010620117 |0.08738017082214355 |
----------------------------------------------------------pseudo_mini_loss sum 1.9502625465393066
Total (block generation + training)time/epoch 10.326454162597656
Training time/epoch 10.219727993011475
Training time without block to device /epoch 9.855809688568115
Training time without total dataloading part /epoch 4.055897235870361
load block tensor time/epoch 5.179908752441406
block to device time/epoch 0.3639183044433594
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2473
Number of first layer input nodes during this epoch:  1815
Number of first layer output nodes during this epoch:  658
----------------------------------------before generate dataloader block 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599649429321289  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007092952728271484
global_2_local spend time (sec) 0.0001289844512939453
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003027915954589844
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 493, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 11: 1, 21: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00015592575073242188
auxiliary_graph
Graph(num_nodes=633, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004374980926513672
remove nodes length  493

auxiliary_graph.remove_nodes spent  0.0014336109161376953
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006995201110839844

the counter of shared neighbor distribution
Counter({1.0: 244, 2.0: 30, 3.0: 14, 4.0: 2})
290
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0030362606048583984
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.008099079132080078
after graph partition
graph partition algorithm spend time 0.03503251075744629
14
14
14
14
14
14
14
14
14
14
partition_len_list
[63, 63, 79, 70, 68, 77, 52, 73, 65, 53]
REG selection method  spend 0.03534293174743652
time for parepare:  7.605552673339844e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.002677440643310547
generate_one_block  0.002611398696899414
generate_one_block  0.0013883113861083984
generate_one_block  0.0012209415435791016
generate_one_block  0.0012021064758300781
generate_one_block  0.0011873245239257812
generate_one_block  0.0012116432189941406
generate_one_block  0.0011782646179199219
generate_one_block  0.0011878013610839844
generate_one_block  0.0011932849884033203
generate_one_block  0.0013272762298583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006034374237060547
gen group dst list time:  7.05718994140625e-05
time for parepare:  0.0001468658447265625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00014662742614746094
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00014972686767578125
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001628398895263672
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00012803077697753906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010442733764648438
----------------------check_connections_block total spend ----------------------------- 0.0037949085235595703
generate_one_block  0.0012311935424804688
generate_one_block  0.0012023448944091797
generate_one_block  0.0012056827545166016
generate_one_block  0.0012011528015136719
generate_one_block  0.0012149810791015625
generate_one_block  0.0012235641479492188
generate_one_block  0.0011456012725830078
generate_one_block  0.001192331314086914
generate_one_block  0.0011823177337646484
generate_one_block  0.0011491775512695312
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599649429321289  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

connection checking time:  0.006472349166870117
block generation total time  0.025656700134277344
average batch blocks generation time:  0.0012828350067138673
block dataloader generation time/epoch 0.09193825721740723
pseudo mini batch 0 input nodes size: 223
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599637031555176  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599637031555176  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.600827693939209  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.600828170776367  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.599999904632568  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.600003719329834  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.600003719329834  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

first layer input nodes number: 223
first layer output nodes number: 63
edges number: 353
torch.Size([223, 1433])
torch.Size([63, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.665008544921875  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.4412841796875 GB
    Memory Allocated: 8.66500997543335  GigaBytes
Max Memory Allocated: 11.599649906158447  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

pseudo mini batch 1 input nodes size: 200
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000858306885  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000858306885  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601191520690918  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

first layer input nodes number: 200
first layer output nodes number: 63
edges number: 305
torch.Size([200, 1433])
torch.Size([63, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.6552414894104  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.655242443084717  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

pseudo mini batch 2 input nodes size: 209
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

first layer input nodes number: 209
first layer output nodes number: 79
edges number: 348
torch.Size([209, 1433])
torch.Size([79, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.672466278076172  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.672467231750488  GigaBytes
Max Memory Allocated: 12.66265869140625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

pseudo mini batch 3 input nodes size: 199
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

first layer input nodes number: 199
first layer output nodes number: 70
edges number: 330
torch.Size([199, 1433])
torch.Size([70, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.66657543182373  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.666576385498047  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

pseudo mini batch 4 input nodes size: 213
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

first layer input nodes number: 213
first layer output nodes number: 68
edges number: 340
torch.Size([213, 1433])
torch.Size([68, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.661238670349121  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.661239624023438  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

pseudo mini batch 5 input nodes size: 186
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

first layer input nodes number: 186
first layer output nodes number: 77
edges number: 396
torch.Size([186, 1433])
torch.Size([77, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.682087898254395  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.682088851928711  GigaBytes
Max Memory Allocated: 12.669627666473389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600014686584473  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 6 input nodes size: 115
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600614547729492  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60061502456665  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599424362182617  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599427223205566  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599427223205566  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 115
first layer output nodes number: 52
edges number: 211
torch.Size([115, 1433])
torch.Size([52, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.645679473876953  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.64568042755127  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599433898925781  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 7 input nodes size: 171
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599424362182617  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599424362182617  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600337505340576  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600337982177734  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599727153778076  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 171
first layer output nodes number: 73
edges number: 300
torch.Size([171, 1433])
torch.Size([73, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.661396503448486  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.661397457122803  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599735736846924  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 8 input nodes size: 172
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972333908081  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60064172744751  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600642204284668  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599732398986816  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 172
first layer output nodes number: 65
edges number: 298
torch.Size([172, 1433])
torch.Size([65, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.655049800872803  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.65505075454712  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599740982055664  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 9 input nodes size: 143
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.59972858428955  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600492000579834  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600492477416992  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599573612213135  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599576473236084  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599576473236084  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 143
first layer output nodes number: 53
edges number: 244
torch.Size([143, 1433])
torch.Size([53, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.645353317260742  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.645354270935059  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599583625793457  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599583625793457  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599583625793457  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5959143161773681 |0.00039348602294921877 |0.11439998149871826 |0.00012955665588378906 |0.17905027866363527 |0.004130363464355469 |
----------------------------------------------------------pseudo_mini_loss sum 46.77745056152344
Total (block generation + training)time/epoch 9.887556910514832
Training time/epoch 9.370960474014282
Training time without block to device /epoch 9.36702561378479
Training time without total dataloading part /epoch 2.9399285316467285
load block tensor time/epoch 5.959143161773682
block to device time/epoch 0.0039348602294921875
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2494
Number of first layer input nodes during this epoch:  1831
Number of first layer output nodes during this epoch:  663
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599583148956299  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006611347198486328
global_2_local spend time (sec) 0.00013184547424316406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003058910369873047
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.00017213821411132812
auxiliary_graph
Graph(num_nodes=629, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00043964385986328125
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0010585784912109375
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006973743438720703

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 12, 4.0: 2})
292
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003118753433227539
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.007803201675415039
after graph partition
graph partition algorithm spend time 0.05587506294250488
14
14
14
14
14
14
14
14
14
14
partition_len_list
[61, 61, 87, 38, 53, 117, 69, 47, 68, 58]
REG selection method  spend 0.05626058578491211
time for parepare:  0.0001266002655029297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  6.318092346191406e-05
----------------------check_connections_block total spend ----------------------------- 0.004394054412841797
generate_one_block  0.0035903453826904297
generate_one_block  0.002187013626098633
generate_one_block  0.002192258834838867
generate_one_block  0.0014896392822265625
generate_one_block  0.0014338493347167969
generate_one_block  0.0015168190002441406
generate_one_block  0.0014579296112060547
generate_one_block  0.001451730728149414
generate_one_block  0.0014641284942626953
generate_one_block  0.001252889633178711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006761550903320312
gen group dst list time:  6.794929504394531e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012564659118652344
----------------------check_connections_block total spend ----------------------------- 0.0038046836853027344
generate_one_block  0.0013699531555175781
generate_one_block  0.0012063980102539062
generate_one_block  0.0012812614440917969
generate_one_block  0.0011539459228515625
generate_one_block  0.001165151596069336
generate_one_block  0.0013570785522460938
generate_one_block  0.0011889934539794922
generate_one_block  0.0011372566223144531
generate_one_block  0.0012140274047851562
generate_one_block  0.0012063980102539062
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599583148956299  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

connection checking time:  0.008198738098144531
block generation total time  0.030317068099975586
average batch blocks generation time:  0.0015158534049987793
block dataloader generation time/epoch 0.09681018193562825
pseudo mini batch 0 input nodes size: 151
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599572658538818  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599572658538818  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.60037899017334  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600379467010498  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599615573883057  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599619388580322  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599619388580322  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 151
first layer output nodes number: 61
edges number: 259
torch.Size([151, 1433])
torch.Size([61, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.65006971359253  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.650071144104004  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599628448486328  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 1 input nodes size: 185
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599616527557373  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.599616527557373  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600806713104248  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600807189941406  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 185
first layer output nodes number: 61
edges number: 296
torch.Size([185, 1433])
torch.Size([61, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.653422355651855  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.653423309326172  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

pseudo mini batch 2 input nodes size: 232
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601239204406738  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.601239681243896  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600049018859863  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600053787231445  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4412841796875 GB
    Memory Allocated: 8.600053787231445  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

first layer input nodes number: 232
first layer output nodes number: 87
edges number: 474
torch.Size([232, 1433])
torch.Size([87, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.693419933319092  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.693420886993408  GigaBytes
Max Memory Allocated: 12.679310321807861  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600063800811768  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

pseudo mini batch 3 input nodes size: 105
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600049018859863  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600049018859863  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.60060977935791  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600610256195068  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599373817443848  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599373817443848  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

first layer input nodes number: 105
first layer output nodes number: 38
edges number: 156
torch.Size([105, 1433])
torch.Size([38, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.63587999343872  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.635880947113037  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599380493164062  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

pseudo mini batch 4 input nodes size: 124
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599370956420898  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600033283233643  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.6000337600708  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599475383758545  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599475383758545  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

first layer input nodes number: 124
first layer output nodes number: 53
edges number: 221
torch.Size([124, 1433])
torch.Size([53, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.642488956451416  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.642489910125732  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.59948205947876  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

pseudo mini batch 5 input nodes size: 320
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.599472522735596  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.601181030273438  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.601181507110596  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600518703460693  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600524425506592  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4471435546875 GB
    Memory Allocated: 8.600524425506592  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

first layer input nodes number: 320
first layer output nodes number: 117
edges number: 574
torch.Size([320, 1433])
torch.Size([117, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.712838172912598  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.712839126586914  GigaBytes
Max Memory Allocated: 12.690337181091309  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600535869598389  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 6 input nodes size: 160
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600518703460693  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600518703460693  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601373195648193  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601373672485352  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599668502807617  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599668502807617  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 160
first layer output nodes number: 69
edges number: 280
torch.Size([160, 1433])
torch.Size([69, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.65846300125122  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.658463954925537  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599677085876465  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 7 input nodes size: 130
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599664688110352  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600358963012695  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600359439849854  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599504470825195  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599507331848145  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599507331848145  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 130
first layer output nodes number: 47
edges number: 177
torch.Size([130, 1433])
torch.Size([47, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.63523006439209  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.635231018066406  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599514484405518  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 8 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599504470825195  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599504470825195  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600785732269287  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600786209106445  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600096225738525  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600096225738525  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 240
first layer output nodes number: 68
edges number: 387
torch.Size([240, 1433])
torch.Size([68, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.671964168548584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6719651222229  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600106239318848  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 9 input nodes size: 185
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600091457366943  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601281642913818  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601282119750977  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 185
first layer output nodes number: 58
edges number: 280
torch.Size([185, 1433])
torch.Size([58, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.654167175292969  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.654168128967285  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4842158079147339 |0.0004001617431640625 |0.12456259727478028 |0.0001316070556640625 |0.2537091732025146 |0.05198550224304199 |
----------------------------------------------------------pseudo_mini_loss sum 32.30067443847656
Total (block generation + training)time/epoch 9.738382260004679
Training time/epoch 9.333322048187256
Training time without block to device /epoch 9.329320430755615
Training time without total dataloading part /epoch 3.836019277572632
load block tensor time/epoch 4.842158079147339
block to device time/epoch 0.004001617431640625
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2491
Number of first layer input nodes during this epoch:  1832
Number of first layer output nodes during this epoch:  659
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600011825561523  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008223056793212891
global_2_local spend time (sec) 0.0001544952392578125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003542900085449219
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00018095970153808594
auxiliary_graph
Graph(num_nodes=629, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0005373954772949219
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0013341903686523438
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008029937744140625

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003231525421142578
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.008761882781982422
after graph partition
graph partition algorithm spend time 0.0481562614440918
14
14
14
14
14
14
14
14
14
14
partition_len_list
[66, 59, 98, 62, 77, 81, 48, 58, 54, 61]
REG selection method  spend 0.04859209060668945
time for parepare:  0.00013494491577148438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00010132789611816406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  5.6743621826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.004493236541748047
generate_one_block  0.003641843795776367
generate_one_block  0.0020780563354492188
generate_one_block  0.0014920234680175781
generate_one_block  0.0014698505401611328
generate_one_block  0.0014483928680419922
generate_one_block  0.0014564990997314453
generate_one_block  0.0014238357543945312
generate_one_block  0.0014319419860839844
generate_one_block  0.0010724067687988281
generate_one_block  0.0010638236999511719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006198883056640625
gen group dst list time:  6.866455078125e-05
time for parepare:  0.00011992454528808594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010514259338378906
----------------------check_connections_block total spend ----------------------------- 0.0037810802459716797
generate_one_block  0.0015604496002197266
generate_one_block  0.0012121200561523438
generate_one_block  0.0012960433959960938
generate_one_block  0.0012035369873046875
generate_one_block  0.0012230873107910156
generate_one_block  0.0012362003326416016
generate_one_block  0.0011336803436279297
generate_one_block  0.0011546611785888672
generate_one_block  0.0010902881622314453
generate_one_block  0.0010955333709716797
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600011825561523  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

connection checking time:  0.008274316787719727
block generation total time  0.02878427505493164
average batch blocks generation time:  0.001439213752746582
block dataloader generation time/epoch 0.09678739309310913
pseudo mini batch 0 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601189613342285  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601190090179443  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59999942779541  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 66
edges number: 307
torch.Size([190, 1433])
torch.Size([66, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.65793228149414  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.657933712005615  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 1 input nodes size: 203
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 203
first layer output nodes number: 59
edges number: 306
torch.Size([203, 1433])
torch.Size([59, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.65265941619873  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.652660369873047  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 2 input nodes size: 289
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601543426513672  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60154390335083  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600353240966797  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600358963012695  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600358963012695  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 289
first layer output nodes number: 98
edges number: 534
torch.Size([289, 1433])
torch.Size([98, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.69968318939209  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.699684143066406  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600370407104492  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 3 input nodes size: 206
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600353240966797  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600353240966797  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601543426513672  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60154390335083  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 206
first layer output nodes number: 62
edges number: 334
torch.Size([206, 1433])
torch.Size([62, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.661125183105469  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.661126136779785  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60001277923584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 4 input nodes size: 209
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 209
first layer output nodes number: 77
edges number: 353
torch.Size([209, 1433])
torch.Size([77, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.671340465545654  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.67134141921997  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 5 input nodes size: 210
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 210
first layer output nodes number: 81
edges number: 413
torch.Size([210, 1433])
torch.Size([81, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.685646533966064  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.68564748764038  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60001516342163  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 6 input nodes size: 127
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600678443908691  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60067892074585  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599491119384766  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 127
first layer output nodes number: 48
edges number: 180
torch.Size([127, 1433])
torch.Size([48, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.636932373046875  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.636933326721191  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59949779510498  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 7 input nodes size: 136
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599488258361816  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60021448135376  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600214958190918  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599539279937744  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599539279937744  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 136
first layer output nodes number: 58
edges number: 244
torch.Size([136, 1433])
torch.Size([58, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.654929161071777  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.654930114746094  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599546432495117  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 8 input nodes size: 118
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599536418914795  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60016679763794  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600167274475098  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599440574645996  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599443435668945  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599443435668945  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 118
first layer output nodes number: 54
edges number: 216
torch.Size([118, 1433])
torch.Size([54, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6426100730896  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.642611026763916  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59945011138916  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 9 input nodes size: 131
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599440574645996  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599440574645996  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60014009475708  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600140571594238  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599509716033936  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599512577056885  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599512577056885  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 131
first layer output nodes number: 61
edges number: 228
torch.Size([131, 1433])
torch.Size([61, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.646561622619629  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.646562576293945  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599519729614258  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599519729614258  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599519729614258  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5326687335968018 |0.00039491653442382815 |0.11902921199798584 |0.00012297630310058593 |0.2223871946334839 |0.0024614334106445312 |
----------------------------------------------------------pseudo_mini_loss sum 50.94706726074219
Total (block generation + training)time/epoch 9.655167520046234
Training time/epoch 9.308688402175903
Training time without block to device /epoch 9.304739236831665
Training time without total dataloading part /epoch 3.4178552627563477
load block tensor time/epoch 5.326687335968018
block to device time/epoch 0.003949165344238281
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2483
Number of first layer input nodes during this epoch:  1819
Number of first layer output nodes during this epoch:  664
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.5995192527771  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006420612335205078
global_2_local spend time (sec) 0.0001277923583984375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00030493736267089844
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 490, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00015687942504882812
auxiliary_graph
Graph(num_nodes=630, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004298686981201172
remove nodes length  490

auxiliary_graph.remove_nodes spent  0.001013040542602539
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006890296936035156

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 12, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0030775070190429688
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.007679462432861328
after graph partition
graph partition algorithm spend time 0.059699296951293945
14
14
14
14
14
14
14
14
14
14
partition_len_list
[89, 57, 55, 63, 71, 77, 55, 55, 80, 75]
REG selection method  spend 0.060079097747802734
time for parepare:  0.00012683868408203125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  7.390975952148438e-05
----------------------check_connections_block total spend ----------------------------- 0.004515886306762695
generate_one_block  0.003560781478881836
generate_one_block  0.002190828323364258
generate_one_block  0.0021331310272216797
generate_one_block  0.0016586780548095703
generate_one_block  0.0014405250549316406
generate_one_block  0.0014905929565429688
generate_one_block  0.0014340877532958984
generate_one_block  0.0014450550079345703
generate_one_block  0.0014584064483642578
generate_one_block  0.0012621879577636719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006406307220458984
gen group dst list time:  6.794929504394531e-05
time for parepare:  0.00014853477478027344
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018787384033203125
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001537799835205078
----------------------check_connections_block total spend ----------------------------- 0.0042459964752197266
generate_one_block  0.0014071464538574219
generate_one_block  0.0011970996856689453
generate_one_block  0.0011701583862304688
generate_one_block  0.0011835098266601562
generate_one_block  0.001188039779663086
generate_one_block  0.0012366771697998047
generate_one_block  0.0011653900146484375
generate_one_block  0.0011622905731201172
generate_one_block  0.0012764930725097656
generate_one_block  0.0012197494506835938
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.5995192527771  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

connection checking time:  0.008761882781982422
block generation total time  0.03028082847595215
average batch blocks generation time:  0.0015140414237976075
block dataloader generation time/epoch 0.09932460784912109
pseudo mini batch 0 input nodes size: 231
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59950876235962  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59950876235962  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60074234008789  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600742816925049  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600042819976807  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600047588348389  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600047588348389  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 231
first layer output nodes number: 89
edges number: 407
torch.Size([231, 1433])
torch.Size([89, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.682706832885742  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.682708263397217  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600058555603027  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 1 input nodes size: 177
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600043773651123  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600043773651123  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600988864898682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60098934173584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59975528717041  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599759101867676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599759101867676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 177
first layer output nodes number: 57
edges number: 290
torch.Size([177, 1433])
torch.Size([57, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.652310848236084  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6523118019104  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599767208099365  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 2 input nodes size: 145
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59975528717041  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59975528717041  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600529670715332  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60053014755249  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599587440490723  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599587440490723  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 145
first layer output nodes number: 55
edges number: 230
torch.Size([145, 1433])
torch.Size([55, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.643508434295654  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.64350938796997  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599594593048096  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 3 input nodes size: 190
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599584579467773  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600774765014648  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600775241851807  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 190
first layer output nodes number: 63
edges number: 273
torch.Size([190, 1433])
torch.Size([63, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.652212619781494  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.65221357345581  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600012302398682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 4 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600838661193848  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600839138031006  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599652290344238  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599652290344238  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 71
edges number: 285
torch.Size([157, 1433])
torch.Size([71, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.657210350036621  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.657211303710938  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599660873413086  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 5 input nodes size: 188
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599648475646973  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600838661193848  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600839138031006  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 188
first layer output nodes number: 77
edges number: 399
torch.Size([188, 1433])
torch.Size([77, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.68232536315918  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.682326316833496  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600014686584473  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 6 input nodes size: 161
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600860118865967  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600860595703125  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599669933319092  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599672794342041  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599672794342041  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 161
first layer output nodes number: 55
edges number: 242
torch.Size([161, 1433])
torch.Size([55, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.645017147064209  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.645018100738525  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599679946899414  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 7 input nodes size: 144
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599669933319092  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599669933319092  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600439071655273  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600439548492432  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599582195281982  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599582195281982  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 144
first layer output nodes number: 55
edges number: 238
torch.Size([144, 1433])
torch.Size([55, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.647793292999268  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.647794246673584  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599589347839355  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 8 input nodes size: 270
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599579334259033  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601020812988281  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60102128982544  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6002516746521  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600256443023682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600256443023682  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 270
first layer output nodes number: 80
edges number: 468
torch.Size([270, 1433])
torch.Size([80, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.683356285095215  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.683357238769531  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600266933441162  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 9 input nodes size: 241
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6002516746521  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6002516746521  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60153865814209  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601539134979248  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600097179412842  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600100994110107  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600100994110107  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 241
first layer output nodes number: 75
edges number: 365
torch.Size([241, 1433])
torch.Size([75, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.67082929611206  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.670830249786377  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600110054016113  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600110054016113  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600110054016113  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.5262138605117798 |0.00038037300109863283 |0.11425533294677734 |0.00011975765228271485 |0.19408884048461914 |0.14926910400390625 |
----------------------------------------------------------pseudo_mini_loss sum 101.59081268310547
Total (block generation + training)time/epoch 9.580345964431762
Training time/epoch 9.171440362930298
Training time without block to device /epoch 9.167636632919312
Training time without total dataloading part /epoch 3.2339084148406982
load block tensor time/epoch 5.262138605117798
block to device time/epoch 0.003803730010986328
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2581
Number of first layer input nodes during this epoch:  1904
Number of first layer output nodes during this epoch:  677
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600109577178955  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009541511535644531
global_2_local spend time (sec) 0.0001385211944580078
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003173351287841797
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 491, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001735687255859375
auxiliary_graph
Graph(num_nodes=631, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004436969757080078
remove nodes length  491

auxiliary_graph.remove_nodes spent  0.001222372055053711
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007345676422119141

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003048419952392578
14
14
14
14
14
14
14
14
14
14
total k batches seeds list generation spend  0.008019208908081055
after graph partition
graph partition algorithm spend time 0.06363391876220703
14
14
14
14
14
14
14
14
14
14
partition_len_list
[90, 67, 61, 93, 67, 86, 45, 68, 52, 43]
REG selection method  spend 0.06404972076416016
time for parepare:  0.00011777877807617188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.5789947509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.004547119140625
generate_one_block  0.004118919372558594
generate_one_block  0.0023245811462402344
generate_one_block  0.0015039443969726562
generate_one_block  0.0015015602111816406
generate_one_block  0.0014891624450683594
generate_one_block  0.00148773193359375
generate_one_block  0.0014495849609375
generate_one_block  0.0014719963073730469
generate_one_block  0.001127481460571289
generate_one_block  0.0010521411895751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006906986236572266
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.00014209747314453125
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00018215179443359375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002002716064453125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00016021728515625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00017595291137695312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.320808410644531e-05
----------------------check_connections_block total spend ----------------------------- 0.004076719284057617
generate_one_block  0.0015020370483398438
generate_one_block  0.0012178421020507812
generate_one_block  0.0011987686157226562
generate_one_block  0.0013234615325927734
generate_one_block  0.0012340545654296875
generate_one_block  0.0012700557708740234
generate_one_block  0.0011594295501708984
generate_one_block  0.0012068748474121094
generate_one_block  0.0011646747589111328
generate_one_block  0.0011355876922607422
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600109577178955  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

connection checking time:  0.008623838424682617
block generation total time  0.029939889907836914
average batch blocks generation time:  0.0014969944953918458
block dataloader generation time/epoch 0.10184276103973389
pseudo mini batch 0 input nodes size: 267
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600096225738525  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600096225738525  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601537704467773  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601538181304932  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600250720977783  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600255489349365  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600255489349365  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 267
first layer output nodes number: 90
edges number: 431
torch.Size([267, 1433])
torch.Size([90, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.681751728057861  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.681753158569336  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600266933441162  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 1 input nodes size: 197
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6002516746521  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6002516746521  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601441860198975  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601442337036133  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 197
first layer output nodes number: 67
edges number: 313
torch.Size([197, 1433])
torch.Size([67, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.657135486602783  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.6571364402771  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 2 input nodes size: 159
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600849628448486  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600850105285645  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599659442901611  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599663257598877  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599663257598877  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 159
first layer output nodes number: 61
edges number: 282
torch.Size([159, 1433])
torch.Size([61, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.656062126159668  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.656063079833984  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599671363830566  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 3 input nodes size: 279
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599659442901611  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599659442901611  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601149082183838  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601149559020996  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60030460357666  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60030460357666  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 279
first layer output nodes number: 93
edges number: 506
torch.Size([279, 1433])
torch.Size([93, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.693176746368408  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.693177700042725  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60031509399414  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 4 input nodes size: 217
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600299835205078  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601490020751953  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601490497589111  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600004196166992  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 217
first layer output nodes number: 67
edges number: 354
torch.Size([217, 1433])
torch.Size([67, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.666830062866211  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.666831016540527  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600013256072998  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 5 input nodes size: 212
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.601190567016602  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60119104385376  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600005149841309  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 212
first layer output nodes number: 86
edges number: 434
torch.Size([212, 1433])
torch.Size([86, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.687788963317871  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.687789916992188  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60001516342163  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 6 input nodes size: 99
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600529193878174  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600529670715332  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599339008331299  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599341869354248  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599341869354248  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 99
first layer output nodes number: 45
edges number: 169
torch.Size([99, 1433])
torch.Size([45, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.63745641708374  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.637457370758057  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599348545074463  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 7 input nodes size: 168
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599339008331299  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599339008331299  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600235939025879  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600236415863037  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599707126617432  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599710941314697  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599710941314697  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 168
first layer output nodes number: 68
edges number: 280
torch.Size([168, 1433])
torch.Size([68, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.658421993255615  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.658422946929932  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599719524383545  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 8 input nodes size: 187
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599707126617432  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599707126617432  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600897312164307  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600897789001465  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600003242492676  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 187
first layer output nodes number: 52
edges number: 244
torch.Size([187, 1433])
torch.Size([52, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.643391609191895  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.643392562866211  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600010395050049  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

pseudo mini batch 9 input nodes size: 123
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600000381469727  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.60065746307373  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.600657939910889  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599467277526855  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599470138549805  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.599470138549805  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

first layer input nodes number: 123
first layer output nodes number: 43
edges number: 166
torch.Size([123, 1433])
torch.Size([43, 8192])
torch.Size([14, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.63352346420288  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.633524417877197  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59947681427002  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59947681427002  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4647216796875 GB
    Memory Allocated: 8.59947681427002  GigaBytes
Max Memory Allocated: 12.708839893341064  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.49802799224853517 |0.00036790370941162107 |0.11460723876953124 |0.0001215219497680664 |0.26885983943939207 |0.0023920536041259766 |
----------------------------------------------------------pseudo_mini_loss sum 142.53445434570312
Total (block generation + training)time/epoch 9.525373498598734
Training time/epoch 9.135953187942505
Training time without block to device /epoch 9.132274150848389
Training time without total dataloading part /epoch 3.83827805519104
load block tensor time/epoch 4.980279922485352
block to device time/epoch 0.003679037094116211
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2580
Number of first layer input nodes during this epoch:  1908
Number of first layer output nodes during this epoch:  672
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=8192, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=8192, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(8192, 8192, batch_first=True)
      (fc_self): Linear(in_features=8192, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=8192, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  576968784
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([8192, 1433])
layers.0.fc_neigh.weight, torch.Size([8192, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([32768, 8192])
layers.1.lstm.weight_hh_l0, torch.Size([32768, 8192])
layers.1.lstm.bias_ih_l0, torch.Size([32768])
layers.1.lstm.bias_hh_l0, torch.Size([32768])
layers.1.fc_self.weight, torch.Size([7, 8192])
layers.1.fc_neigh.weight, torch.Size([7, 8192])
----------------------------------------
un-trainable parameters
