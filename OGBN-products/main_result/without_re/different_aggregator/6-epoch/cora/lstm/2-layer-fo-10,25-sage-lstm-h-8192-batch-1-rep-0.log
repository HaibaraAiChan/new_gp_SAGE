main start at this time 1656400786.8199718
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0032083988189697266
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1697998046875 GB
    Memory Allocated: 2.1506776809692383  GigaBytes
Max Memory Allocated: 2.1506776809692383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.1579809188842773  GigaBytes
Max Memory Allocated: 2.1579809188842773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.157982349395752  GigaBytes
Max Memory Allocated: 2.157982349395752  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 2.157982349395752  GigaBytes
Max Memory Allocated: 2.157982349395752  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 2.1580090522766113  GigaBytes
Max Memory Allocated: 2.1580090522766113  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2537841796875 GB
    Memory Allocated: 2.1580090522766113  GigaBytes
Max Memory Allocated: 2.1580090522766113  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 628
edges number: 2928
torch.Size([1368, 1433])
torch.Size([628, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.7579851150512695  GigaBytes
Max Memory Allocated: 2.7860727310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.9822998046875 GB
    Memory Allocated: 2.7579898834228516  GigaBytes
Max Memory Allocated: 2.7860727310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.9822998046875 GB
    Memory Allocated: 4.307443141937256  GigaBytes
Max Memory Allocated: 6.737778186798096  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012263774871826172 |0.35342955589294434 |0.9988563060760498 |0.00028133392333984375 |1.9124605655670166 |0.23065686225891113 |
----------------------------------------------------------pseudo_mini_loss sum 1.9489314556121826
Total (block generation + training)time/epoch 4.213420867919922
Training time/epoch 4.209918975830078
Training time without block to device /epoch 3.856489419937134
Training time without total dataloading part /epoch 3.1422550678253174
load block tensor time/epoch 0.012263774871826172
block to device time/epoch 0.35342955589294434
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1996
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  628
----------------------------------------before generate dataloader block 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.004496097564697266
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.613420009613037  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.613421440124512  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 633
edges number: 2935
torch.Size([1368, 1433])
torch.Size([633, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 9.208075046539307  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.9822998046875 GB
    Memory Allocated: 9.208079814910889  GigaBytes
Max Memory Allocated: 11.606196880340576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006406068801879883 |0.0007176399230957031 |0.5101766586303711 |0.00018453598022460938 |1.9309864044189453 |0.19205760955810547 |
----------------------------------------------------------pseudo_mini_loss sum 49.36948776245117
Total (block generation + training)time/epoch 3.7937707901000977
Training time/epoch 3.368029832839966
Training time without block to device /epoch 3.36731219291687
Training time without total dataloading part /epoch 2.6334052085876465
load block tensor time/epoch 0.006406068801879883
block to device time/epoch 0.0007176399230957031
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2001
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  633
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.003688176472981771
pseudo mini batch 0 input nodes size: 1368
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613420009613037  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613421440124512  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

first layer input nodes number: 1368
first layer output nodes number: 629
edges number: 2919
torch.Size([1368, 1433])
torch.Size([629, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.20708179473877  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.207086563110352  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0039141178131103516 |0.0002849102020263672 |0.5072088241577148 |0.0001697540283203125 |1.9306788444519043 |0.1912386417388916 |
----------------------------------------------------------pseudo_mini_loss sum 31.191364288330078
Total (block generation + training)time/epoch 3.65032696723938
Training time/epoch 3.3612825870513916
Training time without block to device /epoch 3.3609976768493652
Training time without total dataloading part /epoch 2.629296064376831
load block tensor time/epoch 0.0039141178131103516
block to device time/epoch 0.0002849102020263672
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1368
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0034378767013549805
pseudo mini batch 0 input nodes size: 1355
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.61335039138794  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613351821899414  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.6060471534729  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.60607385635376  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.60607385635376  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

first layer input nodes number: 1355
first layer output nodes number: 629
edges number: 2917
torch.Size([1355, 1433])
torch.Size([629, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.206201076507568  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.20620584487915  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606127262115479  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606127262115479  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606127262115479  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012119531631469727 |0.00040531158447265625 |0.5071272850036621 |0.00019931793212890625 |1.9309868812561035 |0.19214773178100586 |
----------------------------------------------------------pseudo_mini_loss sum 54.735984802246094
Total (block generation + training)time/epoch 3.5807424187660217
Training time/epoch 3.369163990020752
Training time without block to device /epoch 3.3687586784362793
Training time without total dataloading part /epoch 2.6304612159729004
load block tensor time/epoch 0.012119531631469727
block to device time/epoch 0.00040531158447265625
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1984
Number of first layer input nodes during this epoch:  1355
Number of first layer output nodes during this epoch:  629
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.60612678527832  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.60612678527832  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.00316004753112793
pseudo mini batch 0 input nodes size: 1367
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.6060471534729  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.6060471534729  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.61335039138794  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613351821899414  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

first layer input nodes number: 1367
first layer output nodes number: 630
edges number: 2922
torch.Size([1367, 1433])
torch.Size([630, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.206628322601318  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.2066330909729  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196880340576  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038726329803466797 |0.00028252601623535156 |0.507457971572876 |0.0001442432403564453 |1.9313549995422363 |0.1910080909729004 |
----------------------------------------------------------pseudo_mini_loss sum 65.57414245605469
Total (block generation + training)time/epoch 3.5372578144073485
Training time/epoch 3.3611879348754883
Training time without block to device /epoch 3.360905408859253
Training time without total dataloading part /epoch 2.629965305328369
load block tensor time/epoch 0.0038726329803466797
block to device time/epoch 0.00028252601623535156
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1997
Number of first layer input nodes during this epoch:  1367
Number of first layer output nodes during this epoch:  630
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606196403503418  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0030623277028401694
pseudo mini batch 0 input nodes size: 1358
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606116771697998  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613366603851318  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.613368034362793  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.60606336593628  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606090068817139  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606090068817139  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

first layer input nodes number: 1358
first layer output nodes number: 631
edges number: 2929
torch.Size([1358, 1433])
torch.Size([631, 8192])
torch.Size([140, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.207043170928955  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 9.207047939300537  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 8.606143474578857  GigaBytes
Max Memory Allocated: 13.187440872192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005312204360961914 |0.000431060791015625 |0.5072784423828125 |0.00017499923706054688 |1.9313149452209473 |0.19191765785217285 |
----------------------------------------------------------pseudo_mini_loss sum 48.93443298339844
Total (block generation + training)time/epoch 3.5086059967676797
Training time/epoch 3.362638235092163
Training time without block to device /epoch 3.3622071743011475
Training time without total dataloading part /epoch 2.630686044692993
load block tensor time/epoch 0.005312204360961914
block to device time/epoch 0.000431060791015625
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  1989
Number of first layer input nodes during this epoch:  1358
Number of first layer output nodes during this epoch:  631
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=8192, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=8192, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(8192, 8192, batch_first=True)
      (fc_self): Linear(in_features=8192, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=8192, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  576968784
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([8192, 1433])
layers.0.fc_neigh.weight, torch.Size([8192, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([32768, 8192])
layers.1.lstm.weight_hh_l0, torch.Size([32768, 8192])
layers.1.lstm.bias_ih_l0, torch.Size([32768])
layers.1.lstm.bias_hh_l0, torch.Size([32768])
layers.1.fc_self.weight, torch.Size([7, 8192])
layers.1.fc_neigh.weight, torch.Size([7, 8192])
----------------------------------------
un-trainable parameters
