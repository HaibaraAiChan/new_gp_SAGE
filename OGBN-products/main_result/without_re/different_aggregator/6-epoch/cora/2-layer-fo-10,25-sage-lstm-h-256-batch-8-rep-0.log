main start at this time 1656402550.997223
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012979507446289062
global_2_local spend time (sec) 0.0001506805419921875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006680488586425781
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 488, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0004942417144775391
auxiliary_graph
Graph(num_nodes=628, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0008077621459960938
remove nodes length  488

auxiliary_graph.remove_nodes spent  0.0020439624786376953
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0010209083557128906

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.001 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.003101825714111328
18
17
18
17
18
18
17
17
total k batches seeds list generation spend  0.01421046257019043
after graph partition
graph partition algorithm spend time 0.07389116287231445
18
17
18
17
18
18
17
17
partition_len_list
[92, 92, 104, 59, 96, 57, 62, 85]
REG selection method  spend 0.07426047325134277
time for parepare:  5.507469177246094e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.3855438232421875e-05
----------------------check_connections_block total spend ----------------------------- 0.0017290115356445312
generate_one_block  0.0026254653930664062
generate_one_block  0.0010831356048583984
generate_one_block  0.0010578632354736328
generate_one_block  0.0010678768157958984
generate_one_block  0.0011372566223144531
generate_one_block  0.0010864734649658203
generate_one_block  0.001077890396118164
generate_one_block  0.0010561943054199219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005702972412109375
gen group dst list time:  6.818771362304688e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00018644332885742188
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00021386146545410156
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001647472381591797
----------------------check_connections_block total spend ----------------------------- 0.0032858848571777344
generate_one_block  0.0012497901916503906
generate_one_block  0.001249074935913086
generate_one_block  0.001241445541381836
generate_one_block  0.0011415481567382812
generate_one_block  0.0013196468353271484
generate_one_block  0.0011358261108398438
generate_one_block  0.0011219978332519531
generate_one_block  0.0012319087982177734
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

connection checking time:  0.005014896392822266
block generation total time  0.019883394241333008
average batch blocks generation time:  0.001242712140083313
block dataloader generation time/epoch 0.10970520973205566
pseudo mini batch 0 input nodes size: 301
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06725025177001953  GigaBytes
Max Memory Allocated: 0.06725025177001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06885719299316406  GigaBytes
Max Memory Allocated: 0.06885719299316406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06885766983032227  GigaBytes
Max Memory Allocated: 0.06885766983032227  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.06885766983032227  GigaBytes
Max Memory Allocated: 0.06885766983032227  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.0688624382019043  GigaBytes
Max Memory Allocated: 0.0688624382019043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.0688624382019043  GigaBytes
Max Memory Allocated: 0.0688624382019043  GigaBytes

first layer input nodes number: 301
first layer output nodes number: 92
edges number: 492
torch.Size([301, 1433])
torch.Size([92, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.11193990707397461  GigaBytes
Max Memory Allocated: 0.11393022537231445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.11194133758544922  GigaBytes
Max Memory Allocated: 0.11393022537231445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1361246109008789  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

pseudo mini batch 1 input nodes size: 260
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1374974250793457  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1374979019165039  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.13589048385620117  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1358952522277832  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.1358952522277832  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

first layer input nodes number: 260
first layer output nodes number: 92
edges number: 472
torch.Size([260, 1433])
torch.Size([92, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.17725563049316406  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4393310546875 GB
    Memory Allocated: 0.17725658416748047  GigaBytes
Max Memory Allocated: 0.23772668838500977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13590574264526367  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

pseudo mini batch 2 input nodes size: 289
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13589048385620117  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13589048385620117  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1374974250793457  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1374979019165039  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

first layer input nodes number: 289
first layer output nodes number: 104
edges number: 478
torch.Size([289, 1433])
torch.Size([104, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17843055725097656  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17843151092529297  GigaBytes
Max Memory Allocated: 0.29832935333251953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361246109008789  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

pseudo mini batch 3 input nodes size: 126
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13678216934204102  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13517522811889648  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351780891418457  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1351780891418457  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

first layer input nodes number: 126
first layer output nodes number: 59
edges number: 224
torch.Size([126, 1433])
torch.Size([59, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15549135208129883  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15549230575561523  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13518476486206055  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

pseudo mini batch 4 input nodes size: 227
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13517522811889648  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13517522811889648  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13678216934204102  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13678264617919922  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

first layer input nodes number: 227
first layer output nodes number: 96
edges number: 476
torch.Size([227, 1433])
torch.Size([96, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17821550369262695  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17821645736694336  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361241340637207  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

pseudo mini batch 5 input nodes size: 146
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13688898086547852  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13688945770263672  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13528203964233398  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352849006652832  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352849006652832  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

first layer input nodes number: 146
first layer output nodes number: 57
edges number: 221
torch.Size([146, 1433])
torch.Size([57, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1550440788269043  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1550450325012207  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13529205322265625  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

pseudo mini batch 6 input nodes size: 149
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13528203964233398  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13528203964233398  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.136077880859375  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1360783576965332  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352982521057129  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1353011131286621  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1353011131286621  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

first layer input nodes number: 149
first layer output nodes number: 62
edges number: 252
torch.Size([149, 1433])
torch.Size([62, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.15781879425048828  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1578197479248047  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13530826568603516  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

pseudo mini batch 7 input nodes size: 253
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352982521057129  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1352982521057129  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13690519332885742  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13690567016601562  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361093521118164  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.13611412048339844  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

first layer input nodes number: 253
first layer output nodes number: 85
edges number: 429
torch.Size([253, 1433])
torch.Size([85, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17368602752685547  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.17368698120117188  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5018310546875 GB
    Memory Allocated: 0.1361241340637207  GigaBytes
Max Memory Allocated: 0.29994916915893555  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015942543745040894 |0.043767839670181274 |0.0871945321559906 |0.00013425946235656738 |0.027896881103515625 |0.006300210952758789 |
----------------------------------------------------------pseudo_mini_loss sum 1.945300579071045
Total (block generation + training)time/epoch 1.561014175415039
Training time/epoch 1.4510016441345215
Training time without block to device /epoch 1.1008589267730713
Training time without total dataloading part /epoch 0.9281055927276611
load block tensor time/epoch 0.12754034996032715
block to device time/epoch 0.3501427173614502
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2398
Number of first layer input nodes during this epoch:  1751
Number of first layer output nodes during this epoch:  647
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27062416076660156  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006453990936279297
global_2_local spend time (sec) 0.0001251697540283203
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00026535987854003906
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 493, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 11: 1, 21: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00013303756713867188
auxiliary_graph
Graph(num_nodes=633, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004031658172607422
remove nodes length  493

auxiliary_graph.remove_nodes spent  0.0012831687927246094
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=430,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006797313690185547

the counter of shared neighbor distribution
Counter({1.0: 244, 2.0: 30, 3.0: 14, 4.0: 2})
290
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0026040077209472656
18
18
17
18
17
18
17
17
total k batches seeds list generation spend  0.007232189178466797
after graph partition
graph partition algorithm spend time 0.0559849739074707
18
18
17
18
17
18
17
17
partition_len_list
[84, 87, 77, 71, 94, 84, 91, 63]
REG selection method  spend 0.056268930435180664
time for parepare:  7.081031799316406e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.147125244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0020241737365722656
generate_one_block  0.002373218536376953
generate_one_block  0.001313924789428711
generate_one_block  0.0012514591217041016
generate_one_block  0.0012450218200683594
generate_one_block  0.0012753009796142578
generate_one_block  0.001255035400390625
generate_one_block  0.0012655258178710938
generate_one_block  0.0013613700866699219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005979537963867188
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00016880035400390625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002269744873046875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00019693374633789062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001342296600341797
----------------------check_connections_block total spend ----------------------------- 0.004041910171508789
generate_one_block  0.0014922618865966797
generate_one_block  0.001466989517211914
generate_one_block  0.0014243125915527344
generate_one_block  0.001386404037475586
generate_one_block  0.0014710426330566406
generate_one_block  0.0014352798461914062
generate_one_block  0.0013592243194580078
generate_one_block  0.0010917186737060547
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27062416076660156  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

connection checking time:  0.006066083908081055
block generation total time  0.022468090057373047
average batch blocks generation time:  0.0014042556285858154
block dataloader generation time/epoch 0.10204517841339111
pseudo mini batch 0 input nodes size: 279
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2720985412597656  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.27209901809692383  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2704916000366211  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2704963684082031  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2704963684082031  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

first layer input nodes number: 279
first layer output nodes number: 84
edges number: 471
torch.Size([279, 1433])
torch.Size([84, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3116021156311035  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.3116035461425781  GigaBytes
Max Memory Allocated: 0.36437463760375977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2705078125  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

pseudo mini batch 1 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2704925537109375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2704925537109375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27209949493408203  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27209997177124023  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

first layer input nodes number: 240
first layer output nodes number: 87
edges number: 412
torch.Size([240, 1433])
torch.Size([87, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.306976318359375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.3069772720336914  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

pseudo mini batch 2 input nodes size: 229
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2718324661254883  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2718329429626465  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27022552490234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2702293395996094  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2702293395996094  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

first layer input nodes number: 229
first layer output nodes number: 77
edges number: 356
torch.Size([229, 1433])
torch.Size([77, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.30156612396240234  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.30156707763671875  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27023839950561523  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

pseudo mini batch 3 input nodes size: 179
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27022552490234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27022552490234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2711811065673828  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.271181583404541  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26995849609375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2699623107910156  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2699623107910156  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

first layer input nodes number: 179
first layer output nodes number: 71
edges number: 275
torch.Size([179, 1433])
torch.Size([71, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2945833206176758  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2945842742919922  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2699708938598633  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

pseudo mini batch 4 input nodes size: 208
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26995849609375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.26995849609375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27156543731689453  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27156591415405273  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

first layer input nodes number: 208
first layer output nodes number: 94
edges number: 484
torch.Size([208, 1433])
torch.Size([94, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.31329822540283203  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.31329917907714844  GigaBytes
Max Memory Allocated: 0.4328422546386719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

pseudo mini batch 5 input nodes size: 221
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2717900276184082  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2717905044555664  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27018308639526367  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2701878547668457  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2701878547668457  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 221
first layer output nodes number: 84
edges number: 396
torch.Size([221, 1433])
torch.Size([84, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.3050694465637207  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.3050704002380371  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27019786834716797  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

pseudo mini batch 6 input nodes size: 232
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27018308639526367  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27018308639526367  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2717900276184082  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2717905044555664  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 232
first layer output nodes number: 91
edges number: 400
torch.Size([232, 1433])
torch.Size([91, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.30644893646240234  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.30644989013671875  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

pseudo mini batch 7 input nodes size: 158
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2714533805847168  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.271453857421875  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26984643936157227  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2698493003845215  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2698493003845215  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 158
first layer output nodes number: 63
edges number: 248
torch.Size([158, 1433])
torch.Size([63, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2919759750366211  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2919769287109375  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26985645294189453  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26985645294189453  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26985645294189453  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015730232000350952 |0.00039318203926086426 |0.02665761113166809 |0.00010323524475097656 |0.025258004665374756 |0.0038576126098632812 |
----------------------------------------------------------pseudo_mini_loss sum 4.081182956695557
Total (block generation + training)time/epoch 1.124308705329895
Training time/epoch 0.5930740833282471
Training time without block to device /epoch 0.5899286270141602
Training time without total dataloading part /epoch 0.42000842094421387
load block tensor time/epoch 0.12584185600280762
block to device time/epoch 0.003145456314086914
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2397
Number of first layer input nodes during this epoch:  1746
Number of first layer output nodes during this epoch:  651
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26985597610473633  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007610321044921875
global_2_local spend time (sec) 0.00012111663818359375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00026106834411621094
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 8: 3, 10: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001347064971923828
auxiliary_graph
Graph(num_nodes=629, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0003924369812011719
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0007431507110595703
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=432,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006630420684814453

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 12, 4.0: 2})
292
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002534151077270508
17
18
18
17
17
18
18
17
total k batches seeds list generation spend  0.006543636322021484
after graph partition
graph partition algorithm spend time 0.04894399642944336
17
18
18
17
17
18
18
17
partition_len_list
[69, 83, 125, 77, 90, 74, 78, 58]
REG selection method  spend 0.04923653602600098
time for parepare:  6.771087646484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.00543212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0021288394927978516
generate_one_block  0.0016427040100097656
generate_one_block  0.001287221908569336
generate_one_block  0.0012981891632080078
generate_one_block  0.0012547969818115234
generate_one_block  0.0012755393981933594
generate_one_block  0.0012583732604980469
generate_one_block  0.0012598037719726562
generate_one_block  0.0011265277862548828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005967617034912109
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00017070770263671875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002105236053466797
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001766681671142578
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001232624053955078
----------------------check_connections_block total spend ----------------------------- 0.0040760040283203125
generate_one_block  0.0014519691467285156
generate_one_block  0.0018124580383300781
generate_one_block  0.0015785694122314453
generate_one_block  0.0013942718505859375
generate_one_block  0.0014808177947998047
generate_one_block  0.0014088153839111328
generate_one_block  0.0012052059173583984
generate_one_block  0.0010704994201660156
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26985597610473633  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

connection checking time:  0.006204843521118164
block generation total time  0.021805763244628906
average batch blocks generation time:  0.0013628602027893066
block dataloader generation time/epoch 0.09748212496439616
pseudo mini batch 0 input nodes size: 207
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26984548568725586  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.26984548568725586  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2714524269104004  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2714529037475586  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2706127166748047  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2706127166748047  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 207
first layer output nodes number: 69
edges number: 331
torch.Size([207, 1433])
torch.Size([69, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2998313903808594  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.299832820892334  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

pseudo mini batch 1 input nodes size: 280
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27210474014282227  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27210521697998047  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27049779891967773  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27050256729125977  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27050256729125977  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 280
first layer output nodes number: 83
edges number: 445
torch.Size([280, 1433])
torch.Size([83, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.30944347381591797  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.3094444274902344  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27051305770874023  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

pseudo mini batch 2 input nodes size: 340
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27049779891967773  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27049779891967773  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27231311798095703  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27231359481811523  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27081823348999023  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27082395553588867  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27082395553588867  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

first layer input nodes number: 340
first layer output nodes number: 125
edges number: 618
torch.Size([340, 1433])
torch.Size([125, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.3251800537109375  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.3251810073852539  GigaBytes
Max Memory Allocated: 0.43465614318847656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27083587646484375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 3 input nodes size: 173
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27081823348999023  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27081823348999023  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2717418670654297  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2717423439025879  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2699265480041504  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.269930362701416  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.269930362701416  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 173
first layer output nodes number: 77
edges number: 313
torch.Size([173, 1433])
torch.Size([77, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2978367805480957  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2978377342224121  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26993894577026367  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 4 input nodes size: 226
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2699265480041504  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2699265480041504  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2715334892272949  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2715339660644531  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 226
first layer output nodes number: 90
edges number: 457
torch.Size([226, 1433])
torch.Size([90, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3109002113342285  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3109011650085449  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 5 input nodes size: 208
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27172040939331055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27172088623046875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.270113468170166  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27011728286743164  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27011728286743164  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 208
first layer output nodes number: 74
edges number: 335
torch.Size([208, 1433])
torch.Size([74, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.299649715423584  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2996506690979004  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2701263427734375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 6 input nodes size: 183
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.270113468170166  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.270113468170166  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27172040939331055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27172088623046875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 183
first layer output nodes number: 78
edges number: 344
torch.Size([183, 1433])
torch.Size([78, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30111217498779297  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3011131286621094  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062225341796875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 7 input nodes size: 144
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2713789939880371  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2713794708251953  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2697720527648926  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2697749137878418  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2697749137878418  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 144
first layer output nodes number: 58
edges number: 223
torch.Size([144, 1433])
torch.Size([58, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2899613380432129  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2899622917175293  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26978206634521484  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26978206634521484  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26978206634521484  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01569417119026184 |0.0004826784133911133 |0.028666049242019653 |0.0001068115234375 |0.02735474705696106 |0.004060268402099609 |
----------------------------------------------------------pseudo_mini_loss sum 4.9083075523376465
Total (block generation + training)time/epoch 0.9872411886850992
Training time/epoch 0.6246068477630615
Training time without block to device /epoch 0.6207454204559326
Training time without total dataloading part /epoch 0.4530811309814453
load block tensor time/epoch 0.12555336952209473
block to device time/epoch 0.0038614273071289062
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2415
Number of first layer input nodes during this epoch:  1761
Number of first layer output nodes during this epoch:  654
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26978158950805664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007936954498291016
global_2_local spend time (sec) 0.00017213821411132812
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003540515899658203
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 489, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.00017523765563964844
auxiliary_graph
Graph(num_nodes=629, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0004150867462158203
remove nodes length  489

auxiliary_graph.remove_nodes spent  0.0007538795471191406
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006804466247558594

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0026178359985351562
18
16
18
18
17
17
18
18
total k batches seeds list generation spend  0.007087230682373047
after graph partition
graph partition algorithm spend time 0.04713082313537598
18
16
18
18
17
17
18
18
partition_len_list
[79, 96, 76, 66, 90, 74, 90, 85]
REG selection method  spend 0.04745793342590332
time for parepare:  6.079673767089844e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.719329833984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0017158985137939453
generate_one_block  0.0014715194702148438
generate_one_block  0.0010957717895507812
generate_one_block  0.0010552406311035156
generate_one_block  0.0010464191436767578
generate_one_block  0.0011794567108154297
generate_one_block  0.0011582374572753906
generate_one_block  0.0010714530944824219
generate_one_block  0.001064300537109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005083084106445312
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.00012493133544921875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00019502639770507812
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001773834228515625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001513957977294922
----------------------check_connections_block total spend ----------------------------- 0.00336456298828125
generate_one_block  0.0012390613555908203
generate_one_block  0.0015354156494140625
generate_one_block  0.0012035369873046875
generate_one_block  0.0011515617370605469
generate_one_block  0.001218557357788086
generate_one_block  0.0012028217315673828
generate_one_block  0.0012180805206298828
generate_one_block  0.0011899471282958984
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26978158950805664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

connection checking time:  0.005080461502075195
block generation total time  0.019101381301879883
average batch blocks generation time:  0.0011938363313674927
block dataloader generation time/epoch 0.09375202655792236
pseudo mini batch 0 input nodes size: 250
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26977109909057617  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26977109909057617  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2713780403137207  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2713785171508789  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 250
first layer output nodes number: 79
edges number: 409
torch.Size([250, 1433])
torch.Size([79, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30651235580444336  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30651378631591797  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 1 input nodes size: 255
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2719712257385254  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2719717025756836  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27036428451538086  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2703690528869629  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2703690528869629  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 255
first layer output nodes number: 96
edges number: 479
torch.Size([255, 1433])
torch.Size([96, 256])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3124427795410156  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.31244373321533203  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27037906646728516  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 2 input nodes size: 215
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27036428451538086  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27036428451538086  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2719712257385254  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2719717025756836  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 215
first layer output nodes number: 76
edges number: 342
torch.Size([215, 1433])
torch.Size([76, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30083608627319336  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30083703994750977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 3 input nodes size: 166
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2714962959289551  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2714967727661133  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26988935470581055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26989316940307617  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26989316940307617  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 166
first layer output nodes number: 66
edges number: 257
torch.Size([166, 1433])
torch.Size([66, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2928643226623535  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2928652763366699  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26990175247192383  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 4 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26988935470581055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26988935470581055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2714962959289551  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2714967727661133  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 216
first layer output nodes number: 90
edges number: 444
torch.Size([216, 1433])
torch.Size([90, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30994653701782227  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30994749069213867  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 5 input nodes size: 203
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27169370651245117  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2716941833496094  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27008676528930664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27009057998657227  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27009057998657227  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 203
first layer output nodes number: 74
edges number: 365
torch.Size([203, 1433])
torch.Size([74, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3023104667663574  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30231142044067383  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2700996398925781  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 6 input nodes size: 228
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27008676528930664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27008676528930664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27169370651245117  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2716941833496094  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 228
first layer output nodes number: 90
edges number: 418
torch.Size([228, 1433])
torch.Size([90, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3074655532836914  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3074665069580078  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 7 input nodes size: 221
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2717900276184082  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2717905044555664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27018308639526367  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2701869010925293  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2701869010925293  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 221
first layer output nodes number: 85
edges number: 362
torch.Size([221, 1433])
torch.Size([85, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30237531661987305  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30237627029418945  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27019596099853516  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27019596099853516  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27019596099853516  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015812397003173828 |0.0003679990768432617 |0.02814847230911255 |0.00010162591934204102 |0.025912225246429443 |0.003952980041503906 |
----------------------------------------------------------pseudo_mini_loss sum 10.38503646850586
Total (block generation + training)time/epoch 0.9150363802909851
Training time/epoch 0.6157138347625732
Training time without block to device /epoch 0.6127698421478271
Training time without total dataloading part /epoch 0.43725156784057617
load block tensor time/epoch 0.12649917602539062
block to device time/epoch 0.0029439926147460938
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2410
Number of first layer input nodes during this epoch:  1754
Number of first layer output nodes during this epoch:  656
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27019548416137695  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006263256072998047
global_2_local spend time (sec) 0.00012946128845214844
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002639293670654297
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 490, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 25: 2, 12: 2, 21: 1, 11: 1, 19: 1})

A = g.adjacency_matrix() spent  0.0001437664031982422
auxiliary_graph
Graph(num_nodes=630, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.000396728515625
remove nodes length  490

auxiliary_graph.remove_nodes spent  0.0016756057739257812
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006983280181884766

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 12, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002667665481567383
18
17
18
17
16
18
18
18
total k batches seeds list generation spend  0.007743358612060547
after graph partition
graph partition algorithm spend time 0.034543752670288086
18
17
18
17
16
18
18
18
partition_len_list
[103, 84, 89, 66, 68, 81, 100, 72]
REG selection method  spend 0.03490948677062988
time for parepare:  0.00012540817260742188
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00011157989501953125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.003604412078857422
generate_one_block  0.003002643585205078
generate_one_block  0.0015482902526855469
generate_one_block  0.0014979839324951172
generate_one_block  0.0014700889587402344
generate_one_block  0.0014696121215820312
generate_one_block  0.0014238357543945312
generate_one_block  0.0010914802551269531
generate_one_block  0.0010762214660644531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006482601165771484
gen group dst list time:  5.984306335449219e-05
time for parepare:  0.00013446807861328125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002257823944091797
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011849403381347656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015211105346679688
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001399517059326172
----------------------check_connections_block total spend ----------------------------- 0.0034041404724121094
generate_one_block  0.0013430118560791016
generate_one_block  0.0015385150909423828
generate_one_block  0.001255035400390625
generate_one_block  0.0011560916900634766
generate_one_block  0.001165151596069336
generate_one_block  0.00119781494140625
generate_one_block  0.0012638568878173828
generate_one_block  0.0011949539184570312
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27019548416137695  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

connection checking time:  0.007008552551269531
block generation total time  0.02269458770751953
average batch blocks generation time:  0.0014184117317199707
block dataloader generation time/epoch 0.08997859954833984
pseudo mini batch 0 input nodes size: 328
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27018213272094727  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27018213272094727  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27193355560302734  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27193403244018555  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2707533836364746  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27075910568237305  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27075910568237305  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 328
first layer output nodes number: 103
edges number: 599
torch.Size([328, 1433])
torch.Size([103, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.32291460037231445  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.32291603088378906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27077198028564453  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 1 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.270754337310791  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.270754337310791  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27236127853393555  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27236175537109375  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 240
first layer output nodes number: 84
edges number: 367
torch.Size([240, 1433])
torch.Size([84, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3032546043395996  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.303255558013916  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 2 input nodes size: 277
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27208900451660156  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27208948135375977  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27048206329345703  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27048683166503906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27048683166503906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 277
first layer output nodes number: 89
edges number: 426
torch.Size([277, 1433])
torch.Size([89, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30800676345825195  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.30800771713256836  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27049732208251953  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 3 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27048206329345703  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27048206329345703  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2713203430175781  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27132081985473633  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26984405517578125  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26984405517578125  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 157
first layer output nodes number: 66
edges number: 255
torch.Size([157, 1433])
torch.Size([66, 256])
torch.Size([17, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2926783561706543  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2926793098449707  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2698516845703125  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 4 input nodes size: 172
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26984119415283203  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27075958251953125  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27076005935668945  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26992130279541016  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2699251174926758  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2699251174926758  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 172
first layer output nodes number: 68
edges number: 274
torch.Size([172, 1433])
torch.Size([68, 256])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2943563461303711  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2943572998046875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26993370056152344  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 5 input nodes size: 222
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26992130279541016  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.26992130279541016  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2715282440185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2715287208557129  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 222
first layer output nodes number: 81
edges number: 347
torch.Size([222, 1433])
torch.Size([81, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.301389217376709  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3013901710510254  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 6 input nodes size: 225
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27181100845336914  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27181148529052734  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2702040672302246  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27020883560180664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27020883560180664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 225
first layer output nodes number: 100
edges number: 506
torch.Size([225, 1433])
torch.Size([100, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.314847469329834  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3148484230041504  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2702188491821289  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

pseudo mini batch 7 input nodes size: 183
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2702040672302246  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2702040672302246  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27181100845336914  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27181148529052734  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 183
first layer output nodes number: 72
edges number: 333
torch.Size([183, 1433])
torch.Size([72, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3000631332397461  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3000640869140625  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062225341796875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062225341796875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062225341796875  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014971554279327393 |0.00045675039291381836 |0.02643674612045288 |0.00010696053504943848 |0.024586379528045654 |0.0038771629333496094 |
----------------------------------------------------------pseudo_mini_loss sum 10.091753005981445
Total (block generation + training)time/epoch 0.8639025211334228
Training time/epoch 0.5843391418457031
Training time without block to device /epoch 0.5806851387023926
Training time without total dataloading part /epoch 0.4129178524017334
load block tensor time/epoch 0.11977243423461914
block to device time/epoch 0.003654003143310547
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2467
Number of first layer input nodes during this epoch:  1804
Number of first layer output nodes during this epoch:  663
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062177658081055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006017684936523438
global_2_local spend time (sec) 0.00012111663818359375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0002639293670654297
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 491, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 10: 3, 8: 3, 12: 2, 25: 2, 19: 1, 11: 1, 21: 1})

A = g.adjacency_matrix() spent  0.0001361370086669922
auxiliary_graph
Graph(num_nodes=631, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00039768218994140625
remove nodes length  491

auxiliary_graph.remove_nodes spent  0.0007190704345703125
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=434,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0006718635559082031

the counter of shared neighbor distribution
Counter({1.0: 248, 2.0: 30, 3.0: 14, 4.0: 2})
294
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0025467872619628906
18
16
16
18
18
18
18
18
total k batches seeds list generation spend  0.0066912174224853516
after graph partition
graph partition algorithm spend time 0.06653308868408203
18
16
16
18
18
18
18
18
partition_len_list
[126, 76, 78, 69, 101, 65, 69, 75]
REG selection method  spend 0.06679773330688477
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0017383098602294922
generate_one_block  0.001405954360961914
generate_one_block  0.0010924339294433594
generate_one_block  0.001062154769897461
generate_one_block  0.0010478496551513672
generate_one_block  0.0010955333709716797
generate_one_block  0.0010557174682617188
generate_one_block  0.001058340072631836
generate_one_block  0.0010704994201660156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006330013275146484
gen group dst list time:  5.793571472167969e-05
time for parepare:  0.00013780593872070312
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002665519714355469
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.000156402587890625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002014636993408203
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001575946807861328
----------------------check_connections_block total spend ----------------------------- 0.0035626888275146484
generate_one_block  0.0013799667358398438
generate_one_block  0.0015277862548828125
generate_one_block  0.0012135505676269531
generate_one_block  0.0011661052703857422
generate_one_block  0.0012919902801513672
generate_one_block  0.0011584758758544922
generate_one_block  0.001165151596069336
generate_one_block  0.0011992454528808594
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27062177658081055  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

connection checking time:  0.005300998687744141
block generation total time  0.018990755081176758
average batch blocks generation time:  0.0011869221925735474
block dataloader generation time/epoch 0.09173667430877686
pseudo mini batch 0 input nodes size: 361
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27060890197753906  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2725362777709961  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2725367546081543  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27092933654785156  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2709360122680664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2709360122680664  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

first layer input nodes number: 361
first layer output nodes number: 126
edges number: 669
torch.Size([361, 1433])
torch.Size([126, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.329742431640625  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.3297438621520996  GigaBytes
Max Memory Allocated: 0.44534969329833984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2709498405456543  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 1 input nodes size: 241
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27093029022216797  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27093029022216797  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2725372314453125  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2725377082824707  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 241
first layer output nodes number: 76
edges number: 400
torch.Size([241, 1433])
torch.Size([76, 256])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.30562686920166016  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.30562782287597656  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 2 input nodes size: 223
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27180051803588867  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2718009948730469  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27019357681274414  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27019739151000977  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27019739151000977  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 223
first layer output nodes number: 78
edges number: 362
torch.Size([223, 1433])
torch.Size([78, 256])
torch.Size([16, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.30225706100463867  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3022580146789551  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2702064514160156  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 3 input nodes size: 170
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27019357681274414  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27019357681274414  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2711014747619629  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2711019515991211  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699108123779297  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699146270751953  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699146270751953  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 170
first layer output nodes number: 69
edges number: 263
torch.Size([170, 1433])
torch.Size([69, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2934908866882324  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.29349184036254883  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26992321014404297  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 4 input nodes size: 251
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699108123779297  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699108123779297  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2715177536010742  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2715182304382324  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706146240234375  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 251
first layer output nodes number: 101
edges number: 509
torch.Size([251, 1433])
torch.Size([101, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3154764175415039  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3154773712158203  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27062463760375977  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 5 input nodes size: 183
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27158689498901367  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2715873718261719  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26997995376586914  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26998281478881836  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26998281478881836  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 183
first layer output nodes number: 65
edges number: 251
torch.Size([183, 1433])
torch.Size([65, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2924175262451172  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2924184799194336  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2699904441833496  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 6 input nodes size: 158
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26997995376586914  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26997995376586914  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27082347869873047  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27082395553588867  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26984643936157227  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2698502540588379  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2698502540588379  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 158
first layer output nodes number: 69
edges number: 282
torch.Size([158, 1433])
torch.Size([69, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2951979637145996  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.295198917388916  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26985883712768555  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

pseudo mini batch 7 input nodes size: 218
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26984643936157227  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.26984643936157227  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2714533805847168  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.271453857421875  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27060985565185547  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706136703491211  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

first layer input nodes number: 218
first layer output nodes number: 75
edges number: 355
torch.Size([218, 1433])
torch.Size([75, 256])
torch.Size([18, 7])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.3018679618835449  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.30186891555786133  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.27062273025512695  GigaBytes
Max Memory Allocated: 0.4492621421813965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015585899353027344 |0.00039312243461608887 |0.026890814304351807 |0.00010263919830322266 |0.026830822229385376 |0.0038640499114990234 |
----------------------------------------------------------pseudo_mini_loss sum 5.512401103973389
Total (block generation + training)time/epoch 0.838068683942159
Training time/epoch 0.6082267761230469
Training time without block to device /epoch 0.6050817966461182
Training time without total dataloading part /epoch 0.43445825576782227
load block tensor time/epoch 0.12468719482421875
block to device time/epoch 0.003144979476928711
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  2464
Number of first layer input nodes during this epoch:  1805
Number of first layer output nodes during this epoch:  659
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  17702992
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([7, 256])
layers.1.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
