main start at this time 1656227639.1740227
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.764228105545044
pseudo mini batch 0 input nodes size: 1829322
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.6819210052490234  GigaBytes
Max Memory Allocated: 0.6819210052490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.6833858489990234  GigaBytes
Max Memory Allocated: 0.6833858489990234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.6833858489990234  GigaBytes
Max Memory Allocated: 0.6833858489990234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.8063907623291016  GigaBytes
Max Memory Allocated: 0.8063907623291016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.8063907623291016  GigaBytes
Max Memory Allocated: 0.8063907623291016  GigaBytes

first layer input nodes number: 1829322
first layer output nodes number: 1205785
edges number: 11702596
torch.Size([1829322, 100])
torch.Size([1205785, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3299560546875 GB
    Memory Allocated: 4.251471042633057  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3299560546875 GB
    Memory Allocated: 4.285889625549316  GigaBytes
Max Memory Allocated: 5.108603000640869  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.031641960144043  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.0322027206420898  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.0322027206420898  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.31353139877319336 |0.44933104515075684 |0.7953753471374512 |0.00023698806762695312 |0.07454609870910645 |0.0026464462280273438 |
----------------------------------------------------------pseudo_mini_loss sum 6.257230758666992
Total (block generation + training)time/epoch 2.4496829509735107
Training time/epoch 1.6851694583892822
Training time without block to device /epoch 1.2358384132385254
Training time without total dataloading part /epoch 0.8728048801422119
load block tensor time/epoch 0.31353139877319336
block to device time/epoch 0.44933104515075684
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3035107
Number of first layer input nodes during this epoch:  1829322
Number of first layer output nodes during this epoch:  1205785
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.0322022438049316  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.0322022438049316  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7918537855148315
pseudo mini batch 0 input nodes size: 1828621
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.3998594284057617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 1.4013242721557617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 0.8408641815185547  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6854248046875 GB
    Memory Allocated: 0.8408641815185547  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

first layer input nodes number: 1828621
first layer output nodes number: 1205023
edges number: 11697236
torch.Size([1828621, 100])
torch.Size([1205023, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6873779296875 GB
    Memory Allocated: 4.248867034912109  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6873779296875 GB
    Memory Allocated: 4.283285617828369  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313186645507812  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313186645507812  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313186645507812  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3234097957611084 |0.12126493453979492 |0.009613990783691406 |0.00016546249389648438 |0.0058286190032958984 |0.0010743141174316406 |
----------------------------------------------------------pseudo_mini_loss sum 3.4147837162017822
Total (block generation + training)time/epoch 1.9382168054580688
Training time/epoch 0.6070873737335205
Training time without block to device /epoch 0.4858224391937256
Training time without total dataloading part /epoch 0.01668238639831543
load block tensor time/epoch 0.3234097957611084
block to device time/epoch 0.12126493453979492
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3033644
Number of first layer input nodes during this epoch:  1828621
Number of first layer output nodes during this epoch:  1205023
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031318187713623  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031318187713623  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7868293126424154
pseudo mini batch 0 input nodes size: 1828630
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7182188034057617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.3998594284057617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.4013242721557617  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

first layer input nodes number: 1828630
first layer output nodes number: 1205451
edges number: 11699574
torch.Size([1828630, 100])
torch.Size([1205451, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.251816272735596  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.2862348556518555  GigaBytes
Max Memory Allocated: 6.369714260101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031785011291504  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031785011291504  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031785011291504  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2591116428375244 |0.10055661201477051 |0.008682012557983398 |0.00015425682067871094 |0.0032033920288085938 |0.0020656585693359375 |
----------------------------------------------------------pseudo_mini_loss sum 2.0486459732055664
Total (block generation + training)time/epoch 1.7241532802581787
Training time/epoch 0.5190725326538086
Training time without block to device /epoch 0.4185159206390381
Training time without total dataloading part /epoch 0.01410531997680664
load block tensor time/epoch 0.2591116428375244
block to device time/epoch 0.10055661201477051
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3034081
Number of first layer input nodes during this epoch:  1828630
Number of first layer output nodes during this epoch:  1205451
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0317845344543457  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0317845344543457  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7849012017250061
pseudo mini batch 0 input nodes size: 1828797
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.3999247550964355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.4013895988464355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8409266471862793  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8409266471862793  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

first layer input nodes number: 1828797
first layer output nodes number: 1205102
edges number: 11696870
torch.Size([1828797, 100])
torch.Size([1205102, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.2490973472595215  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.283515930175781  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313796997070312  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313796997070312  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0313796997070312  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.25518369674682617 |0.11094999313354492 |0.00849151611328125 |0.00018477439880371094 |0.0030715465545654297 |0.0072858333587646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.6036854982376099
Total (block generation + training)time/epoch 1.619608461856842
Training time/epoch 0.526688814163208
Training time without block to device /epoch 0.4157388210296631
Training time without total dataloading part /epoch 0.01903367042541504
load block tensor time/epoch 0.25518369674682617
block to device time/epoch 0.11094999313354492
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3033899
Number of first layer input nodes during this epoch:  1828797
Number of first layer output nodes during this epoch:  1205102
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031379222869873  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.031379222869873  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.7909594058990479
pseudo mini batch 0 input nodes size: 1829214
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7182841300964355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.3999247550964355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.4013895988464355  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.7186446189880371  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 0.8413071632385254  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

first layer input nodes number: 1829214
first layer output nodes number: 1205475
edges number: 11699466
torch.Size([1829214, 100])
torch.Size([1205475, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.251826286315918  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 4.286244869232178  GigaBytes
Max Memory Allocated: 6.369968414306641  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0317893028259277  GigaBytes
Max Memory Allocated: 6.369978427886963  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0317893028259277  GigaBytes
Max Memory Allocated: 6.369978427886963  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.8377685546875 GB
    Memory Allocated: 1.0317893028259277  GigaBytes
Max Memory Allocated: 6.369978427886963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2608373165130615 |0.11665844917297363 |0.010531902313232422 |0.00013446807861328125 |0.003139019012451172 |0.002014636993408203 |
----------------------------------------------------------pseudo_mini_loss sum 1.4578744173049927
Total (block generation + training)time/epoch 1.5664777278900146
Training time/epoch 0.5385794639587402
Training time without block to device /epoch 0.4219210147857666
Training time without total dataloading part /epoch 0.015820026397705078
load block tensor time/epoch 0.2608373165130615
block to device time/epoch 0.11665844917297363
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 9.685754776000977e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3034689
Number of first layer input nodes during this epoch:  1829214
Number of first layer output nodes during this epoch:  1205475
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
