main start at this time 1655848177.0264947
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.34499430656433105
global_2_local spend time (sec) 0.42424678802490234
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.07695817947387695
A = g.adjacency_matrix() spent  0.11788201332092285
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.684349775314331
remove nodes length
1181171
auxiliary_graph.remove_nodes spent  5.621772527694702
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.323803901672363

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([        0,         1,         2,  ..., 101676969, 101676970,
        101676971])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
Convert a graph into a bidirected graph: 6.514 seconds
Metis partitioning: 22.693 seconds
Split the graph: 7.638 seconds
Construct subgraphs: 0.072 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  36.95993638038635
67099
65694
63778
total k batches seeds list generation spend  79.30114412307739
after graph partition
graph partition algorithm spend time 80.46858048439026
67099
65694
63778
partition_len_list
[493621, 561364, 516904]
shared_neighbor_graph_partition_s0 selection method  spend 81.15024018287659
time for parepare:  0.2777400016784668
local_output_nid generation:  0.009871959686279297
local_in_edges_tensor generation:  0.02806401252746582
mini_batch_src_global generation:  0.07799291610717773
r_  generation:  1.0257010459899902
local_output_nid generation:  0.012206077575683594
local_in_edges_tensor generation:  0.07353711128234863
mini_batch_src_global generation:  0.10427498817443848
r_  generation:  1.0846130847930908
local_output_nid generation:  0.013356447219848633
local_in_edges_tensor generation:  0.053337812423706055
mini_batch_src_global generation:  0.08456587791442871
r_  generation:  1.0870957374572754
----------------------check_connections_block total spend ----------------------------- 4.506336688995361
generate_one_block  2.7146096229553223
generate_one_block  1.3935730457305908
generate_one_block  1.4465057849884033
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.933100938796997
gen group dst list time:  0.04391813278198242
time for parepare:  0.45896458625793457
local_output_nid generation:  0.09606528282165527
local_in_edges_tensor generation:  0.36028623580932617
mini_batch_src_global generation:  0.3668699264526367
r_  generation:  4.883358001708984
local_output_nid generation:  0.12790822982788086
local_in_edges_tensor generation:  0.40317606925964355
mini_batch_src_global generation:  0.5995907783508301
r_  generation:  6.4309914112091064
local_output_nid generation:  0.1637265682220459
local_in_edges_tensor generation:  0.4296905994415283
mini_batch_src_global generation:  0.5913357734680176
r_  generation:  5.997541427612305
----------------------check_connections_block total spend ----------------------------- 23.955949783325195
generate_one_block  6.85732626914978
generate_one_block  8.221204996109009
generate_one_block  7.578638315200806
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1171796321868896
gen group dst list time:  0.12002110481262207
time for parepare:  0.4588487148284912
local_output_nid generation:  0.26250529289245605
local_in_edges_tensor generation:  0.6872878074645996
mini_batch_src_global generation:  0.6651740074157715
r_  generation:  9.334352731704712
local_output_nid generation:  0.3506143093109131
local_in_edges_tensor generation:  0.8138303756713867
mini_batch_src_global generation:  1.0794422626495361
r_  generation:  12.750680923461914
local_output_nid generation:  0.34765028953552246
local_in_edges_tensor generation:  0.6434986591339111
mini_batch_src_global generation:  1.0038576126098633
r_  generation:  11.35841703414917
----------------------check_connections_block total spend ----------------------------- 45.4718599319458
generate_one_block  12.554545164108276
generate_one_block  16.452375888824463
generate_one_block  14.04953384399414
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1034047603607178
gen group dst list time:  0.23000192642211914
time for parepare:  0.4706411361694336
local_output_nid generation:  0.5487039089202881
local_in_edges_tensor generation:  0.93658447265625
mini_batch_src_global generation:  0.5421900749206543
r_  generation:  9.0720796585083
local_output_nid generation:  0.6496801376342773
local_in_edges_tensor generation:  0.9294097423553467
mini_batch_src_global generation:  0.7216157913208008
r_  generation:  9.808460712432861
local_output_nid generation:  0.6065857410430908
local_in_edges_tensor generation:  0.8168010711669922
mini_batch_src_global generation:  0.6901328563690186
r_  generation:  9.021769523620605
----------------------check_connections_block total spend ----------------------------- 40.40617895126343
generate_one_block  11.553594589233398
generate_one_block  11.81924057006836
generate_one_block  11.113133907318115
----------===============-------------===============-------------the number of batches *****---- 3

original number of batches:  3
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  114.34032535552979
block generation total time  105.75428199768066
average batch blocks generation time:  8.812856833140055
block dataloader generation time/epoch 315.2084050178528
pseudo mini batch 0 input nodes size: 2146740
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.8009800910949707  GigaBytes
Max Memory Allocated: 0.8009800910949707  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.8014802932739258  GigaBytes
Max Memory Allocated: 0.8014802932739258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.8014802932739258  GigaBytes
Max Memory Allocated: 0.8014802932739258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 1.2006187438964844  GigaBytes
Max Memory Allocated: 1.2006187438964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 1.2006187438964844  GigaBytes
Max Memory Allocated: 1.2006187438964844  GigaBytes

first layer input nodes number: 2146740
first layer output nodes number: 1910846
edges number: 17284449
----------------------------------------before model layer 0
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.2308502197265625  GigaBytes
Max Memory Allocated: 1.2953033447265625  GigaBytes

torch.Size([2146740, 100])
----------------------------------------after rst
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 5.723370552062988  GigaBytes
Max Memory Allocated: 7.5456953048706055  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 3.901045799255371  GigaBytes
Max Memory Allocated: 7.5456953048706055  GigaBytes

torch.Size([1910846, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 5.723370552062988  GigaBytes
Max Memory Allocated: 7.5456953048706055  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 6.178951740264893  GigaBytes
Max Memory Allocated: 8.00127649307251  GigaBytes

input nodes number: 1910846
output nodes number: 1125771
edges number: 21589785
----------------------------------------before model layer 1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 6.2015767097473145  GigaBytes
Max Memory Allocated: 8.00127649307251  GigaBytes

torch.Size([1910846, 256])
----------------------------------------after rst
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 9.592878818511963  GigaBytes
Max Memory Allocated: 10.667097568511963  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 8.519259929656982  GigaBytes
Max Memory Allocated: 10.667097568511963  GigaBytes

torch.Size([1125771, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 9.593478679656982  GigaBytes
Max Memory Allocated: 10.667097568511963  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 9.861283779144287  GigaBytes
Max Memory Allocated: 10.935502529144287  GigaBytes

input nodes number: 1125771
output nodes number: 493621
edges number: 11881547
----------------------------------------before model layer 2
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 9.873349666595459  GigaBytes
Max Memory Allocated: 10.935502529144287  GigaBytes

torch.Size([1125771, 256])
----------------------------------------after rst
 Nvidia-smi: 14.7928466796875 GB
    Memory Allocated: 11.37786865234375  GigaBytes
Max Memory Allocated: 11.84862232208252  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 14.7928466796875 GB
    Memory Allocated: 10.90711498260498  GigaBytes
Max Memory Allocated: 11.84862232208252  GigaBytes

torch.Size([493621, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 14.7928466796875 GB
    Memory Allocated: 11.37786865234375  GigaBytes
Max Memory Allocated: 11.84862232208252  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 14.7928466796875 GB
    Memory Allocated: 11.495557308197021  GigaBytes
Max Memory Allocated: 11.966310977935791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.7947998046875 GB
    Memory Allocated: 11.602210521697998  GigaBytes
Max Memory Allocated: 11.966310977935791  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.7947998046875 GB
    Memory Allocated: 11.59046220779419  GigaBytes
Max Memory Allocated: 11.966310977935791  GigaBytes

torch.Size([67099, 47])
input nodes number: 493621
output nodes number: 67099
edges number: 2505133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.7947998046875 GB
    Memory Allocated: 11.606388568878174  GigaBytes
Max Memory Allocated: 11.966310977935791  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.7947998046875 GB
    Memory Allocated: 11.60638952255249  GigaBytes
Max Memory Allocated: 11.966310977935791  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.9744114875793457  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

pseudo mini batch 1 input nodes size: 2188029
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 0.8144865036010742  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 0.8144865036010742  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.6295909881591797  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.6300806999206543  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 0.829857349395752  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.3115458488464355  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.3115458488464355  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

first layer input nodes number: 2188029
first layer output nodes number: 2033628
edges number: 18498856
----------------------------------------before model layer 0
 Nvidia-smi: 21.5369873046875 GB
    Memory Allocated: 1.343472957611084  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

torch.Size([2188029, 100])
----------------------------------------after rst
 Nvidia-smi: 13.4256591796875 GB
    Memory Allocated: 6.125368595123291  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.4256591796875 GB
    Memory Allocated: 4.185915470123291  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

torch.Size([2033628, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.4256591796875 GB
    Memory Allocated: 6.125368595123291  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.9119873046875 GB
    Memory Allocated: 6.610223293304443  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

input nodes number: 2033628
output nodes number: 1387695
edges number: 28850602
----------------------------------------before model layer 1
 Nvidia-smi: 13.9119873046875 GB
    Memory Allocated: 6.635714530944824  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

torch.Size([2033628, 256])
----------------------------------------after rst
 Nvidia-smi: 18.1346435546875 GB
    Memory Allocated: 10.833226680755615  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 18.1346435546875 GB
    Memory Allocated: 9.509817600250244  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

torch.Size([1387695, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 18.1346435546875 GB
    Memory Allocated: 10.834036350250244  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 18.1346435546875 GB
    Memory Allocated: 11.164079189300537  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

input nodes number: 1387695
output nodes number: 561364
edges number: 14660171
----------------------------------------before model layer 2
 Nvidia-smi: 18.1346435546875 GB
    Memory Allocated: 11.178601264953613  GigaBytes
Max Memory Allocated: 12.49255657196045  GigaBytes

torch.Size([1387695, 256])
----------------------------------------after rst
 Nvidia-smi: 19.2088623046875 GB
    Memory Allocated: 12.898773193359375  GigaBytes
Max Memory Allocated: 13.434131622314453  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 19.2088623046875 GB
    Memory Allocated: 12.363414764404297  GigaBytes
Max Memory Allocated: 13.434131622314453  GigaBytes

torch.Size([561364, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 19.2088623046875 GB
    Memory Allocated: 12.898773193359375  GigaBytes
Max Memory Allocated: 13.434131622314453  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 19.2088623046875 GB
    Memory Allocated: 13.032612800598145  GigaBytes
Max Memory Allocated: 13.567971229553223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.2108154296875 GB
    Memory Allocated: 13.138670444488525  GigaBytes
Max Memory Allocated: 13.567971229553223  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.2108154296875 GB
    Memory Allocated: 13.126484394073486  GigaBytes
Max Memory Allocated: 13.567971229553223  GigaBytes

torch.Size([65694, 47])
input nodes number: 561364
output nodes number: 65694
edges number: 2481125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2108154296875 GB
    Memory Allocated: 13.130911350250244  GigaBytes
Max Memory Allocated: 13.567971229553223  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2108154296875 GB
    Memory Allocated: 13.130911827087402  GigaBytes
Max Memory Allocated: 13.567971229553223  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 2.2432703971862793  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

pseudo mini batch 2 input nodes size: 2112147
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.8296117782592773  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.8296117782592773  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.616447925567627  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.6169233322143555  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 0.8013291358947754  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.2410521507263184  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.2410521507263184  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

first layer input nodes number: 2112147
first layer output nodes number: 1860855
edges number: 17128852
----------------------------------------before model layer 0
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 1.2709856033325195  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([2112147, 100])
----------------------------------------after rst
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 5.648060321807861  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 3.873410701751709  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([1860855, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 5.648060321807861  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 6.0917229652404785  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

input nodes number: 1860855
output nodes number: 1176617
edges number: 25173371
----------------------------------------before model layer 1
 Nvidia-smi: 19.2303466796875 GB
    Memory Allocated: 6.114354133605957  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([1860855, 256])
----------------------------------------after rst
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 9.677943229675293  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 8.55583381652832  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([1176617, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 9.677943229675293  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 9.958470821380615  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

input nodes number: 1176617
output nodes number: 516904
edges number: 13984804
----------------------------------------before model layer 2
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 9.971594333648682  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([1176617, 256])
----------------------------------------after rst
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 11.558725357055664  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 11.065767288208008  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([516904, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 11.558725357055664  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.3533935546875 GB
    Memory Allocated: 11.681964874267578  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.3553466796875 GB
    Memory Allocated: 11.78381061553955  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.3553466796875 GB
    Memory Allocated: 11.772643566131592  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

torch.Size([63778, 47])
input nodes number: 516904
output nodes number: 63778
edges number: 2444302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3553466796875 GB
    Memory Allocated: 11.77663516998291  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3553466796875 GB
    Memory Allocated: 11.776635646820068  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4783935546875 GB
    Memory Allocated: 2.0857949256896973  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 2.088308811187744  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.4803466796875 GB
    Memory Allocated: 2.088308811187744  GigaBytes
Max Memory Allocated: 14.148282051086426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3464658260345459 |0.6923921902974447 |0.6221375465393066 |0.00014766057332356772 |0.21219642957051596 |0.0027129650115966797 |
----------------------------------------------------------pseudo_mini_loss sum 10.99608325958252
Total (block generation + training)time/epoch 321.1434006690979
* Pure training time/epoch 5.622731924057007
Training time/epoch 5.93463134765625
Training time without block to device /epoch 3.857454776763916
Training time without total dataloading part /epoch 2.506157875061035
load block tensor time/epoch 1.0393974781036377
block to device time/epoch 2.077176570892334
input features size transfer per epoch 4.023313522338867e-07
blocks size to device per epoch 2.682209014892578e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17514217
Number of first layer input nodes during this epoch:  6446916
Number of first layer output nodes during this epoch:  5805329
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
