main start at this time 1655956148.2240016
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.4273824691772461
global_2_local spend time (sec) 0.44771313667297363
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.07712531089782715
A = g.adjacency_matrix() spent  0.12018299102783203
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.692671537399292
remove nodes length
1181171
auxiliary_graph.remove_nodes spent  5.706432580947876
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.820330619812012

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([        0,         1,         2,  ..., 101676969, 101676970,
        101676971])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
Convert a graph into a bidirected graph: 6.462 seconds
Metis partitioning: 22.944 seconds
Split the graph: 3.470 seconds
Construct subgraphs: 0.070 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  32.988683223724365
25290
23979
25268
24191
24697
23919
24268
24959
total k batches seeds list generation spend  76.1650550365448
after graph partition
graph partition algorithm spend time 77.12535214424133
25290
23979
25268
24191
24697
23919
24268
24959
partition_len_list
[242175, 214956, 228767, 211411, 266558, 251490, 249414, 262574]
shared_neighbor_graph_partition_s0 selection method  spend 77.83568978309631
time for parepare:  0.2765178680419922
local_output_nid generation:  0.005945444107055664
local_in_edges_tensor generation:  0.009467124938964844
mini_batch_src_global generation:  0.03268265724182129
r_  generation:  0.3708047866821289
local_output_nid generation:  0.006818056106567383
local_in_edges_tensor generation:  0.017686128616333008
mini_batch_src_global generation:  0.04564356803894043
r_  generation:  0.3543996810913086
local_output_nid generation:  0.008081436157226562
local_in_edges_tensor generation:  0.0359039306640625
mini_batch_src_global generation:  0.034659624099731445
r_  generation:  0.389817476272583
local_output_nid generation:  0.009358882904052734
local_in_edges_tensor generation:  0.014812707901000977
mini_batch_src_global generation:  0.03818511962890625
r_  generation:  0.3681650161743164
local_output_nid generation:  0.006972312927246094
local_in_edges_tensor generation:  0.010236978530883789
mini_batch_src_global generation:  0.038016557693481445
r_  generation:  0.38660717010498047
local_output_nid generation:  0.006735801696777344
local_in_edges_tensor generation:  0.008601188659667969
mini_batch_src_global generation:  0.037946462631225586
r_  generation:  0.3544020652770996
local_output_nid generation:  0.0069577693939208984
local_in_edges_tensor generation:  0.01316213607788086
mini_batch_src_global generation:  0.04075765609741211
r_  generation:  0.41574859619140625
local_output_nid generation:  0.006970643997192383
local_in_edges_tensor generation:  0.014787435531616211
mini_batch_src_global generation:  0.04395866394042969
r_  generation:  0.442596435546875
----------------------check_connections_block total spend ----------------------------- 4.455752372741699
generate_one_block  1.9139220714569092
generate_one_block  0.42230796813964844
generate_one_block  0.4588353633880615
generate_one_block  0.5007359981536865
generate_one_block  0.554236650466919
generate_one_block  0.4671316146850586
generate_one_block  0.5316030979156494
generate_one_block  0.5974311828613281
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.8716554641723633
gen group dst list time:  0.05135321617126465
time for parepare:  0.4558603763580322
local_output_nid generation:  0.07564759254455566
local_in_edges_tensor generation:  0.29970240592956543
mini_batch_src_global generation:  0.20747160911560059
r_  generation:  2.601344347000122
local_output_nid generation:  0.05859541893005371
local_in_edges_tensor generation:  0.1758112907409668
mini_batch_src_global generation:  0.22506093978881836
r_  generation:  2.280014991760254
local_output_nid generation:  0.08474421501159668
local_in_edges_tensor generation:  0.1806190013885498
mini_batch_src_global generation:  0.2143704891204834
r_  generation:  2.230255365371704
local_output_nid generation:  0.060332536697387695
local_in_edges_tensor generation:  0.23375582695007324
mini_batch_src_global generation:  0.22753167152404785
r_  generation:  2.317009449005127
local_output_nid generation:  0.0941305160522461
local_in_edges_tensor generation:  0.264049768447876
mini_batch_src_global generation:  0.2646956443786621
r_  generation:  2.9101521968841553
local_output_nid generation:  0.07025027275085449
local_in_edges_tensor generation:  0.23429346084594727
mini_batch_src_global generation:  0.2800881862640381
r_  generation:  3.0056545734405518
local_output_nid generation:  0.0845341682434082
local_in_edges_tensor generation:  0.21305084228515625
mini_batch_src_global generation:  0.2810795307159424
r_  generation:  2.8713748455047607
local_output_nid generation:  0.07712888717651367
local_in_edges_tensor generation:  0.18172025680541992
mini_batch_src_global generation:  0.29485583305358887
r_  generation:  3.069093942642212
----------------------check_connections_block total spend ----------------------------- 29.89174485206604
generate_one_block  3.8318064212799072
generate_one_block  2.8146989345550537
generate_one_block  2.984421968460083
generate_one_block  2.7432267665863037
generate_one_block  3.7246651649475098
generate_one_block  3.8858821392059326
generate_one_block  3.664353847503662
generate_one_block  3.7738208770751953
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1218276023864746
gen group dst list time:  0.21271419525146484
time for parepare:  0.47617411613464355
local_output_nid generation:  0.24232864379882812
local_in_edges_tensor generation:  0.7009561061859131
mini_batch_src_global generation:  0.5571060180664062
r_  generation:  8.566925764083862
local_output_nid generation:  0.28664159774780273
local_in_edges_tensor generation:  0.6876628398895264
mini_batch_src_global generation:  0.66937255859375
r_  generation:  6.83232855796814
local_output_nid generation:  0.217881441116333
local_in_edges_tensor generation:  0.5105116367340088
mini_batch_src_global generation:  0.5638246536254883
r_  generation:  6.018679857254028
local_output_nid generation:  0.2455759048461914
local_in_edges_tensor generation:  0.458467960357666
mini_batch_src_global generation:  0.5679488182067871
r_  generation:  6.81174635887146
local_output_nid generation:  0.2974674701690674
local_in_edges_tensor generation:  0.7122030258178711
mini_batch_src_global generation:  0.7792994976043701
r_  generation:  9.429399490356445
local_output_nid generation:  0.35930633544921875
local_in_edges_tensor generation:  0.6332931518554688
mini_batch_src_global generation:  0.8632988929748535
r_  generation:  9.907095909118652
local_output_nid generation:  0.244368314743042
local_in_edges_tensor generation:  0.49910545349121094
mini_batch_src_global generation:  0.7750515937805176
r_  generation:  7.946892738342285
local_output_nid generation:  0.27014970779418945
local_in_edges_tensor generation:  0.638263463973999
mini_batch_src_global generation:  0.7791252136230469
r_  generation:  8.508692502975464
----------------------check_connections_block total spend ----------------------------- 88.21504616737366
generate_one_block  10.070231676101685
generate_one_block  9.355136156082153
generate_one_block  7.484589338302612
generate_one_block  8.350061655044556
generate_one_block  12.084870100021362
generate_one_block  11.991973876953125
generate_one_block  9.94551134109497
generate_one_block  10.236141920089722
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.168041467666626
gen group dst list time:  0.5138528347015381
time for parepare:  0.49119114875793457
local_output_nid generation:  0.5759503841400146
local_in_edges_tensor generation:  1.0555541515350342
mini_batch_src_global generation:  0.49442315101623535
r_  generation:  8.200597047805786
local_output_nid generation:  0.6028668880462646
local_in_edges_tensor generation:  0.9290211200714111
mini_batch_src_global generation:  0.616797924041748
r_  generation:  8.053102254867554
local_output_nid generation:  0.5232725143432617
local_in_edges_tensor generation:  0.7862553596496582
mini_batch_src_global generation:  0.5886602401733398
r_  generation:  7.374929666519165
local_output_nid generation:  0.5437281131744385
local_in_edges_tensor generation:  0.7381489276885986
mini_batch_src_global generation:  0.583916187286377
r_  generation:  7.610684394836426
local_output_nid generation:  0.6027841567993164
local_in_edges_tensor generation:  0.8888177871704102
mini_batch_src_global generation:  0.676335334777832
r_  generation:  8.953407049179077
local_output_nid generation:  0.6117262840270996
local_in_edges_tensor generation:  0.8394465446472168
mini_batch_src_global generation:  0.7708921432495117
r_  generation:  9.773239374160767
local_output_nid generation:  0.5920975208282471
local_in_edges_tensor generation:  0.8415141105651855
mini_batch_src_global generation:  0.67388916015625
r_  generation:  8.44565224647522
local_output_nid generation:  0.5337178707122803
local_in_edges_tensor generation:  0.8275158405303955
mini_batch_src_global generation:  0.6433007717132568
r_  generation:  7.8659021854400635
----------------------check_connections_block total spend ----------------------------- 96.85998463630676
generate_one_block  11.279679775238037
generate_one_block  10.146963357925415
generate_one_block  9.037238836288452
generate_one_block  9.23010516166687
generate_one_block  10.873581647872925
generate_one_block  10.416239023208618
generate_one_block  10.402084827423096
generate_one_block  9.805079460144043
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  7
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  219.42252802848816
block generation total time  193.57856822013855
average batch blocks generation time:  6.04933025687933
block dataloader generation time/epoch 514.1447026729584
pseudo mini batch 0 input nodes size: 2051654
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7655577659606934  GigaBytes
Max Memory Allocated: 0.7655577659606934  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7657465934753418  GigaBytes
Max Memory Allocated: 0.7657465934753418  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7657465934753418  GigaBytes
Max Memory Allocated: 0.7657465934753418  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 1.0751652717590332  GigaBytes
Max Memory Allocated: 1.0751652717590332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 1.0751652717590332  GigaBytes
Max Memory Allocated: 1.0751652717590332  GigaBytes

first layer input nodes number: 2051654
first layer output nodes number: 1716387
edges number: 16043640
----------------------------------------before model layer 0
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 1.1044621467590332  GigaBytes
Max Memory Allocated: 1.1650090217590332  GigaBytes

torch.Size([2051654, 100])
----------------------------------------after rst
 Nvidia-smi: 9.8026123046875 GB
    Memory Allocated: 5.1451029777526855  GigaBytes
Max Memory Allocated: 6.78197717666626  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.8026123046875 GB
    Memory Allocated: 3.5082287788391113  GigaBytes
Max Memory Allocated: 6.78197717666626  GigaBytes

torch.Size([1716387, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.8026123046875 GB
    Memory Allocated: 5.1451029777526855  GigaBytes
Max Memory Allocated: 6.78197717666626  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.8026123046875 GB
    Memory Allocated: 5.554321765899658  GigaBytes
Max Memory Allocated: 7.191195964813232  GigaBytes

input nodes number: 1716387
output nodes number: 793541
edges number: 17470911
----------------------------------------before model layer 1
 Nvidia-smi: 9.8026123046875 GB
    Memory Allocated: 5.573022842407227  GigaBytes
Max Memory Allocated: 7.191195964813232  GigaBytes

torch.Size([1716387, 256])
----------------------------------------after rst
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 7.979443550109863  GigaBytes
Max Memory Allocated: 8.736223220825195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 7.222663879394531  GigaBytes
Max Memory Allocated: 8.736223220825195  GigaBytes

torch.Size([793541, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 7.979443550109863  GigaBytes
Max Memory Allocated: 8.736223220825195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 8.168638706207275  GigaBytes
Max Memory Allocated: 8.925418376922607  GigaBytes

input nodes number: 793541
output nodes number: 242175
edges number: 6684060
----------------------------------------before model layer 2
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 8.176355838775635  GigaBytes
Max Memory Allocated: 8.925418376922607  GigaBytes

torch.Size([793541, 256])
----------------------------------------after rst
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 8.92082929611206  GigaBytes
Max Memory Allocated: 9.151785373687744  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 8.689873218536377  GigaBytes
Max Memory Allocated: 9.151785373687744  GigaBytes

torch.Size([242175, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 8.92082929611206  GigaBytes
Max Memory Allocated: 9.151785373687744  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 8.97856855392456  GigaBytes
Max Memory Allocated: 9.209524631500244  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 9.019107341766357  GigaBytes
Max Memory Allocated: 9.209524631500244  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 9.014678955078125  GigaBytes
Max Memory Allocated: 9.209524631500244  GigaBytes

torch.Size([25290, 47])
input nodes number: 242175
output nodes number: 25290
edges number: 989819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 9.021780967712402  GigaBytes
Max Memory Allocated: 9.209524631500244  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 9.021781921386719  GigaBytes
Max Memory Allocated: 9.209524631500244  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.656324863433838  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

pseudo mini batch 1 input nodes size: 2042911
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 0.7714328765869141  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 0.7714328765869141  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.5324769020080566  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.5326557159423828  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 0.7681660652160645  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.0472359657287598  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.0472359657287598  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

first layer input nodes number: 2042911
first layer output nodes number: 1681026
edges number: 15612828
----------------------------------------before model layer 0
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 1.0753860473632812  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([2042911, 100])
----------------------------------------after rst
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 5.030508041381836  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 3.427356719970703  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1681026, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 5.030508041381836  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 5.431295871734619  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 1681026
output nodes number: 736181
edges number: 15482264
----------------------------------------before model layer 1
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 5.449306011199951  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1681026, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 7.676502704620361  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 6.974425792694092  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([736181, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 7.676502704620361  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 7.852022171020508  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 736181
output nodes number: 214956
edges number: 5474655
----------------------------------------before model layer 2
 Nvidia-smi: 18.5682373046875 GB
    Memory Allocated: 7.859201908111572  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([736181, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.516587734222412  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.31158971786499  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([214956, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.516587734222412  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.567837238311768  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.606048107147217  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.601849555969238  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([23979, 47])
input nodes number: 214956
output nodes number: 23979
edges number: 886092
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.603493213653564  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.603493690490723  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.5646309852600098  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

pseudo mini batch 2 input nodes size: 1979541
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7679362297058105  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7679362297058105  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.5053730010986328  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.505561351776123  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7443385124206543  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.9983658790588379  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.9983658790588379  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

first layer input nodes number: 1979541
first layer output nodes number: 1550968
edges number: 14227083
----------------------------------------before model layer 0
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.0255465507507324  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1979541, 100])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 4.673342704772949  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 3.1942243576049805  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1550968, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 4.673342704772949  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 5.043122291564941  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 1550968
output nodes number: 688312
edges number: 13350141
----------------------------------------before model layer 1
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 5.0598063468933105  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1550968, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.133677959442139  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 6.47725248336792  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([688312, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.133677959442139  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.297784328460693  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 688312
output nodes number: 228767
edges number: 5450518
----------------------------------------before model layer 2
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.304681301116943  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([688312, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.00150442123413  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.783335208892822  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([228767, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.00150442123413  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.056046962738037  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.097193241119385  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.092211246490479  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([25268, 47])
input nodes number: 228767
output nodes number: 25268
edges number: 943991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.095299243927002  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.09529972076416  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.472022533416748  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

pseudo mini batch 3 input nodes size: 1958523
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.745121955871582  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.745121955871582  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.474729061126709  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.4749093055725098  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7372841835021973  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.002190113067627  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.002190113067627  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

first layer input nodes number: 1958523
first layer output nodes number: 1559356
edges number: 14376050
----------------------------------------before model layer 0
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.0284004211425781  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1958523, 100])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 4.6968159675598145  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 3.20969820022583  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1559356, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 4.6968159675598145  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 5.0685954093933105  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 1559356
output nodes number: 722395
edges number: 14928377
----------------------------------------before model layer 1
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 5.085736274719238  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1559356, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.269132614135742  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 6.580203056335449  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([722395, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.269132614135742  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.4413652420043945  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 722395
output nodes number: 211411
edges number: 5333142
----------------------------------------before model layer 2
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.448897838592529  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([722395, 256])
----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.0950608253479  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 7.893443584442139  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([211411, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.0950608253479  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.14546537399292  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.184905529022217  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.180669784545898  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([24191, 47])
input nodes number: 211411
output nodes number: 24191
edges number: 917302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.182157516479492  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 8.18215799331665  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.497917652130127  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

pseudo mini batch 4 input nodes size: 2108624
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7365379333496094  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7365379333496094  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.522061824798584  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.5222458839416504  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 0.7924585342407227  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.136148452758789  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.136148452758789  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

first layer input nodes number: 2108624
first layer output nodes number: 1827839
edges number: 17014475
----------------------------------------before model layer 0
 Nvidia-smi: 18.5701904296875 GB
    Memory Allocated: 1.1658635139465332  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([2108624, 100])
----------------------------------------after rst
 Nvidia-smi: 13.0780029296875 GB
    Memory Allocated: 5.466690540313721  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.0780029296875 GB
    Memory Allocated: 3.723527431488037  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1827839, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.0780029296875 GB
    Memory Allocated: 5.466690540313721  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.0780029296875 GB
    Memory Allocated: 5.902481555938721  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

input nodes number: 1827839
output nodes number: 986696
edges number: 21286868
----------------------------------------before model layer 1
 Nvidia-smi: 13.0780029296875 GB
    Memory Allocated: 5.923451900482178  GigaBytes
Max Memory Allocated: 9.817503929138184  GigaBytes

torch.Size([1827839, 256])
----------------------------------------after rst
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 8.91320276260376  GigaBytes
Max Memory Allocated: 9.85460901260376  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 7.9722161293029785  GigaBytes
Max Memory Allocated: 9.85460901260376  GigaBytes

torch.Size([986696, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 8.913622379302979  GigaBytes
Max Memory Allocated: 9.85460901260376  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 9.148449420928955  GigaBytes
Max Memory Allocated: 10.089855670928955  GigaBytes

input nodes number: 986696
output nodes number: 266558
edges number: 6897958
----------------------------------------before model layer 2
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 9.15780782699585  GigaBytes
Max Memory Allocated: 10.089855670928955  GigaBytes

torch.Size([986696, 256])
----------------------------------------after rst
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 9.974308967590332  GigaBytes
Max Memory Allocated: 10.22851848602295  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 9.720099449157715  GigaBytes
Max Memory Allocated: 10.22851848602295  GigaBytes

torch.Size([266558, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 9.974308967590332  GigaBytes
Max Memory Allocated: 10.22851848602295  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 10.037861347198486  GigaBytes
Max Memory Allocated: 10.292070865631104  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 10.077109813690186  GigaBytes
Max Memory Allocated: 10.292070865631104  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 10.072785377502441  GigaBytes
Max Memory Allocated: 10.292070865631104  GigaBytes

torch.Size([24697, 47])
input nodes number: 266558
output nodes number: 24697
edges number: 920410
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 10.075761795043945  GigaBytes
Max Memory Allocated: 10.292070865631104  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 10.075762271881104  GigaBytes
Max Memory Allocated: 10.292070865631104  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.7835016250610352  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

pseudo mini batch 5 input nodes size: 2072634
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 0.7925472259521484  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 0.7925472259521484  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.5646638870239258  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.5648422241210938  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 0.7791342735290527  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.123363971710205  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.123363971710205  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

first layer input nodes number: 2072634
first layer output nodes number: 1789076
edges number: 16631862
----------------------------------------before model layer 0
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 1.152660846710205  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([2072634, 100])
----------------------------------------after rst
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 5.362118244171143  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 3.6559224128723145  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1789076, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 5.362118244171143  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 5.78866720199585  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 1789076
output nodes number: 987945
edges number: 21890608
----------------------------------------before model layer 1
 Nvidia-smi: 20.6209716796875 GB
    Memory Allocated: 5.810070037841797  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1789076, 256])
----------------------------------------after rst
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.807063102722168  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 7.864885330200195  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([987945, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.807063102722168  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 9.04260778427124  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 987945
output nodes number: 251490
edges number: 6845786
----------------------------------------before model layer 2
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 9.052388191223145  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([987945, 256])
----------------------------------------after rst
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.824786186218262  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.584946632385254  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([251490, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.824786186218262  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.884746074676514  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.922692775726318  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.91850471496582  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([23919, 47])
input nodes number: 251490
output nodes number: 23919
edges number: 833278
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.921393871307373  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.5701904296875 GB
    Memory Allocated: 9.921394348144531  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.7743029594421387  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

pseudo mini batch 6 input nodes size: 2004455
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7789978981018066  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7789978981018066  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.5257158279418945  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.5258970260620117  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7536020278930664  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.0554533004760742  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.0554533004760742  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

first layer input nodes number: 2004455
first layer output nodes number: 1634229
edges number: 15326963
----------------------------------------before model layer 0
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.083254337310791  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([2004455, 100])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 4.929379940032959  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 3.3708577156066895  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1634229, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 4.929379940032959  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 5.3190107345581055  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 1634229
output nodes number: 782756
edges number: 17383228
----------------------------------------before model layer 1
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 5.337018966674805  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1634229, 256])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.712793350219727  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 6.966299057006836  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([782756, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.712793350219727  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.899416923522949  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 782756
output nodes number: 249414
edges number: 6848677
----------------------------------------before model layer 2
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.907705307006836  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([782756, 256])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.67417049407959  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.436310768127441  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([249414, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.67417049407959  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.733635425567627  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.77304744720459  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.768798351287842  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([24268, 47])
input nodes number: 249414
output nodes number: 24268
edges number: 954704
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.771636962890625  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.771637439727783  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.6257309913635254  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

pseudo mini batch 7 input nodes size: 1954594
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7536630630493164  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7536630630493164  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.4818062782287598  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.481992244720459  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 0.7350931167602539  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.0463647842407227  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.0463647842407227  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

first layer input nodes number: 1954594
first layer output nodes number: 1577339
edges number: 14847131
----------------------------------------before model layer 0
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.0726799964904785  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1954594, 100])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 4.7853169441223145  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 3.2810492515563965  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1577339, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 4.7853169441223145  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 5.161384105682373  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 1577339
output nodes number: 833856
edges number: 18652874
----------------------------------------before model layer 1
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 5.179348945617676  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([1577339, 256])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.710287570953369  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 6.915060520172119  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([833856, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.710287570953369  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.909094333648682  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

input nodes number: 833856
output nodes number: 262574
edges number: 7292804
----------------------------------------before model layer 2
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.9178080558776855  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([833856, 256])
----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.725415229797363  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.475005149841309  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([262574, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.725415229797363  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.788017749786377  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.829256534576416  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.824288368225098  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

torch.Size([24959, 47])
input nodes number: 262574
output nodes number: 24959
edges number: 984964
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.827321529388428  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.827322006225586  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.6364798545837402  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.638993740081787  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 1.638993740081787  GigaBytes
Max Memory Allocated: 11.166667938232422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.2979469895362854 |0.4411959648132324 |0.4000132977962494 |0.0003374814987182617 |0.04010269045829773 |0.006505489349365234 |
----------------------------------------------------------pseudo_mini_loss sum 11.028549194335938
Total (block generation + training)time/epoch 523.8179545402527
* Pure training time/epoch 9.44327688217163
Training time/epoch 9.672971487045288
Training time without block to device /epoch 6.143403768539429
Training time without total dataloading part /epoch 3.5301332473754883
load block tensor time/epoch 2.383575916290283
block to device time/epoch 3.5295677185058594
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37968183
Number of first layer input nodes during this epoch:  16172936
Number of first layer output nodes during this epoch:  13336220
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
