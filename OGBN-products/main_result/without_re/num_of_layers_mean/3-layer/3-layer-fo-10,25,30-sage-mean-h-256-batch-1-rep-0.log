main start at this time 1656228566.739854
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 2.544745922088623
pseudo mini batch 0 input nodes size: 2200538
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.8210811614990234  GigaBytes
Max Memory Allocated: 0.8210811614990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.8225460052490234  GigaBytes
Max Memory Allocated: 0.8225460052490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.8225460052490234  GigaBytes
Max Memory Allocated: 0.8225460052490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.2170772552490234  GigaBytes
Max Memory Allocated: 1.2170772552490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.2170772552490234  GigaBytes
Max Memory Allocated: 1.2170772552490234  GigaBytes

first layer input nodes number: 2200538
first layer output nodes number: 2049390
edges number: 18709526
torch.Size([2200538, 100])
torch.Size([2049390, 256])
input nodes number: 2049390
output nodes number: 1274769
edges number: 28238730
torch.Size([2049390, 256])
torch.Size([1274769, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4588623046875 GB
    Memory Allocated: 11.055547714233398  GigaBytes
Max Memory Allocated: 11.971246719360352  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.4588623046875 GB
    Memory Allocated: 11.089966297149658  GigaBytes
Max Memory Allocated: 11.971246719360352  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.8885498046875 GB
    Memory Allocated: 1.9804706573486328  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.9820079803466797  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.9820079803466797  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4353170394897461 |0.78387451171875 |0.8907198905944824 |0.00033926963806152344 |0.44457221031188965 |0.004003763198852539 |
----------------------------------------------------------pseudo_mini_loss sum 7.366238117218018
Total (block generation + training)time/epoch 5.182560443878174
Training time/epoch 2.637235403060913
Training time without block to device /epoch 1.853360891342163
Training time without total dataloading part /epoch 1.3396351337432861
load block tensor time/epoch 0.4353170394897461
block to device time/epoch 0.78387451171875
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5524697
Number of first layer input nodes during this epoch:  2200538
Number of first layer output nodes during this epoch:  2049390
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.9820075035095215  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.9820075035095215  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 2.5569018125534058
pseudo mini batch 0 input nodes size: 2199652
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.8592696189880371  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.8592696189880371  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.6787042617797852  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.6801691055297852  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 0.8583917617797852  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.2529230117797852  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8905029296875 GB
    Memory Allocated: 1.2529230117797852  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

first layer input nodes number: 2199652
first layer output nodes number: 2049463
edges number: 18708546
torch.Size([2199652, 100])
torch.Size([2049463, 256])
input nodes number: 2049463
output nodes number: 1274595
edges number: 28237269
torch.Size([2049463, 256])
torch.Size([1274595, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3260498046875 GB
    Memory Allocated: 11.056078433990479  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.3260498046875 GB
    Memory Allocated: 11.090497016906738  GigaBytes
Max Memory Allocated: 13.311452388763428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.9809575080871582  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.9809575080871582  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.9809575080871582  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.35120272636413574 |0.4063756465911865 |0.10981941223144531 |0.00018167495727539062 |0.5066344738006592 |0.0027382373809814453 |
----------------------------------------------------------pseudo_mini_loss sum 12.891520500183105
Total (block generation + training)time/epoch 4.60986053943634
Training time/epoch 1.4677107334136963
Training time without block to device /epoch 1.0613350868225098
Training time without total dataloading part /epoch 0.6193737983703613
load block tensor time/epoch 0.35120272636413574
block to device time/epoch 0.4063756465911865
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5523710
Number of first layer input nodes during this epoch:  2199652
Number of first layer output nodes during this epoch:  2049463
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.98095703125  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.98095703125  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 2.532041629155477
pseudo mini batch 0 input nodes size: 2200044
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 0.8583917617797852  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 0.8583917617797852  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.6779723167419434  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.6794371604919434  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 0.8585376739501953  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.2530689239501953  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.0252685546875 GB
    Memory Allocated: 1.2530689239501953  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

first layer input nodes number: 2200044
first layer output nodes number: 2048489
edges number: 18699488
torch.Size([2200044, 100])
torch.Size([2048489, 256])
input nodes number: 2048489
output nodes number: 1274772
edges number: 28241699
torch.Size([2048489, 256])
torch.Size([1274772, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2440185546875 GB
    Memory Allocated: 11.053353309631348  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2440185546875 GB
    Memory Allocated: 11.087771892547607  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981255054473877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981255054473877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981255054473877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.29362964630126953 |0.3366568088531494 |0.11025857925415039 |0.00014495849609375 |0.006280422210693359 |0.001615762710571289 |
----------------------------------------------------------pseudo_mini_loss sum 3.782827615737915
Total (block generation + training)time/epoch 4.295847574869792
Training time/epoch 1.1853108406066895
Training time without block to device /epoch 0.84865403175354
Training time without total dataloading part /epoch 0.11829972267150879
load block tensor time/epoch 0.29362964630126953
block to device time/epoch 0.3366568088531494
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5523305
Number of first layer input nodes during this epoch:  2200044
Number of first layer output nodes during this epoch:  2048489
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.9812545776367188  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.9812545776367188  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 2.535019874572754
pseudo mini batch 0 input nodes size: 2199969
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8585376739501953  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8585376739501953  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.6780900955200195  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.6795549392700195  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8585095405578613  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.2530407905578613  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.2530407905578613  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

first layer input nodes number: 2199969
first layer output nodes number: 2049078
edges number: 18707343
torch.Size([2199969, 100])
torch.Size([2049078, 256])
input nodes number: 2049078
output nodes number: 1273803
edges number: 28217443
torch.Size([2049078, 256])
torch.Size([1273803, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 11.05410099029541  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 11.08851957321167  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981163501739502  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981163501739502  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981163501739502  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3488805294036865 |0.33564257621765137 |0.10345911979675293 |0.00017333030700683594 |0.004239797592163086 |0.0012073516845703125 |
----------------------------------------------------------pseudo_mini_loss sum 4.669511318206787
Total (block generation + training)time/epoch 4.165647029876709
Training time/epoch 1.2307462692260742
Training time without block to device /epoch 0.8951036930084229
Training time without total dataloading part /epoch 0.10907959938049316
load block tensor time/epoch 0.3488805294036865
block to device time/epoch 0.33564257621765137
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5522850
Number of first layer input nodes during this epoch:  2199969
Number of first layer output nodes during this epoch:  2049078
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.9811630249023438  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.9811630249023438  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 2.524416780471802
pseudo mini batch 0 input nodes size: 2199812
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8585095405578613  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8585095405578613  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.6780037879943848  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.6794686317443848  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 0.8584513664245605  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.2529826164245605  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.2529826164245605  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

first layer input nodes number: 2199812
first layer output nodes number: 2048188
edges number: 18700607
torch.Size([2199812, 100])
torch.Size([2048188, 256])
input nodes number: 2048188
output nodes number: 1274259
edges number: 28231994
torch.Size([2048188, 256])
torch.Size([1274259, 256])
torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 11.051496505737305  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 11.085915088653564  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981010913848877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981010913848877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.4608154296875 GB
    Memory Allocated: 1.981010913848877  GigaBytes
Max Memory Allocated: 13.311774730682373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.29439735412597656 |0.33410048484802246 |0.10245370864868164 |0.000152587890625 |0.003779888153076172 |0.0011379718780517578 |
----------------------------------------------------------pseudo_mini_loss sum 3.553724527359009
Total (block generation + training)time/epoch 4.064344501495361
Training time/epoch 1.1769402027130127
Training time without block to device /epoch 0.8428397178649902
Training time without total dataloading part /epoch 0.10752415657043457
load block tensor time/epoch 0.29439735412597656
block to device time/epoch 0.33410048484802246
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 1.043081283569336e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5522259
Number of first layer input nodes during this epoch:  2199812
Number of first layer output nodes during this epoch:  2048188
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
