main start at this time 1656133511.6257463
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022335052490234375  GigaBytes
Max Memory Allocated: 0.0022335052490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022335052490234375  GigaBytes
Max Memory Allocated: 0.0022335052490234375  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.494182825088501
global_2_local spend time (sec) 0.49048447608947754
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.10808634757995605
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1312332, 60: 154500, 54: 996, 52: 959, 48: 958, 58: 957, 59: 950, 43: 933, 51: 928, 47: 927, 57: 923, 56: 913, 55: 907, 53: 907, 45: 884, 49: 879, 50: 877, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.16971230506896973
auxiliary_graph
Graph(num_nodes=1508903, num_edges=167055469,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7249608039855957
remove nodes length  1312332

auxiliary_graph.remove_nodes spent  9.001859426498413
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=167055469,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  6.559002637863159

the counter of shared neighbor distribution
Counter({1.0: 115133674, 2.0: 25311050, 3.0: 10384000, 4.0: 5354006, 5.0: 3148200, 6.0: 2004162, 7.0: 1347392, 8.0: 952616, 9.0: 692248, 10.0: 515490, 11.0: 393218, 12.0: 308342, 13.0: 243512, 14.0: 188618, 15.0: 153968, 16.0: 124508, 17.0: 98760, 18.0: 80874, 19.0: 64108, 20.0: 54822, 21.0: 41902, 22.0: 35690, 23.0: 28730, 24.0: 24828, 25.0: 21856, 26.0: 17844, 27.0: 14860, 28.0: 13362, 29.0: 10248, 30.0: 10108, 31.0: 8134, 33.0: 7462, 32.0: 7190, 34.0: 5426, 35.0: 5244, 36.0: 4534, 37.0: 4418, 39.0: 4408, 38.0: 3962, 40.0: 3730, 53.0: 3174, 41.0: 3152, 42.0: 2638, 54.0: 2448, 43.0: 2210, 48.0: 2186, 50.0: 1720, 45.0: 1678, 44.0: 1612, 52.0: 1544, 51.0: 1204, 49.0: 1132, 55.0: 1120, 47.0: 1114, 46.0: 1104, 58.0: 960, 57.0: 782, 56.0: 732, 59.0: 528, 60.0: 356})
166858898
Convert a graph into a bidirected graph: 11.718 seconds
Metis partitioning: 39.022 seconds
Split the graph: 4.007 seconds
Construct subgraphs: 0.738 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  55.55220627784729
12104
12653
12049
12481
11927
12434
12654
12019
11959
12608
12065
12645
11927
12001
12391
12654
total k batches seeds list generation spend  104.81021690368652
after graph partition
graph partition algorithm spend time 106.07245779037476
12104
12653
12049
12481
11927
12434
12654
12019
11959
12608
12065
12645
11927
12001
12391
12654
partition_len_list
[132241, 164941, 137703, 133829, 175753, 186167, 106314, 135208, 155699, 129911, 171890, 190951, 154363, 169838, 185517, 171504]
REG selection method  spend 106.8922951221466
time for parepare:  0.35436558723449707
local_output_nid generation:  0.004302501678466797
local_in_edges_tensor generation:  0.010739564895629883
mini_batch_src_global generation:  0.025287866592407227
r_  generation:  0.20684385299682617
local_output_nid generation:  0.0045778751373291016
local_in_edges_tensor generation:  0.013569355010986328
mini_batch_src_global generation:  0.030885696411132812
r_  generation:  0.23894715309143066
local_output_nid generation:  0.0044095516204833984
local_in_edges_tensor generation:  0.007942438125610352
mini_batch_src_global generation:  0.027411460876464844
r_  generation:  0.22531867027282715
local_output_nid generation:  0.004605531692504883
local_in_edges_tensor generation:  0.006669521331787109
mini_batch_src_global generation:  0.024498701095581055
r_  generation:  0.23221588134765625
local_output_nid generation:  0.005372524261474609
local_in_edges_tensor generation:  0.017281770706176758
mini_batch_src_global generation:  0.029473066329956055
r_  generation:  0.2627217769622803
local_output_nid generation:  0.004582405090332031
local_in_edges_tensor generation:  0.015694856643676758
mini_batch_src_global generation:  0.030133962631225586
r_  generation:  0.2822260856628418
local_output_nid generation:  0.005748748779296875
local_in_edges_tensor generation:  0.025626659393310547
mini_batch_src_global generation:  0.02752685546875
r_  generation:  0.23399090766906738
local_output_nid generation:  0.004459857940673828
local_in_edges_tensor generation:  0.016351699829101562
mini_batch_src_global generation:  0.02703070640563965
r_  generation:  0.23001885414123535
local_output_nid generation:  0.004421234130859375
local_in_edges_tensor generation:  0.011284112930297852
mini_batch_src_global generation:  0.02488851547241211
r_  generation:  0.2025749683380127
local_output_nid generation:  0.00464940071105957
local_in_edges_tensor generation:  0.009500980377197266
mini_batch_src_global generation:  0.02749919891357422
r_  generation:  0.22795820236206055
local_output_nid generation:  0.004479169845581055
local_in_edges_tensor generation:  0.008698225021362305
mini_batch_src_global generation:  0.02542400360107422
r_  generation:  0.2311093807220459
local_output_nid generation:  0.004676103591918945
local_in_edges_tensor generation:  0.013421058654785156
mini_batch_src_global generation:  0.032131195068359375
r_  generation:  0.30069947242736816
local_output_nid generation:  0.0045053958892822266
local_in_edges_tensor generation:  0.0068438053131103516
mini_batch_src_global generation:  0.029637813568115234
r_  generation:  0.259784460067749
local_output_nid generation:  0.004597902297973633
local_in_edges_tensor generation:  0.007534980773925781
mini_batch_src_global generation:  0.02999424934387207
r_  generation:  0.2664613723754883
local_output_nid generation:  0.0046312808990478516
local_in_edges_tensor generation:  0.007026195526123047
mini_batch_src_global generation:  0.03732180595397949
r_  generation:  0.2957780361175537
local_output_nid generation:  0.0046749114990234375
local_in_edges_tensor generation:  0.012928247451782227
mini_batch_src_global generation:  0.03333401679992676
r_  generation:  0.28391194343566895
----------------------check_connections_block total spend ----------------------------- 5.906373977661133
generate_one_block  1.7450828552246094
generate_one_block  0.31964850425720215
generate_one_block  0.29646825790405273
generate_one_block  0.3213083744049072
generate_one_block  0.3200228214263916
generate_one_block  0.35236430168151855
generate_one_block  0.29306459426879883
generate_one_block  0.2976415157318115
generate_one_block  0.2597987651824951
generate_one_block  0.2932102680206299
generate_one_block  0.286041259765625
generate_one_block  0.3617122173309326
generate_one_block  0.32494282722473145
generate_one_block  0.3308548927307129
generate_one_block  0.3445286750793457
generate_one_block  0.37328433990478516
The real block id is  4
get_global_graph_edges_ids_block function  spend 2.7097442150115967
gen group dst list time:  0.06848859786987305
time for parepare:  0.44871044158935547
local_output_nid generation:  0.03683781623840332
local_in_edges_tensor generation:  0.3619215488433838
mini_batch_src_global generation:  0.16727542877197266
r_  generation:  2.0174105167388916
local_output_nid generation:  0.07538747787475586
local_in_edges_tensor generation:  0.22422289848327637
mini_batch_src_global generation:  0.23992371559143066
r_  generation:  2.1239817142486572
local_output_nid generation:  0.04260969161987305
local_in_edges_tensor generation:  0.22752046585083008
mini_batch_src_global generation:  0.199904203414917
r_  generation:  1.8812966346740723
local_output_nid generation:  0.0668189525604248
local_in_edges_tensor generation:  0.16105961799621582
mini_batch_src_global generation:  0.18549513816833496
r_  generation:  1.6671817302703857
local_output_nid generation:  0.05265402793884277
local_in_edges_tensor generation:  0.19271564483642578
mini_batch_src_global generation:  0.264132022857666
r_  generation:  2.6945722103118896
local_output_nid generation:  0.061440467834472656
local_in_edges_tensor generation:  0.24739718437194824
mini_batch_src_global generation:  0.3405270576477051
r_  generation:  3.022388219833374
local_output_nid generation:  0.05301642417907715
local_in_edges_tensor generation:  0.121490478515625
mini_batch_src_global generation:  0.18938851356506348
r_  generation:  1.3280797004699707
local_output_nid generation:  0.044663429260253906
local_in_edges_tensor generation:  0.1295483112335205
mini_batch_src_global generation:  0.20020055770874023
r_  generation:  1.8587267398834229
local_output_nid generation:  0.04915738105773926
local_in_edges_tensor generation:  0.1801929473876953
mini_batch_src_global generation:  0.24525833129882812
r_  generation:  2.4208974838256836
local_output_nid generation:  0.03535938262939453
local_in_edges_tensor generation:  0.13693618774414062
mini_batch_src_global generation:  0.19594407081604004
r_  generation:  1.6107738018035889
local_output_nid generation:  0.05060100555419922
local_in_edges_tensor generation:  0.19332051277160645
mini_batch_src_global generation:  0.2684776782989502
r_  generation:  2.7437450885772705
local_output_nid generation:  0.056226253509521484
local_in_edges_tensor generation:  0.24755430221557617
mini_batch_src_global generation:  0.3285644054412842
r_  generation:  3.188896656036377
local_output_nid generation:  0.07128691673278809
local_in_edges_tensor generation:  0.15951895713806152
mini_batch_src_global generation:  0.2744777202606201
r_  generation:  2.323193073272705
local_output_nid generation:  0.053437232971191406
local_in_edges_tensor generation:  0.17000985145568848
mini_batch_src_global generation:  0.2835252285003662
r_  generation:  2.6699624061584473
local_output_nid generation:  0.0536799430847168
local_in_edges_tensor generation:  0.18355035781860352
mini_batch_src_global generation:  0.3155217170715332
r_  generation:  3.0352413654327393
local_output_nid generation:  0.05242657661437988
local_in_edges_tensor generation:  0.2107696533203125
mini_batch_src_global generation:  0.31274867057800293
r_  generation:  2.797764539718628
----------------------check_connections_block total spend ----------------------------- 52.829599380493164
generate_one_block  2.8614342212677
generate_one_block  3.037585735321045
generate_one_block  2.4100866317749023
generate_one_block  2.2329580783843994
generate_one_block  3.6638245582580566
generate_one_block  4.137129545211792
generate_one_block  1.8242387771606445
generate_one_block  2.521334171295166
generate_one_block  3.1988325119018555
generate_one_block  2.1381123065948486
generate_one_block  3.5549168586730957
generate_one_block  3.9988842010498047
generate_one_block  3.05043363571167
generate_one_block  3.6170902252197266
generate_one_block  4.082338333129883
generate_one_block  3.5188727378845215
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.788104772567749
gen group dst list time:  0.38390660285949707
time for parepare:  0.47968459129333496
local_output_nid generation:  0.2164156436920166
local_in_edges_tensor generation:  0.7359917163848877
mini_batch_src_global generation:  0.6508944034576416
r_  generation:  8.39529824256897
local_output_nid generation:  0.2300405502319336
local_in_edges_tensor generation:  0.8076703548431396
mini_batch_src_global generation:  0.745234489440918
r_  generation:  7.389219045639038
local_output_nid generation:  0.21918821334838867
local_in_edges_tensor generation:  0.6572515964508057
mini_batch_src_global generation:  0.728893518447876
r_  generation:  7.54459023475647
local_output_nid generation:  0.22086811065673828
local_in_edges_tensor generation:  0.4256296157836914
mini_batch_src_global generation:  0.6298105716705322
r_  generation:  6.463007926940918
local_output_nid generation:  0.31072068214416504
local_in_edges_tensor generation:  0.8924574851989746
mini_batch_src_global generation:  1.101886510848999
r_  generation:  12.43495225906372
local_output_nid generation:  0.3270232677459717
local_in_edges_tensor generation:  0.8288114070892334
mini_batch_src_global generation:  1.1655821800231934
r_  generation:  11.68001651763916
local_output_nid generation:  0.11626338958740234
local_in_edges_tensor generation:  0.34467291831970215
mini_batch_src_global generation:  0.6361076831817627
r_  generation:  4.3446056842803955
local_output_nid generation:  0.2025136947631836
local_in_edges_tensor generation:  0.5819296836853027
mini_batch_src_global generation:  0.7167387008666992
r_  generation:  7.495530366897583
local_output_nid generation:  0.3451676368713379
local_in_edges_tensor generation:  0.7903251647949219
mini_batch_src_global generation:  1.1085360050201416
r_  generation:  12.222787857055664
local_output_nid generation:  0.18871212005615234
local_in_edges_tensor generation:  0.6247463226318359
mini_batch_src_global generation:  0.8692238330841064
r_  generation:  7.702842950820923
local_output_nid generation:  0.33313465118408203
local_in_edges_tensor generation:  0.782428503036499
mini_batch_src_global generation:  1.0946342945098877
r_  generation:  12.239875793457031
local_output_nid generation:  0.2592332363128662
local_in_edges_tensor generation:  0.759382963180542
mini_batch_src_global generation:  1.1381688117980957
r_  generation:  10.951626062393188
local_output_nid generation:  0.2623000144958496
local_in_edges_tensor generation:  1.4683873653411865
mini_batch_src_global generation:  0.9561452865600586
r_  generation:  9.294350862503052
local_output_nid generation:  0.2613992691040039
local_in_edges_tensor generation:  0.7612814903259277
mini_batch_src_global generation:  1.0752947330474854
r_  generation:  10.819878101348877
local_output_nid generation:  0.28638648986816406
local_in_edges_tensor generation:  0.7679786682128906
mini_batch_src_global generation:  1.1013734340667725
r_  generation:  11.186862230300903
local_output_nid generation:  0.26175642013549805
local_in_edges_tensor generation:  0.6446664333343506
mini_batch_src_global generation:  1.065368890762329
r_  generation:  10.558235168457031
----------------------check_connections_block total spend ----------------------------- 208.4407286643982
generate_one_block  11.442631721496582
generate_one_block  9.570708751678467
generate_one_block  9.962268590927124
generate_one_block  8.282500982284546
generate_one_block  16.728020668029785
generate_one_block  15.433948040008545
generate_one_block  5.891292095184326
generate_one_block  9.747853755950928
generate_one_block  16.377870082855225
generate_one_block  9.717862844467163
generate_one_block  16.189695835113525
generate_one_block  13.907882928848267
generate_one_block  12.686396598815918
generate_one_block  14.032806873321533
generate_one_block  14.103927373886108
generate_one_block  13.466737985610962
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.467247486114502
gen group dst list time:  1.0031907558441162
time for parepare:  0.4960346221923828
local_output_nid generation:  0.620121955871582
local_in_edges_tensor generation:  1.3516569137573242
mini_batch_src_global generation:  1.2139065265655518
r_  generation:  16.157175540924072
local_output_nid generation:  0.6285233497619629
local_in_edges_tensor generation:  1.247880220413208
mini_batch_src_global generation:  1.5718698501586914
r_  generation:  15.518568992614746
local_output_nid generation:  0.6382107734680176
local_in_edges_tensor generation:  1.3000614643096924
mini_batch_src_global generation:  1.5593392848968506
r_  generation:  15.704906463623047
local_output_nid generation:  0.6085505485534668
local_in_edges_tensor generation:  1.1922318935394287
mini_batch_src_global generation:  1.4364149570465088
r_  generation:  15.302410125732422
local_output_nid generation:  0.7474315166473389
local_in_edges_tensor generation:  1.4697012901306152
mini_batch_src_global generation:  1.722229242324829
r_  generation:  19.315845251083374
local_output_nid generation:  0.7041478157043457
local_in_edges_tensor generation:  1.420424461364746
mini_batch_src_global generation:  1.880716323852539
r_  generation:  18.536139726638794
local_output_nid generation:  0.4818141460418701
local_in_edges_tensor generation:  1.0143744945526123
mini_batch_src_global generation:  1.401130199432373
r_  generation:  12.585366487503052
local_output_nid generation:  0.619135856628418
local_in_edges_tensor generation:  1.1520051956176758
mini_batch_src_global generation:  1.5295121669769287
r_  generation:  16.045497179031372
local_output_nid generation:  0.7084143161773682
local_in_edges_tensor generation:  1.382842779159546
mini_batch_src_global generation:  1.8824701309204102
r_  generation:  18.697606086730957
local_output_nid generation:  0.6082665920257568
local_in_edges_tensor generation:  1.2561404705047607
mini_batch_src_global generation:  1.695704698562622
r_  generation:  15.922500610351562
local_output_nid generation:  0.7051348686218262
local_in_edges_tensor generation:  1.366398572921753
mini_batch_src_global generation:  1.88616943359375
r_  generation:  18.525899648666382
local_output_nid generation:  0.6637964248657227
local_in_edges_tensor generation:  1.3449609279632568
mini_batch_src_global generation:  1.7906498908996582
r_  generation:  17.260796070098877
local_output_nid generation:  0.6220972537994385
local_in_edges_tensor generation:  1.2340123653411865
mini_batch_src_global generation:  1.8002173900604248
r_  generation:  16.493053197860718
local_output_nid generation:  0.693183422088623
local_in_edges_tensor generation:  1.3875837326049805
mini_batch_src_global generation:  1.7728915214538574
r_  generation:  17.90710186958313
local_output_nid generation:  0.6476864814758301
local_in_edges_tensor generation:  1.2978127002716064
mini_batch_src_global generation:  1.902538776397705
r_  generation:  17.388497829437256
local_output_nid generation:  0.6372137069702148
local_in_edges_tensor generation:  1.29793381690979
mini_batch_src_global generation:  1.7412440776824951
r_  generation:  16.851434230804443
----------------------check_connections_block total spend ----------------------------- 376.05465602874756
generate_one_block  22.312416553497314
generate_one_block  21.08349847793579
generate_one_block  20.952298164367676
generate_one_block  20.09877300262451
generate_one_block  25.292404174804688
generate_one_block  24.488425493240356
generate_one_block  16.861337423324585
generate_one_block  21.522289276123047
generate_one_block  25.8478684425354
generate_one_block  21.141634464263916
generate_one_block  24.078192234039307
generate_one_block  22.706437349319458
generate_one_block  21.576993465423584
generate_one_block  23.46458101272583
generate_one_block  22.555753231048584
generate_one_block  22.012858390808105
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1333987712860107
gen group dst list time:  1.51847505569458
time for parepare:  0.5097274780273438
local_output_nid generation:  0.8105266094207764
local_in_edges_tensor generation:  1.4597134590148926
mini_batch_src_global generation:  1.268770456314087
r_  generation:  17.45473837852478
local_output_nid generation:  0.8655192852020264
local_in_edges_tensor generation:  1.5149085521697998
mini_batch_src_global generation:  1.7011487483978271
r_  generation:  17.31741237640381
local_output_nid generation:  0.8557100296020508
local_in_edges_tensor generation:  1.4817347526550293
mini_batch_src_global generation:  1.6998653411865234
r_  generation:  17.570162296295166
local_output_nid generation:  0.8828494548797607
local_in_edges_tensor generation:  1.4449398517608643
mini_batch_src_global generation:  1.6396961212158203
r_  generation:  17.617910861968994
local_output_nid generation:  0.8882126808166504
local_in_edges_tensor generation:  1.4692864418029785
mini_batch_src_global generation:  1.9464213848114014
r_  generation:  18.834134578704834
local_output_nid generation:  0.8144180774688721
local_in_edges_tensor generation:  1.4692761898040771
mini_batch_src_global generation:  1.8339004516601562
r_  generation:  18.26730465888977
local_output_nid generation:  0.7603375911712646
local_in_edges_tensor generation:  1.3985469341278076
mini_batch_src_global generation:  1.7400381565093994
r_  generation:  17.392518520355225
local_output_nid generation:  0.7953734397888184
local_in_edges_tensor generation:  1.4475157260894775
mini_batch_src_global generation:  1.8924238681793213
r_  generation:  18.150468111038208
local_output_nid generation:  0.7957127094268799
local_in_edges_tensor generation:  1.456096887588501
mini_batch_src_global generation:  1.7735700607299805
r_  generation:  18.44158101081848
local_output_nid generation:  0.7726953029632568
local_in_edges_tensor generation:  1.4136483669281006
mini_batch_src_global generation:  1.766063928604126
r_  generation:  18.024814128875732
local_output_nid generation:  0.8118419647216797
local_in_edges_tensor generation:  1.4704294204711914
mini_batch_src_global generation:  1.7395226955413818
r_  generation:  18.764784812927246
local_output_nid generation:  0.8010764122009277
local_in_edges_tensor generation:  1.4381065368652344
mini_batch_src_global generation:  1.7164289951324463
r_  generation:  18.452719688415527
local_output_nid generation:  0.805351734161377
local_in_edges_tensor generation:  1.430168628692627
mini_batch_src_global generation:  1.7079365253448486
r_  generation:  18.38307285308838
local_output_nid generation:  0.8234765529632568
local_in_edges_tensor generation:  1.4561517238616943
mini_batch_src_global generation:  1.8167836666107178
r_  generation:  18.40896439552307
local_output_nid generation:  0.7979521751403809
local_in_edges_tensor generation:  1.4500021934509277
mini_batch_src_global generation:  1.8097059726715088
r_  generation:  18.52210283279419
local_output_nid generation:  0.8044934272766113
local_in_edges_tensor generation:  1.4662818908691406
mini_batch_src_global generation:  1.799201250076294
r_  generation:  18.4620041847229
----------------------check_connections_block total spend ----------------------------- 410.18478560447693
generate_one_block  23.45009422302246
generate_one_block  23.19311499595642
generate_one_block  22.97285771369934
generate_one_block  23.18626093864441
generate_one_block  26.184543132781982
generate_one_block  23.55134606361389
generate_one_block  22.780040740966797
generate_one_block  23.37524127960205
generate_one_block  23.803832292556763
generate_one_block  23.405232906341553
generate_one_block  24.748393774032593
generate_one_block  25.132577896118164
generate_one_block  24.935314655303955
generate_one_block  25.297134399414062
generate_one_block  25.421552658081055
generate_one_block  25.01802945137024
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1692519187927246
gen group dst list time:  1.662998914718628
time for parepare:  0.4444570541381836
local_output_nid generation:  0.8408060073852539
local_in_edges_tensor generation:  1.2117729187011719
mini_batch_src_global generation:  0.6302328109741211
r_  generation:  9.91182565689087
local_output_nid generation:  0.8207333087921143
local_in_edges_tensor generation:  1.0580320358276367
mini_batch_src_global generation:  0.8766825199127197
r_  generation:  10.075935125350952
local_output_nid generation:  0.8603644371032715
local_in_edges_tensor generation:  1.163444995880127
mini_batch_src_global generation:  0.9788405895233154
r_  generation:  10.348424434661865
local_output_nid generation:  0.9031360149383545
local_in_edges_tensor generation:  1.205108404159546
mini_batch_src_global generation:  0.9372756481170654
r_  generation:  10.669867992401123
local_output_nid generation:  0.8665962219238281
local_in_edges_tensor generation:  1.2010385990142822
mini_batch_src_global generation:  0.9380958080291748
r_  generation:  11.072343349456787
local_output_nid generation:  0.8440577983856201
local_in_edges_tensor generation:  1.258049726486206
mini_batch_src_global generation:  1.028703212738037
r_  generation:  10.829743385314941
local_output_nid generation:  0.8612544536590576
local_in_edges_tensor generation:  1.1705882549285889
mini_batch_src_global generation:  1.030799150466919
r_  generation:  12.14306116104126
local_output_nid generation:  0.8611669540405273
local_in_edges_tensor generation:  1.238649606704712
mini_batch_src_global generation:  1.0034763813018799
r_  generation:  12.273265838623047
local_output_nid generation:  0.8786396980285645
local_in_edges_tensor generation:  1.2513864040374756
mini_batch_src_global generation:  0.9779529571533203
r_  generation:  12.375329494476318
local_output_nid generation:  0.8724298477172852
local_in_edges_tensor generation:  1.2406013011932373
mini_batch_src_global generation:  0.9384801387786865
r_  generation:  12.30698823928833
local_output_nid generation:  0.8706090450286865
local_in_edges_tensor generation:  1.2590744495391846
mini_batch_src_global generation:  1.0111465454101562
r_  generation:  12.516727209091187
local_output_nid generation:  0.8804440498352051
local_in_edges_tensor generation:  1.2390286922454834
mini_batch_src_global generation:  0.9471430778503418
r_  generation:  12.470162868499756
local_output_nid generation:  0.8829224109649658
local_in_edges_tensor generation:  1.2911248207092285
mini_batch_src_global generation:  0.9780051708221436
r_  generation:  12.432738542556763
local_output_nid generation:  0.8700611591339111
local_in_edges_tensor generation:  1.2924742698669434
mini_batch_src_global generation:  0.9915308952331543
r_  generation:  12.592051982879639
local_output_nid generation:  0.8799409866333008
local_in_edges_tensor generation:  1.2441725730895996
mini_batch_src_global generation:  0.9899246692657471
r_  generation:  12.527121305465698
local_output_nid generation:  0.8807218074798584
local_in_edges_tensor generation:  1.2553985118865967
mini_batch_src_global generation:  0.9413399696350098
r_  generation:  12.706209897994995
----------------------check_connections_block total spend ----------------------------- 276.5357611179352
generate_one_block  14.264722108840942
generate_one_block  16.284844398498535
generate_one_block  13.920838832855225
generate_one_block  14.733001470565796
generate_one_block  15.01554822921753
generate_one_block  14.684744119644165
generate_one_block  14.487082481384277
generate_one_block  14.41359281539917
generate_one_block  15.06203556060791
generate_one_block  14.864944458007812
generate_one_block  15.236595392227173
generate_one_block  14.767553567886353
generate_one_block  15.166961669921875
generate_one_block  15.18299913406372
generate_one_block  15.478893041610718
generate_one_block  14.705164670944214
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022335052490234375  GigaBytes
Max Memory Allocated: 0.0022335052490234375  GigaBytes

connection checking time:  1329.9519047737122
block generation total time  1234.63130235672
average batch blocks generation time:  12.8607427328825
block dataloader generation time/epoch 2738.9369745254517
pseudo mini batch 0 input nodes size: 2276985
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022335052490234375  GigaBytes
Max Memory Allocated: 0.0022335052490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022335052490234375  GigaBytes
Max Memory Allocated: 0.0022335052490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.8504767417907715  GigaBytes
Max Memory Allocated: 0.8504767417907715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.8505673408508301  GigaBytes
Max Memory Allocated: 0.8505673408508301  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8690185546875 GB
    Memory Allocated: 0.8505673408508301  GigaBytes
Max Memory Allocated: 0.8505673408508301  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.8944091796875 GB
    Memory Allocated: 1.7898764610290527  GigaBytes
Max Memory Allocated: 1.7898764610290527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8944091796875 GB
    Memory Allocated: 1.7898764610290527  GigaBytes
Max Memory Allocated: 1.7898764610290527  GigaBytes

first layer input nodes number: 2276985
first layer output nodes number: 2257843
edges number: 19770063
torch.Size([2276985, 100])
torch.Size([2257843, 256])
input nodes number: 2257843
output nodes number: 2148518
edges number: 40309949
torch.Size([2257843, 256])
torch.Size([2148518, 256])
input nodes number: 2148518
output nodes number: 1675974
edges number: 38889386
torch.Size([2148518, 256])
