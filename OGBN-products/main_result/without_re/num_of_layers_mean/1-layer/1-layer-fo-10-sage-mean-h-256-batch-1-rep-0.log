main start at this time 1656225505.658161
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.08713746070861816
pseudo mini batch 0 input nodes size: 849440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31647634506225586  GigaBytes
Max Memory Allocated: 0.31647634506225586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31839466094970703  GigaBytes
Max Memory Allocated: 0.31839466094970703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31839466094970703  GigaBytes
Max Memory Allocated: 0.31839466094970703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.332916259765625  GigaBytes
Max Memory Allocated: 0.332916259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.332916259765625  GigaBytes
Max Memory Allocated: 0.332916259765625  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.49097299575805664  GigaBytes
Max Memory Allocated: 0.525390625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.5253915786743164  GigaBytes
Max Memory Allocated: 0.5253920555114746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38262414932250977  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38269472122192383  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38269472122192383  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.30762386322021484 |0.3402280807495117 |0.773838996887207 |0.00026106834411621094 |0.008969306945800781 |0.0020618438720703125 |
----------------------------------------------------------pseudo_mini_loss sum 5.12290096282959
Total (block generation + training)time/epoch 1.5249874591827393
Training time/epoch 1.4375050067901611
Training time without block to device /epoch 1.0972769260406494
Training time without total dataloading part /epoch 0.7851312160491943
load block tensor time/epoch 0.30762386322021484
block to device time/epoch 0.3402280807495117
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  849440
Number of first layer input nodes during this epoch:  849440
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3826942443847656  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3826942443847656  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.09626328945159912
pseudo mini batch 0 input nodes size: 847718
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3529181480407715  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3529181480407715  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6693243980407715  GigaBytes
Max Memory Allocated: 0.6693243980407715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6707892417907715  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3524298667907715  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.36695146560668945  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.36695146560668945  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.4913291931152344  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5264863967895508  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1256556510925293 |0.009058713912963867 |0.0017240047454833984 |0.00017762184143066406 |0.0011200904846191406 |0.0008535385131835938 |
----------------------------------------------------------pseudo_mini_loss sum 4.811762809753418
Total (block generation + training)time/epoch 0.8911246061325073
Training time/epoch 0.1515657901763916
Training time without block to device /epoch 0.14250707626342773
Training time without total dataloading part /epoch 0.003875255584716797
load block tensor time/epoch 0.1256556510925293
block to device time/epoch 0.009058713912963867
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  847718
Number of first layer input nodes during this epoch:  847718
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.08270502090454102
pseudo mini batch 0 input nodes size: 848141
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.669126033782959  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.49107885360717773  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5262360572814941  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12021636962890625 |0.008843183517456055 |0.0020606517791748047 |0.00015234947204589844 |0.0012404918670654297 |0.0012907981872558594 |
----------------------------------------------------------pseudo_mini_loss sum 4.521127223968506
Total (block generation + training)time/epoch 0.6612234115600586
Training time/epoch 0.14568686485290527
Training time without block to device /epoch 0.13684368133544922
Training time without total dataloading part /epoch 0.004744291305541992
load block tensor time/epoch 0.12021636962890625
block to device time/epoch 0.008843183517456055
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  848141
Number of first layer input nodes during this epoch:  848141
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343286514282227  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343286514282227  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.07545459270477295
pseudo mini batch 0 input nodes size: 848120
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6700630187988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3676900863647461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3676900863647461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.49059057235717773  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5257477760314941  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12154603004455566 |0.010243892669677734 |0.0022306442260742188 |0.0001742839813232422 |0.0012676715850830078 |0.001519918441772461 |
----------------------------------------------------------pseudo_mini_loss sum 4.25014066696167
Total (block generation + training)time/epoch 0.5467003583908081
Training time/epoch 0.14928317070007324
Training time without block to device /epoch 0.1390392780303955
Training time without total dataloading part /epoch 0.00519251823425293
load block tensor time/epoch 0.12154603004455566
block to device time/epoch 0.010243892669677734
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  848120
Number of first layer input nodes during this epoch:  848120
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0677412509918213
pseudo mini batch 0 input nodes size: 848208
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6691508293151855  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.49107885360717773  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5262360572814941  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12426519393920898 |0.009119510650634766 |0.0017299652099609375 |0.00015592575073242188 |0.0014629364013671875 |0.0019605159759521484 |
----------------------------------------------------------pseudo_mini_loss sum 3.997363805770874
Total (block generation + training)time/epoch 0.47472920417785647
Training time/epoch 0.14980340003967285
Training time without block to device /epoch 0.14068388938903809
Training time without total dataloading part /epoch 0.005309343338012695
load block tensor time/epoch 0.12426519393920898
block to device time/epoch 0.009119510650634766
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  848208
Number of first layer input nodes during this epoch:  848208
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  9400
trainable parameters
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
