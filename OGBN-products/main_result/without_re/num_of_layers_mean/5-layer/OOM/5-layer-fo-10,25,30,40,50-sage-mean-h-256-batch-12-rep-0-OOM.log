main start at this time 1656136806.1998634
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.509533166885376
global_2_local spend time (sec) 0.49817585945129395
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.12287688255310059
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1256292, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.1562809944152832
auxiliary_graph
Graph(num_nodes=1452863, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7596104145050049
remove nodes length  1256292

auxiliary_graph.remove_nodes spent  8.528326272964478
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.329992294311523

the counter of shared neighbor distribution
Counter({1.0: 96835744, 2.0: 19827062, 3.0: 7693924, 4.0: 3791436, 5.0: 2140070, 6.0: 1318556, 7.0: 866322, 8.0: 595048, 9.0: 426444, 10.0: 310458, 11.0: 236344, 12.0: 183078, 13.0: 142976, 14.0: 106950, 15.0: 85820, 16.0: 67340, 17.0: 50862, 18.0: 42392, 19.0: 33792, 20.0: 28390, 21.0: 20868, 22.0: 18984, 23.0: 15084, 24.0: 12878, 25.0: 10746, 26.0: 9024, 27.0: 7364, 28.0: 6868, 30.0: 4276, 29.0: 4242, 31.0: 3522, 33.0: 3520, 32.0: 2852, 48.0: 2580, 35.0: 2468, 39.0: 2416, 36.0: 2416, 37.0: 2404, 34.0: 2034, 38.0: 2032, 40.0: 1910, 43.0: 1782, 41.0: 1508, 47.0: 1452, 44.0: 1420, 42.0: 1374, 49.0: 1218, 45.0: 1128, 46.0: 874, 50.0: 420})
134932672
Convert a graph into a bidirected graph: 9.406 seconds
Metis partitioning: 30.239 seconds
Split the graph: 3.414 seconds
Construct subgraphs: 0.615 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  43.72844886779785
15956
16621
16868
16856
16861
16293
16871
15942
16573
15903
15903
15924
total k batches seeds list generation spend  85.2373595237732
after graph partition
graph partition algorithm spend time 86.34792494773865
15956
16621
16868
16856
16861
16293
16871
15942
16573
15903
15903
15924
partition_len_list
[180642, 169408, 183891, 197046, 174128, 128976, 183270, 204089, 225726, 211065, 195115, 212947]
REG selection method  spend 87.17377042770386
time for parepare:  0.34880542755126953
local_output_nid generation:  0.00526881217956543
local_in_edges_tensor generation:  0.008347272872924805
mini_batch_src_global generation:  0.023910045623779297
r_  generation:  0.2684178352355957
local_output_nid generation:  0.0054607391357421875
local_in_edges_tensor generation:  0.009080886840820312
mini_batch_src_global generation:  0.030554533004760742
r_  generation:  0.27501606941223145
local_output_nid generation:  0.005610942840576172
local_in_edges_tensor generation:  0.011793136596679688
mini_batch_src_global generation:  0.03061676025390625
r_  generation:  0.2938807010650635
local_output_nid generation:  0.00562286376953125
local_in_edges_tensor generation:  0.015536069869995117
mini_batch_src_global generation:  0.03081989288330078
r_  generation:  0.3226292133331299
local_output_nid generation:  0.006569623947143555
local_in_edges_tensor generation:  0.053800344467163086
mini_batch_src_global generation:  0.03232145309448242
r_  generation:  0.30835723876953125
local_output_nid generation:  0.0066525936126708984
local_in_edges_tensor generation:  0.029299497604370117
mini_batch_src_global generation:  0.032737016677856445
r_  generation:  0.2612178325653076
local_output_nid generation:  0.006270647048950195
local_in_edges_tensor generation:  0.015364408493041992
mini_batch_src_global generation:  0.031044483184814453
r_  generation:  0.29242968559265137
local_output_nid generation:  0.005971193313598633
local_in_edges_tensor generation:  0.012946844100952148
mini_batch_src_global generation:  0.02998518943786621
r_  generation:  0.2682666778564453
local_output_nid generation:  0.005535125732421875
local_in_edges_tensor generation:  0.009544134140014648
mini_batch_src_global generation:  0.03249478340148926
r_  generation:  0.30670166015625
local_output_nid generation:  0.005381107330322266
local_in_edges_tensor generation:  0.009336709976196289
mini_batch_src_global generation:  0.032691001892089844
r_  generation:  0.3204538822174072
local_output_nid generation:  0.005448341369628906
local_in_edges_tensor generation:  0.011487483978271484
mini_batch_src_global generation:  0.03328561782836914
r_  generation:  0.3269493579864502
local_output_nid generation:  0.005370140075683594
local_in_edges_tensor generation:  0.0074503421783447266
mini_batch_src_global generation:  0.052107810974121094
r_  generation:  0.32622504234313965
----------------------check_connections_block total spend ----------------------------- 5.318760871887207
generate_one_block  1.8609976768493652
generate_one_block  0.41576480865478516
generate_one_block  0.41428232192993164
generate_one_block  0.4621751308441162
generate_one_block  0.5160353183746338
generate_one_block  0.3518345355987549
generate_one_block  0.3686842918395996
generate_one_block  0.330019474029541
generate_one_block  0.36689186096191406
generate_one_block  0.3714561462402344
generate_one_block  0.3809833526611328
generate_one_block  0.37929868698120117
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.339005947113037
gen group dst list time:  0.07766866683959961
time for parepare:  0.4676332473754883
local_output_nid generation:  0.05269479751586914
local_in_edges_tensor generation:  0.2558619976043701
mini_batch_src_global generation:  0.18949317932128906
r_  generation:  2.2508187294006348
local_output_nid generation:  0.050473928451538086
local_in_edges_tensor generation:  0.2615079879760742
mini_batch_src_global generation:  0.2368624210357666
r_  generation:  1.915579080581665
local_output_nid generation:  0.07365274429321289
local_in_edges_tensor generation:  0.17034029960632324
mini_batch_src_global generation:  0.20906925201416016
r_  generation:  2.0983407497406006
local_output_nid generation:  0.06098341941833496
local_in_edges_tensor generation:  0.23987984657287598
mini_batch_src_global generation:  0.2956066131591797
r_  generation:  2.7195587158203125
local_output_nid generation:  0.0800173282623291
local_in_edges_tensor generation:  0.18956613540649414
mini_batch_src_global generation:  0.2454524040222168
r_  generation:  2.2518482208251953
local_output_nid generation:  0.03777813911437988
local_in_edges_tensor generation:  0.31542420387268066
mini_batch_src_global generation:  0.18075942993164062
r_  generation:  1.4339344501495361
local_output_nid generation:  0.047692060470581055
local_in_edges_tensor generation:  0.1617751121520996
mini_batch_src_global generation:  0.21336817741394043
r_  generation:  2.2415833473205566
local_output_nid generation:  0.08841323852539062
local_in_edges_tensor generation:  0.24541640281677246
mini_batch_src_global generation:  0.28182435035705566
r_  generation:  2.776639938354492
local_output_nid generation:  0.06245708465576172
local_in_edges_tensor generation:  0.19225811958312988
mini_batch_src_global generation:  0.3129236698150635
r_  generation:  3.2004685401916504
local_output_nid generation:  0.06243753433227539
local_in_edges_tensor generation:  0.22346830368041992
mini_batch_src_global generation:  0.3098320960998535
r_  generation:  3.0357913970947266
local_output_nid generation:  0.05617833137512207
local_in_edges_tensor generation:  0.16765594482421875
mini_batch_src_global generation:  0.3096182346343994
r_  generation:  2.7369930744171143
local_output_nid generation:  0.06390881538391113
local_in_edges_tensor generation:  0.22466588020324707
mini_batch_src_global generation:  0.3086240291595459
r_  generation:  3.0428407192230225
----------------------check_connections_block total spend ----------------------------- 42.10820198059082
generate_one_block  3.4133429527282715
generate_one_block  2.571997880935669
generate_one_block  2.7428455352783203
generate_one_block  3.5745458602905273
generate_one_block  3.1039628982543945
generate_one_block  1.8966026306152344
generate_one_block  2.847524881362915
generate_one_block  3.784336566925049
generate_one_block  4.1302056312561035
generate_one_block  3.867924213409424
generate_one_block  3.3781375885009766
generate_one_block  3.804028272628784
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.463562488555908
gen group dst list time:  0.31821298599243164
time for parepare:  0.48420119285583496
local_output_nid generation:  0.2537829875946045
local_in_edges_tensor generation:  0.8011696338653564
mini_batch_src_global generation:  0.5838196277618408
r_  generation:  8.046072483062744
local_output_nid generation:  0.24635934829711914
local_in_edges_tensor generation:  0.5616405010223389
mini_batch_src_global generation:  0.6238529682159424
r_  generation:  6.393672704696655
local_output_nid generation:  0.21648406982421875
local_in_edges_tensor generation:  0.6708965301513672
mini_batch_src_global generation:  0.6491837501525879
r_  generation:  6.667896032333374
local_output_nid generation:  0.26602792739868164
local_in_edges_tensor generation:  0.6732277870178223
mini_batch_src_global generation:  0.8008699417114258
r_  generation:  8.2315034866333
local_output_nid generation:  0.2464616298675537
local_in_edges_tensor generation:  0.6437673568725586
mini_batch_src_global generation:  0.8158197402954102
r_  generation:  7.691633939743042
local_output_nid generation:  0.15926241874694824
local_in_edges_tensor generation:  0.27396059036254883
mini_batch_src_global generation:  0.5015039443969727
r_  generation:  4.197840929031372
local_output_nid generation:  0.22057628631591797
local_in_edges_tensor generation:  0.4940226078033447
mini_batch_src_global generation:  0.6600492000579834
r_  generation:  7.833807468414307
local_output_nid generation:  0.34685659408569336
local_in_edges_tensor generation:  0.871204137802124
mini_batch_src_global generation:  1.0236549377441406
r_  generation:  11.097153902053833
local_output_nid generation:  0.3192331790924072
local_in_edges_tensor generation:  0.6894669532775879
mini_batch_src_global generation:  1.0885865688323975
r_  generation:  11.060037851333618
local_output_nid generation:  0.32529306411743164
local_in_edges_tensor generation:  0.8054888248443604
mini_batch_src_global generation:  1.0373303890228271
r_  generation:  10.499081134796143
local_output_nid generation:  0.24933600425720215
local_in_edges_tensor generation:  0.5209102630615234
mini_batch_src_global generation:  0.8631761074066162
r_  generation:  8.362206220626831
local_output_nid generation:  0.2800147533416748
local_in_edges_tensor generation:  0.7567188739776611
mini_batch_src_global generation:  0.8997554779052734
r_  generation:  9.57073187828064
----------------------check_connections_block total spend ----------------------------- 138.3029065132141
generate_one_block  10.72552490234375
generate_one_block  8.783020734786987
generate_one_block  7.810764789581299
generate_one_block  10.25705099105835
generate_one_block  10.07062840461731
generate_one_block  5.4111058712005615
generate_one_block  9.70914340019226
generate_one_block  14.57931137084961
generate_one_block  13.875431537628174
generate_one_block  13.671808958053589
generate_one_block  10.376694202423096
generate_one_block  12.302240133285522
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1255180835723877
gen group dst list time:  0.7442214488983154
time for parepare:  0.47711706161499023
local_output_nid generation:  0.5740540027618408
local_in_edges_tensor generation:  1.2002184391021729
mini_batch_src_global generation:  1.019174575805664
r_  generation:  14.108507633209229
local_output_nid generation:  0.5435171127319336
local_in_edges_tensor generation:  1.0217385292053223
mini_batch_src_global generation:  1.2917442321777344
r_  generation:  13.342594385147095
local_output_nid generation:  0.5336863994598389
local_in_edges_tensor generation:  0.9608516693115234
mini_batch_src_global generation:  1.321993112564087
r_  generation:  14.346831321716309
local_output_nid generation:  0.626727819442749
local_in_edges_tensor generation:  1.2161893844604492
mini_batch_src_global generation:  1.560929536819458
r_  generation:  15.287535667419434
local_output_nid generation:  0.6649973392486572
local_in_edges_tensor generation:  1.3596444129943848
mini_batch_src_global generation:  1.4222486019134521
r_  generation:  15.920212745666504
local_output_nid generation:  0.4757068157196045
local_in_edges_tensor generation:  0.9482004642486572
mini_batch_src_global generation:  1.173952341079712
r_  generation:  11.28660249710083
local_output_nid generation:  0.578688383102417
local_in_edges_tensor generation:  1.0367975234985352
mini_batch_src_global generation:  1.3988053798675537
r_  generation:  15.18257451057434
local_output_nid generation:  0.7093803882598877
local_in_edges_tensor generation:  1.298213005065918
mini_batch_src_global generation:  1.5964128971099854
r_  generation:  16.575788259506226
local_output_nid generation:  0.6744577884674072
local_in_edges_tensor generation:  1.2599027156829834
mini_batch_src_global generation:  1.5025708675384521
r_  generation:  16.458401203155518
local_output_nid generation:  0.6612522602081299
local_in_edges_tensor generation:  1.28263521194458
mini_batch_src_global generation:  1.6351954936981201
r_  generation:  16.560603380203247
local_output_nid generation:  0.5926079750061035
local_in_edges_tensor generation:  1.0460271835327148
mini_batch_src_global generation:  1.5004651546478271
r_  generation:  14.865397214889526
local_output_nid generation:  0.6386425495147705
local_in_edges_tensor generation:  1.1884040832519531
mini_batch_src_global generation:  1.451206922531128
r_  generation:  15.37813401222229
----------------------check_connections_block total spend ----------------------------- 250.12031745910645
generate_one_block  19.494848251342773
generate_one_block  18.124683141708374
generate_one_block  17.309746026992798
generate_one_block  19.35446572303772
generate_one_block  20.08315944671631
generate_one_block  14.680026054382324
generate_one_block  19.83219289779663
generate_one_block  22.71693444252014
generate_one_block  21.156383275985718
generate_one_block  21.237095594406128
generate_one_block  18.945834159851074
generate_one_block  19.46137309074402
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.253474235534668
gen group dst list time:  1.0893285274505615
time for parepare:  0.46718525886535645
local_output_nid generation:  0.731734037399292
local_in_edges_tensor generation:  1.1660621166229248
mini_batch_src_global generation:  0.6016836166381836
r_  generation:  9.737115621566772
local_output_nid generation:  0.7865667343139648
local_in_edges_tensor generation:  1.134793996810913
mini_batch_src_global generation:  0.746368408203125
r_  generation:  9.69327187538147
local_output_nid generation:  0.7126815319061279
local_in_edges_tensor generation:  1.0670182704925537
mini_batch_src_global generation:  0.7991278171539307
r_  generation:  9.79201054573059
local_output_nid generation:  0.7826194763183594
local_in_edges_tensor generation:  1.018908977508545
mini_batch_src_global generation:  0.7401542663574219
r_  generation:  10.141474723815918
local_output_nid generation:  0.7880847454071045
local_in_edges_tensor generation:  1.0863635540008545
mini_batch_src_global generation:  0.8256444931030273
r_  generation:  10.23237943649292
local_output_nid generation:  0.724149227142334
local_in_edges_tensor generation:  1.0564968585968018
mini_batch_src_global generation:  0.8083987236022949
r_  generation:  9.570106267929077
local_output_nid generation:  0.7793786525726318
local_in_edges_tensor generation:  1.003709316253662
mini_batch_src_global generation:  0.7992219924926758
r_  generation:  10.490431547164917
local_output_nid generation:  0.8279156684875488
local_in_edges_tensor generation:  1.0829026699066162
mini_batch_src_global generation:  0.8169734477996826
r_  generation:  10.225047826766968
local_output_nid generation:  0.7381830215454102
local_in_edges_tensor generation:  1.0641567707061768
mini_batch_src_global generation:  0.8753662109375
r_  generation:  10.460040092468262
local_output_nid generation:  0.8079977035522461
local_in_edges_tensor generation:  1.0421433448791504
mini_batch_src_global generation:  0.80812668800354
r_  generation:  10.533758878707886
local_output_nid generation:  0.7929365634918213
local_in_edges_tensor generation:  1.0671789646148682
mini_batch_src_global generation:  0.8150510787963867
r_  generation:  10.159054517745972
local_output_nid generation:  0.7513284683227539
local_in_edges_tensor generation:  1.0747404098510742
mini_batch_src_global generation:  0.8731491565704346
r_  generation:  9.987582921981812
----------------------check_connections_block total spend ----------------------------- 178.67194437980652
generate_one_block  12.859863758087158
generate_one_block  12.581153631210327
generate_one_block  11.9603910446167
generate_one_block  12.707606792449951
generate_one_block  12.657305240631104
generate_one_block  12.049261093139648
generate_one_block  12.7946298122406
generate_one_block  13.921548128128052
generate_one_block  12.898390531539917
generate_one_block  12.830360174179077
generate_one_block  12.29250168800354
generate_one_block  12.665621995925903
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

connection checking time:  614.5221312046051
block generation total time  557.5219798088074
average batch blocks generation time:  9.292032996813457
block dataloader generation time/epoch 1296.9071476459503
pseudo mini batch 0 input nodes size: 2220500
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8298702239990234  GigaBytes
Max Memory Allocated: 0.8298702239990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8299894332885742  GigaBytes
Max Memory Allocated: 0.8299894332885742  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8455810546875 GB
    Memory Allocated: 0.8299894332885742  GigaBytes
Max Memory Allocated: 0.8299894332885742  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 1.4129867553710938  GigaBytes
Max Memory Allocated: 1.4129867553710938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5155029296875 GB
    Memory Allocated: 1.4129867553710938  GigaBytes
Max Memory Allocated: 1.4129867553710938  GigaBytes

first layer input nodes number: 2220500
first layer output nodes number: 2131045
edges number: 19053402
torch.Size([2220500, 100])
torch.Size([2131045, 256])
input nodes number: 2131045
output nodes number: 1674205
edges number: 33624111
torch.Size([2131045, 256])
torch.Size([1674205, 256])
input nodes number: 1674205
output nodes number: 766365
edges number: 18826193
torch.Size([1674205, 256])
torch.Size([766365, 256])
input nodes number: 766365
output nodes number: 180642
edges number: 5944939
torch.Size([766365, 256])
torch.Size([180642, 256])
torch.Size([15956, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.1600341796875 GB
    Memory Allocated: 15.62568712234497  GigaBytes
Max Memory Allocated: 15.771186351776123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.1600341796875 GB
    Memory Allocated: 15.6284818649292  GigaBytes
Max Memory Allocated: 15.771186351776123  GigaBytes

