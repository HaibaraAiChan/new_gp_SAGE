main start at this time 1656133131.6764412
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.5191929340362549
global_2_local spend time (sec) 0.5195777416229248
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.12305378913879395
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1256292, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.1435863971710205
auxiliary_graph
Graph(num_nodes=1452863, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7563052177429199
remove nodes length  1256292

auxiliary_graph.remove_nodes spent  8.212560653686523
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.488843202590942

the counter of shared neighbor distribution
Counter({1.0: 96835744, 2.0: 19827062, 3.0: 7693924, 4.0: 3791436, 5.0: 2140070, 6.0: 1318556, 7.0: 866322, 8.0: 595048, 9.0: 426444, 10.0: 310458, 11.0: 236344, 12.0: 183078, 13.0: 142976, 14.0: 106950, 15.0: 85820, 16.0: 67340, 17.0: 50862, 18.0: 42392, 19.0: 33792, 20.0: 28390, 21.0: 20868, 22.0: 18984, 23.0: 15084, 24.0: 12878, 25.0: 10746, 26.0: 9024, 27.0: 7364, 28.0: 6868, 30.0: 4276, 29.0: 4242, 31.0: 3522, 33.0: 3520, 32.0: 2852, 48.0: 2580, 35.0: 2468, 39.0: 2416, 36.0: 2416, 37.0: 2404, 34.0: 2034, 38.0: 2032, 40.0: 1910, 43.0: 1782, 41.0: 1508, 47.0: 1452, 44.0: 1420, 42.0: 1374, 49.0: 1218, 45.0: 1128, 46.0: 874, 50.0: 420})
134932672
Convert a graph into a bidirected graph: 9.576 seconds
Metis partitioning: 30.057 seconds
Split the graph: 6.563 seconds
Construct subgraphs: 0.049 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  46.300063133239746
31851
32677
33537
33512
31968
33026
total k batches seeds list generation spend  87.88067531585693
after graph partition
graph partition algorithm spend time 89.10014772415161
31851
32677
33537
33512
31968
33026
partition_len_list
[350196, 317739, 384580, 277853, 364831, 290824]
REG selection method  spend 89.94268918037415
time for parepare:  0.36824536323547363
local_output_nid generation:  0.007388591766357422
local_in_edges_tensor generation:  0.013822555541992188
mini_batch_src_global generation:  0.04450392723083496
r_  generation:  0.5068204402923584
local_output_nid generation:  0.007919549942016602
local_in_edges_tensor generation:  0.032381296157836914
mini_batch_src_global generation:  0.06967544555664062
r_  generation:  0.6366086006164551
local_output_nid generation:  0.008944034576416016
local_in_edges_tensor generation:  0.05438685417175293
mini_batch_src_global generation:  0.06549239158630371
r_  generation:  0.6898891925811768
local_output_nid generation:  0.008996009826660156
local_in_edges_tensor generation:  0.022101879119873047
mini_batch_src_global generation:  0.05824089050292969
r_  generation:  0.6080679893493652
local_output_nid generation:  0.007828235626220703
local_in_edges_tensor generation:  0.013938665390014648
mini_batch_src_global generation:  0.054412841796875
r_  generation:  0.6256093978881836
local_output_nid generation:  0.007817506790161133
local_in_edges_tensor generation:  0.026473045349121094
mini_batch_src_global generation:  0.06095600128173828
r_  generation:  0.6230900287628174
----------------------check_connections_block total spend ----------------------------- 5.3401525020599365
generate_one_block  2.156386137008667
generate_one_block  0.872464656829834
generate_one_block  0.9258086681365967
generate_one_block  0.8826172351837158
generate_one_block  0.7410166263580322
generate_one_block  0.7320125102996826
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.3609185218811035
gen group dst list time:  0.05628848075866699
time for parepare:  0.46685004234313965
local_output_nid generation:  0.10466217994689941
local_in_edges_tensor generation:  0.3842027187347412
mini_batch_src_global generation:  0.381009578704834
r_  generation:  4.76812481880188
local_output_nid generation:  0.15031003952026367
local_in_edges_tensor generation:  0.3520841598510742
mini_batch_src_global generation:  0.44478774070739746
r_  generation:  4.356391668319702
local_output_nid generation:  0.1986231803894043
local_in_edges_tensor generation:  0.4590492248535156
mini_batch_src_global generation:  0.5045366287231445
r_  generation:  5.4710373878479
local_output_nid generation:  0.06692075729370117
local_in_edges_tensor generation:  0.25523853302001953
mini_batch_src_global generation:  0.4372992515563965
r_  generation:  3.503483295440674
local_output_nid generation:  0.12943029403686523
local_in_edges_tensor generation:  0.3460428714752197
mini_batch_src_global generation:  0.422821044921875
r_  generation:  4.6216630935668945
local_output_nid generation:  0.0759897232055664
local_in_edges_tensor generation:  0.2091219425201416
mini_batch_src_global generation:  0.3703303337097168
r_  generation:  3.513641595840454
----------------------check_connections_block total spend ----------------------------- 36.687315940856934
generate_one_block  6.843943357467651
generate_one_block  5.390897750854492
generate_one_block  7.035690546035767
generate_one_block  4.481144666671753
generate_one_block  6.431505918502808
generate_one_block  4.367611885070801
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.5012807846069336
gen group dst list time:  0.22689390182495117
time for parepare:  0.4716458320617676
local_output_nid generation:  0.3674182891845703
local_in_edges_tensor generation:  1.013193130493164
mini_batch_src_global generation:  0.9615921974182129
r_  generation:  13.118030548095703
local_output_nid generation:  0.3183135986328125
local_in_edges_tensor generation:  0.9846036434173584
mini_batch_src_global generation:  1.1276791095733643
r_  generation:  10.467804670333862
local_output_nid generation:  0.37865471839904785
local_in_edges_tensor generation:  0.8765969276428223
mini_batch_src_global generation:  1.1599726676940918
r_  generation:  12.3025643825531
local_output_nid generation:  0.2926976680755615
local_in_edges_tensor generation:  0.6792216300964355
mini_batch_src_global generation:  0.8836040496826172
r_  generation:  8.808882474899292
local_output_nid generation:  0.4065256118774414
local_in_edges_tensor generation:  1.0085725784301758
mini_batch_src_global generation:  1.1126573085784912
r_  generation:  13.313454866409302
local_output_nid generation:  0.3107926845550537
local_in_edges_tensor generation:  0.5843989849090576
mini_batch_src_global generation:  0.9492237567901611
r_  generation:  9.461447715759277
----------------------check_connections_block total spend ----------------------------- 93.26243138313293
generate_one_block  17.244204998016357
generate_one_block  12.84163498878479
generate_one_block  15.55531096458435
generate_one_block  10.900516748428345
generate_one_block  17.31144380569458
generate_one_block  12.32314920425415
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.134047031402588
gen group dst list time:  0.3919105529785156
time for parepare:  0.488633394241333
local_output_nid generation:  0.6341125965118408
local_in_edges_tensor generation:  1.371180534362793
mini_batch_src_global generation:  1.1975903511047363
r_  generation:  17.02867078781128
local_output_nid generation:  0.6158432960510254
local_in_edges_tensor generation:  1.340583324432373
mini_batch_src_global generation:  1.542173147201538
r_  generation:  15.469619035720825
local_output_nid generation:  0.6231648921966553
local_in_edges_tensor generation:  1.172748327255249
mini_batch_src_global generation:  1.4251275062561035
r_  generation:  16.621761083602905
local_output_nid generation:  0.6261823177337646
local_in_edges_tensor generation:  1.161409854888916
mini_batch_src_global generation:  1.5160083770751953
r_  generation:  15.660714626312256
local_output_nid generation:  0.705146074295044
local_in_edges_tensor generation:  1.3505711555480957
mini_batch_src_global generation:  1.700458288192749
r_  generation:  17.928985834121704
local_output_nid generation:  0.6376438140869141
local_in_edges_tensor generation:  1.2105371952056885
mini_batch_src_global generation:  1.4286835193634033
r_  generation:  16.145638704299927
----------------------check_connections_block total spend ----------------------------- 137.5794758796692
generate_one_block  22.214335918426514
generate_one_block  20.12850332260132
generate_one_block  21.100778579711914
generate_one_block  20.21207618713379
generate_one_block  22.802603483200073
generate_one_block  20.43846845626831
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1769070625305176
gen group dst list time:  0.5837228298187256
time for parepare:  0.48848605155944824
local_output_nid generation:  0.738530158996582
local_in_edges_tensor generation:  1.3338687419891357
mini_batch_src_global generation:  0.6420886516571045
r_  generation:  10.251917362213135
local_output_nid generation:  0.7783403396606445
local_in_edges_tensor generation:  1.1084775924682617
mini_batch_src_global generation:  0.780623197555542
r_  generation:  10.030480861663818
local_output_nid generation:  0.7509996891021729
local_in_edges_tensor generation:  1.0427982807159424
mini_batch_src_global generation:  0.7895946502685547
r_  generation:  10.132830142974854
local_output_nid generation:  0.7473042011260986
local_in_edges_tensor generation:  1.0570940971374512
mini_batch_src_global generation:  0.8459815979003906
r_  generation:  10.235304355621338
local_output_nid generation:  0.7921657562255859
local_in_edges_tensor generation:  1.708636999130249
mini_batch_src_global generation:  0.806596040725708
r_  generation:  10.574472427368164
local_output_nid generation:  0.7390596866607666
local_in_edges_tensor generation:  1.0545079708099365
mini_batch_src_global generation:  0.8387327194213867
r_  generation:  10.136903762817383
----------------------check_connections_block total spend ----------------------------- 91.30996322631836
generate_one_block  13.116182565689087
generate_one_block  12.669849395751953
generate_one_block  12.475634574890137
generate_one_block  13.31085753440857
generate_one_block  13.135766983032227
generate_one_block  12.651069164276123
----------===============-------------===============-------------the number of batches *****---- 6

original number of batches:  6
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

connection checking time:  364.17933893203735
block generation total time  331.2934868335724
average batch blocks generation time:  11.043116227785747
block dataloader generation time/epoch 814.0182647705078
pseudo mini batch 0 input nodes size: 2299889
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.8591670989990234  GigaBytes
Max Memory Allocated: 0.8591670989990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.8594045639038086  GigaBytes
Max Memory Allocated: 0.8594045639038086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.8594045639038086  GigaBytes
Max Memory Allocated: 0.8594045639038086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.6251001358032227  GigaBytes
Max Memory Allocated: 1.6251001358032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7225341796875 GB
    Memory Allocated: 1.6251001358032227  GigaBytes
Max Memory Allocated: 1.6251001358032227  GigaBytes

first layer input nodes number: 2299889
first layer output nodes number: 2238223
edges number: 19815939
torch.Size([2299889, 100])
torch.Size([2238223, 256])
input nodes number: 2238223
output nodes number: 1956554
edges number: 38425165
torch.Size([2238223, 256])
torch.Size([1956554, 256])
input nodes number: 1956554
output nodes number: 1220170
edges number: 30888603
torch.Size([1956554, 256])
torch.Size([1220170, 256])
input nodes number: 1220170
output nodes number: 350196
edges number: 12106708
torch.Size([1220170, 256])
torch.Size([350196, 256])
torch.Size([31851, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 19.140525817871094  GigaBytes
Max Memory Allocated: 19.422290802001953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.4471435546875 GB
    Memory Allocated: 19.14630365371704  GigaBytes
Max Memory Allocated: 19.422290802001953  GigaBytes

