main start at this time 1656141958.5145943
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.6641004085540771
global_2_local spend time (sec) 0.5009036064147949
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.09780693054199219
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1256292, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.15291380882263184
auxiliary_graph
Graph(num_nodes=1452863, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.737330436706543
remove nodes length  1256292

auxiliary_graph.remove_nodes spent  8.503566026687622
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.624066352844238

the counter of shared neighbor distribution
Counter({1.0: 96835744, 2.0: 19827062, 3.0: 7693924, 4.0: 3791436, 5.0: 2140070, 6.0: 1318556, 7.0: 866322, 8.0: 595048, 9.0: 426444, 10.0: 310458, 11.0: 236344, 12.0: 183078, 13.0: 142976, 14.0: 106950, 15.0: 85820, 16.0: 67340, 17.0: 50862, 18.0: 42392, 19.0: 33792, 20.0: 28390, 21.0: 20868, 22.0: 18984, 23.0: 15084, 24.0: 12878, 25.0: 10746, 26.0: 9024, 27.0: 7364, 28.0: 6868, 30.0: 4276, 29.0: 4242, 31.0: 3522, 33.0: 3520, 32.0: 2852, 48.0: 2580, 35.0: 2468, 39.0: 2416, 36.0: 2416, 37.0: 2404, 34.0: 2034, 38.0: 2032, 40.0: 1910, 43.0: 1782, 41.0: 1508, 47.0: 1452, 44.0: 1420, 42.0: 1374, 49.0: 1218, 45.0: 1128, 46.0: 874, 50.0: 420})
134932672
Convert a graph into a bidirected graph: 9.754 seconds
Metis partitioning: 34.606 seconds
Split the graph: 2.289 seconds
Construct subgraphs: 0.984 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  47.6886932849884
6100
6306
6321
6315
5967
6024
5963
6322
6293
5999
6327
5963
6060
5965
6314
6319
6321
6300
6225
6232
5994
5966
6037
6326
6006
6321
5963
6076
5965
5970
5984
6327
total k batches seeds list generation spend  89.51222491264343
after graph partition
graph partition algorithm spend time 90.42726492881775
6100
6306
6321
6315
5967
6024
5963
6322
6293
5999
6327
5963
6060
5965
6314
6319
6321
6300
6225
6232
5994
5966
6037
6326
6006
6321
5963
6076
5965
5970
5984
6327
partition_len_list
[79444, 88215, 83948, 98964, 72897, 60765, 90747, 62083, 71187, 73823, 91404, 98446, 65097, 76309, 82940, 79285, 76830, 64108, 103775, 97237, 86602, 63282, 88853, 94991, 92291, 85614, 85369, 81387, 116084, 98206, 86649, 98996]
REG selection method  spend 91.21764135360718
time for parepare:  0.3378608226776123
local_output_nid generation:  0.0024030208587646484
local_in_edges_tensor generation:  0.005199432373046875
mini_batch_src_global generation:  0.012275934219360352
r_  generation:  0.08618879318237305
local_output_nid generation:  0.0025496482849121094
local_in_edges_tensor generation:  0.004174470901489258
mini_batch_src_global generation:  0.012919425964355469
r_  generation:  0.10279679298400879
local_output_nid generation:  0.002607107162475586
local_in_edges_tensor generation:  0.0038192272186279297
mini_batch_src_global generation:  0.01109170913696289
r_  generation:  0.10199093818664551
local_output_nid generation:  0.002614259719848633
local_in_edges_tensor generation:  0.0034291744232177734
mini_batch_src_global generation:  0.011145830154418945
r_  generation:  0.1094050407409668
local_output_nid generation:  0.002481698989868164
local_in_edges_tensor generation:  0.0035152435302734375
mini_batch_src_global generation:  0.010119915008544922
r_  generation:  0.0893707275390625
local_output_nid generation:  0.0025184154510498047
local_in_edges_tensor generation:  0.0031080245971679688
mini_batch_src_global generation:  0.009379863739013672
r_  generation:  0.08549857139587402
local_output_nid generation:  0.002524137496948242
local_in_edges_tensor generation:  0.0031347274780273438
mini_batch_src_global generation:  0.00989985466003418
r_  generation:  0.09362959861755371
local_output_nid generation:  0.0026488304138183594
local_in_edges_tensor generation:  0.003332853317260742
mini_batch_src_global generation:  0.01127481460571289
r_  generation:  0.09865307807922363
local_output_nid generation:  0.0025773048400878906
local_in_edges_tensor generation:  0.0032820701599121094
mini_batch_src_global generation:  0.010818958282470703
r_  generation:  0.09650444984436035
local_output_nid generation:  0.0024907588958740234
local_in_edges_tensor generation:  0.0032148361206054688
mini_batch_src_global generation:  0.016273021697998047
r_  generation:  0.09801125526428223
local_output_nid generation:  0.0026412010192871094
local_in_edges_tensor generation:  0.008883476257324219
mini_batch_src_global generation:  0.011675834655761719
r_  generation:  0.10764193534851074
local_output_nid generation:  0.002544879913330078
local_in_edges_tensor generation:  0.005722522735595703
mini_batch_src_global generation:  0.011182785034179688
r_  generation:  0.10426831245422363
local_output_nid generation:  0.0025429725646972656
local_in_edges_tensor generation:  0.0049707889556884766
mini_batch_src_global generation:  0.010567665100097656
r_  generation:  0.09527802467346191
local_output_nid generation:  0.0035021305084228516
local_in_edges_tensor generation:  0.009575605392456055
mini_batch_src_global generation:  0.010839462280273438
r_  generation:  0.09473967552185059
local_output_nid generation:  0.002640962600708008
local_in_edges_tensor generation:  0.008115530014038086
mini_batch_src_global generation:  0.013671636581420898
r_  generation:  0.10089230537414551
local_output_nid generation:  0.0026535987854003906
local_in_edges_tensor generation:  0.00655364990234375
mini_batch_src_global generation:  0.011433839797973633
r_  generation:  0.1014258861541748
local_output_nid generation:  0.0026726722717285156
local_in_edges_tensor generation:  0.005991458892822266
mini_batch_src_global generation:  0.010543346405029297
r_  generation:  0.09286379814147949
local_output_nid generation:  0.0026128292083740234
local_in_edges_tensor generation:  0.004706859588623047
mini_batch_src_global generation:  0.022194623947143555
r_  generation:  0.0927879810333252
local_output_nid generation:  0.0026688575744628906
local_in_edges_tensor generation:  0.005442619323730469
mini_batch_src_global generation:  0.012566804885864258
r_  generation:  0.115203857421875
local_output_nid generation:  0.002652883529663086
local_in_edges_tensor generation:  0.003961324691772461
mini_batch_src_global generation:  0.014463186264038086
r_  generation:  0.11652874946594238
local_output_nid generation:  0.0025610923767089844
local_in_edges_tensor generation:  0.003702402114868164
mini_batch_src_global generation:  0.009318113327026367
r_  generation:  0.08371353149414062
local_output_nid generation:  0.003977775573730469
local_in_edges_tensor generation:  0.003336191177368164
mini_batch_src_global generation:  0.009801864624023438
r_  generation:  0.08640241622924805
local_output_nid generation:  0.0026111602783203125
local_in_edges_tensor generation:  0.0032007694244384766
mini_batch_src_global generation:  0.009484291076660156
r_  generation:  0.09287309646606445
local_output_nid generation:  0.002629995346069336
local_in_edges_tensor generation:  0.003421306610107422
mini_batch_src_global generation:  0.011611700057983398
r_  generation:  0.10886001586914062
local_output_nid generation:  0.0025396347045898438
local_in_edges_tensor generation:  0.0033042430877685547
mini_batch_src_global generation:  0.0111541748046875
r_  generation:  0.11110377311706543
local_output_nid generation:  0.002632617950439453
local_in_edges_tensor generation:  0.045993804931640625
mini_batch_src_global generation:  0.012684106826782227
r_  generation:  0.10988187789916992
local_output_nid generation:  0.0025238990783691406
local_in_edges_tensor generation:  0.0032088756561279297
mini_batch_src_global generation:  0.011553764343261719
r_  generation:  0.10585927963256836
local_output_nid generation:  0.0025491714477539062
local_in_edges_tensor generation:  0.003293752670288086
mini_batch_src_global generation:  0.011871576309204102
r_  generation:  0.10600900650024414
local_output_nid generation:  0.0024967193603515625
local_in_edges_tensor generation:  0.0032117366790771484
mini_batch_src_global generation:  0.011348724365234375
r_  generation:  0.11726903915405273
local_output_nid generation:  0.0025815963745117188
local_in_edges_tensor generation:  0.003799915313720703
mini_batch_src_global generation:  0.012953758239746094
r_  generation:  0.11132431030273438
local_output_nid generation:  0.002517223358154297
local_in_edges_tensor generation:  0.0032083988189697266
mini_batch_src_global generation:  0.011319637298583984
r_  generation:  0.10986971855163574
local_output_nid generation:  0.0026369094848632812
local_in_edges_tensor generation:  0.0033326148986816406
mini_batch_src_global generation:  0.013036012649536133
r_  generation:  0.11820530891418457
----------------------check_connections_block total spend ----------------------------- 4.988377332687378
generate_one_block  1.6045727729797363
generate_one_block  0.1425776481628418
generate_one_block  0.14227700233459473
generate_one_block  0.15002107620239258
generate_one_block  0.12512564659118652
generate_one_block  0.12240028381347656
generate_one_block  0.1246635913848877
generate_one_block  0.14487004280090332
generate_one_block  0.13448357582092285
generate_one_block  0.1330432891845703
generate_one_block  0.13799738883972168
generate_one_block  0.13280105590820312
generate_one_block  0.12869834899902344
generate_one_block  0.13267827033996582
generate_one_block  0.13664698600769043
generate_one_block  0.14319372177124023
generate_one_block  0.13820171356201172
generate_one_block  0.1304025650024414
generate_one_block  0.16523957252502441
generate_one_block  0.157745361328125
generate_one_block  0.11781907081604004
generate_one_block  0.12092995643615723
generate_one_block  0.14279985427856445
generate_one_block  0.1550309658050537
generate_one_block  0.16061043739318848
generate_one_block  0.17173385620117188
generate_one_block  0.1562330722808838
generate_one_block  0.1552727222442627
generate_one_block  0.17719650268554688
generate_one_block  0.16088223457336426
generate_one_block  0.16987299919128418
generate_one_block  0.16833162307739258
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.1874678134918213
gen group dst list time:  0.0806417465209961
time for parepare:  0.4568197727203369
local_output_nid generation:  0.024193525314331055
local_in_edges_tensor generation:  0.25662732124328613
mini_batch_src_global generation:  0.0775909423828125
r_  generation:  0.9320461750030518
local_output_nid generation:  0.03148341178894043
local_in_edges_tensor generation:  0.1260206699371338
mini_batch_src_global generation:  0.11707234382629395
r_  generation:  1.166022777557373
local_output_nid generation:  0.09280085563659668
local_in_edges_tensor generation:  0.12829303741455078
mini_batch_src_global generation:  0.1103062629699707
r_  generation:  1.0740389823913574
local_output_nid generation:  0.04066801071166992
local_in_edges_tensor generation:  0.12122917175292969
mini_batch_src_global generation:  0.13608813285827637
r_  generation:  1.3034977912902832
local_output_nid generation:  0.02733755111694336
local_in_edges_tensor generation:  0.08648276329040527
mini_batch_src_global generation:  0.10279393196105957
r_  generation:  0.8984293937683105
local_output_nid generation:  0.028045177459716797
local_in_edges_tensor generation:  0.08468747138977051
mini_batch_src_global generation:  0.09580874443054199
r_  generation:  0.65444016456604
local_output_nid generation:  0.042591094970703125
local_in_edges_tensor generation:  0.08566832542419434
mini_batch_src_global generation:  0.10442471504211426
r_  generation:  1.0708038806915283
local_output_nid generation:  0.020885467529296875
local_in_edges_tensor generation:  0.05206179618835449
mini_batch_src_global generation:  0.08787059783935547
r_  generation:  0.726515531539917
local_output_nid generation:  0.02450871467590332
local_in_edges_tensor generation:  0.045029401779174805
mini_batch_src_global generation:  0.09113502502441406
r_  generation:  0.9164493083953857
local_output_nid generation:  0.024311065673828125
local_in_edges_tensor generation:  0.08853435516357422
mini_batch_src_global generation:  0.09738874435424805
r_  generation:  0.9114797115325928
local_output_nid generation:  0.027837514877319336
local_in_edges_tensor generation:  0.09468746185302734
mini_batch_src_global generation:  0.10690879821777344
r_  generation:  1.1078674793243408
local_output_nid generation:  0.039188385009765625
local_in_edges_tensor generation:  0.11131668090820312
mini_batch_src_global generation:  0.12427353858947754
r_  generation:  1.2756037712097168
local_output_nid generation:  0.03635573387145996
local_in_edges_tensor generation:  0.0388185977935791
mini_batch_src_global generation:  0.09183883666992188
r_  generation:  0.7578871250152588
local_output_nid generation:  0.02857065200805664
local_in_edges_tensor generation:  0.06363487243652344
mini_batch_src_global generation:  0.09746074676513672
r_  generation:  0.9085426330566406
local_output_nid generation:  0.02704167366027832
local_in_edges_tensor generation:  0.06036567687988281
mini_batch_src_global generation:  0.10458946228027344
r_  generation:  0.9760305881500244
local_output_nid generation:  0.026045560836791992
local_in_edges_tensor generation:  0.04135489463806152
mini_batch_src_global generation:  0.09869980812072754
r_  generation:  0.9089317321777344
local_output_nid generation:  0.023667097091674805
local_in_edges_tensor generation:  0.04160618782043457
mini_batch_src_global generation:  0.09353423118591309
r_  generation:  0.8844618797302246
local_output_nid generation:  0.01874542236328125
local_in_edges_tensor generation:  0.031830787658691406
mini_batch_src_global generation:  0.07956504821777344
r_  generation:  0.6680316925048828
local_output_nid generation:  0.031463623046875
local_in_edges_tensor generation:  0.08076596260070801
mini_batch_src_global generation:  0.13450002670288086
r_  generation:  1.439342975616455
local_output_nid generation:  0.02883172035217285
local_in_edges_tensor generation:  0.3224763870239258
mini_batch_src_global generation:  0.13901185989379883
r_  generation:  1.3145606517791748
local_output_nid generation:  0.02720808982849121
local_in_edges_tensor generation:  0.09281015396118164
mini_batch_src_global generation:  0.1200096607208252
r_  generation:  1.2420353889465332
local_output_nid generation:  0.027512788772583008
local_in_edges_tensor generation:  0.04352569580078125
mini_batch_src_global generation:  0.09876275062561035
r_  generation:  0.835477352142334
local_output_nid generation:  0.04893016815185547
local_in_edges_tensor generation:  0.05974411964416504
mini_batch_src_global generation:  0.11456751823425293
r_  generation:  1.2303426265716553
local_output_nid generation:  0.0321042537689209
local_in_edges_tensor generation:  0.07636666297912598
mini_batch_src_global generation:  0.1331329345703125
r_  generation:  1.2865657806396484
local_output_nid generation:  0.03208518028259277
local_in_edges_tensor generation:  0.0686197280883789
mini_batch_src_global generation:  0.1278514862060547
r_  generation:  1.3192386627197266
local_output_nid generation:  0.028389930725097656
local_in_edges_tensor generation:  0.041352033615112305
mini_batch_src_global generation:  0.13057208061218262
r_  generation:  1.1674327850341797
local_output_nid generation:  0.02853536605834961
local_in_edges_tensor generation:  0.05524110794067383
mini_batch_src_global generation:  0.12003326416015625
r_  generation:  1.1559653282165527
local_output_nid generation:  0.028084993362426758
local_in_edges_tensor generation:  0.037301063537597656
mini_batch_src_global generation:  0.12004661560058594
r_  generation:  1.0905935764312744
local_output_nid generation:  0.039704084396362305
local_in_edges_tensor generation:  0.10407567024230957
mini_batch_src_global generation:  0.16633081436157227
r_  generation:  1.6660914421081543
local_output_nid generation:  0.036309242248535156
local_in_edges_tensor generation:  0.10505270957946777
mini_batch_src_global generation:  0.15108799934387207
r_  generation:  1.3809163570404053
local_output_nid generation:  0.029079914093017578
local_in_edges_tensor generation:  0.07859301567077637
mini_batch_src_global generation:  0.12632489204406738
r_  generation:  1.2279877662658691
local_output_nid generation:  0.03427696228027344
local_in_edges_tensor generation:  0.09714245796203613
mini_batch_src_global generation:  0.15190792083740234
r_  generation:  1.3771154880523682
----------------------check_connections_block total spend ----------------------------- 49.67676568031311
generate_one_block  1.6921107769012451
generate_one_block  1.528794527053833
generate_one_block  1.4173901081085205
generate_one_block  1.7748816013336182
generate_one_block  1.0898656845092773
generate_one_block  0.8340661525726318
generate_one_block  1.3924524784088135
generate_one_block  0.927830696105957
generate_one_block  1.056269645690918
generate_one_block  1.1651639938354492
generate_one_block  1.4087107181549072
generate_one_block  1.670949935913086
generate_one_block  1.030717134475708
generate_one_block  1.1399710178375244
generate_one_block  1.2692887783050537
generate_one_block  1.1675059795379639
generate_one_block  1.0913054943084717
generate_one_block  0.8167159557342529
generate_one_block  1.8875961303710938
generate_one_block  1.737046718597412
generate_one_block  1.5284132957458496
generate_one_block  0.9864299297332764
generate_one_block  1.5674493312835693
generate_one_block  1.6605145931243896
generate_one_block  1.644873857498169
generate_one_block  1.459460973739624
generate_one_block  1.3760933876037598
generate_one_block  1.2854852676391602
generate_one_block  2.1252079010009766
generate_one_block  1.8004648685455322
generate_one_block  1.5400543212890625
generate_one_block  1.8343613147735596
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.4488043785095215
gen group dst list time:  0.4923691749572754
time for parepare:  0.4428105354309082
local_output_nid generation:  0.1636040210723877
local_in_edges_tensor generation:  0.5023612976074219
mini_batch_src_global generation:  0.4128248691558838
r_  generation:  5.27640700340271
local_output_nid generation:  0.14980530738830566
local_in_edges_tensor generation:  0.3309624195098877
mini_batch_src_global generation:  0.4801747798919678
r_  generation:  4.932540655136108
local_output_nid generation:  0.12963533401489258
local_in_edges_tensor generation:  0.4166908264160156
mini_batch_src_global generation:  0.42830562591552734
r_  generation:  4.302140474319458
local_output_nid generation:  0.20960521697998047
local_in_edges_tensor generation:  0.4220540523529053
mini_batch_src_global generation:  0.5355441570281982
r_  generation:  6.052431106567383
local_output_nid generation:  0.12929630279541016
local_in_edges_tensor generation:  0.27027177810668945
mini_batch_src_global generation:  0.4168848991394043
r_  generation:  3.7797226905822754
local_output_nid generation:  0.08397316932678223
local_in_edges_tensor generation:  0.16905665397644043
mini_batch_src_global generation:  0.2749171257019043
r_  generation:  2.455108404159546
local_output_nid generation:  0.15968108177185059
local_in_edges_tensor generation:  0.34413576126098633
mini_batch_src_global generation:  0.42931532859802246
r_  generation:  4.774810075759888
local_output_nid generation:  0.11391878128051758
local_in_edges_tensor generation:  0.23478126525878906
mini_batch_src_global generation:  0.3922402858734131
r_  generation:  3.40791392326355
local_output_nid generation:  0.13866925239562988
local_in_edges_tensor generation:  0.528409481048584
mini_batch_src_global generation:  0.4063107967376709
r_  generation:  4.348676681518555
local_output_nid generation:  0.15788793563842773
local_in_edges_tensor generation:  0.31998181343078613
mini_batch_src_global generation:  0.42534947395324707
r_  generation:  4.299953937530518
local_output_nid generation:  0.15907597541809082
local_in_edges_tensor generation:  0.30673742294311523
mini_batch_src_global generation:  0.4227004051208496
r_  generation:  4.348786115646362
local_output_nid generation:  0.1843247413635254
local_in_edges_tensor generation:  0.3923206329345703
mini_batch_src_global generation:  0.5234353542327881
r_  generation:  5.864051580429077
local_output_nid generation:  0.10806107521057129
local_in_edges_tensor generation:  0.22265410423278809
mini_batch_src_global generation:  0.4179401397705078
r_  generation:  3.283989429473877
local_output_nid generation:  0.13176417350769043
local_in_edges_tensor generation:  0.3815803527832031
mini_batch_src_global generation:  0.4017624855041504
r_  generation:  3.992361307144165
local_output_nid generation:  0.170501708984375
local_in_edges_tensor generation:  0.2734065055847168
mini_batch_src_global generation:  0.3760228157043457
r_  generation:  3.837139129638672
local_output_nid generation:  0.11230134963989258
local_in_edges_tensor generation:  0.21515798568725586
mini_batch_src_global generation:  0.3277120590209961
r_  generation:  3.173975944519043
local_output_nid generation:  0.13950347900390625
local_in_edges_tensor generation:  0.30622363090515137
mini_batch_src_global generation:  0.4116349220275879
r_  generation:  4.442107439041138
local_output_nid generation:  0.0910942554473877
local_in_edges_tensor generation:  0.19110393524169922
mini_batch_src_global generation:  0.33742189407348633
r_  generation:  2.847811222076416
local_output_nid generation:  0.2195572853088379
local_in_edges_tensor generation:  0.48526620864868164
mini_batch_src_global generation:  0.6180598735809326
r_  generation:  7.608858585357666
local_output_nid generation:  0.21723246574401855
local_in_edges_tensor generation:  0.5187513828277588
mini_batch_src_global generation:  0.6176729202270508
r_  generation:  6.136480808258057
local_output_nid generation:  0.2229294776916504
local_in_edges_tensor generation:  0.505150318145752
mini_batch_src_global generation:  0.6994130611419678
r_  generation:  7.568258047103882
local_output_nid generation:  0.14023756980895996
local_in_edges_tensor generation:  0.31099462509155273
mini_batch_src_global generation:  0.531503438949585
r_  generation:  4.718718528747559
local_output_nid generation:  0.22647356986999512
local_in_edges_tensor generation:  0.6341662406921387
mini_batch_src_global generation:  0.7000114917755127
r_  generation:  7.719902515411377
local_output_nid generation:  0.22314786911010742
local_in_edges_tensor generation:  0.4031789302825928
mini_batch_src_global generation:  0.6900770664215088
r_  generation:  6.6813976764678955
local_output_nid generation:  0.24347209930419922
local_in_edges_tensor generation:  0.5892293453216553
mini_batch_src_global generation:  0.6562411785125732
r_  generation:  7.283023357391357
local_output_nid generation:  0.21198582649230957
local_in_edges_tensor generation:  0.5017292499542236
mini_batch_src_global generation:  0.5916802883148193
r_  generation:  6.023650169372559
local_output_nid generation:  0.1483297348022461
local_in_edges_tensor generation:  0.32628941535949707
mini_batch_src_global generation:  0.5212502479553223
r_  generation:  4.999467372894287
local_output_nid generation:  0.13976287841796875
local_in_edges_tensor generation:  0.43935251235961914
mini_batch_src_global generation:  0.48581767082214355
r_  generation:  4.584867477416992
local_output_nid generation:  0.25253796577453613
local_in_edges_tensor generation:  0.521597146987915
mini_batch_src_global generation:  0.6840119361877441
r_  generation:  7.645813941955566
local_output_nid generation:  0.2263660430908203
local_in_edges_tensor generation:  0.5042281150817871
mini_batch_src_global generation:  0.756173849105835
r_  generation:  7.465600967407227
local_output_nid generation:  0.1575460433959961
local_in_edges_tensor generation:  0.44997072219848633
mini_batch_src_global generation:  0.5764069557189941
r_  generation:  5.4749367237091064
local_output_nid generation:  0.22417807579040527
local_in_edges_tensor generation:  0.4461839199066162
mini_batch_src_global generation:  0.5987355709075928
r_  generation:  6.1957385540008545
----------------------check_connections_block total spend ----------------------------- 229.83899426460266
generate_one_block  7.671167850494385
generate_one_block  6.580455541610718
generate_one_block  6.117316007614136
generate_one_block  7.855584621429443
generate_one_block  5.676339149475098
generate_one_block  3.0822863578796387
generate_one_block  6.318544387817383
generate_one_block  4.90903902053833
generate_one_block  5.504651308059692
generate_one_block  5.570143699645996
generate_one_block  5.5695202350616455
generate_one_block  7.471160411834717
generate_one_block  4.518433094024658
generate_one_block  5.157205820083618
generate_one_block  4.890895366668701
generate_one_block  3.905831813812256
generate_one_block  5.736872911453247
generate_one_block  3.8183302879333496
generate_one_block  9.8283371925354
generate_one_block  7.731695175170898
generate_one_block  9.643465042114258
generate_one_block  6.390027284622192
generate_one_block  9.765897274017334
generate_one_block  7.826162099838257
generate_one_block  9.118173122406006
generate_one_block  7.271160125732422
generate_one_block  6.161385774612427
generate_one_block  6.0820677280426025
generate_one_block  9.811502933502197
generate_one_block  9.455437660217285
generate_one_block  6.933981657028198
generate_one_block  8.226709842681885
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2659125328063965
gen group dst list time:  1.6478381156921387
time for parepare:  0.46976494789123535
local_output_nid generation:  0.5472228527069092
local_in_edges_tensor generation:  1.1790716648101807
mini_batch_src_global generation:  1.0381784439086914
r_  generation:  13.96814513206482
local_output_nid generation:  0.5547623634338379
local_in_edges_tensor generation:  1.0613622665405273
mini_batch_src_global generation:  1.2124526500701904
r_  generation:  12.782670021057129
local_output_nid generation:  0.4425532817840576
local_in_edges_tensor generation:  1.0532028675079346
mini_batch_src_global generation:  1.0950140953063965
r_  generation:  11.339035272598267
local_output_nid generation:  0.5775237083435059
local_in_edges_tensor generation:  0.9841403961181641
mini_batch_src_global generation:  1.216353178024292
r_  generation:  14.131459712982178
local_output_nid generation:  0.45301365852355957
local_in_edges_tensor generation:  0.9428832530975342
mini_batch_src_global generation:  1.0947458744049072
r_  generation:  11.158515930175781
local_output_nid generation:  0.36158037185668945
local_in_edges_tensor generation:  0.5789909362792969
mini_batch_src_global generation:  0.860004186630249
r_  generation:  8.213847637176514
local_output_nid generation:  0.48731303215026855
local_in_edges_tensor generation:  0.9957129955291748
mini_batch_src_global generation:  1.0595834255218506
r_  generation:  11.891971349716187
local_output_nid generation:  0.47080063819885254
local_in_edges_tensor generation:  0.7674593925476074
mini_batch_src_global generation:  1.0261735916137695
r_  generation:  10.8635094165802
local_output_nid generation:  0.45334792137145996
local_in_edges_tensor generation:  0.9286913871765137
mini_batch_src_global generation:  1.0487136840820312
r_  generation:  11.25380539894104
local_output_nid generation:  0.4896111488342285
local_in_edges_tensor generation:  0.8347301483154297
mini_batch_src_global generation:  1.0737009048461914
r_  generation:  12.030766248703003
local_output_nid generation:  0.44498515129089355
local_in_edges_tensor generation:  0.9324004650115967
mini_batch_src_global generation:  1.0522260665893555
r_  generation:  11.05282473564148
local_output_nid generation:  0.5763607025146484
local_in_edges_tensor generation:  0.9801638126373291
mini_batch_src_global generation:  1.1977458000183105
r_  generation:  13.83725380897522
local_output_nid generation:  0.3697013854980469
local_in_edges_tensor generation:  0.8138461112976074
mini_batch_src_global generation:  0.9583523273468018
r_  generation:  9.532632112503052
local_output_nid generation:  0.46613025665283203
local_in_edges_tensor generation:  0.7708806991577148
mini_batch_src_global generation:  0.9656176567077637
r_  generation:  11.00450611114502
local_output_nid generation:  0.42549586296081543
local_in_edges_tensor generation:  0.8821368217468262
mini_batch_src_global generation:  1.002715826034546
r_  generation:  10.696282863616943
local_output_nid generation:  0.3842329978942871
local_in_edges_tensor generation:  0.601409912109375
mini_batch_src_global generation:  0.8315234184265137
r_  generation:  8.63682746887207
local_output_nid generation:  0.45325160026550293
local_in_edges_tensor generation:  0.9905390739440918
mini_batch_src_global generation:  1.0667052268981934
r_  generation:  12.23292851448059
local_output_nid generation:  0.39981603622436523
local_in_edges_tensor generation:  0.6791136264801025
mini_batch_src_global generation:  0.977703332901001
r_  generation:  9.717843294143677
local_output_nid generation:  0.578538179397583
local_in_edges_tensor generation:  1.2059354782104492
mini_batch_src_global generation:  1.2992115020751953
r_  generation:  15.154801607131958
local_output_nid generation:  0.5642824172973633
local_in_edges_tensor generation:  0.9865846633911133
mini_batch_src_global generation:  1.441594123840332
r_  generation:  14.073036193847656
local_output_nid generation:  0.6361725330352783
local_in_edges_tensor generation:  1.1781504154205322
mini_batch_src_global generation:  1.3604345321655273
r_  generation:  14.848479986190796
local_output_nid generation:  0.48667430877685547
local_in_edges_tensor generation:  0.9758918285369873
mini_batch_src_global generation:  1.2940773963928223
r_  generation:  12.93516492843628
local_output_nid generation:  0.6313331127166748
local_in_edges_tensor generation:  1.136535406112671
mini_batch_src_global generation:  1.4062650203704834
r_  generation:  15.293109893798828
local_output_nid generation:  0.5331721305847168
local_in_edges_tensor generation:  1.1012654304504395
mini_batch_src_global generation:  1.3127155303955078
r_  generation:  13.971982479095459
local_output_nid generation:  0.5721337795257568
local_in_edges_tensor generation:  0.9963541030883789
mini_batch_src_global generation:  1.4595074653625488
r_  generation:  14.137807130813599
local_output_nid generation:  0.5738413333892822
local_in_edges_tensor generation:  1.1010184288024902
mini_batch_src_global generation:  1.2807140350341797
r_  generation:  14.2674880027771
local_output_nid generation:  0.4385712146759033
local_in_edges_tensor generation:  0.8918907642364502
mini_batch_src_global generation:  1.1733307838439941
r_  generation:  11.761447429656982
local_output_nid generation:  0.49239587783813477
local_in_edges_tensor generation:  0.8966207504272461
mini_batch_src_global generation:  1.1040291786193848
r_  generation:  12.237259149551392
local_output_nid generation:  0.5488204956054688
local_in_edges_tensor generation:  1.153310775756836
mini_batch_src_global generation:  1.322768211364746
r_  generation:  14.245740413665771
local_output_nid generation:  0.6053657531738281
local_in_edges_tensor generation:  1.041480541229248
mini_batch_src_global generation:  1.4885952472686768
r_  generation:  14.561358451843262
local_output_nid generation:  0.5062592029571533
local_in_edges_tensor generation:  0.9898636341094971
mini_batch_src_global generation:  1.2097485065460205
r_  generation:  12.585634231567383
local_output_nid generation:  0.47707247734069824
local_in_edges_tensor generation:  0.9589669704437256
mini_batch_src_global generation:  1.2407143115997314
r_  generation:  12.76641845703125
----------------------check_connections_block total spend ----------------------------- 551.8696286678314
generate_one_block  19.175812005996704
generate_one_block  17.31037402153015
generate_one_block  14.828296661376953
generate_one_block  18.430930614471436
generate_one_block  14.417957067489624
generate_one_block  10.682381868362427
generate_one_block  15.336843967437744
generate_one_block  14.212563753128052
generate_one_block  14.327790975570679
generate_one_block  15.471485614776611
generate_one_block  16.206390142440796
generate_one_block  18.00725555419922
generate_one_block  12.243244886398315
generate_one_block  13.792953491210938
generate_one_block  13.470279216766357
generate_one_block  10.985780239105225
generate_one_block  15.528103590011597
generate_one_block  12.43839168548584
generate_one_block  19.44957184791565
generate_one_block  18.33716583251953
generate_one_block  19.343870878219604
generate_one_block  16.376768589019775
generate_one_block  19.730015516281128
generate_one_block  20.31504464149475
generate_one_block  18.175668716430664
generate_one_block  17.981264352798462
generate_one_block  15.397034645080566
generate_one_block  15.041204929351807
generate_one_block  18.76857018470764
generate_one_block  18.809635877609253
generate_one_block  15.851485252380371
generate_one_block  16.49864101409912
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.183703899383545
gen group dst list time:  2.637481451034546
time for parepare:  0.49485182762145996
local_output_nid generation:  0.7619397640228271
local_in_edges_tensor generation:  1.2433996200561523
mini_batch_src_global generation:  0.6036863327026367
r_  generation:  9.58022952079773
local_output_nid generation:  0.7556312084197998
local_in_edges_tensor generation:  1.1206629276275635
mini_batch_src_global generation:  0.7667181491851807
r_  generation:  9.378263473510742
local_output_nid generation:  0.7013649940490723
local_in_edges_tensor generation:  0.9595897197723389
mini_batch_src_global generation:  0.7618305683135986
r_  generation:  9.385162115097046
local_output_nid generation:  0.7676780223846436
local_in_edges_tensor generation:  1.0624852180480957
mini_batch_src_global generation:  0.7547869682312012
r_  generation:  9.821179389953613
local_output_nid generation:  0.7295184135437012
local_in_edges_tensor generation:  0.9962866306304932
mini_batch_src_global generation:  0.7755990028381348
r_  generation:  9.64143419265747
local_output_nid generation:  0.6820628643035889
local_in_edges_tensor generation:  0.9492335319519043
mini_batch_src_global generation:  0.7099237442016602
r_  generation:  8.603662967681885
local_output_nid generation:  0.7149159908294678
local_in_edges_tensor generation:  0.9914767742156982
mini_batch_src_global generation:  0.7673258781433105
r_  generation:  9.70160722732544
local_output_nid generation:  0.73777174949646
local_in_edges_tensor generation:  1.0322151184082031
mini_batch_src_global generation:  0.7603330612182617
r_  generation:  9.403528690338135
local_output_nid generation:  0.6997649669647217
local_in_edges_tensor generation:  0.980170488357544
mini_batch_src_global generation:  0.7665176391601562
r_  generation:  9.64399266242981
local_output_nid generation:  0.7414863109588623
local_in_edges_tensor generation:  1.0337774753570557
mini_batch_src_global generation:  0.7595069408416748
r_  generation:  9.514271974563599
local_output_nid generation:  0.7046964168548584
local_in_edges_tensor generation:  0.9577734470367432
mini_batch_src_global generation:  0.7690074443817139
r_  generation:  9.617621898651123
local_output_nid generation:  0.7848999500274658
local_in_edges_tensor generation:  1.0724186897277832
mini_batch_src_global generation:  0.7867295742034912
r_  generation:  9.922770023345947
local_output_nid generation:  0.6761751174926758
local_in_edges_tensor generation:  0.899951696395874
mini_batch_src_global generation:  0.7938916683197021
r_  generation:  9.011523485183716
local_output_nid generation:  0.7210512161254883
local_in_edges_tensor generation:  1.0029196739196777
mini_batch_src_global generation:  0.7391119003295898
r_  generation:  9.305794715881348
local_output_nid generation:  0.7149314880371094
local_in_edges_tensor generation:  0.9576582908630371
mini_batch_src_global generation:  0.8054220676422119
r_  generation:  9.623307943344116
local_output_nid generation:  0.6786725521087646
local_in_edges_tensor generation:  0.9455835819244385
mini_batch_src_global generation:  0.7128188610076904
r_  generation:  8.699488639831543
local_output_nid generation:  0.6967859268188477
local_in_edges_tensor generation:  0.9609730243682861
mini_batch_src_global generation:  0.7728691101074219
r_  generation:  9.720279693603516
local_output_nid generation:  0.6679787635803223
local_in_edges_tensor generation:  0.9390788078308105
mini_batch_src_global generation:  0.72232985496521
r_  generation:  8.62847900390625
local_output_nid generation:  0.7631320953369141
local_in_edges_tensor generation:  1.0248322486877441
mini_batch_src_global generation:  0.8022964000701904
r_  generation:  10.50005030632019
local_output_nid generation:  0.7610480785369873
local_in_edges_tensor generation:  1.05818510055542
mini_batch_src_global generation:  0.7927227020263672
r_  generation:  9.889774322509766
local_output_nid generation:  0.7572171688079834
local_in_edges_tensor generation:  1.0193066596984863
mini_batch_src_global generation:  0.8319904804229736
r_  generation:  10.002232074737549
local_output_nid generation:  0.7501258850097656
local_in_edges_tensor generation:  1.0543875694274902
mini_batch_src_global generation:  0.7856800556182861
r_  generation:  9.820136308670044
local_output_nid generation:  0.7885732650756836
local_in_edges_tensor generation:  1.015113353729248
mini_batch_src_global generation:  0.8119215965270996
r_  generation:  10.172332763671875
local_output_nid generation:  0.747272253036499
local_in_edges_tensor generation:  1.046374797821045
mini_batch_src_global generation:  0.7765185832977295
r_  generation:  10.038313627243042
local_output_nid generation:  0.7631561756134033
local_in_edges_tensor generation:  0.996685266494751
mini_batch_src_global generation:  0.808891773223877
r_  generation:  10.264050722122192
local_output_nid generation:  0.7599215507507324
local_in_edges_tensor generation:  1.0624315738677979
mini_batch_src_global generation:  0.7773208618164062
r_  generation:  10.007654428482056
local_output_nid generation:  0.7183043956756592
local_in_edges_tensor generation:  0.9450178146362305
mini_batch_src_global generation:  0.774655818939209
r_  generation:  9.535937786102295
local_output_nid generation:  0.7138147354125977
local_in_edges_tensor generation:  1.0273280143737793
mini_batch_src_global generation:  0.7520225048065186
r_  generation:  9.59668779373169
local_output_nid generation:  0.7674741744995117
local_in_edges_tensor generation:  0.9958093166351318
mini_batch_src_global generation:  0.8044660091400146
r_  generation:  10.083712577819824
local_output_nid generation:  0.7616958618164062
local_in_edges_tensor generation:  1.0662405490875244
mini_batch_src_global generation:  0.7822780609130859
r_  generation:  9.833027362823486
local_output_nid generation:  0.7305328845977783
local_in_edges_tensor generation:  0.9630956649780273
mini_batch_src_global generation:  0.806006669998169
r_  generation:  9.688564538955688
local_output_nid generation:  0.7157895565032959
local_in_edges_tensor generation:  1.022191047668457
mini_batch_src_global generation:  0.7552814483642578
r_  generation:  9.565702438354492
----------------------check_connections_block total spend ----------------------------- 455.1298484802246
generate_one_block  13.025233745574951
generate_one_block  12.14382529258728
generate_one_block  12.092795133590698
generate_one_block  15.015515327453613
generate_one_block  12.326272010803223
generate_one_block  10.560706615447998
generate_one_block  11.946122169494629
generate_one_block  12.111746311187744
generate_one_block  11.55734920501709
generate_one_block  12.042630434036255
generate_one_block  11.64830207824707
generate_one_block  12.525259256362915
generate_one_block  10.834625720977783
generate_one_block  12.111517190933228
generate_one_block  12.177122354507446
generate_one_block  11.028620719909668
generate_one_block  11.780971050262451
generate_one_block  10.79716157913208
generate_one_block  12.492167234420776
generate_one_block  12.237557172775269
generate_one_block  12.602939367294312
generate_one_block  12.005877494812012
generate_one_block  12.999953269958496
generate_one_block  11.968583106994629
generate_one_block  12.521734714508057
generate_one_block  12.05980372428894
generate_one_block  11.480845928192139
generate_one_block  11.909181356430054
generate_one_block  12.10836672782898
generate_one_block  12.95145320892334
generate_one_block  11.56031346321106
generate_one_block  11.962130784988403
----------===============-------------===============-------------the number of batches *****---- 32

original number of batches:  32
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

connection checking time:  1291.5036144256592
block generation total time  1169.1210379600525
average batch blocks generation time:  7.307006487250328
block dataloader generation time/epoch 2612.0719583034515
pseudo mini batch 0 input nodes size: 2265895
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.8458571434020996  GigaBytes
Max Memory Allocated: 0.8458571434020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.8459029197692871  GigaBytes
Max Memory Allocated: 0.8459029197692871  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8631591796875 GB
    Memory Allocated: 0.8459029197692871  GigaBytes
Max Memory Allocated: 0.8459029197692871  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.3591856956481934  GigaBytes
Max Memory Allocated: 1.3591856956481934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.3591856956481934  GigaBytes
Max Memory Allocated: 1.3591856956481934  GigaBytes

first layer input nodes number: 2265895
first layer output nodes number: 2155957
edges number: 19438954
torch.Size([2265895, 100])
torch.Size([2155957, 256])
input nodes number: 2155957
output nodes number: 1579645
edges number: 33133748
torch.Size([2155957, 256])
torch.Size([1579645, 256])
input nodes number: 1579645
output nodes number: 503059
edges number: 13285598
torch.Size([1579645, 256])
torch.Size([503059, 256])
input nodes number: 503059
output nodes number: 79444
edges number: 2687342
torch.Size([503059, 256])
torch.Size([79444, 256])
torch.Size([6100, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6737060546875 GB
    Memory Allocated: 14.119868755340576  GigaBytes
Max Memory Allocated: 14.316819667816162  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.6737060546875 GB
    Memory Allocated: 14.121384620666504  GigaBytes
Max Memory Allocated: 14.316819667816162  GigaBytes

