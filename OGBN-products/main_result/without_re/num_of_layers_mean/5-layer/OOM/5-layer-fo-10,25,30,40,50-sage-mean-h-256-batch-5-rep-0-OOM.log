main start at this time 1656132383.6175506
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.5721340179443359
global_2_local spend time (sec) 0.4899716377258301
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.10184693336486816
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1256292, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.15134286880493164
auxiliary_graph
Graph(num_nodes=1452863, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7577438354492188
remove nodes length  1256292

auxiliary_graph.remove_nodes spent  8.9647536277771
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.89169454574585

the counter of shared neighbor distribution
Counter({1.0: 96835744, 2.0: 19827062, 3.0: 7693924, 4.0: 3791436, 5.0: 2140070, 6.0: 1318556, 7.0: 866322, 8.0: 595048, 9.0: 426444, 10.0: 310458, 11.0: 236344, 12.0: 183078, 13.0: 142976, 14.0: 106950, 15.0: 85820, 16.0: 67340, 17.0: 50862, 18.0: 42392, 19.0: 33792, 20.0: 28390, 21.0: 20868, 22.0: 18984, 23.0: 15084, 24.0: 12878, 25.0: 10746, 26.0: 9024, 27.0: 7364, 28.0: 6868, 30.0: 4276, 29.0: 4242, 31.0: 3522, 33.0: 3520, 32.0: 2852, 48.0: 2580, 35.0: 2468, 39.0: 2416, 36.0: 2416, 37.0: 2404, 34.0: 2034, 38.0: 2032, 40.0: 1910, 43.0: 1782, 41.0: 1508, 47.0: 1452, 44.0: 1420, 42.0: 1374, 49.0: 1218, 45.0: 1128, 46.0: 874, 50.0: 420})
134932672
Convert a graph into a bidirected graph: 9.499 seconds
Metis partitioning: 30.065 seconds
Split the graph: 7.076 seconds
Construct subgraphs: 0.054 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  46.74781131744385
38508
39237
40197
38170
40459
total k batches seeds list generation spend  91.1118311882019
after graph partition
graph partition algorithm spend time 92.51647138595581
38508
39237
40197
38170
40459
partition_len_list
[382139, 423973, 399970, 362613, 351922]
REG selection method  spend 93.33640432357788
time for parepare:  0.3709578514099121
local_output_nid generation:  0.008102655410766602
local_in_edges_tensor generation:  0.03511691093444824
mini_batch_src_global generation:  0.05628633499145508
r_  generation:  0.7555177211761475
local_output_nid generation:  0.010701179504394531
local_in_edges_tensor generation:  0.0474092960357666
mini_batch_src_global generation:  0.0675821304321289
r_  generation:  0.7034685611724854
local_output_nid generation:  0.008404016494750977
local_in_edges_tensor generation:  0.026109933853149414
mini_batch_src_global generation:  0.06414914131164551
r_  generation:  0.8026483058929443
local_output_nid generation:  0.008212566375732422
local_in_edges_tensor generation:  0.014346599578857422
mini_batch_src_global generation:  0.06446433067321777
r_  generation:  0.7593138217926025
local_output_nid generation:  0.008925437927246094
local_in_edges_tensor generation:  0.0233762264251709
mini_batch_src_global generation:  0.07704758644104004
r_  generation:  0.8124992847442627
----------------------check_connections_block total spend ----------------------------- 5.407953262329102
generate_one_block  2.359717607498169
generate_one_block  0.8602311611175537
generate_one_block  0.937197208404541
generate_one_block  0.8426346778869629
generate_one_block  0.9000129699707031
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.176313638687134
gen group dst list time:  0.05505514144897461
time for parepare:  0.45915746688842773
local_output_nid generation:  0.08501362800598145
local_in_edges_tensor generation:  0.4046199321746826
mini_batch_src_global generation:  0.4086802005767822
r_  generation:  5.138927936553955
local_output_nid generation:  0.13174772262573242
local_in_edges_tensor generation:  0.5115382671356201
mini_batch_src_global generation:  0.5842840671539307
r_  generation:  5.841482400894165
local_output_nid generation:  0.09531688690185547
local_in_edges_tensor generation:  0.3833961486816406
mini_batch_src_global generation:  0.5697283744812012
r_  generation:  5.231260299682617
local_output_nid generation:  0.1235964298248291
local_in_edges_tensor generation:  0.2833571434020996
mini_batch_src_global generation:  0.46573662757873535
r_  generation:  4.632782697677612
local_output_nid generation:  0.08233523368835449
local_in_edges_tensor generation:  0.2825791835784912
mini_batch_src_global generation:  0.45513296127319336
r_  generation:  4.206433534622192
----------------------check_connections_block total spend ----------------------------- 34.88473606109619
generate_one_block  7.191562175750732
generate_one_block  7.632346868515015
generate_one_block  7.170329570770264
generate_one_block  6.1183154582977295
generate_one_block  5.277651309967041
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.4785196781158447
gen group dst list time:  0.2069239616394043
time for parepare:  0.48549938201904297
local_output_nid generation:  0.29810476303100586
local_in_edges_tensor generation:  0.9164729118347168
mini_batch_src_global generation:  0.8289794921875
r_  generation:  11.424503326416016
local_output_nid generation:  0.398958683013916
local_in_edges_tensor generation:  1.0068109035491943
mini_batch_src_global generation:  1.2785460948944092
r_  generation:  13.120288133621216
local_output_nid generation:  0.35019636154174805
local_in_edges_tensor generation:  0.8275256156921387
mini_batch_src_global generation:  1.1166024208068848
r_  generation:  12.256101608276367
local_output_nid generation:  0.392040491104126
local_in_edges_tensor generation:  0.8761434555053711
mini_batch_src_global generation:  1.096252202987671
r_  generation:  11.622252941131592
local_output_nid generation:  0.28758835792541504
local_in_edges_tensor generation:  0.7139885425567627
mini_batch_src_global generation:  0.9398448467254639
r_  generation:  10.263004064559937
----------------------check_connections_block total spend ----------------------------- 80.86372590065002
generate_one_block  15.157413005828857
generate_one_block  17.388025999069214
generate_one_block  15.509976863861084
generate_one_block  15.310210704803467
generate_one_block  12.608429670333862
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2167086601257324
gen group dst list time:  0.37182044982910156
time for parepare:  0.47831296920776367
local_output_nid generation:  0.5664832592010498
local_in_edges_tensor generation:  1.29664945602417
mini_batch_src_global generation:  1.130647897720337
r_  generation:  15.472090005874634
local_output_nid generation:  0.5827641487121582
local_in_edges_tensor generation:  1.38332200050354
mini_batch_src_global generation:  1.5473220348358154
r_  generation:  16.65678882598877
local_output_nid generation:  0.6536314487457275
local_in_edges_tensor generation:  1.177459478378296
mini_batch_src_global generation:  1.684007167816162
r_  generation:  17.16184687614441
local_output_nid generation:  0.6909177303314209
local_in_edges_tensor generation:  1.3444297313690186
mini_batch_src_global generation:  1.5323128700256348
r_  generation:  17.0131573677063
local_output_nid generation:  0.6485488414764404
local_in_edges_tensor generation:  1.2597332000732422
mini_batch_src_global generation:  1.4921176433563232
r_  generation:  16.37309169769287
----------------------check_connections_block total spend ----------------------------- 115.22691941261292
generate_one_block  20.772169589996338
generate_one_block  21.733558177947998
generate_one_block  22.724900722503662
generate_one_block  21.66773009300232
generate_one_block  20.69340443611145
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.177513599395752
gen group dst list time:  0.4918019771575928
time for parepare:  0.5002753734588623
local_output_nid generation:  0.7327141761779785
local_in_edges_tensor generation:  1.1973371505737305
mini_batch_src_global generation:  0.629509449005127
r_  generation:  10.301884651184082
local_output_nid generation:  0.7505917549133301
local_in_edges_tensor generation:  1.089562177658081
mini_batch_src_global generation:  0.7941009998321533
r_  generation:  10.207763195037842
local_output_nid generation:  0.7552657127380371
local_in_edges_tensor generation:  1.0797908306121826
mini_batch_src_global generation:  0.7972238063812256
r_  generation:  10.228019714355469
local_output_nid generation:  0.7196779251098633
local_in_edges_tensor generation:  0.9839222431182861
mini_batch_src_global generation:  0.8031508922576904
r_  generation:  10.168967485427856
local_output_nid generation:  0.7544283866882324
local_in_edges_tensor generation:  1.0301735401153564
mini_batch_src_global generation:  0.8555986881256104
r_  generation:  10.705024242401123
----------------------check_connections_block total spend ----------------------------- 76.04292368888855
generate_one_block  12.79338812828064
generate_one_block  12.913187503814697
generate_one_block  12.712376117706299
generate_one_block  12.60878324508667
generate_one_block  12.664781332015991
----------===============-------------===============-------------the number of batches *****---- 5

original number of batches:  5
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

connection checking time:  312.4262583255768
block generation total time  286.54833459854126
average batch blocks generation time:  11.46193338394165
block dataloader generation time/epoch 719.267786026001
pseudo mini batch 0 input nodes size: 2247415
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.8396358489990234  GigaBytes
Max Memory Allocated: 0.8396358489990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.8399229049682617  GigaBytes
Max Memory Allocated: 0.8399229049682617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.8399229049682617  GigaBytes
Max Memory Allocated: 0.8399229049682617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 1.569528579711914  GigaBytes
Max Memory Allocated: 1.569528579711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6639404296875 GB
    Memory Allocated: 1.569528579711914  GigaBytes
Max Memory Allocated: 1.569528579711914  GigaBytes

first layer input nodes number: 2247415
first layer output nodes number: 2183392
edges number: 19451698
torch.Size([2247415, 100])
torch.Size([2183392, 256])
input nodes number: 2183392
output nodes number: 1822235
edges number: 36580986
torch.Size([2183392, 256])
torch.Size([1822235, 256])
input nodes number: 1822235
output nodes number: 1052806
edges number: 26683777
torch.Size([1822235, 256])
torch.Size([1052806, 256])
input nodes number: 1052806
output nodes number: 382139
edges number: 13160937
torch.Size([1052806, 256])
torch.Size([382139, 256])
torch.Size([38508, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1541748046875 GB
    Memory Allocated: 18.072457313537598  GigaBytes
Max Memory Allocated: 18.372431755065918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1541748046875 GB
    Memory Allocated: 18.079200744628906  GigaBytes
Max Memory Allocated: 18.372431755065918  GigaBytes

