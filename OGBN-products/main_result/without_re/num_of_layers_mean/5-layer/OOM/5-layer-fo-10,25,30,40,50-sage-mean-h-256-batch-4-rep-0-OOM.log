main start at this time 1656131725.204768
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.41426563262939453
global_2_local spend time (sec) 0.48412466049194336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.09304094314575195
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1256292, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.14546823501586914
auxiliary_graph
Graph(num_nodes=1452863, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7558927536010742
remove nodes length  1256292

auxiliary_graph.remove_nodes spent  8.708868026733398
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135129243,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.53787636756897

the counter of shared neighbor distribution
Counter({1.0: 96835744, 2.0: 19827062, 3.0: 7693924, 4.0: 3791436, 5.0: 2140070, 6.0: 1318556, 7.0: 866322, 8.0: 595048, 9.0: 426444, 10.0: 310458, 11.0: 236344, 12.0: 183078, 13.0: 142976, 14.0: 106950, 15.0: 85820, 16.0: 67340, 17.0: 50862, 18.0: 42392, 19.0: 33792, 20.0: 28390, 21.0: 20868, 22.0: 18984, 23.0: 15084, 24.0: 12878, 25.0: 10746, 26.0: 9024, 27.0: 7364, 28.0: 6868, 30.0: 4276, 29.0: 4242, 31.0: 3522, 33.0: 3520, 32.0: 2852, 48.0: 2580, 35.0: 2468, 39.0: 2416, 36.0: 2416, 37.0: 2404, 34.0: 2034, 38.0: 2032, 40.0: 1910, 43.0: 1782, 41.0: 1508, 47.0: 1452, 44.0: 1420, 42.0: 1374, 49.0: 1218, 45.0: 1128, 46.0: 874, 50.0: 420})
134932672
Convert a graph into a bidirected graph: 10.115 seconds
Metis partitioning: 29.378 seconds
Split the graph: 7.946 seconds
Construct subgraphs: 0.102 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  47.59629011154175
50451
48263
47859
49998
total k batches seeds list generation spend  90.71953701972961
after graph partition
graph partition algorithm spend time 92.02381443977356
50451
48263
47859
49998
partition_len_list
[466578, 478336, 415879, 400661]
REG selection method  spend 92.83642721176147
time for parepare:  0.3642106056213379
local_output_nid generation:  0.009458065032958984
local_in_edges_tensor generation:  0.05572009086608887
mini_batch_src_global generation:  0.0755167007446289
r_  generation:  0.9846532344818115
local_output_nid generation:  0.01040196418762207
local_in_edges_tensor generation:  0.04374241828918457
mini_batch_src_global generation:  0.08486008644104004
r_  generation:  0.915734052658081
local_output_nid generation:  0.00907278060913086
local_in_edges_tensor generation:  0.03048229217529297
mini_batch_src_global generation:  0.07448744773864746
r_  generation:  0.9479820728302002
local_output_nid generation:  0.010848760604858398
local_in_edges_tensor generation:  0.03913617134094238
mini_batch_src_global generation:  0.08789348602294922
r_  generation:  1.048551321029663
----------------------check_connections_block total spend ----------------------------- 5.482167959213257
generate_one_block  2.733279228210449
generate_one_block  1.2131123542785645
generate_one_block  1.2504315376281738
generate_one_block  1.2633593082427979
The real block id is  3
get_global_graph_edges_ids_block function  spend 2.445425271987915
gen group dst list time:  0.0476529598236084
time for parepare:  0.43633294105529785
local_output_nid generation:  0.0915071964263916
local_in_edges_tensor generation:  0.44366908073425293
mini_batch_src_global generation:  0.5078856945037842
r_  generation:  6.262346506118774
local_output_nid generation:  0.11954212188720703
local_in_edges_tensor generation:  0.4793689250946045
mini_batch_src_global generation:  0.7072029113769531
r_  generation:  6.7844178676605225
local_output_nid generation:  0.10753059387207031
local_in_edges_tensor generation:  0.7114570140838623
mini_batch_src_global generation:  0.5464215278625488
r_  generation:  5.272130966186523
local_output_nid generation:  0.11729860305786133
local_in_edges_tensor generation:  0.35532045364379883
mini_batch_src_global generation:  0.46738576889038086
r_  generation:  4.885875225067139
----------------------check_connections_block total spend ----------------------------- 32.3339147567749
generate_one_block  8.950989246368408
generate_one_block  8.759766101837158
generate_one_block  6.99840521812439
generate_one_block  6.49275803565979
The real block id is  2
get_global_graph_edges_ids_block function  spend 2.5290963649749756
gen group dst list time:  0.20105385780334473
time for parepare:  0.48447442054748535
local_output_nid generation:  0.3113534450531006
local_in_edges_tensor generation:  0.860649585723877
mini_batch_src_global generation:  0.9028449058532715
r_  generation:  12.672280311584473
local_output_nid generation:  0.42586755752563477
local_in_edges_tensor generation:  1.0371589660644531
mini_batch_src_global generation:  1.3714289665222168
r_  generation:  14.045969486236572
local_output_nid generation:  0.385540246963501
local_in_edges_tensor generation:  0.835482120513916
mini_batch_src_global generation:  1.18381929397583
r_  generation:  12.918296575546265
local_output_nid generation:  0.3483133316040039
local_in_edges_tensor generation:  0.7402839660644531
mini_batch_src_global generation:  1.019458532333374
r_  generation:  10.863397359848022
----------------------check_connections_block total spend ----------------------------- 69.03188443183899
generate_one_block  16.15346121788025
generate_one_block  18.099762439727783
generate_one_block  16.455352067947388
generate_one_block  14.28146481513977
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0913877487182617
gen group dst list time:  0.270662784576416
time for parepare:  0.47760486602783203
local_output_nid generation:  0.551429033279419
local_in_edges_tensor generation:  1.2887685298919678
mini_batch_src_global generation:  1.1560373306274414
r_  generation:  16.319560766220093
local_output_nid generation:  0.65028977394104
local_in_edges_tensor generation:  1.3100833892822266
mini_batch_src_global generation:  1.5549085140228271
r_  generation:  17.384236574172974
local_output_nid generation:  0.634009838104248
local_in_edges_tensor generation:  1.4180233478546143
mini_batch_src_global generation:  1.5708105564117432
r_  generation:  17.68339467048645
local_output_nid generation:  0.6327376365661621
local_in_edges_tensor generation:  1.205777645111084
mini_batch_src_global generation:  1.6214993000030518
r_  generation:  16.529924392700195
----------------------check_connections_block total spend ----------------------------- 94.49854826927185
generate_one_block  21.466252326965332
generate_one_block  22.116159200668335
generate_one_block  22.578320503234863
generate_one_block  21.05310559272766
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1861753463745117
gen group dst list time:  0.4157371520996094
time for parepare:  0.5044569969177246
local_output_nid generation:  0.738182783126831
local_in_edges_tensor generation:  1.1647851467132568
mini_batch_src_global generation:  0.6037852764129639
r_  generation:  10.082432985305786
local_output_nid generation:  0.8327019214630127
local_in_edges_tensor generation:  1.089341640472412
mini_batch_src_global generation:  0.814164400100708
r_  generation:  10.144437789916992
local_output_nid generation:  0.7717695236206055
local_in_edges_tensor generation:  0.9965977668762207
mini_batch_src_global generation:  0.8029460906982422
r_  generation:  10.303069114685059
local_output_nid generation:  0.6997151374816895
local_in_edges_tensor generation:  0.9755110740661621
mini_batch_src_global generation:  0.8770811557769775
r_  generation:  10.072824954986572
----------------------check_connections_block total spend ----------------------------- 59.77090287208557
generate_one_block  12.899521589279175
generate_one_block  13.462839603424072
generate_one_block  13.2925283908844
generate_one_block  12.899696588516235
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

connection checking time:  261.11741828918457
block generation total time  242.420565366745
average batch blocks generation time:  12.12102826833725
block dataloader generation time/epoch 630.0114417076111
pseudo mini batch 0 input nodes size: 2254866
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.8417487144470215  GigaBytes
Max Memory Allocated: 0.8417487144470215  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.8421249389648438  GigaBytes
Max Memory Allocated: 0.8421249389648438  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.8421249389648438  GigaBytes
Max Memory Allocated: 0.8421249389648438  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 1.6210851669311523  GigaBytes
Max Memory Allocated: 1.6210851669311523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 1.6210851669311523  GigaBytes
Max Memory Allocated: 1.6210851669311523  GigaBytes

first layer input nodes number: 2254866
first layer output nodes number: 2203205
edges number: 19544887
torch.Size([2254866, 100])
torch.Size([2203205, 256])
input nodes number: 2203205
output nodes number: 1894991
edges number: 37532753
torch.Size([2203205, 256])
torch.Size([1894991, 256])
input nodes number: 1894991
output nodes number: 1151787
edges number: 28760391
torch.Size([1894991, 256])
torch.Size([1151787, 256])
input nodes number: 1151787
output nodes number: 466578
edges number: 15964873
torch.Size([1151787, 256])
torch.Size([466578, 256])
torch.Size([50451, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 19.036719799041748  GigaBytes
Max Memory Allocated: 19.397228717803955  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3026123046875 GB
    Memory Allocated: 19.045554161071777  GigaBytes
Max Memory Allocated: 19.397228717803955  GigaBytes

