main start at this time 1656231425.8799422
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017452239990234375  GigaBytes
Max Memory Allocated: 0.0017452239990234375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.43345165252685547
global_2_local spend time (sec) 0.47598934173583984
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.09482860565185547
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1255389, 50: 163817, 48: 958, 43: 933, 47: 927, 45: 884, 49: 879, 41: 861, 40: 852, 39: 816, 42: 813, 46: 807, 44: 806, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.14854145050048828
auxiliary_graph
Graph(num_nodes=1451960, num_edges=135299567,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7314267158508301
remove nodes length  1255389

auxiliary_graph.remove_nodes spent  7.985843181610107
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=135299567,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  5.4648871421813965

the counter of shared neighbor distribution
Counter({1.0: 96923864, 2.0: 19867476, 3.0: 7713124, 4.0: 3797172, 5.0: 2149568, 6.0: 1323634, 7.0: 867586, 8.0: 596592, 9.0: 424928, 10.0: 311148, 11.0: 236782, 12.0: 182686, 13.0: 142694, 14.0: 108170, 15.0: 85784, 16.0: 66594, 17.0: 51172, 18.0: 42246, 19.0: 33546, 20.0: 28574, 21.0: 20526, 22.0: 18564, 23.0: 14810, 24.0: 12414, 25.0: 10930, 26.0: 8996, 27.0: 7428, 28.0: 7192, 29.0: 4866, 30.0: 4536, 31.0: 3554, 33.0: 3400, 32.0: 2870, 48.0: 2562, 37.0: 2486, 35.0: 2456, 39.0: 2402, 36.0: 2350, 34.0: 2138, 38.0: 2086, 40.0: 1902, 43.0: 1764, 41.0: 1564, 47.0: 1476, 44.0: 1394, 42.0: 1338, 49.0: 1198, 45.0: 1088, 46.0: 938, 50.0: 428})
135102996
Convert a graph into a bidirected graph: 9.567 seconds
Metis partitioning: 40.104 seconds
Split the graph: 2.279 seconds
Construct subgraphs: 1.040 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  53.0535888671875
3294
3308
3371
3250
3357
3308
3180
3180
3180
3352
3180
3180
3280
3182
3346
3180
3374
3374
3374
3180
3229
3180
3180
3182
3304
3180
3374
3318
3308
3360
3369
3318
3294
3358
3354
3180
3180
3188
3196
3363
3364
3180
3184
3180
3374
3304
3369
3278
3196
3374
3374
3261
3221
3275
3351
3192
3361
3181
3374
3333
total k batches seeds list generation spend  94.00401306152344
after graph partition
graph partition algorithm spend time 94.86705422401428
3294
3308
3371
3250
3357
3308
3180
3180
3180
3352
3180
3180
3280
3182
3346
3180
3374
3374
3374
3180
3229
3180
3180
3182
3304
3180
3374
3318
3308
3360
3369
3318
3294
3358
3354
3180
3180
3188
3196
3363
3364
3180
3184
3180
3374
3304
3369
3278
3196
3374
3374
3261
3221
3275
3351
3192
3361
3181
3374
3333
partition_len_list
[47999, 43768, 40956, 60344, 33711, 43647, 37230, 43713, 46838, 42716, 34631, 37368, 40277, 64309, 34707, 55595, 63678, 46507, 41667, 49767, 40123, 63906, 49957, 42917, 35392, 54818, 42921, 53247, 44864, 52473, 55786, 45236, 61843, 48494, 49772, 52906, 53835, 42318, 56515, 56010, 56007, 61980, 53833, 68628, 69186, 59481, 57133, 53920, 53380, 71188, 54296, 54433, 49234, 43164, 45612, 36335, 51405, 52924, 54690, 46025]
REG selection method  spend 95.68874526023865
time for parepare:  0.3616816997528076
local_output_nid generation:  0.0014848709106445312
local_in_edges_tensor generation:  0.002597808837890625
mini_batch_src_global generation:  0.005355119705200195
r_  generation:  0.0468442440032959
local_output_nid generation:  0.0014524459838867188
local_in_edges_tensor generation:  0.0021555423736572266
mini_batch_src_global generation:  0.007355928421020508
r_  generation:  0.048720598220825195
local_output_nid generation:  0.0014801025390625
local_in_edges_tensor generation:  0.002199888229370117
mini_batch_src_global generation:  0.005102872848510742
r_  generation:  0.04593682289123535
local_output_nid generation:  0.0014216899871826172
local_in_edges_tensor generation:  0.0020325183868408203
mini_batch_src_global generation:  0.0046269893646240234
r_  generation:  0.04349040985107422
local_output_nid generation:  0.0014781951904296875
local_in_edges_tensor generation:  0.002117633819580078
mini_batch_src_global generation:  0.004779338836669922
r_  generation:  0.042391300201416016
local_output_nid generation:  0.0014586448669433594
local_in_edges_tensor generation:  0.02312016487121582
mini_batch_src_global generation:  0.004712343215942383
r_  generation:  0.04454350471496582
local_output_nid generation:  0.001371622085571289
local_in_edges_tensor generation:  0.0020520687103271484
mini_batch_src_global generation:  0.021683454513549805
r_  generation:  0.039908409118652344
local_output_nid generation:  0.0013835430145263672
local_in_edges_tensor generation:  0.0020875930786132812
mini_batch_src_global generation:  0.00403285026550293
r_  generation:  0.04224133491516113
local_output_nid generation:  0.001379251480102539
local_in_edges_tensor generation:  0.0020563602447509766
mini_batch_src_global generation:  0.004799365997314453
r_  generation:  0.04705405235290527
local_output_nid generation:  0.0014748573303222656
local_in_edges_tensor generation:  0.002157449722290039
mini_batch_src_global generation:  0.004596233367919922
r_  generation:  0.050202369689941406
local_output_nid generation:  0.0014014244079589844
local_in_edges_tensor generation:  0.002864360809326172
mini_batch_src_global generation:  0.0045528411865234375
r_  generation:  0.041608572006225586
local_output_nid generation:  0.0013959407806396484
local_in_edges_tensor generation:  0.002034425735473633
mini_batch_src_global generation:  0.004460573196411133
r_  generation:  0.04216766357421875
local_output_nid generation:  0.0014264583587646484
local_in_edges_tensor generation:  0.002886056900024414
mini_batch_src_global generation:  0.0053255558013916016
r_  generation:  0.047532081604003906
local_output_nid generation:  0.0013778209686279297
local_in_edges_tensor generation:  0.0023016929626464844
mini_batch_src_global generation:  0.004698038101196289
r_  generation:  0.05200552940368652
local_output_nid generation:  0.0014681816101074219
local_in_edges_tensor generation:  0.0022420883178710938
mini_batch_src_global generation:  0.005612611770629883
r_  generation:  0.0482485294342041
local_output_nid generation:  0.0013730525970458984
local_in_edges_tensor generation:  0.0021071434020996094
mini_batch_src_global generation:  0.004557609558105469
r_  generation:  0.05726814270019531
local_output_nid generation:  0.0014948844909667969
local_in_edges_tensor generation:  0.0022292137145996094
mini_batch_src_global generation:  0.0065348148345947266
r_  generation:  0.053443193435668945