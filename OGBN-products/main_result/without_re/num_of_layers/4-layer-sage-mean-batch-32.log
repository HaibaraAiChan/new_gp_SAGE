main start at this time 1655851081.7865875
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.3205418586730957
global_2_local spend time (sec) 0.4252324104309082
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0753169059753418
A = g.adjacency_matrix() spent  0.11742544174194336
auxiliary_graph
Graph(num_nodes=1377742, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.697798490524292
remove nodes length
1181171
auxiliary_graph.remove_nodes spent  5.774038791656494
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101873543,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.72888708114624

the counter of shared neighbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
101676972
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([        0,         1,         2,  ..., 101676969, 101676970,
        101676971])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 76625834, 2.0: 14048222, 3.0: 5011620, 4.0: 2308328, 5.0: 1244288, 6.0: 737614, 7.0: 469104, 8.0: 320932, 9.0: 223716, 10.0: 162494, 11.0: 118854, 12.0: 89870, 13.0: 69466, 14.0: 53028, 15.0: 41764, 16.0: 31248, 17.0: 22002, 18.0: 19492, 19.0: 13018, 20.0: 10882, 21.0: 7144, 22.0: 5740, 23.0: 4796, 24.0: 3814, 25.0: 3584, 33.0: 3046, 28.0: 2926, 26.0: 2688, 30.0: 2312, 27.0: 2286, 31.0: 2154, 39.0: 2098, 32.0: 2040, 35.0: 1750, 29.0: 1680, 37.0: 1650, 36.0: 1526, 38.0: 1460, 34.0: 1422, 40.0: 1080})
Convert a graph into a bidirected graph: 7.073 seconds
Metis partitioning: 26.269 seconds
Split the graph: 1.569 seconds
Construct subgraphs: 0.530 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  35.48269271850586
6303
6254
6076
6126
5987
5966
5963
6314
5996
6301
5963
5964
6226
6321
6229
6099
5963
6261
5982
6255
5963
6088
6327
6321
6230
6291
6061
6007
6326
5963
6219
6226
total k batches seeds list generation spend  79.47153997421265
after graph partition
graph partition algorithm spend time 80.16599369049072
6303
6254
6076
6126
5987
5966
5963
6314
5996
6301
5963
5964
6226
6321
6229
6099
5963
6261
5982
6255
5963
6088
6327
6321
6230
6291
6061
6007
6326
5963
6219
6226
partition_len_list
[82698, 71575, 78813, 67635, 65335, 54116, 77740, 54510, 56210, 67048, 69275, 88178, 68668, 66638, 75569, 91716, 84507, 84518, 69885, 93405, 87697, 59893, 73529, 58426, 82852, 78123, 75008, 70210, 101825, 88853, 73078, 108340]
shared_neighbor_graph_partition_s0 selection method  spend 80.85957837104797
time for parepare:  0.2745189666748047
local_output_nid generation:  0.0022017955780029297
local_in_edges_tensor generation:  0.0032854080200195312
mini_batch_src_global generation:  0.007838964462280273
r_  generation:  0.07654666900634766
local_output_nid generation:  0.002529621124267578
local_in_edges_tensor generation:  0.0034928321838378906
mini_batch_src_global generation:  0.009685277938842773
r_  generation:  0.07893085479736328
local_output_nid generation:  0.002482891082763672
local_in_edges_tensor generation:  0.003175497055053711
mini_batch_src_global generation:  0.007803201675415039
r_  generation:  0.07907891273498535
local_output_nid generation:  0.0025777816772460938
local_in_edges_tensor generation:  0.0032134056091308594
mini_batch_src_global generation:  0.00821232795715332
r_  generation:  0.07679295539855957
local_output_nid generation:  0.0024471282958984375
local_in_edges_tensor generation:  0.0030128955841064453
mini_batch_src_global generation:  0.007406711578369141
r_  generation:  0.07176780700683594
local_output_nid generation:  0.0024530887603759766
local_in_edges_tensor generation:  0.003007650375366211
mini_batch_src_global generation:  0.0076978206634521484
r_  generation:  0.06986737251281738
local_output_nid generation:  0.003523588180541992
local_in_edges_tensor generation:  0.0073490142822265625
mini_batch_src_global generation:  0.007243633270263672
r_  generation:  0.0735771656036377
local_output_nid generation:  0.0026166439056396484
local_in_edges_tensor generation:  0.011162281036376953
mini_batch_src_global generation:  0.00916290283203125
r_  generation:  0.07948541641235352
local_output_nid generation:  0.002470254898071289
local_in_edges_tensor generation:  0.007792949676513672
mini_batch_src_global generation:  0.007750988006591797
r_  generation:  0.07399702072143555
local_output_nid generation:  0.0025975704193115234
local_in_edges_tensor generation:  0.006484270095825195
mini_batch_src_global generation:  0.00917196273803711
r_  generation:  0.0809483528137207
local_output_nid generation:  0.0024611949920654297
local_in_edges_tensor generation:  0.004936933517456055
mini_batch_src_global generation:  0.007935047149658203
r_  generation:  0.07724475860595703
local_output_nid generation:  0.0036649703979492188
local_in_edges_tensor generation:  0.0043451786041259766
mini_batch_src_global generation:  0.01139688491821289
r_  generation:  0.08341073989868164
local_output_nid generation:  0.0026259422302246094
local_in_edges_tensor generation:  0.003809213638305664
mini_batch_src_global generation:  0.008332252502441406
r_  generation:  0.08200764656066895
local_output_nid generation:  0.002608776092529297
local_in_edges_tensor generation:  0.003676176071166992
mini_batch_src_global generation:  0.009018659591674805
r_  generation:  0.08123087882995605
local_output_nid generation:  0.0025968551635742188
local_in_edges_tensor generation:  0.0034494400024414062
mini_batch_src_global generation:  0.010276079177856445
r_  generation:  0.08306527137756348
local_output_nid generation:  0.0025234222412109375
local_in_edges_tensor generation:  0.003411531448364258
mini_batch_src_global generation:  0.008936166763305664
r_  generation:  0.08672547340393066
local_output_nid generation:  0.002543210983276367
local_in_edges_tensor generation:  0.002860546112060547
mini_batch_src_global generation:  0.007448673248291016
r_  generation:  0.06948018074035645
local_output_nid generation:  0.0025937557220458984
local_in_edges_tensor generation:  0.003220796585083008
mini_batch_src_global generation:  0.008257389068603516
r_  generation:  0.08335757255554199
local_output_nid generation:  0.002492666244506836
local_in_edges_tensor generation:  0.003040313720703125
mini_batch_src_global generation:  0.00868368148803711
r_  generation:  0.07534503936767578
local_output_nid generation:  0.0026023387908935547
local_in_edges_tensor generation:  0.003175020217895508
mini_batch_src_global generation:  0.009160995483398438
r_  generation:  0.09928774833679199
local_output_nid generation:  0.0025091171264648438
local_in_edges_tensor generation:  0.003792285919189453
mini_batch_src_global generation:  0.016126632690429688
r_  generation:  0.0806877613067627
local_output_nid generation:  0.0025758743286132812
local_in_edges_tensor generation:  0.003361225128173828
mini_batch_src_global generation:  0.010186910629272461
r_  generation:  0.07863903045654297
local_output_nid generation:  0.0037567615509033203
local_in_edges_tensor generation:  0.003242015838623047
mini_batch_src_global generation:  0.008810281753540039
r_  generation:  0.08061790466308594
local_output_nid generation:  0.0026433467864990234
local_in_edges_tensor generation:  0.02179884910583496
mini_batch_src_global generation:  0.010329246520996094
r_  generation:  0.08064556121826172
local_output_nid generation:  0.002610445022583008
local_in_edges_tensor generation:  0.01449131965637207
mini_batch_src_global generation:  0.02849125862121582
r_  generation:  0.08922553062438965
local_output_nid generation:  0.003912925720214844
local_in_edges_tensor generation:  0.05718493461608887
mini_batch_src_global generation:  0.010416746139526367
r_  generation:  0.08966565132141113
local_output_nid generation:  0.0025136470794677734
local_in_edges_tensor generation:  0.010912895202636719
mini_batch_src_global generation:  0.009541511535644531
r_  generation:  0.08952617645263672
local_output_nid generation:  0.002495288848876953
local_in_edges_tensor generation:  0.0073626041412353516
mini_batch_src_global generation:  0.028360366821289062
r_  generation:  0.08679604530334473
local_output_nid generation:  0.002617359161376953
local_in_edges_tensor generation:  0.006989479064941406
mini_batch_src_global generation:  0.01038050651550293
r_  generation:  0.09811520576477051
local_output_nid generation:  0.002474069595336914
local_in_edges_tensor generation:  0.004577159881591797
mini_batch_src_global generation:  0.012233495712280273
r_  generation:  0.09477519989013672
local_output_nid generation:  0.002620697021484375
local_in_edges_tensor generation:  0.004305601119995117
mini_batch_src_global generation:  0.009639978408813477
r_  generation:  0.08998370170593262
local_output_nid generation:  0.0025529861450195312
local_in_edges_tensor generation:  0.003664255142211914
mini_batch_src_global generation:  0.010009050369262695
r_  generation:  0.09706473350524902
----------------------check_connections_block total spend ----------------------------- 4.249394416809082
generate_one_block  1.5174658298492432
generate_one_block  0.11294889450073242
generate_one_block  0.11292886734008789
generate_one_block  0.1124715805053711
generate_one_block  0.10574531555175781
generate_one_block  0.09865069389343262
generate_one_block  0.10578727722167969
generate_one_block  0.11396527290344238
generate_one_block  0.1031198501586914
generate_one_block  0.11440467834472656
generate_one_block  0.10808992385864258
generate_one_block  0.11218571662902832
generate_one_block  0.1123969554901123
generate_one_block  0.11914682388305664
generate_one_block  0.11840486526489258
generate_one_block  0.13495516777038574
generate_one_block  0.12193155288696289
generate_one_block  0.1354968547821045
generate_one_block  0.11741280555725098
generate_one_block  0.1372826099395752
generate_one_block  0.11573481559753418
generate_one_block  0.10978984832763672
generate_one_block  0.11319518089294434
generate_one_block  0.10944104194641113
generate_one_block  0.12272858619689941
generate_one_block  0.12264895439147949
generate_one_block  0.11648917198181152
generate_one_block  0.11636471748352051
generate_one_block  0.12778043746948242
generate_one_block  0.1350874900817871
generate_one_block  0.12912249565124512
generate_one_block  0.1319878101348877
The real block id is  2
get_global_graph_edges_ids_block function  spend 1.811286211013794
gen group dst list time:  0.08327245712280273
time for parepare:  0.4437546730041504
local_output_nid generation:  0.02186727523803711
local_in_edges_tensor generation:  0.15759801864624023
mini_batch_src_global generation:  0.07230520248413086
r_  generation:  0.8361308574676514
local_output_nid generation:  0.04436016082763672
local_in_edges_tensor generation:  0.047983646392822266
mini_batch_src_global generation:  0.0793311595916748
r_  generation:  0.6811308860778809
local_output_nid generation:  0.030863523483276367
local_in_edges_tensor generation:  0.0367586612701416
mini_batch_src_global generation:  0.08349156379699707
r_  generation:  0.8181331157684326
local_output_nid generation:  0.02344059944152832
local_in_edges_tensor generation:  0.043561458587646484
mini_batch_src_global generation:  0.07639908790588379
r_  generation:  0.6508052349090576
local_output_nid generation:  0.02073502540588379
local_in_edges_tensor generation:  0.027143239974975586
mini_batch_src_global generation:  0.07017874717712402
r_  generation:  0.613868236541748
local_output_nid generation:  0.01637744903564453
local_in_edges_tensor generation:  0.02308940887451172
mini_batch_src_global generation:  0.057228803634643555
r_  generation:  0.48421359062194824
local_output_nid generation:  0.02402472496032715
local_in_edges_tensor generation:  0.0493621826171875
mini_batch_src_global generation:  0.07609772682189941
r_  generation:  0.8109500408172607
local_output_nid generation:  0.037418365478515625
local_in_edges_tensor generation:  0.052680253982543945
mini_batch_src_global generation:  0.06652021408081055
r_  generation:  0.5177278518676758
local_output_nid generation:  0.021283388137817383
local_in_edges_tensor generation:  0.03495168685913086
mini_batch_src_global generation:  0.055329322814941406
r_  generation:  0.5243964195251465
local_output_nid generation:  0.021346569061279297
local_in_edges_tensor generation:  0.039342641830444336
mini_batch_src_global generation:  0.06609129905700684
r_  generation:  0.6222360134124756
local_output_nid generation:  0.022702932357788086
local_in_edges_tensor generation:  0.047501564025878906
mini_batch_src_global generation:  0.07103991508483887
r_  generation:  0.7450180053710938
local_output_nid generation:  0.028864622116088867
local_in_edges_tensor generation:  0.06778573989868164
mini_batch_src_global generation:  0.11831521987915039
r_  generation:  1.0506319999694824
local_output_nid generation:  0.043711185455322266
local_in_edges_tensor generation:  0.25730156898498535
mini_batch_src_global generation:  0.07960724830627441
r_  generation:  0.6793067455291748
local_output_nid generation:  0.021091938018798828
local_in_edges_tensor generation:  0.06200003623962402
mini_batch_src_global generation:  0.06874823570251465
r_  generation:  0.6490676403045654
local_output_nid generation:  0.02305316925048828
local_in_edges_tensor generation:  0.06793999671936035
mini_batch_src_global generation:  0.07985115051269531
r_  generation:  0.8127298355102539
local_output_nid generation:  0.027554750442504883
local_in_edges_tensor generation:  0.09305024147033691
mini_batch_src_global generation:  0.09018564224243164
r_  generation:  0.9842875003814697
local_output_nid generation:  0.05318284034729004
local_in_edges_tensor generation:  0.09759044647216797
mini_batch_src_global generation:  0.09080958366394043
r_  generation:  0.965308666229248
local_output_nid generation:  0.028674602508544922
local_in_edges_tensor generation:  0.05455279350280762
mini_batch_src_global generation:  0.0966038703918457
r_  generation:  0.9464635848999023
local_output_nid generation:  0.024059534072875977
local_in_edges_tensor generation:  0.04400038719177246
mini_batch_src_global generation:  0.09111571311950684
r_  generation:  0.8110735416412354
local_output_nid generation:  0.03014349937438965
local_in_edges_tensor generation:  0.0528414249420166
mini_batch_src_global generation:  0.10979747772216797
r_  generation:  1.0720500946044922
local_output_nid generation:  0.030046463012695312
local_in_edges_tensor generation:  0.08608245849609375
mini_batch_src_global generation:  0.10292387008666992
r_  generation:  1.0092122554779053
local_output_nid generation:  0.020715713500976562
local_in_edges_tensor generation:  0.04176497459411621
mini_batch_src_global generation:  0.07769584655761719
r_  generation:  0.6547958850860596
local_output_nid generation:  0.031154155731201172
local_in_edges_tensor generation:  0.0768735408782959
mini_batch_src_global generation:  0.09288907051086426
r_  generation:  0.7836992740631104
local_output_nid generation:  0.023740291595458984
local_in_edges_tensor generation:  0.023941993713378906
mini_batch_src_global generation:  0.06487751007080078
r_  generation:  0.514002799987793
local_output_nid generation:  0.028491735458374023
local_in_edges_tensor generation:  0.052222490310668945
mini_batch_src_global generation:  0.08789634704589844
r_  generation:  0.9404711723327637
local_output_nid generation:  0.0247652530670166
local_in_edges_tensor generation:  0.0612032413482666
mini_batch_src_global generation:  0.1016995906829834
r_  generation:  0.8685503005981445
local_output_nid generation:  0.02377176284790039
local_in_edges_tensor generation:  0.03963899612426758
mini_batch_src_global generation:  0.08392167091369629
r_  generation:  0.8159728050231934
local_output_nid generation:  0.02118682861328125
local_in_edges_tensor generation:  0.028676509857177734
mini_batch_src_global generation:  0.08936166763305664
r_  generation:  0.744816780090332
local_output_nid generation:  0.03266501426696777
local_in_edges_tensor generation:  0.06282782554626465
mini_batch_src_global generation:  0.11107301712036133
r_  generation:  1.188920259475708
local_output_nid generation:  0.028218746185302734
local_in_edges_tensor generation:  0.05728721618652344
mini_batch_src_global generation:  0.11295056343078613
r_  generation:  1.0100743770599365
local_output_nid generation:  0.021503210067749023
local_in_edges_tensor generation:  0.046639442443847656
mini_batch_src_global generation:  0.08579397201538086
r_  generation:  0.759352445602417
local_output_nid generation:  0.034062862396240234
local_in_edges_tensor generation:  0.06167340278625488
mini_batch_src_global generation:  0.11737275123596191
r_  generation:  1.232922077178955
----------------------check_connections_block total spend ----------------------------- 37.00021529197693
generate_one_block  1.4524891376495361
generate_one_block  0.9541184902191162
generate_one_block  1.0666773319244385
generate_one_block  0.8497862815856934
generate_one_block  0.8124942779541016
generate_one_block  0.6101436614990234
generate_one_block  0.9840354919433594
generate_one_block  0.6657016277313232
generate_one_block  0.6628060340881348
generate_one_block  0.8158004283905029
generate_one_block  0.9063990116119385
generate_one_block  1.258491039276123
generate_one_block  0.7992229461669922
generate_one_block  0.783989429473877
generate_one_block  0.9400680065155029
generate_one_block  1.1377875804901123
generate_one_block  1.2655584812164307
generate_one_block  1.1895098686218262
generate_one_block  0.9804627895355225
generate_one_block  1.371825933456421
generate_one_block  1.3339135646820068
generate_one_block  0.8463845252990723
generate_one_block  0.89453125
generate_one_block  0.6283926963806152
generate_one_block  1.1688966751098633
generate_one_block  1.0432088375091553
generate_one_block  0.9771199226379395
generate_one_block  0.9407553672790527
generate_one_block  1.448430061340332
generate_one_block  1.2287054061889648
generate_one_block  0.9108381271362305
generate_one_block  1.5799875259399414
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.075460910797119
gen group dst list time:  0.37915611267089844
time for parepare:  0.43961286544799805
local_output_nid generation:  0.13868927955627441
local_in_edges_tensor generation:  0.41315627098083496
mini_batch_src_global generation:  0.3003087043762207
r_  generation:  3.9750516414642334
local_output_nid generation:  0.14380216598510742
local_in_edges_tensor generation:  0.4555091857910156
mini_batch_src_global generation:  0.3123013973236084
r_  generation:  2.80096697807312
local_output_nid generation:  0.12465524673461914
local_in_edges_tensor generation:  0.30574893951416016
mini_batch_src_global generation:  0.35853147506713867
r_  generation:  3.478388547897339
local_output_nid generation:  0.15146327018737793
local_in_edges_tensor generation:  0.3089480400085449
mini_batch_src_global generation:  0.29889893531799316
r_  generation:  3.0629892349243164
local_output_nid generation:  0.10390496253967285
local_in_edges_tensor generation:  0.21035194396972656
mini_batch_src_global generation:  0.27086782455444336
r_  generation:  2.766641855239868
local_output_nid generation:  0.06850337982177734
local_in_edges_tensor generation:  0.17555999755859375
mini_batch_src_global generation:  0.20013213157653809
r_  generation:  1.736607551574707
local_output_nid generation:  0.1553189754486084
local_in_edges_tensor generation:  0.298248291015625
mini_batch_src_global generation:  0.3041222095489502
r_  generation:  3.475538492202759
local_output_nid generation:  0.10353374481201172
local_in_edges_tensor generation:  0.17790746688842773
mini_batch_src_global generation:  0.2693898677825928
r_  generation:  2.4561245441436768
local_output_nid generation:  0.08762311935424805
local_in_edges_tensor generation:  0.14970183372497559
mini_batch_src_global generation:  0.2303297519683838
r_  generation:  2.3745696544647217
local_output_nid generation:  0.1127617359161377
local_in_edges_tensor generation:  0.22164440155029297
mini_batch_src_global generation:  0.2832763195037842
r_  generation:  3.182811737060547
local_output_nid generation:  0.1506028175354004
local_in_edges_tensor generation:  0.27130937576293945
mini_batch_src_global generation:  0.3644590377807617
r_  generation:  3.9807422161102295
local_output_nid generation:  0.1715250015258789
local_in_edges_tensor generation:  0.4471926689147949
mini_batch_src_global generation:  0.45250773429870605
r_  generation:  4.793407201766968
local_output_nid generation:  0.15419316291809082
local_in_edges_tensor generation:  0.22296452522277832
mini_batch_src_global generation:  0.33334970474243164
r_  generation:  3.2043509483337402
local_output_nid generation:  0.09788131713867188
local_in_edges_tensor generation:  0.17397761344909668
mini_batch_src_global generation:  0.2659168243408203
r_  generation:  2.516679525375366
local_output_nid generation:  0.1243906021118164
local_in_edges_tensor generation:  0.22950243949890137
mini_batch_src_global generation:  0.3039112091064453
r_  generation:  3.340850353240967
local_output_nid generation:  0.13608384132385254
local_in_edges_tensor generation:  0.2582733631134033
mini_batch_src_global generation:  0.34586501121520996
r_  generation:  3.618169069290161
local_output_nid generation:  0.1970081329345703
local_in_edges_tensor generation:  0.4035065174102783
mini_batch_src_global generation:  0.5252997875213623
r_  generation:  5.973036050796509
local_output_nid generation:  0.17494797706604004
local_in_edges_tensor generation:  0.41337108612060547
mini_batch_src_global generation:  0.4629349708557129
r_  generation:  4.5538551807403564
local_output_nid generation:  0.16377830505371094
local_in_edges_tensor generation:  0.31041550636291504
mini_batch_src_global generation:  0.4330301284790039
r_  generation:  4.460053443908691
local_output_nid generation:  0.16797590255737305
local_in_edges_tensor generation:  0.33983635902404785
mini_batch_src_global generation:  0.47177696228027344
r_  generation:  5.21439790725708
local_output_nid generation:  0.20421695709228516
local_in_edges_tensor generation:  0.41727614402770996
mini_batch_src_global generation:  0.560671329498291
r_  generation:  6.1616504192352295
local_output_nid generation:  0.12182950973510742
local_in_edges_tensor generation:  0.33895421028137207
mini_batch_src_global generation:  0.4001142978668213
r_  generation:  3.6200385093688965
local_output_nid generation:  0.1654670238494873
local_in_edges_tensor generation:  0.2602989673614502
mini_batch_src_global generation:  0.36058735847473145
r_  generation:  3.749751567840576
local_output_nid generation:  0.07764792442321777
local_in_edges_tensor generation:  0.14803218841552734
mini_batch_src_global generation:  0.2638835906982422
r_  generation:  2.1735470294952393
local_output_nid generation:  0.14258313179016113
local_in_edges_tensor generation:  0.2880728244781494
mini_batch_src_global generation:  0.3751835823059082
r_  generation:  4.365321636199951
local_output_nid generation:  0.1389632225036621
local_in_edges_tensor generation:  0.28448939323425293
mini_batch_src_global generation:  0.41466546058654785
r_  generation:  4.277450799942017
local_output_nid generation:  0.11746549606323242
local_in_edges_tensor generation:  0.27514123916625977
mini_batch_src_global generation:  0.35304808616638184
r_  generation:  3.517289638519287
local_output_nid generation:  0.13161468505859375
local_in_edges_tensor generation:  0.3010280132293701
mini_batch_src_global generation:  0.3504364490509033
r_  generation:  3.555467367172241
local_output_nid generation:  0.18920421600341797
local_in_edges_tensor generation:  0.3593332767486572
mini_batch_src_global generation:  0.45735645294189453
r_  generation:  5.1532979011535645
local_output_nid generation:  0.16684746742248535
local_in_edges_tensor generation:  0.3315463066101074
mini_batch_src_global generation:  0.4764571189880371
r_  generation:  4.828882694244385
local_output_nid generation:  0.09476113319396973
local_in_edges_tensor generation:  0.19013428688049316
mini_batch_src_global generation:  0.34290289878845215
r_  generation:  2.838625907897949
local_output_nid generation:  0.19423460960388184
local_in_edges_tensor generation:  0.39984989166259766
mini_batch_src_global generation:  0.4912569522857666
r_  generation:  5.80257773399353
----------------------check_connections_block total spend ----------------------------- 169.49797081947327
generate_one_block  5.742990493774414
generate_one_block  3.824881076812744
generate_one_block  4.56665563583374
generate_one_block  4.052640199661255
generate_one_block  4.103572130203247
generate_one_block  2.2611262798309326
generate_one_block  4.848986864089966
generate_one_block  3.205293655395508
generate_one_block  2.8866310119628906
generate_one_block  4.223120927810669
generate_one_block  5.417154312133789
generate_one_block  6.199830770492554
generate_one_block  4.499319791793823
generate_one_block  3.0028743743896484
generate_one_block  4.248821258544922
generate_one_block  4.592065095901489
generate_one_block  7.397585868835449
generate_one_block  6.136618137359619
generate_one_block  5.7858500480651855
generate_one_block  6.358948707580566
generate_one_block  7.647676229476929
generate_one_block  4.473124027252197
generate_one_block  4.899022579193115
generate_one_block  2.8234777450561523
generate_one_block  5.463663101196289
generate_one_block  5.203340291976929
generate_one_block  4.308056831359863
generate_one_block  4.58392596244812
generate_one_block  6.630833387374878
generate_one_block  6.435657262802124
generate_one_block  3.5220096111297607
generate_one_block  7.22470760345459
The real block id is  0
get_global_graph_edges_ids_block function  spend 1.2499701976776123
gen group dst list time:  1.3216814994812012
time for parepare:  0.4642810821533203
local_output_nid generation:  0.44840216636657715
local_in_edges_tensor generation:  0.7987687587738037
mini_batch_src_global generation:  0.3892796039581299
r_  generation:  6.117542028427124
local_output_nid generation:  0.37033700942993164
local_in_edges_tensor generation:  0.6044061183929443
mini_batch_src_global generation:  0.4215879440307617
r_  generation:  5.196143627166748
local_output_nid generation:  0.4195365905761719
local_in_edges_tensor generation:  0.5864238739013672
mini_batch_src_global generation:  0.4333069324493408
r_  generation:  5.620131492614746
local_output_nid generation:  0.3995182514190674
local_in_edges_tensor generation:  0.5582103729248047
mini_batch_src_global generation:  0.4259176254272461
r_  generation:  5.430529356002808
local_output_nid generation:  0.3535435199737549
local_in_edges_tensor generation:  0.5088732242584229
mini_batch_src_global generation:  0.40677785873413086
r_  generation:  5.058665990829468
local_output_nid generation:  0.23698639869689941
local_in_edges_tensor generation:  0.3332231044769287
mini_batch_src_global generation:  0.31061720848083496
r_  generation:  3.3322606086730957
local_output_nid generation:  0.43045496940612793
local_in_edges_tensor generation:  0.6830694675445557
mini_batch_src_global generation:  0.4437675476074219
r_  generation:  5.991426706314087
local_output_nid generation:  0.3933107852935791
local_in_edges_tensor generation:  0.4918396472930908
mini_batch_src_global generation:  0.41447019577026367
r_  generation:  4.986568212509155
local_output_nid generation:  0.31479692459106445
local_in_edges_tensor generation:  0.432096004486084
mini_batch_src_global generation:  0.3654141426086426
r_  generation:  4.526939630508423
local_output_nid generation:  0.4192523956298828
local_in_edges_tensor generation:  0.6143090724945068
mini_batch_src_global generation:  0.46753859519958496
r_  generation:  6.165841579437256
local_output_nid generation:  0.44902515411376953
local_in_edges_tensor generation:  0.6807742118835449
mini_batch_src_global generation:  0.5141141414642334
r_  generation:  6.2078893184661865
local_output_nid generation:  0.5167641639709473
local_in_edges_tensor generation:  0.6942789554595947
mini_batch_src_global generation:  0.5988941192626953
r_  generation:  7.492006301879883
local_output_nid generation:  0.44179654121398926
local_in_edges_tensor generation:  0.623511552810669
mini_batch_src_global generation:  0.5580630302429199
r_  generation:  5.948508262634277
local_output_nid generation:  0.3536245822906494
local_in_edges_tensor generation:  0.4701104164123535
mini_batch_src_global generation:  0.36321234703063965
r_  generation:  4.212134838104248
local_output_nid generation:  0.3903920650482178
local_in_edges_tensor generation:  0.5455722808837891
mini_batch_src_global generation:  0.41782641410827637
r_  generation:  5.5929601192474365
local_output_nid generation:  0.4085516929626465
local_in_edges_tensor generation:  0.5752806663513184
mini_batch_src_global generation:  0.4893319606781006
r_  generation:  5.837745189666748
local_output_nid generation:  0.5764303207397461
local_in_edges_tensor generation:  0.8237779140472412
mini_batch_src_global generation:  0.5707178115844727
r_  generation:  7.576404333114624
local_output_nid generation:  0.467334508895874
local_in_edges_tensor generation:  0.6691591739654541
mini_batch_src_global generation:  0.5671827793121338
r_  generation:  6.773972511291504
local_output_nid generation:  0.4512171745300293
local_in_edges_tensor generation:  0.6497843265533447
mini_batch_src_global generation:  0.5406448841094971
r_  generation:  6.555720090866089
local_output_nid generation:  0.5344188213348389
local_in_edges_tensor generation:  0.768096923828125
mini_batch_src_global generation:  0.5533416271209717
r_  generation:  7.062602281570435
local_output_nid generation:  0.5537092685699463
local_in_edges_tensor generation:  0.7948155403137207
mini_batch_src_global generation:  0.689751386642456
r_  generation:  8.425838232040405
local_output_nid generation:  0.49215030670166016
local_in_edges_tensor generation:  0.6906273365020752
mini_batch_src_global generation:  0.7499551773071289
r_  generation:  6.464740991592407
local_output_nid generation:  0.4712224006652832
local_in_edges_tensor generation:  0.6646683216094971
mini_batch_src_global generation:  0.49233508110046387
r_  generation:  6.0864176750183105
local_output_nid generation:  0.302370548248291
local_in_edges_tensor generation:  0.43665623664855957
mini_batch_src_global generation:  0.4037463665008545
r_  generation:  4.329203367233276
local_output_nid generation:  0.42250490188598633
local_in_edges_tensor generation:  0.6182301044464111
mini_batch_src_global generation:  0.4794950485229492
r_  generation:  6.21614670753479
local_output_nid generation:  0.5062494277954102
local_in_edges_tensor generation:  0.7148621082305908
mini_batch_src_global generation:  0.5105338096618652
r_  generation:  6.585952281951904
local_output_nid generation:  0.38020825386047363
local_in_edges_tensor generation:  0.5485610961914062
mini_batch_src_global generation:  0.4599575996398926
r_  generation:  5.596510648727417
local_output_nid generation:  0.3963503837585449
local_in_edges_tensor generation:  0.5730319023132324
mini_batch_src_global generation:  0.4717230796813965
r_  generation:  5.819319725036621
local_output_nid generation:  0.4399116039276123
local_in_edges_tensor generation:  0.6935791969299316
mini_batch_src_global generation:  0.5027587413787842
r_  generation:  6.352315664291382
local_output_nid generation:  0.506793737411499
local_in_edges_tensor generation:  0.6581308841705322
mini_batch_src_global generation:  0.5213379859924316
r_  generation:  6.536217927932739
local_output_nid generation:  0.3327364921569824
local_in_edges_tensor generation:  0.47443127632141113
mini_batch_src_global generation:  0.443096399307251
r_  generation:  4.94031023979187
local_output_nid generation:  0.4982728958129883
local_in_edges_tensor generation:  0.7034342288970947
mini_batch_src_global generation:  0.5436725616455078
r_  generation:  7.111952543258667
----------------------check_connections_block total spend ----------------------------- 278.5073220729828
generate_one_block  8.273608446121216
generate_one_block  6.5491623878479
generate_one_block  6.856769561767578
generate_one_block  6.522320032119751
generate_one_block  6.427058696746826
generate_one_block  4.041705846786499
generate_one_block  7.134039640426636
generate_one_block  5.945616245269775
generate_one_block  5.2036354541778564
generate_one_block  7.233489513397217
generate_one_block  9.510574579238892
generate_one_block  8.301334142684937
generate_one_block  6.5660247802734375
generate_one_block  4.956137418746948
generate_one_block  6.706517219543457
generate_one_block  6.994203567504883
generate_one_block  9.224912166595459
generate_one_block  7.8568243980407715
generate_one_block  7.672388076782227
generate_one_block  8.988223552703857
generate_one_block  9.79879879951477
generate_one_block  7.820364952087402
generate_one_block  7.30890965461731
generate_one_block  7.309283018112183
generate_one_block  7.245169401168823
generate_one_block  7.766167640686035
generate_one_block  6.466685771942139
generate_one_block  7.154679775238037
generate_one_block  7.4305360317230225
generate_one_block  7.7552103996276855
generate_one_block  5.662952899932861
generate_one_block  8.626082420349121
----------===============-------------===============-------------the number of batches *****---- 32

original number of batches:  31
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  489.25490260124207
block generation total time  425.55354166030884
average batch blocks generation time:  3.324637044221163
block dataloader generation time/epoch 1021.5414769649506
pseudo mini batch 0 input nodes size: 1837468
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.6857671737670898  GigaBytes
Max Memory Allocated: 0.6857671737670898  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.685814380645752  GigaBytes
Max Memory Allocated: 0.685814380645752  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.685814380645752  GigaBytes
Max Memory Allocated: 0.685814380645752  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.8698649406433105  GigaBytes
Max Memory Allocated: 0.8698649406433105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.8698649406433105  GigaBytes
Max Memory Allocated: 0.8698649406433105  GigaBytes

first layer input nodes number: 1837468
first layer output nodes number: 1302488
edges number: 12507738
----------------------------------------before model layer 0
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.8932600021362305  GigaBytes
Max Memory Allocated: 0.9401350021362305  GigaBytes

torch.Size([1837468, 100])
----------------------------------------after rst
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 3.961452007293701  GigaBytes
Max Memory Allocated: 5.203639507293701  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 2.719264507293701  GigaBytes
Max Memory Allocated: 5.203639507293701  GigaBytes

torch.Size([1302488, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 3.961452007293701  GigaBytes
Max Memory Allocated: 5.203639507293701  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 4.271989345550537  GigaBytes
Max Memory Allocated: 5.514176845550537  GigaBytes

input nodes number: 1302488
output nodes number: 411920
edges number: 9531210
----------------------------------------before model layer 1
 Nvidia-smi: 7.8065185546875 GB
    Memory Allocated: 4.284763336181641  GigaBytes
Max Memory Allocated: 5.514176845550537  GigaBytes

torch.Size([1302488, 256])
----------------------------------------after rst
 Nvidia-smi: 8.2010498046875 GB
    Memory Allocated: 5.537796974182129  GigaBytes
Max Memory Allocated: 5.930634498596191  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.2010498046875 GB
    Memory Allocated: 5.144959449768066  GigaBytes
Max Memory Allocated: 5.930634498596191  GigaBytes

torch.Size([411920, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.2010498046875 GB
    Memory Allocated: 5.537796974182129  GigaBytes
Max Memory Allocated: 5.930634498596191  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.2010498046875 GB
    Memory Allocated: 5.6360063552856445  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

input nodes number: 411920
output nodes number: 82698
edges number: 2340380
----------------------------------------before model layer 2
 Nvidia-smi: 8.2010498046875 GB
    Memory Allocated: 5.639692306518555  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

torch.Size([411920, 256])
----------------------------------------after rst
 Nvidia-smi: 8.2030029296875 GB
    Memory Allocated: 5.89434814453125  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 8.2030029296875 GB
    Memory Allocated: 5.815481185913086  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

torch.Size([82698, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 8.2030029296875 GB
    Memory Allocated: 5.89434814453125  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 8.2030029296875 GB
    Memory Allocated: 5.914064884185791  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 5.924749851226807  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 5.923636436462402  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

torch.Size([6303, 47])
input nodes number: 82698
output nodes number: 6303
edges number: 248073
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 5.925413608551025  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 5.925414562225342  GigaBytes
Max Memory Allocated: 6.028843879699707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 1.2006568908691406  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 1 input nodes size: 1758527
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.6881856918334961  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.6881856918334961  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 1.3432884216308594  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 1.3433351516723633  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.6587777137756348  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.8051714897155762  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.8051714897155762  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1758527
first layer output nodes number: 1085268
edges number: 10380301
----------------------------------------before model layer 0
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 0.826359748840332  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1758527, 100])
----------------------------------------after rst
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 3.382021427154541  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 2.347029209136963  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1085268, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 3.382021427154541  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 3.6407694816589355  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1085268
output nodes number: 303421
edges number: 6819773
----------------------------------------before model layer 1
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 3.6514973640441895  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1085268, 256])
----------------------------------------after rst
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.572664737701416  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.283299922943115  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([303421, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.572664737701416  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.64500617980957  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 303421
output nodes number: 71575
edges number: 1995030
----------------------------------------before model layer 2
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.648026466369629  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([303421, 256])
----------------------------------------after rst
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.869125843048096  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.800866603851318  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([71575, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.869125843048096  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.886190891265869  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.896224498748779  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.895129203796387  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([6254, 47])
input nodes number: 71575
output nodes number: 6254
edges number: 245851
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.89653205871582  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.1678466796875 GB
    Memory Allocated: 4.8965325355529785  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 1.0663189888000488  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 2 input nodes size: 1729118
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.6596002578735352  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.6596002578735352  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 1.3037471771240234  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 1.3037924766540527  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.6486430168151855  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.8106932640075684  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.8106932640075684  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1729118
first layer output nodes number: 1138299
edges number: 10952350
----------------------------------------before model layer 0
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 0.8320574760437012  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1729118, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 3.513082981109619  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 2.427516460418701  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1138299, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 3.513082981109619  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 3.7844748497009277  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1138299
output nodes number: 356558
edges number: 8233715
----------------------------------------before model layer 1
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 3.795649528503418  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1138299, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 4.880175590515137  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 4.540135383605957  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([356558, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 4.880175590515137  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 4.965185642242432  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 356558
output nodes number: 78813
edges number: 2243192
----------------------------------------before model layer 2
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 4.968430042266846  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([356558, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.211599826812744  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.136437892913818  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([78813, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.211599826812744  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.230390548706055  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.241824626922607  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.2404961585998535  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([6076, 47])
input nodes number: 78813
output nodes number: 6076
edges number: 240239
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.240521430969238  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2030029296875 GB
    Memory Allocated: 5.2405219078063965  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.101346492767334  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 3 input nodes size: 1700287
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6480355262756348  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6480355262756348  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2814421653747559  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2814879417419434  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6372957229614258  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7835197448730469  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7835197448730469  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1700287
first layer output nodes number: 1088912
edges number: 10378571
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8043012619018555  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1700287, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.368959903717041  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.3304924964904785  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1088912, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.368959903717041  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.6285767555236816  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1088912
output nodes number: 323147
edges number: 7212132
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.6397452354431152  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1088912, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.620723724365234  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.312546730041504  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([323147, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.620723724365234  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.697768211364746  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 323147
output nodes number: 67635
edges number: 1799205
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.700680255889893  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([323147, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.908095836639404  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.843594074249268  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([67635, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.908095836639404  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.924221515655518  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.934082984924316  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.932939052581787  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([6126, 47])
input nodes number: 67635
output nodes number: 6126
edges number: 235707
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.933304309844971  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.933304786682129  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.0478343963623047  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 4 input nodes size: 1685693
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6371111869812012  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6371111869812012  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2650809288024902  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2651257514953613  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6316733360290527  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7654356956481934  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7654356956481934  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1685693
first layer output nodes number: 1019269
edges number: 9600071
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7855896949768066  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1685693, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.184722423553467  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.2126717567443848  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1019269, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.184722423553467  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.4277353286743164  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1019269
output nodes number: 301642
edges number: 6419265
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.438188076019287  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1019269, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.351490497589111  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.063822269439697  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([301642, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.351490497589111  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.423407554626465  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 301642
output nodes number: 65335
edges number: 1713527
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.42614221572876  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([301642, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.626321315765381  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.5640130043029785  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([65335, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.626321315765381  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.6418986320495605  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.651612281799316  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.65034294128418  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5987, 47])
input nodes number: 65335
output nodes number: 5987
edges number: 220212
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.651000022888184  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.651000499725342  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.0071601867675781  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 5 input nodes size: 1363373
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6317987442016602  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6317987442016602  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.139695167541504  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.139739990234375  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5117254257202148  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6010141372680664  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6010141372680664  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1363373
first layer output nodes number: 673713
edges number: 6331689
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6161918640136719  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1363373, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.202714443206787  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.5602116584777832  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([673713, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.202714443206787  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.363340377807617  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 673713
output nodes number: 194766
edges number: 3980221
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.369811534881592  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([673713, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.95814847946167  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.7724051475524902  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([194766, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.95814847946167  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.00502347946167  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 194766
output nodes number: 54116
edges number: 1349772
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.007439613342285  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([194766, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.172727584838867  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1211185455322266  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([54116, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.172727584838867  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1856298446655273  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.195056915283203  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.19401216506958  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5966, 47])
input nodes number: 54116
output nodes number: 5966
edges number: 215070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1943297386169434  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1943302154541016  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7633180618286133  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 6 input nodes size: 1812793
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5115947723388672  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5115947723388672  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.186913013458252  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.186957836151123  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6790165901184082  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8434944152832031  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8434944152832031  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1812793
first layer output nodes number: 1219118
edges number: 11462758
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.866084098815918  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1812793, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7354702949523926  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.572828769683838  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1219118, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7354702949523926  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.026130676269531  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1219118
output nodes number: 387611
edges number: 8324415
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.038102149963379  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1219118, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.2120890617370605  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.842434406280518  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([387611, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.2120890617370605  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.304502964019775  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 387611
output nodes number: 77740
edges number: 2026970
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.3079705238342285  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([387611, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.546830177307129  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.472691535949707  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([77740, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.546830177307129  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.565364837646484  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.57513952255249  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.573979377746582  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5963, 47])
input nodes number: 77740
output nodes number: 5963
edges number: 214461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.574625015258789  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.574625492095947  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.1398587226867676  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 7 input nodes size: 1664327
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6790380477905273  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6790380477905273  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2990484237670898  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.299095630645752  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6237325668334961  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7482995986938477  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7482995986938477  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1664327
first layer output nodes number: 995494
edges number: 9389086
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7681174278259277  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1664327, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1113858222961426  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.162008762359619  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([995494, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.1113858222961426  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.3487300872802734  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 995494
output nodes number: 263746
edges number: 5657642
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.358279228210449  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([995494, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.15701150894165  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.9054837226867676  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([263746, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.15701150894165  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.219893455505371  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 263746
output nodes number: 54510
edges number: 1427787
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.222431659698486  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([263746, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.389430522918701  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.3374457359313965  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([54510, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.389430522918701  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.402426719665527  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.413996696472168  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.412375450134277  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([6314, 47])
input nodes number: 54510
output nodes number: 6314
edges number: 244342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.413290023803711  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.413290500640869  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.9711899757385254  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 8 input nodes size: 1515365
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6241936683654785  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6241936683654785  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.188711166381836  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.188755989074707  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5686984062194824  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6819605827331543  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6819605827331543  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1515365
first layer output nodes number: 880342
edges number: 8234167
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7004399299621582  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1515365, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.772141933441162  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.9325823783874512  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([880342, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.772141933441162  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.98203182220459  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 880342
output nodes number: 254021
edges number: 5326589
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.9904842376708984  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([880342, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7588233947753906  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.5165700912475586  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([254021, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7588233947753906  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.8193869590759277  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 254021
output nodes number: 56210
edges number: 1417087
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.8216991424560547  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([254021, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.993494987487793  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.9398889541625977  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([56210, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.993494987487793  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.007312297821045  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.016953468322754  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.015898704528809  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5996, 47])
input nodes number: 56210
output nodes number: 5996
edges number: 223751
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.015796184539795  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.015796661376953  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8860125541687012  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 9 input nodes size: 1818412
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5681319236755371  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.5681319236755371  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2455434799194336  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.2455906867980957  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6810283660888672  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8334445953369141  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8334445953369141  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1818412
first layer output nodes number: 1211437
edges number: 11449279
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8560190200805664  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1818412, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7077651023864746  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.5524487495422363  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1211437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.7077651023864746  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.9965944290161133  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1211437
output nodes number: 333805
edges number: 7099683
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.008107662200928  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1211437, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.019500255584717  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.7011590003967285  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([333805, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.019500255584717  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.099085807800293  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 333805
output nodes number: 67048
edges number: 1667867
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.102072715759277  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([333805, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.306825637817383  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.242883682250977  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([67048, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.306825637817383  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.322811126708984  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.333070278167725  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.331758499145508  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([6301, 47])
input nodes number: 67048
output nodes number: 6301
edges number: 239775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.3323540687561035  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.332354545593262  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.103480339050293  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 10 input nodes size: 1810760
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6810770034790039  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6810770034790039  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.355638027191162  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.3556828498840332  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.6782240867614746  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8493819236755371  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8493819236755371  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1810760
first layer output nodes number: 1261214
edges number: 11870116
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.8722705841064453  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1810760, 100])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.840823173522949  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 2.638035774230957  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1261214, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 3.840823173522949  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.141520023345947  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1261214
output nodes number: 409888
edges number: 9023281
----------------------------------------before model layer 1
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 4.154773712158203  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1261214, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.397756576538086  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.006856918334961  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([409888, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.397756576538086  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.495481491088867  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 409888
output nodes number: 69275
edges number: 1851358
----------------------------------------before model layer 2
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.499492645263672  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([409888, 256])
----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.712000846862793  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.64593505859375  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([69275, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.712000846862793  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.728517532348633  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.738511085510254  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.7373833656311035  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5963, 47])
input nodes number: 69275
output nodes number: 5963
edges number: 227364
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.737968921661377  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 5.737969398498535  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.1573882102966309  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

pseudo mini batch 11 input nodes size: 1881630
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.678248405456543  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.678248405456543  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.3792104721069336  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 1.3792552947998047  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.7046494483947754  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.9031710624694824  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.9031710624694824  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

first layer input nodes number: 1881630
first layer output nodes number: 1397958
edges number: 13109199
----------------------------------------before model layer 0
 Nvidia-smi: 12.2049560546875 GB
    Memory Allocated: 0.9279742240905762  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1881630, 100])
----------------------------------------after rst
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 4.219906330108643  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 2.8859219551086426  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1397958, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 4.219906330108643  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 4.554100513458252  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 1397958
output nodes number: 500767
edges number: 10959831
----------------------------------------before model layer 1
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 4.568602085113525  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([1397958, 256])
----------------------------------------after rst
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.086697101593018  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 5.609128475189209  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([500767, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.086697101593018  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.206089496612549  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

input nodes number: 500767
output nodes number: 88178
edges number: 2348079
----------------------------------------before model layer 2
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.210477828979492  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([500767, 256])
----------------------------------------after rst
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.480921268463135  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.3968281745910645  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([88178, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.480921268463135  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.501944541931152  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.511605739593506  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.510418891906738  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

torch.Size([5964, 47])
input nodes number: 88178
output nodes number: 5964
edges number: 227795
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.511068344116211  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2420654296875 GB
    Memory Allocated: 6.511068820953369  GigaBytes
Max Memory Allocated: 6.964968204498291  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.26287841796875  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

pseudo mini batch 12 input nodes size: 1730796
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.704596996307373  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.704596996307373  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.3493690490722656  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.3494157791137695  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6484088897705078  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.7932777404785156  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.7932777404785156  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

first layer input nodes number: 1730796
first layer output nodes number: 1114869
edges number: 10435826
----------------------------------------before model layer 0
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8144798278808594  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1730796, 100])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.4381513595581055  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.374929428100586  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1114869, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.4381513595581055  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.7039570808410645  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 1114869
output nodes number: 340374
edges number: 7089206
----------------------------------------before model layer 1
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.7149930000305176  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1114869, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.744614601135254  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.420008659362793  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([340374, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.744614601135254  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.825766086578369  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 340374
output nodes number: 68668
edges number: 1686295
----------------------------------------before model layer 2
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.8288140296936035  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([340374, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.038351535797119  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.972864627838135  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([68668, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.038351535797119  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.054723262786865  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.065564155578613  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.064255237579346  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([6226, 47])
input nodes number: 68668
output nodes number: 6226
edges number: 232322
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.065047264099121  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.065047740936279  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.0545635223388672  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

pseudo mini batch 13 input nodes size: 1491291
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6486425399780273  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6486425399780273  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.2041921615600586  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.2042393684387207  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.5594205856323242  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.673365592956543  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.673365592956543  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

first layer input nodes number: 1491291
first layer output nodes number: 845420
edges number: 7788619
----------------------------------------before model layer 0
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6907758712768555  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1491291, 100])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.679920196533203  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.8736648559570312  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([845420, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.679920196533203  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.881484031677246  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 845420
output nodes number: 283574
edges number: 5624555
----------------------------------------before model layer 1
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.8903017044067383  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([845420, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.747455596923828  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.477018356323242  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([283574, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.747455596923828  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.8150649070739746  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 283574
output nodes number: 66638
edges number: 1644488
----------------------------------------before model layer 2
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.817962646484375  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([283574, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.021365165710449  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.9578142166137695  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([66638, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.021365165710449  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.037252902984619  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.0473432540893555  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.046191215515137  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([6321, 47])
input nodes number: 66638
output nodes number: 6321
edges number: 235596
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.046578407287598  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.046578884124756  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8833451271057129  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

pseudo mini batch 14 input nodes size: 1714761
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.5592637062072754  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.5592637062072754  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.1980624198913574  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.1981091499328613  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.642512321472168  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.7915420532226562  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.7915420532226562  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

first layer input nodes number: 1714761
first layer output nodes number: 1113205
edges number: 10316468
----------------------------------------before model layer 0
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8134121894836426  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1714761, 100])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.4323949813842773  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.370759963989258  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1113205, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.4323949813842773  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.6978039741516113  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 1113205
output nodes number: 366340
edges number: 7520356
----------------------------------------before model layer 1
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.7090954780578613  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1113205, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.815964221954346  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.46659517288208  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([366340, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.815964221954346  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.903306484222412  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 366340
output nodes number: 75569
edges number: 1930337
----------------------------------------before model layer 2
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.906800270080566  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([366340, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.138488292694092  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.066420078277588  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([75569, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.138488292694092  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.156867504119873  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.16682243347168  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.1656975746154785  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([6229, 47])
input nodes number: 75569
output nodes number: 6229
edges number: 235013
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.166280269622803  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.166280746459961  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.062124252319336  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

pseudo mini batch 15 input nodes size: 1767802
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6424851417541504  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6424851417541504  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.3010430335998535  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.301088809967041  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6622433662414551  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8222079277038574  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8222079277038574  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

first layer input nodes number: 1767802
first layer output nodes number: 1175418
edges number: 10836199
----------------------------------------before model layer 0
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.8441367149353027  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1767802, 100])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.6090612411499023  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 2.488095283508301  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1175418, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.6090612411499023  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.8893027305603027  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 1175418
output nodes number: 411348
edges number: 8113708
----------------------------------------before model layer 1
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 3.901125431060791  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1175418, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.1419677734375  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 4.749675750732422  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([411348, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.1419677734375  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.2400407791137695  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 411348
output nodes number: 91716
edges number: 2292975
----------------------------------------before model layer 2
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.244166374206543  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([411348, 256])
----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.524335861206055  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.436868667602539  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([91716, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.524335861206055  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.546202659606934  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.557149887084961  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.555610656738281  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([6099, 47])
input nodes number: 91716
output nodes number: 6099
edges number: 227046
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.556283473968506  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 5.556283950805664  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.1132831573486328  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

pseudo mini batch 16 input nodes size: 1941952
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6621866226196289  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.6621866226196289  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.3856201171875  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 1.385664939880371  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.7270612716674805  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.9520206451416016  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.9520206451416016  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

first layer input nodes number: 1941952
first layer output nodes number: 1530674
edges number: 14460508
----------------------------------------before model layer 0
 Nvidia-smi: 17.6678466796875 GB
    Memory Allocated: 0.9778938293457031  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1941952, 100])
----------------------------------------after rst
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 4.581085681915283  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 3.121321201324463  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1530674, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 4.581085681915283  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 4.946026802062988  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 1530674
output nodes number: 586388
edges number: 13268322
----------------------------------------before model layer 1
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 4.962493896484375  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([1530674, 256])
----------------------------------------after rst
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 6.743390083312988  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 6.18416690826416  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([586388, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 6.743390083312988  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 6.883195877075195  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

input nodes number: 586388
output nodes number: 84507
edges number: 2279283
----------------------------------------before model layer 2
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 6.888195037841797  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([586388, 256])
----------------------------------------after rst
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.147583961486816  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.066991806030273  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([84507, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.147583961486816  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.167732238769531  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.1781182289123535  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.176954746246338  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

torch.Size([5963, 47])
input nodes number: 84507
output nodes number: 5963
edges number: 185258
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.177724838256836  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.0994873046875 GB
    Memory Allocated: 7.177725315093994  GigaBytes
Max Memory Allocated: 7.453790664672852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 1.3591656684875488  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

pseudo mini batch 17 input nodes size: 1815074
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.7271566390991211  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.7271566390991211  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 1.4033246040344238  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 1.4033713340759277  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.6798930168151855  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.8707165718078613  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.8707165718078613  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

first layer input nodes number: 1815074
first layer output nodes number: 1321990
edges number: 12648323
----------------------------------------before model layer 0
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 0.8940901756286621  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1815074, 100])
----------------------------------------after rst
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 4.007229328155518  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 2.746481418609619  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1321990, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 4.007229328155518  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 4.322416305541992  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 1321990
output nodes number: 450958
edges number: 10296757
----------------------------------------before model layer 1
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 4.335626602172852  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1321990, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.706179618835449  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.2761125564575195  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([450958, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.706179618835449  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.813696384429932  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 450958
output nodes number: 84518
edges number: 2347556
----------------------------------------before model layer 2
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.817687034606934  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([450958, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 6.07855224609375  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 5.997949600219727  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([84518, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 6.07855224609375  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 6.098702907562256  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 6.109152793884277  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.6561279296875 GB
    Memory Allocated: 6.107668876647949  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([6261, 47])
input nodes number: 84518
output nodes number: 6261
edges number: 233880
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6580810546875 GB
    Memory Allocated: 6.108278274536133  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.6580810546875 GB
    Memory Allocated: 6.108278751373291  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.2140841484069824  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

pseudo mini batch 18 input nodes size: 1764702
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.6798257827758789  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.6798257827758789  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.337228775024414  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.3372735977172852  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.6610589027404785  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.8459916114807129  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.8459916114807129  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

first layer input nodes number: 1764702
first layer output nodes number: 1288620
edges number: 12388882
----------------------------------------before model layer 0
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.8687410354614258  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1764702, 100])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 3.903743267059326  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 2.6748194694519043  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1288620, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 3.903743267059326  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.210974216461182  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 1288620
output nodes number: 443744
edges number: 10270080
----------------------------------------before model layer 1
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.224210739135742  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1288620, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.5740461349487305  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.1508588790893555  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([443744, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.5740461349487305  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.679842948913574  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 443744
output nodes number: 69885
edges number: 1942311
----------------------------------------before model layer 2
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.684094429016113  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([443744, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.8991899490356445  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.832542419433594  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([69885, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.8991899490356445  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.915852069854736  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.925491809844971  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.924286842346191  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([5982, 47])
input nodes number: 69885
output nodes number: 5982
edges number: 219713
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.924961090087891  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.924961566925049  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.1785240173339844  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

pseudo mini batch 19 input nodes size: 1884378
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.6611676216125488  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.6611676216125488  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.3631534576416016  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.3632001876831055  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.7057523727416992  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.9143404960632324  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.9143404960632324  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

first layer input nodes number: 1884378
first layer output nodes number: 1413585
edges number: 13536190
----------------------------------------before model layer 0
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.9389128684997559  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1884378, 100])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.2680583000183105  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 2.9199585914611816  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1413585, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.2680583000183105  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.605083465576172  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 1413585
output nodes number: 499289
edges number: 11528484
----------------------------------------before model layer 1
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 4.619336128234863  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1413585, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.138155937194824  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 5.661996841430664  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([499289, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.138155937194824  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.257195949554443  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 499289
output nodes number: 93405
edges number: 2634616
----------------------------------------before model layer 2
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.261612415313721  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([499289, 256])
----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.5491719245910645  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.460093975067139  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([93405, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.5491719245910645  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.571441650390625  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.581663608551025  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.580383777618408  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([6255, 47])
input nodes number: 93405
output nodes number: 6255
edges number: 246236
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.581017017364502  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 6.58101749420166  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.2910842895507812  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

pseudo mini batch 20 input nodes size: 1994083
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.7056427001953125  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.7056427001953125  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.4484968185424805  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.4485416412353516  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.7465090751647949  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.9814906120300293  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 0.9814906120300293  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

first layer input nodes number: 1994083
first layer output nodes number: 1592423
edges number: 15120786
----------------------------------------before model layer 0
 Nvidia-smi: 14.6600341796875 GB
    Memory Allocated: 1.0082125663757324  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1994083, 100])
----------------------------------------after rst
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 4.759820461273193  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 3.2402892112731934  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1592423, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 4.759820461273193  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 5.13948392868042  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 1592423
output nodes number: 604271
edges number: 13796773
----------------------------------------before model layer 1
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 5.156022548675537  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([1592423, 256])
----------------------------------------after rst
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 6.992557525634766  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 6.4162797927856445  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([604271, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 6.992557525634766  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.136627197265625  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

input nodes number: 604271
output nodes number: 87697
edges number: 2405950
----------------------------------------before model layer 2
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.141783237457275  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([604271, 256])
----------------------------------------after rst
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.411266803741455  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.327632427215576  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([87697, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.411266803741455  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.432686805725098  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.442108154296875  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.44106388092041  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

torch.Size([5963, 47])
input nodes number: 87697
output nodes number: 5963
edges number: 214878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.441937446594238  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2420654296875 GB
    Memory Allocated: 7.4419379234313965  GigaBytes
Max Memory Allocated: 8.133386135101318  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.4064035415649414  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 21 input nodes size: 1779051
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7466840744018555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7466840744018555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.4094324111938477  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.4094781875610352  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6665792465209961  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8270754814147949  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8270754814147949  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1779051
first layer output nodes number: 1219936
edges number: 11730057
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8494200706481934  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1779051, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7226662635803223  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.5592446327209473  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1219936, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7226662635803223  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.013521671295166  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1219936
output nodes number: 346597
edges number: 7920701
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.025193691253662  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1219936, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.078660488128662  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.748119831085205  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([346597, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.078660488128662  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.1612958908081055  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 346597
output nodes number: 59893
edges number: 1627432
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.164324760437012  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([346597, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.349658966064453  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.292540550231934  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([59893, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.349658966064453  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.363938808441162  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.373919486999512  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.372750759124756  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6088, 47])
input nodes number: 59893
output nodes number: 6088
edges number: 223992
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.373141288757324  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.373141765594482  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.1113224029541016  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 22 input nodes size: 1736567
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6664776802062988  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6664776802062988  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.313399314880371  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3134465217590332  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6506524085998535  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8151230812072754  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8151230812072754  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1736567
first layer output nodes number: 1209144
edges number: 11563270
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8370704650878906  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1736567, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.6853489875793457  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.532219409942627  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1209144, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.6853489875793457  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9736313819885254  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1209144
output nodes number: 384802
edges number: 8341845
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9855074882507324  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1209144, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.151534080505371  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.784558296203613  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([384802, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.151534080505371  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.2432780265808105  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 384802
output nodes number: 73529
edges number: 1852043
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.246992111206055  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([384802, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.472404479980469  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.402281761169434  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([73529, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.472404479980469  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.489935398101807  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.500619411468506  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.498794078826904  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6327, 47])
input nodes number: 73529
output nodes number: 6327
edges number: 223882
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.5000457763671875  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.500046253204346  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.1094517707824707  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 23 input nodes size: 1448964
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6513090133666992  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6513090133666992  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.1910905838012695  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.1911377906799316  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.5441689491271973  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6539702415466309  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6539702415466309  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1448964
first layer output nodes number: 866145
edges number: 8287639
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6712198257446289  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1448964, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.710899829864502  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.8848795890808105  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([866145, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.710899829864502  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.917405128479004  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 866145
output nodes number: 239001
edges number: 4867932
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.9269275665283203  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([866145, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.6487655639648438  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.4208364486694336  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([239001, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.6487655639648438  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7057480812072754  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 239001
output nodes number: 58426
edges number: 1352173
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7079644203186035  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([239001, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.885723114013672  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.8300037384033203  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([58426, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.885723114013672  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.8996529579162598  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.909858226776123  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.908660411834717  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6321, 47])
input nodes number: 58426
output nodes number: 6321
edges number: 229323
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.908515453338623  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9085159301757812  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8494524955749512  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 24 input nodes size: 1686853
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.543541431427002  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.543541431427002  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.171943187713623  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.171989917755127  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6321611404418945  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8112311363220215  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8112311363220215  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1686853
first layer output nodes number: 1199445
edges number: 11554553
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8327364921569824  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1686853, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.657881259918213  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.5140013694763184  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1199445, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.657881259918213  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9438514709472656  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1199445
output nodes number: 423273
edges number: 9828880
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.955942153930664  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1199445, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.243624210357666  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.839959621429443  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([423273, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.243624210357666  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.344540596008301  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 423273
output nodes number: 82852
edges number: 2339251
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.348311901092529  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([423273, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.603400707244873  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.524386882781982  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([82852, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.603400707244873  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.623154163360596  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.634481906890869  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.632968902587891  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6230, 47])
input nodes number: 82852
output nodes number: 6230
edges number: 245178
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.63394832611084  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.633948802947998  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.1345934867858887  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 25 input nodes size: 1819962
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6324763298034668  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6324763298034668  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3104653358459473  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3105125427246094  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6820640563964844  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8617916107177734  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8617916107177734  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1819962
first layer output nodes number: 1292699
edges number: 12395703
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8849830627441406  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1819962, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9293508529663086  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.6965370178222656  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1292699, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9293508529663086  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.237554550170898  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1292699
output nodes number: 402287
edges number: 9290620
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.250183582305908  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1292699, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.473598003387451  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.08994722366333  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([402287, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.473598003387451  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.5695109367370605  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 402287
output nodes number: 78123
edges number: 2189520
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.573090553283691  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([402287, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.813498497009277  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.738994598388672  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([78123, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.813498497009277  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.832124710083008  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.842559337615967  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.841403961181641  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6291, 47])
input nodes number: 78123
output nodes number: 6291
edges number: 246649
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.841675758361816  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.841676235198975  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.182548999786377  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 26 input nodes size: 1662350
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.681706428527832  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.681706428527832  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3009800910949707  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.301025390625  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6229891777038574  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7756304740905762  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7756304740905762  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1662350
first layer output nodes number: 1074069
edges number: 10288154
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7960190773010254  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1662350, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.325420379638672  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.3011083602905273  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1074069, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.325420379638672  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.581498622894287  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1074069
output nodes number: 340219
edges number: 7730497
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.592740535736084  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1074069, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.626817226409912  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.302359104156494  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([340219, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.626817226409912  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.707931995391846  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 340219
output nodes number: 75008
edges number: 2066027
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.711025714874268  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([340219, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.941577911376953  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.870044708251953  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([75008, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.941577911376953  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.959953784942627  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.9704976081848145  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.969100475311279  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6061, 47])
input nodes number: 75008
output nodes number: 6061
edges number: 237378
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.969610691070557  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.969611167907715  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.0489721298217773  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 27 input nodes size: 1659967
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6228952407836914  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6228952407836914  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.241281509399414  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2413263320922852  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6220073699951172  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7806529998779297  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7806529998779297  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1659967
first layer output nodes number: 1121111
edges number: 10824613
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8013739585876465  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1659967, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.442196846008301  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.3730220794677734  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1121111, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.442196846008301  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7094907760620117  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1121111
output nodes number: 349497
edges number: 8132271
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7204813957214355  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1121111, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.783844947814941  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.450538635253906  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([349497, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.783844947814941  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.867171764373779  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 349497
output nodes number: 70210
edges number: 1974232
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.870520114898682  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([349497, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.086625576019287  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.019668102264404  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([70210, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.086625576019287  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.103364944458008  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.113404750823975  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.111969947814941  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6007, 47])
input nodes number: 70210
output nodes number: 6007
edges number: 238729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.1125288009643555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.112529277801514  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.0634689331054688  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 28 input nodes size: 1717474
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6219978332519531  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6219978332519531  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2618069648742676  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2618541717529297  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6434230804443359  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8437013626098633  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8437013626098633  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1717474
first layer output nodes number: 1246448
edges number: 11942172
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8657846450805664  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1717474, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.801283836364746  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.6125783920288086  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1246448, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.801283836364746  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.0984601974487305  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1246448
output nodes number: 512594
edges number: 11817150
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.112206935882568  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1246448, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.670614719390869  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.181766986846924  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([512594, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.670614719390869  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.7928266525268555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 512594
output nodes number: 101825
edges number: 2871611
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.797405242919922  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([512594, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.110883712768555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.013775825500488  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([101825, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.110883712768555  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.13516092300415  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.146095275878906  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.144209861755371  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6326, 47])
input nodes number: 101825
output nodes number: 6326
edges number: 249648
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.145849704742432  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.14585018157959  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2117209434509277  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 29 input nodes size: 1803106
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.644256591796875  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.644256591796875  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3159661293029785  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.3160109519958496  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.676154613494873  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8737378120422363  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8737378120422363  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1803106
first layer output nodes number: 1309839
edges number: 12558548
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.8969316482543945  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1803106, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9818859100341797  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.7327260971069336  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1309839, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.9818859100341797  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.29417610168457  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1309839
output nodes number: 485408
edges number: 11234764
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.308505535125732  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1309839, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.7852630615234375  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.3223419189453125  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([485408, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.7852630615234375  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.900993347167969  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 485408
output nodes number: 88853
edges number: 2490894
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.905272960662842  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([485408, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.17870569229126  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.093968868255615  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([88853, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.17870569229126  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.19989013671875  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.20983362197876  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.2084150314331055  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([5963, 47])
input nodes number: 88853
output nodes number: 5963
edges number: 234692
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.208622932434082  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.20862340927124  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2318634986877441  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 30 input nodes size: 1504012
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6756553649902344  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6756553649902344  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2359437942504883  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.2359905242919922  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.5642361640930176  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6968493461608887  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.6968493461608887  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1504012
first layer output nodes number: 932892
edges number: 9026047
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7150063514709473  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1504012, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.9126200675964355  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.022944927215576  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([932892, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.9126200675964355  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.1350388526916504  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 932892
output nodes number: 281516
edges number: 6430179
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.144087314605713  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([932892, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.999843120574951  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.7313685417175293  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([281516, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 3.999843120574951  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.066961765289307  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 281516
output nodes number: 73078
edges number: 2024553
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.06960391998291  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([281516, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.294310569763184  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.224617958068848  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([73078, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.294310569763184  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.311733722686768  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.322017669677734  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.3206305503845215  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6219, 47])
input nodes number: 73078
output nodes number: 6219
edges number: 245532
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.32122278213501  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.321223258972168  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.9346656799316406  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

pseudo mini batch 31 input nodes size: 1869459
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.564237117767334  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.564237117767334  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.260664939880371  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.260711669921875  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.7003765106201172  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.9239721298217773  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.9239721298217773  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

first layer input nodes number: 1869459
first layer output nodes number: 1408040
edges number: 13424410
----------------------------------------before model layer 0
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 0.9483919143676758  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1869459, 100])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.264173984527588  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 2.9213624000549316  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1408040, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.264173984527588  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.599876880645752  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 1408040
output nodes number: 573440
edges number: 13260672
----------------------------------------before model layer 1
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 4.614640235900879  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([1408040, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.358337879180908  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 5.811462879180908  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([573440, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.358337879180908  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.495056629180908  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

input nodes number: 573440
output nodes number: 108340
edges number: 3082220
----------------------------------------before model layer 2
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.5010199546813965  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([573440, 256])
----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.834991931915283  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.73167085647583  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([108340, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.834991931915283  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.8608222007751465  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.871347904205322  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.869708061218262  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

torch.Size([6226, 47])
input nodes number: 108340
output nodes number: 6226
edges number: 242975
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.870814800262451  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 6.870815277099609  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8201904296875 GB
    Memory Allocated: 1.333585262298584  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.8221435546875 GB
    Memory Allocated: 1.3360991477966309  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.8221435546875 GB
    Memory Allocated: 1.3360991477966309  GigaBytes
Max Memory Allocated: 8.457416534423828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.21925805509090424 |0.1433405727148056 |0.1217154860496521 |0.00010122358798980713 |0.02266918122768402 |0.004904508590698242 |
----------------------------------------------------------pseudo_mini_loss sum 11.026467323303223
Total (block generation + training)time/epoch 1038.017739057541
* Pure training time/epoch 16.231609106063843
Training time/epoch 16.47594714164734
Training time without block to device /epoch 11.88904881477356
Training time without total dataloading part /epoch 4.628453016281128
load block tensor time/epoch 7.0162577629089355
block to device time/epoch 4.586898326873779
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  107711926
Number of first layer input nodes during this epoch:  55370357
Number of first layer output nodes during this epoch:  37549484
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  337408
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([47, 256])
layers.3.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
