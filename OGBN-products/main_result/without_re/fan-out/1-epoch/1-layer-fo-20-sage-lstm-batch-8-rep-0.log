main start at this time 1656028801.5539954
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.13747763633728027
global_2_local spend time (sec) 0.34999966621398926
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.019870281219482422
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 922590, 20: 186421, 14: 695, 15: 673, 7: 655, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 19: 584, 12: 583, 9: 576, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.06262397766113281
auxiliary_graph
Graph(num_nodes=1119161, num_edges=36530005,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5450398921966553
remove nodes length  922590

auxiliary_graph.remove_nodes spent  2.1891963481903076
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=36530005,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4771735668182373

the counter of shared neighbor distribution
Counter({1.0: 31135406, 2.0: 3552592, 3.0: 936932, 4.0: 353502, 5.0: 159904, 6.0: 75186, 7.0: 40668, 8.0: 21746, 9.0: 14870, 10.0: 9568, 11.0: 6274, 12.0: 4756, 15.0: 4752, 14.0: 4072, 13.0: 3450, 18.0: 2810, 16.0: 2680, 17.0: 1584, 19.0: 1406, 20.0: 1276})
36333434
Convert a graph into a bidirected graph: 1.948 seconds
Metis partitioning: 8.588 seconds
Split the graph: 1.183 seconds
Construct subgraphs: 0.311 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.045154333114624
25143
25279
25215
23862
25272
24030
23906
23864
total k batches seeds list generation spend  23.479250192642212
after graph partition
graph partition algorithm spend time 23.97789216041565
25143
25279
25215
23862
25272
24030
23906
23864
partition_len_list
[144508, 177101, 165589, 179251, 200154, 192035, 163525, 196395]
REG selection method  spend 24.556771516799927
time for parepare:  0.23101282119750977
local_output_nid generation:  0.0058019161224365234
local_in_edges_tensor generation:  0.0068492889404296875
mini_batch_src_global generation:  0.015382051467895508
r_  generation:  0.1639254093170166
local_output_nid generation:  0.006734371185302734
local_in_edges_tensor generation:  0.008341789245605469
mini_batch_src_global generation:  0.020299434661865234
r_  generation:  0.20378875732421875
local_output_nid generation:  0.006765127182006836
local_in_edges_tensor generation:  0.009345054626464844
mini_batch_src_global generation:  0.017319440841674805
r_  generation:  0.19811677932739258
local_output_nid generation:  0.006589651107788086
local_in_edges_tensor generation:  0.006472587585449219
mini_batch_src_global generation:  0.01698613166809082
r_  generation:  0.21105217933654785
local_output_nid generation:  0.006777048110961914
local_in_edges_tensor generation:  0.006852149963378906
mini_batch_src_global generation:  0.021331787109375
r_  generation:  0.24173521995544434
local_output_nid generation:  0.006718873977661133
local_in_edges_tensor generation:  0.006550312042236328
mini_batch_src_global generation:  0.020319223403930664
r_  generation:  0.2325589656829834
local_output_nid generation:  0.006642818450927734
local_in_edges_tensor generation:  0.006530046463012695
mini_batch_src_global generation:  0.020113706588745117
r_  generation:  0.2066648006439209
local_output_nid generation:  0.006733417510986328
local_in_edges_tensor generation:  0.006470680236816406
mini_batch_src_global generation:  0.020439863204956055
r_  generation:  0.21843481063842773
----------------------check_connections_block total spend ----------------------------- 2.51965069770813
generate_one_block  1.669527530670166
generate_one_block  0.2763690948486328
generate_one_block  0.2574300765991211
generate_one_block  0.2435152530670166
generate_one_block  0.2617340087890625
generate_one_block  0.2608046531677246
generate_one_block  0.2607147693634033
generate_one_block  0.2459423542022705
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  2.51965069770813
block generation total time  3.4760377407073975
average batch blocks generation time:  0.4345047175884247
block dataloader generation time/epoch 30.93078351020813
pseudo mini batch 0 input nodes size: 144508
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0721435546875 GB
    Memory Allocated: 0.05502510070800781  GigaBytes
Max Memory Allocated: 0.05502510070800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0721435546875 GB
    Memory Allocated: 0.05521249771118164  GigaBytes
Max Memory Allocated: 0.05521249771118164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0721435546875 GB
    Memory Allocated: 0.05521249771118164  GigaBytes
Max Memory Allocated: 0.05521249771118164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.058832645416259766  GigaBytes
Max Memory Allocated: 0.058832645416259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.058832645416259766  GigaBytes
Max Memory Allocated: 0.058832645416259766  GigaBytes

torch.Size([25143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 2.8487343788146973  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 2.853137969970703  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.06728792190551758  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

pseudo mini batch 1 input nodes size: 177101
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.05995368957519531  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.05995368957519531  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.1259293556213379  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.12611770629882812  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.0712428092956543  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.07503080368041992  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 0.07503080368041992  GigaBytes
Max Memory Allocated: 3.1953887939453125  GigaBytes

torch.Size([25279, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.9307680130004883  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.935194969177246  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07902097702026367  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

pseudo mini batch 2 input nodes size: 165589
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07126665115356445  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07126665115356445  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.13295364379882812  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.06697750091552734  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07071208953857422  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07071208953857422  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

torch.Size([25215, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.864954948425293  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.869381904602051  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.0751047134399414  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

pseudo mini batch 3 input nodes size: 179251
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.06696605682373047  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.06696605682373047  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.1337423324584961  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.13392019271850586  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07204532623291016  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07551956176757812  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07551956176757812  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

torch.Size([23862, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.724691390991211  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 2.729106903076172  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07889556884765625  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

pseudo mini batch 4 input nodes size: 200154
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07185792922973633  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07185792922973633  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.1464214324951172  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.14660978317260742  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.07965564727783203  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.08340644836425781  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8221435546875 GB
    Memory Allocated: 0.08340644836425781  GigaBytes
Max Memory Allocated: 3.298996925354004  GigaBytes

torch.Size([25272, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 2.960785388946533  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 2.9652109146118164  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.08749628067016602  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

pseudo mini batch 5 input nodes size: 192035
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.07985305786132812  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.07985305786132812  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.15139198303222656  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.15157127380371094  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.07681941986083984  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.0803842544555664  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.0803842544555664  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

torch.Size([24030, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 2.7985668182373047  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 2.802992343902588  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.08416557312011719  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

pseudo mini batch 6 input nodes size: 163525
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.07660198211669922  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.07660198211669922  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.13751983642578125  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.13769817352294922  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.0659799575805664  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.06943035125732422  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8397216796875 GB
    Memory Allocated: 0.06943035125732422  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

torch.Size([23906, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 2.7005300521850586  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 2.704738140106201  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.07294797897338867  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

pseudo mini batch 7 input nodes size: 196395
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.06595802307128906  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.06595802307128906  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.13912105560302734  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.1392989158630371  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.07820272445678711  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.08156442642211914  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8631591796875 GB
    Memory Allocated: 0.08156442642211914  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

torch.Size([23864, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8905029296875 GB
    Memory Allocated: 2.647429943084717  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8905029296875 GB
    Memory Allocated: 2.651616096496582  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8905029296875 GB
    Memory Allocated: 0.0855097770690918  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.8905029296875 GB
    Memory Allocated: 0.08618497848510742  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.8905029296875 GB
    Memory Allocated: 0.08618497848510742  GigaBytes
Max Memory Allocated: 3.3315677642822266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06042090058326721 |0.0444122850894928 |0.10250979661941528 |0.00014284253120422363 |0.051553547382354736 |0.003331899642944336 |
----------------------------------------------------------pseudo_mini_loss sum 4.791061878204346
Total (block generation + training)time/epoch 33.038968563079834
Training time/epoch 2.1079530715942383
Training time without block to device /epoch 1.752654790878296
Training time without total dataloading part /epoch 1.2369813919067383
load block tensor time/epoch 0.4833672046661377
block to device time/epoch 0.3552982807159424
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1418558
Number of first layer input nodes during this epoch:  1418558
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
