main start at this time 1656028859.5080783
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 0.19571685791015625
global_2_local spend time (sec) 0.368466854095459
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.020474672317504883
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 922590, 20: 186421, 14: 695, 15: 673, 7: 655, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 19: 584, 12: 583, 9: 576, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.06369233131408691
auxiliary_graph
Graph(num_nodes=1119161, num_edges=36530005,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5402946472167969
remove nodes length  922590

auxiliary_graph.remove_nodes spent  2.188826322555542
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=36530005,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4677371978759766

the counter of shared neighbor distribution
Counter({1.0: 31135406, 2.0: 3552592, 3.0: 936932, 4.0: 353502, 5.0: 159904, 6.0: 75186, 7.0: 40668, 8.0: 21746, 9.0: 14870, 10.0: 9568, 11.0: 6274, 12.0: 4756, 15.0: 4752, 14.0: 4072, 13.0: 3450, 18.0: 2810, 16.0: 2680, 17.0: 1584, 19.0: 1406, 20.0: 1276})
36333434
Convert a graph into a bidirected graph: 2.081 seconds
Metis partitioning: 9.552 seconds
Split the graph: 0.835 seconds
Construct subgraphs: 0.320 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  12.803303956985474
12090
12653
12654
12438
12615
11958
12615
12432
12630
12138
11967
12627
11938
11928
11955
11933
total k batches seeds list generation spend  24.192833185195923
after graph partition
graph partition algorithm spend time 24.665645599365234
12090
12653
12654
12438
12615
11958
12615
12432
12630
12138
11967
12627
11938
11928
11955
11933
partition_len_list
[103435, 93973, 74587, 82057, 100072, 83033, 94547, 92481, 100705, 101665, 103889, 103138, 76235, 103359, 95341, 99035]
REG selection method  spend 25.27677822113037
time for parepare:  0.23253178596496582
local_output_nid generation:  0.004040718078613281
local_in_edges_tensor generation:  0.004207611083984375
mini_batch_src_global generation:  0.009575843811035156
r_  generation:  0.08884525299072266
local_output_nid generation:  0.005487680435180664
local_in_edges_tensor generation:  0.004289388656616211
mini_batch_src_global generation:  0.012653112411499023
r_  generation:  0.098968505859375
local_output_nid generation:  0.005426645278930664
local_in_edges_tensor generation:  0.0041961669921875
mini_batch_src_global generation:  0.009376764297485352
r_  generation:  0.09343338012695312
local_output_nid generation:  0.005433320999145508
local_in_edges_tensor generation:  0.004122018814086914
mini_batch_src_global generation:  0.015295743942260742
r_  generation:  0.09193873405456543
local_output_nid generation:  0.0067555904388427734
local_in_edges_tensor generation:  0.004172086715698242
mini_batch_src_global generation:  0.009378194808959961
r_  generation:  0.10791921615600586
local_output_nid generation:  0.0052983760833740234
local_in_edges_tensor generation:  0.0041463375091552734
mini_batch_src_global generation:  0.009758710861206055
r_  generation:  0.09519100189208984
local_output_nid generation:  0.0055828094482421875
local_in_edges_tensor generation:  0.004408597946166992
mini_batch_src_global generation:  0.009753227233886719
r_  generation:  0.11030960083007812
local_output_nid generation:  0.005407571792602539
local_in_edges_tensor generation:  0.005076885223388672
mini_batch_src_global generation:  0.010882139205932617
r_  generation:  0.10846400260925293
local_output_nid generation:  0.007181882858276367
local_in_edges_tensor generation:  0.004360675811767578
mini_batch_src_global generation:  0.010385513305664062
r_  generation:  0.11169075965881348
local_output_nid generation:  0.005403757095336914
local_in_edges_tensor generation:  0.004220008850097656
mini_batch_src_global generation:  0.010871648788452148
r_  generation:  0.10951018333435059
local_output_nid generation:  0.005368471145629883
local_in_edges_tensor generation:  0.004025936126708984
mini_batch_src_global generation:  0.010305166244506836
r_  generation:  0.11051750183105469
local_output_nid generation:  0.005532264709472656
local_in_edges_tensor generation:  0.004216909408569336
mini_batch_src_global generation:  0.01193690299987793
r_  generation:  0.11658620834350586
local_output_nid generation:  0.005263328552246094
local_in_edges_tensor generation:  0.004077911376953125
mini_batch_src_global generation:  0.010495424270629883
r_  generation:  0.09799575805664062
local_output_nid generation:  0.00546574592590332
local_in_edges_tensor generation:  0.004024505615234375
mini_batch_src_global generation:  0.011019706726074219
r_  generation:  0.12313604354858398
local_output_nid generation:  0.005336284637451172
local_in_edges_tensor generation:  0.0042040348052978516
mini_batch_src_global generation:  0.022715330123901367
r_  generation:  0.10436582565307617
local_output_nid generation:  0.005190372467041016
local_in_edges_tensor generation:  0.0039250850677490234
mini_batch_src_global generation:  0.009823083877563477
r_  generation:  0.10529208183288574
----------------------check_connections_block total spend ----------------------------- 2.638267755508423
generate_one_block  1.543264627456665
generate_one_block  0.12728142738342285
generate_one_block  0.11814475059509277
generate_one_block  0.1328134536743164
generate_one_block  0.12589454650878906
generate_one_block  0.11622762680053711
generate_one_block  0.12475156784057617
generate_one_block  0.12432193756103516
generate_one_block  0.1294083595275879
generate_one_block  0.12627196311950684
generate_one_block  0.12398099899291992
generate_one_block  0.18050217628479004
generate_one_block  0.11403632164001465
generate_one_block  0.12159061431884766
generate_one_block  0.12253975868225098
generate_one_block  0.1367943286895752
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  2.638267755508423
block generation total time  3.4678244590759277
average batch blocks generation time:  0.21673902869224548
block dataloader generation time/epoch 31.85129427909851
pseudo mini batch 0 input nodes size: 103435
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0565185546875 GB
    Memory Allocated: 0.03940010070800781  GigaBytes
Max Memory Allocated: 0.03940010070800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0565185546875 GB
    Memory Allocated: 0.0394902229309082  GigaBytes
Max Memory Allocated: 0.0394902229309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0565185546875 GB
    Memory Allocated: 0.0394902229309082  GigaBytes
Max Memory Allocated: 0.0394902229309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.04128122329711914  GigaBytes
Max Memory Allocated: 0.04128122329711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1229248046875 GB
    Memory Allocated: 0.04128122329711914  GigaBytes
Max Memory Allocated: 0.04128122329711914  GigaBytes

torch.Size([12090, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.4089007377624512  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 1.4112887382507324  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.04557323455810547  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

pseudo mini batch 1 input nodes size: 93973
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.0419459342956543  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.0419459342956543  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.07695388793945312  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.07704830169677734  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.03789567947387695  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.0397639274597168  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.0397639274597168  GigaBytes
Max Memory Allocated: 1.5836572647094727  GigaBytes

torch.Size([12653, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4642086029052734  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 1.4664249420166016  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.04206037521362305  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 2 input nodes size: 74587
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03827667236328125  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.03827667236328125  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.06606292724609375  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.06615734100341797  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.031054973602294922  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.032862186431884766  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1893310546875 GB
    Memory Allocated: 0.032862186431884766  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12654, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4111356735229492  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4135279655456543  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03461027145385742  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 3 input nodes size: 82057
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.030948638916015625  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.030948638916015625  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.06151771545410156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.06161069869995117  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03373003005981445  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0355372428894043  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0355372428894043  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12438, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4135079383850098  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4156866073608398  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03717756271362305  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 4 input nodes size: 100072
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03351640701293945  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03351640701293945  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07079648971557617  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07089090347290039  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.040228843688964844  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04206657409667969  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04206657409667969  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12615, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4436359405517578  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.446126937866211  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.043982505798339844  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 5 input nodes size: 83033
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04025983810424805  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04025983810424805  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07119226455688477  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07128143310546875  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03390693664550781  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03563880920410156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03563880920410156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([11958, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.3570680618286133  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.3598628044128418  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03773927688598633  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 6 input nodes size: 94547
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.034230709075927734  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.034230709075927734  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.06945228576660156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.06954669952392578  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03852510452270508  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04035520553588867  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04035520553588867  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12615, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4351348876953125  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4376258850097656  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04190874099731445  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 7 input nodes size: 92481
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.038201332092285156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.038201332092285156  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07265329360961914  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07274627685546875  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0374302864074707  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0392460823059082  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0392460823059082  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12432, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4237627983093262  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.426218032836914  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0410761833190918  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

pseudo mini batch 8 input nodes size: 100705
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03739786148071289  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03739786148071289  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07491350173950195  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07500791549682617  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04046297073364258  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04233121871948242  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04233121871948242  GigaBytes
Max Memory Allocated: 1.647878646850586  GigaBytes

torch.Size([12630, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.467421054840088  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4696331024169922  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0442814826965332  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

pseudo mini batch 9 input nodes size: 101665
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.040497779846191406  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.040497779846191406  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07837104797363281  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0784616470336914  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.040851593017578125  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

torch.Size([12138, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4110536575317383  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.4131793975830078  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04439830780029297  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

pseudo mini batch 10 input nodes size: 103889
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04076528549194336  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04076528549194336  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.0794672966003418  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07955646514892578  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04159259796142578  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04336833953857422  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04336833953857422  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

torch.Size([11967, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.3971753120422363  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.3992714881896973  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.045426368713378906  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

pseudo mini batch 11 input nodes size: 103138
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04183006286621094  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04183006286621094  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.08089256286621094  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.08098697662353516  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.042195796966552734  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04407072067260742  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04407072067260742  GigaBytes
Max Memory Allocated: 1.6510300636291504  GigaBytes

torch.Size([12627, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.5359869003295898  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 1.538198471069336  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.04636383056640625  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

pseudo mini batch 12 input nodes size: 76235
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.042566776275634766  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.042566776275634766  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07096672058105469  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.07105588912963867  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03189897537231445  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03361082077026367  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2440185546875 GB
    Memory Allocated: 0.03361082077026367  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

torch.Size([11938, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3393750190734863  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.342109203338623  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.03526782989501953  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

pseudo mini batch 13 input nodes size: 103359
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.03179931640625  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.03179931640625  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.07086181640625  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.07095098495483398  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04246187210083008  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04421281814575195  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04421281814575195  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

torch.Size([11928, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.3791751861572266  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 1.381615161895752  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04581403732299805  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

pseudo mini batch 14 input nodes size: 95341
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.0422673225402832  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.0422673225402832  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.07778501510620117  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.07787418365478516  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.03872251510620117  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04039430618286133  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2576904296875 GB
    Memory Allocated: 0.04039430618286133  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

torch.Size([11955, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.3255395889282227  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.3276333808898926  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.04209327697753906  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

pseudo mini batch 15 input nodes size: 99035
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.038704872131347656  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.038704872131347656  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.07559871673583984  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.07568788528442383  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.040081024169921875  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.041767120361328125  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.041767120361328125  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

torch.Size([11933, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.3278865814208984  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.330545425415039  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.04324483871459961  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.043920040130615234  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.043920040130615234  GigaBytes
Max Memory Allocated: 1.7212657928466797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030769377946853638 |0.02191150188446045 |0.06491895020008087 |0.00013521313667297363 |0.04119528830051422 |0.0033762454986572266 |
----------------------------------------------------------pseudo_mini_loss sum 4.7910614013671875
Total (block generation + training)time/epoch 34.454116106033325
Training time/epoch 2.602548599243164
Training time without block to device /epoch 2.251964569091797
Training time without total dataloading part /epoch 1.7033674716949463
load block tensor time/epoch 0.4923100471496582
block to device time/epoch 0.3505840301513672
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1507552
Number of first layer input nodes during this epoch:  1507552
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
