main start at this time 1656302668.854342
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.2706396579742432
global_2_local spend time (sec) 0.6129772663116455
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.2897963523864746
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630649, 400: 15194, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 94: 1069, 74: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 58: 957, 100: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 123: 741, 36: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 131: 654, 139: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 195: 369, 208: 369, 196: 369, 194: 365, 198: 363, 204: 350, 203: 340, 209: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 217: 291, 212: 291, 225: 289, 222: 284, 220: 282, 223: 275, 233: 273, 226: 273, 230: 271, 227: 268, 239: 268, 238: 259, 244: 259, 249: 258, 234: 258, 237: 257, 229: 254, 240: 253, 235: 252, 246: 252, 232: 246, 236: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 2: 221, 248: 221, 252: 219, 264: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 253: 201, 258: 201, 266: 199, 260: 196, 269: 195, 273: 190, 265: 190, 270: 189, 263: 189, 278: 188, 277: 187, 262: 183, 276: 182, 261: 182, 282: 182, 256: 179, 274: 179, 285: 178, 272: 178, 271: 177, 280: 175, 299: 175, 284: 174, 1: 173, 290: 169, 291: 168, 303: 165, 295: 165, 287: 164, 279: 160, 288: 159, 315: 159, 286: 159, 298: 157, 294: 156, 300: 155, 292: 154, 283: 152, 297: 152, 302: 151, 301: 151, 289: 149, 305: 148, 275: 147, 293: 147, 306: 147, 281: 147, 312: 146, 307: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 304: 133, 309: 133, 318: 132, 320: 131, 314: 131, 308: 130, 319: 127, 332: 127, 342: 123, 326: 123, 328: 123, 323: 120, 321: 120, 322: 119, 333: 119, 317: 118, 344: 115, 351: 114, 327: 114, 340: 114, 331: 113, 324: 113, 336: 110, 325: 109, 355: 108, 349: 107, 365: 105, 341: 105, 329: 105, 353: 104, 345: 104, 330: 103, 338: 103, 339: 103, 359: 102, 357: 102, 334: 101, 381: 100, 378: 100, 362: 100, 371: 99, 383: 99, 337: 99, 348: 99, 380: 99, 356: 98, 360: 98, 350: 98, 370: 97, 354: 97, 363: 96, 343: 96, 372: 95, 385: 94, 335: 93, 347: 92, 376: 92, 352: 92, 374: 92, 375: 91, 368: 91, 361: 91, 373: 91, 366: 90, 346: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 390: 81, 386: 81, 395: 80, 398: 80, 387: 80, 392: 79, 397: 79, 389: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.4195272922515869
auxiliary_graph
Graph(num_nodes=1827220, num_edges=428466667,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8687849044799805
remove nodes length  1630649

auxiliary_graph.remove_nodes spent  24.764636039733887
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428466667,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  18.73428511619568

the counter of shared neighbor distribution
Counter({1.0: 241148736, 2.0: 65510716, 3.0: 32147020, 4.0: 19309016, 5.0: 12922570, 6.0: 9266256, 7.0: 6926008, 8.0: 5379696, 9.0: 4275856, 10.0: 3479706, 11.0: 2875592, 12.0: 2418492, 13.0: 2062668, 14.0: 1765142, 15.0: 1530056, 16.0: 1337972, 17.0: 1177270, 18.0: 1042516, 19.0: 930596, 20.0: 830446, 21.0: 744982, 22.0: 672132, 23.0: 610810, 24.0: 555532, 25.0: 508832, 26.0: 465894, 27.0: 429120, 28.0: 396970, 29.0: 367042, 30.0: 342094, 31.0: 318430, 32.0: 297234, 33.0: 278688, 34.0: 258750, 35.0: 242972, 36.0: 230320, 37.0: 216376, 38.0: 203800, 39.0: 195386, 40.0: 182544, 41.0: 171624, 42.0: 165628, 43.0: 156670, 44.0: 149000, 45.0: 141410, 46.0: 134026, 47.0: 128494, 48.0: 122582, 49.0: 119854, 50.0: 112420, 51.0: 109452, 52.0: 103624, 53.0: 98554, 54.0: 93190, 55.0: 88498, 56.0: 84828, 57.0: 81998, 58.0: 78196, 59.0: 75688, 60.0: 72220, 61.0: 69374, 62.0: 66714, 63.0: 63698, 64.0: 61034, 65.0: 58942, 67.0: 58758, 66.0: 57372, 68.0: 53426, 69.0: 51290, 70.0: 49998, 71.0: 47298, 72.0: 46254, 73.0: 44318, 74.0: 42540, 75.0: 41774, 76.0: 39520, 77.0: 38618, 78.0: 36866, 79.0: 35210, 80.0: 34394, 81.0: 33984, 82.0: 32362, 83.0: 31086, 84.0: 30700, 85.0: 30320, 86.0: 28762, 87.0: 27772, 88.0: 26684, 89.0: 25564, 90.0: 24800, 91.0: 24106, 92.0: 23584, 93.0: 22428, 94.0: 21730, 95.0: 21198, 96.0: 20770, 97.0: 20478, 98.0: 19434, 99.0: 18788, 100.0: 18436, 102.0: 17672, 101.0: 17494, 103.0: 16914, 104.0: 16130, 105.0: 15930, 106.0: 15454, 107.0: 14786, 108.0: 14404, 109.0: 14272, 110.0: 13576, 111.0: 13156, 113.0: 12820, 112.0: 12676, 114.0: 12318, 115.0: 11744, 116.0: 11422, 117.0: 11270, 118.0: 11114, 120.0: 10532, 119.0: 10392, 121.0: 10016, 122.0: 9756, 123.0: 9260, 124.0: 9220, 125.0: 8694, 126.0: 8676, 127.0: 8620, 128.0: 7870, 129.0: 7842, 130.0: 7470, 132.0: 7320, 131.0: 7288, 133.0: 7134, 135.0: 6916, 134.0: 6904, 136.0: 6512, 137.0: 6414, 138.0: 6038, 141.0: 5954, 139.0: 5834, 140.0: 5830, 142.0: 5496, 144.0: 5302, 143.0: 5264, 145.0: 5162, 146.0: 4934, 147.0: 4864, 148.0: 4666, 149.0: 4648, 150.0: 4516, 151.0: 4234, 152.0: 4074, 154.0: 4058, 153.0: 4002, 156.0: 3912, 155.0: 3864, 157.0: 3786, 158.0: 3666, 159.0: 3488, 160.0: 3460, 162.0: 3330, 161.0: 3300, 163.0: 3152, 165.0: 2998, 164.0: 2934, 166.0: 2850, 168.0: 2790, 167.0: 2740, 169.0: 2662, 171.0: 2528, 170.0: 2500, 172.0: 2426, 174.0: 2366, 173.0: 2322, 175.0: 2322, 177.0: 2140, 176.0: 2130, 178.0: 2128, 179.0: 1958, 180.0: 1950, 181.0: 1928, 182.0: 1898, 184.0: 1870, 183.0: 1828, 186.0: 1640, 185.0: 1638, 187.0: 1600, 188.0: 1510, 191.0: 1504, 189.0: 1470, 190.0: 1418, 192.0: 1386, 193.0: 1318, 194.0: 1292, 195.0: 1268, 196.0: 1192, 199.0: 1168, 197.0: 1150, 200.0: 1128, 201.0: 1086, 198.0: 1044, 203.0: 968, 202.0: 968, 205.0: 942, 204.0: 930, 206.0: 876, 207.0: 860, 208.0: 828, 211.0: 824, 210.0: 808, 209.0: 808, 213.0: 698, 212.0: 694, 214.0: 672, 217.0: 642, 215.0: 640, 218.0: 634, 216.0: 628, 219.0: 598, 220.0: 538, 221.0: 524, 223.0: 518, 222.0: 498, 224.0: 488, 227.0: 478, 229.0: 458, 225.0: 438, 228.0: 426, 226.0: 398, 230.0: 378, 234.0: 360, 231.0: 354, 233.0: 350, 235.0: 350, 236.0: 342, 232.0: 302, 238.0: 292, 239.0: 290, 242.0: 268, 237.0: 266, 241.0: 252, 243.0: 242, 244.0: 240, 240.0: 234, 245.0: 232, 246.0: 224, 249.0: 196, 248.0: 194, 247.0: 192, 250.0: 188, 253.0: 182, 251.0: 172, 252.0: 158, 257.0: 152, 258.0: 148, 254.0: 136, 255.0: 134, 263.0: 118, 260.0: 118, 259.0: 112, 256.0: 106, 262.0: 104, 266.0: 102, 261.0: 98, 265.0: 94, 268.0: 92, 264.0: 84, 272.0: 82, 285.0: 78, 267.0: 74, 276.0: 74, 269.0: 72, 270.0: 72, 277.0: 68, 274.0: 68, 284.0: 66, 286.0: 64, 283.0: 64, 287.0: 62, 282.0: 62, 275.0: 62, 292.0: 62, 278.0: 60, 273.0: 56, 271.0: 56, 280.0: 50, 294.0: 50, 289.0: 48, 291.0: 48, 279.0: 48, 288.0: 46, 281.0: 44, 298.0: 40, 297.0: 40, 290.0: 32, 293.0: 30, 295.0: 28, 302.0: 26, 301.0: 22, 296.0: 22, 299.0: 18, 300.0: 16, 307.0: 16, 306.0: 16, 305.0: 14, 303.0: 12, 311.0: 12, 308.0: 10, 310.0: 10, 304.0: 10, 309.0: 8, 325.0: 8, 312.0: 6, 319.0: 4, 315.0: 4, 313.0: 4, 318.0: 4, 331.0: 4, 327.0: 4, 343.0: 2, 333.0: 2, 348.0: 2, 321.0: 2, 323.0: 2, 332.0: 2, 316.0: 2, 352.0: 2, 317.0: 2, 322.0: 2, 335.0: 2})
428270096
Convert a graph into a bidirected graph: 36.921 seconds
Metis partitioning: 101.301 seconds
Split the graph: 12.639 seconds
Construct subgraphs: 4.752 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  155.7989637851715
16733
16622
15903
15903
16083
16227
16847
15903
16723
16030
16747
16850
total k batches seeds list generation spend  302.83275175094604
after graph partition
graph partition algorithm spend time 306.5456473827362
16733
16622
15903
15903
16083
16227
16847
15903
16723
16030
16747
16850
partition_len_list
[352217, 292535, 372038, 391884, 268720, 403667, 295227, 311436, 294062, 165538, 235084, 269916]
REG selection method  spend 307.5156419277191
time for parepare:  0.40922021865844727
local_output_nid generation:  0.005380153656005859
local_in_edges_tensor generation:  0.017194032669067383
mini_batch_src_global generation:  0.06852197647094727
r_  generation:  0.6663117408752441
local_output_nid generation:  0.005342960357666016
local_in_edges_tensor generation:  0.0261995792388916
mini_batch_src_global generation:  0.07648634910583496
r_  generation:  0.5888328552246094
local_output_nid generation:  0.0053212642669677734
local_in_edges_tensor generation:  0.05596017837524414
mini_batch_src_global generation:  0.11142611503601074
r_  generation:  0.9905025959014893
local_output_nid generation:  0.006592988967895508
local_in_edges_tensor generation:  0.07896065711975098
mini_batch_src_global generation:  0.11438798904418945
r_  generation:  0.95284104347229
local_output_nid generation:  0.005311012268066406
local_in_edges_tensor generation:  0.0811316967010498
mini_batch_src_global generation:  0.11212778091430664
r_  generation:  0.8930990695953369
local_output_nid generation:  0.008481979370117188
local_in_edges_tensor generation:  0.06043291091918945
mini_batch_src_global generation:  0.10044145584106445
r_  generation:  0.8718516826629639
local_output_nid generation:  0.00550532341003418
local_in_edges_tensor generation:  0.07234978675842285
mini_batch_src_global generation:  0.11077284812927246
r_  generation:  0.8922884464263916
local_output_nid generation:  0.005259513854980469
local_in_edges_tensor generation:  0.03618001937866211
mini_batch_src_global generation:  0.08872628211975098
r_  generation:  0.6917462348937988
local_output_nid generation:  0.005455732345581055
local_in_edges_tensor generation:  0.03477025032043457
mini_batch_src_global generation:  0.12112832069396973
r_  generation:  0.9836044311523438
local_output_nid generation:  0.005388021469116211
local_in_edges_tensor generation:  0.03540635108947754
mini_batch_src_global generation:  0.09676718711853027
r_  generation:  0.6569464206695557
local_output_nid generation:  0.005560398101806641
local_in_edges_tensor generation:  0.046625614166259766
mini_batch_src_global generation:  0.09097814559936523
r_  generation:  0.7192609310150146
local_output_nid generation:  0.006705760955810547
local_in_edges_tensor generation:  0.0466306209564209
mini_batch_src_global generation:  0.08448910713195801
r_  generation:  0.7324132919311523
----------------------check_connections_block total spend ----------------------------- 13.649373054504395
generate_one_block  3.529247760772705
generate_one_block  0.8217973709106445
generate_one_block  1.3018169403076172
generate_one_block  1.1851418018341064
generate_one_block  1.2249844074249268
generate_one_block  1.1060547828674316
generate_one_block  1.2284860610961914
generate_one_block  0.8916232585906982
generate_one_block  1.3434453010559082
generate_one_block  0.8366146087646484
generate_one_block  0.9210195541381836
generate_one_block  0.9133603572845459
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  13.649373054504395
block generation total time  15.303592205047607
average batch blocks generation time:  1.275299350420634
block dataloader generation time/epoch 339.3505873680115
pseudo mini batch 0 input nodes size: 352217
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.13154888153076172  GigaBytes
Max Memory Allocated: 0.13154888153076172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.13167381286621094  GigaBytes
Max Memory Allocated: 0.13167381286621094  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1502685546875 GB
    Memory Allocated: 0.13167381286621094  GigaBytes
Max Memory Allocated: 0.13167381286621094  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.14724445343017578  GigaBytes
Max Memory Allocated: 0.14724445343017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2342529296875 GB
    Memory Allocated: 0.14724445343017578  GigaBytes
Max Memory Allocated: 0.14724445343017578  GigaBytes

torch.Size([16733, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 11.967392921447754  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 11.970697402954102  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.16614627838134766  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

pseudo mini batch 1 input nodes size: 292535
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.13494253158569336  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.13494253158569336  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.24392032623291016  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.24404430389404297  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.11270809173583984  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.12662792205810547  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.12662792205810547  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

torch.Size([16622, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 10.767992973327637  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 10.770923614501953  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.14059019088745117  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

pseudo mini batch 2 input nodes size: 372038
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.11268854141235352  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.11268854141235352  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.2512836456298828  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.2514023780822754  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.14230060577392578  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.16417598724365234  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.6912841796875 GB
    Memory Allocated: 0.16417598724365234  GigaBytes
Max Memory Allocated: 12.901928901672363  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 16.738491535186768  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 16.741276741027832  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.18634033203125  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 3 input nodes size: 391884
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.14252996444702148  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.14252996444702148  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.28851842880249023  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.2886371612548828  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.14992332458496094  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.16967296600341797  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.16967296600341797  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 15.128437042236328  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 15.131577491760254  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.18912696838378906  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 4 input nodes size: 268720
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1495680809020996  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1495680809020996  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.24967432022094727  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.24979448318481445  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.10368728637695312  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.12391853332519531  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.12391853332519531  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([16083, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 15.445647239685059  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 15.448822975158691  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1442413330078125  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 5 input nodes size: 403667
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.10371875762939453  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.10371875762939453  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.25409650802612305  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.25421762466430664  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1539912223815918  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.17244672775268555  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.17244672775268555  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([16227, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 14.237912654876709  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 14.241117000579834  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.19098806381225586  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 6 input nodes size: 295227
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.15401649475097656  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.15401649475097656  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.26399755477905273  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.26412343978881836  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.11362457275390625  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.13460350036621094  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.13460350036621094  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([16847, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 16.087226390838623  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 16.090552806854248  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.15575408935546875  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 7 input nodes size: 311436
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.11373329162597656  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.11373329162597656  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.2297525405883789  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.22987127304077148  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.11976432800292969  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1353893280029297  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1353893280029297  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 11.850022792816162  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 11.852807998657227  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1506519317626953  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

pseudo mini batch 8 input nodes size: 294062
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1195988655090332  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.1195988655090332  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.22914552688598633  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.22927045822143555  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.11313247680664062  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.13575172424316406  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5643310546875 GB
    Memory Allocated: 0.13575172424316406  GigaBytes
Max Memory Allocated: 18.10221004486084  GigaBytes

torch.Size([16723, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 17.256279945373535  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 17.259582042694092  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.15857696533203125  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 9 input nodes size: 165538
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.11327600479125977  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.11327600479125977  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1749439239501953  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1750636100769043  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.06539201736450195  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16030, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.937216758728027  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.94038200378418  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09658098220825195  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 10 input nodes size: 235084
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.06527090072631836  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.06527090072631836  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1528468132019043  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.15297174453735352  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09118413925170898  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10744142532348633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10744142532348633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16747, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.483269691467285  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.486202716827393  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1238865852355957  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 11 input nodes size: 269916
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.0913095474243164  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.0913095474243164  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.19186115264892578  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1919870376586914  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10428619384765625  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1198587417602539  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1198587417602539  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16850, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.949146270751953  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.952097415924072  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1359410285949707  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13661623001098633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13661623001098633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1305854320526123 |0.05717597405115763 |5.96682475010554 |0.00020490090052286783 |11.046615044275919 |0.07899594306945801 |
----------------------------------------------------------pseudo_mini_loss sum 4.793654918670654
Total (block generation + training)time/epoch 546.7666006088257
Training time/epoch 207.41569471359253
Training time without block to device /epoch 206.72958302497864
Training time without total dataloading part /epoch 204.24273228645325
load block tensor time/epoch 1.5670251846313477
block to device time/epoch 0.6861116886138916
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3652324
Number of first layer input nodes during this epoch:  3652324
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13661575317382812  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.5317108631134033
global_2_local spend time (sec) 0.8848273754119873
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.3496537208557129
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630616, 400: 15194, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 94: 1069, 74: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 62: 959, 52: 959, 48: 958, 58: 957, 100: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 15: 673, 145: 673, 25: 671, 26: 659, 7: 655, 131: 654, 139: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 208: 369, 195: 369, 196: 369, 194: 365, 198: 363, 204: 350, 209: 340, 203: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 217: 291, 212: 291, 225: 289, 222: 284, 220: 282, 223: 275, 233: 273, 226: 273, 230: 271, 239: 268, 227: 268, 238: 259, 244: 259, 234: 258, 249: 258, 237: 257, 229: 254, 240: 253, 246: 252, 235: 252, 236: 246, 232: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 248: 221, 2: 221, 252: 219, 264: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 253: 201, 258: 201, 266: 199, 260: 196, 269: 195, 273: 190, 265: 190, 263: 189, 270: 189, 278: 188, 277: 187, 262: 183, 261: 182, 276: 182, 282: 182, 274: 179, 256: 179, 272: 178, 285: 178, 271: 177, 299: 175, 280: 175, 284: 174, 1: 173, 290: 169, 291: 168, 295: 165, 303: 165, 287: 164, 279: 160, 315: 159, 286: 159, 288: 159, 298: 157, 294: 156, 300: 155, 292: 154, 283: 152, 297: 152, 301: 151, 302: 151, 289: 149, 305: 148, 275: 147, 293: 147, 281: 147, 306: 147, 312: 146, 307: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 309: 133, 304: 133, 318: 132, 314: 131, 320: 131, 308: 130, 332: 127, 319: 127, 342: 123, 326: 123, 328: 123, 321: 120, 323: 120, 322: 119, 333: 119, 317: 118, 344: 115, 327: 114, 351: 114, 340: 114, 324: 113, 331: 113, 336: 110, 325: 109, 355: 108, 349: 107, 341: 105, 329: 105, 365: 105, 345: 104, 353: 104, 330: 103, 339: 103, 338: 103, 357: 102, 359: 102, 334: 101, 362: 100, 381: 100, 378: 100, 371: 99, 337: 99, 383: 99, 348: 99, 380: 99, 360: 98, 356: 98, 350: 98, 354: 97, 370: 97, 363: 96, 343: 96, 372: 95, 385: 94, 335: 93, 374: 92, 376: 92, 352: 92, 347: 92, 373: 91, 375: 91, 361: 91, 368: 91, 366: 90, 346: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 386: 81, 390: 81, 395: 80, 387: 80, 398: 80, 389: 79, 392: 79, 397: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.44553375244140625
auxiliary_graph
Graph(num_nodes=1827187, num_edges=428551863,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8136947154998779
remove nodes length  1630616

auxiliary_graph.remove_nodes spent  21.217397689819336
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428551863,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  17.606877326965332

the counter of shared neighbor distribution
Counter({1.0: 241191798, 2.0: 65536026, 3.0: 32161526, 4.0: 19315108, 5.0: 12921814, 6.0: 9265714, 7.0: 6926666, 8.0: 5381070, 9.0: 4279224, 10.0: 3476568, 11.0: 2874050, 12.0: 2416126, 13.0: 2060026, 14.0: 1765656, 15.0: 1531436, 16.0: 1337702, 17.0: 1177634, 18.0: 1042356, 19.0: 930434, 20.0: 830464, 21.0: 746252, 22.0: 672180, 23.0: 611294, 24.0: 555946, 25.0: 509064, 26.0: 465658, 27.0: 430062, 28.0: 397856, 29.0: 367100, 30.0: 341192, 31.0: 317272, 32.0: 296456, 33.0: 278600, 34.0: 260054, 35.0: 243042, 36.0: 229080, 37.0: 215420, 38.0: 203666, 39.0: 195270, 40.0: 183246, 41.0: 171912, 42.0: 165110, 43.0: 156402, 44.0: 149644, 45.0: 141566, 46.0: 134734, 47.0: 127904, 48.0: 122712, 49.0: 120042, 50.0: 112778, 51.0: 109466, 52.0: 103648, 53.0: 98006, 54.0: 92682, 55.0: 88668, 56.0: 85280, 57.0: 81790, 58.0: 78694, 59.0: 75250, 60.0: 72210, 61.0: 69158, 62.0: 66136, 63.0: 63822, 64.0: 60664, 65.0: 59476, 67.0: 58548, 66.0: 57258, 68.0: 53450, 69.0: 51512, 70.0: 49810, 71.0: 47844, 72.0: 46218, 73.0: 44360, 74.0: 42604, 75.0: 41472, 76.0: 39610, 77.0: 39210, 78.0: 36528, 79.0: 35040, 80.0: 34084, 81.0: 33714, 82.0: 31886, 83.0: 31474, 84.0: 30584, 85.0: 30194, 86.0: 28758, 87.0: 27810, 88.0: 26820, 89.0: 25734, 90.0: 24898, 91.0: 24160, 92.0: 23606, 93.0: 22764, 94.0: 21430, 95.0: 21134, 96.0: 20702, 97.0: 20456, 98.0: 19292, 99.0: 18712, 100.0: 18490, 101.0: 17652, 102.0: 17550, 103.0: 16940, 104.0: 16116, 105.0: 15872, 106.0: 15450, 107.0: 14668, 108.0: 14460, 109.0: 13968, 110.0: 13622, 111.0: 13258, 112.0: 12900, 113.0: 12612, 114.0: 12026, 115.0: 11702, 116.0: 11562, 118.0: 11246, 117.0: 11152, 120.0: 10744, 119.0: 10516, 121.0: 9758, 122.0: 9752, 123.0: 9362, 124.0: 9126, 125.0: 9004, 126.0: 8580, 127.0: 8464, 128.0: 7830, 129.0: 7822, 130.0: 7584, 131.0: 7410, 132.0: 7288, 133.0: 7134, 135.0: 6922, 134.0: 6876, 136.0: 6436, 137.0: 6096, 138.0: 6082, 141.0: 5906, 140.0: 5836, 139.0: 5822, 142.0: 5428, 143.0: 5302, 144.0: 5194, 145.0: 5108, 146.0: 5086, 147.0: 4802, 148.0: 4756, 150.0: 4572, 149.0: 4444, 151.0: 4404, 152.0: 4200, 153.0: 4062, 154.0: 4058, 156.0: 3870, 157.0: 3810, 155.0: 3790, 158.0: 3700, 159.0: 3492, 160.0: 3470, 161.0: 3422, 162.0: 3268, 163.0: 3066, 164.0: 3012, 165.0: 2982, 166.0: 2878, 167.0: 2778, 168.0: 2728, 169.0: 2674, 172.0: 2474, 171.0: 2464, 170.0: 2462, 174.0: 2304, 173.0: 2296, 175.0: 2274, 176.0: 2222, 177.0: 2206, 178.0: 2084, 179.0: 2004, 180.0: 1958, 181.0: 1926, 182.0: 1894, 183.0: 1812, 184.0: 1748, 185.0: 1660, 186.0: 1632, 187.0: 1588, 188.0: 1538, 189.0: 1508, 191.0: 1484, 190.0: 1466, 192.0: 1434, 193.0: 1324, 194.0: 1308, 196.0: 1272, 195.0: 1244, 199.0: 1172, 198.0: 1142, 197.0: 1136, 200.0: 1104, 201.0: 1062, 203.0: 988, 204.0: 962, 206.0: 926, 202.0: 920, 205.0: 908, 207.0: 890, 208.0: 872, 209.0: 782, 210.0: 742, 212.0: 734, 211.0: 728, 213.0: 706, 216.0: 678, 214.0: 670, 217.0: 616, 215.0: 612, 218.0: 608, 219.0: 592, 221.0: 558, 223.0: 542, 220.0: 542, 222.0: 538, 224.0: 472, 225.0: 456, 229.0: 436, 228.0: 420, 226.0: 412, 227.0: 404, 234.0: 372, 236.0: 366, 230.0: 362, 232.0: 350, 231.0: 342, 235.0: 336, 233.0: 312, 241.0: 294, 238.0: 278, 239.0: 274, 237.0: 274, 243.0: 268, 240.0: 252, 242.0: 250, 244.0: 226, 250.0: 220, 249.0: 216, 247.0: 212, 245.0: 206, 246.0: 200, 248.0: 196, 253.0: 178, 254.0: 164, 251.0: 162, 252.0: 150, 257.0: 148, 258.0: 148, 255.0: 142, 256.0: 116, 259.0: 112, 260.0: 106, 263.0: 102, 261.0: 100, 264.0: 98, 267.0: 96, 268.0: 96, 262.0: 96, 265.0: 90, 272.0: 84, 274.0: 76, 286.0: 72, 276.0: 72, 266.0: 70, 271.0: 70, 283.0: 68, 273.0: 68, 285.0: 64, 280.0: 64, 282.0: 62, 279.0: 62, 270.0: 62, 277.0: 60, 269.0: 58, 293.0: 56, 275.0: 54, 294.0: 52, 284.0: 52, 292.0: 50, 278.0: 50, 289.0: 46, 295.0: 46, 281.0: 44, 287.0: 40, 288.0: 40, 297.0: 38, 291.0: 38, 290.0: 32, 298.0: 30, 296.0: 24, 299.0: 22, 300.0: 22, 301.0: 20, 306.0: 20, 304.0: 20, 307.0: 18, 302.0: 16, 303.0: 16, 305.0: 12, 311.0: 12, 310.0: 12, 312.0: 10, 325.0: 8, 308.0: 8, 317.0: 6, 318.0: 6, 313.0: 6, 322.0: 4, 319.0: 4, 309.0: 4, 332.0: 2, 350.0: 2, 329.0: 2, 320.0: 2, 315.0: 2, 334.0: 2, 336.0: 2, 326.0: 2, 328.0: 2, 343.0: 2, 347.0: 2, 331.0: 2, 314.0: 2})
428355292
Convert a graph into a bidirected graph: 34.054 seconds
Metis partitioning: 98.587 seconds
Split the graph: 12.214 seconds
Construct subgraphs: 0.040 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  145.04642271995544
16868
15908
15931
15965
16502
16866
16744
16064
16819
16577
16297
16030
total k batches seeds list generation spend  287.5023491382599
after graph partition
graph partition algorithm spend time 290.9575774669647
16868
15908
15931
15965
16502
16866
16744
16064
16819
16577
16297
16030
partition_len_list
[310482, 365804, 168024, 318150, 242088, 268339, 322295, 416378, 304713, 328420, 343423, 321864]
REG selection method  spend 292.2546446323395
time for parepare:  0.40111398696899414
local_output_nid generation:  0.00825810432434082
local_in_edges_tensor generation:  0.020247936248779297
mini_batch_src_global generation:  0.07660293579101562
r_  generation:  0.7021000385284424
local_output_nid generation:  0.007817506790161133
local_in_edges_tensor generation:  0.018796920776367188
mini_batch_src_global generation:  0.09317684173583984
r_  generation:  0.7560865879058838
local_output_nid generation:  0.007952690124511719
local_in_edges_tensor generation:  0.01654982566833496
mini_batch_src_global generation:  0.07921290397644043
r_  generation:  0.6032578945159912
local_output_nid generation:  0.009077310562133789
local_in_edges_tensor generation:  0.0185701847076416
mini_batch_src_global generation:  0.0768277645111084
r_  generation:  0.6561946868896484
local_output_nid generation:  0.007991790771484375
local_in_edges_tensor generation:  0.018065214157104492
mini_batch_src_global generation:  0.08305692672729492
r_  generation:  0.6775367259979248
local_output_nid generation:  0.008235454559326172
local_in_edges_tensor generation:  0.01904582977294922
mini_batch_src_global generation:  0.08128666877746582
r_  generation:  0.8430085182189941
local_output_nid generation:  0.010809183120727539
local_in_edges_tensor generation:  0.022505521774291992
mini_batch_src_global generation:  0.12265539169311523
r_  generation:  0.8449654579162598
local_output_nid generation:  0.010543346405029297
local_in_edges_tensor generation:  0.0295867919921875
mini_batch_src_global generation:  0.11737918853759766
r_  generation:  1.1553583145141602
local_output_nid generation:  0.010854244232177734
local_in_edges_tensor generation:  0.05408883094787598
mini_batch_src_global generation:  0.13497138023376465
r_  generation:  1.0983989238739014
local_output_nid generation:  0.010438680648803711
local_in_edges_tensor generation:  0.0409855842590332
mini_batch_src_global generation:  0.11564898490905762
r_  generation:  0.9558780193328857
local_output_nid generation:  0.009045600891113281
local_in_edges_tensor generation:  0.03595399856567383
mini_batch_src_global generation:  0.10532903671264648
r_  generation:  0.9275107383728027
local_output_nid generation:  0.008399248123168945
local_in_edges_tensor generation:  0.030999422073364258
mini_batch_src_global generation:  0.11204290390014648
r_  generation:  0.9504101276397705
----------------------check_connections_block total spend ----------------------------- 13.956018447875977
generate_one_block  1.7632079124450684
generate_one_block  1.462097406387329
generate_one_block  1.0493528842926025
generate_one_block  1.170849084854126
generate_one_block  1.1597931385040283
generate_one_block  1.1874635219573975
generate_one_block  1.2054028511047363
generate_one_block  1.6592280864715576
generate_one_block  1.6582179069519043
generate_one_block  1.5517969131469727
generate_one_block  1.3888559341430664
generate_one_block  1.4716811180114746
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13661575317382812  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

connection checking time:  13.956018447875977
block generation total time  16.727946758270264
average batch blocks generation time:  1.3939955631891887
block dataloader generation time/epoch 335.0914350748062
pseudo mini batch 0 input nodes size: 310482
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10535478591918945  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10535478591918945  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.22101879119873047  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2211446762084961  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1204671859741211  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1378955841064453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1378955841064453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16868, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 13.351918697357178  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 13.355246543884277  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1550145149230957  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 1 input nodes size: 365804
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12009477615356445  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12009477615356445  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.25636768341064453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2564864158630371  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.14069652557373047  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1587209701538086  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1587209701538086  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([15908, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 13.81662130355835  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 13.81940746307373  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1766371726989746  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 2 input nodes size: 168024
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.14052867889404297  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.14052867889404297  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.20312261581420898  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.20324134826660156  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.0668497085571289  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.0824747085571289  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.0824747085571289  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([15931, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.776333808898926  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.779905319213867  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09794473648071289  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 3 input nodes size: 318150
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.06685352325439453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.06685352325439453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.18537378311157227  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.18549299240112305  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12278032302856445  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13840532302856445  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13840532302856445  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([15965, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.889775276184082  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 11.892571449279785  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.15430116653442383  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 4 input nodes size: 242088
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1227865219116211  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1227865219116211  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.21297168731689453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.21309471130371094  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09445524215698242  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.11012601852416992  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.11012601852416992  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16502, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.068343162536621  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.071601867675781  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12595224380493164  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 5 input nodes size: 268339
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09454917907714844  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.09454917907714844  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.19451332092285156  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1946392059326172  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10433101654052734  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1202239990234375  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1202239990234375  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16866, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.183465480804443  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.186796188354492  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.13624334335327148  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 6 input nodes size: 322295
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10439443588256836  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.10439443588256836  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2244586944580078  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.22458362579345703  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12449359893798828  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1403350830078125  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1403350830078125  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16744, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.163163185119629  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 12.166116714477539  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1562180519104004  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 7 input nodes size: 416378
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12447261810302734  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.12447261810302734  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2795858383178711  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2797055244445801  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1595163345336914  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.18099021911621094  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.18099021911621094  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16064, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 16.188526153564453  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 16.19136381149292  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2020740509033203  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 8 input nodes size: 304713
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.15939712524414062  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.15939712524414062  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.27291202545166016  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.2730374336242676  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.11780452728271484  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1402912139892578  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7869873046875 GB
    Memory Allocated: 0.1402912139892578  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16819, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 17.18566131591797  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 17.188982486724854  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16297292709350586  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 9 input nodes size: 328420
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.11793661117553711  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.11793661117553711  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.24028301239013672  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.24040699005126953  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12676668167114258  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14746475219726562  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14746475219726562  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16577, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 15.593699932098389  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 15.59664535522461  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1677556037902832  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 10 input nodes size: 343423
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1267242431640625  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1267242431640625  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.25465965270996094  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.25478124618530273  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1323108673095703  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.15089702606201172  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.15089702606201172  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16297, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 14.305386543273926  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 14.308289527893066  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.170440673828125  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 11 input nodes size: 321864
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1322622299194336  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1322622299194336  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.2521662712097168  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.2522859573364258  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12422895431518555  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14415407180786133  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14415407180786133  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16030, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 15.234328746795654  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 15.237136363983154  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16457796096801758  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16457796096801758  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16457796096801758  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12209959824879964 |0.026096701622009277 |5.719961146513621 |0.00018896659215291342 |10.741724650065104 |0.02286052703857422 |
----------------------------------------------------------pseudo_mini_loss sum 4.173506736755371
Total (block generation + training)time/epoch 538.9284397363663
Training time/epoch 200.25764560699463
Training time without block to device /epoch 199.94448518753052
Training time without total dataloading part /epoch 197.5653576850891
load block tensor time/epoch 1.4651951789855957
block to device time/epoch 0.31316041946411133
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3709980
Number of first layer input nodes during this epoch:  3709980
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16457748413085938  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.6364407539367676
global_2_local spend time (sec) 0.7918283939361572
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.2970552444458008
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630740, 400: 15194, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 123: 741, 36: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 137: 654, 139: 654, 131: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 157: 577, 151: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 181: 435, 173: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 208: 369, 195: 369, 196: 369, 194: 365, 198: 363, 204: 350, 209: 340, 203: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 217: 291, 212: 291, 225: 289, 222: 284, 220: 282, 223: 275, 233: 273, 226: 273, 230: 271, 239: 268, 227: 268, 238: 259, 244: 259, 234: 258, 249: 258, 237: 257, 229: 254, 240: 253, 235: 252, 246: 252, 236: 246, 232: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 2: 221, 248: 221, 264: 219, 252: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 253: 201, 258: 201, 266: 199, 260: 196, 269: 195, 265: 190, 273: 190, 263: 189, 270: 189, 278: 188, 277: 187, 262: 183, 276: 182, 261: 182, 282: 182, 256: 179, 274: 179, 272: 178, 285: 178, 271: 177, 299: 175, 280: 175, 284: 174, 1: 173, 290: 169, 291: 168, 303: 165, 295: 165, 287: 164, 279: 160, 288: 159, 286: 159, 315: 159, 298: 157, 294: 156, 300: 155, 292: 154, 297: 152, 283: 152, 301: 151, 302: 151, 289: 149, 305: 148, 293: 147, 281: 147, 275: 147, 306: 147, 312: 146, 307: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 309: 133, 304: 133, 318: 132, 320: 131, 314: 131, 308: 130, 332: 127, 319: 127, 342: 123, 328: 123, 326: 123, 323: 120, 321: 120, 333: 119, 322: 119, 317: 118, 344: 115, 351: 114, 327: 114, 340: 114, 324: 113, 331: 113, 336: 110, 325: 109, 355: 108, 349: 107, 365: 105, 329: 105, 341: 105, 345: 104, 353: 104, 330: 103, 339: 103, 338: 103, 357: 102, 359: 102, 334: 101, 362: 100, 378: 100, 381: 100, 337: 99, 380: 99, 383: 99, 348: 99, 371: 99, 356: 98, 360: 98, 350: 98, 354: 97, 370: 97, 363: 96, 343: 96, 372: 95, 385: 94, 335: 93, 352: 92, 376: 92, 374: 92, 347: 92, 373: 91, 375: 91, 361: 91, 368: 91, 346: 90, 366: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 390: 81, 386: 81, 395: 80, 398: 80, 387: 80, 389: 79, 397: 79, 392: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.42749595642089844
auxiliary_graph
Graph(num_nodes=1827311, num_edges=428535431,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8030948638916016
remove nodes length  1630740

auxiliary_graph.remove_nodes spent  21.513225317001343
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428535431,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  17.54521131515503

the counter of shared neighbor distribution
Counter({1.0: 241175360, 2.0: 65508806, 3.0: 32147580, 4.0: 19315856, 5.0: 12935382, 6.0: 9266958, 7.0: 6929142, 8.0: 5383052, 9.0: 4276582, 10.0: 3482110, 11.0: 2879350, 12.0: 2417358, 13.0: 2063004, 14.0: 1769288, 15.0: 1531986, 16.0: 1337326, 17.0: 1178532, 18.0: 1045098, 19.0: 928870, 20.0: 831774, 21.0: 746668, 22.0: 672678, 23.0: 610526, 24.0: 555600, 25.0: 508714, 26.0: 465214, 27.0: 430730, 28.0: 396828, 29.0: 366038, 30.0: 341550, 31.0: 318700, 32.0: 296228, 33.0: 279938, 34.0: 260592, 35.0: 243022, 36.0: 229974, 37.0: 215678, 38.0: 204134, 39.0: 194628, 40.0: 182694, 41.0: 171832, 42.0: 165244, 43.0: 156512, 44.0: 148530, 45.0: 141914, 46.0: 134490, 47.0: 128402, 48.0: 122928, 49.0: 120310, 50.0: 112464, 51.0: 109228, 52.0: 103188, 53.0: 98202, 54.0: 92864, 55.0: 88668, 56.0: 85434, 57.0: 82118, 58.0: 78222, 59.0: 75588, 60.0: 72062, 61.0: 69052, 62.0: 66434, 63.0: 63926, 64.0: 60942, 65.0: 58822, 67.0: 58668, 66.0: 57818, 68.0: 53678, 69.0: 51540, 70.0: 49570, 71.0: 47442, 72.0: 46268, 73.0: 44078, 74.0: 42578, 75.0: 41410, 76.0: 40070, 77.0: 39142, 78.0: 36532, 79.0: 35306, 80.0: 34178, 81.0: 33790, 82.0: 32336, 83.0: 31364, 85.0: 30446, 84.0: 30226, 86.0: 28746, 87.0: 27290, 88.0: 26892, 89.0: 25644, 90.0: 24872, 91.0: 23874, 92.0: 23590, 93.0: 22774, 94.0: 21682, 95.0: 21084, 97.0: 20604, 96.0: 20472, 98.0: 19442, 99.0: 18920, 100.0: 18722, 102.0: 17658, 101.0: 17364, 103.0: 17002, 104.0: 15956, 105.0: 15902, 106.0: 15538, 107.0: 14908, 108.0: 14250, 109.0: 14136, 110.0: 13728, 111.0: 13170, 112.0: 12822, 113.0: 12804, 114.0: 12138, 115.0: 11778, 116.0: 11440, 117.0: 11232, 118.0: 11036, 120.0: 10700, 119.0: 10472, 121.0: 10038, 122.0: 9666, 123.0: 9258, 124.0: 9146, 125.0: 8858, 126.0: 8842, 127.0: 8296, 128.0: 7924, 129.0: 7624, 130.0: 7524, 131.0: 7408, 132.0: 7322, 133.0: 7038, 135.0: 6934, 134.0: 6924, 136.0: 6466, 137.0: 6330, 138.0: 6064, 141.0: 5966, 140.0: 5776, 139.0: 5748, 142.0: 5552, 143.0: 5390, 144.0: 5182, 145.0: 5092, 146.0: 4896, 148.0: 4720, 147.0: 4706, 149.0: 4580, 150.0: 4466, 151.0: 4326, 152.0: 4194, 153.0: 4064, 154.0: 3996, 156.0: 3910, 155.0: 3818, 157.0: 3786, 158.0: 3696, 159.0: 3554, 160.0: 3448, 161.0: 3230, 162.0: 3142, 163.0: 3114, 164.0: 2988, 165.0: 2986, 166.0: 2872, 168.0: 2724, 167.0: 2718, 169.0: 2676, 170.0: 2616, 171.0: 2546, 172.0: 2390, 174.0: 2326, 177.0: 2270, 173.0: 2268, 175.0: 2184, 178.0: 2158, 176.0: 2114, 179.0: 2024, 180.0: 1942, 182.0: 1878, 183.0: 1858, 181.0: 1818, 184.0: 1790, 186.0: 1722, 185.0: 1608, 189.0: 1568, 187.0: 1548, 191.0: 1508, 188.0: 1486, 190.0: 1486, 192.0: 1370, 194.0: 1340, 193.0: 1332, 195.0: 1266, 196.0: 1250, 200.0: 1164, 199.0: 1116, 198.0: 1080, 197.0: 1064, 201.0: 1040, 202.0: 1036, 203.0: 1004, 205.0: 976, 204.0: 890, 208.0: 884, 207.0: 870, 206.0: 842, 210.0: 822, 209.0: 770, 211.0: 770, 212.0: 738, 213.0: 708, 214.0: 702, 216.0: 660, 217.0: 636, 218.0: 624, 215.0: 600, 219.0: 570, 221.0: 562, 220.0: 548, 222.0: 542, 224.0: 524, 223.0: 502, 229.0: 444, 226.0: 440, 225.0: 438, 228.0: 424, 227.0: 390, 234.0: 378, 230.0: 352, 233.0: 342, 236.0: 336, 231.0: 332, 232.0: 330, 235.0: 322, 239.0: 320, 245.0: 276, 237.0: 270, 244.0: 264, 238.0: 252, 243.0: 250, 241.0: 246, 242.0: 244, 246.0: 226, 240.0: 226, 248.0: 202, 247.0: 198, 250.0: 186, 249.0: 178, 255.0: 178, 252.0: 172, 257.0: 168, 251.0: 164, 253.0: 152, 258.0: 136, 254.0: 130, 256.0: 122, 259.0: 118, 261.0: 116, 263.0: 110, 260.0: 106, 266.0: 98, 262.0: 98, 265.0: 94, 282.0: 82, 264.0: 80, 277.0: 78, 268.0: 76, 271.0: 76, 269.0: 74, 270.0: 74, 287.0: 74, 274.0: 74, 267.0: 72, 278.0: 70, 284.0: 68, 273.0: 60, 272.0: 58, 276.0: 58, 279.0: 56, 286.0: 56, 292.0: 56, 285.0: 52, 283.0: 52, 275.0: 50, 280.0: 50, 289.0: 50, 291.0: 46, 281.0: 42, 294.0: 40, 296.0: 40, 295.0: 38, 290.0: 36, 298.0: 34, 288.0: 34, 293.0: 32, 299.0: 28, 301.0: 26, 303.0: 26, 302.0: 24, 297.0: 22, 308.0: 22, 304.0: 16, 300.0: 14, 307.0: 12, 305.0: 10, 306.0: 10, 312.0: 8, 313.0: 8, 318.0: 8, 310.0: 8, 309.0: 8, 324.0: 4, 315.0: 4, 311.0: 4, 314.0: 4, 325.0: 4, 319.0: 4, 331.0: 2, 332.0: 2, 326.0: 2, 317.0: 2, 347.0: 2, 335.0: 2, 322.0: 2, 323.0: 2, 343.0: 2, 329.0: 2, 350.0: 2, 333.0: 2, 327.0: 2})
428338860
Convert a graph into a bidirected graph: 35.834 seconds
Metis partitioning: 104.540 seconds
Split the graph: 11.743 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  152.338862657547
16043
16573
16860
16872
16164
16852
15903
15903
16511
16856
16131
15903
total k batches seeds list generation spend  296.7336657047272
after graph partition
graph partition algorithm spend time 300.22375559806824
16043
16573
16860
16872
16164
16852
15903
15903
16511
16856
16131
15903
partition_len_list
[333242, 233571, 271552, 313655, 174696, 289270, 371395, 375891, 338539, 379016, 360536, 290788]
REG selection method  spend 301.386687040329
time for parepare:  0.43482112884521484
local_output_nid generation:  0.007967710494995117
local_in_edges_tensor generation:  0.022319316864013672
mini_batch_src_global generation:  0.07274651527404785
r_  generation:  0.6380903720855713
local_output_nid generation:  0.008508920669555664
local_in_edges_tensor generation:  0.020915985107421875
mini_batch_src_global generation:  0.08878445625305176
r_  generation:  0.6791596412658691
local_output_nid generation:  0.008093833923339844
local_in_edges_tensor generation:  0.019889354705810547
mini_batch_src_global generation:  0.07895708084106445
r_  generation:  0.6675136089324951
local_output_nid generation:  0.008100509643554688
local_in_edges_tensor generation:  0.02894449234008789
mini_batch_src_global generation:  0.11214709281921387
r_  generation:  1.017064094543457
local_output_nid generation:  0.007688760757446289
local_in_edges_tensor generation:  0.018648862838745117
mini_batch_src_global generation:  0.09117531776428223
r_  generation:  0.6352286338806152
local_output_nid generation:  0.007938861846923828
local_in_edges_tensor generation:  0.022873878479003906
mini_batch_src_global generation:  0.10509490966796875
r_  generation:  0.9001939296722412
local_output_nid generation:  0.007592678070068359
local_in_edges_tensor generation:  0.030668258666992188
mini_batch_src_global generation:  0.11935019493103027
r_  generation:  1.034961462020874
local_output_nid generation:  0.0076389312744140625
local_in_edges_tensor generation:  0.02455925941467285
mini_batch_src_global generation:  0.11276888847351074
r_  generation:  0.9751336574554443
local_output_nid generation:  0.007723331451416016
local_in_edges_tensor generation:  0.022736549377441406
mini_batch_src_global generation:  0.11906743049621582
r_  generation:  0.8820204734802246
local_output_nid generation:  0.008008956909179688
local_in_edges_tensor generation:  0.02031683921813965
mini_batch_src_global generation:  0.08993268013000488
r_  generation:  0.7814960479736328
local_output_nid generation:  0.007703065872192383
local_in_edges_tensor generation:  0.025675058364868164
mini_batch_src_global generation:  0.1112370491027832
r_  generation:  1.0155284404754639
local_output_nid generation:  0.0074863433837890625
local_in_edges_tensor generation:  0.019195556640625
mini_batch_src_global generation:  0.08567047119140625
r_  generation:  0.6821081638336182
----------------------check_connections_block total spend ----------------------------- 13.55727243423462
generate_one_block  2.6133065223693848
generate_one_block  1.3335163593292236
generate_one_block  1.1704535484313965
generate_one_block  1.778003454208374
generate_one_block  1.072155475616455
generate_one_block  1.5052876472473145
generate_one_block  1.65681791305542
generate_one_block  1.4915871620178223
generate_one_block  1.3287646770477295
generate_one_block  1.1902191638946533
generate_one_block  1.5357892513275146
generate_one_block  1.0267329216003418
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16457748413085938  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

connection checking time:  13.55727243423462
block generation total time  17.70263409614563
average batch blocks generation time:  1.4752195080121357
block dataloader generation time/epoch 337.1144167582194
pseudo mini batch 0 input nodes size: 333242
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12466669082641602  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12466669082641602  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.2488093376159668  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.24892902374267578  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1289052963256836  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14531660079956055  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14531660079956055  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16043, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 11.943947315216064  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 11.946757316589355  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.16051912307739258  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 1 input nodes size: 233571
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12842273712158203  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12842273712158203  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.21543502807617188  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.21555852890014648  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.09129619598388672  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.10747528076171875  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.10747528076171875  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16573, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 12.432797908782959  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 12.435700416564941  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1238093376159668  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 2 input nodes size: 271552
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.09138917922973633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.09138917922973633  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1925501823425293  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.19267606735229492  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.10554027557373047  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12102127075195312  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12102127075195312  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16860, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 11.889248371124268  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 11.893103122711182  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.13675928115844727  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

pseudo mini batch 3 input nodes size: 313655
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1055903434753418  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.1055903434753418  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.22243595123291016  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.22256183624267578  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.12127494812011719  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14417076110839844  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9119873046875 GB
    Memory Allocated: 0.14417076110839844  GigaBytes
Max Memory Allocated: 18.596919536590576  GigaBytes

torch.Size([16872, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 17.469010829925537  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 17.471965789794922  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.16713190078735352  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 4 input nodes size: 174696
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1212773323059082  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1212773323059082  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1863570213317871  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1864776611328125  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.06950616836547852  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.0851283073425293  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.0851283073425293  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16164, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 12.028439044952393  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 12.031394004821777  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.10068988800048828  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 5 input nodes size: 289270
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.0693821907043457  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.0693821907043457  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.17714405059814453  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.17726993560791016  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.11206960678100586  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1331496238708496  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4197998046875 GB
    Memory Allocated: 0.1331496238708496  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16852, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 15.985642433166504  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 15.988593578338623  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.15413522720336914  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 6 input nodes size: 371395
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.11218976974487305  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.11218976974487305  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.2505455017089844  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.25066423416137695  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.1427764892578125  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.16546630859375  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8924560546875 GB
    Memory Allocated: 0.16546630859375  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 16.79504156112671  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 16.797992706298828  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1873021125793457  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 7 input nodes size: 375891
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1426105499267578  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1426105499267578  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2826409339904785  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2827596664428711  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1442852020263672  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.16539287567138672  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.16539287567138672  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 15.55246114730835  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 15.555601596832275  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1856398582458496  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 8 input nodes size: 338539
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1442852020263672  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1442852020263672  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2704010009765625  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2705240249633789  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.13037490844726562  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.148590087890625  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.148590087890625  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16511, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 13.955256938934326  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 13.95814847946167  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.16697311401367188  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 9 input nodes size: 379016
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.13048124313354492  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.13048124313354492  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.27167606353759766  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2718019485473633  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.14556312561035156  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.16129779815673828  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.16129779815673828  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16856, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 12.11374044418335  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 12.117059707641602  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1771559715270996  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 10 input nodes size: 360536
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.14562368392944336  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.14562368392944336  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.2799339294433594  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.28005456924438477  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.1387338638305664  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.15877389907836914  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4471435546875 GB
    Memory Allocated: 0.15877389907836914  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16131, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 14.914593696594238  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 14.917545795440674  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.1782388687133789  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

pseudo mini batch 11 input nodes size: 290788
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.13860702514648438  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.13860702514648438  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.2469344139099121  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.2470531463623047  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.11262226104736328  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.12670135498046875  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 10.87726354598999  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 10.880048751831055  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.14079999923706055  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.14079999923706055  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.14079999923706055  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1279863715171814 |0.02907113234202067 |5.848647276560466 |0.00017486015955607095 |10.603420972824097 |0.01925826072692871 |
----------------------------------------------------------pseudo_mini_loss sum 3.4549829959869385
Total (block generation + training)time/epoch 539.7357043425242
Training time/epoch 200.18956780433655
Training time without block to device /epoch 199.8407142162323
Training time without total dataloading part /epoch 197.44617557525635
load block tensor time/epoch 1.5358364582061768
block to device time/epoch 0.34885358810424805
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3732151
Number of first layer input nodes during this epoch:  3732151
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.14079952239990234  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.583094596862793
global_2_local spend time (sec) 0.919055700302124
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.2995321750640869
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630700, 400: 15194, 77: 1190, 81: 1185, 79: 1185, 88: 1183, 84: 1177, 78: 1169, 75: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 62: 959, 52: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 119: 816, 39: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 15: 673, 145: 673, 25: 671, 26: 659, 7: 655, 139: 654, 131: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 190: 386, 193: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 196: 369, 208: 369, 195: 369, 194: 365, 198: 363, 204: 350, 203: 340, 209: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 212: 291, 217: 291, 225: 289, 222: 284, 220: 282, 223: 275, 233: 273, 226: 273, 230: 271, 227: 268, 239: 268, 244: 259, 238: 259, 234: 258, 249: 258, 237: 257, 229: 254, 240: 253, 246: 252, 235: 252, 232: 246, 236: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 248: 221, 2: 221, 252: 219, 264: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 258: 201, 253: 201, 266: 199, 260: 196, 269: 195, 273: 190, 265: 190, 263: 189, 270: 189, 278: 188, 277: 187, 262: 183, 276: 182, 282: 182, 261: 182, 256: 179, 274: 179, 272: 178, 285: 178, 271: 177, 299: 175, 280: 175, 284: 174, 1: 173, 290: 169, 291: 168, 295: 165, 303: 165, 287: 164, 279: 160, 315: 159, 286: 159, 288: 159, 298: 157, 294: 156, 300: 155, 292: 154, 283: 152, 297: 152, 302: 151, 301: 151, 289: 149, 305: 148, 293: 147, 306: 147, 275: 147, 281: 147, 312: 146, 307: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 309: 133, 304: 133, 318: 132, 320: 131, 314: 131, 308: 130, 332: 127, 319: 127, 342: 123, 326: 123, 328: 123, 321: 120, 323: 120, 333: 119, 322: 119, 317: 118, 344: 115, 340: 114, 327: 114, 351: 114, 331: 113, 324: 113, 336: 110, 325: 109, 355: 108, 349: 107, 329: 105, 365: 105, 341: 105, 345: 104, 353: 104, 338: 103, 330: 103, 339: 103, 359: 102, 357: 102, 334: 101, 381: 100, 378: 100, 362: 100, 337: 99, 383: 99, 371: 99, 380: 99, 348: 99, 350: 98, 360: 98, 356: 98, 354: 97, 370: 97, 343: 96, 363: 96, 372: 95, 385: 94, 335: 93, 376: 92, 374: 92, 347: 92, 352: 92, 368: 91, 375: 91, 373: 91, 361: 91, 366: 90, 346: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 390: 81, 386: 81, 398: 80, 387: 80, 395: 80, 389: 79, 392: 79, 397: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.44449567794799805
auxiliary_graph
Graph(num_nodes=1827271, num_edges=428534485,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8267011642456055
remove nodes length  1630700

auxiliary_graph.remove_nodes spent  20.366153955459595
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428534485,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  17.361715078353882

the counter of shared neighbor distribution
Counter({1.0: 241199392, 2.0: 65515638, 3.0: 32160510, 4.0: 19316116, 5.0: 12926056, 6.0: 9266472, 7.0: 6924910, 8.0: 5377978, 9.0: 4275504, 10.0: 3480900, 11.0: 2875966, 12.0: 2416186, 13.0: 2060596, 14.0: 1765060, 15.0: 1531964, 16.0: 1336080, 17.0: 1179502, 18.0: 1042444, 19.0: 929752, 20.0: 830888, 21.0: 744180, 22.0: 670986, 23.0: 609498, 24.0: 555290, 25.0: 509216, 26.0: 466118, 27.0: 429034, 28.0: 396940, 29.0: 366978, 30.0: 340630, 31.0: 318136, 32.0: 296934, 33.0: 278360, 34.0: 259404, 35.0: 242688, 36.0: 229720, 37.0: 215788, 38.0: 204302, 39.0: 195414, 40.0: 182622, 41.0: 172302, 42.0: 164758, 43.0: 156450, 44.0: 149710, 45.0: 141080, 46.0: 134038, 47.0: 128290, 48.0: 122322, 49.0: 120140, 50.0: 112266, 51.0: 108892, 52.0: 103272, 53.0: 98660, 54.0: 93784, 55.0: 88568, 56.0: 85168, 57.0: 82086, 58.0: 78410, 59.0: 75390, 60.0: 71788, 61.0: 69124, 62.0: 66570, 63.0: 63844, 64.0: 60882, 65.0: 59166, 67.0: 58496, 66.0: 57104, 68.0: 53606, 69.0: 51408, 70.0: 49678, 71.0: 47748, 72.0: 46216, 73.0: 43990, 74.0: 42832, 75.0: 41166, 76.0: 39662, 77.0: 39200, 78.0: 36626, 79.0: 35172, 80.0: 34398, 81.0: 33882, 82.0: 32034, 83.0: 31122, 85.0: 30378, 84.0: 30228, 86.0: 28802, 87.0: 27474, 88.0: 26620, 89.0: 25654, 90.0: 25022, 91.0: 23892, 92.0: 23608, 93.0: 22750, 94.0: 21470, 95.0: 21276, 96.0: 20834, 97.0: 20590, 98.0: 19452, 99.0: 18860, 100.0: 18606, 101.0: 17742, 102.0: 17490, 103.0: 17032, 104.0: 16142, 105.0: 15620, 106.0: 15292, 107.0: 14862, 108.0: 14372, 109.0: 14218, 110.0: 13664, 111.0: 13008, 112.0: 12690, 113.0: 12538, 114.0: 12100, 115.0: 11844, 116.0: 11408, 117.0: 11176, 118.0: 11134, 120.0: 10722, 119.0: 10462, 121.0: 9882, 122.0: 9808, 123.0: 9380, 124.0: 9052, 125.0: 8904, 126.0: 8772, 127.0: 8590, 129.0: 7882, 128.0: 7838, 130.0: 7490, 131.0: 7360, 132.0: 7222, 133.0: 7000, 134.0: 6994, 135.0: 6938, 136.0: 6502, 137.0: 6178, 138.0: 5968, 141.0: 5962, 139.0: 5774, 140.0: 5712, 142.0: 5458, 144.0: 5318, 143.0: 5302, 145.0: 5086, 146.0: 5036, 147.0: 4792, 148.0: 4562, 149.0: 4556, 150.0: 4490, 151.0: 4314, 152.0: 4174, 153.0: 4066, 154.0: 4050, 155.0: 3900, 156.0: 3872, 157.0: 3816, 158.0: 3602, 159.0: 3554, 160.0: 3422, 161.0: 3384, 162.0: 3220, 163.0: 3140, 164.0: 3040, 165.0: 3002, 166.0: 2896, 168.0: 2758, 167.0: 2756, 169.0: 2728, 170.0: 2580, 171.0: 2534, 172.0: 2430, 174.0: 2384, 175.0: 2300, 173.0: 2236, 177.0: 2194, 176.0: 2190, 178.0: 2030, 179.0: 1956, 181.0: 1936, 180.0: 1928, 182.0: 1884, 184.0: 1838, 183.0: 1792, 186.0: 1708, 185.0: 1658, 187.0: 1588, 190.0: 1518, 188.0: 1486, 189.0: 1480, 191.0: 1476, 194.0: 1314, 192.0: 1308, 193.0: 1302, 196.0: 1266, 199.0: 1196, 195.0: 1186, 197.0: 1170, 200.0: 1102, 198.0: 1098, 201.0: 1038, 202.0: 1018, 206.0: 968, 203.0: 966, 205.0: 928, 204.0: 906, 207.0: 896, 208.0: 842, 211.0: 822, 209.0: 814, 210.0: 798, 212.0: 716, 214.0: 688, 213.0: 686, 216.0: 666, 217.0: 656, 218.0: 628, 215.0: 614, 219.0: 592, 221.0: 554, 220.0: 542, 224.0: 508, 223.0: 500, 222.0: 474, 228.0: 444, 225.0: 444, 227.0: 428, 226.0: 418, 229.0: 400, 231.0: 386, 234.0: 372, 233.0: 354, 230.0: 346, 236.0: 342, 235.0: 334, 232.0: 318, 239.0: 284, 238.0: 280, 241.0: 280, 237.0: 278, 243.0: 276, 240.0: 244, 246.0: 238, 242.0: 230, 244.0: 228, 245.0: 218, 248.0: 214, 249.0: 204, 247.0: 202, 251.0: 178, 250.0: 176, 258.0: 166, 253.0: 164, 254.0: 154, 252.0: 150, 255.0: 142, 257.0: 140, 256.0: 134, 259.0: 124, 264.0: 116, 262.0: 116, 263.0: 110, 261.0: 102, 260.0: 102, 271.0: 84, 267.0: 78, 266.0: 76, 274.0: 76, 273.0: 74, 268.0: 72, 282.0: 70, 276.0: 70, 270.0: 70, 283.0: 68, 286.0: 68, 284.0: 66, 265.0: 62, 288.0: 60, 269.0: 60, 293.0: 60, 280.0: 58, 272.0: 58, 291.0: 56, 278.0: 56, 281.0: 54, 277.0: 54, 295.0: 52, 294.0: 50, 285.0: 50, 289.0: 48, 279.0: 48, 287.0: 42, 275.0: 40, 292.0: 40, 290.0: 36, 296.0: 28, 302.0: 26, 299.0: 26, 298.0: 26, 301.0: 20, 297.0: 20, 306.0: 18, 300.0: 18, 303.0: 18, 305.0: 16, 304.0: 16, 310.0: 14, 309.0: 12, 307.0: 12, 308.0: 8, 311.0: 8, 320.0: 6, 312.0: 6, 325.0: 4, 322.0: 4, 313.0: 4, 318.0: 4, 331.0: 4, 326.0: 4, 314.0: 4, 316.0: 2, 333.0: 2, 315.0: 2, 319.0: 2, 347.0: 2, 343.0: 2, 335.0: 2, 351.0: 2, 327.0: 2, 332.0: 2, 317.0: 2})
428337914
Convert a graph into a bidirected graph: 33.421 seconds
Metis partitioning: 106.210 seconds
Split the graph: 11.921 seconds
Construct subgraphs: 0.069 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  151.7809989452362
16752
16159
16845
15903
16866
16728
16549
15906
16589
15903
16468
15903
total k batches seeds list generation spend  293.60564708709717
after graph partition
graph partition algorithm spend time 297.4037756919861
16752
16159
16845
15903
16866
16728
16549
15906
16589
15903
16468
15903
partition_len_list
[306094, 171734, 296105, 334021, 272540, 238513, 346942, 420026, 345470, 459742, 432083, 273611]
REG selection method  spend 298.7848844528198
time for parepare:  0.4372365474700928
local_output_nid generation:  0.008030414581298828
local_in_edges_tensor generation:  0.03989863395690918
mini_batch_src_global generation:  0.10608053207397461
r_  generation:  0.9384903907775879
local_output_nid generation:  0.007641315460205078
local_in_edges_tensor generation:  0.051352739334106445
mini_batch_src_global generation:  0.10715842247009277
r_  generation:  0.6195423603057861
local_output_nid generation:  0.007960081100463867
local_in_edges_tensor generation:  0.06249070167541504
mini_batch_src_global generation:  0.10239839553833008
r_  generation:  0.8820388317108154
local_output_nid generation:  0.008603572845458984
local_in_edges_tensor generation:  0.035289764404296875
mini_batch_src_global generation:  0.08508872985839844
r_  generation:  0.6652448177337646
local_output_nid generation:  0.007814168930053711
local_in_edges_tensor generation:  0.0354304313659668
mini_batch_src_global generation:  0.0871429443359375
r_  generation:  0.7067098617553711
local_output_nid generation:  0.007665157318115234
local_in_edges_tensor generation:  0.04115104675292969
mini_batch_src_global generation:  0.10156559944152832
r_  generation:  0.6964664459228516
local_output_nid generation:  0.00749516487121582
local_in_edges_tensor generation:  0.02168726921081543
mini_batch_src_global generation:  0.08307862281799316
r_  generation:  0.7041435241699219
local_output_nid generation:  0.007428884506225586
local_in_edges_tensor generation:  0.0256195068359375
mini_batch_src_global generation:  0.08233952522277832
r_  generation:  0.7826108932495117
local_output_nid generation:  0.007496833801269531
local_in_edges_tensor generation:  0.03328275680541992
mini_batch_src_global generation:  0.11796712875366211
r_  generation:  1.0120630264282227
local_output_nid generation:  0.007415056228637695
local_in_edges_tensor generation:  0.018830060958862305
mini_batch_src_global generation:  0.09970736503601074
r_  generation:  0.8960092067718506
local_output_nid generation:  0.007486820220947266
local_in_edges_tensor generation:  0.026656389236450195
mini_batch_src_global generation:  0.11311674118041992
r_  generation:  0.9393672943115234
local_output_nid generation:  0.007427215576171875
local_in_edges_tensor generation:  0.028431415557861328
mini_batch_src_global generation:  0.10489749908447266
r_  generation:  0.8872156143188477
----------------------check_connections_block total spend ----------------------------- 13.601469039916992
generate_one_block  2.0611565113067627
generate_one_block  1.0844128131866455
generate_one_block  1.4808425903320312
generate_one_block  1.137071132659912
generate_one_block  1.1338253021240234
generate_one_block  1.1437721252441406
generate_one_block  1.1321663856506348
generate_one_block  1.2088704109191895
generate_one_block  1.5362939834594727
generate_one_block  1.4951660633087158
generate_one_block  1.5080454349517822
generate_one_block  1.413222074508667
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.14079952239990234  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

connection checking time:  13.601469039916992
block generation total time  16.334844827651978
average batch blocks generation time:  1.361237068970998
block dataloader generation time/epoch 336.96686738729477
pseudo mini batch 0 input nodes size: 306094
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.11258125305175781  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.11258125305175781  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.2266101837158203  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.22673511505126953  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.11828899383544922  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.1417689323425293  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0408935546875 GB
    Memory Allocated: 0.1417689323425293  GigaBytes
Max Memory Allocated: 18.826699256896973  GigaBytes

torch.Size([16752, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 17.52974843978882  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 17.5326828956604  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16497039794921875  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 1 input nodes size: 171734
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.118438720703125  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.118438720703125  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.18241500854492188  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.18253564834594727  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.06838178634643555  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.08400297164916992  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.08400297164916992  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16159, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.030173301696777  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.033003330230713  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09958457946777344  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 2 input nodes size: 296105
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.06827783584594727  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.06827783584594727  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.17858600616455078  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1787118911743164  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11461496353149414  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13576030731201172  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13576030731201172  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16845, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 16.026134490966797  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 16.029769897460938  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.15687084197998047  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 3 input nodes size: 334021
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11473512649536133  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2391676902770996  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2392864227294922  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12885236740112305  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14406728744506836  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14406728744506836  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.74198579788208  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.744771003723145  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.15958690643310547  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 4 input nodes size: 272540
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12868738174438477  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12868738174438477  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.23021650314331055  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.23034238815307617  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10579109191894531  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12140655517578125  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12140655517578125  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16866, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.05212116241455  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.055074691772461  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13726282119750977  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 5 input nodes size: 238513
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10595941543579102  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10595941543579102  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.19481277465820312  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.19493770599365234  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09328269958496094  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10956764221191406  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10956764221191406  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16728, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.504600524902344  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.507554054260254  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12589120864868164  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 6 input nodes size: 346942
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09325885772705078  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09325885772705078  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2225050926208496  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.22262859344482422  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1336503028869629  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14880132675170898  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14880132675170898  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16549, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.652339458465576  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.655269145965576  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16445684432983398  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 7 input nodes size: 420026
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13361883163452148  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13361883163452148  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.29009103775024414  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2902097702026367  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16084003448486328  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.17620086669921875  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.17620086669921875  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([15906, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.837343215942383  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.840241432189941  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1917729377746582  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 8 input nodes size: 345470
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16072750091552734  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16072750091552734  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2894253730773926  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2895493507385254  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13295841217041016  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1555800437927246  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1555800437927246  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16589, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 16.663400650024414  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 16.66667652130127  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1775674819946289  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 9 input nodes size: 459742
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13307809829711914  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13307809829711914  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.30434560775756836  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.30446434020996094  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1756424903869629  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1940751075744629  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1940751075744629  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 14.166767597198486  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 14.169672966003418  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2124471664428711  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 10 input nodes size: 432083
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1755223274230957  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1755223274230957  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.3364858627319336  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.33660888671875  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1652226448059082  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.18395757675170898  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.18395757675170898  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16468, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 14.380294799804688  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 14.3831787109375  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.20364904403686523  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 11 input nodes size: 273611
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16532135009765625  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16532135009765625  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.26724958419799805  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.2673683166503906  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10628175735473633  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12624406814575195  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12624406814575195  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 15.24782943725586  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 15.250713348388672  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14616727828979492  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14616727828979492  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14616727828979492  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1335416634877523 |0.026699145634969074 |5.654219925403595 |0.00017907222112019858 |10.60165681441625 |0.01885509490966797 |
----------------------------------------------------------pseudo_mini_loss sum 2.622462749481201
Total (block generation + training)time/epoch 538.4114073514938
Training time/epoch 197.91402459144592
Training time without block to device /epoch 197.5936348438263
Training time without total dataloading part /epoch 195.09152483940125
load block tensor time/epoch 1.6024999618530273
block to device time/epoch 0.3203897476196289
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3896881
Number of first layer input nodes during this epoch:  3896881
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14616680145263672  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.5112264156341553
global_2_local spend time (sec) 0.907336950302124
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.29845571517944336
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630727, 400: 15194, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 119: 816, 39: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 137: 654, 131: 654, 139: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 181: 435, 173: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 190: 386, 193: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 196: 369, 195: 369, 208: 369, 194: 365, 198: 363, 204: 350, 209: 340, 203: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 212: 291, 217: 291, 225: 289, 222: 284, 220: 282, 223: 275, 226: 273, 233: 273, 230: 271, 239: 268, 227: 268, 244: 259, 238: 259, 234: 258, 249: 258, 237: 257, 229: 254, 240: 253, 235: 252, 246: 252, 232: 246, 236: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 2: 221, 248: 221, 252: 219, 264: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 253: 201, 258: 201, 266: 199, 260: 196, 269: 195, 265: 190, 273: 190, 270: 189, 263: 189, 278: 188, 277: 187, 262: 183, 276: 182, 282: 182, 261: 182, 256: 179, 274: 179, 285: 178, 272: 178, 271: 177, 299: 175, 280: 175, 284: 174, 1: 173, 290: 169, 291: 168, 295: 165, 303: 165, 287: 164, 279: 160, 288: 159, 286: 159, 315: 159, 298: 157, 294: 156, 300: 155, 292: 154, 297: 152, 283: 152, 301: 151, 302: 151, 289: 149, 305: 148, 306: 147, 281: 147, 275: 147, 293: 147, 307: 146, 312: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 304: 133, 309: 133, 318: 132, 320: 131, 314: 131, 308: 130, 319: 127, 332: 127, 342: 123, 328: 123, 326: 123, 321: 120, 323: 120, 333: 119, 322: 119, 317: 118, 344: 115, 327: 114, 351: 114, 340: 114, 324: 113, 331: 113, 336: 110, 325: 109, 355: 108, 349: 107, 329: 105, 341: 105, 365: 105, 353: 104, 345: 104, 339: 103, 338: 103, 330: 103, 359: 102, 357: 102, 334: 101, 362: 100, 378: 100, 381: 100, 383: 99, 348: 99, 371: 99, 337: 99, 380: 99, 356: 98, 360: 98, 350: 98, 354: 97, 370: 97, 363: 96, 343: 96, 372: 95, 385: 94, 335: 93, 347: 92, 376: 92, 374: 92, 352: 92, 361: 91, 375: 91, 373: 91, 368: 91, 346: 90, 366: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 386: 81, 390: 81, 395: 80, 387: 80, 398: 80, 392: 79, 397: 79, 389: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.4344511032104492
auxiliary_graph
Graph(num_nodes=1827298, num_edges=428499397,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8390543460845947
remove nodes length  1630727

auxiliary_graph.remove_nodes spent  21.695161819458008
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428499397,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  17.443151712417603

the counter of shared neighbor distribution
Counter({1.0: 241190966, 2.0: 65519892, 3.0: 32150312, 4.0: 19308804, 5.0: 12916650, 6.0: 9261260, 7.0: 6922090, 8.0: 5379636, 9.0: 4273306, 10.0: 3478792, 11.0: 2875150, 12.0: 2416592, 13.0: 2060368, 14.0: 1767982, 15.0: 1531398, 16.0: 1337600, 17.0: 1177532, 18.0: 1040688, 19.0: 929934, 20.0: 831042, 21.0: 746038, 22.0: 672184, 23.0: 610994, 24.0: 555616, 25.0: 509812, 26.0: 465304, 27.0: 429702, 28.0: 397164, 29.0: 365820, 30.0: 341612, 31.0: 317972, 32.0: 296412, 33.0: 278846, 34.0: 260018, 35.0: 242534, 36.0: 229008, 37.0: 217184, 38.0: 204188, 39.0: 194820, 40.0: 182894, 41.0: 171650, 42.0: 164956, 43.0: 157132, 44.0: 148460, 45.0: 141670, 46.0: 134846, 47.0: 128466, 48.0: 122868, 49.0: 119666, 50.0: 112764, 51.0: 109170, 52.0: 103200, 53.0: 98200, 54.0: 92962, 55.0: 88518, 56.0: 85136, 57.0: 81792, 58.0: 79050, 59.0: 74932, 60.0: 72230, 61.0: 69010, 62.0: 66368, 63.0: 63720, 64.0: 61158, 65.0: 59158, 67.0: 58570, 66.0: 57312, 68.0: 53724, 69.0: 51494, 70.0: 49772, 71.0: 47318, 72.0: 46210, 73.0: 44154, 74.0: 42744, 75.0: 41710, 76.0: 39650, 77.0: 39058, 78.0: 36520, 79.0: 35238, 80.0: 34140, 81.0: 33956, 82.0: 32252, 83.0: 31226, 84.0: 30708, 85.0: 30256, 86.0: 28404, 87.0: 27666, 88.0: 26676, 89.0: 25490, 90.0: 24800, 91.0: 23952, 92.0: 23586, 93.0: 22664, 94.0: 21732, 95.0: 21390, 96.0: 20496, 97.0: 20220, 98.0: 19542, 99.0: 19116, 100.0: 18698, 101.0: 17750, 102.0: 17312, 103.0: 17000, 104.0: 15994, 106.0: 15806, 105.0: 15700, 107.0: 14760, 108.0: 14410, 109.0: 13980, 110.0: 13696, 111.0: 13230, 112.0: 12774, 113.0: 12490, 114.0: 12160, 115.0: 11702, 117.0: 11294, 116.0: 11244, 118.0: 11184, 120.0: 10806, 119.0: 10544, 121.0: 10114, 122.0: 9734, 123.0: 9374, 124.0: 9022, 125.0: 8814, 126.0: 8624, 127.0: 8284, 128.0: 8150, 129.0: 7710, 130.0: 7452, 131.0: 7410, 132.0: 7372, 133.0: 7066, 134.0: 6974, 135.0: 6768, 136.0: 6412, 137.0: 6276, 138.0: 6080, 141.0: 5832, 139.0: 5814, 140.0: 5752, 142.0: 5474, 143.0: 5422, 145.0: 5162, 144.0: 5112, 147.0: 4972, 146.0: 4876, 148.0: 4696, 149.0: 4604, 150.0: 4556, 152.0: 4260, 151.0: 4226, 153.0: 4072, 154.0: 4022, 156.0: 3958, 155.0: 3806, 157.0: 3752, 158.0: 3724, 159.0: 3552, 160.0: 3490, 161.0: 3342, 162.0: 3226, 163.0: 3080, 165.0: 2982, 164.0: 2956, 166.0: 2866, 168.0: 2808, 167.0: 2758, 169.0: 2668, 170.0: 2598, 171.0: 2516, 172.0: 2474, 173.0: 2310, 174.0: 2258, 175.0: 2254, 176.0: 2186, 177.0: 2108, 178.0: 2100, 179.0: 1978, 181.0: 1938, 180.0: 1934, 182.0: 1922, 183.0: 1836, 184.0: 1748, 186.0: 1702, 185.0: 1676, 187.0: 1572, 188.0: 1506, 190.0: 1476, 189.0: 1474, 191.0: 1464, 194.0: 1342, 192.0: 1324, 193.0: 1318, 195.0: 1298, 196.0: 1242, 199.0: 1176, 197.0: 1164, 198.0: 1110, 201.0: 1086, 200.0: 1080, 203.0: 1028, 202.0: 976, 205.0: 952, 204.0: 910, 206.0: 894, 207.0: 884, 210.0: 828, 209.0: 822, 208.0: 806, 211.0: 766, 213.0: 738, 217.0: 692, 212.0: 660, 215.0: 660, 214.0: 654, 218.0: 632, 216.0: 594, 219.0: 574, 220.0: 574, 221.0: 570, 222.0: 514, 223.0: 502, 224.0: 496, 227.0: 448, 225.0: 444, 228.0: 440, 229.0: 420, 230.0: 382, 234.0: 372, 226.0: 372, 232.0: 364, 231.0: 356, 236.0: 338, 233.0: 322, 237.0: 314, 235.0: 298, 240.0: 298, 239.0: 282, 241.0: 266, 238.0: 260, 244.0: 252, 243.0: 246, 245.0: 222, 242.0: 216, 248.0: 214, 246.0: 212, 250.0: 198, 247.0: 196, 249.0: 190, 253.0: 176, 257.0: 170, 258.0: 160, 252.0: 156, 254.0: 144, 255.0: 138, 251.0: 136, 259.0: 122, 256.0: 120, 262.0: 120, 261.0: 118, 263.0: 104, 260.0: 100, 264.0: 96, 266.0: 90, 272.0: 84, 269.0: 82, 275.0: 78, 286.0: 72, 277.0: 72, 267.0: 70, 270.0: 70, 268.0: 70, 276.0: 68, 279.0: 66, 284.0: 66, 282.0: 62, 271.0: 62, 292.0: 62, 265.0: 60, 290.0: 60, 280.0: 58, 283.0: 56, 293.0: 56, 278.0: 54, 285.0: 52, 281.0: 50, 274.0: 50, 291.0: 50, 287.0: 46, 273.0: 44, 294.0: 44, 289.0: 42, 295.0: 38, 296.0: 34, 300.0: 34, 288.0: 34, 301.0: 28, 297.0: 28, 302.0: 24, 298.0: 20, 304.0: 16, 308.0: 16, 309.0: 12, 306.0: 12, 310.0: 12, 303.0: 12, 299.0: 12, 307.0: 12, 312.0: 10, 305.0: 8, 322.0: 6, 319.0: 6, 321.0: 4, 318.0: 4, 348.0: 4, 311.0: 4, 332.0: 4, 325.0: 4, 326.0: 2, 324.0: 2, 317.0: 2, 327.0: 2, 330.0: 2, 334.0: 2, 313.0: 2, 331.0: 2, 320.0: 2, 343.0: 2})
428302826
Convert a graph into a bidirected graph: 33.744 seconds
Metis partitioning: 107.436 seconds
Split the graph: 12.123 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  153.5399353504181
16766
16197
16797
16032
16684
15921
16334
16651
16573
16176
15903
16537
total k batches seeds list generation spend  298.067321062088
after graph partition
graph partition algorithm spend time 301.6645691394806
16766
16197
16797
16032
16684
15921
16334
16651
16573
16176
15903
16537
partition_len_list
[247992, 180471, 288426, 303522, 319047, 335234, 330178, 348679, 417059, 265384, 436963, 388663]
REG selection method  spend 302.96424317359924
time for parepare:  0.3767688274383545
local_output_nid generation:  0.007803440093994141
local_in_edges_tensor generation:  0.0318148136138916
mini_batch_src_global generation:  0.0675971508026123
r_  generation:  0.6202025413513184
local_output_nid generation:  0.007635831832885742
local_in_edges_tensor generation:  0.02987957000732422
mini_batch_src_global generation:  0.08259153366088867
r_  generation:  0.6245419979095459
local_output_nid generation:  0.010043144226074219
local_in_edges_tensor generation:  0.03211045265197754
mini_batch_src_global generation:  0.08599376678466797
r_  generation:  0.7097623348236084
local_output_nid generation:  0.007157325744628906
local_in_edges_tensor generation:  0.028578758239746094
mini_batch_src_global generation:  0.08784198760986328
r_  generation:  0.7231690883636475
local_output_nid generation:  0.007628917694091797
local_in_edges_tensor generation:  0.026572704315185547
mini_batch_src_global generation:  0.11401700973510742
r_  generation:  0.9751379489898682
local_output_nid generation:  0.007290363311767578
local_in_edges_tensor generation:  0.01878046989440918
mini_batch_src_global generation:  0.08533215522766113
r_  generation:  0.6695766448974609
local_output_nid generation:  0.007303953170776367
local_in_edges_tensor generation:  0.01732158660888672
mini_batch_src_global generation:  0.07587909698486328
r_  generation:  0.6420876979827881
local_output_nid generation:  0.007454872131347656
local_in_edges_tensor generation:  0.021039724349975586
mini_batch_src_global generation:  0.11460041999816895
r_  generation:  0.9635694026947021
local_output_nid generation:  0.0074253082275390625
local_in_edges_tensor generation:  0.023033857345581055
mini_batch_src_global generation:  0.09999346733093262
r_  generation:  0.8857593536376953
local_output_nid generation:  0.0073909759521484375
local_in_edges_tensor generation:  0.022475242614746094
mini_batch_src_global generation:  0.09237241744995117
r_  generation:  0.7554044723510742
local_output_nid generation:  0.007230520248413086
local_in_edges_tensor generation:  0.01791238784790039
mini_batch_src_global generation:  0.0909569263458252
r_  generation:  0.8380706310272217
local_output_nid generation:  0.0074269771575927734
local_in_edges_tensor generation:  0.030794620513916016
mini_batch_src_global generation:  0.11474728584289551
r_  generation:  0.9459097385406494
----------------------check_connections_block total spend ----------------------------- 12.916015863418579
generate_one_block  1.487004280090332
generate_one_block  1.1266121864318848
generate_one_block  1.2949178218841553
generate_one_block  1.2595345973968506
generate_one_block  1.671271800994873
generate_one_block  1.1001255512237549
generate_one_block  1.0731110572814941
generate_one_block  1.6388905048370361
generate_one_block  1.6652607917785645
generate_one_block  1.5092616081237793
generate_one_block  1.400604486465454
generate_one_block  1.5460901260375977
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14616680145263672  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

connection checking time:  12.916015863418579
block generation total time  16.772684812545776
average batch blocks generation time:  1.3977237343788147
block dataloader generation time/epoch 337.67698521614074
pseudo mini batch 0 input nodes size: 247992
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10618209838867188  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10618209838867188  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.19856643676757812  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.19869136810302734  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09664440155029297  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1121683120727539  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1121683120727539  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16766, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.960078716278076  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 11.96301555633545  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.12838220596313477  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 1 input nodes size: 180471
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09717082977294922  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.09717082977294922  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16440153121948242  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.16452264785766602  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.07201337814331055  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.08774328231811523  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.08774328231811523  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16197, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.105667114257812  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 12.108503818511963  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.10305976867675781  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 2 input nodes size: 288426
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.07153940200805664  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.07153940200805664  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1789865493774414  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.17911195755004883  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11176013946533203  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13020992279052734  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13020992279052734  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16797, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 13.792065143585205  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 13.79500675201416  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1483774185180664  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 3 input nodes size: 303522
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11186504364013672  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11186504364013672  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.22493600845336914  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.22505569458007812  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11748313903808594  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13508129119873047  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.13508129119873047  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16032, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 13.493664264678955  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 13.49660587310791  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.15260553359985352  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

pseudo mini batch 4 input nodes size: 319047
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11734914779663086  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.11734914779663086  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.23620367050170898  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.236328125  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.1231374740600586  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14696788787841797  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2127685546875 GB
    Memory Allocated: 0.14696788787841797  GigaBytes
Max Memory Allocated: 18.895630836486816  GigaBytes

torch.Size([16684, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 18.16835641860962  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 18.171802043914795  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.1709752082824707  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 5 input nodes size: 335234
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12325191497802734  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12325191497802734  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.2481365203857422  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.24825525283813477  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12927627563476562  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.14490127563476562  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.14490127563476562  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([15921, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 11.676158905029297  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 11.67894697189331  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.1600189208984375  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 6 input nodes size: 330178
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12914228439331055  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12914228439331055  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.25214338302612305  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.25226545333862305  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.12726211547851562  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.14226055145263672  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.14226055145263672  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16334, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 11.304254531860352  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 11.307479858398438  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.1580190658569336  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 7 input nodes size: 348679
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.1273345947265625  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.1273345947265625  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.25722789764404297  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.257352352142334  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.13422918319702148  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.15616941452026367  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2459716796875 GB
    Memory Allocated: 0.15616941452026367  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16651, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 16.765017986297607  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 16.767934322357178  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.17822790145874023  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 8 input nodes size: 417059
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.13428497314453125  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.13428497314453125  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.28965187072753906  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.28977537155151367  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.1597576141357422  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.17819976806640625  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7655029296875 GB
    Memory Allocated: 0.17819976806640625  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16573, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 14.237399101257324  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 14.240301609039307  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.19669008255004883  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 9 input nodes size: 265384
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1597437858581543  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1597437858581543  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2586073875427246  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.25872802734375  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10323762893676758  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12079763412475586  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12079763412475586  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16176, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 13.51682996749878  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 13.519732475280762  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.13834857940673828  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 10 input nodes size: 436963
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10316801071166992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10316801071166992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.26594972610473633  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2660684585571289  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1670842170715332  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.18466615676879883  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.18466615676879883  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 13.620826244354248  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 13.623659133911133  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2028646469116211  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 11 input nodes size: 388663
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.16764116287231445  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.16764116287231445  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.31242942810058594  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.31255292892456055  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.14965248107910156  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.16967010498046875  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.16967010498046875  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16537, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 15.33114767074585  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 15.334280967712402  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1892561912536621  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1892561912536621  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1892561912536621  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13243279854456583 |0.027341941992441814 |5.913191696008046 |0.00018294652303059897 |10.67184023062388 |0.0193936824798584 |
----------------------------------------------------------pseudo_mini_loss sum 2.1629648208618164
Total (block generation + training)time/epoch 539.202056646347
Training time/epoch 201.8469159603119
Training time without block to device /epoch 201.5188126564026
Training time without total dataloading part /epoch 199.04197216033936
load block tensor time/epoch 1.58919358253479
block to device time/epoch 0.32810330390930176
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3861618
Number of first layer input nodes during this epoch:  3861618
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1892557144165039  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.580306053161621
global_2_local spend time (sec) 0.9182024002075195
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.3015921115875244
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1630982, 400: 15194, 77: 1190, 81: 1185, 79: 1185, 88: 1183, 84: 1177, 78: 1169, 75: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 131: 654, 137: 654, 139: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 208: 369, 195: 369, 196: 369, 194: 365, 198: 363, 204: 350, 209: 340, 203: 340, 197: 339, 200: 338, 207: 337, 202: 336, 206: 335, 201: 333, 213: 327, 214: 320, 211: 316, 224: 309, 231: 308, 216: 306, 215: 305, 219: 304, 205: 303, 218: 302, 210: 301, 221: 299, 228: 293, 212: 291, 217: 291, 225: 289, 222: 284, 220: 282, 223: 275, 226: 273, 233: 273, 230: 271, 239: 268, 227: 268, 244: 259, 238: 259, 249: 258, 234: 258, 237: 257, 229: 254, 240: 253, 235: 252, 246: 252, 232: 246, 236: 246, 247: 244, 241: 243, 245: 239, 242: 235, 257: 234, 243: 233, 250: 232, 255: 227, 2: 221, 248: 221, 252: 219, 264: 219, 254: 214, 259: 210, 267: 209, 268: 206, 251: 202, 258: 201, 253: 201, 266: 199, 260: 196, 269: 195, 273: 190, 265: 190, 263: 189, 270: 189, 278: 188, 277: 187, 262: 183, 282: 182, 261: 182, 276: 182, 274: 179, 256: 179, 272: 178, 285: 178, 271: 177, 280: 175, 299: 175, 284: 174, 1: 173, 290: 169, 291: 168, 295: 165, 303: 165, 287: 164, 279: 160, 315: 159, 286: 159, 288: 159, 298: 157, 294: 156, 300: 155, 292: 154, 297: 152, 283: 152, 301: 151, 302: 151, 289: 149, 305: 148, 293: 147, 306: 147, 281: 147, 275: 147, 312: 146, 307: 146, 311: 145, 316: 144, 313: 140, 310: 139, 296: 134, 304: 133, 309: 133, 318: 132, 314: 131, 320: 131, 308: 130, 319: 127, 332: 127, 326: 123, 342: 123, 328: 123, 321: 120, 323: 120, 322: 119, 333: 119, 317: 118, 344: 115, 340: 114, 351: 114, 327: 114, 324: 113, 331: 113, 336: 110, 325: 109, 355: 108, 349: 107, 329: 105, 341: 105, 365: 105, 345: 104, 353: 104, 330: 103, 339: 103, 338: 103, 359: 102, 357: 102, 334: 101, 381: 100, 378: 100, 362: 100, 383: 99, 380: 99, 337: 99, 348: 99, 371: 99, 360: 98, 356: 98, 350: 98, 370: 97, 354: 97, 363: 96, 343: 96, 372: 95, 385: 94, 335: 93, 374: 92, 376: 92, 352: 92, 347: 92, 373: 91, 361: 91, 375: 91, 368: 91, 366: 90, 346: 90, 393: 89, 369: 88, 364: 87, 384: 86, 377: 82, 386: 81, 390: 81, 398: 80, 395: 80, 387: 80, 397: 79, 392: 79, 389: 79, 358: 78, 382: 77, 367: 73, 379: 71, 394: 69, 388: 68, 391: 68, 399: 66, 396: 61})

A = g.adjacency_matrix() spent  0.44048213958740234
auxiliary_graph
Graph(num_nodes=1827553, num_edges=428602849,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8172171115875244
remove nodes length  1630982

auxiliary_graph.remove_nodes spent  21.22045922279358
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=428602849,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  17.410934925079346

the counter of shared neighbor distribution
Counter({1.0: 241202254, 2.0: 65553218, 3.0: 32161618, 4.0: 19323578, 5.0: 12934030, 6.0: 9266170, 7.0: 6924136, 8.0: 5382238, 9.0: 4276476, 10.0: 3479452, 11.0: 2874898, 12.0: 2416548, 13.0: 2064200, 14.0: 1766314, 15.0: 1529822, 16.0: 1337904, 17.0: 1177000, 18.0: 1042798, 19.0: 930574, 20.0: 831686, 21.0: 745510, 22.0: 671380, 23.0: 611250, 24.0: 555836, 25.0: 509700, 26.0: 464872, 27.0: 429920, 28.0: 397658, 29.0: 366074, 30.0: 341722, 31.0: 317416, 32.0: 296464, 33.0: 277954, 34.0: 260112, 35.0: 243598, 36.0: 229288, 37.0: 215590, 38.0: 204194, 39.0: 194938, 40.0: 182356, 41.0: 171970, 42.0: 165154, 43.0: 156694, 44.0: 149024, 45.0: 141884, 46.0: 134506, 47.0: 128216, 48.0: 122950, 49.0: 119948, 50.0: 112026, 51.0: 109124, 52.0: 103324, 53.0: 98708, 54.0: 93220, 55.0: 88496, 56.0: 85056, 57.0: 81678, 58.0: 78304, 59.0: 75220, 60.0: 72014, 61.0: 69102, 62.0: 66050, 63.0: 64234, 64.0: 61244, 65.0: 59412, 67.0: 58540, 66.0: 57270, 68.0: 53924, 69.0: 51166, 70.0: 49440, 71.0: 47648, 72.0: 45942, 73.0: 44260, 74.0: 42782, 75.0: 41766, 76.0: 39798, 77.0: 39268, 78.0: 36668, 79.0: 35270, 80.0: 34282, 81.0: 34044, 82.0: 32080, 83.0: 31202, 84.0: 30768, 85.0: 30154, 86.0: 28788, 87.0: 27642, 88.0: 26780, 89.0: 25284, 90.0: 24596, 91.0: 24082, 92.0: 23512, 93.0: 22644, 94.0: 21698, 95.0: 20990, 96.0: 20640, 97.0: 20276, 98.0: 19550, 99.0: 18880, 100.0: 18426, 102.0: 17748, 101.0: 17618, 103.0: 17100, 104.0: 16218, 105.0: 15768, 106.0: 15634, 107.0: 15020, 108.0: 14452, 109.0: 13958, 110.0: 13676, 111.0: 13276, 112.0: 12754, 113.0: 12602, 114.0: 12210, 115.0: 11676, 116.0: 11410, 117.0: 11310, 118.0: 11060, 120.0: 10722, 119.0: 10416, 121.0: 9950, 122.0: 9858, 123.0: 9424, 125.0: 8996, 124.0: 8974, 126.0: 8720, 127.0: 8402, 129.0: 7844, 128.0: 7824, 130.0: 7454, 132.0: 7426, 131.0: 7200, 133.0: 7024, 134.0: 7010, 135.0: 6978, 136.0: 6430, 137.0: 6304, 138.0: 6094, 141.0: 5954, 139.0: 5916, 140.0: 5714, 142.0: 5408, 143.0: 5292, 144.0: 5224, 145.0: 5030, 146.0: 4872, 147.0: 4864, 148.0: 4576, 149.0: 4442, 151.0: 4422, 150.0: 4398, 152.0: 4168, 153.0: 4114, 154.0: 4088, 156.0: 3986, 155.0: 3836, 157.0: 3812, 158.0: 3712, 161.0: 3496, 160.0: 3464, 159.0: 3462, 162.0: 3248, 163.0: 3092, 165.0: 2994, 164.0: 2964, 166.0: 2860, 167.0: 2788, 168.0: 2770, 170.0: 2578, 169.0: 2570, 171.0: 2526, 172.0: 2484, 174.0: 2344, 173.0: 2256, 175.0: 2238, 176.0: 2232, 177.0: 2180, 178.0: 2034, 179.0: 2032, 181.0: 1934, 180.0: 1908, 183.0: 1850, 182.0: 1802, 184.0: 1788, 186.0: 1730, 185.0: 1574, 187.0: 1544, 188.0: 1540, 190.0: 1496, 191.0: 1484, 189.0: 1446, 194.0: 1368, 192.0: 1350, 193.0: 1278, 195.0: 1198, 199.0: 1182, 196.0: 1178, 197.0: 1176, 200.0: 1166, 198.0: 1120, 201.0: 1106, 203.0: 992, 204.0: 972, 202.0: 950, 206.0: 944, 205.0: 936, 207.0: 878, 208.0: 858, 209.0: 830, 211.0: 754, 210.0: 720, 213.0: 718, 216.0: 688, 215.0: 686, 212.0: 684, 214.0: 676, 217.0: 652, 218.0: 630, 219.0: 574, 221.0: 534, 220.0: 520, 223.0: 514, 222.0: 496, 229.0: 490, 224.0: 480, 225.0: 458, 226.0: 408, 228.0: 408, 234.0: 404, 227.0: 402, 230.0: 376, 233.0: 346, 231.0: 346, 236.0: 344, 238.0: 316, 232.0: 312, 237.0: 290, 235.0: 288, 239.0: 284, 241.0: 274, 240.0: 248, 243.0: 248, 244.0: 244, 246.0: 240, 242.0: 226, 247.0: 210, 251.0: 204, 245.0: 204, 248.0: 186, 249.0: 184, 250.0: 180, 253.0: 172, 254.0: 170, 252.0: 162, 257.0: 144, 258.0: 138, 259.0: 126, 255.0: 126, 256.0: 122, 261.0: 108, 262.0: 106, 264.0: 98, 268.0: 98, 263.0: 92, 265.0: 88, 269.0: 86, 260.0: 86, 272.0: 82, 267.0: 74, 274.0: 74, 270.0: 72, 266.0: 68, 275.0: 66, 286.0: 66, 271.0: 64, 281.0: 64, 276.0: 64, 283.0: 62, 280.0: 60, 277.0: 58, 278.0: 56, 279.0: 56, 289.0: 56, 288.0: 56, 284.0: 56, 287.0: 54, 292.0: 54, 290.0: 54, 282.0: 54, 285.0: 52, 273.0: 52, 295.0: 42, 291.0: 38, 294.0: 38, 296.0: 34, 302.0: 34, 293.0: 34, 299.0: 30, 297.0: 24, 300.0: 24, 298.0: 22, 301.0: 20, 303.0: 20, 305.0: 14, 308.0: 14, 309.0: 12, 310.0: 12, 304.0: 12, 312.0: 10, 306.0: 10, 307.0: 10, 325.0: 6, 317.0: 6, 315.0: 4, 318.0: 4, 322.0: 4, 319.0: 4, 332.0: 4, 314.0: 4, 323.0: 4, 311.0: 2, 324.0: 2, 329.0: 2, 349.0: 2, 331.0: 2, 321.0: 2, 347.0: 2, 343.0: 2, 334.0: 2, 313.0: 2})
428406278
Convert a graph into a bidirected graph: 36.100 seconds
Metis partitioning: 110.003 seconds
Split the graph: 12.320 seconds
Construct subgraphs: 0.057 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  158.65182375907898
16702
15903
16755
16021
16869
16804
16625
15903
16721
15903
16231
16134
total k batches seeds list generation spend  302.97050166130066
after graph partition
graph partition algorithm spend time 306.6232981681824
16702
15903
16755
16021
16869
16804
16625
15903
16721
15903
16231
16134
partition_len_list
[302359, 314587, 293389, 167487, 275575, 234892, 352645, 460164, 310317, 313475, 406557, 272203]
REG selection method  spend 307.96754932403564
time for parepare:  0.40468907356262207
local_output_nid generation:  0.007599830627441406
local_in_edges_tensor generation:  0.05559492111206055
mini_batch_src_global generation:  0.09427976608276367
r_  generation:  0.7844388484954834
local_output_nid generation:  0.010004758834838867
local_in_edges_tensor generation:  0.03985428810119629
mini_batch_src_global generation:  0.08602523803710938
r_  generation:  0.63043212890625
local_output_nid generation:  0.007366180419921875
local_in_edges_tensor generation:  0.05505681037902832
mini_batch_src_global generation:  0.11254048347473145
r_  generation:  0.8782343864440918
local_output_nid generation:  0.007110595703125
local_in_edges_tensor generation:  0.021079540252685547
mini_batch_src_global generation:  0.08631110191345215
r_  generation:  0.6174614429473877
local_output_nid generation:  0.007390260696411133
local_in_edges_tensor generation:  0.026337862014770508
mini_batch_src_global generation:  0.08847427368164062
r_  generation:  0.6859116554260254
local_output_nid generation:  0.0073778629302978516
local_in_edges_tensor generation:  0.021956920623779297
mini_batch_src_global generation:  0.09490513801574707
r_  generation:  0.6968624591827393
local_output_nid generation:  0.007365226745605469
local_in_edges_tensor generation:  0.017915725708007812
mini_batch_src_global generation:  0.08696770668029785
r_  generation:  0.7047195434570312
local_output_nid generation:  0.0071637630462646484
local_in_edges_tensor generation:  0.03252220153808594
mini_batch_src_global generation:  0.11478042602539062
r_  generation:  1.0803487300872803
local_output_nid generation:  0.00738525390625
local_in_edges_tensor generation:  0.017587900161743164
mini_batch_src_global generation:  0.08638739585876465
r_  generation:  0.6428329944610596
local_output_nid generation:  0.007116079330444336
local_in_edges_tensor generation:  0.018607378005981445
mini_batch_src_global generation:  0.1059715747833252
r_  generation:  0.8390777111053467
local_output_nid generation:  0.007234811782836914
local_in_edges_tensor generation:  0.03459334373474121
mini_batch_src_global generation:  0.1034841537475586
r_  generation:  0.8889007568359375
local_output_nid generation:  0.0071103572845458984
local_in_edges_tensor generation:  0.01926398277282715
mini_batch_src_global generation:  0.11751270294189453
r_  generation:  0.8846383094787598
----------------------check_connections_block total spend ----------------------------- 13.06444525718689
generate_one_block  1.8528697490692139
generate_one_block  1.1971774101257324
generate_one_block  1.5730986595153809
generate_one_block  1.0323874950408936
generate_one_block  1.2056210041046143
generate_one_block  1.23048996925354
generate_one_block  1.1955029964447021
generate_one_block  1.8838279247283936
generate_one_block  1.1413977146148682
generate_one_block  1.5428462028503418
generate_one_block  1.6752393245697021
generate_one_block  1.5192761421203613
----------===============-------------===============-------------the number of batches *****---- 12

original number of batches:  12
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1892557144165039  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

connection checking time:  13.06444525718689
block generation total time  17.049734592437744
average batch blocks generation time:  1.4208112160364788
block dataloader generation time/epoch 339.0465661287308
pseudo mini batch 0 input nodes size: 302359
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.14915800094604492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.14915800094604492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2617955207824707  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2619199752807617  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11700820922851562  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1376180648803711  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1376180648803711  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16702, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 15.74344778060913  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 15.74674654006958  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.15831995010375977  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 1 input nodes size: 314587
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11703777313232422  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11703777313232422  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.23423099517822266  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.23434972763061523  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12158775329589844  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.13711071014404297  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.13711071014404297  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.975896835327148  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.978682041168213  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.15265560150146484  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 2 input nodes size: 293389
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12144804000854492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12144804000854492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2307443618774414  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.23086929321289062  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11355733871459961  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.13598299026489258  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.13598299026489258  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16755, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 17.19950580596924  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 17.20244026184082  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.15862035751342773  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 3 input nodes size: 167487
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11370658874511719  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.11370658874511719  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1761007308959961  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.17622041702270508  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.06679916381835938  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.082244873046875  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.082244873046875  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16021, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.807805061340332  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.810739517211914  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.09847211837768555  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 4 input nodes size: 275575
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.06734132766723633  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.06734132766723633  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.17000102996826172  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.17012691497802734  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10761308670043945  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1232600212097168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1232600212097168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16869, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 12.054629802703857  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 12.058106422424316  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1388559341430664  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 5 input nodes size: 234892
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10709095001220703  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10709095001220703  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1945953369140625  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.19472074508666992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.0919351577758789  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10822582244873047  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.10822582244873047  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16804, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 12.511218547821045  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 12.514161586761475  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.12456798553466797  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 6 input nodes size: 352645
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.09192371368408203  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.09192371368408203  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.22329425811767578  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.2234182357788086  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1357884407043457  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.15111112594604492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.15111112594604492  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16625, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.783595561981201  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 11.78653860092163  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.16676664352416992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 7 input nodes size: 460164
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1357569694519043  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.1357569694519043  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.30718183517456055  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.3073005676269531  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.17580604553222656  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.19855308532714844  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3123779296875 GB
    Memory Allocated: 0.19855308532714844  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 17.415137767791748  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 17.418049335479736  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.22156476974487305  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 8 input nodes size: 310317
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1760110855102539  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1760110855102539  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.2916135787963867  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.29173851013183594  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12019491195678711  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.13430261611938477  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.13430261611938477  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16721, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 10.853532314300537  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 10.856648921966553  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1482844352722168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 9 input nodes size: 313475
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12000656127929688  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12000656127929688  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.2367854118347168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.23690414428710938  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12117671966552734  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.14107084274291992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.14107084274291992  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([15903, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 14.562805652618408  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 14.565733909606934  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.16117238998413086  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 10 input nodes size: 406557
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12168741226196289  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.12168741226196289  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.27314186096191406  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.27326297760009766  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.15636539459228516  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.17515945434570312  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.17515945434570312  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16231, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 14.412703037261963  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 14.416141986846924  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1941547393798828  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

pseudo mini batch 11 input nodes size: 272203
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.15576887130737305  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.15576887130737305  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.2571725845336914  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.2572932243347168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.10571765899658203  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1264338493347168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.1264338493347168  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

torch.Size([16134, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 15.382171630859375  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 15.385014057159424  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.14664506912231445  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.14664506912231445  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.9725341796875 GB
    Memory Allocated: 0.14664506912231445  GigaBytes
Max Memory Allocated: 19.598477363586426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1340018113454183 |0.026736597220102947 |5.625974694887797 |0.00017432371775309244 |10.618819952011108 |0.017663240432739258 |
----------------------------------------------------------pseudo_mini_loss sum 1.8093459606170654
Total (block generation + training)time/epoch 539.943371852239
Training time/epoch 197.755056142807
Training time without block to device /epoch 197.43421697616577
Training time without total dataloading part /epoch 194.95729088783264
load block tensor time/epoch 1.6080217361450195
block to device time/epoch 0.32083916664123535
input features size transfer per epoch 1.6093254089355469e-06
blocks size to device per epoch 1.0728836059570312e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3703650
Number of first layer input nodes during this epoch:  3703650
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
