main start at this time 1656300677.0324936
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.0316669940948486
global_2_local spend time (sec) 0.6303613185882568
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.24315142631530762
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1567943, 200: 49189, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 94: 1069, 74: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 58: 957, 100: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 123: 741, 36: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 131: 654, 139: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 195: 369, 196: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.3560335636138916
auxiliary_graph
Graph(num_nodes=1764514, num_edges=376053513,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8183896541595459
remove nodes length  1567943

auxiliary_graph.remove_nodes spent  21.97212028503418
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376053513,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  16.910141229629517

the counter of shared neighbor distribution
Counter({1.0: 218053246, 2.0: 58319084, 3.0: 28180506, 4.0: 16675126, 5.0: 11015610, 6.0: 7786438, 7.0: 5754194, 8.0: 4414366, 9.0: 3476900, 10.0: 2795830, 11.0: 2289366, 12.0: 1906458, 13.0: 1611830, 14.0: 1365990, 15.0: 1172656, 16.0: 1014834, 17.0: 884656, 18.0: 777954, 19.0: 684940, 20.0: 608090, 21.0: 541200, 22.0: 481174, 23.0: 431924, 24.0: 389850, 25.0: 354810, 26.0: 321942, 27.0: 293026, 28.0: 270702, 29.0: 247274, 30.0: 227940, 31.0: 209434, 32.0: 195254, 33.0: 181740, 34.0: 167998, 35.0: 156878, 36.0: 146360, 37.0: 136394, 38.0: 127534, 39.0: 120390, 40.0: 111054, 41.0: 104066, 42.0: 99738, 43.0: 93980, 44.0: 88768, 45.0: 84272, 46.0: 78558, 47.0: 74180, 48.0: 70504, 49.0: 69772, 50.0: 63986, 51.0: 62926, 52.0: 57672, 53.0: 54102, 54.0: 49904, 55.0: 46972, 56.0: 44724, 57.0: 42296, 58.0: 39990, 59.0: 37500, 60.0: 35836, 61.0: 33708, 62.0: 32556, 63.0: 30286, 64.0: 28664, 67.0: 28212, 65.0: 27534, 66.0: 26030, 68.0: 23986, 69.0: 22748, 70.0: 21044, 71.0: 19846, 72.0: 19396, 73.0: 17856, 74.0: 17126, 75.0: 16382, 76.0: 15684, 77.0: 15210, 78.0: 13644, 79.0: 12918, 80.0: 12594, 81.0: 12356, 82.0: 11284, 85.0: 10674, 84.0: 10572, 83.0: 10328, 86.0: 9262, 87.0: 8580, 88.0: 8446, 89.0: 7794, 90.0: 7514, 91.0: 7172, 92.0: 6866, 93.0: 6620, 94.0: 5990, 95.0: 5908, 97.0: 5576, 96.0: 5168, 98.0: 5034, 100.0: 4698, 99.0: 4646, 101.0: 4318, 103.0: 3940, 102.0: 3880, 104.0: 3422, 105.0: 3298, 106.0: 3138, 107.0: 2886, 108.0: 2724, 109.0: 2662, 110.0: 2422, 111.0: 2270, 112.0: 2134, 113.0: 2026, 114.0: 1892, 120.0: 1742, 115.0: 1736, 117.0: 1564, 116.0: 1534, 118.0: 1378, 119.0: 1318, 122.0: 1140, 121.0: 1084, 123.0: 940, 124.0: 918, 126.0: 832, 127.0: 746, 125.0: 734, 129.0: 618, 128.0: 600, 130.0: 594, 131.0: 572, 132.0: 552, 134.0: 482, 133.0: 458, 135.0: 418, 136.0: 376, 141.0: 326, 137.0: 320, 138.0: 316, 139.0: 294, 140.0: 294, 142.0: 276, 143.0: 236, 146.0: 204, 149.0: 198, 145.0: 196, 144.0: 194, 147.0: 182, 150.0: 180, 151.0: 162, 148.0: 160, 152.0: 146, 154.0: 142, 153.0: 138, 156.0: 102, 157.0: 102, 160.0: 94, 158.0: 90, 155.0: 88, 159.0: 82, 161.0: 64, 162.0: 64, 163.0: 58, 164.0: 56, 166.0: 36, 167.0: 34, 165.0: 26, 169.0: 24, 168.0: 20, 170.0: 16, 178.0: 8, 172.0: 8, 174.0: 8, 171.0: 6, 176.0: 6, 175.0: 6, 173.0: 6, 177.0: 6, 179.0: 4, 182.0: 2, 181.0: 2, 180.0: 2})
375856942
Convert a graph into a bidirected graph: 30.974 seconds
Metis partitioning: 85.968 seconds
Split the graph: 14.371 seconds
Construct subgraphs: 3.577 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  135.02908205986023
21204
21211
21492
22311
22369
22473
22145
21439
21927
total k batches seeds list generation spend  258.8487515449524
after graph partition
graph partition algorithm spend time 261.83311772346497
21204
21211
21492
22311
22369
22473
22145
21439
21927
partition_len_list
[326465, 339407, 306594, 297387, 377318, 367861, 410358, 448724, 301073]
REG selection method  spend 262.8190495967865
time for parepare:  0.3879578113555908
local_output_nid generation:  0.006181001663208008
local_in_edges_tensor generation:  0.02823472023010254
mini_batch_src_global generation:  0.09419798851013184
r_  generation:  0.8145492076873779
local_output_nid generation:  0.00626826286315918
local_in_edges_tensor generation:  0.05950808525085449
mini_batch_src_global generation:  0.10563278198242188
r_  generation:  0.7393443584442139
local_output_nid generation:  0.0074994564056396484
local_in_edges_tensor generation:  0.060890913009643555
mini_batch_src_global generation:  0.09295010566711426
r_  generation:  0.7266600131988525
local_output_nid generation:  0.006339073181152344
local_in_edges_tensor generation:  0.06802248954772949
mini_batch_src_global generation:  0.09405517578125
r_  generation:  0.8215351104736328
local_output_nid generation:  0.0063092708587646484
local_in_edges_tensor generation:  0.09607839584350586
mini_batch_src_global generation:  0.09460687637329102
r_  generation:  0.8550028800964355
local_output_nid generation:  0.009404659271240234
local_in_edges_tensor generation:  0.07621169090270996
mini_batch_src_global generation:  0.11755061149597168
r_  generation:  1.0840842723846436
local_output_nid generation:  0.006300210952758789
local_in_edges_tensor generation:  0.04423642158508301
mini_batch_src_global generation:  0.1119546890258789
r_  generation:  1.0262434482574463
local_output_nid generation:  0.006110191345214844
local_in_edges_tensor generation:  0.035605430603027344
mini_batch_src_global generation:  0.11581158638000488
r_  generation:  1.0070617198944092
local_output_nid generation:  0.0062558650970458984
local_in_edges_tensor generation:  0.027250289916992188
mini_batch_src_global generation:  0.10873246192932129
r_  generation:  0.9053549766540527
----------------------check_connections_block total spend ----------------------------- 11.315486192703247
generate_one_block  3.7519192695617676
generate_one_block  1.026158094406128
generate_one_block  1.0395514965057373
generate_one_block  1.0404067039489746
generate_one_block  1.1295137405395508
generate_one_block  1.5459449291229248
generate_one_block  1.3459546566009521
generate_one_block  1.3869895935058594
generate_one_block  1.2160062789916992
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  11.315486192703247
block generation total time  13.482444763183594
average batch blocks generation time:  1.4980494181315105
block dataloader generation time/epoch 290.0340974330902
pseudo mini batch 0 input nodes size: 326465
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.12195539474487305  GigaBytes
Max Memory Allocated: 0.12195539474487305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.12211370468139648  GigaBytes
Max Memory Allocated: 0.12211370468139648  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1405029296875 GB
    Memory Allocated: 0.12211370468139648  GigaBytes
Max Memory Allocated: 0.12211370468139648  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.14283037185668945  GigaBytes
Max Memory Allocated: 0.14283037185668945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2283935546875 GB
    Memory Allocated: 0.14283037185668945  GigaBytes
Max Memory Allocated: 0.14283037185668945  GigaBytes

torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 15.964447021484375  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 15.968966007232666  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.1681513786315918  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

pseudo mini batch 1 input nodes size: 339407
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.12663888931274414  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.12663888931274414  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.25307798385620117  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.2532362937927246  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.13146018981933594  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.14879703521728516  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.14879703521728516  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

torch.Size([21211, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 13.357470989227295  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 13.361185550689697  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.1657404899597168  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

pseudo mini batch 2 input nodes size: 306594
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.13098764419555664  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.13098764419555664  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.24520301818847656  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.2453632354736328  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.11876583099365234  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.13631772994995117  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7186279296875 GB
    Memory Allocated: 0.13631772994995117  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

torch.Size([21492, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 13.304358959197998  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 13.308122634887695  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.15388774871826172  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

pseudo mini batch 3 input nodes size: 297387
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.11881494522094727  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.11881494522094727  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.2296004295349121  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.229766845703125  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.11539125442504883  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.13293027877807617  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.13293027877807617  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

torch.Size([22311, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 13.43701696395874  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 13.441376209259033  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.1506962776184082  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

pseudo mini batch 4 input nodes size: 377318
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.11553478240966797  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.11553478240966797  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.25609683990478516  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.25626373291015625  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.14531183242797852  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.16341447830200195  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3807373046875 GB
    Memory Allocated: 0.16341447830200195  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

torch.Size([22369, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 13.823853015899658  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 13.827770233154297  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.1816105842590332  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

pseudo mini batch 5 input nodes size: 367861
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.14532184600830078  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.14532184600830078  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.2823610305786133  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.2825288772583008  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.1417999267578125  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.1652374267578125  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7830810546875 GB
    Memory Allocated: 0.1652374267578125  GigaBytes
Max Memory Allocated: 17.462158679962158  GigaBytes

torch.Size([22473, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 17.73351812362671  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 17.73745346069336  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1892385482788086  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 6 input nodes size: 410358
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.14227962493896484  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.14227962493896484  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.2951502799987793  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.2953157424926758  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15810871124267578  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.17838382720947266  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.17838382720947266  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([22145, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 15.479179382324219  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 15.48380708694458  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.19822311401367188  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 7 input nodes size: 448724
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15758991241455078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15758991241455078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.3247528076171875  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.32491254806518555  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1718764305114746  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.19250249862670898  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.19250249862670898  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([21439, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 15.78284502029419  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 15.786723136901855  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.21308517456054688  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 8 input nodes size: 301073
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1717529296875  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1717529296875  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.28391170501708984  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.2840752601623535  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.11675262451171875  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1362314224243164  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1362314224243164  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([21927, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 14.854076862335205  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 14.858575820922852  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15587759017944336  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15655279159545898  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15655279159545898  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0797784063551161 |0.055226114061143666 |1.671694040298462 |0.00021041764153374566 |2.6591917673746743 |0.02973318099975586 |
----------------------------------------------------------pseudo_mini_loss sum 4.7931013107299805
Total (block generation + training)time/epoch 330.5195918083191
Training time/epoch 40.485207319259644
Training time without block to device /epoch 39.98817229270935
Training time without total dataloading part /epoch 39.00959920883179
load block tensor time/epoch 0.7180056571960449
block to device time/epoch 0.49703502655029297
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3175187
Number of first layer input nodes during this epoch:  3175187
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15655231475830078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.138904333114624
global_2_local spend time (sec) 0.634749174118042
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.2460494041442871
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1568046, 200: 49189, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 94: 1069, 74: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 62: 959, 52: 959, 48: 958, 58: 957, 100: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 15: 673, 145: 673, 25: 671, 26: 659, 7: 655, 131: 654, 139: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 195: 369, 196: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.35039710998535156
auxiliary_graph
Graph(num_nodes=1764617, num_edges=376145881,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8007621765136719
remove nodes length  1568046

auxiliary_graph.remove_nodes spent  19.698253631591797
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376145881,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  15.360832214355469

the counter of shared neighbor distribution
Counter({1.0: 218107298, 2.0: 58333416, 3.0: 28186388, 4.0: 16683124, 5.0: 11017110, 6.0: 7788074, 7.0: 5758758, 8.0: 4417922, 9.0: 3477766, 10.0: 2798854, 11.0: 2290994, 12.0: 1905200, 13.0: 1611400, 14.0: 1363990, 15.0: 1173904, 16.0: 1012760, 17.0: 886322, 18.0: 777492, 19.0: 685820, 20.0: 607038, 21.0: 540476, 22.0: 480636, 23.0: 432036, 24.0: 390940, 25.0: 355934, 26.0: 321754, 27.0: 293886, 28.0: 269538, 29.0: 246524, 30.0: 227154, 31.0: 209268, 32.0: 194672, 33.0: 181200, 34.0: 167284, 35.0: 155658, 36.0: 145856, 37.0: 136708, 38.0: 126894, 39.0: 120812, 40.0: 111504, 41.0: 104782, 42.0: 99870, 43.0: 93900, 44.0: 88012, 45.0: 83976, 46.0: 79570, 47.0: 74398, 48.0: 70632, 49.0: 70000, 50.0: 63884, 51.0: 62724, 52.0: 57670, 53.0: 53600, 54.0: 50128, 55.0: 47020, 56.0: 44826, 57.0: 42352, 58.0: 40270, 59.0: 37368, 60.0: 35990, 61.0: 33818, 62.0: 32652, 63.0: 30500, 64.0: 28524, 67.0: 28430, 65.0: 27690, 66.0: 25868, 68.0: 23892, 69.0: 22680, 70.0: 21230, 71.0: 19832, 72.0: 19306, 73.0: 17866, 74.0: 17032, 75.0: 16306, 76.0: 15682, 77.0: 15354, 78.0: 13594, 79.0: 13108, 80.0: 12552, 81.0: 12034, 82.0: 10920, 85.0: 10708, 83.0: 10420, 84.0: 10416, 86.0: 9088, 88.0: 8710, 87.0: 8588, 89.0: 7718, 90.0: 7462, 91.0: 7060, 92.0: 6668, 93.0: 6528, 94.0: 6112, 95.0: 5812, 96.0: 5470, 97.0: 5442, 98.0: 4964, 99.0: 4782, 100.0: 4602, 101.0: 4282, 102.0: 4072, 103.0: 3866, 104.0: 3394, 105.0: 3344, 106.0: 3206, 107.0: 2900, 108.0: 2752, 109.0: 2656, 110.0: 2408, 111.0: 2262, 112.0: 2106, 113.0: 2012, 114.0: 1952, 115.0: 1720, 120.0: 1712, 116.0: 1570, 117.0: 1520, 119.0: 1378, 118.0: 1376, 122.0: 1060, 121.0: 1026, 123.0: 988, 124.0: 958, 126.0: 830, 125.0: 784, 127.0: 780, 129.0: 684, 128.0: 608, 130.0: 566, 131.0: 564, 132.0: 500, 133.0: 492, 135.0: 440, 134.0: 424, 136.0: 394, 137.0: 338, 138.0: 324, 139.0: 310, 140.0: 306, 141.0: 274, 142.0: 264, 144.0: 252, 143.0: 206, 145.0: 194, 149.0: 188, 146.0: 188, 147.0: 186, 150.0: 178, 148.0: 172, 153.0: 142, 151.0: 142, 152.0: 126, 155.0: 124, 157.0: 120, 158.0: 112, 154.0: 110, 156.0: 96, 160.0: 80, 159.0: 70, 162.0: 68, 161.0: 64, 166.0: 44, 163.0: 44, 164.0: 42, 165.0: 40, 168.0: 38, 167.0: 32, 170.0: 16, 178.0: 16, 169.0: 14, 171.0: 10, 173.0: 6, 172.0: 6, 174.0: 6, 175.0: 6, 181.0: 4, 180.0: 2, 176.0: 2, 179.0: 2, 182.0: 2, 177.0: 2})
375949310
Convert a graph into a bidirected graph: 31.027 seconds
Metis partitioning: 84.710 seconds
Split the graph: 13.324 seconds
Construct subgraphs: 0.038 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  129.23857235908508
21392
21224
21577
22486
22466
22327
21204
21547
22348
total k batches seeds list generation spend  247.50089025497437
after graph partition
graph partition algorithm spend time 250.63262581825256
21392
21224
21577
22486
22466
22327
21204
21547
22348
partition_len_list
[338297, 332253, 292438, 302469, 354155, 370227, 428044, 440904, 300678]
REG selection method  spend 251.61252236366272
time for parepare:  0.3841431140899658
local_output_nid generation:  0.007090330123901367
local_in_edges_tensor generation:  0.020385026931762695
mini_batch_src_global generation:  0.09142374992370605
r_  generation:  0.8582375049591064
local_output_nid generation:  0.006896018981933594
local_in_edges_tensor generation:  0.02415299415588379
mini_batch_src_global generation:  0.09470605850219727
r_  generation:  0.7446005344390869
local_output_nid generation:  0.007050275802612305
local_in_edges_tensor generation:  0.025620222091674805
mini_batch_src_global generation:  0.08866667747497559
r_  generation:  0.7855253219604492
local_output_nid generation:  0.008616209030151367
local_in_edges_tensor generation:  0.04404401779174805
mini_batch_src_global generation:  0.10197925567626953
r_  generation:  0.8310308456420898
local_output_nid generation:  0.00726318359375
local_in_edges_tensor generation:  0.05407595634460449
mini_batch_src_global generation:  0.09031128883361816
r_  generation:  0.8248064517974854
local_output_nid generation:  0.007294178009033203
local_in_edges_tensor generation:  0.0574946403503418
mini_batch_src_global generation:  0.11939883232116699
r_  generation:  1.207942247390747
local_output_nid generation:  0.009872913360595703
local_in_edges_tensor generation:  0.06225180625915527
mini_batch_src_global generation:  0.11292719841003418
r_  generation:  1.0342817306518555
local_output_nid generation:  0.0070612430572509766
local_in_edges_tensor generation:  0.051967620849609375
mini_batch_src_global generation:  0.11254310607910156
r_  generation:  1.0514931678771973
local_output_nid generation:  0.007158517837524414
local_in_edges_tensor generation:  0.027167081832885742
mini_batch_src_global generation:  0.11704468727111816
r_  generation:  0.9171361923217773
----------------------check_connections_block total spend ----------------------------- 11.440587520599365
generate_one_block  1.8029005527496338
generate_one_block  1.2079548835754395
generate_one_block  1.2802801132202148
generate_one_block  1.3215208053588867
generate_one_block  1.2522380352020264
generate_one_block  1.595705509185791
generate_one_block  1.3810615539550781
generate_one_block  1.4494397640228271
generate_one_block  1.226926326751709
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15655231475830078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

connection checking time:  11.440587520599365
block generation total time  12.518027544021606
average batch blocks generation time:  1.3908919493357341
block dataloader generation time/epoch 284.54551589488983
pseudo mini batch 0 input nodes size: 338297
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.11751222610473633  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.11751222610473633  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.24353790283203125  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.2436976432800293  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.13137531280517578  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15227222442626953  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.15227222442626953  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([21392, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 16.03743553161621  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 16.04127597808838  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1731562614440918  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 1 input nodes size: 332253
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.13128232955932617  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.13128232955932617  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.25505638122558594  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.2552146911621094  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.1290292739868164  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.14632034301757812  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.14632034301757812  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([21224, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 13.288692951202393  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 13.292438983917236  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.16366147994995117  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 2 input nodes size: 292438
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.12900018692016602  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.12900018692016602  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.23794221878051758  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.23810338973999023  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.11417102813720703  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.13171768188476562  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6209716796875 GB
    Memory Allocated: 0.13171768188476562  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([21577, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 13.55169677734375  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 13.555475234985352  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.14940643310546875  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 3 input nodes size: 302469
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.11423254013061523  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.11423254013061523  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.22691106796264648  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.22707891464233398  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.11797571182250977  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1357111930847168  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1357111930847168  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([22486, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 13.553910255432129  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 13.558350563049316  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.15368986129760742  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 4 input nodes size: 354155
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.11813497543334961  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.11813497543334961  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.25006818771362305  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.25023603439331055  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1373896598815918  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.15415430068969727  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.15415430068969727  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([22466, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 12.831103324890137  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 12.835041046142578  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.17118358612060547  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

pseudo mini batch 5 input nodes size: 370227
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.13757038116455078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.13757038116455078  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.27549076080322266  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.27565717697143555  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1435561180114746  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1674332618713379  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.1674332618713379  GigaBytes
Max Memory Allocated: 19.446961402893066  GigaBytes

torch.Size([22327, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 18.16417407989502  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 18.16829252243042  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.19118547439575195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 6 input nodes size: 428044
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14334774017333984  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14334774017333984  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.3028068542480469  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.3029651641845703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.16487836837768555  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.18506669998168945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.18506669998168945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 15.437539100646973  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 15.441449165344238  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.20606184005737305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 7 input nodes size: 440904
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.16560602188110352  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.16560602188110352  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.32985591888427734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.3300166130065918  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.17039918899536133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.19135236740112305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.19135236740112305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21547, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 15.996017456054688  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 15.999976634979248  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.21152162551879883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 8 input nodes size: 300678
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.16953468322753906  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.16953468322753906  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.28154611587524414  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.28171300888061523  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.11730241775512695  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1368088722229004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1368088722229004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22348, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 14.948742389678955  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 14.953603267669678  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1574864387512207  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1574864387512207  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1574864387512207  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08041299713982476 |0.0187022156185574 |1.7756048573387995 |0.0001827081044514974 |2.674980799357096 |0.015272855758666992 |
----------------------------------------------------------pseudo_mini_loss sum 4.1734819412231445
Total (block generation + training)time/epoch 325.3946578502655
Training time/epoch 41.21252799034119
Training time without block to device /epoch 41.04420804977417
Training time without total dataloading part /epoch 40.07218813896179
load block tensor time/epoch 0.7237169742584229
block to device time/epoch 0.1683199405670166
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3159465
Number of first layer input nodes during this epoch:  3159465
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1574859619140625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1710546016693115
global_2_local spend time (sec) 0.6621336936950684
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.251615047454834
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1567909, 200: 49189, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 123: 741, 36: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 137: 654, 139: 654, 131: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 157: 577, 151: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 181: 435, 173: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 195: 369, 196: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.3568551540374756
auxiliary_graph
Graph(num_nodes=1764480, num_edges=376089015,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8444476127624512
remove nodes length  1567909

auxiliary_graph.remove_nodes spent  19.71231698989868
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376089015,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  16.0624361038208

the counter of shared neighbor distribution
Counter({1.0: 218119618, 2.0: 58339776, 3.0: 28175844, 4.0: 16670090, 5.0: 11003734, 6.0: 7782318, 7.0: 5750812, 8.0: 4412162, 9.0: 3467994, 10.0: 2796670, 11.0: 2290454, 12.0: 1905556, 13.0: 1611834, 14.0: 1361954, 15.0: 1173346, 16.0: 1013534, 17.0: 883368, 18.0: 777872, 19.0: 685612, 20.0: 606460, 21.0: 540624, 22.0: 480750, 23.0: 432186, 24.0: 389226, 25.0: 355012, 26.0: 320810, 27.0: 293416, 28.0: 269428, 29.0: 245924, 30.0: 228188, 31.0: 209484, 32.0: 194798, 33.0: 181532, 34.0: 167278, 35.0: 156770, 36.0: 146398, 37.0: 136056, 38.0: 128332, 39.0: 120598, 40.0: 111316, 41.0: 104552, 42.0: 99978, 43.0: 94238, 44.0: 87936, 45.0: 84218, 46.0: 78890, 47.0: 73758, 48.0: 70956, 49.0: 69900, 50.0: 63968, 51.0: 62416, 52.0: 57390, 53.0: 53762, 54.0: 50652, 55.0: 46904, 56.0: 44174, 57.0: 42194, 58.0: 40210, 59.0: 38156, 60.0: 35626, 61.0: 33816, 62.0: 32048, 63.0: 30696, 64.0: 28698, 67.0: 28620, 65.0: 27238, 66.0: 25862, 68.0: 23590, 69.0: 22866, 70.0: 21048, 71.0: 19824, 72.0: 19144, 73.0: 18110, 74.0: 17152, 75.0: 16504, 76.0: 15664, 77.0: 15398, 78.0: 13460, 79.0: 13036, 80.0: 12224, 81.0: 12084, 82.0: 11112, 85.0: 10724, 83.0: 10444, 84.0: 10382, 86.0: 9252, 87.0: 8490, 88.0: 8488, 89.0: 7966, 90.0: 7444, 91.0: 7124, 92.0: 6600, 93.0: 6462, 94.0: 6026, 95.0: 5926, 96.0: 5490, 97.0: 5398, 98.0: 5026, 99.0: 4742, 100.0: 4600, 101.0: 4128, 102.0: 4078, 103.0: 3752, 104.0: 3630, 105.0: 3370, 106.0: 3176, 107.0: 2908, 108.0: 2730, 109.0: 2656, 110.0: 2458, 111.0: 2276, 112.0: 2114, 113.0: 1992, 114.0: 1952, 120.0: 1706, 115.0: 1670, 116.0: 1616, 117.0: 1554, 118.0: 1418, 119.0: 1318, 121.0: 1144, 122.0: 1058, 123.0: 1010, 124.0: 890, 126.0: 810, 125.0: 792, 127.0: 726, 129.0: 636, 131.0: 608, 128.0: 586, 130.0: 558, 132.0: 540, 135.0: 470, 133.0: 460, 134.0: 450, 136.0: 390, 137.0: 366, 138.0: 348, 139.0: 308, 141.0: 296, 140.0: 280, 142.0: 254, 143.0: 230, 144.0: 218, 147.0: 202, 145.0: 200, 148.0: 200, 146.0: 186, 149.0: 168, 151.0: 160, 150.0: 158, 152.0: 144, 155.0: 134, 153.0: 128, 154.0: 124, 157.0: 112, 158.0: 102, 156.0: 102, 159.0: 76, 160.0: 76, 162.0: 74, 161.0: 64, 164.0: 52, 166.0: 46, 163.0: 40, 165.0: 38, 167.0: 26, 168.0: 18, 169.0: 18, 170.0: 16, 175.0: 10, 172.0: 10, 179.0: 8, 174.0: 6, 178.0: 6, 171.0: 6, 177.0: 4, 173.0: 4, 180.0: 2, 182.0: 2, 181.0: 2})
375892444
Convert a graph into a bidirected graph: 18.883 seconds
Metis partitioning: 83.606 seconds
Split the graph: 14.533 seconds
Construct subgraphs: 0.074 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  117.2651002407074
21219
22461
21206
22456
22453
22350
21204
21603
21619
total k batches seeds list generation spend  235.0083944797516
after graph partition
graph partition algorithm spend time 238.27264642715454
21219
22461
21206
22456
22453
22350
21204
21603
21619
partition_len_list
[314257, 316508, 401686, 307161, 357705, 364451, 417212, 455599, 296749]
REG selection method  spend 239.30942845344543
time for parepare:  0.37655043601989746
local_output_nid generation:  0.006925106048583984
local_in_edges_tensor generation:  0.01773834228515625
mini_batch_src_global generation:  0.07705068588256836
r_  generation:  0.7209632396697998
local_output_nid generation:  0.0071258544921875
local_in_edges_tensor generation:  0.020368337631225586
mini_batch_src_global generation:  0.10620689392089844
r_  generation:  0.8861038684844971
local_output_nid generation:  0.006867408752441406
local_in_edges_tensor generation:  0.021574020385742188
mini_batch_src_global generation:  0.10493612289428711
r_  generation:  0.8349876403808594
local_output_nid generation:  0.007128715515136719
local_in_edges_tensor generation:  0.03934311866760254
mini_batch_src_global generation:  0.0980842113494873
r_  generation:  0.8381342887878418
local_output_nid generation:  0.007140159606933594
local_in_edges_tensor generation:  0.051714420318603516
mini_batch_src_global generation:  0.09004354476928711
r_  generation:  0.8195786476135254
local_output_nid generation:  0.008479595184326172
local_in_edges_tensor generation:  0.046504974365234375
mini_batch_src_global generation:  0.14265894889831543
r_  generation:  1.1715126037597656
local_output_nid generation:  0.00983119010925293
local_in_edges_tensor generation:  0.04716014862060547
mini_batch_src_global generation:  0.11283993721008301
r_  generation:  1.0307731628417969
local_output_nid generation:  0.006970405578613281
local_in_edges_tensor generation:  0.04474663734436035
mini_batch_src_global generation:  0.12502241134643555
r_  generation:  1.0518887042999268
local_output_nid generation:  0.006942033767700195
local_in_edges_tensor generation:  0.026221275329589844
mini_batch_src_global generation:  0.10888528823852539
r_  generation:  0.9131157398223877
----------------------check_connections_block total spend ----------------------------- 11.492396116256714
generate_one_block  1.5366897583007812
generate_one_block  1.4877896308898926
generate_one_block  1.3018882274627686
generate_one_block  1.154106616973877
generate_one_block  1.2090232372283936
generate_one_block  1.7095890045166016
generate_one_block  1.5780484676361084
generate_one_block  1.502392292022705
generate_one_block  1.2284605503082275
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.1574859619140625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

connection checking time:  11.492396116256714
block generation total time  12.707987785339355
average batch blocks generation time:  1.411998642815484
block dataloader generation time/epoch 278.7293930053711
pseudo mini batch 0 input nodes size: 314257
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.11838912963867188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.11838912963867188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.2354593276977539  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.23561763763427734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.12343931198120117  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14090204238891602  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14090204238891602  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21219, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 13.298211097717285  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 13.30192756652832  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.15713977813720703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 1 input nodes size: 316508
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.12229537963867188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.12229537963867188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.240203857421875  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.2403712272644043  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.12314271926879883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14431142807006836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2401123046875 GB
    Memory Allocated: 0.14431142807006836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22461, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 16.275291919708252  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 16.27922534942627  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.16578149795532227  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 2 input nodes size: 401686
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.12336015701293945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.12336015701293945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.27300024032592773  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.27315855026245117  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.15508270263671875  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1728496551513672  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1728496551513672  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21206, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 13.83578634262085  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 13.839719772338867  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1909160614013672  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 3 input nodes size: 307161
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1553030014038086  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1553030014038086  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.2697296142578125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.2698969841003418  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.12009859085083008  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.13855552673339844  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.13855552673339844  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22456, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 13.78575325012207  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 13.789906978607178  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1562948226928711  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 4 input nodes size: 357705
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.11987733840942383  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.11987733840942383  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.25313329696655273  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.25330066680908203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.13870668411254883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1554856300354004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1554856300354004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22453, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 12.826942443847656  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 12.830874919891357  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1723480224609375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 5 input nodes size: 364451
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.13870620727539062  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.13870620727539062  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.27447509765625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.2746419906616211  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.1412186622619629  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.16474294662475586  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7127685546875 GB
    Memory Allocated: 0.16474294662475586  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22350, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 17.90600299835205  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 17.909916877746582  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.18833255767822266  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 6 input nodes size: 417212
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.14120054244995117  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.14120054244995117  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.29662418365478516  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.2967824935913086  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.16084671020507812  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.18101024627685547  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.18101024627685547  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 15.421235084533691  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 15.425148963928223  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.20198869705200195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 7 input nodes size: 455599
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.16158246994018555  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.16158246994018555  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.33130645751953125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.3314676284790039  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.17588567733764648  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1968998908996582  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1968998908996582  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21603, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 16.047841548919678  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 16.051759719848633  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.21712827682495117  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 8 input nodes size: 296749
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1750192642211914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1750192642211914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.2855672836303711  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.28572845458984375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.11584329605102539  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.13500642776489258  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.13500642776489258  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21619, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 14.691808223724365  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 14.695594310760498  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1542530059814453  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1542530059814453  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1542530059814453  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07795190811157227 |0.01924239264594184 |1.576607757144504 |0.00018016497294108072 |2.717499362097846 |0.015395164489746094 |
----------------------------------------------------------pseudo_mini_loss sum 3.4531826972961426
Total (block generation + training)time/epoch 319.2306085427602
Training time/epoch 39.80503749847412
Training time without block to device /epoch 39.631855964660645
Training time without total dataloading part /epoch 38.66398072242737
load block tensor time/epoch 0.7015671730041504
block to device time/epoch 0.17318153381347656
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3231328
Number of first layer input nodes during this epoch:  3231328
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1542525291442871  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1741430759429932
global_2_local spend time (sec) 0.6230471134185791
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.24836492538452148
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1567927, 200: 49189, 77: 1190, 81: 1185, 79: 1185, 88: 1183, 84: 1177, 78: 1169, 75: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 71: 1080, 73: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 62: 959, 52: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 119: 816, 39: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 127: 722, 138: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 15: 673, 145: 673, 25: 671, 26: 659, 7: 655, 139: 654, 131: 654, 137: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 190: 386, 193: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 196: 369, 195: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.3565826416015625
auxiliary_graph
Graph(num_nodes=1764498, num_edges=376057251,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.8429172039031982
remove nodes length  1567927

auxiliary_graph.remove_nodes spent  19.49922490119934
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376057251,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  15.519229888916016

the counter of shared neighbor distribution
Counter({1.0: 218069136, 2.0: 58322116, 3.0: 28167744, 4.0: 16681622, 5.0: 11005422, 6.0: 7783288, 7.0: 5760388, 8.0: 4415746, 9.0: 3478300, 10.0: 2798054, 11.0: 2290790, 12.0: 1904542, 13.0: 1610798, 14.0: 1365702, 15.0: 1174358, 16.0: 1013970, 17.0: 884486, 18.0: 777970, 19.0: 685774, 20.0: 606796, 21.0: 539684, 22.0: 481054, 23.0: 432152, 24.0: 389254, 25.0: 354472, 26.0: 321982, 27.0: 292776, 28.0: 269644, 29.0: 246846, 30.0: 228102, 31.0: 209848, 32.0: 194196, 33.0: 181800, 34.0: 167426, 35.0: 156440, 36.0: 145490, 37.0: 136048, 38.0: 127766, 39.0: 121008, 40.0: 111338, 41.0: 104550, 42.0: 99870, 43.0: 93752, 44.0: 88528, 45.0: 84056, 46.0: 79080, 47.0: 73992, 48.0: 71002, 49.0: 69788, 50.0: 64064, 51.0: 62542, 52.0: 57310, 53.0: 53910, 54.0: 50282, 55.0: 46870, 56.0: 44592, 57.0: 42276, 58.0: 40238, 59.0: 37856, 60.0: 35398, 61.0: 33662, 62.0: 32104, 63.0: 30722, 64.0: 28692, 67.0: 28188, 65.0: 27720, 66.0: 26226, 68.0: 23920, 69.0: 22898, 70.0: 21096, 71.0: 19966, 72.0: 19196, 73.0: 17724, 74.0: 17166, 75.0: 16358, 76.0: 15788, 77.0: 15336, 78.0: 13630, 79.0: 12686, 80.0: 12506, 81.0: 12158, 82.0: 11194, 85.0: 10584, 83.0: 10484, 84.0: 10266, 86.0: 9220, 87.0: 8690, 88.0: 8476, 89.0: 7958, 90.0: 7596, 91.0: 7160, 92.0: 6828, 93.0: 6532, 94.0: 6182, 95.0: 5768, 97.0: 5550, 96.0: 5228, 98.0: 4980, 99.0: 4742, 100.0: 4524, 101.0: 4288, 102.0: 3916, 103.0: 3902, 104.0: 3362, 105.0: 3346, 106.0: 3230, 107.0: 3006, 108.0: 2812, 109.0: 2692, 110.0: 2444, 111.0: 2344, 112.0: 2072, 113.0: 1964, 114.0: 1830, 115.0: 1734, 120.0: 1726, 116.0: 1620, 117.0: 1580, 119.0: 1386, 118.0: 1354, 121.0: 1132, 122.0: 1052, 123.0: 1006, 124.0: 874, 126.0: 810, 127.0: 766, 125.0: 734, 128.0: 668, 130.0: 606, 132.0: 598, 131.0: 584, 129.0: 576, 133.0: 468, 135.0: 412, 134.0: 410, 136.0: 362, 138.0: 346, 137.0: 334, 142.0: 304, 140.0: 298, 139.0: 278, 141.0: 270, 144.0: 236, 143.0: 220, 145.0: 214, 147.0: 214, 146.0: 198, 150.0: 182, 152.0: 164, 148.0: 158, 149.0: 156, 151.0: 150, 157.0: 130, 153.0: 126, 156.0: 124, 154.0: 114, 155.0: 110, 158.0: 96, 160.0: 84, 159.0: 74, 163.0: 64, 161.0: 62, 162.0: 54, 164.0: 52, 165.0: 36, 166.0: 34, 168.0: 30, 170.0: 24, 167.0: 22, 169.0: 12, 175.0: 8, 178.0: 8, 172.0: 8, 174.0: 6, 176.0: 6, 173.0: 6, 179.0: 4, 171.0: 2, 177.0: 2, 181.0: 2, 180.0: 2, 182.0: 2})
375860680
Convert a graph into a bidirected graph: 19.738 seconds
Metis partitioning: 85.997 seconds
Split the graph: 15.952 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  121.87469792366028
21225
22356
21205
22009
22453
22420
21925
21378
21600
total k batches seeds list generation spend  240.30737352371216
after graph partition
graph partition algorithm spend time 243.50411462783813
21225
22356
21205
22009
22453
22420
21925
21378
21600
partition_len_list
[279179, 317542, 341426, 315990, 345317, 367957, 434506, 318138, 412773]
REG selection method  spend 244.4960606098175
time for parepare:  0.3790574073791504
local_output_nid generation:  0.007307767868041992
local_in_edges_tensor generation:  0.025012969970703125
mini_batch_src_global generation:  0.07811331748962402
r_  generation:  0.7278571128845215
local_output_nid generation:  0.007431745529174805
local_in_edges_tensor generation:  0.02408742904663086
mini_batch_src_global generation:  0.11344790458679199
r_  generation:  0.8642427921295166
local_output_nid generation:  0.010063648223876953
local_in_edges_tensor generation:  0.022936582565307617
mini_batch_src_global generation:  0.09509992599487305
r_  generation:  0.7789511680603027
local_output_nid generation:  0.00754857063293457
local_in_edges_tensor generation:  0.03313779830932617
mini_batch_src_global generation:  0.09642601013183594
r_  generation:  0.8228611946105957
local_output_nid generation:  0.007459878921508789
local_in_edges_tensor generation:  0.07305216789245605
mini_batch_src_global generation:  0.09172344207763672
r_  generation:  0.7563252449035645
local_output_nid generation:  0.008730888366699219
local_in_edges_tensor generation:  0.06905126571655273
mini_batch_src_global generation:  0.14495444297790527
r_  generation:  1.1930420398712158
local_output_nid generation:  0.010262489318847656
local_in_edges_tensor generation:  0.09658050537109375
mini_batch_src_global generation:  0.11681652069091797
r_  generation:  1.1110777854919434
local_output_nid generation:  0.00722193717956543
local_in_edges_tensor generation:  0.050081491470336914
mini_batch_src_global generation:  0.10984086990356445
r_  generation:  0.950023889541626
local_output_nid generation:  0.007372617721557617
local_in_edges_tensor generation:  0.02872180938720703
mini_batch_src_global generation:  0.11067056655883789
r_  generation:  1.008554220199585
----------------------check_connections_block total spend ----------------------------- 11.549345016479492
generate_one_block  1.5551159381866455
generate_one_block  1.4582018852233887
generate_one_block  1.206467866897583
generate_one_block  1.1873679161071777
generate_one_block  1.2532868385314941
generate_one_block  1.8373911380767822
generate_one_block  1.5786528587341309
generate_one_block  1.3059821128845215
generate_one_block  1.3545615673065186
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1542525291442871  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

connection checking time:  11.549345016479492
block generation total time  12.737028121948242
average batch blocks generation time:  1.415225346883138
block dataloader generation time/epoch 277.1395850777626
pseudo mini batch 0 input nodes size: 279179
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1158452033996582  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.1158452033996582  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.2198476791381836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.22000598907470703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.10929679870605469  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.12720394134521484  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.12720394134521484  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21225, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 13.730743408203125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 13.734529972076416  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.14584112167358398  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 1 input nodes size: 317542
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.10994768142700195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.10994768142700195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.2282414436340332  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.2284083366394043  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.12424755096435547  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.14467239379882812  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3299560546875 GB
    Memory Allocated: 0.14467239379882812  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22356, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 15.66504955291748  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 15.669485569000244  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.16531801223754883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 2 input nodes size: 341426
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.12438488006591797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.12438488006591797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.25157642364501953  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.25173473358154297  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.13327407836914062  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.15063953399658203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.15063953399658203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21205, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 13.393951416015625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 13.397665023803711  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.16722440719604492  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 3 input nodes size: 315990
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1324143409729004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.1324143409729004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.25013017654418945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.25029420852661133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.12294435501098633  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.14048004150390625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.14048004150390625  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22009, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 13.435593128204346  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 13.439447402954102  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.15826845169067383  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 4 input nodes size: 345317
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.12323760986328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.12323760986328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.2518782615661621  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.2520456314086914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.13416576385498047  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.15025043487548828  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.15025043487548828  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22453, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 12.40173625946045  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 12.40574312210083  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.16634416580200195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 5 input nodes size: 367957
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.13409090042114258  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.13409090042114258  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.2711658477783203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.2713332176208496  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.14252519607543945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.16636228561401367  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5487060546875 GB
    Memory Allocated: 0.16636228561401367  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22420, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 18.143232822418213  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 18.147159099578857  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1902775764465332  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 6 input nodes size: 434506
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14251947402954102  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14251947402954102  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.3043856620788574  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.3045492172241211  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.16730690002441406  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19074440002441406  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19074440002441406  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21925, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 16.430625438690186  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 16.43455171585083  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.21322393417358398  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 7 input nodes size: 318138
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1672201156616211  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1672201156616211  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.285736083984375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.28589582443237305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12386608123779297  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14393138885498047  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14393138885498047  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21378, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 15.330326080322266  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 15.334069728851318  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.16398096084594727  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 8 input nodes size: 412773
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12377023696899414  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12377023696899414  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.2775402069091797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.27770137786865234  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1590256690979004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.17915773391723633  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.17915773391723633  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21600, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 15.55221939086914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 15.556002140045166  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19940948486328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19940948486328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19940948486328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08098562558492024 |0.018009715610080294 |1.94020496474372 |0.00020472208658854166 |3.0158425437079535 |0.014481782913208008 |
----------------------------------------------------------pseudo_mini_loss sum 2.6168322563171387
Total (block generation + training)time/epoch 318.9608663916588
Training time/epoch 45.78120493888855
Training time without block to device /epoch 45.61911749839783
Training time without total dataloading part /epoch 44.62075185775757
load block tensor time/epoch 0.7288706302642822
block to device time/epoch 0.16208744049072266
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3132828
Number of first layer input nodes during this epoch:  3132828
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19940900802612305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1836674213409424
global_2_local spend time (sec) 0.7416746616363525
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.25978803634643555
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1567889, 200: 49189, 77: 1190, 79: 1185, 81: 1185, 88: 1183, 84: 1177, 75: 1169, 78: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 119: 816, 39: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 38: 775, 116: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 30: 689, 140: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 137: 654, 131: 654, 139: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 181: 435, 173: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 190: 386, 193: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 196: 369, 195: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.3564443588256836
auxiliary_graph
Graph(num_nodes=1764460, num_edges=376194813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7978291511535645
remove nodes length  1567889

auxiliary_graph.remove_nodes spent  19.653172254562378
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376194813,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  15.57111144065857

the counter of shared neighbor distribution
Counter({1.0: 218153938, 2.0: 58367638, 3.0: 28192258, 4.0: 16685322, 5.0: 11008718, 6.0: 7783056, 7.0: 5753812, 8.0: 4409712, 9.0: 3475714, 10.0: 2800030, 11.0: 2287104, 12.0: 1902546, 13.0: 1610874, 14.0: 1366168, 15.0: 1172914, 16.0: 1013566, 17.0: 883496, 18.0: 777126, 19.0: 685422, 20.0: 604934, 21.0: 539010, 22.0: 480992, 23.0: 432402, 24.0: 389304, 25.0: 354416, 26.0: 320520, 27.0: 294954, 28.0: 270804, 29.0: 246440, 30.0: 227830, 31.0: 209486, 32.0: 195048, 33.0: 181264, 34.0: 166984, 35.0: 156670, 36.0: 146140, 37.0: 136116, 38.0: 126860, 39.0: 120646, 40.0: 112158, 41.0: 104424, 42.0: 99858, 43.0: 93818, 44.0: 89044, 45.0: 84274, 46.0: 79112, 47.0: 73782, 48.0: 70466, 49.0: 69320, 50.0: 64066, 51.0: 62916, 52.0: 57458, 53.0: 53704, 54.0: 50248, 55.0: 46980, 56.0: 44444, 57.0: 42648, 58.0: 39944, 59.0: 37768, 60.0: 35932, 61.0: 33644, 62.0: 32658, 63.0: 30308, 64.0: 28646, 67.0: 28250, 65.0: 27576, 66.0: 25628, 68.0: 23762, 69.0: 22810, 70.0: 21132, 71.0: 20094, 72.0: 19334, 73.0: 17824, 74.0: 16940, 75.0: 16574, 76.0: 15620, 77.0: 15264, 78.0: 13734, 79.0: 12866, 80.0: 12358, 81.0: 12202, 82.0: 11026, 85.0: 10710, 83.0: 10414, 84.0: 10342, 86.0: 9112, 87.0: 8806, 88.0: 8384, 89.0: 7802, 90.0: 7552, 91.0: 7174, 92.0: 6968, 93.0: 6648, 94.0: 6036, 95.0: 5876, 97.0: 5552, 96.0: 5334, 98.0: 4928, 99.0: 4726, 100.0: 4604, 101.0: 4220, 103.0: 3958, 102.0: 3944, 105.0: 3550, 104.0: 3382, 106.0: 3094, 107.0: 2930, 108.0: 2726, 109.0: 2614, 110.0: 2440, 111.0: 2360, 112.0: 2078, 113.0: 2006, 114.0: 1972, 120.0: 1790, 115.0: 1648, 116.0: 1628, 117.0: 1492, 119.0: 1370, 118.0: 1318, 122.0: 1058, 121.0: 1052, 123.0: 946, 124.0: 858, 125.0: 852, 126.0: 802, 127.0: 726, 129.0: 634, 128.0: 596, 130.0: 564, 132.0: 552, 131.0: 536, 133.0: 472, 134.0: 440, 135.0: 408, 136.0: 398, 137.0: 342, 138.0: 334, 141.0: 308, 139.0: 296, 140.0: 268, 142.0: 266, 143.0: 244, 147.0: 222, 149.0: 210, 144.0: 206, 146.0: 194, 145.0: 190, 148.0: 176, 151.0: 172, 153.0: 154, 150.0: 150, 154.0: 132, 152.0: 124, 156.0: 120, 155.0: 116, 158.0: 94, 159.0: 90, 157.0: 88, 160.0: 72, 163.0: 64, 161.0: 64, 164.0: 60, 162.0: 54, 165.0: 34, 166.0: 28, 167.0: 26, 171.0: 22, 168.0: 20, 170.0: 12, 169.0: 10, 175.0: 10, 173.0: 8, 177.0: 6, 178.0: 6, 174.0: 4, 176.0: 4, 172.0: 4, 181.0: 2, 180.0: 2, 179.0: 2, 182.0: 2})
375998242
Convert a graph into a bidirected graph: 31.036 seconds
Metis partitioning: 85.326 seconds
Split the graph: 12.668 seconds
Construct subgraphs: 0.049 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  129.21667575836182
21875
21222
21296
21220
22416
22469
22113
22452
21508
total k batches seeds list generation spend  247.89231705665588
after graph partition
graph partition algorithm spend time 250.9222972393036
21875
21222
21296
21220
22416
22469
22113
22452
21508
partition_len_list
[337705, 325456, 285948, 292834, 372619, 370661, 412767, 312140, 455376]
REG selection method  spend 252.08436942100525
time for parepare:  0.35170483589172363
local_output_nid generation:  0.007311344146728516
local_in_edges_tensor generation:  0.026035308837890625
mini_batch_src_global generation:  0.09338998794555664
r_  generation:  0.8608150482177734
local_output_nid generation:  0.007125377655029297
local_in_edges_tensor generation:  0.019479990005493164
mini_batch_src_global generation:  0.09775781631469727
r_  generation:  0.7070064544677734
local_output_nid generation:  0.007152080535888672
local_in_edges_tensor generation:  0.017148733139038086
mini_batch_src_global generation:  0.10402059555053711
r_  generation:  0.701174259185791
local_output_nid generation:  0.007217884063720703
local_in_edges_tensor generation:  0.017639636993408203
mini_batch_src_global generation:  0.09204792976379395
r_  generation:  0.7723820209503174
local_output_nid generation:  0.0073239803314208984
local_in_edges_tensor generation:  0.052481889724731445
mini_batch_src_global generation:  0.09638094902038574
r_  generation:  0.8631541728973389
local_output_nid generation:  0.007250308990478516
local_in_edges_tensor generation:  0.043385982513427734
mini_batch_src_global generation:  0.12186336517333984
r_  generation:  1.1004469394683838
local_output_nid generation:  0.009263277053833008
local_in_edges_tensor generation:  0.030144214630126953
mini_batch_src_global generation:  0.11165785789489746
r_  generation:  0.9793248176574707
local_output_nid generation:  0.008177042007446289
local_in_edges_tensor generation:  0.025051593780517578
mini_batch_src_global generation:  0.11130595207214355
r_  generation:  0.9179854393005371
local_output_nid generation:  0.007070779800415039
local_in_edges_tensor generation:  0.025940656661987305
mini_batch_src_global generation:  0.11337804794311523
r_  generation:  1.0174031257629395
----------------------check_connections_block total spend ----------------------------- 10.959233283996582
generate_one_block  1.706613302230835
generate_one_block  1.1647589206695557
generate_one_block  1.0799179077148438
generate_one_block  1.1103157997131348
generate_one_block  1.198261022567749
generate_one_block  1.487335443496704
generate_one_block  1.3315227031707764
generate_one_block  1.2549378871917725
generate_one_block  1.4440498352050781
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.19940900802612305  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

connection checking time:  10.959233283996582
block generation total time  11.77771282196045
average batch blocks generation time:  1.3086347579956055
block dataloader generation time/epoch 277.38863229751587
pseudo mini batch 0 input nodes size: 337705
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.15906381607055664  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.15906381607055664  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.2848691940307617  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.2850322723388672  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.13110113143920898  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.15211725234985352  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.15211725234985352  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21875, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 16.079585552215576  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 16.084293842315674  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1732640266418457  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 1 input nodes size: 325456
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1311502456665039  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.1311502456665039  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.2523922920227051  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.2525506019592285  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12658214569091797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14388084411621094  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.14388084411621094  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21222, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 13.285219669342041  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 13.288936138153076  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.16114425659179688  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 2 input nodes size: 285948
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12646770477294922  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12646770477294922  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.23299169540405273  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.23315048217773438  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.11175012588500977  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12833833694458008  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1190185546875 GB
    Memory Allocated: 0.12833833694458008  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21296, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 12.674721717834473  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 12.67845106124878  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.14590215682983398  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 3 input nodes size: 292834
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.11264610290527344  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.11264610290527344  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.22173547744750977  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.2218937873840332  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.11521100997924805  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1329951286315918  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1329951286315918  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21220, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 13.385005950927734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 13.389618396759033  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.15018653869628906  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 4 input nodes size: 372619
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.11487483978271484  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.11487483978271484  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.25368642807006836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.25385379791259766  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1446061134338379  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.16301441192626953  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.16301441192626953  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22416, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 13.769829750061035  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 13.7741060256958  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1807718276977539  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 5 input nodes size: 370661
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1442551612854004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1442551612854004  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.2823371887207031  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.2825050354003906  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.1435260772705078  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.16704845428466797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2967529296875 GB
    Memory Allocated: 0.16704845428466797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22469, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 17.907588958740234  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 17.911523818969727  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.19066429138183594  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 6 input nodes size: 412767
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.14353561401367188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.14353561401367188  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2973036766052246  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2974686622619629  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15921878814697266  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.1791849136352539  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.1791849136352539  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22113, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.25075101852417  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.254685878753662  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.1998767852783203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 7 input nodes size: 312140
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15986204147338867  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15986204147338867  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.27614355087280273  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.27631092071533203  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12237787246704102  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.14242982864379883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.14242982864379883  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22452, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.269573211669922  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.27415132522583  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.16191959381103516  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 8 input nodes size: 455376
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12173175811767578  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12173175811767578  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.29137277603149414  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2915334701538086  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.17508459091186523  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.19592714309692383  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.19592714309692383  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21508, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.962759017944336  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 15.967453002929688  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21761226654052734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21761226654052734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21761226654052734  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08218675189548069 |0.019076771206325956 |1.517310619354248 |0.00017719798617892794 |3.589871406555176 |0.014369964599609375 |
----------------------------------------------------------pseudo_mini_loss sum 2.152523994445801
Total (block generation + training)time/epoch 320.27218170166014
Training time/epoch 47.1323664188385
Training time without block to device /epoch 46.96067547798157
Training time without total dataloading part /epoch 45.980602979660034
load block tensor time/epoch 0.7396807670593262
block to device time/epoch 0.1716909408569336
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3165506
Number of first layer input nodes during this epoch:  3165506
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21761178970336914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

The real block id is  0
get_global_graph_edges_ids_block function  spend 1.1827867031097412
global_2_local spend time (sec) 0.6781976222991943
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.3045954704284668
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1567700, 200: 49189, 77: 1190, 81: 1185, 79: 1185, 88: 1183, 84: 1177, 78: 1169, 75: 1169, 83: 1165, 85: 1164, 82: 1160, 67: 1158, 87: 1156, 91: 1154, 86: 1151, 76: 1145, 89: 1142, 92: 1119, 80: 1117, 90: 1108, 69: 1107, 93: 1088, 73: 1080, 71: 1080, 74: 1069, 94: 1069, 70: 1068, 68: 1053, 72: 1052, 99: 1042, 97: 1034, 96: 1020, 95: 1017, 102: 1006, 54: 996, 65: 994, 61: 981, 66: 977, 98: 963, 52: 959, 62: 959, 48: 958, 100: 957, 58: 957, 63: 955, 101: 954, 64: 953, 59: 950, 107: 949, 104: 947, 106: 945, 105: 942, 103: 939, 43: 933, 60: 930, 51: 928, 47: 927, 57: 923, 56: 913, 53: 907, 55: 907, 108: 898, 112: 887, 45: 884, 49: 879, 50: 877, 109: 867, 41: 861, 115: 857, 111: 853, 40: 852, 110: 850, 113: 848, 120: 844, 117: 838, 114: 835, 122: 825, 39: 816, 119: 816, 42: 813, 121: 810, 46: 807, 44: 806, 118: 798, 33: 793, 37: 791, 128: 782, 116: 775, 38: 775, 28: 768, 125: 756, 35: 754, 136: 752, 126: 747, 124: 744, 36: 741, 123: 741, 32: 727, 138: 722, 127: 722, 130: 716, 129: 711, 133: 706, 135: 704, 134: 703, 132: 702, 14: 695, 31: 691, 140: 689, 30: 689, 34: 677, 145: 673, 15: 673, 25: 671, 26: 659, 7: 655, 131: 654, 137: 654, 139: 654, 141: 652, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 150: 633, 143: 629, 11: 624, 144: 620, 142: 617, 13: 615, 16: 614, 148: 612, 147: 612, 146: 605, 18: 604, 149: 602, 22: 592, 155: 587, 21: 586, 19: 584, 12: 583, 154: 580, 152: 579, 151: 577, 157: 577, 9: 576, 153: 575, 20: 572, 17: 556, 6: 550, 159: 544, 156: 541, 158: 535, 164: 527, 160: 520, 8: 512, 165: 508, 169: 507, 161: 505, 172: 503, 163: 497, 166: 495, 170: 492, 168: 486, 162: 484, 171: 482, 167: 476, 177: 463, 4: 456, 179: 453, 180: 447, 175: 446, 5: 445, 182: 438, 173: 435, 181: 435, 185: 429, 176: 428, 184: 427, 174: 423, 178: 421, 199: 400, 187: 391, 188: 389, 186: 387, 193: 386, 190: 386, 192: 381, 189: 377, 191: 375, 3: 374, 183: 370, 195: 369, 196: 369, 194: 365, 198: 363, 197: 339, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.3552079200744629
auxiliary_graph
Graph(num_nodes=1764271, num_edges=376158189,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.7969207763671875
remove nodes length  1567700

auxiliary_graph.remove_nodes spent  19.1087908744812
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=376158189,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  15.936330556869507

the counter of shared neighbor distribution
Counter({1.0: 218154066, 2.0: 58332938, 3.0: 28181824, 4.0: 16686858, 5.0: 11001888, 6.0: 7786728, 7.0: 5757820, 8.0: 4415494, 9.0: 3472110, 10.0: 2796740, 11.0: 2286202, 12.0: 1906746, 13.0: 1613362, 14.0: 1365196, 15.0: 1170380, 16.0: 1013994, 17.0: 884874, 18.0: 778398, 19.0: 686450, 20.0: 607432, 21.0: 539718, 22.0: 480482, 23.0: 433426, 24.0: 389366, 25.0: 354370, 26.0: 320448, 27.0: 292646, 28.0: 269918, 29.0: 246580, 30.0: 226826, 31.0: 210034, 32.0: 195308, 33.0: 181898, 34.0: 167144, 35.0: 155796, 36.0: 145954, 37.0: 136128, 38.0: 127712, 39.0: 120120, 40.0: 111322, 41.0: 105084, 42.0: 100318, 43.0: 94084, 44.0: 88250, 45.0: 84268, 46.0: 78648, 47.0: 74128, 48.0: 70812, 49.0: 69834, 50.0: 64050, 51.0: 62278, 52.0: 57362, 53.0: 53620, 54.0: 50364, 55.0: 47228, 56.0: 44726, 57.0: 41944, 58.0: 40320, 59.0: 38002, 60.0: 35828, 61.0: 33636, 62.0: 32174, 63.0: 30434, 64.0: 28782, 67.0: 28622, 65.0: 27592, 66.0: 26032, 68.0: 23912, 69.0: 22838, 70.0: 21164, 71.0: 20016, 72.0: 19100, 73.0: 17886, 74.0: 17000, 75.0: 16568, 76.0: 15500, 77.0: 15148, 78.0: 13586, 79.0: 12936, 80.0: 12512, 81.0: 12236, 82.0: 10986, 85.0: 10506, 84.0: 10416, 83.0: 10194, 86.0: 9214, 87.0: 8574, 88.0: 8466, 89.0: 7806, 90.0: 7486, 91.0: 7256, 92.0: 6828, 93.0: 6586, 94.0: 6136, 95.0: 5772, 97.0: 5444, 96.0: 5402, 98.0: 5002, 99.0: 4636, 100.0: 4596, 101.0: 4302, 102.0: 4034, 103.0: 3968, 104.0: 3454, 105.0: 3392, 106.0: 3352, 107.0: 2906, 108.0: 2632, 109.0: 2564, 110.0: 2510, 111.0: 2388, 112.0: 2030, 113.0: 1984, 114.0: 1866, 115.0: 1786, 120.0: 1702, 116.0: 1638, 117.0: 1564, 118.0: 1414, 119.0: 1292, 121.0: 1134, 122.0: 1048, 123.0: 906, 124.0: 878, 126.0: 820, 127.0: 804, 125.0: 772, 128.0: 636, 129.0: 634, 130.0: 626, 132.0: 536, 131.0: 524, 133.0: 468, 134.0: 466, 135.0: 414, 138.0: 362, 136.0: 352, 137.0: 346, 139.0: 312, 140.0: 292, 141.0: 278, 142.0: 260, 144.0: 228, 145.0: 218, 143.0: 216, 147.0: 198, 148.0: 180, 150.0: 172, 146.0: 170, 149.0: 168, 151.0: 160, 152.0: 150, 153.0: 148, 157.0: 122, 155.0: 120, 156.0: 116, 158.0: 110, 154.0: 96, 161.0: 76, 159.0: 66, 162.0: 64, 160.0: 62, 164.0: 48, 166.0: 36, 165.0: 34, 163.0: 34, 168.0: 32, 167.0: 28, 170.0: 16, 169.0: 14, 171.0: 12, 174.0: 10, 178.0: 10, 173.0: 6, 175.0: 6, 172.0: 6, 176.0: 4, 177.0: 4, 179.0: 4, 180.0: 2, 182.0: 2})
375961618
Convert a graph into a bidirected graph: 31.327 seconds
Metis partitioning: 86.393 seconds
Split the graph: 17.442 seconds
Construct subgraphs: 0.052 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  135.35401582717896
22449
21264
21204
22151
21204
22013
22279
21599
22408
total k batches seeds list generation spend  253.92366528511047
after graph partition
graph partition algorithm spend time 256.8501470088959
22449
21264
21204
22151
21204
22013
22279
21599
22408
partition_len_list
[306178, 252576, 312149, 261016, 448368, 335570, 389423, 403416, 304323]
REG selection method  spend 257.8760817050934
time for parepare:  0.34546494483947754
local_output_nid generation:  0.008484125137329102
local_in_edges_tensor generation:  0.019598960876464844
mini_batch_src_global generation:  0.0909430980682373
r_  generation:  0.7628517150878906
local_output_nid generation:  0.007386207580566406
local_in_edges_tensor generation:  0.023108482360839844
mini_batch_src_global generation:  0.10167574882507324
r_  generation:  0.7487561702728271
local_output_nid generation:  0.00874471664428711
local_in_edges_tensor generation:  0.030021190643310547
mini_batch_src_global generation:  0.10200953483581543
r_  generation:  0.7635130882263184
local_output_nid generation:  0.007503509521484375
local_in_edges_tensor generation:  0.04102921485900879
mini_batch_src_global generation:  0.09282445907592773
r_  generation:  0.8416552543640137
local_output_nid generation:  0.00939798355102539
local_in_edges_tensor generation:  0.06942248344421387
mini_batch_src_global generation:  0.11744284629821777
r_  generation:  0.9977147579193115
local_output_nid generation:  0.008296489715576172
local_in_edges_tensor generation:  0.06094527244567871
mini_batch_src_global generation:  0.12738752365112305
r_  generation:  0.9833698272705078
local_output_nid generation:  0.007561683654785156
local_in_edges_tensor generation:  0.04368400573730469
mini_batch_src_global generation:  0.1116189956665039
r_  generation:  0.9235134124755859
local_output_nid generation:  0.007283687591552734
local_in_edges_tensor generation:  0.034835100173950195
mini_batch_src_global generation:  0.11599421501159668
r_  generation:  1.042553186416626
local_output_nid generation:  0.007441997528076172
local_in_edges_tensor generation:  0.033914804458618164
mini_batch_src_global generation:  0.11179757118225098
r_  generation:  0.9383862018585205
----------------------check_connections_block total spend ----------------------------- 11.21511721611023
generate_one_block  1.6160542964935303
generate_one_block  1.2117908000946045
generate_one_block  1.1704063415527344
generate_one_block  1.1839253902435303
generate_one_block  1.7052607536315918
generate_one_block  1.634016990661621
generate_one_block  1.3298335075378418
generate_one_block  1.4630649089813232
generate_one_block  1.3142778873443604
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21761178970336914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

connection checking time:  11.21511721611023
block generation total time  12.628630876541138
average batch blocks generation time:  1.403181208504571
block dataloader generation time/epoch 278.68107930819195
pseudo mini batch 0 input nodes size: 306178
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.17584562301635742  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.17584562301635742  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.28990602493286133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2900733947753906  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12027168273925781  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13890838623046875  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13890838623046875  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22449, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 14.216389656066895  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 14.22032117843628  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15709161758422852  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 1 input nodes size: 252576
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.11973428726196289  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.11973428726196289  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21382617950439453  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21398496627807617  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.09975719451904297  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.11760330200195312  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.11760330200195312  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21264, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.688211917877197  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.692367553710938  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13590478897094727  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 2 input nodes size: 312149
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.10013294219970703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.10013294219970703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21641778945922852  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21657609939575195  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12232542037963867  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13935136795043945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13935136795043945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.105870246887207  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.109583377838135  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15596580505371094  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 3 input nodes size: 261016
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12183475494384766  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12183475494384766  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2190709114074707  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2192363739013672  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.10279321670532227  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12130117416381836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.12130117416381836  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22151, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.523819923400879  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 13.527860641479492  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13925695419311523  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 4 input nodes size: 448368
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.10291337966918945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.10291337966918945  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.2699437141418457  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.27010202407836914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.1727004051208496  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.19396543502807617  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.19396543502807617  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 16.244494915008545  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 16.248655796051025  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.21486186981201172  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 5 input nodes size: 335570
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.17225265502929688  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.17225265502929688  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.29726266860961914  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.297426700592041  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.13023805618286133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15367555618286133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9158935546875 GB
    Memory Allocated: 0.15367555618286133  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22013, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 16.514049530029297  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 16.51864194869995  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.1769542694091797  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 6 input nodes size: 389423
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.13087177276611328  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.13087177276611328  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.2759432792663574  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.2761096954345703  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15093564987182617  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.16995859146118164  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.16995859146118164  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22279, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 14.590729713439941  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 14.595076560974121  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.18861961364746094  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 7 input nodes size: 403416
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15049028396606445  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15049028396606445  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.30077457427978516  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.3009357452392578  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15569782257080078  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.1770639419555664  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.1770639419555664  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([21599, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 16.358580112457275  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 16.362481594085693  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.19839143753051758  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

pseudo mini batch 8 input nodes size: 304323
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15557861328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15557861328125  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.2689480781555176  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.2691154479980469  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.11866998672485352  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.1388249397277832  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.1388249397277832  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

torch.Size([22408, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 15.34483289718628  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 15.349257946014404  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15956878662109375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15956878662109375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.1932373046875 GB
    Memory Allocated: 0.15956878662109375  GigaBytes
Max Memory Allocated: 19.945618629455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07395211855570476 |0.01754283905029297 |1.5079482396443684 |0.00017944971720377603 |3.582504669825236 |0.012281417846679688 |
----------------------------------------------------------pseudo_mini_loss sum 1.7964338064193726
Total (block generation + training)time/epoch 322.23290224870044
Training time/epoch 46.89288687705994
Training time without block to device /epoch 46.7350013256073
Training time without total dataloading part /epoch 45.827972650527954
load block tensor time/epoch 0.6655690670013428
block to device time/epoch 0.15788555145263672
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  3013019
Number of first layer input nodes during this epoch:  3013019
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
