[21:29:40] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37290540 edges into 16 parts and get 9309207 edge cuts
main start at this time 1652477354.5354877
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.58306884765625e-06  GigaBytes
Max Memory Allocated: 8.58306884765625e-06  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.58306884765625e-06  GigaBytes
Max Memory Allocated: 8.58306884765625e-06  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030169248580932617
global_2_local spend time (sec) 0.035059452056884766
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005255222320556641
A = g.adjacency_matrix() spent  0.008903741836547852
auxiliary_graph
Graph(num_nodes=158287, num_edges=37381481,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08471441268920898
remove nodes length
67346
auxiliary_graph.remove_nodes spent  1.9218409061431885
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37381481,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4925925731658936

the counter of shared neighbor distribution
Counter({1.0: 28475990, 2.0: 5922902, 3.0: 1745642, 4.0: 609330, 5.0: 251380, 6.0: 118424, 7.0: 61812, 8.0: 36128, 9.0: 21804, 10.0: 14362, 11.0: 9260, 12.0: 6524, 13.0: 4512, 14.0: 3310, 15.0: 2504, 16.0: 1728, 17.0: 1242, 18.0: 938, 19.0: 640, 20.0: 542, 21.0: 378, 22.0: 316, 23.0: 198, 24.0: 182, 25.0: 152, 26.0: 104, 27.0: 66, 29.0: 46, 28.0: 38, 30.0: 28, 32.0: 22, 33.0: 10, 38.0: 8, 35.0: 6, 40.0: 4, 31.0: 4, 49.0: 2, 37.0: 2})
37290540
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37290537, 37290538, 37290539])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28475990, 2.0: 5922902, 3.0: 1745642, 4.0: 609330, 5.0: 251380, 6.0: 118424, 7.0: 61812, 8.0: 36128, 9.0: 21804, 10.0: 14362, 11.0: 9260, 12.0: 6524, 13.0: 4512, 14.0: 3310, 15.0: 2504, 16.0: 1728, 17.0: 1242, 18.0: 938, 19.0: 640, 20.0: 542, 21.0: 378, 22.0: 316, 23.0: 198, 24.0: 182, 25.0: 152, 26.0: 104, 27.0: 66, 29.0: 46, 28.0: 38, 30.0: 28, 32.0: 22, 33.0: 10, 38.0: 8, 35.0: 6, 40.0: 4, 31.0: 4, 49.0: 2, 37.0: 2})
Convert a graph into a bidirected graph: 1.563 seconds
Metis partitioning: 6.650 seconds
Split the graph: 1.346 seconds
Construct subgraphs: 0.067 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.642304182052612
5853
5853
5854
5854
5854
5616
5741
5537
5517
5853
5548
5517
5544
5544
5517
5739
total k batches seeds list generation spend  22.486454963684082
after graph partition
graph partition algorithm spend time 22.59676241874695
5853
5853
5854
5854
5854
5616
5741
5537
5517
5853
5548
5517
5544
5544
5517
5739
partition_len_list
[12189, 12314, 11755, 14445, 13457, 12141, 10966, 10992, 34038, 30325, 33739, 28490, 14195, 14800, 28350, 19263]
shared_neighbor_graph_partition_s0 selection method  spend 22.68452262878418
time for parepare:  0.016899824142456055
local_output_nid generation:  0.001199960708618164
local_in_edges_tensor generation:  0.0014963150024414062
mini_batch_src_global generation:  0.002450227737426758
r_  generation:  0.017574787139892578
local_output_nid generation:  0.0013043880462646484
local_in_edges_tensor generation:  0.001402139663696289
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.013867378234863281
local_output_nid generation:  0.0013818740844726562
local_in_edges_tensor generation:  0.0013580322265625
mini_batch_src_global generation:  0.0012924671173095703
r_  generation:  0.015176057815551758
local_output_nid generation:  0.0014481544494628906
local_in_edges_tensor generation:  0.0012972354888916016
mini_batch_src_global generation:  0.0017139911651611328
r_  generation:  0.01746058464050293
local_output_nid generation:  0.0014803409576416016
local_in_edges_tensor generation:  0.0013000965118408203
mini_batch_src_global generation:  0.0017137527465820312
r_  generation:  0.017386436462402344
local_output_nid generation:  0.0014941692352294922
local_in_edges_tensor generation:  0.0012001991271972656
mini_batch_src_global generation:  0.0013556480407714844
r_  generation:  0.01385188102722168
local_output_nid generation:  0.0014910697937011719
local_in_edges_tensor generation:  0.0012769699096679688
mini_batch_src_global generation:  0.0015821456909179688
r_  generation:  0.017502784729003906
local_output_nid generation:  0.0025277137756347656
local_in_edges_tensor generation:  0.001592397689819336
mini_batch_src_global generation:  0.002135753631591797
r_  generation:  0.01404881477355957
local_output_nid generation:  0.0018610954284667969
local_in_edges_tensor generation:  0.0013544559478759766
mini_batch_src_global generation:  0.0024526119232177734
r_  generation:  0.0258333683013916
local_output_nid generation:  0.0016903877258300781
local_in_edges_tensor generation:  0.002337217330932617
mini_batch_src_global generation:  0.0036144256591796875
r_  generation:  0.031262874603271484
local_output_nid generation:  0.0031211376190185547
local_in_edges_tensor generation:  0.0018715858459472656
mini_batch_src_global generation:  0.002624034881591797
r_  generation:  0.02522444725036621
local_output_nid generation:  0.0017809867858886719
local_in_edges_tensor generation:  0.0013446807861328125
mini_batch_src_global generation:  0.0017580986022949219
r_  generation:  0.01749730110168457
local_output_nid generation:  0.0018291473388671875
local_in_edges_tensor generation:  0.0013203620910644531
mini_batch_src_global generation:  0.0010945796966552734
r_  generation:  0.012304544448852539
local_output_nid generation:  0.0016932487487792969
local_in_edges_tensor generation:  0.001293182373046875
mini_batch_src_global generation:  0.0011577606201171875
r_  generation:  0.013275623321533203
local_output_nid generation:  0.0016047954559326172
local_in_edges_tensor generation:  0.0013322830200195312
mini_batch_src_global generation:  0.0017714500427246094
r_  generation:  0.02135920524597168
local_output_nid generation:  0.0017199516296386719
local_in_edges_tensor generation:  0.0013108253479003906
mini_batch_src_global generation:  0.0018448829650878906
r_  generation:  0.016008853912353516
----------------------check_connections_block total spend ----------------------------- 0.4678347110748291
generate_one_block  0.02522110939025879
generate_one_block  0.019067049026489258
generate_one_block  0.020765066146850586
generate_one_block  0.024995803833007812
generate_one_block  0.034587860107421875
generate_one_block  0.0189361572265625
generate_one_block  0.02395462989807129
generate_one_block  0.019617557525634766
generate_one_block  0.04229569435119629
generate_one_block  0.049050092697143555
generate_one_block  0.04138469696044922
generate_one_block  0.024345874786376953
generate_one_block  0.016180038452148438
generate_one_block  0.018191099166870117
generate_one_block  0.030512094497680664
generate_one_block  0.02234053611755371
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07120966911315918
gen group dst list time:  0.008816957473754883
time for parepare:  0.02265167236328125
local_output_nid generation:  0.0022673606872558594
local_in_edges_tensor generation:  0.025550365447998047
mini_batch_src_global generation:  0.003233671188354492
r_  generation:  0.03289985656738281
local_output_nid generation:  0.0035376548767089844
local_in_edges_tensor generation:  0.003757953643798828
mini_batch_src_global generation:  0.003613710403442383
r_  generation:  0.032572269439697266
local_output_nid generation:  0.003315448760986328
local_in_edges_tensor generation:  0.003274679183959961
mini_batch_src_global generation:  0.0028824806213378906
r_  generation:  0.029881715774536133
local_output_nid generation:  0.0040738582611083984
local_in_edges_tensor generation:  0.004351377487182617
mini_batch_src_global generation:  0.005160331726074219
r_  generation:  0.05031943321228027
local_output_nid generation:  0.005994319915771484
local_in_edges_tensor generation:  0.004427194595336914
mini_batch_src_global generation:  0.017705917358398438
r_  generation:  0.04052257537841797
local_output_nid generation:  0.0035271644592285156
local_in_edges_tensor generation:  0.003129720687866211
mini_batch_src_global generation:  0.00341796875
r_  generation:  0.035515785217285156
local_output_nid generation:  0.003270387649536133
local_in_edges_tensor generation:  0.0029449462890625
mini_batch_src_global generation:  0.0036156177520751953
r_  generation:  0.0341796875
local_output_nid generation:  0.0031456947326660156
local_in_edges_tensor generation:  0.0028162002563476562
mini_batch_src_global generation:  0.004389524459838867
r_  generation:  0.03213667869567871
local_output_nid generation:  0.008620500564575195
local_in_edges_tensor generation:  0.015697717666625977
mini_batch_src_global generation:  0.017377138137817383
r_  generation:  0.16225457191467285
local_output_nid generation:  0.007805824279785156
local_in_edges_tensor generation:  0.0144805908203125
mini_batch_src_global generation:  0.01950526237487793
r_  generation:  0.1543283462524414
local_output_nid generation:  0.008529424667358398
local_in_edges_tensor generation:  0.009816884994506836
mini_batch_src_global generation:  0.022338151931762695
r_  generation:  0.1587975025177002
local_output_nid generation:  0.008008956909179688
local_in_edges_tensor generation:  0.008490562438964844
mini_batch_src_global generation:  0.0169527530670166
r_  generation:  0.1314983367919922
local_output_nid generation:  0.004303932189941406
local_in_edges_tensor generation:  0.004052162170410156
mini_batch_src_global generation:  0.007303714752197266
r_  generation:  0.04353690147399902
local_output_nid generation:  0.004197120666503906
local_in_edges_tensor generation:  0.004134654998779297
mini_batch_src_global generation:  0.004782199859619141
r_  generation:  0.04554104804992676
local_output_nid generation:  0.013889312744140625
local_in_edges_tensor generation:  0.008222818374633789
mini_batch_src_global generation:  0.013790130615234375
r_  generation:  0.1242530345916748
local_output_nid generation:  0.005360126495361328
local_in_edges_tensor generation:  0.005406379699707031
mini_batch_src_global generation:  0.010083436965942383
r_  generation:  0.07561111450195312
----------------------check_connections_block total spend ----------------------------- 1.8443448543548584
generate_one_block  0.058269500732421875
generate_one_block  0.04331779479980469
generate_one_block  0.042134761810302734
generate_one_block  0.06540608406066895
generate_one_block  0.05362200736999512
generate_one_block  0.044889211654663086
generate_one_block  0.055159807205200195
generate_one_block  0.04012727737426758
generate_one_block  0.23278594017028809
generate_one_block  0.2074265480041504
generate_one_block  0.217254638671875
generate_one_block  0.16648459434509277
generate_one_block  0.055216312408447266
generate_one_block  0.0575711727142334
generate_one_block  0.1698589324951172
generate_one_block  0.09354352951049805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.08248233795166016
gen group dst list time:  0.02555084228515625
time for parepare:  0.01911759376525879
local_output_nid generation:  0.0048503875732421875
local_in_edges_tensor generation:  0.01656627655029297
mini_batch_src_global generation:  0.005173444747924805
r_  generation:  0.05734872817993164
local_output_nid generation:  0.00856161117553711
local_in_edges_tensor generation:  0.007355928421020508
mini_batch_src_global generation:  0.007047176361083984
r_  generation:  0.06763195991516113
local_output_nid generation:  0.008589506149291992
local_in_edges_tensor generation:  0.006925106048583984
mini_batch_src_global generation:  0.0073146820068359375
r_  generation:  0.06861543655395508
local_output_nid generation:  0.012498855590820312
local_in_edges_tensor generation:  0.02464604377746582
mini_batch_src_global generation:  0.014177083969116211
r_  generation:  0.1154172420501709
local_output_nid generation:  0.00750732421875
local_in_edges_tensor generation:  0.0066678524017333984
mini_batch_src_global generation:  0.008381366729736328
r_  generation:  0.06411194801330566
local_output_nid generation:  0.00784921646118164
local_in_edges_tensor generation:  0.0064067840576171875
mini_batch_src_global generation:  0.007306098937988281
r_  generation:  0.0672464370727539
local_output_nid generation:  0.0067901611328125
local_in_edges_tensor generation:  0.00553441047668457
mini_batch_src_global generation:  0.007115840911865234
r_  generation:  0.05975985527038574
local_output_nid generation:  0.007710695266723633
local_in_edges_tensor generation:  0.006429433822631836
mini_batch_src_global generation:  0.007058143615722656
r_  generation:  0.0695943832397461
local_output_nid generation:  0.017868518829345703
local_in_edges_tensor generation:  0.0208284854888916
mini_batch_src_global generation:  0.02318572998046875
r_  generation:  0.2041025161743164
local_output_nid generation:  0.0165560245513916
local_in_edges_tensor generation:  0.020952939987182617
mini_batch_src_global generation:  0.022884607315063477
r_  generation:  0.17757415771484375
local_output_nid generation:  0.0186920166015625
local_in_edges_tensor generation:  0.018479108810424805
mini_batch_src_global generation:  0.030406713485717773
r_  generation:  0.21486544609069824
local_output_nid generation:  0.02198338508605957
local_in_edges_tensor generation:  0.024828672409057617
mini_batch_src_global generation:  0.02567887306213379
r_  generation:  0.24199128150939941
local_output_nid generation:  0.012468099594116211
local_in_edges_tensor generation:  0.010199546813964844
mini_batch_src_global generation:  0.016118288040161133
r_  generation:  0.12173318862915039
local_output_nid generation:  0.013649702072143555
local_in_edges_tensor generation:  0.009310722351074219
mini_batch_src_global generation:  0.012748956680297852
r_  generation:  0.1095280647277832
local_output_nid generation:  0.019419193267822266
local_in_edges_tensor generation:  0.016183853149414062
mini_batch_src_global generation:  0.02186417579650879
r_  generation:  0.21067571640014648
local_output_nid generation:  0.01401972770690918
local_in_edges_tensor generation:  0.012485265731811523
mini_batch_src_global generation:  0.01785445213317871
r_  generation:  0.14374136924743652
----------------------check_connections_block total spend ----------------------------- 3.145094394683838
generate_one_block  0.08371329307556152
generate_one_block  0.09204268455505371
generate_one_block  0.09250283241271973
generate_one_block  0.14867854118347168
generate_one_block  0.08802247047424316
generate_one_block  0.0850982666015625
generate_one_block  0.07823824882507324
generate_one_block  0.08716392517089844
generate_one_block  0.25589704513549805
generate_one_block  0.2280721664428711
generate_one_block  0.2733724117279053
generate_one_block  0.32106995582580566
generate_one_block  0.14540743827819824
generate_one_block  0.13585114479064941
generate_one_block  0.25640058517456055
generate_one_block  0.18521976470947266
dict sorted
[(6, 46368), (4, 48350), (0, 52460), (5, 57132), (7, 60630), (1, 63236), (2, 64526), (13, 85995), (3, 88731), (9, 90055), (15, 90590), (12, 93448), (8, 102950), (10, 107763), (14, 113525), (11, 124999)]
batch  0
tensor([ 6, 10,  9,  ..., 10,  4,  1])
tensor([1962.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0., 2178.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0., 2202.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0., 2015.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0., 1810.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0., 1598.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0., 1368.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0., 1276.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 1096.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 9723.])
Counter({10: 9723, 3: 2202, 2: 2178, 4: 2015, 1: 1962, 5: 1810, 6: 1598, 7: 1368, 8: 1276, 9: 1096})

batch  1
tensor([ 5,  1,  5,  ...,  1,  6, 10])
tensor([ 2406.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2715.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2582.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2294.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2099.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1735.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1552.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1419.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1189.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        10997.])
Counter({10: 10997, 2: 2715, 3: 2582, 1: 2406, 4: 2294, 5: 2099, 6: 1735, 7: 1552, 8: 1419, 9: 1189})

batch  2
tensor([ 1,  5,  1,  ..., 10, 10,  9])
tensor([ 2160.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2475.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2371.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2089.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1857.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1635.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1450.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1296.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1114.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11883.])
Counter({10: 11883, 2: 2475, 3: 2371, 1: 2160, 4: 2089, 5: 1857, 6: 1635, 7: 1450, 8: 1296, 9: 1114})

batch  3
tensor([10,  1, 10,  ...,  2,  5,  4])
tensor([ 1975.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2465.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2569.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2432.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2374.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2132.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1983.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1881.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1692.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        23134.])
Counter({10: 23134, 3: 2569, 2: 2465, 4: 2432, 5: 2374, 6: 2132, 7: 1983, 1: 1975, 8: 1881, 9: 1692})

batch  4
tensor([10, 10,  5,  ...,  1,  1,  1])
tensor([ 1722.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2043.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2049.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1872.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1764.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1546.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1374.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1238.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1039.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11060.])
Counter({10: 11060, 3: 2049, 2: 2043, 4: 1872, 5: 1764, 1: 1722, 6: 1546, 7: 1374, 8: 1238, 9: 1039})

batch  5
tensor([10,  4, 10,  ...,  9,  3, 10])
tensor([ 2182.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2353.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2312.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2075.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1941.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1656.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1417.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1291.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1064.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11326.])
Counter({10: 11326, 2: 2353, 3: 2312, 1: 2182, 4: 2075, 5: 1941, 6: 1656, 7: 1417, 8: 1291, 9: 1064})

batch  6
tensor([2, 4, 7,  ..., 7, 2, 2])
tensor([ 1310.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  1660.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  1796.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1682.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1578.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1448.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1292.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1183.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1016.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        10870.])
Counter({10: 10870, 3: 1796, 4: 1682, 2: 1660, 5: 1578, 6: 1448, 1: 1310, 7: 1292, 8: 1183, 9: 1016})

batch  7
tensor([ 1,  3,  8,  ..., 10, 10, 10])
tensor([ 1617.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2091.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2028.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1936.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1691.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1608.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1427.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1352.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1149.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        12034.])
Counter({10: 12034, 2: 2091, 3: 2028, 4: 1936, 5: 1691, 1: 1617, 6: 1608, 7: 1427, 8: 1352, 9: 1149})

batch  8
tensor([ 2, 10, 10,  ...,  8,  6,  5])
tensor([ 2461.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3016.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3301.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3274.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3197.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3086.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3029.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2882.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2757.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        44358.])
Counter({10: 44358, 3: 3301, 4: 3274, 5: 3197, 6: 3086, 7: 3029, 2: 3016, 8: 2882, 9: 2757, 1: 2461})

batch  9
tensor([ 3,  9, 10,  ...,  6,  2,  1])
tensor([ 1917.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2404.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2566.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2583.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2639.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2517.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2518.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2380.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2303.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        40502.])
Counter({10: 40502, 5: 2639, 4: 2583, 3: 2566, 7: 2518, 6: 2517, 2: 2404, 8: 2380, 9: 2303, 1: 1917})

batch  10
tensor([10,  4,  1,  ...,  5,  7,  1])
tensor([ 2658.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3436.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3643.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3659.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3554.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3397.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3268.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3117.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2997.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        46170.])
Counter({10: 46170, 4: 3659, 3: 3643, 5: 3554, 2: 3436, 6: 3397, 7: 3268, 8: 3117, 9: 2997, 1: 2658})

batch  11
tensor([ 2, 10,  2,  ...,  3, 10,  2])
tensor([ 3120.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  4109.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4354.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4306.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4190.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3969.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3810.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3657.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3423.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        50467.])
Counter({10: 50467, 3: 4354, 4: 4306, 5: 4190, 2: 4109, 6: 3969, 7: 3810, 8: 3657, 9: 3423, 1: 3120})

batch  12
tensor([ 2, 10,  3,  ...,  8,  1,  3])
tensor([ 2581.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3189.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3150.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2884.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2647.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2311.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2092.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1960.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1683.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        21088.])
Counter({10: 21088, 2: 3189, 3: 3150, 4: 2884, 5: 2647, 1: 2581, 6: 2311, 7: 2092, 8: 1960, 9: 1683})

batch  13
tensor([ 3,  6,  7,  ...,  2,  6, 10])
tensor([ 2326.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3036.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2996.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2759.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2565.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2194.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1982.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1845.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1642.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        19628.])
Counter({10: 19628, 2: 3036, 3: 2996, 4: 2759, 5: 2565, 1: 2326, 6: 2194, 7: 1982, 8: 1845, 9: 1642})

batch  14
tensor([ 3, 10,  4,  ..., 10,  3, 10])
tensor([ 2742.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3638.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3638.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3734.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3562.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3423.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3295.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3143.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3009.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        44443.])
Counter({10: 44443, 4: 3734, 3: 3638, 2: 3638, 5: 3562, 6: 3423, 7: 3295, 8: 3143, 9: 3009, 1: 2742})

batch  15
tensor([10,  5,  2,  ..., 10, 10, 10])
tensor([ 2577.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2974.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2847.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2670.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2526.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2312.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2164.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2055.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1861.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        29583.])
Counter({10: 29583, 2: 2974, 3: 2847, 4: 2670, 1: 2577, 5: 2526, 6: 2312, 7: 2164, 8: 2055, 9: 1861})

----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  15
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.58306884765625e-06  GigaBytes
Max Memory Allocated: 8.58306884765625e-06  GigaBytes

connection checking time:  5.457273960113525
block generation total time  4.591264247894287
average batch blocks generation time:  0.09565133849779765
pseudo mini batch 0 input nodes size: 52460
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.58306884765625e-06  GigaBytes
Max Memory Allocated: 8.58306884765625e-06  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 8.58306884765625e-06  GigaBytes
Max Memory Allocated: 8.58306884765625e-06  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.025399208068847656  GigaBytes
Max Memory Allocated: 0.025399208068847656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.025443077087402344  GigaBytes
Max Memory Allocated: 0.025443077087402344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.025443077087402344  GigaBytes
Max Memory Allocated: 0.025443077087402344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.0291290283203125  GigaBytes
Max Memory Allocated: 0.0291290283203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.0291290283203125  GigaBytes
Max Memory Allocated: 0.0291290283203125  GigaBytes

first layer input nodes number: 52460
first layer output nodes number: 25228
edges number: 166500
torch.Size([52460, 128])
torch.Size([25228, 6])
input nodes number: 25228
output nodes number: 12189
edges number: 100577
torch.Size([25228, 6])
torch.Size([12189, 6])
torch.Size([5853, 40])
input nodes number: 12189
output nodes number: 5853
edges number: 48362
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.04743003845214844  GigaBytes
Max Memory Allocated: 0.05386209487915039  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.04830360412597656  GigaBytes
Max Memory Allocated: 0.05386209487915039  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033432960510253906  GigaBytes
Max Memory Allocated: 0.05386209487915039  GigaBytes

pseudo mini batch 1 input nodes size: 63236
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026325225830078125  GigaBytes
Max Memory Allocated: 0.05386209487915039  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.026325225830078125  GigaBytes
Max Memory Allocated: 0.05386209487915039  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.05647850036621094  GigaBytes
Max Memory Allocated: 0.05647850036621094  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.056522369384765625  GigaBytes
Max Memory Allocated: 0.056522369384765625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.031087875366210938  GigaBytes
Max Memory Allocated: 0.056522369384765625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03500223159790039  GigaBytes
Max Memory Allocated: 0.056522369384765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3533935546875 GB
    Memory Allocated: 0.03500223159790039  GigaBytes
Max Memory Allocated: 0.056522369384765625  GigaBytes

first layer input nodes number: 63236
first layer output nodes number: 28988
edges number: 188550
torch.Size([63236, 128])
torch.Size([28988, 6])
input nodes number: 28988
output nodes number: 12314
edges number: 91738
torch.Size([28988, 6])
torch.Size([12314, 6])
torch.Size([5853, 40])
input nodes number: 12314
output nodes number: 5853
edges number: 41645
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.05444526672363281  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.055318355560302734  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.0383458137512207  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

pseudo mini batch 2 input nodes size: 64526
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.031087875366210938  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.031087875366210938  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.06233787536621094  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.062381744384765625  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.032184600830078125  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03609752655029297  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.03609752655029297  GigaBytes
Max Memory Allocated: 0.06344318389892578  GigaBytes

first layer input nodes number: 64526
first layer output nodes number: 28330
edges number: 191048
torch.Size([64526, 128])
torch.Size([28330, 6])
input nodes number: 28330
output nodes number: 11755
edges number: 89819
torch.Size([28330, 6])
torch.Size([11755, 6])
torch.Size([5854, 40])
input nodes number: 11755
output nodes number: 5854
edges number: 38861
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.055267333984375  GigaBytes
Max Memory Allocated: 0.064239501953125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.05614042282104492  GigaBytes
Max Memory Allocated: 0.064239501953125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.039354801177978516  GigaBytes
Max Memory Allocated: 0.064239501953125  GigaBytes

pseudo mini batch 3 input nodes size: 88731
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.032184600830078125  GigaBytes
Max Memory Allocated: 0.064239501953125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.032184600830078125  GigaBytes
Max Memory Allocated: 0.064239501953125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.07515335083007812  GigaBytes
Max Memory Allocated: 0.07515335083007812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.07519721984863281  GigaBytes
Max Memory Allocated: 0.07519721984863281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.043903350830078125  GigaBytes
Max Memory Allocated: 0.07519721984863281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.050459861755371094  GigaBytes
Max Memory Allocated: 0.07519721984863281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4588623046875 GB
    Memory Allocated: 0.050459861755371094  GigaBytes
Max Memory Allocated: 0.07519721984863281  GigaBytes

first layer input nodes number: 88731
first layer output nodes number: 42637
edges number: 324499
torch.Size([88731, 128])
torch.Size([42637, 6])
input nodes number: 42637
output nodes number: 14445
edges number: 152019
torch.Size([42637, 6])
torch.Size([14445, 6])
torch.Size([5854, 40])
input nodes number: 14445
output nodes number: 5854
edges number: 57251
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.07825899124145508  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.079132080078125  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.05542612075805664  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

pseudo mini batch 4 input nodes size: 48350
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.043903350830078125  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.043903350830078125  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.06695842742919922  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.0670022964477539  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.028121471405029297  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.028121471405029297  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

first layer input nodes number: 48350
first layer output nodes number: 25707
edges number: 177012
torch.Size([48350, 128])
torch.Size([25707, 6])
input nodes number: 25707
output nodes number: 13457
edges number: 131514
torch.Size([25707, 6])
torch.Size([13457, 6])
torch.Size([5854, 40])
input nodes number: 13457
output nodes number: 5854
edges number: 56055
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.046187400817871094  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.047060489654541016  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03212547302246094  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

pseudo mini batch 5 input nodes size: 57132
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02398967742919922  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.051232337951660156  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05127429962158203  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02817535400390625  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.032115936279296875  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.032115936279296875  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

first layer input nodes number: 57132
first layer output nodes number: 27617
edges number: 184848
torch.Size([57132, 128])
torch.Size([27617, 6])
input nodes number: 27617
output nodes number: 12141
edges number: 102984
torch.Size([27617, 6])
torch.Size([12141, 6])
torch.Size([5616, 40])
input nodes number: 12141
output nodes number: 5616
edges number: 42080
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.051262855529785156  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.052100181579589844  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.035518646240234375  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

pseudo mini batch 6 input nodes size: 46368
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.028139591217041016  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.028139591217041016  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.050249576568603516  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0502924919128418  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.023007869720458984  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.026886940002441406  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.026886940002441406  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

first layer input nodes number: 46368
first layer output nodes number: 23835
edges number: 169676
torch.Size([46368, 128])
torch.Size([23835, 6])
input nodes number: 23835
output nodes number: 10966
edges number: 110140
torch.Size([23835, 6])
torch.Size([10966, 6])
torch.Size([5741, 40])
input nodes number: 10966
output nodes number: 5741
edges number: 58893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0435481071472168  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.04440450668334961  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.030528545379638672  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

pseudo mini batch 7 input nodes size: 60630
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02302694320678711  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02302694320678711  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05193758010864258  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05197906494140625  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02982616424560547  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03375577926635742  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03375577926635742  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

first layer input nodes number: 60630
first layer output nodes number: 26933
edges number: 189216
torch.Size([60630, 128])
torch.Size([26933, 6])
input nodes number: 26933
output nodes number: 10992
edges number: 92330
torch.Size([26933, 6])
torch.Size([10992, 6])
torch.Size([5537, 40])
input nodes number: 10992
output nodes number: 5537
edges number: 42780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.052692413330078125  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05351829528808594  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03700399398803711  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

pseudo mini batch 8 input nodes size: 102950
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.02979564666748047  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.07888603210449219  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.07892751693725586  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.04997539520263672  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.06356334686279297  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.06356334686279297  GigaBytes
Max Memory Allocated: 0.09226036071777344  GigaBytes

first layer input nodes number: 102950
first layer output nodes number: 71361
edges number: 578645
torch.Size([102950, 128])
torch.Size([71361, 6])
input nodes number: 71361
output nodes number: 34038
edges number: 544310
torch.Size([71361, 6])
torch.Size([34038, 6])
torch.Size([5517, 40])
input nodes number: 34038
output nodes number: 5517
edges number: 86161
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11206769943237305  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11289072036743164  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.07587909698486328  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

pseudo mini batch 9 input nodes size: 90055
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.0499725341796875  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.0499725341796875  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.0929412841796875  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.09298515319824219  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.0438532829284668  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.056227684020996094  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.056227684020996094  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

first layer input nodes number: 90055
first layer output nodes number: 62329
edges number: 515465
torch.Size([90055, 128])
torch.Size([62329, 6])
input nodes number: 62329
output nodes number: 30325
edges number: 493949
torch.Size([62329, 6])
torch.Size([30325, 6])
torch.Size([5853, 40])
input nodes number: 30325
output nodes number: 5853
edges number: 104525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1000823974609375  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.10095548629760742  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.06824159622192383  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

pseudo mini batch 10 input nodes size: 107763
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.043903350830078125  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.043903350830078125  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09528875350952148  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.09533023834228516  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.05231761932373047  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.06686067581176758  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.06686067581176758  GigaBytes
Max Memory Allocated: 0.13318395614624023  GigaBytes

first layer input nodes number: 107763
first layer output nodes number: 75899
edges number: 609732
torch.Size([107763, 128])
torch.Size([75899, 6])
input nodes number: 75899
output nodes number: 33739
edges number: 515147
torch.Size([75899, 6])
torch.Size([33739, 6])
torch.Size([5548, 40])
input nodes number: 33739
output nodes number: 5548
edges number: 78946
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.11742687225341797  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.11825418472290039  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.07960844039916992  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

pseudo mini batch 11 input nodes size: 124999
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.05227184295654297  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.05227184295654297  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.11281871795654297  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.11286020278930664  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.06143331527709961  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.07578134536743164  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.07578134536743164  GigaBytes
Max Memory Allocated: 0.14089488983154297  GigaBytes

first layer input nodes number: 124999
first layer output nodes number: 85405
edges number: 677791
torch.Size([124999, 128])
torch.Size([85405, 6])
input nodes number: 85405
output nodes number: 28490
edges number: 395113
torch.Size([85405, 6])
torch.Size([28490, 6])
torch.Size([5517, 40])
input nodes number: 28490
output nodes number: 5517
edges number: 47941
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.1304788589477539  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.1313018798828125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08604145050048828  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 12 input nodes size: 93448
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.06142902374267578  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.06142902374267578  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.1059885025024414  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.10602998733520508  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.045441627502441406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.051424503326416016  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 93448
first layer output nodes number: 43585
edges number: 313397
torch.Size([93448, 128])
torch.Size([43585, 6])
input nodes number: 43585
output nodes number: 14195
edges number: 121068
torch.Size([43585, 6])
torch.Size([14195, 6])
torch.Size([5544, 40])
input nodes number: 14195
output nodes number: 5544
edges number: 33086
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0792841911315918  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08011102676391602  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05561637878417969  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 13 input nodes size: 85995
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04544544219970703  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04544544219970703  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08645105361938477  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08649253845214844  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04189157485961914  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0485529899597168  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0485529899597168  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 85995
first layer output nodes number: 40973
edges number: 294103
torch.Size([85995, 128])
torch.Size([40973, 6])
input nodes number: 40973
output nodes number: 14800
edges number: 130235
torch.Size([40973, 6])
torch.Size([14800, 6])
torch.Size([5544, 40])
input nodes number: 14800
output nodes number: 5544
edges number: 38528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0751032829284668  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.07593011856079102  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05286836624145508  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 14 input nodes size: 113525
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04189157485961914  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04189157485961914  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0960245132446289  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.09606599807739258  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05501890182495117  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0681304931640625  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0681304931640625  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 113525
first layer output nodes number: 74627
edges number: 593936
torch.Size([113525, 128])
torch.Size([74627, 6])
input nodes number: 74627
output nodes number: 28350
edges number: 400279
torch.Size([74627, 6])
torch.Size([28350, 6])
torch.Size([5517, 40])
input nodes number: 28350
output nodes number: 5517
edges number: 67293
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.11680984497070312  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.11763286590576172  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.07845592498779297  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 15 input nodes size: 90590
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05501508712768555  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05501508712768555  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.09821176528930664  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.09825468063354492  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.044080257415771484  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05219841003417969  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05219841003417969  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 90590
first layer output nodes number: 51569
edges number: 398415
torch.Size([90590, 128])
torch.Size([51569, 6])
input nodes number: 51569
output nodes number: 19263
edges number: 219395
torch.Size([51569, 6])
torch.Size([19263, 6])
torch.Size([5739, 40])
input nodes number: 19263
output nodes number: 5739
edges number: 47349
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08624267578125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.08709859848022461  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.058339595794677734  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05835676193237305  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05835676193237305  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |[21:30:15] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37290066 edges into 15 parts and get 10240303 edge cuts

      |0.016727179288864136 |0.030281513929367065 |0.05175480246543884 |0.00014513731002807617 |0.0035527050495147705 |0.001729726791381836 |
----------------------------------------------------------pseudo_mini_loss sum 3.9183945655822754
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2327240
Number of first layer input nodes during this epoch:  1290758
Number of first layer output nodes during this epoch:  735023
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.058356285095214844  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02928471565246582
global_2_local spend time (sec) 0.048610687255859375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005536556243896484
A = g.adjacency_matrix() spent  0.016806364059448242
auxiliary_graph
Graph(num_nodes=158234, num_edges=37381007,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0856316089630127
remove nodes length
67293
auxiliary_graph.remove_nodes spent  2.103621244430542
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37381007,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4676885604858398

the counter of shared neighbor distribution
Counter({1.0: 28435146, 2.0: 5958494, 3.0: 1747550, 4.0: 609560, 5.0: 252834, 6.0: 118658, 7.0: 62490, 8.0: 36346, 9.0: 21712, 10.0: 14456, 11.0: 9498, 12.0: 6448, 13.0: 4528, 14.0: 3276, 15.0: 2326, 16.0: 1738, 17.0: 1286, 18.0: 944, 19.0: 688, 20.0: 520, 21.0: 396, 22.0: 344, 23.0: 214, 24.0: 138, 25.0: 122, 26.0: 104, 27.0: 58, 29.0: 46, 30.0: 42, 28.0: 38, 31.0: 22, 32.0: 18, 38.0: 6, 33.0: 6, 39.0: 4, 34.0: 2, 49.0: 2, 40.0: 2, 42.0: 2, 35.0: 2})
37290066
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37290063, 37290064, 37290065])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28435146, 2.0: 5958494, 3.0: 1747550, 4.0: 609560, 5.0: 252834, 6.0: 118658, 7.0: 62490, 8.0: 36346, 9.0: 21712, 10.0: 14456, 11.0: 9498, 12.0: 6448, 13.0: 4528, 14.0: 3276, 15.0: 2326, 16.0: 1738, 17.0: 1286, 18.0: 944, 19.0: 688, 20.0: 520, 21.0: 396, 22.0: 344, 23.0: 214, 24.0: 138, 25.0: 122, 26.0: 104, 27.0: 58, 29.0: 46, 30.0: 42, 28.0: 38, 31.0: 22, 32.0: 18, 38.0: 6, 33.0: 6, 39.0: 4, 34.0: 2, 49.0: 2, 40.0: 2, 42.0: 2, 35.0: 2})
Convert a graph into a bidirected graph: 1.666 seconds
Metis partitioning: 6.383 seconds
Split the graph: 1.261 seconds
Construct subgraphs: 0.097 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.422679901123047
6206
6148
6195
5984
6069
6181
6160
5885
5905
6196
6206
5885
6093
5885
5943
total k batches seeds list generation spend  22.750451803207397
after graph partition
graph partition algorithm spend time 22.844586849212646
6206
6148
6195
5984
6069
6181
6160
5885
5905
6196
6206
5885
6093
5885
5943
partition_len_list
[10595, 14287, 12034, 14291, 15128, 11531, 11462, 22090, 24453, 16365, 15731, 38166, 31223, 35103, 35293]
shared_neighbor_graph_partition_s0 selection method  spend 22.946660041809082
time for parepare:  0.01731729507446289
local_output_nid generation:  0.0012862682342529297
local_in_edges_tensor generation:  0.0015261173248291016
mini_batch_src_global generation:  0.001516580581665039
r_  generation:  0.013025045394897461
local_output_nid generation:  0.001486063003540039
local_in_edges_tensor generation:  0.0014693737030029297
mini_batch_src_global generation:  0.0016574859619140625
r_  generation:  0.01602935791015625
local_output_nid generation:  0.0017628669738769531
local_in_edges_tensor generation:  0.0014095306396484375
mini_batch_src_global generation:  0.0015947818756103516
r_  generation:  0.016005277633666992
local_output_nid generation:  0.0018000602722167969
local_in_edges_tensor generation:  0.0014040470123291016
mini_batch_src_global generation:  0.0017821788787841797
r_  generation:  0.017879962921142578
local_output_nid generation:  0.0018856525421142578
local_in_edges_tensor generation:  0.0014579296112060547
mini_batch_src_global generation:  0.001705169677734375
r_  generation:  0.0174713134765625
local_output_nid generation:  0.002034902572631836
local_in_edges_tensor generation:  0.001485586166381836
mini_batch_src_global generation:  0.0018415451049804688
r_  generation:  0.01900768280029297
local_output_nid generation:  0.002000570297241211
local_in_edges_tensor generation:  0.0013875961303710938
mini_batch_src_global generation:  0.0013630390167236328
r_  generation:  0.014862060546875
local_output_nid generation:  0.0019822120666503906
local_in_edges_tensor generation:  0.0013267993927001953
mini_batch_src_global generation:  0.0012753009796142578
r_  generation:  0.015154600143432617
local_output_nid generation:  0.0018804073333740234
local_in_edges_tensor generation:  0.0013186931610107422
mini_batch_src_global generation:  0.0017428398132324219
r_  generation:  0.019026756286621094
local_output_nid generation:  0.0020563602447509766
local_in_edges_tensor generation:  0.0013685226440429688
mini_batch_src_global generation:  0.0013632774353027344
r_  generation:  0.01527261734008789
local_output_nid generation:  0.002060413360595703
local_in_edges_tensor generation:  0.0014667510986328125
mini_batch_src_global generation:  0.0017037391662597656
r_  generation:  0.01884603500366211
local_output_nid generation:  0.0020699501037597656
local_in_edges_tensor generation:  0.002360105514526367
mini_batch_src_global generation:  0.003003358840942383
r_  generation:  0.0271456241607666
local_output_nid generation:  0.0025234222412109375
local_in_edges_tensor generation:  0.0021250247955322266
mini_batch_src_global generation:  0.0036394596099853516
r_  generation:  0.03314828872680664
local_output_nid generation:  0.0023653507232666016
local_in_edges_tensor generation:  0.0015969276428222656
mini_batch_src_global generation:  0.002245187759399414
r_  generation:  0.023685932159423828
local_output_nid generation:  0.00229644775390625
local_in_edges_tensor generation:  0.0019102096557617188
mini_batch_src_global generation:  0.0028786659240722656
r_  generation:  0.02942514419555664
----------------------check_connections_block total spend ----------------------------- 0.4720337390899658
generate_one_block  0.02228832244873047
generate_one_block  0.02410125732421875
generate_one_block  0.020763397216796875
generate_one_block  0.02415776252746582
generate_one_block  0.024003028869628906
generate_one_block  0.02490401268005371
generate_one_block  0.019573450088500977
generate_one_block  0.02191781997680664
generate_one_block  0.024917125701904297
generate_one_block  0.020178556442260742
generate_one_block  0.02605891227722168
generate_one_block  0.040506839752197266
generate_one_block  0.04817938804626465
generate_one_block  0.03371858596801758
generate_one_block  0.041059255599975586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0460970401763916
gen group dst list time:  0.00900411605834961
time for parepare:  0.02203536033630371
local_output_nid generation:  0.0020287036895751953
local_in_edges_tensor generation:  0.015498876571655273
mini_batch_src_global generation:  0.0021250247955322266
r_  generation:  0.021482229232788086
local_output_nid generation:  0.003779888153076172
local_in_edges_tensor generation:  0.003621816635131836
mini_batch_src_global generation:  0.004230499267578125
r_  generation:  0.039721012115478516
local_output_nid generation:  0.0034706592559814453
local_in_edges_tensor generation:  0.003144979476928711
mini_batch_src_global generation:  0.003537416458129883
r_  generation:  0.031211137771606445
local_output_nid generation:  0.004109382629394531
local_in_edges_tensor generation:  0.003995418548583984
mini_batch_src_global generation:  0.004109382629394531
r_  generation:  0.04214978218078613
local_output_nid generation:  0.004294395446777344
local_in_edges_tensor generation:  0.00553441047668457
mini_batch_src_global generation:  0.0054056644439697266
r_  generation:  0.04739665985107422
local_output_nid generation:  0.0034596920013427734
local_in_edges_tensor generation:  0.0032262802124023438
mini_batch_src_global generation:  0.004163503646850586
r_  generation:  0.03673148155212402
local_output_nid generation:  0.003300905227661133
local_in_edges_tensor generation:  0.0031766891479492188
mini_batch_src_global generation:  0.0029098987579345703
r_  generation:  0.02951645851135254
local_output_nid generation:  0.006128787994384766
local_in_edges_tensor generation:  0.007867097854614258
mini_batch_src_global generation:  0.009055852890014648
r_  generation:  0.0831451416015625
local_output_nid generation:  0.006885528564453125
local_in_edges_tensor generation:  0.010524749755859375
mini_batch_src_global generation:  0.012120723724365234
r_  generation:  0.10012388229370117
local_output_nid generation:  0.004876613616943359
local_in_edges_tensor generation:  0.00452733039855957
mini_batch_src_global generation:  0.006808042526245117
r_  generation:  0.0515439510345459
local_output_nid generation:  0.004586935043334961
local_in_edges_tensor generation:  0.004460811614990234
mini_batch_src_global generation:  0.006320476531982422
r_  generation:  0.05450010299682617
local_output_nid generation:  0.00989675521850586
local_in_edges_tensor generation:  0.014525890350341797
mini_batch_src_global generation:  0.021236419677734375
r_  generation:  0.18186712265014648
local_output_nid generation:  0.008255243301391602
local_in_edges_tensor generation:  0.014255523681640625
mini_batch_src_global generation:  0.021012544631958008
r_  generation:  0.1545560359954834
local_output_nid generation:  0.009746789932250977
local_in_edges_tensor generation:  0.012232542037963867
mini_batch_src_global generation:  0.020543575286865234
r_  generation:  0.16512155532836914
local_output_nid generation:  0.009562492370605469
local_in_edges_tensor generation:  0.01079416275024414
mini_batch_src_global generation:  0.023675203323364258
r_  generation:  0.1744823455810547
----------------------check_connections_block total spend ----------------------------- 1.8645045757293701
generate_one_block  0.032640695571899414
generate_one_block  0.06762814521789551
generate_one_block  0.04466581344604492
generate_one_block  0.05687117576599121
generate_one_block  0.06344366073608398
generate_one_block  0.04773998260498047
generate_one_block  0.037497520446777344
generate_one_block  0.11737513542175293
generate_one_block  0.13831329345703125
generate_one_block  0.06615090370178223
generate_one_block  0.07227253913879395
generate_one_block  0.2519659996032715
generate_one_block  0.2158665657043457
generate_one_block  0.22614550590515137
generate_one_block  0.2302088737487793
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03189802169799805
gen group dst list time:  0.025390625
time for parepare:  0.023972749710083008
local_output_nid generation:  0.0042552947998046875
local_in_edges_tensor generation:  0.009512662887573242
mini_batch_src_global generation:  0.0037157535552978516
r_  generation:  0.03704547882080078
local_output_nid generation:  0.012617111206054688
local_in_edges_tensor generation:  0.009388923645019531
mini_batch_src_global generation:  0.015883207321166992
r_  generation:  0.0864875316619873
local_output_nid generation:  0.00982975959777832
local_in_edges_tensor generation:  0.006414890289306641
mini_batch_src_global generation:  0.007087230682373047
r_  generation:  0.06328248977661133
local_output_nid generation:  0.011690139770507812
local_in_edges_tensor generation:  0.006869316101074219
mini_batch_src_global generation:  0.008690118789672852
r_  generation:  0.07227206230163574
local_output_nid generation:  0.014051437377929688
local_in_edges_tensor generation:  0.00818324089050293
mini_batch_src_global generation:  0.012241125106811523
r_  generation:  0.08701944351196289
local_output_nid generation:  0.009845256805419922
local_in_edges_tensor generation:  0.006365776062011719
mini_batch_src_global generation:  0.007419109344482422
r_  generation:  0.0660562515258789
local_output_nid generation:  0.010495185852050781
local_in_edges_tensor generation:  0.006441593170166016
mini_batch_src_global generation:  0.007212638854980469
r_  generation:  0.06549406051635742
local_output_nid generation:  0.02265763282775879
local_in_edges_tensor generation:  0.0183103084564209
mini_batch_src_global generation:  0.018727779388427734
r_  generation:  0.19415998458862305
local_output_nid generation:  0.02235579490661621
local_in_edges_tensor generation:  0.018065452575683594
mini_batch_src_global generation:  0.02076864242553711
r_  generation:  0.18873286247253418
local_output_nid generation:  0.016333341598510742
local_in_edges_tensor generation:  0.01067972183227539
mini_batch_src_global generation:  0.01507258415222168
r_  generation:  0.12142133712768555
local_output_nid generation:  0.016913175582885742
local_in_edges_tensor generation:  0.011507272720336914
mini_batch_src_global generation:  0.014686822891235352
r_  generation:  0.1357736587524414
local_output_nid generation:  0.025130033493041992
local_in_edges_tensor generation:  0.020529747009277344
mini_batch_src_global generation:  0.02584362030029297
r_  generation:  0.23624324798583984
local_output_nid generation:  0.0196073055267334
local_in_edges_tensor generation:  0.015721797943115234
mini_batch_src_global generation:  0.02220606803894043
r_  generation:  0.1842496395111084
local_output_nid generation:  0.026968955993652344
local_in_edges_tensor generation:  0.022958040237426758
mini_batch_src_global generation:  0.026216745376586914
r_  generation:  0.24663019180297852
local_output_nid generation:  0.0243377685546875
local_in_edges_tensor generation:  0.021327733993530273
mini_batch_src_global generation:  0.025882959365844727
r_  generation:  0.22663474082946777
----------------------check_connections_block total spend ----------------------------- 3.1891894340515137
generate_one_block  0.04992842674255371
generate_one_block  0.11684417724609375
generate_one_block  0.07607126235961914
generate_one_block  0.09232807159423828
generate_one_block  0.11297130584716797
generate_one_block  0.09954166412353516
generate_one_block  0.08451318740844727
generate_one_block  0.2376575469970703
generate_one_block  0.23867416381835938
generate_one_block  0.14668941497802734
generate_one_block  0.16550898551940918
generate_one_block  0.2987525463104248
generate_one_block  0.23336124420166016
generate_one_block  0.33052825927734375
generate_one_block  0.2770683765411377
dict sorted
[(0, 38079), (5, 47580), (2, 51554), (3, 57089), (6, 61124), (4, 69259), (1, 75481), (9, 91619), (12, 92472), (10, 93954), (8, 106427), (14, 111930), (7, 113324), (11, 115540), (13, 123921)]
batch  0
tensor([10,  7,  5,  ...,  4,  1,  1])
tensor([2097.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0., 2369.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0., 1943.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0., 1645.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0., 1352.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0., 1115.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,  950.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,  816.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,  673.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 5152.])
Counter({10: 5152, 2: 2369, 1: 2097, 3: 1943, 4: 1645, 5: 1352, 6: 1115, 7: 950, 8: 816, 9: 673})

batch  1
tensor([ 1,  1,  2,  ..., 10, 10,  1])
tensor([ 2346.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2778.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2809.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2599.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2323.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2125.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1859.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1662.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1469.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        15180.])
Counter({10: 15180, 3: 2809, 2: 2778, 4: 2599, 1: 2346, 5: 2323, 6: 2125, 7: 1859, 8: 1662, 9: 1469})

batch  2
tensor([ 5, 10, 10,  ...,  6, 10,  3])
tensor([2027.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0., 2205.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0., 2148.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0., 1945.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0., 1826.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0., 1568.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0., 1342.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0., 1215.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 1036.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 9103.])
Counter({10: 9103, 2: 2205, 3: 2148, 1: 2027, 4: 1945, 5: 1826, 6: 1568, 7: 1342, 8: 1215, 9: 1036})

batch  3
tensor([1, 1, 2,  ..., 4, 3, 3])
tensor([ 2127.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2445.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2475.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2252.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2022.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1780.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1565.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1388.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1227.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        12118.])
Counter({10: 12118, 3: 2475, 2: 2445, 4: 2252, 1: 2127, 5: 2022, 6: 1780, 7: 1565, 8: 1388, 9: 1227})

batch  4
tensor([ 2,  3, 10,  ...,  7,  3,  5])
tensor([ 1998.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2474.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2562.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2454.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2290.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2020.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1876.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1737.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1467.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        15659.])
Counter({10: 15659, 3: 2562, 2: 2474, 4: 2454, 5: 2290, 6: 2020, 1: 1998, 7: 1876, 8: 1737, 9: 1467})

batch  5
tensor([7, 3, 4,  ..., 2, 2, 9])
tensor([ 1268.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  1688.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  1749.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1643.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1501.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1418.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1318.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1211.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1068.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11614.])
Counter({10: 11614, 3: 1749, 2: 1688, 4: 1643, 5: 1501, 6: 1418, 7: 1318, 1: 1268, 8: 1211, 9: 1068})

batch  6
tensor([ 4,  3,  3,  ..., 10,  3,  2])
tensor([ 2226.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2438.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2306.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1984.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1769.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1557.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1310.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1211.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,   966.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        10405.])
Counter({10: 10405, 2: 2438, 3: 2306, 1: 2226, 4: 1984, 5: 1769, 6: 1557, 7: 1310, 8: 1211, 9: 966})

batch  7
tensor([10,  1,  4,  ..., 10,  8,  4])
tensor([ 3089.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3804.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3830.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3704.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3649.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3212.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3025.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2845.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2657.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        39255.])
Counter({10: 39255, 3: 3830, 2: 3804, 4: 3704, 5: 3649, 6: 3212, 1: 3089, 7: 3025, 8: 2845, 9: 2657})

batch  8
tensor([ 8, 10, 10,  ...,  9,  6,  5])
tensor([ 2898.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3635.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3527.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3460.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3365.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3087.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2873.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2757.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2554.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        39309.])
Counter({10: 39309, 2: 3635, 3: 3527, 4: 3460, 5: 3365, 6: 3087, 1: 2898, 7: 2873, 8: 2757, 9: 2554})

batch  9
tensor([10,  9, 10,  ...,  1,  2,  3])
tensor([ 2852.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3520.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3353.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3071.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2893.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2482.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2255.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2139.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1776.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        20840.])
Counter({10: 20840, 2: 3520, 3: 3353, 4: 3071, 5: 2893, 1: 2852, 6: 2482, 7: 2255, 8: 2139, 9: 1776})

batch  10
tensor([ 2,  4,  5,  ..., 10, 10, 10])
tensor([ 2180.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2786.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2865.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2747.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2659.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2406.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2141.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2132.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1847.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        24474.])
Counter({10: 24474, 3: 2865, 2: 2786, 4: 2747, 5: 2659, 6: 2406, 1: 2180, 7: 2141, 8: 2132, 9: 1847})

batch  11
tensor([ 6,  1,  5,  ...,  9, 10, 10])
tensor([ 2992.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3948.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4172.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4195.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4116.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3855.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3747.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3542.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3376.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        49210.])
Counter({10: 49210, 4: 4195, 3: 4172, 5: 4116, 2: 3948, 6: 3855, 7: 3747, 8: 3542, 9: 3376, 1: 2992})

batch  12
tensor([10, 10,  5,  ...,  6, 10, 10])
tensor([ 2067.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2626.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2691.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2715.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2718.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2641.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2624.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2475.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2370.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        40859.])
Counter({10: 40859, 5: 2718, 4: 2715, 3: 2691, 6: 2641, 2: 2626, 7: 2624, 8: 2475, 9: 2370, 1: 2067})

batch  13
tensor([10,  3,  8,  ...,  6,  4,  1])
tensor([ 3251.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  4393.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4512.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4591.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4464.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  4235.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  4009.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3819.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3543.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        50731.])
Counter({10: 50731, 4: 4591, 3: 4512, 5: 4464, 2: 4393, 6: 4235, 7: 4009, 8: 3819, 9: 3543, 1: 3251})

batch  14
tensor([10, 10,  1,  ...,  7,  8,  5])
tensor([ 2852.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3848.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3905.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3955.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3876.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3632.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3513.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3385.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3141.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        47184.])
Counter({10: 47184, 4: 3955, 3: 3905, 5: 3876, 2: 3848, 6: 3632, 7: 3513, 8: 3385, 9: 3141, 1: 2852})

----------===============-------------===============-------------the number of batches *****---- 15

original number of batches:  14
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.058356285095214844  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

connection checking time:  5.52572774887085
block generation total time  4.645552158355713
average batch blocks generation time:  0.10323449240790473
block dataloader generation time/epoch 33.67430877685547
pseudo mini batch 0 input nodes size: 38079
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.044129371643066406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.044129371643066406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.0622868537902832  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.062333106994628906  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.01909351348876953  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.02144908905029297  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.02144908905029297  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 38079
first layer output nodes number: 18112
edges number: 103449
torch.Size([38079, 128])
torch.Size([18112, 6])
input nodes number: 18112
output nodes number: 10595
edges number: 62964
torch.Size([18112, 6])
torch.Size([10595, 6])
torch.Size([6206, 40])
input nodes number: 10595
output nodes number: 6206
edges number: 36974
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.034529685974121094  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.03545570373535156  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.023937702178955078  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 1 input nodes size: 75481
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.019164085388183594  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.019164085388183594  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.05515623092651367  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.055202484130859375  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.036998748779296875  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04202413558959961  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.04202413558959961  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 75481
first layer output nodes number: 35150
edges number: 242420
torch.Size([75481, 128])
torch.Size([35150, 6])
input nodes number: 35150
output nodes number: 14287
edges number: 122916
torch.Size([35150, 6])
torch.Size([14287, 6])
torch.Size([6148, 40])
input nodes number: 14287
output nodes number: 6148
edges number: 48951
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.06541967391967773  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.06633663177490234  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.046187400817871094  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 2 input nodes size: 51554
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03699016571044922  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.06238079071044922  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.06242704391479492  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.02638864517211914  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.029892921447753906  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.029892921447753906  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 51554
first layer output nodes number: 24415
edges number: 158667
torch.Size([51554, 128])
torch.Size([24415, 6])
input nodes number: 24415
output nodes number: 12034
edges number: 93398
torch.Size([24415, 6])
torch.Size([12034, 6])
torch.Size([6195, 40])
input nodes number: 12034
output nodes number: 6195
edges number: 47188
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04686880111694336  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04779243469238281  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03317594528198242  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 3 input nodes size: 57089
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.026395320892333984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.026395320892333984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05361747741699219  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05366230010986328  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.028225421905517578  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03269624710083008  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03269624710083008  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 57089
first layer output nodes number: 29399
edges number: 198522
torch.Size([57089, 128])
torch.Size([29399, 6])
input nodes number: 29399
output nodes number: 14291
edges number: 132166
torch.Size([29399, 6])
torch.Size([14291, 6])
torch.Size([5984, 40])
input nodes number: 14291
output nodes number: 5984
edges number: 55990
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.052904605865478516  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05379676818847656  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.036832332611083984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 4 input nodes size: 69259
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.028193950653076172  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.028193950653076172  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.061219215393066406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0612645149230957  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.033997535705566406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03929328918457031  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03929328918457031  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 69259
first layer output nodes number: 34537
edges number: 244839
torch.Size([69259, 128])
torch.Size([34537, 6])
input nodes number: 34537
output nodes number: 15128
edges number: 150378
torch.Size([34537, 6])
torch.Size([15128, 6])
torch.Size([6069, 40])
input nodes number: 15128
output nodes number: 6069
edges number: 53331
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.06263303756713867  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0635380744934082  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04391050338745117  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 5 input nodes size: 47580
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03401041030883789  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03401041030883789  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05669832229614258  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05674457550048828  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.02367401123046875  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.027685165405273438  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.027685165405273438  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 47580
first layer output nodes number: 24478
edges number: 177142
torch.Size([47580, 128])
torch.Size([24478, 6])
input nodes number: 24478
output nodes number: 11531
edges number: 112505
torch.Size([24478, 6])
torch.Size([11531, 6])
torch.Size([6181, 40])
input nodes number: 11531
output nodes number: 6181
edges number: 59177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04485607147216797  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04577779769897461  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0314021110534668  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 6 input nodes size: 61124
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.02369070053100586  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.02369070053100586  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05283689498901367  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.052883148193359375  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.030148983001708984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03376007080078125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.03376007080078125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 61124
first layer output nodes number: 26172
edges number: 171745
torch.Size([61124, 128])
torch.Size([26172, 6])
input nodes number: 26172
output nodes number: 11462
edges number: 84754
torch.Size([26172, 6])
torch.Size([11462, 6])
torch.Size([6160, 40])
input nodes number: 11462
output nodes number: 6160
edges number: 43124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05159282684326172  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05251121520996094  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.036934852600097656  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 7 input nodes size: 113324
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.030145645141601562  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.030145645141601562  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0841827392578125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08422660827636719  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05503416061401367  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0660557746887207  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0660557746887207  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 113324
first layer output nodes number: 69070
edges number: 534918
torch.Size([113324, 128])
torch.Size([69070, 6])
input nodes number: 69070
output nodes number: 22090
edges number: 259023
torch.Size([69070, 6])
torch.Size([22090, 6])
torch.Size([5885, 40])
input nodes number: 22090
output nodes number: 5885
edges number: 44353
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.1097574234008789  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.11063528060913086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.07323026657104492  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 8 input nodes size: 106427
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.054993629455566406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.054993629455566406  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.1057748794555664  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.1058192253112793  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05173826217651367  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.06255865097045898  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.06255865097045898  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 106427
first layer output nodes number: 67465
edges number: 528179
torch.Size([106427, 128])
torch.Size([67465, 6])
input nodes number: 67465
output nodes number: 24453
edges number: 309596
torch.Size([67465, 6])
torch.Size([24453, 6])
torch.Size([5905, 40])
input nodes number: 24453
output nodes number: 5905
edges number: 52270
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10658836364746094  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10746908187866211  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.07151603698730469  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 9 input nodes size: 91619
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05174112319946289  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05174112319946289  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.095428466796875  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0954747200012207  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04464912414550781  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05093526840209961  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05093526840209961  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 91619
first layer output nodes number: 45181
edges number: 318873
torch.Size([91619, 128])
torch.Size([45181, 6])
input nodes number: 45181
output nodes number: 16365
edges number: 141043
torch.Size([45181, 6])
torch.Size([16365, 6])
torch.Size([6196, 40])
input nodes number: 16365
output nodes number: 6196
edges number: 42079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08022785186767578  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08115196228027344  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05566835403442383  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 10 input nodes size: 93954
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0446925163269043  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0446925163269043  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0894932746887207  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0895395278930664  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.045805931091308594  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.053615570068359375  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.053615570068359375  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 93954
first layer output nodes number: 46237
edges number: 348472
torch.Size([93954, 128])
torch.Size([46237, 6])
input nodes number: 46237
output nodes number: 15731
edges number: 163513
torch.Size([46237, 6])
torch.Size([15731, 6])
torch.Size([6206, 40])
input nodes number: 15731
output nodes number: 6206
edges number: 58748
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08368968963623047  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08461523056030273  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0589141845703125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 11 input nodes size: 115540
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0458073616027832  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0458073616027832  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10090112686157227  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10094499588012695  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.056097984313964844  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0718069076538086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.0718069076538086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 115540
first layer output nodes number: 83153
edges number: 660943
torch.Size([115540, 128])
torch.Size([83153, 6])
input nodes number: 83153
output nodes number: 38166
edges number: 590229
torch.Size([83153, 6])
torch.Size([38166, 6])
torch.Size([5885, 40])
input nodes number: 38166
output nodes number: 5885
edges number: 83547
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.12807083129882812  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.12894868850708008  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.08542346954345703  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 12 input nodes size: 92472
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05605030059814453  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.05605030059814453  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.1001443862915039  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.1001901626586914  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.045052528381347656  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.058438777923583984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.058438777923583984  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 92472
first layer output nodes number: 63786
edges number: 523776
torch.Size([92472, 128])
torch.Size([63786, 6])
input nodes number: 63786
output nodes number: 31223
edges number: 499466
torch.Size([63786, 6])
torch.Size([31223, 6])
torch.Size([6093, 40])
input nodes number: 31223
output nodes number: 6093
edges number: 105641
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10382604598999023  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10473489761352539  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.07077932357788086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

pseudo mini batch 13 input nodes size: 123921
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04508352279663086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.04508352279663086  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.10417366027832031  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.104217529296875  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.060077667236328125  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.07502269744873047  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.07502269744873047  GigaBytes
Max Memory Allocated: 0.1591167449951172  GigaBytes

first layer input nodes number: 123921
first layer output nodes number: 87548
edges number: 689479
torch.Size([123921, 128])
torch.Size([87548, 6])
input nodes number: 87548
output nodes number: 35103
edges number: 514265
torch.Size([87548, 6])
torch.Size([35103, 6])
torch.Size([5885, 40])
input nodes number: 35103
output nodes number: 5885
edges number: 68723
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.1324481964111328  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.13332605361938477  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.0873870849609375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 14 input nodes size: 111930
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.06004667282104492  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.06004667282104492  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes
[21:30:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 37176774 edges into 14 parts and get 10006189 edge cuts

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1134190559387207  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1134634017944336  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05432939529418945  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06896543502807617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06896543502807617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 111930
first layer output nodes number: 79291
edges number: 631035
torch.Size([111930, 128])
torch.Size([79291, 6])
input nodes number: 79291
output nodes number: 35293
edges number: 537064
torch.Size([79291, 6])
torch.Size([35293, 6])
torch.Size([5943, 40])
input nodes number: 35293
output nodes number: 5943
edges number: 89660
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.12191963195800781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.12280607223510742  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08148193359375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08148193359375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08148193359375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020013888676961262 |0.011122957865397135 |0.005078617731730143 |0.00015695889790852865 |0.0035980701446533202 |0.0016713142395019531 |
----------------------------------------------------------pseudo_mini_loss sum 3.696782112121582
Total (block generation + training)time/epoch 34.316922426223755
Training time/epoch 0.6423792839050293
Training time without block to device /epoch 0.47553491592407227
Training time without total dataloading part /epoch 0.13417601585388184
load block tensor time/epoch 0.30020833015441895
block to device time/epoch 0.16684436798095703
input features size transfer per epoch 2.0116567611694336e-06
blocks size to device per epoch 1.341104507446289e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2291099
Number of first layer input nodes during this epoch:  1249353
Number of first layer output nodes during this epoch:  733994
----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0814814567565918  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02909398078918457
global_2_local spend time (sec) 0.052887678146362305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048694610595703125
A = g.adjacency_matrix() spent  0.017034530639648438
auxiliary_graph
Graph(num_nodes=158259, num_edges=37267715,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09481525421142578
remove nodes length
67318
auxiliary_graph.remove_nodes spent  1.9857616424560547
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=37267715,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.5276048183441162

the counter of shared neighbor distribution
Counter({1.0: 28344234, 2.0: 5931558, 3.0: 1754360, 4.0: 609494, 5.0: 251928, 6.0: 118138, 7.0: 62200, 8.0: 36066, 9.0: 21684, 10.0: 14400, 11.0: 9328, 12.0: 6430, 13.0: 4394, 14.0: 3458, 15.0: 2414, 16.0: 1634, 17.0: 1306, 18.0: 922, 19.0: 636, 20.0: 552, 21.0: 404, 22.0: 324, 23.0: 222, 24.0: 186, 25.0: 134, 26.0: 110, 27.0: 70, 29.0: 44, 28.0: 34, 30.0: 34, 31.0: 24, 32.0: 20, 40.0: 6, 38.0: 4, 34.0: 4, 35.0: 4, 36.0: 4, 33.0: 4, 49.0: 2, 41.0: 2, 37.0: 2})
37176774
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 37176771, 37176772, 37176773])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 28344234, 2.0: 5931558, 3.0: 1754360, 4.0: 609494, 5.0: 251928, 6.0: 118138, 7.0: 62200, 8.0: 36066, 9.0: 21684, 10.0: 14400, 11.0: 9328, 12.0: 6430, 13.0: 4394, 14.0: 3458, 15.0: 2414, 16.0: 1634, 17.0: 1306, 18.0: 922, 19.0: 636, 20.0: 552, 21.0: 404, 22.0: 324, 23.0: 222, 24.0: 186, 25.0: 134, 26.0: 110, 27.0: 70, 29.0: 44, 28.0: 34, 30.0: 34, 31.0: 24, 32.0: 20, 40.0: 6, 38.0: 4, 34.0: 4, 35.0: 4, 36.0: 4, 33.0: 4, 49.0: 2, 41.0: 2, 37.0: 2})
Convert a graph into a bidirected graph: 1.673 seconds
Metis partitioning: 6.392 seconds
Split the graph: 1.461 seconds
Construct subgraphs: 0.118 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.661442518234253
6611
6610
6595
6681
6623
6503
6563
6377
6441
6310
6325
6306
6690
6306
total k batches seeds list generation spend  23.059452295303345
after graph partition
graph partition algorithm spend time 23.16288113594055
6611
6610
6595
6681
6623
6503
6563
6377
6441
6310
6325
6306
6690
6306
partition_len_list
[11920, 15597, 13012, 12616, 16653, 14737, 14154, 18607, 18182, 25351, 37260, 35305, 34292, 38117]
shared_neighbor_graph_partition_s0 selection method  spend 23.268526554107666
time for parepare:  0.016556501388549805
local_output_nid generation:  0.0014605522155761719
local_in_edges_tensor generation:  0.0017032623291015625
mini_batch_src_global generation:  0.0017650127410888672
r_  generation:  0.016678810119628906
local_output_nid generation:  0.0017287731170654297
local_in_edges_tensor generation:  0.001683950424194336
mini_batch_src_global generation:  0.002418994903564453
r_  generation:  0.02151775360107422
local_output_nid generation:  0.0018253326416015625
local_in_edges_tensor generation:  0.001623392105102539
mini_batch_src_global generation:  0.0019712448120117188
r_  generation:  0.016616106033325195
local_output_nid generation:  0.0018346309661865234
local_in_edges_tensor generation:  0.0015869140625
mini_batch_src_global generation:  0.0017671585083007812
r_  generation:  0.01942276954650879
local_output_nid generation:  0.001920461654663086
local_in_edges_tensor generation:  0.0015194416046142578
mini_batch_src_global generation:  0.001889944076538086
r_  generation:  0.018918514251708984
local_output_nid generation:  0.0018911361694335938
local_in_edges_tensor generation:  0.002886056900024414
mini_batch_src_global generation:  0.001729726791381836
r_  generation:  0.01868605613708496
local_output_nid generation:  0.0018875598907470703
local_in_edges_tensor generation:  0.001730203628540039
mini_batch_src_global generation:  0.0020236968994140625
r_  generation:  0.02024984359741211
local_output_nid generation:  0.0019068717956542969
local_in_edges_tensor generation:  0.001588582992553711
mini_batch_src_global generation:  0.0014965534210205078
r_  generation:  0.01484823226928711
local_output_nid generation:  0.0018711090087890625
local_in_edges_tensor generation:  0.0014967918395996094
mini_batch_src_global generation:  0.0012891292572021484
r_  generation:  0.01556706428527832
local_output_nid generation:  0.0018076896667480469
local_in_edges_tensor generation:  0.0014274120330810547
mini_batch_src_global generation:  0.0015172958374023438
r_  generation:  0.018456459045410156
local_output_nid generation:  0.0018734931945800781
local_in_edges_tensor generation:  0.00165557861328125
mini_batch_src_global generation:  0.0031647682189941406
r_  generation:  0.03149914741516113
local_output_nid generation:  0.0021142959594726562
local_in_edges_tensor generation:  0.0016794204711914062
mini_batch_src_global generation:  0.0027282238006591797
r_  generation:  0.02422356605529785
local_output_nid generation:  0.002169370651245117
local_in_edges_tensor generation:  0.0022902488708496094
mini_batch_src_global generation:  0.003735065460205078
r_  generation:  0.03728008270263672
local_output_nid generation:  0.0021352767944335938
local_in_edges_tensor generation:  0.0019078254699707031
mini_batch_src_global generation:  0.007621288299560547
r_  generation:  0.02739119529724121
----------------------check_connections_block total spend ----------------------------- 0.4841020107269287
generate_one_block  0.024817466735839844
generate_one_block  0.028960466384887695
generate_one_block  0.022025346755981445
generate_one_block  0.025815725326538086
generate_one_block  0.025340557098388672
generate_one_block  0.025114774703979492
generate_one_block  0.0274810791015625
generate_one_block  0.02047419548034668
generate_one_block  0.021000146865844727
generate_one_block  0.025401592254638672
generate_one_block  0.0439295768737793
generate_one_block  0.03436446189880371
generate_one_block  0.05274629592895508
generate_one_block  0.03901314735412598
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05103182792663574
gen group dst list time:  0.008915901184082031
time for parepare:  0.02013421058654785
local_output_nid generation:  0.002337217330932617
local_in_edges_tensor generation:  0.013292789459228516
mini_batch_src_global generation:  0.0025658607482910156
r_  generation:  0.026539087295532227
local_output_nid generation:  0.004427671432495117
local_in_edges_tensor generation:  0.00523066520690918
mini_batch_src_global generation:  0.008904695510864258
r_  generation:  0.051134586334228516
local_output_nid generation:  0.004933834075927734
local_in_edges_tensor generation:  0.004104137420654297
mini_batch_src_global generation:  0.0037953853607177734
r_  generation:  0.036012887954711914
local_output_nid generation:  0.0036978721618652344
local_in_edges_tensor generation:  0.003359556198120117
mini_batch_src_global generation:  0.003975868225097656
r_  generation:  0.037569284439086914
local_output_nid generation:  0.0046498775482177734
local_in_edges_tensor generation:  0.004220247268676758
mini_batch_src_global generation:  0.005129337310791016
r_  generation:  0.04906439781188965
local_output_nid generation:  0.004406452178955078
local_in_edges_tensor generation:  0.0037686824798583984
mini_batch_src_global generation:  0.004719257354736328
r_  generation:  0.04336237907409668
local_output_nid generation:  0.004116535186767578
local_in_edges_tensor generation:  0.00353240966796875
mini_batch_src_global generation:  0.005302906036376953
r_  generation:  0.044049978256225586
local_output_nid generation:  0.0056531429290771484
local_in_edges_tensor generation:  0.007459163665771484
mini_batch_src_global generation:  0.006978273391723633
r_  generation:  0.06376314163208008
local_output_nid generation:  0.0055806636810302734
local_in_edges_tensor generation:  0.00487828254699707
mini_batch_src_global generation:  0.006978750228881836
r_  generation:  0.05912971496582031
local_output_nid generation:  0.007807016372680664
local_in_edges_tensor generation:  0.007960319519042969
mini_batch_src_global generation:  0.011278629302978516
r_  generation:  0.10219788551330566
local_output_nid generation:  0.010543107986450195
local_in_edges_tensor generation:  0.016464948654174805
mini_batch_src_global generation:  0.022583723068237305
r_  generation:  0.17494773864746094
local_output_nid generation:  0.010090827941894531
local_in_edges_tensor generation:  0.014813899993896484
mini_batch_src_global generation:  0.021164417266845703
r_  generation:  0.167161226272583
local_output_nid generation:  0.009093046188354492
local_in_edges_tensor generation:  0.011321067810058594
mini_batch_src_global generation:  0.023870468139648438
r_  generation:  0.1677074432373047
local_output_nid generation:  0.010532379150390625
local_in_edges_tensor generation:  0.014792680740356445
mini_batch_src_global generation:  0.025057554244995117
r_  generation:  0.18213319778442383
----------------------check_connections_block total spend ----------------------------- 1.8567266464233398
generate_one_block  0.03432893753051758
generate_one_block  0.06848645210266113
generate_one_block  0.044064998626708984
generate_one_block  0.06334853172302246
generate_one_block  0.06805992126464844
generate_one_block  0.05999279022216797
generate_one_block  0.057645559310913086
generate_one_block  0.08744525909423828
generate_one_block  0.07717657089233398
generate_one_block  0.13854455947875977
generate_one_block  0.23352408409118652
generate_one_block  0.21692752838134766
generate_one_block  0.2266089916229248
generate_one_block  0.24200081825256348
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05117511749267578
gen group dst list time:  0.02356553077697754
time for parepare:  0.019393205642700195
local_output_nid generation:  0.004734992980957031
local_in_edges_tensor generation:  0.01532125473022461
mini_batch_src_global generation:  0.006276607513427734
r_  generation:  0.05182981491088867
local_output_nid generation:  0.012920141220092773
local_in_edges_tensor generation:  0.010938882827758789
mini_batch_src_global generation:  0.01129770278930664
r_  generation:  0.11164617538452148
local_output_nid generation:  0.008587121963500977
local_in_edges_tensor generation:  0.007328510284423828
mini_batch_src_global generation:  0.007339000701904297
r_  generation:  0.06713509559631348
local_output_nid generation:  0.007606983184814453
local_in_edges_tensor generation:  0.006547451019287109
mini_batch_src_global generation:  0.006545305252075195
r_  generation:  0.06415629386901855
local_output_nid generation:  0.011687517166137695
local_in_edges_tensor generation:  0.009526252746582031
mini_batch_src_global generation:  0.011466741561889648
r_  generation:  0.10277605056762695
local_output_nid generation:  0.00974726676940918
local_in_edges_tensor generation:  0.008211851119995117
mini_batch_src_global generation:  0.009694099426269531
r_  generation:  0.08263564109802246
local_output_nid generation:  0.007596254348754883
local_in_edges_tensor generation:  0.006482601165771484
mini_batch_src_global generation:  0.007781505584716797
r_  generation:  0.06554174423217773
local_output_nid generation:  0.016572952270507812
local_in_edges_tensor generation:  0.0203554630279541
mini_batch_src_global generation:  0.017787933349609375
r_  generation:  0.16576123237609863
local_output_nid generation:  0.015900135040283203
local_in_edges_tensor generation:  0.017668724060058594
mini_batch_src_global generation:  0.017101049423217773
r_  generation:  0.15074753761291504
local_output_nid generation:  0.018708229064941406
local_in_edges_tensor generation:  0.021107912063598633
mini_batch_src_global generation:  0.03273820877075195
r_  generation:  0.19500327110290527
local_output_nid generation:  0.02066206932067871
local_in_edges_tensor generation:  0.0178983211517334
mini_batch_src_global generation:  0.025182485580444336
r_  generation:  0.22892117500305176
local_output_nid generation:  0.022648334503173828
local_in_edges_tensor generation:  0.021270275115966797
mini_batch_src_global generation:  0.027657508850097656
r_  generation:  0.24979734420776367
local_output_nid generation:  0.01725172996520996
local_in_edges_tensor generation:  0.014984846115112305
mini_batch_src_global generation:  0.023485898971557617
r_  generation:  0.19511008262634277
local_output_nid generation:  0.021696805953979492
local_in_edges_tensor generation:  0.020419597625732422
mini_batch_src_global generation:  0.027162551879882812
r_  generation:  0.24118947982788086
----------------------check_connections_block total spend ----------------------------- 3.087458848953247
generate_one_block  0.06945991516113281
generate_one_block  0.14617156982421875
generate_one_block  0.08379220962524414
generate_one_block  0.08367109298706055
generate_one_block  0.1366124153137207
generate_one_block  0.10785531997680664
generate_one_block  0.08007693290710449
generate_one_block  0.21226882934570312
generate_one_block  0.20609498023986816
generate_one_block  0.2361588478088379
generate_one_block  0.2883150577545166
generate_one_block  0.333789587020874
generate_one_block  0.23476338386535645
generate_one_block  0.3117077350616455
dict sorted
[(3, 48760), (6, 49371), (0, 49977), (2, 58688), (5, 66307), (4, 83168), (1, 88983), (12, 94430), (8, 104606), (9, 108702), (7, 110320), (10, 112785), (13, 121336), (11, 125953)]
batch  0
tensor([7, 3, 7,  ..., 7, 7, 1])
tensor([2255.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0., 2502.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0., 2314.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0., 2059.,    0.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0., 1757.,    0.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0., 1499.,    0.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0., 1289.,    0.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0., 1078.,    0.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,  937.,    0.,
           0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0., 7766.])
Counter({10: 7766, 2: 2502, 3: 2314, 1: 2255, 4: 2059, 5: 1757, 6: 1499, 7: 1289, 8: 1078, 9: 937})

batch  1
tensor([ 1,  1,  5,  ...,  4,  3, 10])
tensor([ 2226.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2724.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2819.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2623.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2605.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2301.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2045.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1981.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1759.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        22125.])
Counter({10: 22125, 3: 2819, 2: 2724, 4: 2623, 5: 2605, 6: 2301, 1: 2226, 7: 2045, 8: 1981, 9: 1759})

batch  2
tensor([ 1, 10,  6,  ...,  1,  8, 10])
tensor([ 2396.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2572.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2472.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2214.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1999.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1685.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1480.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1334.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1146.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        10291.])
Counter({10: 10291, 2: 2572, 3: 2472, 1: 2396, 4: 2214, 5: 1999, 6: 1685, 7: 1480, 8: 1334, 9: 1146})

batch  3
tensor([ 4,  4,  4,  ..., 10,  8,  3])
tensor([ 1475.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  1879.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  1915.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1773.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1671.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1527.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1388.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1249.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1125.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11735.])
Counter({10: 11735, 3: 1915, 2: 1879, 4: 1773, 5: 1671, 6: 1527, 1: 1475, 7: 1388, 8: 1249, 9: 1125})

batch  4
tensor([ 5, 10,  4,  ...,  4, 10, 10])
tensor([ 2481.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3118.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3048.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2891.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2604.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2322.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2055.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1952.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1705.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        18548.])
Counter({10: 18548, 2: 3118, 3: 3048, 4: 2891, 5: 2604, 1: 2481, 6: 2322, 7: 2055, 8: 1952, 9: 1705})

batch  5
tensor([ 2, 10,  6,  ..., 10,  2,  8])
tensor([ 2419.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2887.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2819.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2573.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2347.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2033.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1788.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1601.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1403.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        13612.])
Counter({10: 13612, 2: 2887, 3: 2819, 4: 2573, 1: 2419, 5: 2347, 6: 2033, 7: 1788, 8: 1601, 9: 1403})

batch  6
tensor([10,  5,  4,  ...,  1,  4, 10])
tensor([ 1745.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2010.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2079.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  1907.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  1771.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  1550.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  1389.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  1265.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  1078.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        11366.])
Counter({10: 11366, 3: 2079, 2: 2010, 4: 1907, 5: 1771, 1: 1745, 6: 1550, 7: 1389, 8: 1265, 9: 1078})

batch  7
tensor([ 3,  2, 10,  ...,  9, 10,  1])
tensor([ 2885.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3675.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3615.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3314.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3209.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2797.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2653.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2502.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2208.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        34099.])
Counter({10: 34099, 2: 3675, 3: 3615, 4: 3314, 5: 3209, 1: 2885, 6: 2797, 7: 2653, 8: 2502, 9: 2208})

batch  8
tensor([ 4, 10,  2,  ..., 10,  2, 10])
tensor([ 3092.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3541.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3641.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3279.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3215.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2752.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2567.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2462.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2146.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        28524.])
Counter({10: 28524, 3: 3641, 2: 3541, 4: 3279, 5: 3215, 1: 3092, 6: 2752, 7: 2567, 8: 2462, 9: 2146})

batch  9
tensor([9, 2, 2,  ..., 8, 4, 4])
tensor([ 3240.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3932.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  3849.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  3654.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  3489.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3213.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3022.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2864.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2635.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        39659.])
Counter({10: 39659, 2: 3932, 3: 3849, 4: 3654, 5: 3489, 1: 3240, 6: 3213, 7: 3022, 8: 2864, 9: 2635})

batch  10
tensor([10,  8, 10,  ...,  1,  4, 10])
tensor([ 2845.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  3828.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4036.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4056.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4013.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  3782.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3603.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3439.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3273.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        48003.])
Counter({10: 48003, 4: 4056, 3: 4036, 5: 4013, 2: 3828, 6: 3782, 7: 3603, 8: 3439, 9: 3273, 1: 2845})

batch  11
tensor([ 2,  1, 10,  ..., 10, 10,  7])
tensor([ 3402.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  4401.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4631.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4574.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4582.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  4258.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  4056.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3856.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3569.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        51701.])
Counter({10: 51701, 3: 4631, 5: 4582, 4: 4574, 2: 4401, 6: 4258, 7: 4056, 8: 3856, 9: 3569, 1: 3402})

batch  12
tensor([10,  4, 10,  ...,  2, 10,  6])
tensor([ 2267.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  2758.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  2916.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  2930.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  2903.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  2771.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  2709.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  2586.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  2528.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        42184.])
Counter({10: 42184, 4: 2930, 3: 2916, 5: 2903, 6: 2771, 2: 2758, 7: 2709, 8: 2586, 9: 2528, 1: 2267})

batch  13
tensor([2, 3, 1,  ..., 1, 1, 1])
tensor([ 3362.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,  4282.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,  4518.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,  4434.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,  4417.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,  4113.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,  3948.,     0.,     0.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,  3697.,     0.,     0.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,  3491.,     0.,
            0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,
        50675.])
Counter({10: 50675, 3: 4518, 4: 4434, 5: 4417, 2: 4282, 6: 4113, 7: 3948, 8: 3697, 9: 3491, 1: 3362})

----------===============-------------===============-------------the number of batches *****---- 14

original number of batches:  13
0
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0814814567565918  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

connection checking time:  5.428287506103516
block generation total time  4.565377712249756
average batch blocks generation time:  0.10869946933927989
block dataloader generation time/epoch 33.71480655670166
pseudo mini batch 0 input nodes size: 49977
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0543370246887207  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0543370246887207  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07816791534423828  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0782175064086914  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024800777435302734  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.027908802032470703  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.027908802032470703  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 49977
first layer output nodes number: 23456
edges number: 143956
torch.Size([49977, 128])
torch.Size([23456, 6])
input nodes number: 23456
output nodes number: 11920
edges number: 77072
torch.Size([23456, 6])
torch.Size([11920, 6])
torch.Size([6611, 40])
input nodes number: 11920
output nodes number: 6611
edges number: 40192
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04485321044921875  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04641389846801758  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.030910491943359375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 1 input nodes size: 88983
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.02490091323852539  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.02490091323852539  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06786966323852539  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06791925430297852  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04403877258300781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05089855194091797  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05089855194091797  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 88983
first layer output nodes number: 43208
edges number: 320698
torch.Size([88983, 128])
torch.Size([43208, 6])
input nodes number: 43208
output nodes number: 15597
edges number: 156164
torch.Size([43208, 6])
torch.Size([15597, 6])
torch.Size([6610, 40])
input nodes number: 15597
output nodes number: 6610
edges number: 59991
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07931089401245117  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08029651641845703  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0560145378112793  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 2 input nodes size: 58688
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04403877258300781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04403877258300781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07202339172363281  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07207298278808594  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.029054641723632812  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03291130065917969  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03291130065917969  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 58688
first layer output nodes number: 27589
edges number: 178173
torch.Size([58688, 128])
torch.Size([27589, 6])
input nodes number: 27589
output nodes number: 13012
edges number: 99520
torch.Size([27589, 6])
torch.Size([13012, 6])
torch.Size([6595, 40])
input nodes number: 13012
output nodes number: 6595
edges number: 47772
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05186796188354492  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.053168296813964844  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03642463684082031  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 3 input nodes size: 48760
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.029052257537841797  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.029052257537841797  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05230283737182617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0523529052734375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024318695068359375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.028474807739257812  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.028474807739257812  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 48760
first layer output nodes number: 25737
edges number: 182770
torch.Size([48760, 128])
torch.Size([25737, 6])
input nodes number: 25737
output nodes number: 12616
edges number: 118613
torch.Size([25737, 6])
torch.Size([12616, 6])
torch.Size([6681, 40])
input nodes number: 12616
output nodes number: 6681
edges number: 60650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04673433303833008  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04813432693481445  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.032511234283447266  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 4 input nodes size: 83168
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024480342864990234  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024480342864990234  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06413793563842773  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06418752670288086  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.040886878967285156  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04697751998901367  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04697751998901367  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 83168
first layer output nodes number: 40724
edges number: 287203
torch.Size([83168, 128])
torch.Size([40724, 6])
input nodes number: 40724
output nodes number: 16653
edges number: 151566
torch.Size([40724, 6])
torch.Size([16653, 6])
torch.Size([6623, 40])
input nodes number: 16653
output nodes number: 6623
edges number: 57230
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07389116287231445  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07487869262695312  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05176258087158203  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 5 input nodes size: 66307
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07234716415405273  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07239580154418945  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03268861770629883  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.037595272064208984  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.037595272064208984  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 66307
first layer output nodes number: 33482
edges number: 224946
torch.Size([66307, 128])
torch.Size([33482, 6])
input nodes number: 33482
output nodes number: 14737
edges number: 134462
torch.Size([33482, 6])
torch.Size([14737, 6])
torch.Size([6503, 40])
input nodes number: 14737
output nodes number: 6503
edges number: 57204
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06026458740234375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.061234474182128906  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.041957855224609375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 6 input nodes size: 49371
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03267097473144531  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03267097473144531  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0562129020690918  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05626201629638672  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.02459573745727539  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.028898239135742188  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.028898239135742188  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 49371
first layer output nodes number: 26160
edges number: 180990
torch.Size([49371, 128])
torch.Size([26160, 6])
input nodes number: 26160
output nodes number: 14154
edges number: 138308
torch.Size([26160, 6])
torch.Size([14154, 6])
torch.Size([6563, 40])
input nodes number: 14154
output nodes number: 6563
edges number: 63981
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.047753334045410156  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.049602508544921875  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.03338956832885742  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 7 input nodes size: 110320
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024824142456054688  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.024824142456054688  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07755851745605469  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.077606201171875  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.054015159606933594  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06292486190795898  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06292486190795898  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 110320
first layer output nodes number: 60957
edges number: 466612
torch.Size([110320, 128])
torch.Size([60957, 6])
input nodes number: 60957
output nodes number: 18607
edges number: 191101
torch.Size([60957, 6])
torch.Size([18607, 6])
torch.Size([6377, 40])
input nodes number: 18607
output nodes number: 6377
edges number: 40705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10204839706420898  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10299921035766602  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06858015060424805  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 8 input nodes size: 104606
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05376768112182617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05376768112182617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10454893112182617  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10459709167480469  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.051815032958984375  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.059721946716308594  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.059721946716308594  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 104606
first layer output nodes number: 55219
edges number: 409019
torch.Size([104606, 128])
torch.Size([55219, 6])
input nodes number: 55219
output nodes number: 18182
edges number: 171075
torch.Size([55219, 6])
torch.Size([18182, 6])
torch.Size([6441, 40])
input nodes number: 18182
output nodes number: 6441
edges number: 44184
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09497880935668945  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.09593915939331055  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0652308464050293  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 9 input nodes size: 108702
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05182456970214844  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05182456970214844  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10455894470214844  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10460615158081055  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05377674102783203  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06477546691894531  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06477546691894531  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 108702
first layer output nodes number: 69557
edges number: 538361
torch.Size([108702, 128])
torch.Size([69557, 6])
input nodes number: 69557
output nodes number: 25351
edges number: 312768
torch.Size([69557, 6])
torch.Size([25351, 6])
torch.Size([6310, 40])
input nodes number: 25351
output nodes number: 6310
edges number: 51750
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.11026191711425781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.11120271682739258  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07341480255126953  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 10 input nodes size: 112785
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0537571907043457  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1084446907043457  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10849189758300781  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0557103157043457  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07051992416381836  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07051992416381836  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 112785
first layer output nodes number: 80878
edges number: 643810
torch.Size([112785, 128])
torch.Size([80878, 6])
input nodes number: 80878
output nodes number: 37260
edges number: 564020
torch.Size([80878, 6])
torch.Size([37260, 6])
torch.Size([6325, 40])
input nodes number: 37260
output nodes number: 6325
edges number: 95424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.12500619888305664  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.12594938278198242  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0836038589477539  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

pseudo mini batch 11 input nodes size: 125953
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05571269989013672  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.05571269989013672  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.11625957489013672  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.11630678176879883  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.06157207489013672  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07669925689697266  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07669925689697266  GigaBytes
Max Memory Allocated: 0.1604170799255371  GigaBytes

first layer input nodes number: 125953
first layer output nodes number: 89030
edges number: 701222
torch.Size([125953, 128])
torch.Size([89030, 6])
input nodes number: 89030
output nodes number: 35305
edges number: 512621
torch.Size([89030, 6])
torch.Size([35305, 6])
torch.Size([6306, 40])
input nodes number: 35305
output nodes number: 6306
edges number: 70504
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.13515377044677734  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1360940933227539  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08967733383178711  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

pseudo mini batch 12 input nodes size: 94430
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0615692138671875  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0615692138671875  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1065969467163086  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10664701461791992  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04605293273925781  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0593719482421875  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.0593719482421875  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

first layer input nodes number: 94430
first layer output nodes number: 66552
edges number: 543635
torch.Size([94430, 128])
torch.Size([66552, 6])
input nodes number: 66552
output nodes number: 34292
edges number: 547609
torch.Size([66552, 6])
torch.Size([34292, 6])
torch.Size([6690, 40])
input nodes number: 34292
output nodes number: 6690
edges number: 119053
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10645580291748047  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.10794401168823242  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07271194458007812  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

pseudo mini batch 13 input nodes size: 121336
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.04614591598510742  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1040034294128418  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes
Using backend: pytorch

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1040506362915039  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.058972835540771484  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07453727722167969  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.07453727722167969  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

first layer input nodes number: 121336
first layer output nodes number: 86937
edges number: 685360
torch.Size([121336, 128])
torch.Size([86937, 6])
input nodes number: 86937
output nodes number: 38117
edges number: 575222
torch.Size([86937, 6])
torch.Size([38117, 6])
torch.Size([6306, 40])
input nodes number: 38117
output nodes number: 6306
edges number: 81116
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.13216066360473633  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.1331009864807129  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08767318725585938  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08767318725585938  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.08767318725585938  GigaBytes
Max Memory Allocated: 0.16405534744262695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018118211201259067 |0.008062073162623815 |0.004760537828717913 |0.0001371077128819057 |0.003321051597595215 |0.002741575241088867 |
----------------------------------------------------------pseudo_mini_loss sum 3.657787561416626
Total (block generation + training)time/epoch 34.29858469963074
Training time/epoch 0.5247023105621338
Training time without block to device /epoch 0.4118332862854004
Training time without total dataloading part /epoch 0.11780333518981934
load block tensor time/epoch 0.25365495681762695
block to device time/epoch 0.1128690242767334
input features size transfer per epoch 1.8775463104248047e-06
blocks size to device per epoch 1.2516975402832031e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2258675
Number of first layer input nodes during this epoch:  1223386
Number of first layer output nodes during this epoch:  729486
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=6, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=6, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=6, out_features=6, bias=False)
      (fc_neigh): Linear(in_features=6, out_features=6, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=6, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=6, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  2088
trainable parameters
layers.0.fc_self.weight, torch.Size([6, 128])
layers.0.fc_neigh.weight, torch.Size([6, 128])
layers.1.fc_self.weight, torch.Size([6, 6])
layers.1.fc_neigh.weight, torch.Size([6, 6])
layers.2.fc_self.weight, torch.Size([40, 6])
layers.2.fc_neigh.weight, torch.Size([40, 6])
----------------------------------------
un-trainable parameters
