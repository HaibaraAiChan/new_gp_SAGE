main start at this time 1662435269.4805408
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.31403207778930664
global_2_local spend time (sec) 0.4149346351623535

----------------------------  graph partition start---------------------
REG start----................................
---------================-----------------=============---------REG before start 
{'VmPeak': 28642.16015625, 'VmSize': 26456.109375, 'VmHWM': 11869.47265625, 'VmRSS': 9683.37109375}
number of edges of full batch :  7430560
---------================-----------------=============---------REG start 
{'VmPeak': 28642.16015625, 'VmSize': 26456.109375, 'VmHWM': 11869.47265625, 'VmRSS': 9683.37109375}
---------================-----------------=============---------REG A 
{'VmPeak': 28642.16015625, 'VmSize': 26597.83984375, 'VmHWM': 11869.47265625, 'VmRSS': 9826.140625}
---------================-----------------=============---------REG AT 
{'VmPeak': 28642.16015625, 'VmSize': 26739.5703125, 'VmHWM': 11869.47265625, 'VmRSS': 9967.61328125}
---------================-----------------=============---------REG indices AT 
{'VmPeak': 28642.16015625, 'VmSize': 27313.203125, 'VmHWM': 11869.47265625, 'VmRSS': 10541.23828125}
---------================-----------------=============---------REG indices A 
{'VmPeak': 28642.16015625, 'VmSize': 27887.0859375, 'VmHWM': 11869.47265625, 'VmRSS': 11114.875}
---------================-----------------=============---------REG weight AT 
{'VmPeak': 28642.16015625, 'VmSize': 28028.81640625, 'VmHWM': 11869.47265625, 'VmRSS': 11256.671875}
---------================-----------------=============---------REG weight A 
{'VmPeak': 28642.16015625, 'VmSize': 28170.546875, 'VmHWM': 11869.47265625, 'VmRSS': 11397.953125}
---------================-----------------=============---------REG auxiliary graph done 
{'VmPeak': 29560.37109375, 'VmSize': 29560.37109375, 'VmHWM': 12788.5859375, 'VmRSS': 12788.5859375}
Convert a graph into a bidirected graph: 6.471 seconds
Metis partitioning: 23.861 seconds
Split the graph: 11.637 seconds
Construct subgraphs: 0.052 seconds
97762
98809
REG metis partition end ----................................
the time spent:  60.421969413757324
REG construction  time spent:  18.3575177192688
pure dgl.metis_partition the time spent:  42.064451694488525
total k batches seeds list generation spend  61.576199531555176
after graph partition
graph partition algorithm spend time 62.853230237960815

partition_len_list
[701982, 788953]
REG selection method  spend 63.450642108917236
check_connections_block*********************************
time for parepare 1: 0.2539975643157959
local_output_nid generation: 0.012867927551269531
local_in_edges_tensor generation: 0.05957460403442383

&&&&&&&&&&&&&&& before remove duplicate length: 3700321
remove duplicated spend time : 0.9251110553741455

&&&&&&&&&&&&&&& after remove duplicate length: 699461

mini_batch_src_global generation: 0.05745220184326172
r_  generation: 0.4800105094909668

local_output_nid generation: 0.015933513641357422
local_in_edges_tensor generation: 0.07373309135437012

&&&&&&&&&&&&&&& before remove duplicate length: 3730239
remove duplicated spend time : 1.013770341873169

&&&&&&&&&&&&&&& after remove duplicate length: 784787

mini_batch_src_global generation: 0.07501792907714844
r_  generation: 0.5651564598083496


The real block id is  2
get_global_graph_edges_ids_block function  spend 1.9258275032043457
gen group dst list time:  0.04264640808105469
check_connections_block*********************************
time for parepare 1: 0.3925957679748535
local_output_nid generation: 0.1354203224182129
local_in_edges_tensor generation: 0.47040343284606934

&&&&&&&&&&&&&&& before remove duplicate length: 17383467
remove duplicated spend time : 4.251251459121704

&&&&&&&&&&&&&&& after remove duplicate length: 1430773

mini_batch_src_global generation: 0.13045525550842285
r_  generation: 1.3528940677642822

local_output_nid generation: 0.18387079238891602
local_in_edges_tensor generation: 0.5309731960296631

&&&&&&&&&&&&&&& before remove duplicate length: 20868076
remove duplicated spend time : 5.117727041244507

&&&&&&&&&&&&&&& after remove duplicate length: 1487764

mini_batch_src_global generation: 0.1886603832244873
r_  generation: 1.6345221996307373


The real block id is  1
get_global_graph_edges_ids_block function  spend 2.212202787399292
gen group dst list time:  0.11157035827636719
check_connections_block*********************************
time for parepare 1: 0.4652249813079834
local_output_nid generation: 0.3214869499206543
local_in_edges_tensor generation: 0.976670503616333

&&&&&&&&&&&&&&& before remove duplicate length: 28250793
remove duplicated spend time : 7.451825857162476

&&&&&&&&&&&&&&& after remove duplicate length: 2014922

mini_batch_src_global generation: 0.21065497398376465
r_  generation: 2.2012956142425537

local_output_nid generation: 0.35944509506225586
local_in_edges_tensor generation: 0.9438424110412598

&&&&&&&&&&&&&&& before remove duplicate length: 30792395
remove duplicated spend time : 7.952133893966675

&&&&&&&&&&&&&&& after remove duplicate length: 1977078

mini_batch_src_global generation: 0.26037144660949707
r_  generation: 2.3553695678710938


The real block id is  0
get_global_graph_edges_ids_block function  spend 1.2200608253479004
gen group dst list time:  0.15181374549865723
check_connections_block*********************************
time for parepare 1: 0.45432305335998535
local_output_nid generation: 0.5563807487487793
local_in_edges_tensor generation: 1.0485153198242188

&&&&&&&&&&&&&&& before remove duplicate length: 18373383
remove duplicated spend time : 5.228113889694214

&&&&&&&&&&&&&&& after remove duplicate length: 2057241

mini_batch_src_global generation: 0.19130563735961914
r_  generation: 2.7523906230926514

local_output_nid generation: 0.5489683151245117
local_in_edges_tensor generation: 0.8049559593200684

&&&&&&&&&&&&&&& before remove duplicate length: 18266629
remove duplicated spend time : 4.992265462875366

&&&&&&&&&&&&&&& after remove duplicate length: 2027414

mini_batch_src_global generation: 0.2553389072418213
r_  generation: 2.7446577548980713


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

connection checking time:  72.90093469619751
block generation total time  85.9466245174408
average batch blocks generation time:  42.9733122587204
block dataloader generation time/epoch 233.01249408721924
pseudo mini batch 0 input nodes size: 2200323
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0012569427490234375  GigaBytes
Max Memory Allocated: 0.0012569427490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 0.8215694427490234  GigaBytes
Max Memory Allocated: 0.8215694427490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 0.8222980499267578  GigaBytes
Max Memory Allocated: 0.8222980499267578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9002685546875 GB
    Memory Allocated: 0.8222980499267578  GigaBytes
Max Memory Allocated: 0.8222980499267578  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 1.3272161483764648  GigaBytes
Max Memory Allocated: 1.3272161483764648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 1.3272161483764648  GigaBytes
Max Memory Allocated: 1.3272161483764648  GigaBytes

first layer input nodes number: 2200323
first layer output nodes number: 2045863
edges number: 18373383
----------------------------------------before model layer 0
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 1.3592352867126465  GigaBytes
Max Memory Allocated: 1.4276819229125977  GigaBytes

torch.Size([2200323, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 1.3592352867126465  GigaBytes
Max Memory Allocated: 1.4276819229125977  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 1.3592352867126465  GigaBytes
Max Memory Allocated: 1.4276819229125977  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6600341796875 GB
    Memory Allocated: 2.2658939361572266  GigaBytes
Max Memory Allocated: 3.0356593132019043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6600341796875 GB
    Memory Allocated: 2.2658939361572266  GigaBytes
Max Memory Allocated: 3.0356593132019043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 4.217065811157227  GigaBytes
Max Memory Allocated: 4.217065811157227  GigaBytes

h_neigh size torch.Size([2045863, 256])
h_self size  torch.Size([2045863, 100])
----------------------------------------before rst
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 4.217065811157227  GigaBytes
Max Memory Allocated: 4.217065811157227  GigaBytes

torch.Size([2045863, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.168237686157227  GigaBytes
Max Memory Allocated: 8.119409561157227  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 4.217065811157227  GigaBytes
Max Memory Allocated: 8.119409561157227  GigaBytes

torch.Size([2045863, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.168237686157227  GigaBytes
Max Memory Allocated: 8.119409561157227  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.656009674072266  GigaBytes
Max Memory Allocated: 8.607181549072266  GigaBytes

input nodes number: 2045863
output nodes number: 1443465
edges number: 28250793
----------------------------------------before model layer 1
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.682007789611816  GigaBytes
Max Memory Allocated: 8.607181549072266  GigaBytes

torch.Size([2045863, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.682007789611816  GigaBytes
Max Memory Allocated: 8.607181549072266  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 17.5135498046875 GB
    Memory Allocated: 6.682007789611816  GigaBytes
Max Memory Allocated: 8.607181549072266  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.5037841796875 GB
    Memory Allocated: 8.28020191192627  GigaBytes
Max Memory Allocated: 9.656797409057617  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.5037841796875 GB
    Memory Allocated: 8.28020191192627  GigaBytes
Max Memory Allocated: 9.656797409057617  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.5037841796875 GB
    Memory Allocated: 9.656797409057617  GigaBytes
Max Memory Allocated: 9.656797409057617  GigaBytes

h_neigh size torch.Size([1443465, 256])
h_self size  torch.Size([1443465, 256])
----------------------------------------before rst
 Nvidia-smi: 19.5037841796875 GB
    Memory Allocated: 9.656797409057617  GigaBytes
Max Memory Allocated: 9.656797409057617  GigaBytes

torch.Size([1443465, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.033750534057617  GigaBytes
Max Memory Allocated: 12.410703659057617  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 9.65715503692627  GigaBytes
Max Memory Allocated: 12.410703659057617  GigaBytes

torch.Size([1443465, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.03410816192627  GigaBytes
Max Memory Allocated: 12.410703659057617  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.377899646759033  GigaBytes
Max Memory Allocated: 12.754852771759033  GigaBytes

input nodes number: 1443465
output nodes number: 701982
edges number: 17383467
----------------------------------------before model layer 2
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.393885612487793  GigaBytes
Max Memory Allocated: 12.754852771759033  GigaBytes

torch.Size([1443465, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.393885612487793  GigaBytes
Max Memory Allocated: 12.754852771759033  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 11.393885612487793  GigaBytes
Max Memory Allocated: 12.754852771759033  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 12.19809627532959  GigaBytes
Max Memory Allocated: 12.867558479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 12.19809627532959  GigaBytes
Max Memory Allocated: 12.867558479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 12.867558479309082  GigaBytes
Max Memory Allocated: 12.867558479309082  GigaBytes

h_neigh size torch.Size([701982, 256])
h_self size  torch.Size([701982, 256])
----------------------------------------before rst
 Nvidia-smi: 22.2576904296875 GB
    Memory Allocated: 12.867558479309082  GigaBytes
Max Memory Allocated: 12.867558479309082  GigaBytes

torch.Size([701982, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 13.537480354309082  GigaBytes
Max Memory Allocated: 14.207402229309082  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 12.86801815032959  GigaBytes
Max Memory Allocated: 14.207402229309082  GigaBytes

torch.Size([701982, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 13.537480354309082  GigaBytes
Max Memory Allocated: 14.207402229309082  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 13.705305576324463  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------input nodes number: 701982
----------------output nodes number: 97762
----------------edges number: 3700321
----------------------------------------before mean aggregator
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 13.711265087127686  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 23.5975341796875 GB
    Memory Allocated: 13.711265087127686  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.832796573638916  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.832796573638916  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.849913597106934  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

h_neigh size torch.Size([97762, 47])
h_self size  torch.Size([97762, 256])
----------------------------------------before rst
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.849913597106934  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

torch.Size([97762, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.867030620574951  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.849913597106934  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

torch.Size([97762, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.867030620574951  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5994873046875 GB
    Memory Allocated: 13.884148597717285  GigaBytes
Max Memory Allocated: 14.374767780303955  GigaBytes

