main start at this time 1665784339.270824
-----------------------------------------before load data 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.07617521286010742
pseudo mini batch 0 input nodes size: 847637
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.0003376007080078125  GigaBytes
Max Memory Allocated: 0.0003376007080078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2882080078125 GB
    Memory Allocated: 0.3167438507080078  GigaBytes
Max Memory Allocated: 0.3167438507080078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3077392578125 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3077392578125 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3468017578125 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3468017578125 GB
    Memory Allocated: 0.3182086944580078  GigaBytes
Max Memory Allocated: 0.3182086944580078  GigaBytes

----------------input nodes number: 847637
----------------output nodes number: 196571
----------------edges number: 1949041
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.3468017578125 GB
    Memory Allocated: 0.3259892463684082  GigaBytes
Max Memory Allocated: 0.3259892463684082  GigaBytes

m.shape torch.Size([173, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.1651611328125 GB
    Memory Allocated: 1.0570297241210938  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1651611328125 GB
    Memory Allocated: 1.0570297241210938  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

 h.shape torch.Size([1, 173, 100]), torch.Size([1, 173, 100])
----------------------------------------3
 Nvidia-smi: 2.1651611328125 GB
    Memory Allocated: 1.057159423828125  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1749267578125 GB
    Memory Allocated: 1.0581927299499512  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

rst.shape  torch.Size([1, 173, 100])
m.shape torch.Size([221, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.1749267578125 GB
    Memory Allocated: 1.0582928657531738  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1749267578125 GB
    Memory Allocated: 1.0582928657531738  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 2.1749267578125 GB
    Memory Allocated: 1.058457851409912  GigaBytes
Max Memory Allocated: 1.0591435432434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1768798828125 GB
    Memory Allocated: 1.060929775238037  GigaBytes
Max Memory Allocated: 1.0610947608947754  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([374, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.1788330078125 GB
    Memory Allocated: 1.061265468597412  GigaBytes
Max Memory Allocated: 1.0612783432006836  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1788330078125 GB
    Memory Allocated: 1.061265468597412  GigaBytes
Max Memory Allocated: 1.0612783432006836  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 2.1788330078125 GB
    Memory Allocated: 1.0615448951721191  GigaBytes
Max Memory Allocated: 1.0615448951721191  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1846923828125 GB
    Memory Allocated: 1.0676794052124023  GigaBytes
Max Memory Allocated: 1.0680975914001465  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([456, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.1846923828125 GB
    Memory Allocated: 1.0682191848754883  GigaBytes
Max Memory Allocated: 1.0682401657104492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1846923828125 GB
    Memory Allocated: 1.0682191848754883  GigaBytes
Max Memory Allocated: 1.0682401657104492  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 2.1846923828125 GB
    Memory Allocated: 1.0685596466064453  GigaBytes
Max Memory Allocated: 1.0685596466064453  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1983642578125 GB
    Memory Allocated: 1.078415870666504  GigaBytes
Max Memory Allocated: 1.0790953636169434  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([445, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.1983642578125 GB
    Memory Allocated: 1.0790748596191406  GigaBytes
Max Memory Allocated: 1.0791001319885254  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1983642578125 GB
    Memory Allocated: 1.0790748596191406  GigaBytes
Max Memory Allocated: 1.0791001319885254  GigaBytes

 h.shape torch.Size([1, 445, 100]), torch.Size([1, 445, 100])
----------------------------------------3
 Nvidia-smi: 2.1983642578125 GB
    Memory Allocated: 1.07940673828125  GigaBytes
Max Memory Allocated: 1.07940673828125  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0913472175598145  GigaBytes
Max Memory Allocated: 1.0921764373779297  GigaBytes

rst.shape  torch.Size([1, 445, 100])
m.shape torch.Size([550, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0924110412597656  GigaBytes
Max Memory Allocated: 1.0924482345581055  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0924110412597656  GigaBytes
Max Memory Allocated: 1.0924482345581055  GigaBytes

 h.shape torch.Size([1, 550, 100]), torch.Size([1, 550, 100])
----------------------------------------3
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0928211212158203  GigaBytes
Max Memory Allocated: 1.0928211212158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2296142578125 GB
    Memory Allocated: 1.1104459762573242  GigaBytes
Max Memory Allocated: 1.1121163368225098  GigaBytes

rst.shape  torch.Size([1, 550, 100])
m.shape torch.Size([655, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.2296142578125 GB
    Memory Allocated: 1.1119494438171387  GigaBytes
Max Memory Allocated: 1.1121163368225098  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2296142578125 GB
    Memory Allocated: 1.1119494438171387  GigaBytes
Max Memory Allocated: 1.1121163368225098  GigaBytes

 h.shape torch.Size([1, 655, 100]), torch.Size([1, 655, 100])
----------------------------------------3
 Nvidia-smi: 2.2296142578125 GB
    Memory Allocated: 1.1124377250671387  GigaBytes
Max Memory Allocated: 1.1124377250671387  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2530517578125 GB
    Memory Allocated: 1.1368417739868164  GigaBytes
Max Memory Allocated: 1.1385502815246582  GigaBytes

rst.shape  torch.Size([1, 655, 100])
m.shape torch.Size([512, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.2530517578125 GB
    Memory Allocated: 1.138267993927002  GigaBytes
Max Memory Allocated: 1.1385502815246582  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2530517578125 GB
    Memory Allocated: 1.138267993927002  GigaBytes
Max Memory Allocated: 1.1385502815246582  GigaBytes

 h.shape torch.Size([1, 512, 100]), torch.Size([1, 512, 100])
----------------------------------------3
 Nvidia-smi: 2.2530517578125 GB
    Memory Allocated: 1.1386494636535645  GigaBytes
Max Memory Allocated: 1.1386494636535645  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2764892578125 GB
    Memory Allocated: 1.160393238067627  GigaBytes
Max Memory Allocated: 1.161919116973877  GigaBytes

rst.shape  torch.Size([1, 512, 100])
m.shape torch.Size([576, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.2764892578125 GB
    Memory Allocated: 1.1621336936950684  GigaBytes
Max Memory Allocated: 1.1621918678283691  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2764892578125 GB
    Memory Allocated: 1.1621336936950684  GigaBytes
Max Memory Allocated: 1.1621918678283691  GigaBytes

 h.shape torch.Size([1, 576, 100]), torch.Size([1, 576, 100])
----------------------------------------3
 Nvidia-smi: 2.2764892578125 GB
    Memory Allocated: 1.1625628471374512  GigaBytes
Max Memory Allocated: 1.1625628471374512  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3038330078125 GB
    Memory Allocated: 1.1900286674499512  GigaBytes
Max Memory Allocated: 1.1923394203186035  GigaBytes

rst.shape  torch.Size([1, 576, 100])
m.shape torch.Size([12039, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.3507080078125 GB
    Memory Allocated: 1.2347359657287598  GigaBytes
Max Memory Allocated: 1.2360820770263672  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3507080078125 GB
    Memory Allocated: 1.2347359657287598  GigaBytes
Max Memory Allocated: 1.2360820770263672  GigaBytes

 h.shape torch.Size([1, 12039, 100]), torch.Size([1, 12039, 100])
----------------------------------------3
 Nvidia-smi: 2.3702392578125 GB
    Memory Allocated: 1.243706226348877  GigaBytes
Max Memory Allocated: 1.243706226348877  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0987548828125 GB
    Memory Allocated: 1.880566120147705  GigaBytes
Max Memory Allocated: 1.925487995147705  GigaBytes

rst.shape  torch.Size([1, 12039, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.0987548828125 GB
    Memory Allocated: 1.9210028648376465  GigaBytes
Max Memory Allocated: 1.925487995147705  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0987548828125 GB
    Memory Allocated: 1.9210028648376465  GigaBytes
Max Memory Allocated: 1.925487995147705  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 3.1182861328125 GB
    Memory Allocated: 1.9299726486206055  GigaBytes
Max Memory Allocated: 1.9299726486206055  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8468017578125 GB
    Memory Allocated: 2.566779136657715  GigaBytes
Max Memory Allocated: 2.611701011657715  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.8468017578125 GB
    Memory Allocated: 2.6072163581848145  GigaBytes
Max Memory Allocated: 2.611701011657715  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8468017578125 GB
    Memory Allocated: 2.6072163581848145  GigaBytes
Max Memory Allocated: 2.611701011657715  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 3.8468017578125 GB
    Memory Allocated: 2.6161856651306152  GigaBytes
Max Memory Allocated: 2.6161856651306152  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5948486328125 GB
    Memory Allocated: 3.2529921531677246  GigaBytes
Max Memory Allocated: 3.2979140281677246  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 4.5948486328125 GB
    Memory Allocated: 3.293429374694824  GigaBytes
Max Memory Allocated: 3.2979140281677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5948486328125 GB
    Memory Allocated: 3.293429374694824  GigaBytes
Max Memory Allocated: 3.2979140281677246  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 4.5948486328125 GB
    Memory Allocated: 3.302398681640625  GigaBytes
Max Memory Allocated: 3.302398681640625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3428955078125 GB
    Memory Allocated: 3.9392051696777344  GigaBytes
Max Memory Allocated: 3.9841270446777344  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 5.3428955078125 GB
    Memory Allocated: 3.979642391204834  GigaBytes
Max Memory Allocated: 3.9841270446777344  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3428955078125 GB
    Memory Allocated: 3.979642391204834  GigaBytes
Max Memory Allocated: 3.9841270446777344  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 5.3428955078125 GB
    Memory Allocated: 3.9886116981506348  GigaBytes
Max Memory Allocated: 3.9886116981506348  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0714111328125 GB
    Memory Allocated: 4.625418186187744  GigaBytes
Max Memory Allocated: 4.670340061187744  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 6.0714111328125 GB
    Memory Allocated: 4.665855407714844  GigaBytes
Max Memory Allocated: 4.670340061187744  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0714111328125 GB
    Memory Allocated: 4.665855407714844  GigaBytes
Max Memory Allocated: 4.670340061187744  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 6.0909423828125 GB
    Memory Allocated: 4.6748247146606445  GigaBytes
Max Memory Allocated: 4.6748247146606445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8194580078125 GB
    Memory Allocated: 5.311631202697754  GigaBytes
Max Memory Allocated: 5.356553077697754  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 6.8194580078125 GB
    Memory Allocated: 5.3520684242248535  GigaBytes
Max Memory Allocated: 5.356553077697754  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8194580078125 GB
    Memory Allocated: 5.3520684242248535  GigaBytes
Max Memory Allocated: 5.356553077697754  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 6.8194580078125 GB
    Memory Allocated: 5.361037731170654  GigaBytes
Max Memory Allocated: 5.361037731170654  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5675048828125 GB
    Memory Allocated: 5.997844219207764  GigaBytes
Max Memory Allocated: 6.042766094207764  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.5675048828125 GB
    Memory Allocated: 6.038281440734863  GigaBytes
Max Memory Allocated: 6.042766094207764  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5675048828125 GB
    Memory Allocated: 6.038281440734863  GigaBytes
Max Memory Allocated: 6.042766094207764  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 7.5675048828125 GB
    Memory Allocated: 6.047250747680664  GigaBytes
Max Memory Allocated: 6.047250747680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3155517578125 GB
    Memory Allocated: 6.684057235717773  GigaBytes
Max Memory Allocated: 6.728979110717773  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3155517578125 GB
    Memory Allocated: 6.724494457244873  GigaBytes
Max Memory Allocated: 6.728979110717773  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3155517578125 GB
    Memory Allocated: 6.724494457244873  GigaBytes
Max Memory Allocated: 6.728979110717773  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 8.3155517578125 GB
    Memory Allocated: 6.733463764190674  GigaBytes
Max Memory Allocated: 6.733463764190674  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0440673828125 GB
    Memory Allocated: 7.370270252227783  GigaBytes
Max Memory Allocated: 7.415192127227783  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 9.0440673828125 GB
    Memory Allocated: 7.410707473754883  GigaBytes
Max Memory Allocated: 7.415192127227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0440673828125 GB
    Memory Allocated: 7.410707473754883  GigaBytes
Max Memory Allocated: 7.415192127227783  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 9.0635986328125 GB
    Memory Allocated: 7.419676780700684  GigaBytes
Max Memory Allocated: 7.419676780700684  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7921142578125 GB
    Memory Allocated: 8.056483268737793  GigaBytes
Max Memory Allocated: 8.101405143737793  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 9.7921142578125 GB
    Memory Allocated: 8.096920490264893  GigaBytes
Max Memory Allocated: 8.101405143737793  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7921142578125 GB
    Memory Allocated: 8.096920490264893  GigaBytes
Max Memory Allocated: 8.101405143737793  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 9.7921142578125 GB
    Memory Allocated: 8.105889797210693  GigaBytes
Max Memory Allocated: 8.105889797210693  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5401611328125 GB
    Memory Allocated: 8.742696285247803  GigaBytes
Max Memory Allocated: 8.787618160247803  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.5401611328125 GB
    Memory Allocated: 8.783133506774902  GigaBytes
Max Memory Allocated: 8.787618160247803  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5401611328125 GB
    Memory Allocated: 8.783133506774902  GigaBytes
Max Memory Allocated: 8.787618160247803  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 10.5401611328125 GB
    Memory Allocated: 8.792102813720703  GigaBytes
Max Memory Allocated: 8.792102813720703  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2882080078125 GB
    Memory Allocated: 9.428909301757812  GigaBytes
Max Memory Allocated: 9.473831176757812  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.2882080078125 GB
    Memory Allocated: 9.469346523284912  GigaBytes
Max Memory Allocated: 9.473831176757812  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2882080078125 GB
    Memory Allocated: 9.469346523284912  GigaBytes
Max Memory Allocated: 9.473831176757812  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 11.2882080078125 GB
    Memory Allocated: 9.478315830230713  GigaBytes
Max Memory Allocated: 9.478315830230713  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0167236328125 GB
    Memory Allocated: 10.115122318267822  GigaBytes
Max Memory Allocated: 10.160044193267822  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.0167236328125 GB
    Memory Allocated: 10.155559539794922  GigaBytes
Max Memory Allocated: 10.160044193267822  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0167236328125 GB
    Memory Allocated: 10.155559539794922  GigaBytes
Max Memory Allocated: 10.160044193267822  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 12.0362548828125 GB
    Memory Allocated: 10.164528846740723  GigaBytes
Max Memory Allocated: 10.164528846740723  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.7647705078125 GB
    Memory Allocated: 10.801335334777832  GigaBytes
Max Memory Allocated: 10.846257209777832  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.7647705078125 GB
    Memory Allocated: 10.841772556304932  GigaBytes
Max Memory Allocated: 10.846257209777832  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.7647705078125 GB
    Memory Allocated: 10.841772556304932  GigaBytes
Max Memory Allocated: 10.846257209777832  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 12.7647705078125 GB
    Memory Allocated: 10.850741863250732  GigaBytes
Max Memory Allocated: 10.850741863250732  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5128173828125 GB
    Memory Allocated: 11.487548351287842  GigaBytes
Max Memory Allocated: 11.532470226287842  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
m.shape torch.Size([12038, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.5128173828125 GB
    Memory Allocated: 11.527985572814941  GigaBytes
Max Memory Allocated: 11.532470226287842  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5128173828125 GB
    Memory Allocated: 11.527985572814941  GigaBytes
Max Memory Allocated: 11.532470226287842  GigaBytes

 h.shape torch.Size([1, 12038, 100]), torch.Size([1, 12038, 100])
----------------------------------------3
 Nvidia-smi: 13.5128173828125 GB
    Memory Allocated: 11.536954879760742  GigaBytes
Max Memory Allocated: 11.536954879760742  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2608642578125 GB
    Memory Allocated: 12.173761367797852  GigaBytes
Max Memory Allocated: 12.218683242797852  GigaBytes

rst.shape  torch.Size([1, 12038, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.513116836547852  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.547534465789795  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

h_self size  torch.Size([196571, 100])
----------------------------------------before rst
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.547534465789795  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

torch.Size([196571, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.581952095031738  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.547534465789795  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

torch.Size([196571, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.581952095031738  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4835205078125 GB
    Memory Allocated: 11.616370677947998  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.4913330078125 GB
    Memory Allocated: 0.3607454299926758  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.4913330078125 GB
    Memory Allocated: 0.3614206314086914  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.4913330078125 GB
    Memory Allocated: 0.3614206314086914  GigaBytes
Max Memory Allocated: 12.389903545379639  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1723930835723877 |0.11832523345947266 |0.45748043060302734 |0.0002837181091308594 |0.11419844627380371 |0.006772518157958984 |
----------------------------------------------------------pseudo_mini_loss sum 4.791597843170166
Total (block generation + training)time/epoch 1.0223414897918701
Training time/epoch 0.945915699005127
Training time without block to device /epoch 0.8275904655456543
Training time without total dataloading part /epoch 0.5787351131439209
load block tensor time/epoch 0.1723930835723877
block to device time/epoch 0.11832523345947266
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  847637
Number of first layer input nodes during this epoch:  847637
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  90200
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
