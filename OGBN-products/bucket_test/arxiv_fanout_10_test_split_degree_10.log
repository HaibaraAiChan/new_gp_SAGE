main start at this time 1665776130.0269842
-----------------------------------------before load data 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.02026081085205078
pseudo mini batch 0 input nodes size: 144917
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.9718017578125 GB
    Memory Allocated: 0.000530242919921875  GigaBytes
Max Memory Allocated: 0.000530242919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0421142578125 GB
    Memory Allocated: 0.06963205337524414  GigaBytes
Max Memory Allocated: 0.06963205337524414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0421142578125 GB
    Memory Allocated: 0.07030963897705078  GigaBytes
Max Memory Allocated: 0.07030963897705078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0421142578125 GB
    Memory Allocated: 0.07030963897705078  GigaBytes
Max Memory Allocated: 0.07030963897705078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0694580078125 GB
    Memory Allocated: 0.07030963897705078  GigaBytes
Max Memory Allocated: 0.07030963897705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0694580078125 GB
    Memory Allocated: 0.07030963897705078  GigaBytes
Max Memory Allocated: 0.07030963897705078  GigaBytes

----------------input nodes number: 144917
----------------output nodes number: 90941
----------------edges number: 513414
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.0694580078125 GB
    Memory Allocated: 0.07219791412353516  GigaBytes
Max Memory Allocated: 0.07219791412353516  GigaBytes

m.shape torch.Size([13428, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4014892578125 GB
    Memory Allocated: 0.3254561424255371  GigaBytes
Max Memory Allocated: 0.3256063461303711  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4014892578125 GB
    Memory Allocated: 0.3254561424255371  GigaBytes
Max Memory Allocated: 0.3256063461303711  GigaBytes

 h.shape torch.Size([1, 13428, 128]), torch.Size([1, 13428, 128])
----------------------------------------3
 Nvidia-smi: 1.4014892578125 GB
    Memory Allocated: 0.33858442306518555  GigaBytes
Max Memory Allocated: 0.33858442306518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5303955078125 GB
    Memory Allocated: 0.44103193283081055  GigaBytes
Max Memory Allocated: 0.4477572441101074  GigaBytes

rst.shape  torch.Size([1, 13428, 128])
m.shape torch.Size([11706, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5421142578125 GB
    Memory Allocated: 0.446347713470459  GigaBytes
Max Memory Allocated: 0.4477572441101074  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5421142578125 GB
    Memory Allocated: 0.446347713470459  GigaBytes
Max Memory Allocated: 0.4477572441101074  GigaBytes

 h.shape torch.Size([1, 11706, 128]), torch.Size([1, 11706, 128])
----------------------------------------3
 Nvidia-smi: 1.5421142578125 GB
    Memory Allocated: 0.45833253860473633  GigaBytes
Max Memory Allocated: 0.45833253860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7335205078125 GB
    Memory Allocated: 0.6257882118225098  GigaBytes
Max Memory Allocated: 0.6375069618225098  GigaBytes

rst.shape  torch.Size([1, 11706, 128])
m.shape torch.Size([9277, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7471923828125 GB
    Memory Allocated: 0.633878231048584  GigaBytes
Max Memory Allocated: 0.6375069618225098  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7471923828125 GB
    Memory Allocated: 0.633878231048584  GigaBytes
Max Memory Allocated: 0.6375069618225098  GigaBytes

 h.shape torch.Size([1, 9277, 128]), torch.Size([1, 9277, 128])
----------------------------------------3
 Nvidia-smi: 1.7471923828125 GB
    Memory Allocated: 0.6427254676818848  GigaBytes
Max Memory Allocated: 0.6427254676818848  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9757080078125 GB
    Memory Allocated: 0.837364673614502  GigaBytes
Max Memory Allocated: 0.851036548614502  GigaBytes

rst.shape  torch.Size([1, 9277, 128])
m.shape torch.Size([7320, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.9913330078125 GB
    Memory Allocated: 0.8469028472900391  GigaBytes
Max Memory Allocated: 0.851036548614502  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9913330078125 GB
    Memory Allocated: 0.8469028472900391  GigaBytes
Max Memory Allocated: 0.851036548614502  GigaBytes

 h.shape torch.Size([1, 7320, 128]), torch.Size([1, 7320, 128])
----------------------------------------3
 Nvidia-smi: 1.9913330078125 GB
    Memory Allocated: 0.8552703857421875  GigaBytes
Max Memory Allocated: 0.8552703857421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0579290390014648  GigaBytes
Max Memory Allocated: 1.0718908309936523  GigaBytes

rst.shape  torch.Size([1, 7320, 128])
m.shape torch.Size([6222, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.070063591003418  GigaBytes
Max Memory Allocated: 1.0718908309936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.070063591003418  GigaBytes
Max Memory Allocated: 1.0718908309936523  GigaBytes

 h.shape torch.Size([1, 6222, 128]), torch.Size([1, 6222, 128])
----------------------------------------3
 Nvidia-smi: 2.2139892578125 GB
    Memory Allocated: 1.0767545700073242  GigaBytes
Max Memory Allocated: 1.0767545700073242  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4815673828125 GB
    Memory Allocated: 1.290369987487793  GigaBytes
Max Memory Allocated: 1.3052043914794922  GigaBytes

rst.shape  torch.Size([1, 6222, 128])
m.shape torch.Size([4868, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4815673828125 GB
    Memory Allocated: 1.30133056640625  GigaBytes
Max Memory Allocated: 1.3052043914794922  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4815673828125 GB
    Memory Allocated: 1.30133056640625  GigaBytes
Max Memory Allocated: 1.3052043914794922  GigaBytes

 h.shape torch.Size([1, 4868, 128]), torch.Size([1, 4868, 128])
----------------------------------------3
 Nvidia-smi: 2.4815673828125 GB
    Memory Allocated: 1.306570053100586  GigaBytes
Max Memory Allocated: 1.306570053100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6925048828125 GB
    Memory Allocated: 1.5165090560913086  GigaBytes
Max Memory Allocated: 1.5304365158081055  GigaBytes

rst.shape  torch.Size([1, 4868, 128])
m.shape torch.Size([4045, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6925048828125 GB
    Memory Allocated: 1.5276894569396973  GigaBytes
Max Memory Allocated: 1.5304365158081055  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6925048828125 GB
    Memory Allocated: 1.5276894569396973  GigaBytes
Max Memory Allocated: 1.5304365158081055  GigaBytes

 h.shape torch.Size([1, 4045, 128]), torch.Size([1, 4045, 128])
----------------------------------------3
 Nvidia-smi: 2.6925048828125 GB
    Memory Allocated: 1.531804084777832  GigaBytes
Max Memory Allocated: 1.531804084777832  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9210205078125 GB
    Memory Allocated: 1.7267794609069824  GigaBytes
Max Memory Allocated: 1.7404513359069824  GigaBytes

rst.shape  torch.Size([1, 4045, 128])
m.shape torch.Size([3472, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9210205078125 GB
    Memory Allocated: 1.7382793426513672  GigaBytes
Max Memory Allocated: 1.7404513359069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9210205078125 GB
    Memory Allocated: 1.7382793426513672  GigaBytes
Max Memory Allocated: 1.7404513359069824  GigaBytes

 h.shape torch.Size([1, 3472, 128]), torch.Size([1, 3472, 128])
----------------------------------------3
 Nvidia-smi: 2.9210205078125 GB
    Memory Allocated: 1.7416057586669922  GigaBytes
Max Memory Allocated: 1.7416057586669922  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1690673828125 GB
    Memory Allocated: 1.9309520721435547  GigaBytes
Max Memory Allocated: 1.9446239471435547  GigaBytes

rst.shape  torch.Size([1, 3472, 128])
m.shape torch.Size([2976, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1690673828125 GB
    Memory Allocated: 1.942129135131836  GigaBytes
Max Memory Allocated: 1.9446239471435547  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1690673828125 GB
    Memory Allocated: 1.942129135131836  GigaBytes
Max Memory Allocated: 1.9446239471435547  GigaBytes

 h.shape torch.Size([1, 2976, 128]), torch.Size([1, 2976, 128])
----------------------------------------3
 Nvidia-smi: 3.1690673828125 GB
    Memory Allocated: 1.9456653594970703  GigaBytes
Max Memory Allocated: 1.9456653594970703  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2803955078125 GB
    Memory Allocated: 2.142049789428711  GigaBytes
Max Memory Allocated: 2.155721664428711  GigaBytes

rst.shape  torch.Size([1, 2976, 128])
m.shape torch.Size([13814, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.3468017578125 GB
    Memory Allocated: 2.2066192626953125  GigaBytes
Max Memory Allocated: 2.2082443237304688  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3468017578125 GB
    Memory Allocated: 2.2066192626953125  GigaBytes
Max Memory Allocated: 2.2082443237304688  GigaBytes

 h.shape torch.Size([1, 13814, 128]), torch.Size([1, 13814, 128])
----------------------------------------3
 Nvidia-smi: 3.3468017578125 GB
    Memory Allocated: 2.2197933197021484  GigaBytes
Max Memory Allocated: 2.2197933197021484  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4483642578125 GB
    Memory Allocated: 3.155649185180664  GigaBytes
Max Memory Allocated: 3.222055435180664  GigaBytes

rst.shape  torch.Size([1, 13814, 128])
m.shape torch.Size([13813, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.4483642578125 GB
    Memory Allocated: 3.215468406677246  GigaBytes
Max Memory Allocated: 3.222055435180664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4483642578125 GB
    Memory Allocated: 3.215468406677246  GigaBytes
Max Memory Allocated: 3.222055435180664  GigaBytes

 h.shape torch.Size([1, 13813, 128]), torch.Size([1, 13813, 128])
----------------------------------------3
 Nvidia-smi: 4.4483642578125 GB
    Memory Allocated: 3.2286415100097656  GigaBytes
Max Memory Allocated: 3.2286415100097656  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5499267578125 GB
    Memory Allocated: 4.163931846618652  GigaBytes
Max Memory Allocated: 4.230338096618652  GigaBytes

rst.shape  torch.Size([1, 13813, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.954037666320801  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9675893783569336  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

h_self size  torch.Size([90941, 128])
----------------------------------------before rst
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9675893783569336  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

torch.Size([90941, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9811410903930664  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9675893783569336  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

torch.Size([90941, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9811410903930664  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.6397705078125 GB
    Memory Allocated: 3.9946937561035156  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6475830078125 GB
    Memory Allocated: 0.08628082275390625  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.6475830078125 GB
    Memory Allocated: 0.08734130859375  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.6475830078125 GB
    Memory Allocated: 0.08734130859375  GigaBytes
Max Memory Allocated: 4.287877082824707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02548503875732422 |0.12798285484313965 |0.27006983757019043 |0.0002684593200683594 |0.01906728744506836 |0.0017240047454833984 |
----------------------------------------------------------pseudo_mini_loss sum 3.8380048274993896
Total (block generation + training)time/epoch 0.5069811344146729
Training time/epoch 0.4864792823791504
Training time without block to device /epoch 0.35849642753601074
Training time without total dataloading part /epoch 0.29112958908081055
load block tensor time/epoch 0.02548503875732422
block to device time/epoch 0.12798285484313965
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  144917
Number of first layer input nodes during this epoch:  144917
Number of first layer output nodes during this epoch:  90941
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  142336
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([40, 128])
layers.0.fc_neigh.weight, torch.Size([40, 128])
----------------------------------------
un-trainable parameters
