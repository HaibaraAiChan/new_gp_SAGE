main start at this time 1667673586.77487
-----------------------------------------before load data 
 Nvidia-smi: 9.9503173828125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 9.9503173828125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 9.9503173828125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the paramters before train----------0000000000
layers.0.lstm.weight_ih_l0
Parameter containing:
tensor([[ 0.0182, -0.0204, -0.0118,  ..., -0.0069, -0.0263,  0.0186],
        [ 0.0010, -0.0082, -0.0225,  ...,  0.0207,  0.0083, -0.0209],
        [-0.0028,  0.0147, -0.0208,  ...,  0.0140, -0.0088,  0.0194],
        ...,
        [-0.0151,  0.0263, -0.0013,  ..., -0.0136,  0.0216, -0.0143],
        [ 0.0238,  0.0028, -0.0167,  ...,  0.0058, -0.0066, -0.0127],
        [-0.0184,  0.0177,  0.0039,  ..., -0.0180,  0.0207, -0.0188]],
       device='cuda:0', requires_grad=True)
layers.0.lstm.weight_hh_l0
Parameter containing:
tensor([[-0.0042, -0.0088,  0.0224,  ..., -0.0119, -0.0002,  0.0202],
        [ 0.0031,  0.0205,  0.0020,  ..., -0.0253, -0.0064,  0.0175],
        [-0.0181, -0.0144, -0.0080,  ..., -0.0043,  0.0130, -0.0028],
        ...,
        [-0.0226, -0.0201, -0.0141,  ..., -0.0258,  0.0140, -0.0257],
        [-0.0237, -0.0068,  0.0046,  ...,  0.0076, -0.0255,  0.0257],
        [ 0.0257,  0.0209, -0.0226,  ...,  0.0260,  0.0131, -0.0045]],
       device='cuda:0', requires_grad=True)
layers.0.lstm.bias_ih_l0
Parameter containing:
tensor([ 0.0254,  0.0070, -0.0033,  ..., -0.0035,  0.0203, -0.0156],
       device='cuda:0', requires_grad=True)
layers.0.lstm.bias_hh_l0
Parameter containing:
tensor([-0.0064,  0.0004,  0.0041,  ...,  0.0099, -0.0156, -0.0186],
       device='cuda:0', requires_grad=True)
layers.0.fc_self.weight
Parameter containing:
tensor([[-0.0414,  0.0383,  0.0869,  ..., -0.0043, -0.0584,  0.0429],
        [-0.0214,  0.0796, -0.0468,  ..., -0.0118,  0.0611,  0.0796],
        [ 0.0396, -0.0859, -0.0320,  ...,  0.0489, -0.0277,  0.0287],
        ...,
        [-0.0719,  0.0104,  0.0364,  ...,  0.0859,  0.0265,  0.0911],
        [ 0.0682, -0.0805, -0.0726,  ..., -0.0377,  0.0282,  0.0096],
        [ 0.0606,  0.0844, -0.0228,  ...,  0.0572, -0.0222,  0.0192]],
       device='cuda:0', requires_grad=True)
layers.0.fc_neigh.weight
Parameter containing:
tensor([[ 0.0226, -0.0259,  0.0310,  ...,  0.0466,  0.0430,  0.0603],
        [ 0.0790, -0.0567,  0.0061,  ..., -0.0749,  0.0530, -0.0227],
        [ 0.0551,  0.0563, -0.0132,  ...,  0.0868, -0.0010, -0.0552],
        ...,
        [ 0.0866, -0.0564,  0.0576,  ...,  0.0173, -0.0630, -0.0058],
        [ 0.0374, -0.0409,  0.0246,  ...,  0.0364,  0.0742,  0.0614],
        [ 0.0171, -0.0626,  0.0855,  ..., -0.0629, -0.0469, -0.0595]],
       device='cuda:0', requires_grad=True)
------------------------------------0000000000
----------------------------------------after model to device
 Nvidia-smi: 10.7315673828125 GB
    Memory Allocated: 0.06261825561523438  GigaBytes
Max Memory Allocated: 0.0626215934753418  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.7315673828125 GB
    Memory Allocated: 0.06261825561523438  GigaBytes
Max Memory Allocated: 0.0626215934753418  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.7315673828125 GB
    Memory Allocated: 0.06261825561523438  GigaBytes
Max Memory Allocated: 0.0626215934753418  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0026803016662597656
----------------------------------------before batch input features to device
 Nvidia-smi: 10.7315673828125 GB
    Memory Allocated: 0.06261825561523438  GigaBytes
Max Memory Allocated: 0.0626215934753418  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.7510986328125 GB
    Memory Allocated: 0.06574678421020508  GigaBytes
Max Memory Allocated: 0.06574678421020508  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.7510986328125 GB
    Memory Allocated: 0.06574821472167969  GigaBytes
Max Memory Allocated: 0.06574821472167969  GigaBytes

----------------input nodes number: 586
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7764892578125 GB
    Memory Allocated: 0.06575441360473633  GigaBytes
Max Memory Allocated: 0.06575441360473633  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 50, 106,  62,  57,   3,  34,  98,  23,  58,  96, 115,  31,  28,  19,
        127,   7, 134,  63, 136,  66], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 10.8253173828125 GB
    Memory Allocated: 0.0688929557800293  GigaBytes
Max Memory Allocated: 0.06889629364013672  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8253173828125 GB
    Memory Allocated: 0.0688929557800293  GigaBytes
Max Memory Allocated: 0.06889629364013672  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 10.8253173828125 GB
    Memory Allocated: 0.0691065788269043  GigaBytes
Max Memory Allocated: 0.0691065788269043  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8253173828125 GB
    Memory Allocated: 0.0691065788269043  GigaBytes
Max Memory Allocated: 0.0691065788269043  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0709223747253418  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0708155632019043  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0074, -0.0049,  0.0074,  ..., -0.0073,  0.0019,  0.0028],
        [ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040],
        [ 0.0085, -0.0053,  0.0087,  ..., -0.0072,  0.0025,  0.0040],
        ...,
        [ 0.0074, -0.0052,  0.0092,  ..., -0.0072,  0.0031,  0.0033],
        [ 0.0035, -0.0021,  0.0065,  ..., -0.0059,  0.0019,  0.0004],
        [ 0.0074, -0.0050,  0.0084,  ..., -0.0081,  0.0024,  0.0027]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0707087516784668  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0707087516784668  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0709223747253418  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8350830078125 GB
    Memory Allocated: 0.0709223747253418  GigaBytes
Max Memory Allocated: 0.0709223747253418  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.0727381706237793  GigaBytes
Max Memory Allocated: 0.0727381706237793  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.0726313591003418  GigaBytes
Max Memory Allocated: 0.0727381706237793  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([ 77,   9,  70, 125,  21, 117,  29,  72, 100,  49,  42,  79, 129,  10,
         11,  54,  47,  46,  83,  92,  82, 116,  97,  13, 131],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.07279157638549805  GigaBytes
Max Memory Allocated: 0.07279539108276367  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.07279157638549805  GigaBytes
Max Memory Allocated: 0.07279539108276367  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.0730586051940918  GigaBytes
Max Memory Allocated: 0.0730586051940918  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8370361328125 GB
    Memory Allocated: 0.0730586051940918  GigaBytes
Max Memory Allocated: 0.0730586051940918  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.0773310661315918  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.07706403732299805  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0116, -0.0068,  0.0120,  ..., -0.0125,  0.0043,  0.0068],
        [ 0.0119, -0.0084,  0.0114,  ..., -0.0114,  0.0045,  0.0045],
        [ 0.0105, -0.0081,  0.0087,  ..., -0.0101,  0.0057,  0.0067],
        ...,
        [ 0.0116, -0.0072,  0.0117,  ..., -0.0105,  0.0051,  0.0039],
        [ 0.0095, -0.0074,  0.0115,  ..., -0.0103,  0.0047,  0.0053],
        [ 0.0124, -0.0061,  0.0111,  ..., -0.0109,  0.0050,  0.0067]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.07511472702026367  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.07511472702026367  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.07538175582885742  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8409423828125 GB
    Memory Allocated: 0.07538175582885742  GigaBytes
Max Memory Allocated: 0.0773310661315918  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8428955078125 GB
    Memory Allocated: 0.07965421676635742  GigaBytes
Max Memory Allocated: 0.07965421676635742  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8428955078125 GB
    Memory Allocated: 0.07938718795776367  GigaBytes
Max Memory Allocated: 0.07965421676635742  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([ 80,  78,  68, 108,   1,  37, 138, 101,  85,  44, 135,  87, 114,   0,
         64, 130,  35,  40, 113,   8,  60,  53,  76,   5,  71,  67],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 10.8448486328125 GB
    Memory Allocated: 0.07967042922973633  GigaBytes
Max Memory Allocated: 0.07967472076416016  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8448486328125 GB
    Memory Allocated: 0.07967042922973633  GigaBytes
Max Memory Allocated: 0.07967472076416016  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 10.8448486328125 GB
    Memory Allocated: 0.07994890213012695  GigaBytes
Max Memory Allocated: 0.07994890213012695  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8448486328125 GB
    Memory Allocated: 0.07994890213012695  GigaBytes
Max Memory Allocated: 0.07994890213012695  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.08647918701171875  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.08606243133544922  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0152, -0.0065,  0.0121,  ..., -0.0137,  0.0039,  0.0088],
        [ 0.0138, -0.0085,  0.0148,  ..., -0.0112,  0.0069,  0.0083],
        [ 0.0150, -0.0081,  0.0124,  ..., -0.0132,  0.0047,  0.0091],
        ...,
        [ 0.0133, -0.0077,  0.0150,  ..., -0.0119,  0.0060,  0.0092],
        [ 0.0139, -0.0088,  0.0134,  ..., -0.0129,  0.0053,  0.0085],
        [ 0.0128, -0.0079,  0.0137,  ..., -0.0124,  0.0070,  0.0081]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.08178424835205078  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.08178424835205078  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.0820627212524414  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8507080078125 GB
    Memory Allocated: 0.0820627212524414  GigaBytes
Max Memory Allocated: 0.08647918701171875  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8526611328125 GB
    Memory Allocated: 0.0885930061340332  GigaBytes
Max Memory Allocated: 0.0885930061340332  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8526611328125 GB
    Memory Allocated: 0.08817625045776367  GigaBytes
Max Memory Allocated: 0.0885930061340332  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 16,  32,  86,  93,  38, 107, 137,  41, 123,  81,   6, 112,  15, 104,
         12, 122,  90, 128,  27, 105,  25,  56], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 10.8546142578125 GB
    Memory Allocated: 0.08850717544555664  GigaBytes
Max Memory Allocated: 0.0885930061340332  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8546142578125 GB
    Memory Allocated: 0.08850717544555664  GigaBytes
Max Memory Allocated: 0.0885930061340332  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 10.8546142578125 GB
    Memory Allocated: 0.08874273300170898  GigaBytes
Max Memory Allocated: 0.08874273300170898  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8546142578125 GB
    Memory Allocated: 0.08874273300170898  GigaBytes
Max Memory Allocated: 0.08874273300170898  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.09603261947631836  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.09556245803833008  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0148, -0.0078,  0.0138,  ..., -0.0147,  0.0075,  0.0071],
        [ 0.0154, -0.0091,  0.0117,  ..., -0.0129,  0.0084,  0.0093],
        [ 0.0177, -0.0109,  0.0119,  ..., -0.0153,  0.0076,  0.0097],
        ...,
        [ 0.0162, -0.0083,  0.0118,  ..., -0.0133,  0.0063,  0.0093],
        [ 0.0147, -0.0109,  0.0122,  ..., -0.0139,  0.0073,  0.0081],
        [ 0.0179, -0.0092,  0.0122,  ..., -0.0145,  0.0090,  0.0091]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.08919191360473633  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.08919191360473633  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.08942747116088867  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8604736328125 GB
    Memory Allocated: 0.08942747116088867  GigaBytes
Max Memory Allocated: 0.09603261947631836  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09671735763549805  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09624719619750977  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 61,  17,   4,  20,  18,  22, 124,  26, 110,  14,  52, 120,  84, 132,
          2], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0417],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0714],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0625, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09652996063232422  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09652996063232422  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09669017791748047  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8624267578125 GB
    Memory Allocated: 0.09669017791748047  GigaBytes
Max Memory Allocated: 0.09671735763549805  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.1028585433959961  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10245800018310547  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0167, -0.0089,  0.0122,  ..., -0.0152,  0.0077,  0.0088],
        [ 0.0172, -0.0127,  0.0149,  ..., -0.0146,  0.0076,  0.0111],
        [ 0.0165, -0.0088,  0.0110,  ..., -0.0136,  0.0100,  0.0117],
        ...,
        [ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097],
        [ 0.0177, -0.0078,  0.0115,  ..., -0.0148,  0.0111,  0.0089],
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.09544038772583008  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.09544038772583008  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.09560060501098633  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.09560060501098633  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10176897048950195  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10136842727661133  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 75,  91, 103, 126, 119,  43,  51,  99,  45,  30, 111],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10164070129394531  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10164070129394531  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10175895690917969  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8682861328125 GB
    Memory Allocated: 0.10175895690917969  GigaBytes
Max Memory Allocated: 0.1028585433959961  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10717058181762695  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10681819915771484  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        ...,
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0184, -0.0101,  0.0115,  ..., -0.0130,  0.0085,  0.0099],
        [ 0.0165, -0.0096,  0.0141,  ..., -0.0149,  0.0081,  0.0112]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10091114044189453  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10091114044189453  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1010293960571289  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1010293960571289  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10644102096557617  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10608863830566406  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 24,  39,  69, 121], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10617923736572266  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10617923736572266  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10622215270996094  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10622215270996094  GigaBytes
Max Memory Allocated: 0.10717058181762695  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10851764678955078  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.108367919921875  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10322809219360352  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10322809219360352  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1032710075378418  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1032710075378418  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10556650161743164  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10541677474975586  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([102, 139,  36], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10552358627319336  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10552358627319336  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10555601119995117  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10555601119995117  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10752105712890625  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10739278793334961  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104],
        [ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1052093505859375  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10524177551269531  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10524177551269531  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10720682144165039  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10707855224609375  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 33,  48, 133,  74], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1072549819946289  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.1072549819946289  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10729789733886719  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8721923828125 GB
    Memory Allocated: 0.10729789733886719  GigaBytes
Max Memory Allocated: 0.10851764678955078  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.11023712158203125  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.11004447937011719  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.1081700325012207  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.1081700325012207  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.10821294784545898  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.10821294784545898  GigaBytes
Max Memory Allocated: 0.11023712158203125  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.11115217208862305  GigaBytes
Max Memory Allocated: 0.11115217208862305  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8741455078125 GB
    Memory Allocated: 0.11095952987670898  GigaBytes
Max Memory Allocated: 0.11115217208862305  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 88, 109, 118,  94,  73,  55,  89,  59,  95,  65], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 10.8760986328125 GB
    Memory Allocated: 0.11147212982177734  GigaBytes
Max Memory Allocated: 0.11147785186767578  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8760986328125 GB
    Memory Allocated: 0.11147212982177734  GigaBytes
Max Memory Allocated: 0.11147785186767578  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 10.8760986328125 GB
    Memory Allocated: 0.11157894134521484  GigaBytes
Max Memory Allocated: 0.11157894134521484  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8760986328125 GB
    Memory Allocated: 0.11157894134521484  GigaBytes
Max Memory Allocated: 0.11157894134521484  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11969661712646484  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11916255950927734  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0170, -0.0092,  0.0121,  ..., -0.0159,  0.0085,  0.0127],
        [ 0.0198, -0.0103,  0.0139,  ..., -0.0171,  0.0116,  0.0156],
        [ 0.0187, -0.0066,  0.0106,  ..., -0.0119,  0.0060,  0.0103],
        ...,
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0179, -0.0092,  0.0131,  ..., -0.0149,  0.0093,  0.0104],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11634111404418945  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11634111404418945  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11644792556762695  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 10.8839111328125 GB
    Memory Allocated: 0.11644792556762695  GigaBytes
Max Memory Allocated: 0.11969661712646484  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 10.8878173828125 GB
    Memory Allocated: 0.12456560134887695  GigaBytes
Max Memory Allocated: 0.12456560134887695  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8878173828125 GB
    Memory Allocated: 0.12403154373168945  GigaBytes
Max Memory Allocated: 0.12456560134887695  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8917236328125 GB
    Memory Allocated: 0.11405706405639648  GigaBytes
Max Memory Allocated: 0.1262192726135254  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8917236328125 GB
    Memory Allocated: 0.11406087875366211  GigaBytes
Max Memory Allocated: 0.1262192726135254  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 10.8917236328125 GB
    Memory Allocated: 0.11406087875366211  GigaBytes
Max Memory Allocated: 0.1262192726135254  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.8917236328125 GB
    Memory Allocated: 0.11406469345092773  GigaBytes
Max Memory Allocated: 0.1262192726135254  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8917236328125 GB
    Memory Allocated: 0.11406087875366211  GigaBytes
Max Memory Allocated: 0.1262192726135254  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9463, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 0 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0022848844528198242
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1314988136291504  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.131500244140625  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------input nodes number: 586
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.12837648391723633  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([  3, 136, 106,  23,  19,  28,  62,  34,  66,  31,  98,  58, 134,  96,
         57, 115,  50,   7,  63, 127], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13162708282470703  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13162708282470703  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13184070587158203  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13184070587158203  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13354969024658203  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0064, -0.0042,  0.0088,  ..., -0.0076,  0.0016,  0.0028],
        [ 0.0035, -0.0021,  0.0065,  ..., -0.0059,  0.0019,  0.0004],
        [ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040],
        ...,
        [ 0.0047, -0.0040,  0.0125,  ..., -0.0120,  0.0037,  0.0046],
        [ 0.0074, -0.0052,  0.0092,  ..., -0.0072,  0.0031,  0.0033],
        [ 0.0068, -0.0034,  0.0085,  ..., -0.0064,  0.0022,  0.0047]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13344287872314453  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13344287872314453  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13547229766845703  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13536548614501953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([129,  42,  72, 116, 100, 131,  82,  83,  97, 117,  21,  92,  70,  47,
          9,  13,  49, 125,  11,  54,  10,  77,  79,  46,  29],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13579273223876953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13579273223876953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14006519317626953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13979816436767578  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0111, -0.0093,  0.0103,  ..., -0.0104,  0.0038,  0.0058],
        [ 0.0102, -0.0074,  0.0116,  ..., -0.0096,  0.0042,  0.0067],
        [ 0.0114, -0.0076,  0.0114,  ..., -0.0104,  0.0028,  0.0055],
        ...,
        [ 0.0123, -0.0073,  0.0095,  ..., -0.0114,  0.0034,  0.0041],
        [ 0.0114, -0.0053,  0.0117,  ..., -0.0125,  0.0034,  0.0066],
        [ 0.0153, -0.0061,  0.0098,  ..., -0.0078,  0.0084,  0.0060]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1378488540649414  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1378488540649414  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13811588287353516  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.13811588287353516  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14238834381103516  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1421213150024414  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([  0,  64, 114,  40,  76,  80,  67, 135, 138,  53, 113,   1, 130,  44,
         87,  60, 108,   5,  85,  37,   8,  71, 101,  68,  78,  35],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0667, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0714, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14240455627441406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14240455627441406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1426830291748047  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1426830291748047  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14921331405639648  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14879655838012695  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0146, -0.0069,  0.0120,  ..., -0.0116,  0.0052,  0.0069],
        [ 0.0126, -0.0089,  0.0142,  ..., -0.0141,  0.0076,  0.0053],
        [ 0.0119, -0.0096,  0.0109,  ..., -0.0134,  0.0063,  0.0077],
        ...,
        [ 0.0150, -0.0081,  0.0124,  ..., -0.0132,  0.0047,  0.0091],
        [ 0.0138, -0.0085,  0.0148,  ..., -0.0112,  0.0069,  0.0083],
        [ 0.0146, -0.0072,  0.0126,  ..., -0.0139,  0.0058,  0.0078]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14451837539672852  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14451837539672852  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15132713317871094  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1509103775024414  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 93,  90,   6, 112, 107,  16,  32,  86, 128,  56, 104,  25,  15,  81,
        105,  12, 122, 137,  41,  38, 123,  27], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1587667465209961  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1582965850830078  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0133, -0.0078,  0.0109,  ..., -0.0134,  0.0040,  0.0081],
        [ 0.0146, -0.0090,  0.0127,  ..., -0.0136,  0.0065,  0.0085],
        [ 0.0147, -0.0095,  0.0138,  ..., -0.0127,  0.0080,  0.0095],
        ...,
        [ 0.0147, -0.0096,  0.0140,  ..., -0.0132,  0.0072,  0.0082],
        [ 0.0143, -0.0068,  0.0148,  ..., -0.0127,  0.0067,  0.0089],
        [ 0.0146, -0.0081,  0.0137,  ..., -0.0147,  0.0071,  0.0092]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15192604064941406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15192604064941406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1521615982055664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1521615982055664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15945148468017578  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1589813232421875  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 61,  20,   2, 132,   4,  14, 120,  52,  22,  26, 110,  18,  84,  17,
        124], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0417],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0714],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15926408767700195  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15926408767700195  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1594243049621582  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1594243049621582  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16559267044067383  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1651921272277832  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0167, -0.0089,  0.0122,  ..., -0.0152,  0.0077,  0.0088],
        [ 0.0173, -0.0085,  0.0114,  ..., -0.0142,  0.0076,  0.0095],
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106],
        ...,
        [ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097],
        [ 0.0172, -0.0127,  0.0149,  ..., -0.0146,  0.0076,  0.0111],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1581745147705078  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1581745147705078  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15833473205566406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.15833473205566406  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1645030975341797  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16410255432128906  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([103, 126,  43,  91, 111,  30,  75, 119,  51,  45,  99],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16437482833862305  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16437482833862305  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16449308395385742  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16449308395385742  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1699047088623047  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16955232620239258  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0153, -0.0105,  0.0138,  ..., -0.0140,  0.0084,  0.0109],
        [ 0.0194, -0.0066,  0.0151,  ..., -0.0130,  0.0101,  0.0096],
        ...,
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094],
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0157, -0.0077,  0.0152,  ..., -0.0141,  0.0081,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16376352310180664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16376352310180664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1691751480102539  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1688227653503418  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 39,  24, 121,  69], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16895627975463867  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16895627975463867  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17125177383422852  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17110204696655273  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16596221923828125  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16596221923828125  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16600513458251953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16600513458251953  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16830062866210938  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1681509017944336  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([139,  36, 102], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1682577133178711  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1682577133178711  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17025518417358398  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17012691497802734  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16794347763061523  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16794347763061523  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16994094848632812  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16981267929077148  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 74, 133,  48,  33], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16998910903930664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.16998910903930664  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17297124862670898  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17277860641479492  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17090415954589844  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17090415954589844  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17094707489013672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17094707489013672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17388629913330078  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17369365692138672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 59,  73,  95,  65,  89,  55, 109,  88,  94, 118], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0400, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17420625686645508  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17420625686645508  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17431306838989258  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17431306838989258  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.18243074417114258  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.18189668655395508  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0185, -0.0082,  0.0136,  ..., -0.0169,  0.0090,  0.0090],
        [ 0.0162, -0.0105,  0.0129,  ..., -0.0134,  0.0101,  0.0101],
        ...,
        [ 0.0173, -0.0082,  0.0131,  ..., -0.0155,  0.0087,  0.0112],
        [ 0.0193, -0.0124,  0.0128,  ..., -0.0149,  0.0086,  0.0100],
        [ 0.0204, -0.0089,  0.0114,  ..., -0.0162,  0.0078,  0.0126]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1790752410888672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1790752410888672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1791820526123047  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1791820526123047  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1872997283935547  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1867656707763672  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17667913436889648  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.17668676376342773  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0245361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.23720264434814453  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 1 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0021413167317708335
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13150930404663086  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13151073455810547  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------input nodes number: 588
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283869743347168  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 19,  58, 127, 106, 134,  96,  28, 136,  23,  57,  98,   7, 115,  31,
         34,  62,   3,  66,  63,  50], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13173913955688477  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13173913955688477  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13344812393188477  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0063, -0.0050,  0.0095,  ..., -0.0073,  0.0041,  0.0034],
        [ 0.0058, -0.0045,  0.0087,  ..., -0.0075,  0.0020,  0.0028],
        [ 0.0068, -0.0034,  0.0085,  ..., -0.0064,  0.0022,  0.0047],
        ...,
        [ 0.0074, -0.0050,  0.0084,  ..., -0.0081,  0.0024,  0.0027],
        [ 0.0074, -0.0052,  0.0092,  ..., -0.0072,  0.0031,  0.0033],
        [ 0.0074, -0.0049,  0.0074,  ..., -0.0073,  0.0019,  0.0028]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13334131240844727  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13334131240844727  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13537073135375977  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13526391983032227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([ 54,  77,  97,  29,  46,  42, 116,  82,  11,  70, 117,  47,  79,  49,
        125,  72, 100,  13,   9, 129,  83,  21,  10,  92, 131],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0526, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542413711547852  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542413711547852  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13569116592407227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13569116592407227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13996362686157227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13969659805297852  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0119, -0.0059,  0.0111,  ..., -0.0120,  0.0041,  0.0056],
        [ 0.0116, -0.0068,  0.0120,  ..., -0.0125,  0.0043,  0.0068],
        [ 0.0116, -0.0072,  0.0117,  ..., -0.0105,  0.0051,  0.0039],
        ...,
        [ 0.0091, -0.0085,  0.0103,  ..., -0.0100,  0.0040,  0.0070],
        [ 0.0109, -0.0049,  0.0117,  ..., -0.0110,  0.0055,  0.0054],
        [ 0.0124, -0.0061,  0.0111,  ..., -0.0109,  0.0050,  0.0067]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13774728775024414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13774728775024414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1380143165588379  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1380143165588379  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1422867774963379  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14201974868774414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([ 37,   1,  53, 108,  76, 114,   0, 135,  64,  60,  80, 138, 101,  40,
         85,  44,  71, 130,  68,  78,  35, 113,  87,   5,   8,  67],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1423029899597168  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1423029899597168  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258146286010742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258146286010742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14911174774169922  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1486949920654297  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0136, -0.0073,  0.0137,  ..., -0.0144,  0.0064,  0.0062],
        [ 0.0148, -0.0079,  0.0121,  ..., -0.0127,  0.0067,  0.0071],
        [ 0.0145, -0.0079,  0.0137,  ..., -0.0123,  0.0042,  0.0080],
        ...,
        [ 0.0133, -0.0077,  0.0150,  ..., -0.0119,  0.0060,  0.0092],
        [ 0.0129, -0.0091,  0.0113,  ..., -0.0150,  0.0054,  0.0049],
        [ 0.0128, -0.0079,  0.0137,  ..., -0.0124,  0.0070,  0.0081]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14441680908203125  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14441680908203125  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14469528198242188  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14469528198242188  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15122556686401367  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15080881118774414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 15,   6, 122,  41, 105,  86,  12,  56,  25, 123, 112,  38, 128,  32,
         90,  93, 107,  16, 104,  81,  27, 137], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0625, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1511397361755371  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1511397361755371  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15137529373168945  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15137529373168945  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15866518020629883  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15819501876831055  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0165, -0.0086,  0.0126,  ..., -0.0137,  0.0085,  0.0093],
        [ 0.0147, -0.0095,  0.0138,  ..., -0.0127,  0.0080,  0.0095],
        [ 0.0120, -0.0072,  0.0154,  ..., -0.0140,  0.0075,  0.0071],
        ...,
        [ 0.0165, -0.0095,  0.0124,  ..., -0.0130,  0.0077,  0.0122],
        [ 0.0146, -0.0081,  0.0137,  ..., -0.0147,  0.0071,  0.0092],
        [ 0.0151, -0.0104,  0.0139,  ..., -0.0139,  0.0057,  0.0107]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1518244743347168  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1518244743347168  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206003189086914  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206003189086914  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15934991836547852  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15887975692749023  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 22,   2,  14,   4, 120,  26,  61, 124,  20, 132,  52,  84,  17,  18,
        110], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0417],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0714],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1591625213623047  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1591625213623047  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932273864746094  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932273864746094  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16549110412597656  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16509056091308594  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0195, -0.0130,  0.0153,  ..., -0.0160,  0.0093,  0.0111],
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106],
        [ 0.0164, -0.0092,  0.0120,  ..., -0.0166,  0.0089,  0.0096],
        ...,
        [ 0.0172, -0.0127,  0.0149,  ..., -0.0146,  0.0076,  0.0111],
        [ 0.0201, -0.0107,  0.0149,  ..., -0.0124,  0.0070,  0.0095],
        [ 0.0169, -0.0088,  0.0134,  ..., -0.0152,  0.0069,  0.0093]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807294845581055  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807294845581055  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1582331657409668  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1582331657409668  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16440153121948242  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1640009880065918  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([103,  75,  51, 119, 126, 111,  30,  43,  99,  45,  91],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427326202392578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427326202392578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439151763916016  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439151763916016  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16980314254760742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1694507598876953  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094],
        ...,
        [ 0.0157, -0.0077,  0.0152,  ..., -0.0141,  0.0081,  0.0104],
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.163543701171875  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.163543701171875  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16366195678710938  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16366195678710938  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16907358169555664  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16872119903564453  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 69, 121,  24,  39], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881179809570312  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881179809570312  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688547134399414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688547134399414  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17115020751953125  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17100048065185547  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586065292358398  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586065292358398  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16590356826782227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16590356826782227  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681990623474121  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16804933547973633  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([102,  36, 139], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16815614700317383  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16815614700317383  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17015361785888672  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17002534866333008  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16784191131591797  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16784191131591797  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16787433624267578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16787433624267578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16983938217163086  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16971111297607422  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([133,  48,  74,  33], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16988754272460938  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16988754272460938  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16993045806884766  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16993045806884766  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17286968231201172  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17267704010009766  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17080259323120117  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17080259323120117  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17084550857543945  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17084550857543945  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17378473281860352  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17359209060668945  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 88, 118,  55,  89, 109,  94,  95,  73,  59,  65], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1741046905517578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1741046905517578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1742115020751953  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1742115020751953  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1823291778564453  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1817951202392578  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0183, -0.0092,  0.0141,  ..., -0.0153,  0.0098,  0.0100],
        [ 0.0173, -0.0082,  0.0120,  ..., -0.0149,  0.0092,  0.0119],
        [ 0.0189, -0.0102,  0.0135,  ..., -0.0137,  0.0097,  0.0113],
        ...,
        [ 0.0183, -0.0109,  0.0128,  ..., -0.0155,  0.0076,  0.0109],
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897367477416992  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897367477416992  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908048629760742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908048629760742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18719816207885742  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18666410446166992  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668962478637695  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766972541809082  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.2997455596923828  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 2 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.128387451171875  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.128387451171875  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0020606517791748047
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12838077545166016  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13150930404663086  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13151073455810547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------input nodes number: 586
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837648391723633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 34,  58,  66,  62,  50,  98, 127,  28, 115, 134,   3,  57,  31,  96,
         63,  23, 136,  19,   7, 106], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315150260925293  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315150260925293  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317286491394043  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317286491394043  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1334376335144043  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0066, -0.0052,  0.0078,  ..., -0.0070,  0.0015,  0.0031],
        [ 0.0058, -0.0045,  0.0087,  ..., -0.0075,  0.0020,  0.0028],
        [ 0.0074, -0.0050,  0.0084,  ..., -0.0081,  0.0024,  0.0027],
        ...,
        [ 0.0063, -0.0050,  0.0095,  ..., -0.0073,  0.0041,  0.0034],
        [ 0.0047, -0.0040,  0.0125,  ..., -0.0120,  0.0037,  0.0046],
        [ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1353602409362793  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1352534294128418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([100, 131,  70,  82,  79,  92,  13, 129,  54,  77,  49,  10,  42,  21,
         72,  83,  47, 116,  46,  29,  11, 125, 117,   9,  97],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13541364669799805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13541364669799805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356806755065918  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356806755065918  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1399531364440918  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13968610763549805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0113, -0.0074,  0.0122,  ..., -0.0107,  0.0042,  0.0050],
        [ 0.0124, -0.0061,  0.0111,  ..., -0.0109,  0.0050,  0.0067],
        [ 0.0105, -0.0081,  0.0087,  ..., -0.0101,  0.0057,  0.0067],
        ...,
        [ 0.0113, -0.0069,  0.0135,  ..., -0.0125,  0.0041,  0.0039],
        [ 0.0119, -0.0084,  0.0114,  ..., -0.0114,  0.0045,  0.0045],
        [ 0.0116, -0.0072,  0.0117,  ..., -0.0105,  0.0051,  0.0039]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13773679733276367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13773679733276367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13800382614135742  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13800382614135742  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14227628707885742  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14200925827026367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([ 60, 101,  35,  85, 108, 114,  71,  44, 138,  76, 135,  87,   8,  53,
         67,  68,  37,  64,  78,   0, 130,   1,   5, 113,  80,  40],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229249954223633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229249954223633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14257097244262695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14257097244262695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14910125732421875  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14868450164794922  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0143, -0.0066,  0.0132,  ..., -0.0132,  0.0064,  0.0081],
        [ 0.0127, -0.0093,  0.0135,  ..., -0.0127,  0.0056,  0.0066],
        [ 0.0146, -0.0072,  0.0126,  ..., -0.0139,  0.0058,  0.0078],
        ...,
        [ 0.0116, -0.0056,  0.0150,  ..., -0.0113,  0.0057,  0.0080],
        [ 0.0152, -0.0065,  0.0121,  ..., -0.0137,  0.0039,  0.0088],
        [ 0.0146, -0.0088,  0.0108,  ..., -0.0131,  0.0071,  0.0071]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14440631866455078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14440631866455078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1446847915649414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1446847915649414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1512150764465332  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15079832077026367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 81,  93,  25,  27,  12, 137, 104,   6, 123,  86,  90,  56, 112,  15,
         38, 107, 122,  16, 105,  41, 128,  32], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0455,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15112924575805664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15112924575805664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15136480331420898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15136480331420898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15865468978881836  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15818452835083008  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0165, -0.0095,  0.0124,  ..., -0.0130,  0.0077,  0.0122],
        [ 0.0133, -0.0078,  0.0109,  ..., -0.0134,  0.0040,  0.0081],
        [ 0.0147, -0.0109,  0.0122,  ..., -0.0139,  0.0073,  0.0081],
        ...,
        [ 0.0158, -0.0097,  0.0139,  ..., -0.0153,  0.0054,  0.0093],
        [ 0.0146, -0.0084,  0.0135,  ..., -0.0128,  0.0072,  0.0083],
        [ 0.0154, -0.0091,  0.0117,  ..., -0.0129,  0.0084,  0.0093]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15204954147338867  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15204954147338867  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15933942794799805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15886926651000977  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 22,  20, 124,  84, 132,  17,  61,   4,  26,  52, 110,  14,   2, 120,
         18], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15915203094482422  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15915203094482422  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15931224822998047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15931224822998047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1654806137084961  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16508007049560547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0195, -0.0130,  0.0153,  ..., -0.0160,  0.0093,  0.0111],
        [ 0.0173, -0.0085,  0.0114,  ..., -0.0142,  0.0076,  0.0095],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073],
        ...,
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106],
        [ 0.0167, -0.0095,  0.0129,  ..., -0.0148,  0.0081,  0.0117],
        [ 0.0201, -0.0107,  0.0149,  ..., -0.0124,  0.0070,  0.0095]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15806245803833008  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15806245803833008  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15822267532348633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15822267532348633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439104080200195  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16399049758911133  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 30, 103, 119,  45, 126,  99,  51,  75,  43, 111,  91],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1642627716064453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1642627716064453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643810272216797  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643810272216797  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16979265213012695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16944026947021484  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0184, -0.0101,  0.0115,  ..., -0.0130,  0.0085,  0.0099],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0175, -0.0080,  0.0108,  ..., -0.0149,  0.0108,  0.0109],
        ...,
        [ 0.0194, -0.0066,  0.0151,  ..., -0.0130,  0.0101,  0.0096],
        [ 0.0165, -0.0096,  0.0141,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636514663696289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636514663696289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16906309127807617  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16871070861816406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 39,  69, 121,  24], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16880130767822266  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16880130767822266  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16884422302246094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16884422302246094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17113971710205078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.170989990234375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16585016250610352  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16585016250610352  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1658930778503418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1658930778503418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16803884506225586  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([139,  36, 102], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16814565658569336  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16814565658569336  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16817808151245117  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16817808151245117  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17014312744140625  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1700148582458496  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678638458251953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678638458251953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698288917541504  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16970062255859375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 48, 133,  74,  33], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699199676513672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699199676513672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17285919189453125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1726665496826172  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1707921028137207  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1707921028137207  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17083501815795898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17083501815795898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17377424240112305  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17358160018920898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 55,  73,  65, 118,  94,  95, 109,  59,  89,  88], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0400, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0526,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17409420013427734  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17409420013427734  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420101165771484  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420101165771484  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18231868743896484  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18178462982177734  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0183, -0.0102,  0.0136,  ..., -0.0146,  0.0093,  0.0111],
        [ 0.0177, -0.0088,  0.0129,  ..., -0.0148,  0.0086,  0.0107],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115],
        ...,
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0190, -0.0074,  0.0110,  ..., -0.0150,  0.0076,  0.0114],
        [ 0.0181, -0.0074,  0.0129,  ..., -0.0161,  0.0089,  0.0117]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17896318435668945  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17896318435668945  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17906999588012695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17906999588012695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18718767166137695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18665361404418945  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17667913436889648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668676376342773  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9463, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 3 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002009010314941406
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1314988136291504  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.131500244140625  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------input nodes number: 586
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837648391723633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 31, 106,  58,  62,  19,  66,   3, 136,  96,  98,  28,  23,  50,  63,
        115,  34, 134, 127,  57,   7], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13162708282470703  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13162708282470703  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13184070587158203  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13184070587158203  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13354969024658203  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0074, -0.0045,  0.0061,  ..., -0.0080,  0.0018,  0.0034],
        [ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040],
        [ 0.0058, -0.0045,  0.0087,  ..., -0.0075,  0.0020,  0.0028],
        ...,
        [ 0.0068, -0.0034,  0.0085,  ..., -0.0064,  0.0022,  0.0047],
        [ 0.0060, -0.0040,  0.0076,  ..., -0.0066,  0.0015,  0.0028],
        [ 0.0047, -0.0040,  0.0125,  ..., -0.0120,  0.0037,  0.0046]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13344287872314453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13344287872314453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13365650177001953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13547229766845703  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13536548614501953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([ 49, 116, 131,  42, 117,  29,  82,  72,  97,  47,  11,  46,  70,  77,
          9,  54,  13, 125,  83,  10,  92, 129,  21, 100,  79],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13552570343017578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13579273223876953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13579273223876953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14006519317626953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13979816436767578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0122, -0.0080,  0.0114,  ..., -0.0100,  0.0057,  0.0058],
        [ 0.0097, -0.0077,  0.0098,  ..., -0.0123,  0.0043,  0.0054],
        [ 0.0124, -0.0061,  0.0111,  ..., -0.0109,  0.0050,  0.0067],
        ...,
        [ 0.0112, -0.0079,  0.0108,  ..., -0.0114,  0.0037,  0.0038],
        [ 0.0113, -0.0074,  0.0122,  ..., -0.0107,  0.0042,  0.0050],
        [ 0.0123, -0.0073,  0.0095,  ..., -0.0114,  0.0034,  0.0041]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1378488540649414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1378488540649414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13811588287353516  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13811588287353516  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14238834381103516  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1421213150024414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([138,  85,  64,  87,  40, 108,  78,  37, 114, 135,   0,  44,  60,  35,
         67,   1,  76,  71,   8,  68,  53, 130, 101,  80, 113,   5],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14240455627441406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14240455627441406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1426830291748047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1426830291748047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14921331405639648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14879655838012695  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0131, -0.0081,  0.0115,  ..., -0.0131,  0.0062,  0.0088],
        [ 0.0145, -0.0064,  0.0125,  ..., -0.0125,  0.0063,  0.0090],
        [ 0.0126, -0.0089,  0.0142,  ..., -0.0141,  0.0076,  0.0053],
        ...,
        [ 0.0152, -0.0065,  0.0121,  ..., -0.0137,  0.0039,  0.0088],
        [ 0.0116, -0.0056,  0.0150,  ..., -0.0113,  0.0057,  0.0080],
        [ 0.0133, -0.0077,  0.0150,  ..., -0.0119,  0.0060,  0.0092]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14451837539672852  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14451837539672852  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14479684829711914  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15132713317871094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1509103775024414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([112,  12,  27,  16, 123,  90,  15, 128,  32, 122,   6,  56,  41, 105,
         81,  93,  25, 137, 104,  38,  86, 107], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0435, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0476, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15124130249023438  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15147686004638672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1587667465209961  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1582965850830078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0164, -0.0101,  0.0150,  ..., -0.0127,  0.0061,  0.0094],
        [ 0.0173, -0.0074,  0.0162,  ..., -0.0128,  0.0094,  0.0069],
        [ 0.0146, -0.0081,  0.0137,  ..., -0.0147,  0.0071,  0.0092],
        ...,
        [ 0.0147, -0.0096,  0.0140,  ..., -0.0132,  0.0072,  0.0082],
        [ 0.0177, -0.0109,  0.0119,  ..., -0.0153,  0.0076,  0.0097],
        [ 0.0161, -0.0091,  0.0125,  ..., -0.0157,  0.0077,  0.0099]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15192604064941406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15192604064941406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1521615982055664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1521615982055664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15945148468017578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1589813232421875  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 26, 124,  61,  18, 132,  14,  52,  17,   2,  20, 110,  22,   4, 120,
         84], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0625, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15926408767700195  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15926408767700195  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1594243049621582  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1594243049621582  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16559267044067383  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1651921272277832  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0133, -0.0076,  0.0156,  ..., -0.0149,  0.0084,  0.0079],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073],
        [ 0.0167, -0.0089,  0.0122,  ..., -0.0152,  0.0077,  0.0088],
        ...,
        [ 0.0165, -0.0088,  0.0110,  ..., -0.0136,  0.0100,  0.0117],
        [ 0.0167, -0.0095,  0.0129,  ..., -0.0148,  0.0081,  0.0117],
        [ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1581745147705078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1581745147705078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15833473205566406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15833473205566406  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1645030975341797  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16410255432128906  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 91, 111,  99,  51,  75, 126, 119,  43,  45,  30, 103],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16437482833862305  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16437482833862305  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16449308395385742  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16449308395385742  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699047088623047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16955232620239258  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100],
        [ 0.0165, -0.0096,  0.0141,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0157, -0.0077,  0.0152,  ..., -0.0141,  0.0081,  0.0104],
        ...,
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0184, -0.0101,  0.0115,  ..., -0.0130,  0.0085,  0.0099],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16364526748657227  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16376352310180664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16376352310180664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1691751480102539  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688227653503418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 69, 121,  24,  39], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16895627975463867  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16895627975463867  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17125177383422852  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17110204696655273  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16596221923828125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16596221923828125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16600513458251953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16600513458251953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16830062866210938  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681509017944336  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([139, 102,  36], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1682577133178711  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1682577133178711  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1682901382446289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17025518417358398  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17012691497802734  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16794347763061523  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16794347763061523  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16797590255737305  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16994094848632812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16981267929077148  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 33, 133,  74,  48], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16998910903930664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16998910903930664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17003202438354492  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17297124862670898  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17277860641479492  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17090415954589844  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17090415954589844  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17094707489013672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17094707489013672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17388629913330078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17369365692138672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 88,  65,  95,  59,  89,  55, 109, 118,  73,  94], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0400, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0556,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420625686645508  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420625686645508  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17431306838989258  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17431306838989258  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18243074417114258  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18189668655395508  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0184, -0.0101,  0.0130,  ..., -0.0165,  0.0077,  0.0113],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115],
        [ 0.0184, -0.0094,  0.0118,  ..., -0.0161,  0.0075,  0.0096],
        ...,
        [ 0.0193, -0.0089,  0.0127,  ..., -0.0140,  0.0070,  0.0130],
        [ 0.0187, -0.0092,  0.0143,  ..., -0.0139,  0.0086,  0.0109],
        [ 0.0193, -0.0092,  0.0138,  ..., -0.0152,  0.0095,  0.0107]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1790752410888672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1790752410888672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1791820526123047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1791820526123047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1872997283935547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1867656707763672  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17667913436889648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668676376342773  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 4 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0020455121994018555
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152027130126953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152170181274414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------input nodes number: 590
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839794158935547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([106,  19,  57,  23,  50,  66,  28,  96,  34, 136,  58,  63,  31,  62,
        134, 115,   3,  98,   7, 127], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13153648376464844  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13153648376464844  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13175010681152344  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13175010681152344  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13356590270996094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13345909118652344  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040],
        [ 0.0063, -0.0050,  0.0095,  ..., -0.0073,  0.0041,  0.0034],
        [ 0.0060, -0.0040,  0.0076,  ..., -0.0066,  0.0015,  0.0028],
        ...,
        [ 0.0060, -0.0033,  0.0081,  ..., -0.0085,  0.0032,  0.0038],
        [ 0.0047, -0.0040,  0.0125,  ..., -0.0120,  0.0037,  0.0046],
        [ 0.0068, -0.0034,  0.0085,  ..., -0.0064,  0.0022,  0.0047]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13335227966308594  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13335227966308594  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13356590270996094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13356590270996094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13538169860839844  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13527488708496094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([129,  29,  49,  21, 116,  54,  82, 117,  13, 100,  42,  46,   9, 131,
         47,  83,  92,  97,  11,  79,  10, 125,  70,  77,  72],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1354351043701172  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1354351043701172  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13570213317871094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13570213317871094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13997459411621094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1397075653076172  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0111, -0.0093,  0.0103,  ..., -0.0104,  0.0038,  0.0058],
        [ 0.0153, -0.0061,  0.0098,  ..., -0.0078,  0.0084,  0.0060],
        [ 0.0122, -0.0080,  0.0114,  ..., -0.0100,  0.0057,  0.0058],
        ...,
        [ 0.0105, -0.0081,  0.0087,  ..., -0.0101,  0.0057,  0.0067],
        [ 0.0116, -0.0068,  0.0120,  ..., -0.0125,  0.0043,  0.0068],
        [ 0.0114, -0.0076,  0.0114,  ..., -0.0104,  0.0028,  0.0055]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1377582550048828  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1377582550048828  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13802528381347656  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13802528381347656  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229774475097656  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1420307159423828  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([108,   8,  37,  87,  68,  71, 138,  64,   0, 101,  85,  80,  78,  67,
        130,  53,  35,  60, 113,  76,  40, 114,   5,   1, 135,  44],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14231395721435547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14231395721435547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1425924301147461  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1425924301147461  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1491227149963379  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14870595932006836  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0111, -0.0070,  0.0151,  ..., -0.0148,  0.0085,  0.0115],
        [ 0.0129, -0.0091,  0.0113,  ..., -0.0150,  0.0054,  0.0049],
        [ 0.0136, -0.0073,  0.0137,  ..., -0.0144,  0.0064,  0.0062],
        ...,
        [ 0.0148, -0.0079,  0.0121,  ..., -0.0127,  0.0067,  0.0071],
        [ 0.0117, -0.0104,  0.0129,  ..., -0.0132,  0.0050,  0.0089],
        [ 0.0128, -0.0083,  0.0120,  ..., -0.0136,  0.0080,  0.0089]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14442777633666992  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14442777633666992  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14470624923706055  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14470624923706055  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15123653411865234  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1508197784423828  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 41, 112,  25,  38,  15, 137, 123, 105, 104,  81,  86, 122,  32,  12,
         90,  27,  56,   6, 128, 107,  16,  93], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0435, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0476, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15115070343017578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15115070343017578  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15138626098632812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15138626098632812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1586761474609375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15820598602294922  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0158, -0.0097,  0.0139,  ..., -0.0153,  0.0054,  0.0093],
        [ 0.0164, -0.0101,  0.0150,  ..., -0.0127,  0.0061,  0.0094],
        [ 0.0147, -0.0109,  0.0122,  ..., -0.0139,  0.0073,  0.0081],
        ...,
        [ 0.0161, -0.0091,  0.0125,  ..., -0.0157,  0.0077,  0.0099],
        [ 0.0148, -0.0078,  0.0138,  ..., -0.0147,  0.0075,  0.0071],
        [ 0.0133, -0.0078,  0.0109,  ..., -0.0134,  0.0040,  0.0081]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15183544158935547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15183544158935547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1520709991455078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1520709991455078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1593608856201172  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1588907241821289  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 20,  18, 124,  17, 132,  61,   2,  26,  52, 110,  84, 120,  14,  22,
          4], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0625, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15917348861694336  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15917348861694336  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1593337059020996  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1593337059020996  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16550207138061523  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1651015281677246  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0173, -0.0085,  0.0114,  ..., -0.0142,  0.0076,  0.0095],
        [ 0.0201, -0.0107,  0.0149,  ..., -0.0124,  0.0070,  0.0095],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073],
        ...,
        [ 0.0164, -0.0092,  0.0120,  ..., -0.0166,  0.0089,  0.0096],
        [ 0.0195, -0.0130,  0.0153,  ..., -0.0160,  0.0093,  0.0111],
        [ 0.0165, -0.0088,  0.0110,  ..., -0.0136,  0.0100,  0.0117]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15808391571044922  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15808391571044922  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15824413299560547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15824413299560547  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1644124984741211  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16401195526123047  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 75,  99, 126, 119,  43, 111,  51,  30, 103,  45,  91],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16428422927856445  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16428422927856445  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16440248489379883  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16440248489379883  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698141098022461  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16946172714233398  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        [ 0.0157, -0.0077,  0.0152,  ..., -0.0141,  0.0081,  0.0104],
        [ 0.0153, -0.0105,  0.0138,  ..., -0.0140,  0.0084,  0.0109],
        ...,
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16355466842651367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16355466842651367  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16367292404174805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16367292404174805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1690845489501953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1687321662902832  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 24, 121,  69,  39], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688227653503418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688227653503418  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16886568069458008  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16886568069458008  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17116117477416992  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17101144790649414  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16587162017822266  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16587162017822266  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16591453552246094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16591453552246094  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16821002960205078  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.168060302734375  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([102, 139,  36], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681671142578125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681671142578125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681995391845703  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681995391845703  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1701645851135254  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17003631591796875  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104],
        [ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16785287857055664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16785287857055664  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16788530349731445  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16788530349731445  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16985034942626953  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1697220802307129  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([133,  48,  33,  74], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16989850997924805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16989850997924805  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16994142532348633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16994142532348633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1728806495666504  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17268800735473633  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17081356048583984  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17081356048583984  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17085647583007812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17085647583007812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1737957000732422  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17360305786132812  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([109,  95, 118,  89,  88,  94,  55,  73,  59,  65], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17411565780639648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17411565780639648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17422246932983398  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17422246932983398  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18234014511108398  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18180608749389648  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0173, -0.0104,  0.0133,  ..., -0.0148,  0.0092,  0.0116],
        [ 0.0171, -0.0109,  0.0125,  ..., -0.0130,  0.0062,  0.0114],
        [ 0.0170, -0.0095,  0.0115,  ..., -0.0146,  0.0092,  0.0107],
        ...,
        [ 0.0197, -0.0101,  0.0142,  ..., -0.0146,  0.0079,  0.0108],
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1789846420288086  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1789846420288086  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1790914535522461  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1790914535522461  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1872091293334961  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1866750717163086  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670059204101562  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670440673828125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670440673828125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670822143554688  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670440673828125  GigaBytes
Max Memory Allocated: 0.2997560501098633  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9463, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 5 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839841842651367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839841842651367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002021312713623047
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839174270629883  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152027130126953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152170181274414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------input nodes number: 586
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837648391723633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([115,  62, 106,  63,  58,  19,  34,  98,  23, 134,   7,  50, 127, 136,
         96,  31,  28,   3,  57,  66], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315150260925293  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315150260925293  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317286491394043  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317286491394043  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1334376335144043  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0073, -0.0047,  0.0071,  ..., -0.0080,  0.0025,  0.0040],
        [ 0.0085, -0.0053,  0.0087,  ..., -0.0072,  0.0025,  0.0040],
        [ 0.0058, -0.0048,  0.0083,  ..., -0.0065,  0.0034,  0.0040],
        ...,
        [ 0.0064, -0.0042,  0.0088,  ..., -0.0076,  0.0016,  0.0028],
        [ 0.0060, -0.0040,  0.0076,  ..., -0.0066,  0.0015,  0.0028],
        [ 0.0074, -0.0050,  0.0084,  ..., -0.0081,  0.0024,  0.0027]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333308219909668  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335444450378418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1353602409362793  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1352534294128418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([ 97,  72, 131, 117,  77,  46,  10,  83,  11,   9,  79, 116,  70, 125,
         92,  42,  49,  13, 100, 129,  29,  21,  82,  47,  54],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13541364669799805  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13541364669799805  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356806755065918  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356806755065918  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1399531364440918  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13968610763549805  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0116, -0.0072,  0.0117,  ..., -0.0105,  0.0051,  0.0039],
        [ 0.0114, -0.0076,  0.0114,  ..., -0.0104,  0.0028,  0.0055],
        [ 0.0124, -0.0061,  0.0111,  ..., -0.0109,  0.0050,  0.0067],
        ...,
        [ 0.0123, -0.0059,  0.0112,  ..., -0.0111,  0.0064,  0.0050],
        [ 0.0118, -0.0068,  0.0098,  ..., -0.0111,  0.0052,  0.0052],
        [ 0.0119, -0.0059,  0.0111,  ..., -0.0120,  0.0041,  0.0056]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13773679733276367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13773679733276367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13800382614135742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13800382614135742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14227628707885742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14200925827026367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([ 78,  35, 114,   0,  87,  53, 138,  71,  67,   1, 113, 101,  68,  76,
         44, 130,   5, 135,  60,  37,  64,   8, 108,  85,  40,  80],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0714, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229249954223633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229249954223633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14257097244262695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14257097244262695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14910125732421875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14868450164794922  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0138, -0.0085,  0.0148,  ..., -0.0112,  0.0069,  0.0083],
        [ 0.0146, -0.0072,  0.0126,  ..., -0.0139,  0.0058,  0.0078],
        [ 0.0119, -0.0096,  0.0109,  ..., -0.0134,  0.0063,  0.0077],
        ...,
        [ 0.0145, -0.0064,  0.0125,  ..., -0.0125,  0.0063,  0.0090],
        [ 0.0146, -0.0088,  0.0108,  ..., -0.0131,  0.0071,  0.0071],
        [ 0.0152, -0.0065,  0.0121,  ..., -0.0137,  0.0039,  0.0088]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14440631866455078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14440631866455078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1446847915649414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1446847915649414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1512150764465332  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15079832077026367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 93, 122, 107,  90, 123,  56,  25,  32, 137,  16, 104,  15,  81, 128,
        105, 112,  12,  27,   6,  86,  41,  38], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0435, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0476, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15112924575805664  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15112924575805664  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15136480331420898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15136480331420898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15865468978881836  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15818452835083008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0133, -0.0078,  0.0109,  ..., -0.0134,  0.0040,  0.0081],
        [ 0.0120, -0.0072,  0.0154,  ..., -0.0140,  0.0075,  0.0071],
        [ 0.0161, -0.0091,  0.0125,  ..., -0.0157,  0.0077,  0.0099],
        ...,
        [ 0.0177, -0.0109,  0.0119,  ..., -0.0153,  0.0076,  0.0097],
        [ 0.0158, -0.0097,  0.0139,  ..., -0.0153,  0.0054,  0.0093],
        [ 0.0147, -0.0096,  0.0140,  ..., -0.0132,  0.0072,  0.0082]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15181398391723633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15204954147338867  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15204954147338867  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15933942794799805  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15886926651000977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 52, 132,  26,  22, 124,  61, 120,   2,   4,  14, 110,  18,  84,  17,
         20], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0556,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0417],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0714],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15915203094482422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15915203094482422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15931224822998047  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15931224822998047  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1654806137084961  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16508007049560547  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0166, -0.0098,  0.0112,  ..., -0.0157,  0.0074,  0.0083],
        [ 0.0177, -0.0078,  0.0115,  ..., -0.0148,  0.0111,  0.0089],
        [ 0.0133, -0.0076,  0.0156,  ..., -0.0149,  0.0084,  0.0079],
        ...,
        [ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097],
        [ 0.0172, -0.0127,  0.0149,  ..., -0.0146,  0.0076,  0.0111],
        [ 0.0173, -0.0085,  0.0114,  ..., -0.0142,  0.0076,  0.0095]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15806245803833008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15806245803833008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15822267532348633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15822267532348633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439104080200195  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16399049758911133  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 99, 111,  75, 126,  43,  45,  91,  30, 119, 103,  51],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1642627716064453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1642627716064453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643810272216797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643810272216797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16979265213012695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16944026947021484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0157, -0.0077,  0.0152,  ..., -0.0141,  0.0081,  0.0104],
        [ 0.0165, -0.0096,  0.0141,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        ...,
        [ 0.0175, -0.0080,  0.0108,  ..., -0.0149,  0.0108,  0.0109],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636514663696289  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636514663696289  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16906309127807617  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16871070861816406  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 39,  24, 121,  69], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16880130767822266  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16880130767822266  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16884422302246094  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16884422302246094  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17113971710205078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.170989990234375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16585016250610352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16585016250610352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1658930778503418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1658930778503418  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16803884506225586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([ 36, 139, 102], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16814565658569336  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16814565658569336  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16817808151245117  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16817808151245117  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17014312744140625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1700148582458496  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678314208984375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678638458251953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678638458251953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698288917541504  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16970062255859375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 74, 133,  33,  48], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698770523071289  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699199676513672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699199676513672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17285919189453125  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1726665496826172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1707921028137207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1707921028137207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17083501815795898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17083501815795898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17377424240112305  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17358160018920898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 94,  88, 109,  73,  65,  59, 118,  95,  89,  55], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0400, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0526,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17409420013427734  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17409420013427734  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420101165771484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17420101165771484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18231868743896484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18178462982177734  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0201, -0.0100,  0.0131,  ..., -0.0146,  0.0095,  0.0108],
        [ 0.0179, -0.0079,  0.0131,  ..., -0.0148,  0.0079,  0.0094],
        [ 0.0204, -0.0120,  0.0126,  ..., -0.0156,  0.0082,  0.0137],
        ...,
        [ 0.0200, -0.0090,  0.0128,  ..., -0.0156,  0.0092,  0.0118],
        [ 0.0190, -0.0074,  0.0110,  ..., -0.0150,  0.0076,  0.0114],
        [ 0.0166, -0.0101,  0.0132,  ..., -0.0160,  0.0094,  0.0129]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17896318435668945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17896318435668945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17906999588012695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17906999588012695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18718767166137695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18665361404418945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17667913436889648  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668676376342773  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766829490661621  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 6 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12837696075439453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.002000868320465088
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283702850341797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13150930404663086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13151073455810547  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------input nodes number: 588
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283869743347168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([115,  58,  23,   7,  63,  98,  19,  34,  57,  31, 134,  28, 127,  62,
         66, 106,   3,  96,  50, 136], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0435, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1316375732421875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1316375732421875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1318511962890625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1318511962890625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1336669921875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335601806640625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0073, -0.0047,  0.0071,  ..., -0.0080,  0.0025,  0.0040],
        [ 0.0058, -0.0045,  0.0087,  ..., -0.0075,  0.0020,  0.0028],
        [ 0.0068, -0.0043,  0.0078,  ..., -0.0079,  0.0020,  0.0031],
        ...,
        [ 0.0068, -0.0055,  0.0080,  ..., -0.0085,  0.0026,  0.0034],
        [ 0.0074, -0.0049,  0.0074,  ..., -0.0073,  0.0019,  0.0028],
        [ 0.0035, -0.0021,  0.0065,  ..., -0.0059,  0.0019,  0.0004]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.133453369140625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.133453369140625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1336669921875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1336669921875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1354827880859375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1353759765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([ 79,  42,  10, 100,  92,  83, 129,  82,  97,  54,  29,  72,  77, 116,
         47, 131,  13,  46,  11,  21, 117,  49,   9,  70, 125],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13553619384765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13553619384765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13580322265625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13580322265625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14007568359375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13980865478515625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0123, -0.0073,  0.0095,  ..., -0.0114,  0.0034,  0.0041],
        [ 0.0102, -0.0074,  0.0116,  ..., -0.0096,  0.0042,  0.0067],
        [ 0.0091, -0.0085,  0.0103,  ..., -0.0100,  0.0040,  0.0070],
        ...,
        [ 0.0119, -0.0084,  0.0114,  ..., -0.0114,  0.0045,  0.0045],
        [ 0.0105, -0.0081,  0.0087,  ..., -0.0101,  0.0057,  0.0067],
        [ 0.0117, -0.0062,  0.0124,  ..., -0.0114,  0.0047,  0.0056]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13785934448242188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13785934448242188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13812637329101562  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13812637329101562  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14239883422851562  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14213180541992188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([101, 138,  60,  37, 108,  78,  76,  44,  87,  85,   8,  80, 114, 113,
         53, 130, 135,  67,  71,   5,  64,  68,   0,  40,   1,  35],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14241504669189453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14241504669189453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14269351959228516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14269351959228516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14922380447387695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14880704879760742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0127, -0.0093,  0.0135,  ..., -0.0127,  0.0056,  0.0066],
        [ 0.0131, -0.0081,  0.0115,  ..., -0.0131,  0.0062,  0.0088],
        [ 0.0143, -0.0066,  0.0132,  ..., -0.0132,  0.0064,  0.0081],
        ...,
        [ 0.0146, -0.0088,  0.0108,  ..., -0.0131,  0.0071,  0.0071],
        [ 0.0148, -0.0079,  0.0121,  ..., -0.0127,  0.0067,  0.0071],
        [ 0.0146, -0.0072,  0.0126,  ..., -0.0139,  0.0058,  0.0078]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14452886581420898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14452886581420898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1448073387145996  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1448073387145996  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1513376235961914  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15092086791992188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 25, 123,  32,  27, 112,   6,  15, 122, 107,  86, 105,  41,  56,  12,
         93, 128, 137,  90,  38,  16,  81, 104], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15125179290771484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15125179290771484  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1514873504638672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1514873504638672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15877723693847656  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15830707550048828  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0147, -0.0109,  0.0122,  ..., -0.0139,  0.0073,  0.0081],
        [ 0.0143, -0.0068,  0.0148,  ..., -0.0127,  0.0067,  0.0089],
        [ 0.0154, -0.0091,  0.0117,  ..., -0.0129,  0.0084,  0.0093],
        ...,
        [ 0.0148, -0.0078,  0.0138,  ..., -0.0147,  0.0075,  0.0071],
        [ 0.0165, -0.0095,  0.0124,  ..., -0.0130,  0.0077,  0.0122],
        [ 0.0154, -0.0101,  0.0125,  ..., -0.0139,  0.0061,  0.0072]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15193653106689453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15193653106689453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15217208862304688  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15217208862304688  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15946197509765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15899181365966797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 61, 110,   4,  52,  14,  22, 124,  17,  84,  20, 132,  18, 120,   2,
         26], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0625, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15927457809448242  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15927457809448242  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15943479537963867  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15943479537963867  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1656031608581543  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16520261764526367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0167, -0.0089,  0.0122,  ..., -0.0152,  0.0077,  0.0088],
        [ 0.0169, -0.0088,  0.0134,  ..., -0.0152,  0.0069,  0.0093],
        [ 0.0165, -0.0088,  0.0110,  ..., -0.0136,  0.0100,  0.0117],
        ...,
        [ 0.0167, -0.0095,  0.0129,  ..., -0.0148,  0.0081,  0.0117],
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106],
        [ 0.0133, -0.0076,  0.0156,  ..., -0.0149,  0.0084,  0.0079]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15818500518798828  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15818500518798828  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15834522247314453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15834522247314453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16451358795166016  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16411304473876953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 45,  30,  75, 111, 103,  91,  43,  99,  51, 126, 119],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16438531875610352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16438531875610352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1645035743713379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1645035743713379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16991519927978516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16956281661987305  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0184, -0.0101,  0.0115,  ..., -0.0130,  0.0085,  0.0099],
        [ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        ...,
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094],
        [ 0.0153, -0.0105,  0.0138,  ..., -0.0140,  0.0084,  0.0109],
        [ 0.0175, -0.0080,  0.0108,  ..., -0.0149,  0.0108,  0.0109]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16365575790405273  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16365575790405273  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1637740135192871  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1637740135192871  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16918563842773438  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16883325576782227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 39,  24, 121,  69], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16892385482788086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16892385482788086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16896677017211914  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16896677017211914  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17126226425170898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1711125373840332  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16597270965576172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16597270965576172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.166015625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.166015625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16831111907958984  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16816139221191406  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([139, 102,  36], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16826820373535156  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16826820373535156  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16830062866210938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16830062866210938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17026567459106445  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1701374053955078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1679539680480957  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1679539680480957  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16798639297485352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16798639297485352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699514389038086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16982316970825195  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([133,  48,  33,  74], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699995994567871  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699995994567871  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1700425148010254  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1700425148010254  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17298173904418945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1727890968322754  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1709146499633789  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1709146499633789  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1709575653076172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1709575653076172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17389678955078125  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1737041473388672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 55,  73,  65, 109,  88, 118,  95,  59,  89,  94], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0400, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0526,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17421674728393555  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17421674728393555  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17432355880737305  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17432355880737305  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18244123458862305  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18190717697143555  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0171, -0.0094,  0.0127,  ..., -0.0153,  0.0095,  0.0115],
        [ 0.0191, -0.0083,  0.0140,  ..., -0.0147,  0.0095,  0.0103],
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115],
        ...,
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0190, -0.0074,  0.0110,  ..., -0.0150,  0.0076,  0.0114],
        [ 0.0197, -0.0122,  0.0145,  ..., -0.0154,  0.0103,  0.0110]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908573150634766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908573150634766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17919254302978516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17919254302978516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18731021881103516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18677616119384766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668962478637695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766972541809082  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9463, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 7 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.128387451171875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.128387451171875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0019843843248155382
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12838077545166016  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152694702148438  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------input nodes number: 589
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839269638061523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 31,  96,  19,  23, 115,   3,  50,  98,  28,  58, 127, 134,  57,  62,
        106,  66,  63,  34, 136,   7], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315312385559082  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1315312385559082  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317448616027832  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1317448616027832  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335606575012207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1334538459777832  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0074, -0.0045,  0.0061,  ..., -0.0080,  0.0018,  0.0034],
        [ 0.0068, -0.0055,  0.0080,  ..., -0.0085,  0.0026,  0.0034],
        [ 0.0063, -0.0050,  0.0095,  ..., -0.0073,  0.0041,  0.0034],
        ...,
        [ 0.0066, -0.0052,  0.0078,  ..., -0.0070,  0.0015,  0.0031],
        [ 0.0035, -0.0021,  0.0065,  ..., -0.0059,  0.0019,  0.0004],
        [ 0.0047, -0.0040,  0.0125,  ..., -0.0120,  0.0037,  0.0046]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333470344543457  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1333470344543457  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335606575012207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1335606575012207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1353764533996582  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1352696418762207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([  9,  54,  72,  92, 116,  97, 131,  82,  21,  13,  47, 117,  46,  49,
         70, 100,  79,  42,  83, 125,  29,  10,  11, 129,  77],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542985916137695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542985916137695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356968879699707  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1356968879699707  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1399693489074707  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13970232009887695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0119, -0.0084,  0.0114,  ..., -0.0114,  0.0045,  0.0045],
        [ 0.0119, -0.0059,  0.0111,  ..., -0.0120,  0.0041,  0.0056],
        [ 0.0114, -0.0076,  0.0114,  ..., -0.0104,  0.0028,  0.0055],
        ...,
        [ 0.0114, -0.0060,  0.0120,  ..., -0.0094,  0.0067,  0.0062],
        [ 0.0111, -0.0093,  0.0103,  ..., -0.0104,  0.0038,  0.0058],
        [ 0.0116, -0.0068,  0.0120,  ..., -0.0125,  0.0043,  0.0068]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13775300979614258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13775300979614258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13802003860473633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13802003860473633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14229249954223633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14202547073364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([ 85, 108,  60, 114,  35,  71,  40, 113,  67,   0,   8,  44, 101, 130,
          1,  68,  64,  53,  78, 135,  76,   5,  37, 138,  87,  80],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14230871200561523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14230871200561523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258718490600586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258718490600586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14911746978759766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14870071411132812  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0145, -0.0064,  0.0125,  ..., -0.0125,  0.0063,  0.0090],
        [ 0.0111, -0.0070,  0.0151,  ..., -0.0148,  0.0085,  0.0115],
        [ 0.0143, -0.0066,  0.0132,  ..., -0.0132,  0.0064,  0.0081],
        ...,
        [ 0.0131, -0.0081,  0.0115,  ..., -0.0131,  0.0062,  0.0088],
        [ 0.0132, -0.0075,  0.0121,  ..., -0.0138,  0.0058,  0.0063],
        [ 0.0152, -0.0065,  0.0121,  ..., -0.0137,  0.0039,  0.0088]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1444225311279297  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1444225311279297  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1447010040283203  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1447010040283203  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1512312889099121  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15081453323364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 12,   6,  25,  38, 107, 112, 105,  41, 128, 123, 122,  86,  27,  93,
         81,  15,  56,  90,  16, 137, 104,  32], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0417, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15114545822143555  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15114545822143555  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1513810157775879  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1513810157775879  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15867090225219727  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15820074081420898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0173, -0.0074,  0.0162,  ..., -0.0128,  0.0094,  0.0069],
        [ 0.0147, -0.0095,  0.0138,  ..., -0.0127,  0.0080,  0.0095],
        [ 0.0147, -0.0109,  0.0122,  ..., -0.0139,  0.0073,  0.0081],
        ...,
        [ 0.0151, -0.0104,  0.0139,  ..., -0.0139,  0.0057,  0.0107],
        [ 0.0154, -0.0101,  0.0125,  ..., -0.0139,  0.0061,  0.0072],
        [ 0.0154, -0.0091,  0.0117,  ..., -0.0129,  0.0084,  0.0093]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15183019638061523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15183019638061523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206575393676758  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206575393676758  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15935564041137695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15888547897338867  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 61,  22,  84,  14,  52,  20,   4, 132,  17,   2,  18,  26, 110, 120,
        124], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0400],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15916824340820312  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15916824340820312  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932846069335938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932846069335938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.165496826171875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16509628295898438  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0167, -0.0089,  0.0122,  ..., -0.0152,  0.0077,  0.0088],
        [ 0.0195, -0.0130,  0.0153,  ..., -0.0160,  0.0093,  0.0111],
        [ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097],
        ...,
        [ 0.0169, -0.0088,  0.0134,  ..., -0.0152,  0.0069,  0.0093],
        [ 0.0167, -0.0095,  0.0129,  ..., -0.0148,  0.0081,  0.0117],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807867050170898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807867050170898  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15823888778686523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15823888778686523  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16440725326538086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16400671005249023  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 43,  91,  51, 111,  30,  75,  99, 126,  45, 119, 103],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0476, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427898406982422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427898406982422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643972396850586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1643972396850586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16980886459350586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16945648193359375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0194, -0.0066,  0.0151,  ..., -0.0130,  0.0101,  0.0096],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100],
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094],
        ...,
        [ 0.0173, -0.0087,  0.0133,  ..., -0.0172,  0.0101,  0.0097],
        [ 0.0175, -0.0080,  0.0108,  ..., -0.0149,  0.0108,  0.0109],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16354942321777344  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16354942321777344  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636676788330078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1636676788330078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16907930374145508  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16872692108154297  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([121,  24,  69,  39], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881752014160156  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881752014160156  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16886043548583984  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16886043548583984  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1711559295654297  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1710062026977539  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586637496948242  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586637496948242  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1659092903137207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1659092903137207  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16820478439331055  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16805505752563477  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([ 36, 139, 102], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16816186904907227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16816186904907227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16819429397583008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16819429397583008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17015933990478516  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17003107070922852  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678476333618164  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1678476333618164  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16788005828857422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16788005828857422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698451042175293  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16971683502197266  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([133,  74,  33,  48], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698932647705078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1698932647705078  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699361801147461  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1699361801147461  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17287540435791016  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1726827621459961  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1708083152770996  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1708083152770996  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1708512306213379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1708512306213379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17379045486450195  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1735978126525879  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 95, 118,  94, 109,  55,  89,  73,  65,  59,  88], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0556,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0400, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17411041259765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17411041259765625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17421722412109375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17421722412109375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18233489990234375  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18180084228515625  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0189, -0.0092,  0.0093,  ..., -0.0143,  0.0084,  0.0103],
        [ 0.0180, -0.0105,  0.0134,  ..., -0.0141,  0.0070,  0.0135],
        [ 0.0194, -0.0122,  0.0146,  ..., -0.0162,  0.0091,  0.0113],
        ...,
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115],
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0180, -0.0097,  0.0115,  ..., -0.0171,  0.0083,  0.0116]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897939682006836  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897939682006836  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908620834350586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908620834350586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18720388412475586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18666982650756836  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766953468322754  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669916152954102  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669916152954102  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17670297622680664  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669916152954102  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 8 |
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839317321777344  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.12839317321777344  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0019722223281860352
----------------------------------------before batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283864974975586  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152694702148438  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------input nodes number: 588
----------------output nodes number: 140
----------------edges number: 565
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1283869743347168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  1
orig_nid_bkt
tensor([ 62, 115,  58,  28,  34, 136,  19, 127,   7, 106, 134,  96,  98,  63,
         23,  66,  31,   3,  50,  57], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13152551651000977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13173913955688477  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13173913955688477  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13344812393188477  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
{'neigh': tensor([[ 0.0085, -0.0053,  0.0087,  ..., -0.0072,  0.0025,  0.0040],
        [ 0.0073, -0.0047,  0.0071,  ..., -0.0080,  0.0025,  0.0040],
        [ 0.0058, -0.0045,  0.0087,  ..., -0.0075,  0.0020,  0.0028],
        ...,
        [ 0.0064, -0.0042,  0.0088,  ..., -0.0076,  0.0016,  0.0028],
        [ 0.0074, -0.0049,  0.0074,  ..., -0.0073,  0.0019,  0.0028],
        [ 0.0060, -0.0040,  0.0076,  ..., -0.0066,  0.0015,  0.0028]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([20, 1, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13334131240844727  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13334131240844727  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 20, 1433]), torch.Size([1, 20, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13537073135375977  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13526391983032227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 20, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  2
orig_nid_bkt
tensor([116,  72,  82, 129,   9,  83,  21,  11,  54,  10,  29,  77, 125,  49,
         47, 131,  79,  92,  70,  13, 100,  42, 117,  97,  46],
       device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        ...,

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542413711547852  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13542413711547852  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13569116592407227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13569116592407227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13996362686157227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13969659805297852  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
{'neigh': tensor([[ 0.0097, -0.0077,  0.0098,  ..., -0.0123,  0.0043,  0.0054],
        [ 0.0114, -0.0076,  0.0114,  ..., -0.0104,  0.0028,  0.0055],
        [ 0.0123, -0.0059,  0.0112,  ..., -0.0111,  0.0064,  0.0050],
        ...,
        [ 0.0113, -0.0069,  0.0135,  ..., -0.0125,  0.0041,  0.0039],
        [ 0.0116, -0.0072,  0.0117,  ..., -0.0105,  0.0051,  0.0039],
        [ 0.0114, -0.0053,  0.0117,  ..., -0.0125,  0.0034,  0.0066]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([25, 2, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13774728775024414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.13774728775024414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 25, 1433]), torch.Size([1, 25, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1380143165588379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1380143165588379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1422867774963379  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14201974868774414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 25, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  3
orig_nid_bkt
tensor([  1,  76, 138,   5, 135,   8, 108,  35,  78,  67,  37,  44,  80,  40,
         53,  68, 101, 130,  60,  85,  64,  87,   0,  71, 113, 114],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0476,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0714, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1423029899597168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1423029899597168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258146286010742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14258146286010742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14911174774169922  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1486949920654297  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
{'neigh': tensor([[ 0.0148, -0.0079,  0.0121,  ..., -0.0127,  0.0067,  0.0071],
        [ 0.0136, -0.0083,  0.0133,  ..., -0.0136,  0.0062,  0.0067],
        [ 0.0131, -0.0081,  0.0115,  ..., -0.0131,  0.0062,  0.0088],
        ...,
        [ 0.0139, -0.0088,  0.0134,  ..., -0.0129,  0.0053,  0.0085],
        [ 0.0116, -0.0056,  0.0150,  ..., -0.0113,  0.0057,  0.0080],
        [ 0.0119, -0.0096,  0.0109,  ..., -0.0134,  0.0063,  0.0077]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([26, 3, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14441680908203125  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14441680908203125  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 26, 1433]), torch.Size([1, 26, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14469528198242188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.14469528198242188  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15122556686401367  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15080881118774414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 26, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  4
orig_nid_bkt
tensor([ 81, 137, 107,  25,   6,  90, 122,  41,  16,  86, 123,  93,  56,  27,
        105,  38,  12, 112,  15,  32, 104, 128], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0500, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0435, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0476, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0455,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1511397361755371  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1511397361755371  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15137529373168945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15137529373168945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15866518020629883  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15819501876831055  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
{'neigh': tensor([[ 0.0165, -0.0095,  0.0124,  ..., -0.0130,  0.0077,  0.0122],
        [ 0.0151, -0.0104,  0.0139,  ..., -0.0139,  0.0057,  0.0107],
        [ 0.0161, -0.0091,  0.0125,  ..., -0.0157,  0.0077,  0.0099],
        ...,
        [ 0.0154, -0.0091,  0.0117,  ..., -0.0129,  0.0084,  0.0093],
        [ 0.0154, -0.0101,  0.0125,  ..., -0.0139,  0.0061,  0.0072],
        [ 0.0146, -0.0084,  0.0135,  ..., -0.0128,  0.0072,  0.0083]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([22, 4, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1518244743347168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1518244743347168  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 22, 1433]), torch.Size([1, 22, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206003189086914  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15206003189086914  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15934991836547852  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15887975692749023  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 22, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  5
orig_nid_bkt
tensor([ 84,   2, 124,  61,  14, 132,  20,  22,  52, 120,  26,  18, 110,  17,
          4], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0417],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0714],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0625, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1591625213623047  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1591625213623047  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932273864746094  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15932273864746094  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16549110412597656  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16509056091308594  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
{'neigh': tensor([[ 0.0150, -0.0082,  0.0134,  ..., -0.0127,  0.0080,  0.0097],
        [ 0.0180, -0.0084,  0.0127,  ..., -0.0142,  0.0074,  0.0106],
        [ 0.0173, -0.0110,  0.0129,  ..., -0.0142,  0.0082,  0.0073],
        ...,
        [ 0.0169, -0.0088,  0.0134,  ..., -0.0152,  0.0069,  0.0093],
        [ 0.0172, -0.0127,  0.0149,  ..., -0.0146,  0.0076,  0.0111],
        [ 0.0165, -0.0088,  0.0110,  ..., -0.0136,  0.0100,  0.0117]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([15, 5, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807294845581055  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.15807294845581055  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 15, 1433]), torch.Size([1, 15, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1582331657409668  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1582331657409668  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16440153121948242  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1640009880065918  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 15, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  6
orig_nid_bkt
tensor([ 75,  51, 111,  45, 119,  30, 126,  99,  43, 103,  91],
       device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0455, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0500, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427326202392578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16427326202392578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439151763916016  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16439151763916016  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16980314254760742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1694507598876953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
{'neigh': tensor([[ 0.0160, -0.0095,  0.0134,  ..., -0.0136,  0.0060,  0.0096],
        [ 0.0176, -0.0123,  0.0114,  ..., -0.0149,  0.0086,  0.0094],
        [ 0.0165, -0.0096,  0.0141,  ..., -0.0149,  0.0081,  0.0112],
        ...,
        [ 0.0194, -0.0066,  0.0151,  ..., -0.0130,  0.0101,  0.0096],
        [ 0.0157, -0.0081,  0.0123,  ..., -0.0149,  0.0089,  0.0133],
        [ 0.0158, -0.0104,  0.0135,  ..., -0.0166,  0.0084,  0.0100]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([11, 6, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.163543701171875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.163543701171875  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 11, 1433]), torch.Size([1, 11, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16366195678710938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16366195678710938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16907358169555664  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16872119903564453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 11, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  7
orig_nid_bkt
tensor([ 39,  69,  24, 121], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0500,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0588],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0500]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881179809570312  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16881179809570312  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688547134399414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1688547134399414  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17115020751953125  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17100048065185547  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0199, -0.0109,  0.0135,  ..., -0.0150,  0.0088,  0.0096],
        [ 0.0179, -0.0086,  0.0116,  ..., -0.0149,  0.0095,  0.0104],
        [ 0.0163, -0.0097,  0.0136,  ..., -0.0147,  0.0089,  0.0122],
        [ 0.0191, -0.0099,  0.0151,  ..., -0.0164,  0.0060,  0.0111]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 7, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586065292358398  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16586065292358398  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16590356826782227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16590356826782227  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1681990623474121  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16804933547973633  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  8
orig_nid_bkt
tensor([139,  36, 102], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0476],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0667, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0417,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16815614700317383  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16815614700317383  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16818857192993164  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17015361785888672  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17002534866333008  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
{'neigh': tensor([[ 0.0169, -0.0094,  0.0143,  ..., -0.0149,  0.0077,  0.0119],
        [ 0.0167, -0.0098,  0.0127,  ..., -0.0149,  0.0081,  0.0112],
        [ 0.0169, -0.0104,  0.0114,  ..., -0.0139,  0.0104,  0.0104]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([3, 8, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16784191131591797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16784191131591797  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 3, 1433]), torch.Size([1, 3, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16787433624267578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16787433624267578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16983938217163086  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16971111297607422  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 3, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  9
orig_nid_bkt
tensor([ 74, 133,  48,  33], device='cuda:0')
maildata
{'m': tensor([[[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]],

        [[0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.]]], device='cuda:0')}
func(nbatch)
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16988754272460938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16988754272460938  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16993045806884766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.16993045806884766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17286968231201172  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17267704010009766  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
{'neigh': tensor([[ 0.0192, -0.0097,  0.0101,  ..., -0.0154,  0.0097,  0.0114],
        [ 0.0216, -0.0125,  0.0133,  ..., -0.0144,  0.0076,  0.0110],
        [ 0.0166, -0.0102,  0.0121,  ..., -0.0156,  0.0098,  0.0106],
        [ 0.0184, -0.0100,  0.0153,  ..., -0.0155,  0.0088,  0.0115]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([4, 9, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17080259323120117  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17080259323120117  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 4, 1433]), torch.Size([1, 4, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17084550857543945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17084550857543945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17378473281860352  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17359209060668945  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 4, 1433])
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
degree  10
orig_nid_bkt
tensor([ 95,  59,  94,  73,  89,  55,  88,  65, 109, 118], device='cuda:0')
maildata
{'m': tensor([[[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0455, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        ...,

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0476, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],

        [[0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         ...,
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
         [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]]],
       device='cuda:0')}
func(nbatch)
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1741046905517578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1741046905517578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1742115020751953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1742115020751953  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1823291778564453  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1817951202392578  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
{'neigh': tensor([[ 0.0182, -0.0093,  0.0124,  ..., -0.0157,  0.0067,  0.0126],
        [ 0.0183, -0.0087,  0.0109,  ..., -0.0151,  0.0081,  0.0112],
        [ 0.0186, -0.0132,  0.0131,  ..., -0.0165,  0.0081,  0.0108],
        ...,
        [ 0.0178, -0.0083,  0.0124,  ..., -0.0149,  0.0093,  0.0115],
        [ 0.0179, -0.0083,  0.0144,  ..., -0.0151,  0.0094,  0.0117],
        [ 0.0199, -0.0090,  0.0109,  ..., -0.0154,  0.0082,  0.0131]],
       device='cuda:0', grad_fn=<SqueezeBackward1>)}
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
m.shape torch.Size([10, 10, 1433])
----------------------------------------1
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897367477416992  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17897367477416992  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

 h.shape torch.Size([1, 10, 1433]), torch.Size([1, 10, 1433])
----------------------------------------3
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908048629760742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------before  _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17908048629760742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after _VF.lstm
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18719816207885742  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.18666410446166992  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

rst.shape  torch.Size([1, 10, 1433])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17668962478637695  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

h_self size  torch.Size([140, 1433])
----------------------------------------before rst
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.1766972541809082  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0870361328125 GB
    Memory Allocated: 0.17669343948364258  GigaBytes
Max Memory Allocated: 0.29976701736450195  GigaBytes

torch.Size([140, 7])
loss :  tensor(1.9464, device='cuda:0', grad_fn=<NllLossBackward>)
 Run 0| Epoch 9 |
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  16459438
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([7, 1433])
layers.0.fc_neigh.weight, torch.Size([7, 1433])
----------------------------------------
un-trainable parameters
