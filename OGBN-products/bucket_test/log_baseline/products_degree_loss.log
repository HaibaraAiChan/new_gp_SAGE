main start at this time 1669529522.076186
-----------------------------------------before load data 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.2530517578125 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 1.4132080078125 GB
    Memory Allocated: 0.3182096481323242  GigaBytes
Max Memory Allocated: 0.3182096481323242  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.2979736328125 GB
    Memory Allocated: 0.4614381790161133  GigaBytes
Max Memory Allocated: 1.1946616172790527  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0038)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3057861328125 GB
    Memory Allocated: 0.3544621467590332  GigaBytes
Max Memory Allocated: 1.1946616172790527  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3057861328125 GB
    Memory Allocated: 0.3544621467590332  GigaBytes
Max Memory Allocated: 1.1946616172790527  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3819580078125 GB
    Memory Allocated: 0.4648299217224121  GigaBytes
Max Memory Allocated: 1.2310247421264648  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0057)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3819580078125 GB
    Memory Allocated: 0.35447120666503906  GigaBytes
Max Memory Allocated: 1.2310247421264648  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3819580078125 GB
    Memory Allocated: 0.35447168350219727  GigaBytes
Max Memory Allocated: 1.2310247421264648  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3858642578125 GB
    Memory Allocated: 0.468813419342041  GigaBytes
Max Memory Allocated: 1.2350683212280273  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0083)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3858642578125 GB
    Memory Allocated: 0.35449934005737305  GigaBytes
Max Memory Allocated: 1.2350683212280273  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3858642578125 GB
    Memory Allocated: 0.35449981689453125  GigaBytes
Max Memory Allocated: 1.2350683212280273  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3917236328125 GB
    Memory Allocated: 0.4728560447692871  GigaBytes
Max Memory Allocated: 1.2391443252563477  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0105)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3917236328125 GB
    Memory Allocated: 0.35451507568359375  GigaBytes
Max Memory Allocated: 1.2391443252563477  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3917236328125 GB
    Memory Allocated: 0.35451507568359375  GigaBytes
Max Memory Allocated: 1.2391443252563477  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3956298828125 GB
    Memory Allocated: 0.4751005172729492  GigaBytes
Max Memory Allocated: 1.2413835525512695  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0112)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3956298828125 GB
    Memory Allocated: 0.35451269149780273  GigaBytes
Max Memory Allocated: 1.2413835525512695  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3956298828125 GB
    Memory Allocated: 0.35451316833496094  GigaBytes
Max Memory Allocated: 1.2413835525512695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3975830078125 GB
    Memory Allocated: 0.48122358322143555  GigaBytes
Max Memory Allocated: 1.2475485801696777  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0128)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.3975830078125 GB
    Memory Allocated: 0.35453224182128906  GigaBytes
Max Memory Allocated: 1.2475485801696777  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.3975830078125 GB
    Memory Allocated: 0.35453271865844727  GigaBytes
Max Memory Allocated: 1.2475485801696777  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4034423828125 GB
    Memory Allocated: 0.4885411262512207  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0158)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.4053955078125 GB
    Memory Allocated: 0.3545522689819336  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4053955078125 GB
    Memory Allocated: 0.3545513153076172  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4053955078125 GB
    Memory Allocated: 0.48566198348999023  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0127)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.4053955078125 GB
    Memory Allocated: 0.3545246124267578  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4053955078125 GB
    Memory Allocated: 0.354525089263916  GigaBytes
Max Memory Allocated: 1.2549080848693848  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4073486328125 GB
    Memory Allocated: 0.4917874336242676  GigaBytes
Max Memory Allocated: 1.2581219673156738  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0141)
----------------------------------------- after loss backward 
 Nvidia-smi: 2.4073486328125 GB
    Memory Allocated: 0.3545370101928711  GigaBytes
Max Memory Allocated: 1.2581219673156738  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 2.4151611328125 GB
    Memory Allocated: 0.3552522659301758  GigaBytes
Max Memory Allocated: 1.2581219673156738  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0557861328125 GB
    Memory Allocated: 11.456252574920654  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.6964)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0557861328125 GB
    Memory Allocated: 0.3903059959411621  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.7912)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.0557861328125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes


 Run 0| Epoch 0 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3884425163269043  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.49725341796875  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0038)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3547801971435547  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3547801971435547  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4651479721069336  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0056)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35478925704956055  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35478973388671875  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4691314697265625  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0082)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35481739044189453  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35481786727905273  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4731740951538086  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0104)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35483312606811523  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35483312606811523  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4754185676574707  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0111)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3548307418823242  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3548312187194824  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.48154163360595703  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0126)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35485029220581055  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35485076904296875  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4888591766357422  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0156)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3548703193664551  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.35486936569213867  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.4859800338745117  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0125)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3548426628112793  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.3548431396484375  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0479736328125 GB
    Memory Allocated: 0.49210548400878906  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0139)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.0499267578125 GB
    Memory Allocated: 0.3548550605773926  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.0577392578125 GB
    Memory Allocated: 0.35557031631469727  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.456570625305176  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.6336)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3906240463256836  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.7273)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3906240463256836  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes


 Run 0| Epoch 1 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.38851404190063477  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49732494354248047  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0038)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35485172271728516  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35485172271728516  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46521949768066406  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0056)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354860782623291  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548612594604492  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46920299530029297  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0082)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354888916015625  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548893928527832  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47324562072753906  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0103)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3549046516418457  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3549046516418457  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47549009323120117  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0110)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3549022674560547  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3549027442932129  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4816131591796875  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0124)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354921817779541  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3549222946166992  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48893070220947266  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0154)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35494184494018555  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35494089126586914  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4860515594482422  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0123)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491418838500977  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491466522216797  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49217700958251953  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0137)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35492658615112305  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.35564184188842773  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.456642150878906  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.5704)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913893699645996  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.6630)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913893699645996  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes


 Run 0| Epoch 2 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.389493465423584  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4983043670654297  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0037)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46550512313842773  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0056)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551464080810547  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551468849182129  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46948862075805664  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0081)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551750183105469  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47353124618530273  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0102)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47577571868896484  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0108)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518789291381836  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518836975097656  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48189878463745117  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0123)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552074432373047  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552079200744629  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48921632766723633  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0152)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552274703979492  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552265167236328  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48633718490600586  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0121)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35519981384277344  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35520029067993164  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4924626350402832  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0135)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3559274673461914  GigaBytes
Max Memory Allocated: 12.867815017700195  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.45692777633667  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.5080)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.5995)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 3 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.38848352432250977  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49729442596435547  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0037)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35482120513916016  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35482120513916016  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46518898010253906  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0055)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354830265045166  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548307418823242  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46917247772216797  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0080)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548583984375  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548588752746582  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47321510314941406  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0101)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548741340637207  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548741340637207  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47545957565307617  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0107)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548717498779297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548722267150879  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4815826416015625  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0121)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354891300201416  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548917770385742  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48890018463134766  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0150)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491132736206055  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491037368774414  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4860210418701172  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0120)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35488367080688477  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35488414764404297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49214649200439453  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0133)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35489606857299805  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.35561132431030273  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.457141876220703  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.4448)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913588523864746  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.5352)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913588523864746  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 4 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.389493465423584  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4983043670654297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0037)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46550512313842773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0055)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551464080810547  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551468849182129  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46948862075805664  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0079)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551750183105469  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47353124618530273  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0100)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47577571868896484  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0105)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518789291381836  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518836975097656  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48189878463745117  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0119)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552074432373047  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552079200744629  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48921632766723633  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0148)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552274703979492  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552265167236328  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48633718490600586  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0118)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35519981384277344  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35520029067993164  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4924626350402832  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0132)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3559274673461914  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.45692777633667  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.3813)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.4706)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 5 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.38835906982421875  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49716997146606445  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0037)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35469675064086914  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35469675064086914  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46506452560424805  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0054)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354705810546875  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547062873840332  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46904802322387695  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0079)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354733943939209  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547344207763672  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47309064865112305  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0098)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547496795654297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547496795654297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47533512115478516  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0104)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35474729537963867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547477722167969  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4814581871032715  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0118)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354766845703125  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547673225402832  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48877573013305664  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0147)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35478687286376953  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3547859191894531  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48589658737182617  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0116)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35475921630859375  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35475969314575195  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4920220375061035  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0130)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35477161407470703  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3554868698120117  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.457017421722412  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.3168)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3912343978881836  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.4050)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3912343978881836  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 6 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.389493465423584  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4983043670654297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0036)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46550512313842773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0054)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551464080810547  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551468849182129  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46948862075805664  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0078)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551750183105469  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47353124618530273  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0097)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47577571868896484  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0102)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518789291381836  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518836975097656  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48189878463745117  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0116)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552074432373047  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552079200744629  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48921632766723633  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0145)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552274703979492  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552265167236328  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48633718490600586  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0114)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35519981384277344  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35520029067993164  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4924626350402832  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0128)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3559274673461914  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.45692777633667  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.2510)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.3380)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 7 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3884854316711426  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4972963333129883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0036)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35482311248779297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35482311248779297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4651908874511719  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0053)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35483217239379883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35483264923095703  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4691743850708008  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0077)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548603057861328  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.354860782623291  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4732170104980469  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0096)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548760414123535  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548760414123535  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.475461483001709  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0101)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548736572265625  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548741340637207  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4815845489501953  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0114)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35489320755004883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35489368438720703  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48890209197998047  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0143)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491323471069336  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35491228103637695  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48602294921875  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0113)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548855781555176  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3548860549926758  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.49214839935302734  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0126)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35489797592163086  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.35561323165893555  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.457143783569336  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.1842)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913607597351074  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.2701)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3913607597351074  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 8 |
{1: 173, 2: 221, 3: 374, 4: 456, 5: 445, 6: 550, 7: 655, 8: 512, 9: 576, 10: 192609}
----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.389493465423584  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4983043670654297  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 1 # of output: 173 ratio: 0.0008800891281012967 bucket_loss : tensor(0.0036)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35513734817504883  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46550512313842773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 2 # of output: 221 ratio: 0.001124275706996454 bucket_loss : tensor(0.0053)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551464080810547  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551468849182129  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.46948862075805664  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 3 # of output: 374 ratio: 0.0019026204272247686 bucket_loss : tensor(0.0076)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35517454147338867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551750183105469  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47353124618530273  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 4 # of output: 456 ratio: 0.0023197724995039962 bucket_loss : tensor(0.0095)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3551902770996094  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.47577571868896484  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 5 # of output: 445 ratio: 0.002263813075173856 bucket_loss : tensor(0.0100)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518789291381836  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35518836975097656  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48189878463745117  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 6 # of output: 550 ratio: 0.0027979712165070126 bucket_loss : tensor(0.0113)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552074432373047  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552079200744629  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48921632766723633  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 7 # of output: 655 ratio: 0.00333212935784017 bucket_loss : tensor(0.0141)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552274703979492  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552265167236328  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.48633718490600586  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 8 # of output: 512 ratio: 0.0026046568415483465 bucket_loss : tensor(0.0111)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35519981384277344  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.35520029067993164  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.4924626350402832  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 9 # of output: 576 ratio: 0.0029302389467418897 bucket_loss : tensor(0.0124)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7686767578125 GB
    Memory Allocated: 0.3552122116088867  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- before batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.3559274673461914  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs, deg.to(device)) 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 11.45692777633667  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

degree: 10 # of output: 192609 ratio: 0.9798444328003623 bucket_loss : tensor(4.1151)
----------------------------------------- after loss backward 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes

-------------------------------------------------------loss_sum  :  tensor(4.1999)
----------------------------------------- after optimizer.zero_grad() 
 Nvidia-smi: 14.7764892578125 GB
    Memory Allocated: 0.39098119735717773  GigaBytes
Max Memory Allocated: 12.867977142333984  GigaBytes


 Run 0| Epoch 9 |
