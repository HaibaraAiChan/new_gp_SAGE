main start at this time 1660335296.124073
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.31572628021240234
global_2_local spend time (sec) 0.3790132999420166

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.011 seconds
Metis partitioning: 13.279 seconds
Split the graph: 0.856 seconds
Construct subgraphs: 0.390 seconds
5992
5975
5963
6278
6305
6321
6327
6297
6325
6248
6095
6095
6327
6206
5965
5995
6093
5965
5963
6312
5985
6182
6181
5963
6233
6161
6290
5964
6301
5963
5992
6309
REG metis partition end ----................................
the time spent:  26.825592756271362
total k batches seeds list generation spend  27.35042667388916
after graph partition
graph partition algorithm spend time 27.810492515563965

partition_len_list
[44247, 51046, 60245, 63284, 44122, 64186, 60808, 65771, 52658, 55749, 68559, 59081, 55483, 48751, 52503, 45512, 53146, 46875, 50485, 70575, 61817, 53885, 66209, 65513, 68988, 60493, 67471, 54052, 58780, 58598, 64843, 76817]
REG selection method  spend 28.37114715576172
check_connections_block*********************************
time for parepare 1: 0.22267603874206543
local_output_nid generation: 0.002203702926635742
local_in_edges_tensor generation: 0.002507448196411133
mini_batch_src_global generation: 0.004775047302246094

&&&&&&&&&&&&&&& before remove duplicate length: 141715
r_  generation: 0.045560359954833984

local_output_nid generation: 0.0023915767669677734
local_in_edges_tensor generation: 0.0023801326751708984
mini_batch_src_global generation: 0.005451202392578125

&&&&&&&&&&&&&&& before remove duplicate length: 141966
r_  generation: 0.046427011489868164

local_output_nid generation: 0.0024836063385009766
local_in_edges_tensor generation: 0.0023119449615478516
mini_batch_src_global generation: 0.004435300827026367

&&&&&&&&&&&&&&& before remove duplicate length: 138737
r_  generation: 0.04706096649169922

local_output_nid generation: 0.002652406692504883
local_in_edges_tensor generation: 0.0024979114532470703
mini_batch_src_global generation: 0.004827022552490234

&&&&&&&&&&&&&&& before remove duplicate length: 151897
r_  generation: 0.0542445182800293

local_output_nid generation: 0.0026106834411621094
local_in_edges_tensor generation: 0.0025093555450439453
mini_batch_src_global generation: 0.004865407943725586

&&&&&&&&&&&&&&& before remove duplicate length: 154936
r_  generation: 0.053527116775512695

local_output_nid generation: 0.002650022506713867
local_in_edges_tensor generation: 0.0025529861450195312
mini_batch_src_global generation: 0.005215167999267578

&&&&&&&&&&&&&&& before remove duplicate length: 156563
r_  generation: 0.054807424545288086

local_output_nid generation: 0.002622365951538086
local_in_edges_tensor generation: 0.002512693405151367
mini_batch_src_global generation: 0.005539655685424805

&&&&&&&&&&&&&&& before remove duplicate length: 156474
r_  generation: 0.05613970756530762

local_output_nid generation: 0.0026695728302001953
local_in_edges_tensor generation: 0.0028204917907714844
mini_batch_src_global generation: 0.005227088928222656

&&&&&&&&&&&&&&& before remove duplicate length: 156895
r_  generation: 0.05753064155578613

local_output_nid generation: 0.002675294876098633
local_in_edges_tensor generation: 0.002563953399658203
mini_batch_src_global generation: 0.005442380905151367

&&&&&&&&&&&&&&& before remove duplicate length: 152358
r_  generation: 0.05343341827392578

local_output_nid generation: 0.002612590789794922
local_in_edges_tensor generation: 0.0024785995483398438
mini_batch_src_global generation: 0.0049970149993896484

&&&&&&&&&&&&&&& before remove duplicate length: 151078
r_  generation: 0.05361676216125488

local_output_nid generation: 0.002566099166870117
local_in_edges_tensor generation: 0.0023708343505859375
mini_batch_src_global generation: 0.005341053009033203

&&&&&&&&&&&&&&& before remove duplicate length: 146633
r_  generation: 0.05356907844543457

local_output_nid generation: 0.0025980472564697266
local_in_edges_tensor generation: 0.002463102340698242
mini_batch_src_global generation: 0.005295991897583008

&&&&&&&&&&&&&&& before remove duplicate length: 147427
r_  generation: 0.055008649826049805

local_output_nid generation: 0.002727985382080078
local_in_edges_tensor generation: 0.002488851547241211
mini_batch_src_global generation: 0.005224704742431641

&&&&&&&&&&&&&&& before remove duplicate length: 155370
r_  generation: 0.05657839775085449

local_output_nid generation: 0.0025908946990966797
local_in_edges_tensor generation: 0.0026471614837646484
mini_batch_src_global generation: 0.005304098129272461

&&&&&&&&&&&&&&& before remove duplicate length: 151020
r_  generation: 0.05305814743041992

local_output_nid generation: 0.0025110244750976562
local_in_edges_tensor generation: 0.0023648738861083984
mini_batch_src_global generation: 0.0050203800201416016

&&&&&&&&&&&&&&& before remove duplicate length: 144293
r_  generation: 0.05058717727661133

local_output_nid generation: 0.0025148391723632812
local_in_edges_tensor generation: 0.0023603439331054688
mini_batch_src_global generation: 0.004981279373168945

&&&&&&&&&&&&&&& before remove duplicate length: 144199
r_  generation: 0.05091738700866699

local_output_nid generation: 0.002565145492553711
local_in_edges_tensor generation: 0.002365589141845703
mini_batch_src_global generation: 0.004805088043212891

&&&&&&&&&&&&&&& before remove duplicate length: 143475
r_  generation: 0.04952669143676758

local_output_nid generation: 0.0025026798248291016
local_in_edges_tensor generation: 0.002449512481689453
mini_batch_src_global generation: 0.0048542022705078125

&&&&&&&&&&&&&&& before remove duplicate length: 141357
r_  generation: 0.05043673515319824

local_output_nid generation: 0.0025014877319335938
local_in_edges_tensor generation: 0.002355337142944336
mini_batch_src_global generation: 0.004807472229003906

&&&&&&&&&&&&&&& before remove duplicate length: 143598
r_  generation: 0.05061912536621094

local_output_nid generation: 0.0026404857635498047
local_in_edges_tensor generation: 0.0024852752685546875
mini_batch_src_global generation: 0.005403280258178711

&&&&&&&&&&&&&&& before remove duplicate length: 155035
r_  generation: 0.0563356876373291

local_output_nid generation: 0.0025072097778320312
local_in_edges_tensor generation: 0.0023174285888671875
mini_batch_src_global generation: 0.0049114227294921875

&&&&&&&&&&&&&&& before remove duplicate length: 131912
r_  generation: 0.04684853553771973

local_output_nid generation: 0.002613067626953125
local_in_edges_tensor generation: 0.04607510566711426
mini_batch_src_global generation: 0.00491023063659668

&&&&&&&&&&&&&&& before remove duplicate length: 150586
r_  generation: 0.05319690704345703

local_output_nid generation: 0.002557516098022461
local_in_edges_tensor generation: 0.0024399757385253906
mini_batch_src_global generation: 0.005441904067993164

&&&&&&&&&&&&&&& before remove duplicate length: 149971
r_  generation: 0.05375313758850098

local_output_nid generation: 0.0025377273559570312
local_in_edges_tensor generation: 0.002331972122192383
mini_batch_src_global generation: 0.005023479461669922

&&&&&&&&&&&&&&& before remove duplicate length: 136229
r_  generation: 0.0502161979675293

local_output_nid generation: 0.0026772022247314453
local_in_edges_tensor generation: 0.0024831295013427734
mini_batch_src_global generation: 0.005227327346801758

&&&&&&&&&&&&&&& before remove duplicate length: 154455
r_  generation: 0.05800437927246094

local_output_nid generation: 0.0026133060455322266
local_in_edges_tensor generation: 0.0024678707122802734
mini_batch_src_global generation: 0.005666494369506836

&&&&&&&&&&&&&&& before remove duplicate length: 151630
r_  generation: 0.05660057067871094

local_output_nid generation: 0.0026617050170898438
local_in_edges_tensor generation: 0.0025153160095214844
mini_batch_src_global generation: 0.00564885139465332

&&&&&&&&&&&&&&& before remove duplicate length: 156709
r_  generation: 0.0598599910736084

local_output_nid generation: 0.002585172653198242
local_in_edges_tensor generation: 0.0024385452270507812
mini_batch_src_global generation: 0.005494594573974609

&&&&&&&&&&&&&&& before remove duplicate length: 146514
r_  generation: 0.05265188217163086

local_output_nid generation: 0.0026628971099853516
local_in_edges_tensor generation: 0.0024747848510742188
mini_batch_src_global generation: 0.005459785461425781

&&&&&&&&&&&&&&& before remove duplicate length: 157076
r_  generation: 0.05837512016296387

local_output_nid generation: 0.0025467872619628906
local_in_edges_tensor generation: 0.002398967742919922
mini_batch_src_global generation: 0.005523681640625

&&&&&&&&&&&&&&& before remove duplicate length: 148112
r_  generation: 0.05426192283630371

local_output_nid generation: 0.0025353431701660156
local_in_edges_tensor generation: 0.0024755001068115234
mini_batch_src_global generation: 0.005265712738037109

&&&&&&&&&&&&&&& before remove duplicate length: 148913
r_  generation: 0.05460309982299805

local_output_nid generation: 0.0026543140411376953
local_in_edges_tensor generation: 0.0025212764739990234
mini_batch_src_global generation: 0.009671449661254883

&&&&&&&&&&&&&&& before remove duplicate length: 156746
r_  generation: 0.0594937801361084


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6541297435760498
gen group dst list time:  0.04976320266723633
check_connections_block*********************************
time for parepare 1: 0.3743762969970703
local_output_nid generation: 0.011767148971557617
local_in_edges_tensor generation: 0.05904722213745117
mini_batch_src_global generation: 0.015213251113891602

&&&&&&&&&&&&&&& before remove duplicate length: 429418
r_  generation: 0.1506798267364502

local_output_nid generation: 0.016585588455200195
local_in_edges_tensor generation: 0.017627477645874023
mini_batch_src_global generation: 0.02018451690673828

&&&&&&&&&&&&&&& before remove duplicate length: 497305
r_  generation: 0.18785881996154785

local_output_nid generation: 0.01954054832458496
local_in_edges_tensor generation: 0.02097463607788086
mini_batch_src_global generation: 0.04512619972229004

&&&&&&&&&&&&&&& before remove duplicate length: 583694
r_  generation: 0.24560308456420898

local_output_nid generation: 0.018880128860473633
local_in_edges_tensor generation: 0.020046472549438477
mini_batch_src_global generation: 0.026226282119750977

&&&&&&&&&&&&&&& before remove duplicate length: 624449
r_  generation: 0.265399694442749

local_output_nid generation: 0.013883113861083984
local_in_edges_tensor generation: 0.012967109680175781
mini_batch_src_global generation: 0.02033090591430664

&&&&&&&&&&&&&&& before remove duplicate length: 429993
r_  generation: 0.18326139450073242

local_output_nid generation: 0.0195920467376709
local_in_edges_tensor generation: 0.019085407257080078
mini_batch_src_global generation: 0.029736042022705078

&&&&&&&&&&&&&&& before remove duplicate length: 635999
r_  generation: 0.2893979549407959

local_output_nid generation: 0.019266366958618164
local_in_edges_tensor generation: 0.022647380828857422
mini_batch_src_global generation: 0.03190469741821289

&&&&&&&&&&&&&&& before remove duplicate length: 601829
r_  generation: 0.2742338180541992

local_output_nid generation: 0.020213842391967773
local_in_edges_tensor generation: 0.021438121795654297
mini_batch_src_global generation: 0.0317533016204834

&&&&&&&&&&&&&&& before remove duplicate length: 652139
r_  generation: 0.30402255058288574

local_output_nid generation: 0.01724076271057129
local_in_edges_tensor generation: 0.015030145645141602
mini_batch_src_global generation: 0.02550983428955078

&&&&&&&&&&&&&&& before remove duplicate length: 505401
r_  generation: 0.22635149955749512

local_output_nid generation: 0.01730489730834961
local_in_edges_tensor generation: 0.014986276626586914
mini_batch_src_global generation: 0.02402639389038086

&&&&&&&&&&&&&&& before remove duplicate length: 536197
r_  generation: 0.23737239837646484

local_output_nid generation: 0.02111029624938965
local_in_edges_tensor generation: 0.020395278930664062
mini_batch_src_global generation: 0.029539108276367188

&&&&&&&&&&&&&&& before remove duplicate length: 660592
r_  generation: 0.3040497303009033

local_output_nid generation: 0.01824164390563965
local_in_edges_tensor generation: 0.018624067306518555
mini_batch_src_global generation: 0.02677607536315918

&&&&&&&&&&&&&&& before remove duplicate length: 573105
r_  generation: 0.2753140926361084

local_output_nid generation: 0.017983436584472656
local_in_edges_tensor generation: 0.0159151554107666
mini_batch_src_global generation: 0.02634453773498535

&&&&&&&&&&&&&&& before remove duplicate length: 542016
r_  generation: 0.24226832389831543

local_output_nid generation: 0.017488718032836914
local_in_edges_tensor generation: 0.013799667358398438
mini_batch_src_global generation: 0.02323007583618164

&&&&&&&&&&&&&&& before remove duplicate length: 475206
r_  generation: 0.21591687202453613

local_output_nid generation: 0.016951560974121094
local_in_edges_tensor generation: 0.01492166519165039
mini_batch_src_global generation: 0.024553537368774414

&&&&&&&&&&&&&&& before remove duplicate length: 505625
r_  generation: 0.22512030601501465

local_output_nid generation: 0.014379024505615234
local_in_edges_tensor generation: 0.06453371047973633
mini_batch_src_global generation: 0.019669532775878906

&&&&&&&&&&&&&&& before remove duplicate length: 439377
r_  generation: 0.1957552433013916

local_output_nid generation: 0.01594376564025879
local_in_edges_tensor generation: 0.01395416259765625
mini_batch_src_global generation: 0.023898601531982422

&&&&&&&&&&&&&&& before remove duplicate length: 516190
r_  generation: 0.24008989334106445

local_output_nid generation: 0.013617277145385742
local_in_edges_tensor generation: 0.01228785514831543
mini_batch_src_global generation: 0.022134065628051758

&&&&&&&&&&&&&&& before remove duplicate length: 448794
r_  generation: 0.1945781707763672

local_output_nid generation: 0.015098094940185547
local_in_edges_tensor generation: 0.01309823989868164
mini_batch_src_global generation: 0.0222623348236084

&&&&&&&&&&&&&&& before remove duplicate length: 498335
r_  generation: 0.21691465377807617

local_output_nid generation: 0.020669937133789062
local_in_edges_tensor generation: 0.024170398712158203
mini_batch_src_global generation: 0.03030872344970703

&&&&&&&&&&&&&&& before remove duplicate length: 696616
r_  generation: 0.32152700424194336

local_output_nid generation: 0.02028942108154297
local_in_edges_tensor generation: 0.021963119506835938
mini_batch_src_global generation: 0.028628826141357422

&&&&&&&&&&&&&&& before remove duplicate length: 608457
r_  generation: 0.2936244010925293

local_output_nid generation: 0.016578197479248047
local_in_edges_tensor generation: 0.015674591064453125
mini_batch_src_global generation: 0.025634288787841797

&&&&&&&&&&&&&&& before remove duplicate length: 528111
r_  generation: 0.25984692573547363

local_output_nid generation: 0.019518375396728516
local_in_edges_tensor generation: 0.017313480377197266
mini_batch_src_global generation: 0.029017925262451172

&&&&&&&&&&&&&&& before remove duplicate length: 653942
r_  generation: 0.3162713050842285

local_output_nid generation: 0.020592689514160156
local_in_edges_tensor generation: 0.018829345703125
mini_batch_src_global generation: 0.031149625778198242

&&&&&&&&&&&&&&& before remove duplicate length: 641188
r_  generation: 0.32076406478881836

local_output_nid generation: 0.02140212059020996
local_in_edges_tensor generation: 0.019340991973876953
mini_batch_src_global generation: 0.03178238868713379

&&&&&&&&&&&&&&& before remove duplicate length: 683823
r_  generation: 0.3323369026184082

local_output_nid generation: 0.01947808265686035
local_in_edges_tensor generation: 0.01870250701904297
mini_batch_src_global generation: 0.029895544052124023

&&&&&&&&&&&&&&& before remove duplicate length: 593945
r_  generation: 0.29778599739074707

local_output_nid generation: 0.020511150360107422
local_in_edges_tensor generation: 0.018059492111206055
mini_batch_src_global generation: 0.03125286102294922

&&&&&&&&&&&&&&& before remove duplicate length: 670462
r_  generation: 0.32559680938720703

local_output_nid generation: 0.017516613006591797
local_in_edges_tensor generation: 0.015979766845703125
mini_batch_src_global generation: 0.02810835838317871

&&&&&&&&&&&&&&& before remove duplicate length: 533954
r_  generation: 0.2617917060852051

local_output_nid generation: 0.017412662506103516
local_in_edges_tensor generation: 0.01497340202331543
mini_batch_src_global generation: 0.02806401252746582

&&&&&&&&&&&&&&& before remove duplicate length: 582416
r_  generation: 0.26012158393859863

local_output_nid generation: 0.018343448638916016
local_in_edges_tensor generation: 0.016494274139404297
mini_batch_src_global generation: 0.027950763702392578

&&&&&&&&&&&&&&& before remove duplicate length: 579375
r_  generation: 0.27662062644958496

local_output_nid generation: 0.020227909088134766
local_in_edges_tensor generation: 0.021212339401245117
mini_batch_src_global generation: 0.03217148780822754

&&&&&&&&&&&&&&& before remove duplicate length: 642892
r_  generation: 0.31244730949401855

local_output_nid generation: 0.024199724197387695
local_in_edges_tensor generation: 0.025908946990966797
mini_batch_src_global generation: 0.033492326736450195

&&&&&&&&&&&&&&& before remove duplicate length: 761666
r_  generation: 0.37746715545654297


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  15.523335218429565
block generation total time  13.819019794464111
average batch blocks generation time:  0.4318443685770035
pseudo mini batch 0 input nodes size: 115920
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.04346418380737305  GigaBytes
Max Memory Allocated: 0.04346418380737305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.04350900650024414  GigaBytes
Max Memory Allocated: 0.04350900650024414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.04350900650024414  GigaBytes
Max Memory Allocated: 0.04350900650024414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2069091796875 GB
    Memory Allocated: 0.04790353775024414  GigaBytes
Max Memory Allocated: 0.04790353775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2069091796875 GB
    Memory Allocated: 0.04790353775024414  GigaBytes
Max Memory Allocated: 0.04790353775024414  GigaBytes

first layer input nodes number: 115920
first layer output nodes number: 44247
edges number: 429418
----------------------------------------before model layer 0
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.049097537994384766  GigaBytes
Max Memory Allocated: 0.05069732666015625  GigaBytes

torch.Size([115920, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.049097537994384766  GigaBytes
Max Memory Allocated: 0.05069732666015625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.2088623046875 GB
    Memory Allocated: 0.049097537994384766  GigaBytes
Max Memory Allocated: 0.05069732666015625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4295654296875 GB
    Memory Allocated: 0.06894540786743164  GigaBytes
Max Memory Allocated: 0.08559370040893555  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4295654296875 GB
    Memory Allocated: 0.06894540786743164  GigaBytes
Max Memory Allocated: 0.08559370040893555  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4725341796875 GB
    Memory Allocated: 0.11191415786743164  GigaBytes
Max Memory Allocated: 0.11191415786743164  GigaBytes

h_neigh size torch.Size([44247, 256])
h_self size  torch.Size([44247, 100])
----------------------------------------before rst
 Nvidia-smi: 7.4725341796875 GB
    Memory Allocated: 0.11191415786743164  GigaBytes
Max Memory Allocated: 0.11191415786743164  GigaBytes

torch.Size([44247, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.15488290786743164  GigaBytes
Max Memory Allocated: 0.19785165786743164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.11191415786743164  GigaBytes
Max Memory Allocated: 0.19785165786743164  GigaBytes

torch.Size([44247, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.15488290786743164  GigaBytes
Max Memory Allocated: 0.19785165786743164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.16543245315551758  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------input nodes number: 44247
----------------output nodes number: 5992
----------------edges number: 141715
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.16580724716186523  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5584716796875 GB
    Memory Allocated: 0.16580724716186523  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.1726231575012207  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.1726231575012207  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17371797561645508  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

h_neigh size torch.Size([5992, 47])
h_self size  torch.Size([5992, 256])
----------------------------------------before rst
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17371797561645508  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

torch.Size([5992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17476749420166016  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17367267608642578  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

torch.Size([5992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17472219467163086  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5604248046875 GB
    Memory Allocated: 0.17581796646118164  GigaBytes
Max Memory Allocated: 0.20840120315551758  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 0.05646848678588867  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

pseudo mini batch 1 input nodes size: 153941
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 0.04483985900878906  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 0.04483985900878906  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.1021876335144043  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.10223245620727539  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.05900382995605469  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.06376838684082031  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.06376838684082031  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

first layer input nodes number: 153941
first layer output nodes number: 51046
edges number: 497305
----------------------------------------before model layer 0
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.06539487838745117  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

torch.Size([153941, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.06539487838745117  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7088623046875 GB
    Memory Allocated: 0.06539487838745117  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 0.08830738067626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 0.08830738067626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 0.13713550567626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

h_neigh size torch.Size([51046, 256])
h_self size  torch.Size([51046, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 0.13713550567626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

torch.Size([51046, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.18596363067626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.13713550567626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

torch.Size([51046, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.18596363067626953  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.1981339454650879  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------input nodes number: 51046
----------------output nodes number: 5975
----------------edges number: 141966
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.19855928421020508  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.19855928421020508  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.20536088943481445  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.20536088943481445  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.2064070701599121  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

h_neigh size torch.Size([5975, 47])
h_self size  torch.Size([5975, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.2064070701599121  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

torch.Size([5975, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.20745325088500977  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.2064070701599121  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

torch.Size([5975, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.2064037322998047  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8572998046875 GB
    Memory Allocated: 0.20745038986206055  GigaBytes
Max Memory Allocated: 0.255185604095459  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9119873046875 GB
    Memory Allocated: 0.07204294204711914  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

pseudo mini batch 2 input nodes size: 205869
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9119873046875 GB
    Memory Allocated: 0.059000492095947266  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9119873046875 GB
    Memory Allocated: 0.059000492095947266  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.13569307327270508  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.13573789596557617  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.07834529876708984  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.0837407112121582  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.0837407112121582  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

first layer input nodes number: 205869
first layer output nodes number: 60245
edges number: 583694
----------------------------------------before model layer 0
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.085723876953125  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

torch.Size([205869, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.085723876953125  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.085723876953125  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.11274147033691406  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.11274147033691406  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.1701955795288086  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

h_neigh size torch.Size([60245, 256])
h_self size  torch.Size([60245, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9940185546875 GB
    Memory Allocated: 0.1701955795288086  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

torch.Size([60245, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.22764968872070312  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.1701955795288086  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

torch.Size([60245, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.22764968872070312  GigaBytes
Max Memory Allocated: 0.29854249954223633  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.24201345443725586  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------input nodes number: 60245
----------------output nodes number: 5963
----------------edges number: 138737
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2425074577331543  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2425074577331543  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.24927282333374023  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.24927282333374023  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2504124641418457  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2504124641418457  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2518448829650879  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2507052421569824  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.25079870223999023  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1112060546875 GB
    Memory Allocated: 0.2519388198852539  GigaBytes
Max Memory Allocated: 0.2994675636291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1795654296875 GB
    Memory Allocated: 0.0932002067565918  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

pseudo mini batch 3 input nodes size: 215160
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1795654296875 GB
    Memory Allocated: 0.07843875885009766  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1795654296875 GB
    Memory Allocated: 0.07843875885009766  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.15859222412109375  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.15863943099975586  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.08190202713012695  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.08768701553344727  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.08768701553344727  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

first layer input nodes number: 215160
first layer output nodes number: 63284
edges number: 624449
----------------------------------------before model layer 0
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.09003639221191406  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

torch.Size([215160, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.09003639221191406  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2615966796875 GB
    Memory Allocated: 0.09003639221191406  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2635498046875 GB
    Memory Allocated: 0.1185007095336914  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2635498046875 GB
    Memory Allocated: 0.1185007095336914  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2635498046875 GB
    Memory Allocated: 0.17885303497314453  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

h_neigh size torch.Size([63284, 256])
h_self size  torch.Size([63284, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2635498046875 GB
    Memory Allocated: 0.17885303497314453  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

torch.Size([63284, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.23939990997314453  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.1790475845336914  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

torch.Size([63284, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2395944595336914  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2544879913330078  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------input nodes number: 63284
----------------output nodes number: 6278
----------------edges number: 151897
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2550067901611328  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2550067901611328  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2621736526489258  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2621736526489258  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2632732391357422  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

h_neigh size torch.Size([6278, 47])
h_self size  torch.Size([6278, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2632732391357422  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

torch.Size([6278, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2643728256225586  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2632732391357422  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

torch.Size([6278, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2632331848144531  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 0.2648186683654785  GigaBytes
Max Memory Allocated: 0.35982418060302734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.09792804718017578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

pseudo mini batch 4 input nodes size: 132329
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.08186197280883789  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.08186197280883789  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.13115882873535156  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.13120603561401367  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05100536346435547  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05536460876464844  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05536460876464844  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

first layer input nodes number: 132329
first layer output nodes number: 44122
edges number: 429993
----------------------------------------before model layer 0
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05727863311767578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([132329, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05727863311767578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.05727863311767578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.07708454132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.07708454132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.12005329132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

h_neigh size torch.Size([44122, 256])
h_self size  torch.Size([44122, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.12005329132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([44122, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.16302204132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.12005329132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([44122, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.16302204132080078  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.17354154586791992  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------input nodes number: 44122
----------------output nodes number: 6305
----------------edges number: 154936
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1739177703857422  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1739177703857422  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18113327026367188  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18113327026367188  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1822376251220703  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

h_neigh size torch.Size([6305, 47])
h_self size  torch.Size([6305, 256])
----------------------------------------before rst
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1822376251220703  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([6305, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18334197998046875  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1822376251220703  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([6305, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18312788009643555  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.1842327117919922  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.06441211700439453  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

pseudo mini batch 5 input nodes size: 212590
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.0518956184387207  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.0518956184387207  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.13109159469604492  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.13113880157470703  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.08179473876953125  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.08816671371459961  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.08816671371459961  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

first layer input nodes number: 212590
first layer output nodes number: 64186
edges number: 635999
----------------------------------------before model layer 0
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.09022903442382812  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([212590, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.09022903442382812  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.09022903442382812  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.11911869049072266  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.11911869049072266  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18033123016357422  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

h_neigh size torch.Size([64186, 256])
h_self size  torch.Size([64186, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 0.18033123016357422  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([64186, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.24154376983642578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.18033123016357422  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([64186, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.24154376983642578  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.25684690475463867  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------input nodes number: 64186
----------------output nodes number: 6321
----------------edges number: 156563
----------------------------------------before mean aggregator
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.2573723793029785  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.2573723793029785  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.264615535736084  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.264615535736084  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.2659029960632324  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

h_neigh size torch.Size([6321, 47])
h_self size  torch.Size([6321, 256])
----------------------------------------before rst
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.2659029960632324  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([6321, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.2670097351074219  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.26572227478027344  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

torch.Size([6321, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.26501989364624023  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5721435546875 GB
    Memory Allocated: 0.266629695892334  GigaBytes
Max Memory Allocated: 0.3785848617553711  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.09762811660766602  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

pseudo mini batch 6 input nodes size: 190372
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08109235763549805  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08109235763549805  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.15201187133789062  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.15205907821655273  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.0728158950805664  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.07846641540527344  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.07846641540527344  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

first layer input nodes number: 190372
first layer output nodes number: 60808
edges number: 601829
----------------------------------------before model layer 0
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.0803384780883789  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([190372, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.0803384780883789  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.0803384780883789  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.10770273208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.10770273208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.16629648208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

h_neigh size torch.Size([60808, 256])
h_self size  torch.Size([60808, 100])
----------------------------------------before rst
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.16629648208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([60808, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.22489023208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.16629648208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([60808, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.22489023208618164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.23938798904418945  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------input nodes number: 60808
----------------output nodes number: 6327
----------------edges number: 156474
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.23988866806030273  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.23988866806030273  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24713659286499023  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24713659286499023  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24843931198120117  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24843931198120117  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24954748153686523  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.2482447624206543  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24806547164916992  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.24936866760253906  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08795452117919922  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

pseudo mini batch 7 input nodes size: 214916
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.07263660430908203  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.07263660430908203  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.15269947052001953  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.15274667739868164  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08177995681762695  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08780813217163086  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.08780813217163086  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

first layer input nodes number: 214916
first layer output nodes number: 65771
edges number: 652139
----------------------------------------before model layer 0
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.09026670455932617  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([214916, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.09026670455932617  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.09026670455932617  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.1198725700378418  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.1198725700378418  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.18259668350219727  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

h_neigh size torch.Size([65771, 256])
h_self size  torch.Size([65771, 100])
----------------------------------------before rst
 Nvidia-smi: 8.6365966796875 GB
    Memory Allocated: 0.18259668350219727  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([65771, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.24532079696655273  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.18259668350219727  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([65771, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.24532079696655273  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.2610020637512207  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------input nodes number: 65771
----------------output nodes number: 6297
----------------edges number: 156895
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.2615394592285156  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.2615394592285156  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.26876163482666016  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.26876163482666016  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.27025747299194336  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

h_neigh size torch.Size([6297, 47])
h_self size  torch.Size([6297, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.27025747299194336  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([6297, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.2721543312072754  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.2706584930419922  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

torch.Size([6297, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.27104616165161133  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.27277565002441406  GigaBytes
Max Memory Allocated: 0.38169336318969727  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.09890317916870117  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

pseudo mini batch 8 input nodes size: 165261
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0821676254272461  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0821676254272461  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.1446676254272461  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.1447148323059082  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0646047592163086  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06950664520263672  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06950664520263672  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

first layer input nodes number: 165261
first layer output nodes number: 52658
edges number: 505401
----------------------------------------before model layer 0
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07113075256347656  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([165261, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07113075256347656  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07113075256347656  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0947103500366211  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0947103500366211  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.1449289321899414  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([52658, 256])
h_self size  torch.Size([52658, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.1449289321899414  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([52658, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.19514751434326172  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.1449289321899414  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([52658, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.19514751434326172  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2077021598815918  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------input nodes number: 52658
----------------output nodes number: 6325
----------------edges number: 152358
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.20814180374145508  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.20814180374145508  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21535730361938477  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21535730361938477  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21663999557495117  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([6325, 47])
h_self size  torch.Size([6325, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21663999557495117  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6325, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21787548065185547  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21659278869628906  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6325, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21620464324951172  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.21748781204223633  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07763671875  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

pseudo mini batch 9 input nodes size: 180918
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06421661376953125  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06421661376953125  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.13161420822143555  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.13166093826293945  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06911373138427734  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07423591613769531  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07423591613769531  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

first layer input nodes number: 180918
first layer output nodes number: 55749
edges number: 536197
----------------------------------------before model layer 0
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07599973678588867  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([180918, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07599973678588867  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.07599973678588867  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.10097169876098633  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.10097169876098633  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.15413808822631836  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([55749, 256])
h_self size  torch.Size([55749, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.15413808822631836  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([55749, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2073044776916504  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.15413808822631836  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([55749, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2073044776916504  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2205963134765625  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------input nodes number: 55749
----------------output nodes number: 6248
----------------edges number: 151078
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22105884552001953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22105884552001953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22819042205810547  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22819042205810547  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22942590713500977  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([6248, 47])
h_self size  torch.Size([6248, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22942590713500977  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6248, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.23085832595825195  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.22962284088134766  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6248, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2297506332397461  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.2311387062072754  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.08327770233154297  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

pseudo mini batch 10 input nodes size: 218280
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06924152374267578  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.06924152374267578  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.15127277374267578  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.15131855010986328  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.08387422561645508  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0898890495300293  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0898890495300293  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

first layer input nodes number: 218280
first layer output nodes number: 68559
edges number: 660592
----------------------------------------before model layer 0
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0920267105102539  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([218280, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0920267105102539  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 0.0920267105102539  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8338623046875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8338623046875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8338623046875 GB
    Memory Allocated: 0.1881275177001953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([68559, 256])
h_self size  torch.Size([68559, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8338623046875 GB
    Memory Allocated: 0.1881275177001953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([68559, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.2535104751586914  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.1881275177001953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([68559, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.2535104751586914  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.26985645294189453  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------input nodes number: 68559
----------------output nodes number: 6095
----------------edges number: 146633
----------------------------------------before mean aggregator
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.2704133987426758  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.2704133987426758  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27736473083496094  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27736473083496094  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27844715118408203  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

h_neigh size torch.Size([6095, 47])
h_self size  torch.Size([6095, 256])
----------------------------------------before rst
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27844715118408203  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6095, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27951478958129883  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27843236923217773  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

torch.Size([6095, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27826452255249023  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.9666748046875 GB
    Memory Allocated: 0.27934741973876953  GigaBytes
Max Memory Allocated: 0.3899831771850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10005760192871094  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 11 input nodes size: 194129
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08370637893676758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08370637893676758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.15602540969848633  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.15607118606567383  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07399415969848633  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08013296127319336  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08013296127319336  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 194129
first layer output nodes number: 59081
edges number: 573105
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08202028274536133  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([194129, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08202028274536133  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08202028274536133  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10860967636108398  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10860967636108398  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.16495370864868164  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([59081, 256])
h_self size  torch.Size([59081, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.16495370864868164  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([59081, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2212977409362793  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.16495370864868164  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([59081, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2212977409362793  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2353839874267578  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 59081
----------------output nodes number: 6095
----------------edges number: 147427
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.235870361328125  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.235870361328125  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2428274154663086  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2428274154663086  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2438950538635254  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([6095, 47])
h_self size  torch.Size([6095, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2438950538635254  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6095, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2449626922607422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2438950538635254  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6095, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.24400949478149414  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.24507761001586914  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08964109420776367  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 12 input nodes size: 180168
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07410860061645508  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07410860061645508  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14122676849365234  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14127397537231445  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0689091682434082  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07410573959350586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07410573959350586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 180168
first layer output nodes number: 55483
edges number: 542016
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07586193084716797  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([180168, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07586193084716797  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07586193084716797  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10077714920043945  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10077714920043945  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.15368986129760742  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([55483, 256])
h_self size  torch.Size([55483, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.15368986129760742  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([55483, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2066025733947754  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.15368986129760742  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([55483, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2066025733947754  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21983098983764648  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 55483
----------------output nodes number: 6327
----------------edges number: 155370
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2202916145324707  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2202916145324707  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22753095626831055  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22753095626831055  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22916078567504883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22916078567504883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2302689552307129  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2286391258239746  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22856521606445312  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2301955223083496  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08304071426391602  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 13 input nodes size: 171409
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06883525848388672  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06883525848388672  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.13328838348388672  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.13333463668823242  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06616926193237305  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07083559036254883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07083559036254883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 171409
first layer output nodes number: 48751
edges number: 475206
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07266998291015625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([171409, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07266998291015625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07266998291015625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09538888931274414  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09538888931274414  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14188146591186523  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([48751, 256])
h_self size  torch.Size([48751, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14188146591186523  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([48751, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18837404251098633  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14188146591186523  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([48751, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18837404251098633  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1999974250793457  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 48751
----------------output nodes number: 6206
----------------edges number: 151020
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2004070281982422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2004070281982422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20749759674072266  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20749759674072266  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20886754989624023  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([6206, 47])
h_self size  torch.Size([6206, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20886754989624023  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6206, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20995426177978516  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20858430862426758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6206, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2087249755859375  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20983362197875977  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08023357391357422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 14 input nodes size: 180646
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06630992889404297  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06630992889404297  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.13360595703125  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1336507797241211  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06915140151977539  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07399511337280273  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07399511337280273  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 180646
first layer output nodes number: 52503
edges number: 505625
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07573270797729492  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([180646, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07573270797729492  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07573270797729492  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09925556182861328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09925556182861328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14932632446289062  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([52503, 256])
h_self size  torch.Size([52503, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14932632446289062  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([52503, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.19939708709716797  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14932632446289062  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([52503, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.19939708709716797  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2119150161743164  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 52503
----------------output nodes number: 5965
----------------edges number: 144293
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21235132217407227  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21235132217407227  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2191605567932129  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2191605567932129  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22110748291015625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([5965, 47])
h_self size  torch.Size([5965, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22110748291015625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5965, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22289705276489258  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22095012664794922  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5965, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22074604034423828  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22269344329833984  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08229875564575195  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 15 input nodes size: 134234
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06894731521606445  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06894731521606445  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.11895370483398438  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.11899852752685547  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.051657676696777344  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.056159019470214844  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.056159019470214844  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 134234
first layer output nodes number: 45512
edges number: 439377
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.057498931884765625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([134234, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.057498931884765625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.057498931884765625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07883691787719727  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07883691787719727  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12224054336547852  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([45512, 256])
h_self size  torch.Size([45512, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12224054336547852  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([45512, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.16564416885375977  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12224054336547852  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([45512, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.16564416885375977  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.17649507522583008  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 45512
----------------output nodes number: 5995
----------------edges number: 144199
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1768794059753418  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1768794059753418  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1837162971496582  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1837162971496582  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1851949691772461  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([5995, 47])
h_self size  torch.Size([5995, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1851949691772461  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5995, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18624496459960938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18476629257202148  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5995, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18477153778076172  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1858220100402832  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0636739730834961  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 16 input nodes size: 190117
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.05166292190551758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.05166292190551758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12248706817626953  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12253284454345703  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07248163223266602  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07792520523071289  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07792520523071289  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 190117
first layer output nodes number: 53146
edges number: 516190
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07973814010620117  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([190117, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07973814010620117  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07973814010620117  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10358142852783203  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.10358142852783203  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1542654037475586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([53146, 256])
h_self size  torch.Size([53146, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1542654037475586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([53146, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20494937896728516  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1542654037475586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([53146, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20494937896728516  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2176203727722168  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 53146
----------------output nodes number: 6093
----------------edges number: 143475
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2180624008178711  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2180624008178711  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22498798370361328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22498798370361328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22702598571777344  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([6093, 47])
h_self size  torch.Size([6093, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22702598571777344  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6093, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22809314727783203  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22605514526367188  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6093, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22704315185546875  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.22811079025268555  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.08757209777832031  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 17 input nodes size: 131785
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07346963882446289  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07346963882446289  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12256383895874023  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12260866165161133  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.051738739013671875  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0561370849609375  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0561370849609375  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 131785
first layer output nodes number: 46875
edges number: 448794
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.05746889114379883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([131785, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.05746889114379883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.05746889114379883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07845115661621094  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07845115661621094  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12337303161621094  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([46875, 256])
h_self size  torch.Size([46875, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.12337303161621094  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([46875, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1680765151977539  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1231546401977539  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([46875, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1680765151977539  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.17903423309326172  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 46875
----------------output nodes number: 5965
----------------edges number: 141357
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1794285774230957  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1794285774230957  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18621587753295898  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18621587753295898  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18804407119750977  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([5965, 47])
h_self size  torch.Size([5965, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18804407119750977  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5965, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1890888214111328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18726062774658203  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5965, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.18705081939697266  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1880960464477539  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06347799301147461  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 18 input nodes size: 167935
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0515289306640625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0515289306640625  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1140899658203125  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.1141347885131836  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06499576568603516  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06981468200683594  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06981468200683594  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 167935
first layer output nodes number: 50485
edges number: 498335
----------------------------------------before model layer 0
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0714421272277832  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([167935, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0714421272277832  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.0714421272277832  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09487533569335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.09487533569335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14370346069335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([50485, 256])
h_self size  torch.Size([50485, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14370346069335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([50485, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.19253158569335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.14370346069335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([50485, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.19253158569335938  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20456838607788086  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 50485
----------------output nodes number: 5963
----------------edges number: 143598
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20498943328857422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.20498943328857422  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2117910385131836  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2117910385131836  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21283531188964844  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21283531188964844  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21387958526611328  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21283531188964844  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.21294403076171875  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.2139887809753418  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.07822465896606445  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

pseudo mini batch 19 input nodes size: 245596
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06510448455810547  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0350341796875 GB
    Memory Allocated: 0.06510448455810547  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.15690135955810547  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.15694856643676758  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.09434270858764648  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.10068941116333008  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.10068941116333008  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

first layer input nodes number: 245596
first layer output nodes number: 70575
edges number: 696616
----------------------------------------before model layer 0
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.10304546356201172  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([245596, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.10304546356201172  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.10304546356201172  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.13479089736938477  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.13479089736938477  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.20209646224975586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([70575, 256])
h_self size  torch.Size([70575, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 0.20209646224975586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([70575, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.26940202713012695  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.20209646224975586  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([70575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.26940202713012695  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.28622865676879883  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------input nodes number: 70575
----------------output nodes number: 6312
----------------edges number: 155035
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.286801815032959  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.286801815032959  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.2940249443054199  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.2940249443054199  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.29513025283813477  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

h_neigh size torch.Size([6312, 47])
h_self size  torch.Size([6312, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.29513025283813477  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6312, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.2962355613708496  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.29513025283813477  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

torch.Size([6312, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.29479265213012695  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.1951904296875 GB
    Memory Allocated: 0.2958984375  GigaBytes
Max Memory Allocated: 0.4034762382507324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2655029296875 GB
    Memory Allocated: 0.11133384704589844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 20 input nodes size: 292058
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2655029296875 GB
    Memory Allocated: 0.09400510787963867  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2655029296875 GB
    Memory Allocated: 0.09400510787963867  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20338010787963867  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20342493057250977  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11158084869384766  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11709785461425781  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11709785461425781  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 292058
first layer output nodes number: 61817
edges number: 608457
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1197347640991211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([292058, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1197347640991211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1197347640991211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14752769470214844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14752769470214844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2064809799194336  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([61817, 256])
h_self size  torch.Size([61817, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2064809799194336  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([61817, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26543426513671875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2064809799194336  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([61817, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26543426513671875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28017282485961914  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 61817
----------------output nodes number: 5985
----------------edges number: 131912
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28067827224731445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28067827224731445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2874140739440918  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2874140739440918  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28900766372680664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([5985, 47])
h_self size  torch.Size([5985, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28900766372680664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2900557518005371  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28846216201782227  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28845643997192383  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2900505065917969  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12721776962280273  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 21 input nodes size: 194193
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11157512664794922  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11157512664794922  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.18391799926757812  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.18396425247192383  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07454442977905273  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07960176467895508  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07960176467895508  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 194193
first layer output nodes number: 53885
edges number: 528111
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08185052871704102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([194193, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08185052871704102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08185052871704102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10606002807617188  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10606002807617188  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.15744876861572266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([53885, 256])
h_self size  torch.Size([53885, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.15744876861572266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([53885, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20883750915527344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.15744876861572266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([53885, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20883750915527344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22168493270874023  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 53885
----------------output nodes number: 6182
----------------edges number: 150586
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22213268280029297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22213268280029297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22919750213623047  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22919750213623047  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23050689697265625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6182, 47])
h_self size  torch.Size([6182, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23050689697265625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6182, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23158931732177734  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23027992248535156  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6182, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2299957275390625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2317347526550293  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08861875534057617  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 22 input nodes size: 241231
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07426023483276367  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07426023483276367  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16412591934204102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16417217254638672  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09178304672241211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09777307510375977  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09777307510375977  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 241231
first layer output nodes number: 66209
edges number: 653942
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10019779205322266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([241231, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10019779205322266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10019779205322266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12998199462890625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12998199462890625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.19312381744384766  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([66209, 256])
h_self size  torch.Size([66209, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.19312381744384766  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([66209, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25626564025878906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.19312381744384766  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([66209, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25626564025878906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2720513343811035  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 66209
----------------output nodes number: 6181
----------------edges number: 149971
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27259111404418945  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27259111404418945  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2796502113342285  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2796502113342285  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2809615135192871  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6181, 47])
h_self size  torch.Size([6181, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2809615135192871  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6181, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2820439338684082  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2807326316833496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6181, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2807345390319824  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2820463180541992  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10836458206176758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 23 input nodes size: 280006
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09178495407104492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09178495407104492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.19609546661376953  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.19614028930664062  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10622835159301758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11230850219726562  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11230850219726562  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 280006
first layer output nodes number: 65513
edges number: 641188
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1148834228515625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([280006, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1148834228515625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1148834228515625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14431142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14431142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20681142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([65513, 256])
h_self size  torch.Size([65513, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20681142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([65513, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26931142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.20681142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([65513, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26931142807006836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2849311828613281  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 65513
----------------output nodes number: 5963
----------------edges number: 136229
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2854642868041992  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2854642868041992  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29221153259277344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29221153259277344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29336977005004883  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29336977005004883  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29526853561401367  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2941102981567383  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.29384326934814453  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2950019836425781  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12246942520141602  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 24 input nodes size: 225049
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10596132278442383  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10596132278442383  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.18979883193969727  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.18984556198120117  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08549022674560547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0917367935180664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0917367935180664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 225049
first layer output nodes number: 68988
edges number: 683823
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09414958953857422  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([225049, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09414958953857422  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09414958953857422  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1255183219909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1255183219909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1919245719909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([68988, 256])
h_self size  torch.Size([68988, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1919245719909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([68988, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2583308219909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1919245719909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([68988, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2583308219909668  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27559947967529297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 68988
----------------output nodes number: 6233
----------------edges number: 154455
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27616024017333984  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27616024017333984  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28330230712890625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28330230712890625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28488969802856445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6233, 47])
h_self size  torch.Size([6233, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28488969802856445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6233, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2859811782836914  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2843937873840332  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6233, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2844409942626953  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.28553295135498047  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10300874710083008  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 25 input nodes size: 206478
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08553743362426758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08553743362426758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16245651245117188  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16250276565551758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07861852645874023  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08434677124023438  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08434677124023438  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 206478
first layer output nodes number: 60493
edges number: 593945
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08633661270141602  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([206478, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08633661270141602  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08633661270141602  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11352396011352539  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.11352396011352539  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1721177101135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([60493, 256])
h_self size  torch.Size([60493, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1721177101135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([60493, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2307114601135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1721177101135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([60493, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2307114601135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2451343536376953  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 60493
----------------output nodes number: 6161
----------------edges number: 151630
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.24563169479370117  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.24563169479370117  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2526841163635254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2526841163635254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2538900375366211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6161, 47])
h_self size  torch.Size([6161, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2538900375366211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25496912002563477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25376319885253906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2537508010864258  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2549571990966797  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09398221969604492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 26 input nodes size: 219973
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07860612869262695  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07860612869262695  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16063737869262695  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16068458557128906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08371925354003906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08988285064697266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08988285064697266  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 219973
first layer output nodes number: 67471
edges number: 670462
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0920252799987793  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([219973, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0920252799987793  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0920252799987793  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12240743637084961  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12240743637084961  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1868605613708496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([67471, 256])
h_self size  torch.Size([67471, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1868605613708496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([67471, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2513136863708496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1868605613708496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([67471, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2513136863708496  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26740026473999023  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 67471
----------------output nodes number: 6290
----------------edges number: 156709
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26795053482055664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26795053482055664  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2751650810241699  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2751650810241699  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2766566276550293  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6290, 47])
h_self size  torch.Size([6290, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2766566276550293  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6290, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2777581214904785  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27626657485961914  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6290, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27667903900146484  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2782111167907715  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10084724426269531  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 27 input nodes size: 200743
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08413171768188477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08413171768188477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.15891456604003906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.15895938873291016  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07688093185424805  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08195161819458008  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08195161819458008  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 200743
first layer output nodes number: 54052
edges number: 533954
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08385038375854492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([200743, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08385038375854492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08385038375854492  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10883235931396484  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16038036346435547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([54052, 256])
h_self size  torch.Size([54052, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16038036346435547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([54052, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2119283676147461  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16038036346435547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([54052, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2119283676147461  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22481536865234375  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 54052
----------------output nodes number: 5964
----------------edges number: 146514
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22526311874389648  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22526311874389648  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2320876121520996  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2320876121520996  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23344039916992188  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([5964, 47])
h_self size  torch.Size([5964, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23344039916992188  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5964, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23448467254638672  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23313188552856445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5964, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23299312591552734  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23435163497924805  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09141302108764648  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 28 input nodes size: 153116
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07674217224121094  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07674217224121094  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.13378238677978516  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.13382959365844727  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.059001922607421875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0645132064819336  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0645132064819336  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 153116
first layer output nodes number: 58780
edges number: 582416
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.06650495529174805  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([153116, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.06650495529174805  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.06650495529174805  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09317970275878906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09317970275878906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14923667907714844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([58780, 256])
h_self size  torch.Size([58780, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14923667907714844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([58780, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2052936553955078  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14923667907714844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([58780, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2052936553955078  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.21930789947509766  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 58780
----------------output nodes number: 6301
----------------edges number: 157076
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.21979331970214844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.21979331970214844  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2270212173461914  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2270212173461914  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22812461853027344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6301, 47])
h_self size  torch.Size([6301, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22812461853027344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6301, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22922801971435547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22812461853027344  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6301, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22820520401000977  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.22930908203125  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.07443380355834961  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 29 input nodes size: 227607
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0590825080871582  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0590825080871582  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14387273788452148  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.14391756057739258  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08683013916015625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09225177764892578  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09225177764892578  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 227607
first layer output nodes number: 58598
edges number: 579375
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09438467025756836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([227607, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09438467025756836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09438467025756836  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12105989456176758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12105989456176758  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.17694330215454102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([58598, 256])
h_self size  torch.Size([58598, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.17694330215454102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([58598, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23282670974731445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.17694330215454102  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([58598, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.23282670974731445  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2467975616455078  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 58598
----------------output nodes number: 5963
----------------edges number: 148112
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.24727916717529297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.24727916717529297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25411510467529297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25411510467529297  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2556924819946289  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2556924819946289  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2573585510253906  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2557811737060547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.25539207458496094  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2569699287414551  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10177230834960938  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 30 input nodes size: 223579
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0864410400390625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0864410400390625  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16973114013671875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.16977596282958984  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.08494091033935547  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09084129333496094  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09084129333496094  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 223579
first layer output nodes number: 64843
edges number: 642892
----------------------------------------before model layer 0
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09299087524414062  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([223579, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09299087524414062  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.09299087524414062  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12217903137207031  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.12217903137207031  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1846790313720703  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([64843, 256])
h_self size  torch.Size([64843, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1846790313720703  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([64843, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2471790313720703  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.1846790313720703  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([64843, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2471790313720703  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.26263904571533203  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 64843
----------------output nodes number: 5992
----------------edges number: 148913
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2631673812866211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2631673812866211  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2700366973876953  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2700366973876953  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2710862159729004  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([5992, 47])
h_self size  torch.Size([5992, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2710862159729004  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.2723398208618164  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27129030227661133  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([5992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27129554748535156  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.27234554290771484  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.10104084014892578  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

pseudo mini batch 31 input nodes size: 270027
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0849461555480957  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3748779296875 GB
    Memory Allocated: 0.0849461555480957  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.1865086555480957  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.1865558624267578  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.10322093963623047  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.11006450653076172  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.11006450653076172  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

first layer input nodes number: 270027
first layer output nodes number: 76817
edges number: 761666
----------------------------------------before model layer 0
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.11294031143188477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([270027, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.11294031143188477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4764404296875 GB
    Memory Allocated: 0.11294031143188477  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.14751911163330078  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.14751911163330078  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.2207775115966797  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([76817, 256])
h_self size  torch.Size([76817, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.2207775115966797  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([76817, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.2940359115600586  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.2207775115966797  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([76817, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.2940359115600586  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3125743865966797  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------input nodes number: 76817
----------------output nodes number: 6309
----------------edges number: 156746
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.31319427490234375  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.31319427490234375  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.32042694091796875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.32042694091796875  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3215317726135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

h_neigh size torch.Size([6309, 47])
h_self size  torch.Size([6309, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3215317726135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6309, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.32263660430908203  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3215317726135254  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

torch.Size([6309, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3224916458129883  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 0.3235969543457031  GigaBytes
Max Memory Allocated: 0.4236745834350586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12312889099121094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12368965148925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12368965148925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037022776901721954 |0.013859964907169342 |0.03540126234292984 |0.00013637542724609375 |0.003230772912502289 |0.002795696258544922 |
----------------------------------------------------------pseudo_mini_loss sum 6.257943630218506
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8206187
Number of first layer input nodes during this epoch:  6335635
Number of first layer output nodes during this epoch:  1870552
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12368917465209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.27167677879333496
global_2_local spend time (sec) 0.42106127738952637

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.253 seconds
Metis partitioning: 13.928 seconds
Split the graph: 0.813 seconds
Construct subgraphs: 0.362 seconds
6293
5976
6310
6047
5963
6016
5987
6083
6288
6250
6313
6281
5963
6313
5963
6327
5963
6293
5991
5969
6145
6050
6320
6284
6261
6160
6326
5963
6011
6166
6291
6005
REG metis partition end ----................................
the time spent:  27.496408700942993
total k batches seeds list generation spend  28.034600257873535
after graph partition
graph partition algorithm spend time 28.480305910110474

partition_len_list
[63500, 60274, 47029, 52636, 63910, 57214, 61731, 56120, 63969, 61613, 68177, 72559, 54688, 58246, 64768, 73274, 60078, 45012, 44033, 51873, 62057, 51475, 64352, 58951, 55829, 65642, 57274, 60767, 52861, 47781, 60204, 48852]
REG selection method  spend 29.131222248077393
check_connections_block*********************************
time for parepare 1: 0.229292631149292
local_output_nid generation: 0.002298116683959961
local_in_edges_tensor generation: 0.0026116371154785156
mini_batch_src_global generation: 0.005102872848510742

&&&&&&&&&&&&&&& before remove duplicate length: 155748
r_  generation: 0.051698923110961914

local_output_nid generation: 0.002476215362548828
local_in_edges_tensor generation: 0.002411365509033203
mini_batch_src_global generation: 0.005954742431640625

&&&&&&&&&&&&&&& before remove duplicate length: 144467
r_  generation: 0.04879951477050781

local_output_nid generation: 0.002663850784301758
local_in_edges_tensor generation: 0.002454519271850586
mini_batch_src_global generation: 0.004379987716674805

&&&&&&&&&&&&&&& before remove duplicate length: 150699
r_  generation: 0.05232882499694824

local_output_nid generation: 0.002578258514404297
local_in_edges_tensor generation: 0.002368450164794922
mini_batch_src_global generation: 0.004611492156982422

&&&&&&&&&&&&&&& before remove duplicate length: 141813
r_  generation: 0.0487513542175293

local_output_nid generation: 0.0025572776794433594
local_in_edges_tensor generation: 0.002308368682861328
mini_batch_src_global generation: 0.0043256282806396484

&&&&&&&&&&&&&&& before remove duplicate length: 133697
r_  generation: 0.0485687255859375

local_output_nid generation: 0.002572774887084961
local_in_edges_tensor generation: 0.0024023056030273438
mini_batch_src_global generation: 0.0046541690826416016

&&&&&&&&&&&&&&& before remove duplicate length: 137097
r_  generation: 0.049013614654541016

local_output_nid generation: 0.0025734901428222656
local_in_edges_tensor generation: 0.002399444580078125
mini_batch_src_global generation: 0.0046656131744384766

&&&&&&&&&&&&&&& before remove duplicate length: 142050
r_  generation: 0.05162167549133301

local_output_nid generation: 0.002615690231323242
local_in_edges_tensor generation: 0.002435922622680664
mini_batch_src_global generation: 0.005181789398193359

&&&&&&&&&&&&&&& before remove duplicate length: 143700
r_  generation: 0.049120187759399414

local_output_nid generation: 0.0026912689208984375
local_in_edges_tensor generation: 0.002549886703491211
mini_batch_src_global generation: 0.005203962326049805

&&&&&&&&&&&&&&& before remove duplicate length: 156236
r_  generation: 0.05916714668273926

local_output_nid generation: 0.002686738967895508
local_in_edges_tensor generation: 0.002612590789794922
mini_batch_src_global generation: 0.005980968475341797

&&&&&&&&&&&&&&& before remove duplicate length: 154876
r_  generation: 0.05771446228027344

local_output_nid generation: 0.0026924610137939453
local_in_edges_tensor generation: 0.002521514892578125
mini_batch_src_global generation: 0.005560636520385742

&&&&&&&&&&&&&&& before remove duplicate length: 156378
r_  generation: 0.06044650077819824

local_output_nid generation: 0.002677440643310547
local_in_edges_tensor generation: 0.002570629119873047
mini_batch_src_global generation: 0.0059893131256103516

&&&&&&&&&&&&&&& before remove duplicate length: 155853
r_  generation: 0.059441566467285156

local_output_nid generation: 0.00255584716796875
local_in_edges_tensor generation: 0.002477407455444336
mini_batch_src_global generation: 0.005449056625366211

&&&&&&&&&&&&&&& before remove duplicate length: 148221
r_  generation: 0.057199716567993164

local_output_nid generation: 0.002666473388671875
local_in_edges_tensor generation: 0.002546548843383789
mini_batch_src_global generation: 0.0057773590087890625

&&&&&&&&&&&&&&& before remove duplicate length: 157279
r_  generation: 0.05875825881958008

local_output_nid generation: 0.002548694610595703
local_in_edges_tensor generation: 0.0023581981658935547
mini_batch_src_global generation: 0.005723714828491211

&&&&&&&&&&&&&&& before remove duplicate length: 148111
r_  generation: 0.057114362716674805

local_output_nid generation: 0.0026874542236328125
local_in_edges_tensor generation: 0.0024826526641845703
mini_batch_src_global generation: 0.005831241607666016

&&&&&&&&&&&&&&& before remove duplicate length: 157457
r_  generation: 0.06091499328613281

local_output_nid generation: 0.0025713443756103516
local_in_edges_tensor generation: 0.0024597644805908203
mini_batch_src_global generation: 0.005486249923706055

&&&&&&&&&&&&&&& before remove duplicate length: 140242
r_  generation: 0.05492997169494629

local_output_nid generation: 0.002660512924194336
local_in_edges_tensor generation: 0.0025234222412109375
mini_batch_src_global generation: 0.005621433258056641

&&&&&&&&&&&&&&& before remove duplicate length: 154657
r_  generation: 0.05750107765197754

local_output_nid generation: 0.0025823116302490234
local_in_edges_tensor generation: 0.0026900768280029297
mini_batch_src_global generation: 0.005410909652709961

&&&&&&&&&&&&&&& before remove duplicate length: 141580
r_  generation: 0.0490877628326416

local_output_nid generation: 0.002507448196411133
local_in_edges_tensor generation: 0.002317190170288086
mini_batch_src_global generation: 0.005198955535888672

&&&&&&&&&&&&&&& before remove duplicate length: 141103
r_  generation: 0.051389217376708984

local_output_nid generation: 0.002633810043334961
local_in_edges_tensor generation: 0.002507925033569336
mini_batch_src_global generation: 0.005494832992553711

&&&&&&&&&&&&&&& before remove duplicate length: 152577
r_  generation: 0.05877065658569336

local_output_nid generation: 0.0026199817657470703
local_in_edges_tensor generation: 0.002468109130859375
mini_batch_src_global generation: 0.0055999755859375

&&&&&&&&&&&&&&& before remove duplicate length: 148491
r_  generation: 0.05563688278198242

local_output_nid generation: 0.002681732177734375
local_in_edges_tensor generation: 0.0024874210357666016
mini_batch_src_global generation: 0.00568079948425293

&&&&&&&&&&&&&&& before remove duplicate length: 157088
r_  generation: 0.05961489677429199

local_output_nid generation: 0.0026650428771972656
local_in_edges_tensor generation: 0.002560853958129883
mini_batch_src_global generation: 0.00609898567199707

&&&&&&&&&&&&&&& before remove duplicate length: 155939
r_  generation: 0.05920553207397461

local_output_nid generation: 0.0026841163635253906
local_in_edges_tensor generation: 0.0024504661560058594
mini_batch_src_global generation: 0.005555868148803711

&&&&&&&&&&&&&&& before remove duplicate length: 151164
r_  generation: 0.056755781173706055

local_output_nid generation: 0.002607107162475586
local_in_edges_tensor generation: 0.0025489330291748047
mini_batch_src_global generation: 0.005722522735595703

&&&&&&&&&&&&&&& before remove duplicate length: 148828
r_  generation: 0.05633068084716797

local_output_nid generation: 0.002672910690307617
local_in_edges_tensor generation: 0.0024902820587158203
mini_batch_src_global generation: 0.005795001983642578

&&&&&&&&&&&&&&& before remove duplicate length: 153234
r_  generation: 0.05876278877258301

local_output_nid generation: 0.002562999725341797
local_in_edges_tensor generation: 0.002385377883911133
mini_batch_src_global generation: 0.005602359771728516

&&&&&&&&&&&&&&& before remove duplicate length: 142671
r_  generation: 0.05384349822998047

local_output_nid generation: 0.0025560855865478516
local_in_edges_tensor generation: 0.0024030208587646484
mini_batch_src_global generation: 0.005431413650512695

&&&&&&&&&&&&&&& before remove duplicate length: 145182
r_  generation: 0.05504131317138672

local_output_nid generation: 0.0025985240936279297
local_in_edges_tensor generation: 0.0024118423461914062
mini_batch_src_global generation: 0.0055696964263916016

&&&&&&&&&&&&&&& before remove duplicate length: 148122
r_  generation: 0.054358720779418945

local_output_nid generation: 0.0026476383209228516
local_in_edges_tensor generation: 0.002447843551635742
mini_batch_src_global generation: 0.005620241165161133

&&&&&&&&&&&&&&& before remove duplicate length: 152696
r_  generation: 0.05741286277770996

local_output_nid generation: 0.002560138702392578
local_in_edges_tensor generation: 0.002377033233642578
mini_batch_src_global generation: 0.005579710006713867

&&&&&&&&&&&&&&& before remove duplicate length: 146623
r_  generation: 0.05392122268676758


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7161169052124023
gen group dst list time:  0.05403876304626465
check_connections_block*********************************
time for parepare 1: 0.3826935291290283
local_output_nid generation: 0.016237258911132812
local_in_edges_tensor generation: 0.07916498184204102
mini_batch_src_global generation: 0.020294189453125

&&&&&&&&&&&&&&& before remove duplicate length: 626927
r_  generation: 0.24302411079406738

local_output_nid generation: 0.020250320434570312
local_in_edges_tensor generation: 0.0245664119720459
mini_batch_src_global generation: 0.02402639389038086

&&&&&&&&&&&&&&& before remove duplicate length: 594807
r_  generation: 0.25391650199890137

local_output_nid generation: 0.01457524299621582
local_in_edges_tensor generation: 0.011230945587158203
mini_batch_src_global generation: 0.01799607276916504

&&&&&&&&&&&&&&& before remove duplicate length: 450296
r_  generation: 0.1785128116607666

local_output_nid generation: 0.01607513427734375
local_in_edges_tensor generation: 0.013595819473266602
mini_batch_src_global generation: 0.01891160011291504

&&&&&&&&&&&&&&& before remove duplicate length: 510137
r_  generation: 0.20730304718017578

local_output_nid generation: 0.02043890953063965
local_in_edges_tensor generation: 0.021235942840576172
mini_batch_src_global generation: 0.02610015869140625

&&&&&&&&&&&&&&& before remove duplicate length: 621890
r_  generation: 0.2908351421356201

local_output_nid generation: 0.017363548278808594
local_in_edges_tensor generation: 0.01610708236694336
mini_batch_src_global generation: 0.024918079376220703

&&&&&&&&&&&&&&& before remove duplicate length: 565157
r_  generation: 0.26576685905456543

local_output_nid generation: 0.019711971282958984
local_in_edges_tensor generation: 0.01785421371459961
mini_batch_src_global generation: 0.026325464248657227

&&&&&&&&&&&&&&& before remove duplicate length: 609869
r_  generation: 0.29088497161865234

local_output_nid generation: 0.018276453018188477
local_in_edges_tensor generation: 0.016777515411376953
mini_batch_src_global generation: 0.026541948318481445

&&&&&&&&&&&&&&& before remove duplicate length: 554003
r_  generation: 0.26822996139526367

local_output_nid generation: 0.019742250442504883
local_in_edges_tensor generation: 0.017147064208984375
mini_batch_src_global generation: 0.0284576416015625

&&&&&&&&&&&&&&& before remove duplicate length: 633619
r_  generation: 0.3092336654663086

local_output_nid generation: 0.01974940299987793
local_in_edges_tensor generation: 0.017130136489868164
mini_batch_src_global generation: 0.02913808822631836

&&&&&&&&&&&&&&& before remove duplicate length: 607560
r_  generation: 0.2859787940979004

local_output_nid generation: 0.021207332611083984
local_in_edges_tensor generation: 0.018445253372192383
mini_batch_src_global generation: 0.03201699256896973

&&&&&&&&&&&&&&& before remove duplicate length: 675536
r_  generation: 0.3323702812194824

local_output_nid generation: 0.022475004196166992
local_in_edges_tensor generation: 0.02374553680419922
mini_batch_src_global generation: 0.03766345977783203

&&&&&&&&&&&&&&& before remove duplicate length: 720599
r_  generation: 0.35092854499816895

local_output_nid generation: 0.01701664924621582
local_in_edges_tensor generation: 0.0370635986328125
mini_batch_src_global generation: 0.028108835220336914

&&&&&&&&&&&&&&& before remove duplicate length: 541593
r_  generation: 0.2675313949584961

local_output_nid generation: 0.017675161361694336
local_in_edges_tensor generation: 0.022748947143554688
mini_batch_src_global generation: 0.02752685546875

&&&&&&&&&&&&&&& before remove duplicate length: 576718
r_  generation: 0.25429320335388184

local_output_nid generation: 0.02029895782470703
local_in_edges_tensor generation: 0.023387670516967773
mini_batch_src_global generation: 0.02983999252319336

&&&&&&&&&&&&&&& before remove duplicate length: 641757
r_  generation: 0.3074769973754883

local_output_nid generation: 0.023594141006469727
local_in_edges_tensor generation: 0.026833772659301758
mini_batch_src_global generation: 0.033232927322387695

&&&&&&&&&&&&&&& before remove duplicate length: 726718
r_  generation: 0.35549402236938477

local_output_nid generation: 0.0192718505859375
local_in_edges_tensor generation: 0.01902914047241211
mini_batch_src_global generation: 0.029146432876586914

&&&&&&&&&&&&&&& before remove duplicate length: 585325
r_  generation: 0.29074859619140625

local_output_nid generation: 0.014394998550415039
local_in_edges_tensor generation: 0.012227535247802734
mini_batch_src_global generation: 0.02403545379638672

&&&&&&&&&&&&&&& before remove duplicate length: 438963
r_  generation: 0.20620417594909668

local_output_nid generation: 0.013853311538696289
local_in_edges_tensor generation: 0.030740022659301758
mini_batch_src_global generation: 0.021955013275146484

&&&&&&&&&&&&&&& before remove duplicate length: 426649
r_  generation: 0.18906903266906738

local_output_nid generation: 0.016223669052124023
local_in_edges_tensor generation: 0.020343780517578125
mini_batch_src_global generation: 0.024182796478271484

&&&&&&&&&&&&&&& before remove duplicate length: 504458
r_  generation: 0.2227625846862793

local_output_nid generation: 0.019565105438232422
local_in_edges_tensor generation: 0.02788686752319336
mini_batch_src_global generation: 0.02805471420288086

&&&&&&&&&&&&&&& before remove duplicate length: 615420
r_  generation: 0.2919459342956543

local_output_nid generation: 0.01693558692932129
local_in_edges_tensor generation: 0.01661229133605957
mini_batch_src_global generation: 0.024582386016845703

&&&&&&&&&&&&&&& before remove duplicate length: 502629
r_  generation: 0.23186278343200684

local_output_nid generation: 0.019774436950683594
local_in_edges_tensor generation: 0.018492698669433594
mini_batch_src_global generation: 0.030404090881347656

&&&&&&&&&&&&&&& before remove duplicate length: 638844
r_  generation: 0.3074920177459717

local_output_nid generation: 0.01768636703491211
local_in_edges_tensor generation: 0.015535593032836914
mini_batch_src_global generation: 0.027923583984375

&&&&&&&&&&&&&&& before remove duplicate length: 584107
r_  generation: 0.26412439346313477

local_output_nid generation: 0.017508506774902344
local_in_edges_tensor generation: 0.015471935272216797
mini_batch_src_global generation: 0.027986764907836914

&&&&&&&&&&&&&&& before remove duplicate length: 537043
r_  generation: 0.2621593475341797

local_output_nid generation: 0.02023458480834961
local_in_edges_tensor generation: 0.01867079734802246
mini_batch_src_global generation: 0.03047633171081543

&&&&&&&&&&&&&&& before remove duplicate length: 633728
r_  generation: 0.30893588066101074

local_output_nid generation: 0.018599510192871094
local_in_edges_tensor generation: 0.014859676361083984
mini_batch_src_global generation: 0.027662992477416992

&&&&&&&&&&&&&&& before remove duplicate length: 551868
r_  generation: 0.2623779773712158

local_output_nid generation: 0.019566059112548828
local_in_edges_tensor generation: 0.016004562377929688
mini_batch_src_global generation: 0.027895212173461914

&&&&&&&&&&&&&&& before remove duplicate length: 590315
r_  generation: 0.29529595375061035

local_output_nid generation: 0.01723647117614746
local_in_edges_tensor generation: 0.014174938201904297
mini_batch_src_global generation: 0.028219223022460938

&&&&&&&&&&&&&&& before remove duplicate length: 508420
r_  generation: 0.23922300338745117

local_output_nid generation: 0.01515054702758789
local_in_edges_tensor generation: 0.012034893035888672
mini_batch_src_global generation: 0.022467851638793945

&&&&&&&&&&&&&&& before remove duplicate length: 460905
r_  generation: 0.21256375312805176

local_output_nid generation: 0.018261194229125977
local_in_edges_tensor generation: 0.015101432800292969
mini_batch_src_global generation: 0.027287721633911133

&&&&&&&&&&&&&&& before remove duplicate length: 584762
r_  generation: 0.2860844135284424

local_output_nid generation: 0.01645064353942871
local_in_edges_tensor generation: 0.013804197311401367
mini_batch_src_global generation: 0.02469348907470703

&&&&&&&&&&&&&&& before remove duplicate length: 476228
r_  generation: 0.22802376747131348


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12368917465209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

connection checking time:  15.677479028701782
block generation total time  12.91441535949707
average batch blocks generation time:  0.40357547998428345
pseudo mini batch 0 input nodes size: 194381
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10474061965942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10474061965942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1771535873413086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1772007942199707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0755910873413086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08142280578613281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08142280578613281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 194381
first layer output nodes number: 63500
edges number: 626927
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08334493637084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([194381, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08334493637084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08334493637084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1119089126586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1119089126586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17246723175048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63500, 256])
h_self size  torch.Size([63500, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17246723175048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63500, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23302555084228516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17246723175048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63500, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23302555084228516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24816513061523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63500
----------------output nodes number: 6293
----------------edges number: 155748
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2486858367919922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2486858367919922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25589561462402344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25589561462402344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25782346725463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6293, 47])
h_self size  torch.Size([6293, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25782346725463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6293, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2597651481628418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25783729553222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6293, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25775575637817383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25969839096069336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09127521514892578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 1 input nodes size: 238694
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07551050186157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07551050186157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16443109512329102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1644759178161621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09201574325561523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09818458557128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09818458557128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 238694
first layer output nodes number: 60274
edges number: 594807
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10041236877441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([238694, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10041236877441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10041236877441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12781143188476562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12781143188476562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18529319763183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([60274, 256])
h_self size  torch.Size([60274, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18529319763183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60274, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24277496337890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18529319763183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60274, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24277496337890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25714540481567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 60274
----------------output nodes number: 5976
----------------edges number: 144467
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25763940811157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25763940811157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26446008682250977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26446008682250977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26557207107543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5976, 47])
h_self size  torch.Size([5976, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26557207107543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5976, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2666187286376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2655067443847656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5976, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2646908760070801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26580333709716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10743570327758789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 2 input nodes size: 125227
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09119987487792969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09119987487792969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13785076141357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13789796829223633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.048932552337646484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05391073226928711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05391073226928711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 125227
first layer output nodes number: 47029
edges number: 450296
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05519437789916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([125227, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05519437789916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05519437789916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07657861709594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07657861709594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12150049209594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([47029, 256])
h_self size  torch.Size([47029, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12150049209594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47029, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1663508415222168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1214289665222168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47029, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1663508415222168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1774921417236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 47029
----------------output nodes number: 6310
----------------edges number: 150699
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17788982391357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17788982391357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18507862091064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18507862091064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1870899200439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6310, 47])
h_self size  torch.Size([6310, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1870899200439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6310, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.188995361328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18698406219482422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6310, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18697690963745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18898868560791016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06189537048339844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 3 input nodes size: 179043
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04892539978027344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04892539978027344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11562442779541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11566972732543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06897163391113281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07383441925048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07383441925048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 179043
first layer output nodes number: 52636
edges number: 510137
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07588720321655273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([179043, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07588720321655273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07588720321655273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09949350357055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09949350357055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14969110488891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52636, 256])
h_self size  torch.Size([52636, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14969110488891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52636, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1998887062072754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14969110488891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52636, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1998887062072754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21243810653686523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52636
----------------output nodes number: 6047
----------------edges number: 141813
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2128758430480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2128758430480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21974515914916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21974515914916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2210087776184082  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6047, 47])
h_self size  torch.Size([6047, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2210087776184082  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6047, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22206783294677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22080421447753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6047, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2209630012512207  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22206830978393555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08281421661376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 4 input nodes size: 283872
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06913042068481445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06913042068481445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1748809814453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1749258041381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10818147659301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11450529098510742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11450529098510742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 283872
first layer output nodes number: 63910
edges number: 621890
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1170969009399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([283872, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1170969009399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1170969009399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14577770233154297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14577770233154297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2067270278930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63910, 256])
h_self size  torch.Size([63910, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2067270278930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63910, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26767635345458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2067270278930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63910, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26767635345458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2829136848449707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63910
----------------output nodes number: 5963
----------------edges number: 133697
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2834348678588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2834348678588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2901630401611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2901630401611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2914705276489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2914705276489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.29302120208740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2917137145996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.29175758361816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.29330873489379883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12478828430175781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 5 input nodes size: 202859
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10822534561157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10822534561157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18379640579223633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18384122848510742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07804584503173828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08372783660888672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08372783660888672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 202859
first layer output nodes number: 57214
edges number: 565157
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08566570281982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([202859, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08566570281982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08566570281982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11174488067626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11174488067626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16630840301513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57214, 256])
h_self size  torch.Size([57214, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16630840301513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57214, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2208719253540039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16630840301513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57214, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2208719253540039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2345128059387207  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57214
----------------output nodes number: 6016
----------------edges number: 137097
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2349839210510254  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2349839210510254  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2417888641357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2417888641357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24311590194702148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6016, 47])
h_self size  torch.Size([6016, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24311590194702148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6016, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24474763870239258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24342060089111328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6016, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24316644668579102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24449396133422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09258794784545898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 6 input nodes size: 243453
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07779169082641602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07779169082641602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16848516464233398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16852998733520508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09291410446166992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09903717041015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09903717041015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 243453
first layer output nodes number: 61731
edges number: 609869
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10131120681762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([243453, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10131120681762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10131120681762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12908267974853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12908267974853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18795394897460938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([61731, 256])
h_self size  torch.Size([61731, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18795394897460938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61731, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2468252182006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18795394897460938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61731, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2468252182006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26154327392578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 61731
----------------output nodes number: 5987
----------------edges number: 142050
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26204824447631836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26204824447631836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2688612937927246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2688612937927246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26996469497680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5987, 47])
h_self size  torch.Size([5987, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26996469497680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5987, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2716403007507324  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2705368995666504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5987, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2705869674682617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2722630500793457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10901069641113281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 7 input nodes size: 237909
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09296417236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09296417236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18159246444702148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18163824081420898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09089994430541992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0960993766784668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0960993766784668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 237909
first layer output nodes number: 56120
edges number: 554003
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09829044342041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([237909, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09829044342041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09829044342041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1235346794128418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1235346794128418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17705488204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([56120, 256])
h_self size  torch.Size([56120, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17705488204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56120, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2305750846862793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17705488204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56120, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2305750846862793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24395513534545898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 56120
----------------output nodes number: 6083
----------------edges number: 143700
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24441909790039062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24441909790039062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25133705139160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25133705139160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25249290466308594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6083, 47])
h_self size  torch.Size([6083, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25249290466308594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6083, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2543320655822754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.253176212310791  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6083, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25313806533813477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25429439544677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10542821884155273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 8 input nodes size: 203108
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09086179733276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09086179733276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16652584075927734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16657304763793945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07789897918701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08388519287109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08388519287109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 203108
first layer output nodes number: 63969
edges number: 633619
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08620119094848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([203108, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08620119094848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08620119094848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11499166488647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11499166488647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17599725723266602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63969, 256])
h_self size  torch.Size([63969, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17599725723266602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63969, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23700284957885742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17599725723266602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63969, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23700284957885742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2522544860839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63969
----------------output nodes number: 6288
----------------edges number: 156236
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2527785301208496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2527785301208496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25998735427856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25998735427856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26148176193237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6288, 47])
h_self size  torch.Size([6288, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26148176193237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6288, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26258277893066406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26108837127685547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6288, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2615175247192383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2630124092102051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09470558166503906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 9 input nodes size: 190629
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07832813262939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07832813262939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14934301376342773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14938974380493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07367849349975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07935953140258789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07935953140258789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 190629
first layer output nodes number: 61613
edges number: 607560
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08123922348022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([190629, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08123922348022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08123922348022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10949087142944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10949087142944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16824960708618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([61613, 256])
h_self size  torch.Size([61613, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16824960708618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61613, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22700834274291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16824960708618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61613, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22700834274291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2416982650756836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 61613
----------------output nodes number: 6250
----------------edges number: 154876
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2422041893005371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2422041893005371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24936532974243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24936532974243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25115346908569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6250, 47])
h_self size  torch.Size([6250, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25115346908569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6250, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25224781036376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2504596710205078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6250, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25075340270996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25254201889038086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08989858627319336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 10 input nodes size: 241429
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07397222518920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07397222518920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1639118194580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16395902633666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09289741516113281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09909629821777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09909629821777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 241429
first layer output nodes number: 68177
edges number: 675536
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10146188735961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([241429, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10146188735961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10146188735961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13214778900146484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13214778900146484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19716644287109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68177, 256])
h_self size  torch.Size([68177, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19716644287109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68177, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26218509674072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19716644287109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68177, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26218509674072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.278439998626709  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68177
----------------output nodes number: 6313
----------------edges number: 156378
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2789955139160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2789955139160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28673267364501953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28673267364501953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28804826736450195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6313, 47])
h_self size  torch.Size([6313, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28804826736450195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28943586349487305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2881202697753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28764772415161133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2890357971191406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10944128036499023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 11 input nodes size: 265867
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09242486953735352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09242486953735352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1914682388305664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19151544570922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10152864456176758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10805940628051758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10805940628051758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 265867
first layer output nodes number: 72559
edges number: 720599
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11111927032470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([265867, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11111927032470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11111927032470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14378929138183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14378929138183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21298694610595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([72559, 256])
h_self size  torch.Size([72559, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21298694610595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([72559, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2821846008300781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21298694610595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([72559, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2821846008300781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2994842529296875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 72559
----------------output nodes number: 6281
----------------edges number: 155853
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30007219314575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30007219314575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30750036239624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30750036239624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3087000846862793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6281, 47])
h_self size  torch.Size([6281, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3087000846862793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6281, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3098316192626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30863189697265625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6281, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30841636657714844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30951690673828125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11974859237670898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 12 input nodes size: 186496
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10131311416625977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10131311416625977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17078828811645508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17083311080932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07174253463745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07688283920288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07688283920288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 186496
first layer output nodes number: 54688
edges number: 541593
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07868003845214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([186496, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07868003845214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07868003845214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10329294204711914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10329294204711914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15544748306274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([54688, 256])
h_self size  torch.Size([54688, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15544748306274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54688, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20760202407836914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15544748306274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54688, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20760202407836914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2206406593322754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 54688
----------------output nodes number: 5963
----------------edges number: 148221
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22109317779541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22109317779541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2286815643310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2286815643310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2298130989074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2298130989074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23085737228393555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22972583770751953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22975730895996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23093652725219727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08583927154541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 13 input nodes size: 158786
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07177400588989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07177400588989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13092660903930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13097381591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.061453819274902344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06692314147949219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06692314147949219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 158786
first layer output nodes number: 58246
edges number: 576718
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06875181198120117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([158786, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06875181198120117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06875181198120117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09535408020019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09535408020019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15090179443359375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58246, 256])
h_self size  torch.Size([58246, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15090179443359375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58246, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2064495086669922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15090179443359375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58246, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2064495086669922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2203364372253418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58246
----------------output nodes number: 6313
----------------edges number: 157279
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22081804275512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22081804275512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2280583381652832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2280583381652832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22916412353515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6313, 47])
h_self size  torch.Size([6313, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22916412353515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2302699089050293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22916412353515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22997283935546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2310791015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07753133773803711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 14 input nodes size: 226263
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.062262535095214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.062262535095214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14655208587646484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14659690856933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08739709854125977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09328317642211914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09328317642211914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 226263
first layer output nodes number: 64768
edges number: 641757
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09545183181762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([226263, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09545183181762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09545183181762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.124603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.124603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.187103271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64768, 256])
h_self size  torch.Size([64768, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.187103271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64768, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.249603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.187103271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64768, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.249603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.265045166015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64768
----------------output nodes number: 5963
----------------edges number: 148111
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26557254791259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26557254791259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27240848541259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27240848541259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2738313674926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2738313674926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2748756408691406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2734527587890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27255678176879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2738676071166992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10257959365844727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 15 input nodes size: 264034
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0865011215209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0865011215209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1848616600036621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18490886688232422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10057449340820312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10765790939331055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10765790939331055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 264034
first layer output nodes number: 73274
edges number: 726718
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11055850982666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([264034, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11055850982666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11055850982666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14354372024536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14354372024536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2134232521057129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([73274, 256])
h_self size  torch.Size([73274, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2134232521057129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([73274, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28330278396606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2134232521057129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([73274, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28330278396606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30077266693115234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 73274
----------------output nodes number: 6327
----------------edges number: 157457
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30136585235595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30136585235595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3086214065551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3086214065551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3099551200866699  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.3099551200866699  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.311063289642334  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.30972957611083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.31001901626586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.31208086013793945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11977434158325195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 16 input nodes size: 203621
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10086393356323242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10086393356323242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17671871185302734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17676353454589844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07835578918457031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08385181427001953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08385181427001953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 203621
first layer output nodes number: 60078
edges number: 585325
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08581686019897461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([203621, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08581686019897461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08581686019897461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11278295516967773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11278295516967773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17007780075073242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([60078, 256])
h_self size  torch.Size([60078, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17007780075073242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60078, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2273726463317871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17007780075073242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60078, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2273726463317871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24169635772705078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 60078
----------------output nodes number: 5963
----------------edges number: 140242
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2421889305114746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2421889305114746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24896574020385742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24896574020385742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25026464462280273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25026464462280273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2513089179992676  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25001001358032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24997520446777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25127458572387695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09319686889648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 17 input nodes size: 138022
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07832098007202148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07832098007202148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12973833084106445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12978553771972656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05388593673706055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05831003189086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05831003189086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 138022
first layer output nodes number: 45012
edges number: 438963
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05967426300048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([138022, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05967426300048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05967426300048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07988166809082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07988166809082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12285041809082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([45012, 256])
h_self size  torch.Size([45012, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12285041809082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45012, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1658191680908203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12285041809082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45012, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1658191680908203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17655086517333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 45012
----------------output nodes number: 6293
----------------edges number: 154657
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17693376541137695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17693376541137695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18413591384887695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18413591384887695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1857137680053711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6293, 47])
h_self size  torch.Size([6293, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1857137680053711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6293, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18737459182739258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18579673767089844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6293, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18559980392456055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18670225143432617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0657968521118164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 18 input nodes size: 114510
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.053689002990722656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.053689002990722656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09665775299072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09670257568359375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04523801803588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.049544334411621094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.049544334411621094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 114510
first layer output nodes number: 44033
edges number: 426649
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05072641372680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([114510, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05072641372680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05072641372680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07134580612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07134580612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11431455612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([44033, 256])
h_self size  torch.Size([44033, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11431455612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44033, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15728330612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11431455612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44033, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15728330612182617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1684107780456543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 44033
----------------output nodes number: 5991
----------------edges number: 141580
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16878414154052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16878414154052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17559814453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17559814453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17664718627929688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5991, 47])
h_self size  torch.Size([5991, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17664718627929688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5991, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17769622802734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17664718627929688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5991, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17659425735473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17769670486450195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05756092071533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 19 input nodes size: 153629
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.045185089111328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.045185089111328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1024165153503418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10246133804321289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0594477653503418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06445789337158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06445789337158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 153629
first layer output nodes number: 51873
edges number: 504458
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0662069320678711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([153629, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0662069320678711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0662069320678711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08948421478271484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08948421478271484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13895416259765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([51873, 256])
h_self size  torch.Size([51873, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13895416259765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51873, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18842411041259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13895416259765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51873, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18842411041259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2007918357849121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 51873
----------------output nodes number: 5969
----------------edges number: 141103
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20122337341308594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20122337341308594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20801258087158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20801258087158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20905780792236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5969, 47])
h_self size  torch.Size([5969, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20905780792236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21039867401123047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20935344696044922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2093496322631836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21039533615112305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0729074478149414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 20 input nodes size: 185803
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05944395065307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05944395065307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1286611557006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1287074089050293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07143115997314453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07724761962890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07724761962890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 185803
first layer output nodes number: 62057
edges number: 615420
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07909488677978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([185803, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07909488677978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07909488677978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10767507553100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10767507553100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16685724258422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62057, 256])
h_self size  torch.Size([62057, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16685724258422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62057, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22603940963745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16685724258422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62057, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22603940963745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24083518981933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62057
----------------output nodes number: 6145
----------------edges number: 152577
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24134397506713867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24134397506713867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24838876724243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24838876724243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24975347518920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6145, 47])
h_self size  torch.Size([6145, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24975347518920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6145, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25082969665527344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2494649887084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6145, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2497844696044922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25114965438842773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08791494369506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 21 input nodes size: 172318
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07175064086914062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07175064086914062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13620376586914062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13624906539916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0669856071472168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0718379020690918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0718379020690918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 172318
first layer output nodes number: 51475
edges number: 502629
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07350587844848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([172318, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07350587844848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07350587844848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09697437286376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09697437286376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14606475830078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([51475, 256])
h_self size  torch.Size([51475, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14606475830078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51475, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19515514373779297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14606475830078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51475, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19515514373779297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.207427978515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 51475
----------------output nodes number: 6050
----------------edges number: 148491
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2078571319580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2078571319580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21477985382080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21477985382080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2160935401916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6050, 47])
h_self size  torch.Size([6050, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2160935401916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6050, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21715307235717773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21583938598632812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6050, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2157883644104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21750926971435547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08025074005126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 22 input nodes size: 208164
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06693458557128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06693458557128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14505958557128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14510679244995117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08060836791992188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08653926849365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08653926849365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 208164
first layer output nodes number: 64352
edges number: 638844
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08857011795043945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([208164, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08857011795043945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08857011795043945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11754274368286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11754274368286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17891359329223633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64352, 256])
h_self size  torch.Size([64352, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17891359329223633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64352, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24028444290161133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17891359329223633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64352, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24028444290161133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2556271553039551  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64352
----------------output nodes number: 6320
----------------edges number: 157088
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25615406036376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25615406036376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2634000778198242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2634000778198242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2645292282104492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6320, 47])
h_self size  torch.Size([6320, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2645292282104492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6320, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26563596725463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26450681686401367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6320, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26432228088378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26545190811157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09651803970336914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 23 input nodes size: 168303
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08042383193969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08042383193969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14312171936035156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14316892623901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06499671936035156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0705118179321289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0705118179321289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 168303
first layer output nodes number: 58951
edges number: 584107
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07270669937133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([168303, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07270669937133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07270669937133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09940862655639648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09940862655639648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15562868118286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58951, 256])
h_self size  torch.Size([58951, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15562868118286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58951, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21184873580932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15562868118286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58951, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21184873580932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22590398788452148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58951
----------------output nodes number: 6284
----------------edges number: 155939
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22639083862304688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22639083862304688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23359394073486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23359394073486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2346944808959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6284, 47])
h_self size  torch.Size([6284, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2346944808959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6284, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2357950210571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2346944808959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6284, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23483848571777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23593950271606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08064699172973633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 24 input nodes size: 183838
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0651407241821289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0651407241821289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13362598419189453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13367271423339844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07092761993408203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07605552673339844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07605552673339844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 183838
first layer output nodes number: 55829
edges number: 537043
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([183838, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10311651229858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10311651229858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15635919570922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55829, 256])
h_self size  torch.Size([55829, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15635919570922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55829, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20960187911987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15635919570922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55829, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20960187911987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22291278839111328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55829
----------------output nodes number: 6261
----------------edges number: 151164
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22337579727172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22337579727172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23051977157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23051977157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23189210891723633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6261, 47])
h_self size  torch.Size([6261, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23189210891723633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6261, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2329883575439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23161602020263672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6261, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23143911361694336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23281192779541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08508872985839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 25 input nodes size: 232064
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07075071334838867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07075071334838867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15720129013061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15724754333496094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0887155532836914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09535646438598633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09535646438598633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 232064
first layer output nodes number: 65642
edges number: 633728
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09757471084594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([232064, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09757471084594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09757471084594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12699460983276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12699460983276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18959569931030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([65642, 256])
h_self size  torch.Size([65642, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18959569931030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65642, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2521967887878418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18959569931030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65642, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2521967887878418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26784706115722656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 65642
----------------output nodes number: 6160
----------------edges number: 148828
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26838254928588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26838254928588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27541303634643555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27541303634643555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2766695022583008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6160, 47])
h_self size  torch.Size([6160, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2766695022583008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2785215377807617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2772650718688965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6160, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.27742528915405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2792778015136719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10572290420532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 26 input nodes size: 173355
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08887577056884766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08887577056884766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1534557342529297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1535029411315918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06700611114501953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07226085662841797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07226085662841797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 173355
first layer output nodes number: 57274
edges number: 551868
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07451391220092773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([173355, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07451391220092773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07451391220092773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10047197341918945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10047197341918945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15509271621704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57274, 256])
h_self size  torch.Size([57274, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15509271621704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57274, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20971345901489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15509271621704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57274, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20971345901489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22336864471435547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57274
----------------output nodes number: 6326
----------------edges number: 153234
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22384262084960938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22384262084960938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2310657501220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2310657501220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23219537734985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6326, 47])
h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23219537734985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23330307006835938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23217344284057617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2320246696472168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2331547737121582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08168745040893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 27 input nodes size: 209239
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06685733795166016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06685733795166016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14498233795166016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14502716064453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08039999008178711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08652782440185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08652782440185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 209239
first layer output nodes number: 60767
edges number: 590315
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08854007720947266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([209239, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08854007720947266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08854007720947266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11642742156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11642742156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17502117156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([60767, 256])
h_self size  torch.Size([60767, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17502117156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60767, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23361492156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17502117156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60767, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23361492156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24810314178466797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 60767
----------------output nodes number: 5963
----------------edges number: 142671
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24860095977783203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24860095977783203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25539588928222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25539588928222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2564401626586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2564401626586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25748443603515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2564401626586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25724267959594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2582874298095703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09746551513671875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 28 input nodes size: 176660
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08120250701904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08120250701904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14760875701904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14765357971191406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06948375701904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0743551254272461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0743551254272461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 176660
first layer output nodes number: 52861
edges number: 508420
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0760655403137207  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([176660, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0760655403137207  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0760655403137207  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09974384307861328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09974384307861328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15015602111816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52861, 256])
h_self size  torch.Size([52861, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15015602111816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52861, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20056819915771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15015602111816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52861, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20056819915771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21317148208618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52861
----------------output nodes number: 6011
----------------edges number: 145182
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21361017227172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21361017227172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22046995162963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22046995162963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22157621383666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6011, 47])
h_self size  torch.Size([6011, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22157621383666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6011, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22297239303588867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22186613082885742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6011, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2210087776184082  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22211551666259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0820169448852539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 29 input nodes size: 142173
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06862640380859375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06862640380859375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12159013748168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12163639068603516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05518531799316406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.059723854064941406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.059723854064941406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 142173
first layer output nodes number: 47781
edges number: 460905
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06147623062133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([142173, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06147623062133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06147623062133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08290290832519531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08290290832519531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12847042083740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([47781, 256])
h_self size  torch.Size([47781, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12847042083740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47781, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17403793334960938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12847042083740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47781, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17403793334960938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18543004989624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 47781
----------------output nodes number: 6166
----------------edges number: 148122
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18583250045776367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18583250045776367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19286394119262695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19286394119262695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19432783126831055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6166, 47])
h_self size  torch.Size([6166, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19432783126831055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6166, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19540786743164062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19394397735595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6166, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19435501098632812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19602727890014648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06832695007324219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 30 input nodes size: 189557
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.055596351623535156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.055596351623535156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12621212005615234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12625932693481445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07324934005737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07901477813720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07901477813720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 189557
first layer output nodes number: 60204
edges number: 584762
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([189557, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10803556442260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10803556442260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1654505729675293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([60204, 256])
h_self size  torch.Size([60204, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1654505729675293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60204, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22286558151245117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1654505729675293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60204, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22286558151245117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23721933364868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 60204
----------------output nodes number: 6291
----------------edges number: 152696
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2377152442932129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2377152442932129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24490022659301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24490022659301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2460789680480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6291, 47])
h_self size  torch.Size([6291, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2460789680480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6291, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24718046188354492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2460017204284668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6291, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24571657180786133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.24689579010009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08834218978881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 31 input nodes size: 180096
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07296419143676758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07296419143676758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14005517959594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14010000228881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06943702697753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07407855987548828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07407855987548828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 180096
first layer output nodes number: 48852
edges number: 476228
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07578468322753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([180096, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07578468322753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07578468322753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09771442413330078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09771442413330078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1443033218383789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([48852, 256])
h_self size  torch.Size([48852, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1443033218383789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([48852, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19089221954345703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1443033218383789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([48852, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.19089221954345703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20253944396972656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 48852
----------------output nodes number: 6005
----------------edges number: 146623
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20294857025146484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20294857025146484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20981311798095703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20981311798095703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21108150482177734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6005, 47])
h_self size  torch.Size([6005, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21108150482177734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6005, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21213293075561523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21086454391479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6005, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21087360382080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2121424674987793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08232402801513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08232402801513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08232402801513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03411589562892914 |0.00487864762544632 |0.010864198207855225 |0.00013152509927749634 |0.002623133361339569 |0.0010755062103271484 |
----------------------------------------------------------pseudo_mini_loss sum 3.4496264457702637
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8140151
Number of first layer input nodes during this epoch:  6273402
Number of first layer output nodes during this epoch:  1866749
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08232355117797852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2796947956085205
global_2_local spend time (sec) 0.46924304962158203

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.421 seconds
Metis partitioning: 13.842 seconds
Split the graph: 0.895 seconds
Construct subgraphs: 0.364 seconds
6146
6106
6305
6304
5969
5986
5963
5999
5963
5996
6245
6290
6322
5963
6326
6025
6313
5964
6110
6327
5963
6326
6176
6296
6076
6006
5990
6327
6172
5965
6326
6326
REG metis partition end ----................................
the time spent:  27.818702697753906
total k batches seeds list generation spend  28.338757038116455
after graph partition
graph partition algorithm spend time 28.80169177055359

partition_len_list
[63490, 68871, 63788, 44681, 54076, 44797, 55646, 52743, 70509, 49433, 55932, 46721, 65333, 59148, 67012, 63140, 59219, 54744, 59375, 74047, 71127, 64213, 63192, 63414, 51926, 55350, 64848, 64240, 49616, 55775, 58324, 57421]
REG selection method  spend 29.487860441207886
check_connections_block*********************************
time for parepare 1: 0.22789359092712402
local_output_nid generation: 0.0022630691528320312
local_in_edges_tensor generation: 0.0025556087493896484
mini_batch_src_global generation: 0.004949808120727539

&&&&&&&&&&&&&&& before remove duplicate length: 152922
r_  generation: 0.05009961128234863

local_output_nid generation: 0.0025491714477539062
local_in_edges_tensor generation: 0.002469778060913086
mini_batch_src_global generation: 0.00603938102722168

&&&&&&&&&&&&&&& before remove duplicate length: 151762
r_  generation: 0.06362533569335938

local_output_nid generation: 0.0026624202728271484
local_in_edges_tensor generation: 0.010071039199829102
mini_batch_src_global generation: 0.004813671112060547

&&&&&&&&&&&&&&& before remove duplicate length: 156248
r_  generation: 0.0552217960357666

local_output_nid generation: 0.002696990966796875
local_in_edges_tensor generation: 0.0065953731536865234
mini_batch_src_global generation: 0.004773378372192383

&&&&&&&&&&&&&&& before remove duplicate length: 155059
r_  generation: 0.054465532302856445

local_output_nid generation: 0.002557992935180664
local_in_edges_tensor generation: 0.004281759262084961
mini_batch_src_global generation: 0.0047359466552734375

&&&&&&&&&&&&&&& before remove duplicate length: 142238
r_  generation: 0.04954361915588379

local_output_nid generation: 0.0026023387908935547
local_in_edges_tensor generation: 0.003384113311767578
mini_batch_src_global generation: 0.004724264144897461

&&&&&&&&&&&&&&& before remove duplicate length: 141584
r_  generation: 0.04968667030334473

local_output_nid generation: 0.0025615692138671875
local_in_edges_tensor generation: 0.0028922557830810547
mini_batch_src_global generation: 0.004588127136230469

&&&&&&&&&&&&&&& before remove duplicate length: 138445
r_  generation: 0.050902366638183594

local_output_nid generation: 0.0025713443756103516
local_in_edges_tensor generation: 0.0034706592559814453
mini_batch_src_global generation: 0.005121707916259766

&&&&&&&&&&&&&&& before remove duplicate length: 147723
r_  generation: 0.05392146110534668

local_output_nid generation: 0.002568483352661133
local_in_edges_tensor generation: 0.002544403076171875
mini_batch_src_global generation: 0.004934549331665039

&&&&&&&&&&&&&&& before remove duplicate length: 136742
r_  generation: 0.0495607852935791

local_output_nid generation: 0.002575397491455078
local_in_edges_tensor generation: 0.0025064945220947266
mini_batch_src_global generation: 0.005363941192626953

&&&&&&&&&&&&&&& before remove duplicate length: 145881
r_  generation: 0.052150726318359375

local_output_nid generation: 0.0026671886444091797
local_in_edges_tensor generation: 0.0025763511657714844
mini_batch_src_global generation: 0.0049591064453125

&&&&&&&&&&&&&&& before remove duplicate length: 147386
r_  generation: 0.053516387939453125

local_output_nid generation: 0.0027229785919189453
local_in_edges_tensor generation: 0.0024874210357666016
mini_batch_src_global generation: 0.005758047103881836

&&&&&&&&&&&&&&& before remove duplicate length: 149575
r_  generation: 0.05257773399353027

local_output_nid generation: 0.0027000904083251953
local_in_edges_tensor generation: 0.002641916275024414
mini_batch_src_global generation: 0.005378007888793945

&&&&&&&&&&&&&&& before remove duplicate length: 154369
r_  generation: 0.05719137191772461

local_output_nid generation: 0.002596616744995117
local_in_edges_tensor generation: 0.0022935867309570312
mini_batch_src_global generation: 0.005083799362182617

&&&&&&&&&&&&&&& before remove duplicate length: 123090
r_  generation: 0.044846296310424805

local_output_nid generation: 0.002681255340576172
local_in_edges_tensor generation: 0.002531290054321289
mini_batch_src_global generation: 0.0052525997161865234

&&&&&&&&&&&&&&& before remove duplicate length: 157207
r_  generation: 0.059836387634277344

local_output_nid generation: 0.0025932788848876953
local_in_edges_tensor generation: 0.002459287643432617
mini_batch_src_global generation: 0.0056819915771484375

&&&&&&&&&&&&&&& before remove duplicate length: 143923
r_  generation: 0.05176115036010742

local_output_nid generation: 0.0026869773864746094
local_in_edges_tensor generation: 0.002524852752685547
mini_batch_src_global generation: 0.005639553070068359

&&&&&&&&&&&&&&& before remove duplicate length: 157314
r_  generation: 0.05924797058105469

local_output_nid generation: 0.00257110595703125
local_in_edges_tensor generation: 0.0024607181549072266
mini_batch_src_global generation: 0.005816459655761719

&&&&&&&&&&&&&&& before remove duplicate length: 148030
r_  generation: 0.05886697769165039

local_output_nid generation: 0.0026319026947021484
local_in_edges_tensor generation: 0.002456188201904297
mini_batch_src_global generation: 0.005547523498535156

&&&&&&&&&&&&&&& before remove duplicate length: 151243
r_  generation: 0.05663609504699707

local_output_nid generation: 0.002698659896850586
local_in_edges_tensor generation: 0.002521991729736328
mini_batch_src_global generation: 0.006100177764892578

&&&&&&&&&&&&&&& before remove duplicate length: 157349
r_  generation: 0.060042381286621094

local_output_nid generation: 0.0025839805603027344
local_in_edges_tensor generation: 0.0024547576904296875
mini_batch_src_global generation: 0.005625724792480469

&&&&&&&&&&&&&&& before remove duplicate length: 147423
r_  generation: 0.05709242820739746

local_output_nid generation: 0.002695322036743164
local_in_edges_tensor generation: 0.00254058837890625
mini_batch_src_global generation: 0.005906105041503906

&&&&&&&&&&&&&&& before remove duplicate length: 157244
r_  generation: 0.06063985824584961

local_output_nid generation: 0.0026357173919677734
local_in_edges_tensor generation: 0.0027115345001220703
mini_batch_src_global generation: 0.005993366241455078

&&&&&&&&&&&&&&& before remove duplicate length: 152887
r_  generation: 0.06134676933288574

local_output_nid generation: 0.00510716438293457
local_in_edges_tensor generation: 0.002500295639038086
mini_batch_src_global generation: 0.006064176559448242

&&&&&&&&&&&&&&& before remove duplicate length: 156385
r_  generation: 0.060484886169433594

local_output_nid generation: 0.002645730972290039
local_in_edges_tensor generation: 0.0024335384368896484
mini_batch_src_global generation: 0.0057849884033203125

&&&&&&&&&&&&&&& before remove duplicate length: 148848
r_  generation: 0.056169986724853516

local_output_nid generation: 0.0026006698608398438
local_in_edges_tensor generation: 0.0023965835571289062
mini_batch_src_global generation: 0.005561113357543945

&&&&&&&&&&&&&&& before remove duplicate length: 146729
r_  generation: 0.0540313720703125

local_output_nid generation: 0.0025572776794433594
local_in_edges_tensor generation: 0.0028231143951416016
mini_batch_src_global generation: 0.005510091781616211

&&&&&&&&&&&&&&& before remove duplicate length: 146049
r_  generation: 0.05586886405944824

local_output_nid generation: 0.00269317626953125
local_in_edges_tensor generation: 0.002504587173461914
mini_batch_src_global generation: 0.006150007247924805

&&&&&&&&&&&&&&& before remove duplicate length: 152506
r_  generation: 0.06022357940673828

local_output_nid generation: 0.0026526451110839844
local_in_edges_tensor generation: 0.0026197433471679688
mini_batch_src_global generation: 0.005800962448120117

&&&&&&&&&&&&&&& before remove duplicate length: 148499
r_  generation: 0.05577540397644043

local_output_nid generation: 0.0025696754455566406
local_in_edges_tensor generation: 0.0027861595153808594
mini_batch_src_global generation: 0.005568981170654297

&&&&&&&&&&&&&&& before remove duplicate length: 144037
r_  generation: 0.05413413047790527

local_output_nid generation: 0.002691507339477539
local_in_edges_tensor generation: 0.0024864673614501953
mini_batch_src_global generation: 0.005765676498413086

&&&&&&&&&&&&&&& before remove duplicate length: 152753
r_  generation: 0.05711197853088379

local_output_nid generation: 0.0027031898498535156
local_in_edges_tensor generation: 0.0025212764739990234
mini_batch_src_global generation: 0.0056972503662109375

&&&&&&&&&&&&&&& before remove duplicate length: 152429
r_  generation: 0.05736207962036133


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6958215236663818
gen group dst list time:  0.06751728057861328
check_connections_block*********************************
time for parepare 1: 0.3622095584869385
local_output_nid generation: 0.017577648162841797
local_in_edges_tensor generation: 0.07150650024414062
mini_batch_src_global generation: 0.022916793823242188

&&&&&&&&&&&&&&& before remove duplicate length: 629706
r_  generation: 0.25106310844421387

local_output_nid generation: 0.022627830505371094
local_in_edges_tensor generation: 0.024801969528198242
mini_batch_src_global generation: 0.030928850173950195

&&&&&&&&&&&&&&& before remove duplicate length: 683597
r_  generation: 0.29018688201904297

local_output_nid generation: 0.020367860794067383
local_in_edges_tensor generation: 0.019500255584716797
mini_batch_src_global generation: 0.02610301971435547

&&&&&&&&&&&&&&& before remove duplicate length: 632331
r_  generation: 0.2817354202270508

local_output_nid generation: 0.014396429061889648
local_in_edges_tensor generation: 0.017439603805541992
mini_batch_src_global generation: 0.033149003982543945

&&&&&&&&&&&&&&& before remove duplicate length: 435478
r_  generation: 0.19398999214172363

local_output_nid generation: 0.017974138259887695
local_in_edges_tensor generation: 0.01940441131591797
mini_batch_src_global generation: 0.025234222412109375

&&&&&&&&&&&&&&& before remove duplicate length: 527831
r_  generation: 0.23148679733276367

local_output_nid generation: 0.014523744583129883
local_in_edges_tensor generation: 0.012072086334228516
mini_batch_src_global generation: 0.02359318733215332

&&&&&&&&&&&&&&& before remove duplicate length: 434388
r_  generation: 0.18751096725463867

local_output_nid generation: 0.017578840255737305
local_in_edges_tensor generation: 0.017632722854614258
mini_batch_src_global generation: 0.02620673179626465

&&&&&&&&&&&&&&& before remove duplicate length: 539131
r_  generation: 0.2360379695892334

local_output_nid generation: 0.015857696533203125
local_in_edges_tensor generation: 0.016675233840942383
mini_batch_src_global generation: 0.026436567306518555

&&&&&&&&&&&&&&& before remove duplicate length: 519937
r_  generation: 0.22025203704833984

local_output_nid generation: 0.0226290225982666
local_in_edges_tensor generation: 0.022678613662719727
mini_batch_src_global generation: 0.03154182434082031

&&&&&&&&&&&&&&& before remove duplicate length: 690738
r_  generation: 0.34143853187561035

local_output_nid generation: 0.01652812957763672
local_in_edges_tensor generation: 0.014203071594238281
mini_batch_src_global generation: 0.027657270431518555

&&&&&&&&&&&&&&& before remove duplicate length: 487237
r_  generation: 0.22764134407043457

local_output_nid generation: 0.01712179183959961
local_in_edges_tensor generation: 0.06352901458740234
mini_batch_src_global generation: 0.0269930362701416

&&&&&&&&&&&&&&& before remove duplicate length: 543347
r_  generation: 0.27137327194213867

local_output_nid generation: 0.013866662979125977
local_in_edges_tensor generation: 0.018126487731933594
mini_batch_src_global generation: 0.025931596755981445

&&&&&&&&&&&&&&& before remove duplicate length: 446101
r_  generation: 0.19425749778747559

local_output_nid generation: 0.019455432891845703
local_in_edges_tensor generation: 0.028469085693359375
mini_batch_src_global generation: 0.028212308883666992

&&&&&&&&&&&&&&& before remove duplicate length: 643839
r_  generation: 0.3188333511352539

local_output_nid generation: 0.02659893035888672
local_in_edges_tensor generation: 0.025775909423828125
mini_batch_src_global generation: 0.032802581787109375

&&&&&&&&&&&&&&& before remove duplicate length: 574371
r_  generation: 0.278533935546875

local_output_nid generation: 0.021141529083251953
local_in_edges_tensor generation: 0.019693613052368164
mini_batch_src_global generation: 0.03125405311584473

&&&&&&&&&&&&&&& before remove duplicate length: 665681
r_  generation: 0.32918405532836914

local_output_nid generation: 0.02144646644592285
local_in_edges_tensor generation: 0.023680448532104492
mini_batch_src_global generation: 0.031763315200805664

&&&&&&&&&&&&&&& before remove duplicate length: 625231
r_  generation: 0.31092190742492676

local_output_nid generation: 0.019843578338623047
local_in_edges_tensor generation: 0.018645763397216797
mini_batch_src_global generation: 0.030805110931396484

&&&&&&&&&&&&&&& before remove duplicate length: 586099
r_  generation: 0.281325101852417

local_output_nid generation: 0.028516530990600586
local_in_edges_tensor generation: 0.014864206314086914
mini_batch_src_global generation: 0.028981924057006836

&&&&&&&&&&&&&&& before remove duplicate length: 540764
r_  generation: 0.26755404472351074

local_output_nid generation: 0.02044367790222168
local_in_edges_tensor generation: 0.01618170738220215
mini_batch_src_global generation: 0.030556201934814453

&&&&&&&&&&&&&&& before remove duplicate length: 588094
r_  generation: 0.27390289306640625

local_output_nid generation: 0.02483224868774414
local_in_edges_tensor generation: 0.025157928466796875
mini_batch_src_global generation: 0.0356903076171875

&&&&&&&&&&&&&&& before remove duplicate length: 734584
r_  generation: 0.3644528388977051

local_output_nid generation: 0.02371501922607422
local_in_edges_tensor generation: 0.023730039596557617
mini_batch_src_global generation: 0.03664803504943848

&&&&&&&&&&&&&&& before remove duplicate length: 701890
r_  generation: 0.3545691967010498

local_output_nid generation: 0.021120309829711914
local_in_edges_tensor generation: 0.016952037811279297
mini_batch_src_global generation: 0.03285074234008789

&&&&&&&&&&&&&&& before remove duplicate length: 637112
r_  generation: 0.32351183891296387

local_output_nid generation: 0.02039313316345215
local_in_edges_tensor generation: 0.01652669906616211
mini_batch_src_global generation: 0.03423929214477539

&&&&&&&&&&&&&&& before remove duplicate length: 623467
r_  generation: 0.30831217765808105

local_output_nid generation: 0.020341873168945312
local_in_edges_tensor generation: 0.022502660751342773
mini_batch_src_global generation: 0.03422045707702637

&&&&&&&&&&&&&&& before remove duplicate length: 627340
r_  generation: 0.3180661201477051

local_output_nid generation: 0.017978906631469727
local_in_edges_tensor generation: 0.016885757446289062
mini_batch_src_global generation: 0.029426097869873047

&&&&&&&&&&&&&&& before remove duplicate length: 505020
r_  generation: 0.24346685409545898

local_output_nid generation: 0.019337892532348633
local_in_edges_tensor generation: 0.016672134399414062
mini_batch_src_global generation: 0.029520034790039062

&&&&&&&&&&&&&&& before remove duplicate length: 539974
r_  generation: 0.2892646789550781

local_output_nid generation: 0.021406888961791992
local_in_edges_tensor generation: 0.04261946678161621
mini_batch_src_global generation: 0.03337287902832031

&&&&&&&&&&&&&&& before remove duplicate length: 633319
r_  generation: 0.34393858909606934

local_output_nid generation: 0.0387730598449707
local_in_edges_tensor generation: 0.02260565757751465
mini_batch_src_global generation: 0.03220224380493164

&&&&&&&&&&&&&&& before remove duplicate length: 621946
r_  generation: 0.31830263137817383

local_output_nid generation: 0.020527124404907227
local_in_edges_tensor generation: 0.016059160232543945
mini_batch_src_global generation: 0.02891254425048828

&&&&&&&&&&&&&&& before remove duplicate length: 479496
r_  generation: 0.22913575172424316

local_output_nid generation: 0.019301414489746094
local_in_edges_tensor generation: 0.016463041305541992
mini_batch_src_global generation: 0.027704238891601562

&&&&&&&&&&&&&&& before remove duplicate length: 537354
r_  generation: 0.2712557315826416

local_output_nid generation: 0.019717693328857422
local_in_edges_tensor generation: 0.0175478458404541
mini_batch_src_global generation: 0.03245806694030762

&&&&&&&&&&&&&&& before remove duplicate length: 561541
r_  generation: 0.267153263092041

local_output_nid generation: 0.019068002700805664
local_in_edges_tensor generation: 0.015388965606689453
mini_batch_src_global generation: 0.02907538414001465

&&&&&&&&&&&&&&& before remove duplicate length: 551649
r_  generation: 0.2664499282836914


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08232355117797852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

connection checking time:  16.41311740875244
block generation total time  13.552324771881104
average batch blocks generation time:  0.4235101491212845
block dataloader generation time/epoch 61.37364339828491
pseudo mini batch 0 input nodes size: 211062
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06944513320922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06944513320922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1480722427368164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1481184959411621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08098268508911133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08681440353393555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08681440353393555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 211062
first layer output nodes number: 63490
edges number: 629706
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08886051177978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([211062, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08886051177978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08886051177978516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11744165420532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11744165420532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17799043655395508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63490, 256])
h_self size  torch.Size([63490, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17799043655395508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63490, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2385392189025879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17799043655395508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63490, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2385392189025879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2536764144897461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63490
----------------output nodes number: 6146
----------------edges number: 152922
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2541961669921875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2541961669921875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2612438201904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2612438201904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2631950378417969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6146, 47])
h_self size  torch.Size([6146, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2631950378417969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6146, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26427125930786133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26232004165649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6146, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26308345794677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26503562927246094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09761333465576172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 1 input nodes size: 240054
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08174705505371094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08174705505371094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1711745262145996  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1712203025817871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09254693984985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09877157211303711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09877157211303711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 240054
first layer output nodes number: 68871
edges number: 683597
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1016545295715332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([240054, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1016545295715332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1016545295715332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1326618194580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1326618194580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1990680694580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68871, 256])
h_self size  torch.Size([68871, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1990680694580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68871, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2654743194580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1990680694580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68871, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2654743194580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28278636932373047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68871
----------------output nodes number: 6106
----------------edges number: 151762
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28334569931030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.28334569931030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2911839485168457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2911839485168457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2922534942626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6106, 47])
h_self size  torch.Size([6106, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2922534942626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6106, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2933230400085449  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2922534942626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6106, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2916717529296875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2927417755126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10952472686767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 2 input nodes size: 210936
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0919651985168457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0919651985168457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17054510116577148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1705923080444336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08111906051635742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08699560165405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08699560165405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 210936
first layer output nodes number: 63788
edges number: 632331
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08904266357421875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([210936, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08904266357421875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08904266357421875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11775588989257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11775588989257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1785888671875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63788, 256])
h_self size  torch.Size([63788, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1785888671875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63788, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23942184448242188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1785888671875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63788, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23942184448242188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25463008880615234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63788
----------------output nodes number: 6305
----------------edges number: 156248
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25515270233154297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.25515270233154297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2623777389526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2623777389526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26404476165771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6305, 47])
h_self size  torch.Size([6305, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26404476165771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6305, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2651491165161133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26348209381103516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6305, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2637796401977539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.26544713973999023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09740352630615234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 3 input nodes size: 137332
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08141660690307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08141660690307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13257694244384766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.13262414932250977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.053997039794921875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05839824676513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05839824676513672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 137332
first layer output nodes number: 44681
edges number: 435478
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05975484848022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([137332, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05975484848022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05975484848022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07981252670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07981252670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12278127670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([44681, 256])
h_self size  torch.Size([44681, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12278127670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44681, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16575002670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12278127670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44681, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.16575002670288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17640304565429688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 44681
----------------output nodes number: 6304
----------------edges number: 155059
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17678356170654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17678356170654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18399906158447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18399906158447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18526220321655273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6304, 47])
h_self size  torch.Size([6304, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18526220321655273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18636608123779297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1851029396057129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18469905853271484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.18624162673950195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06564617156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 4 input nodes size: 174694
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05359315872192383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05359315872192383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11867189407348633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11871671676635742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06750917434692383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07250261306762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07250261306762695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 174694
first layer output nodes number: 54076
edges number: 527831
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0742330551147461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([174694, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0742330551147461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0742330551147461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09851264953613281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09851264953613281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1500835418701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([54076, 256])
h_self size  torch.Size([54076, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1500835418701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54076, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20165443420410156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1500835418701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54076, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20165443420410156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21454715728759766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 54076
----------------output nodes number: 5969
----------------edges number: 142238
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2149949073791504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2149949073791504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22179269790649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22179269790649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22312307357788086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5969, 47])
h_self size  torch.Size([5969, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22312307357788086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2241683006286621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2228379249572754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22290515899658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22453927993774414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08122777938842773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 5 input nodes size: 119849
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06757640838623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06757640838623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11249828338623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11254310607910156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04741954803466797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0517120361328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.0517120361328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 119849
first layer output nodes number: 44797
edges number: 434388
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05293893814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([119849, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05293893814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.05293893814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07303094863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07303094863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11599969863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([44797, 256])
h_self size  torch.Size([44797, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11599969863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44797, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15896844863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11599969863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44797, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15896844863891602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1696491241455078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 44797
----------------output nodes number: 5986
----------------edges number: 141584
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1700277328491211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1700277328491211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17683696746826172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17683696746826172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17806148529052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5986, 47])
h_self size  torch.Size([5986, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17806148529052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5986, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1798563003540039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17863178253173828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5986, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17834949493408203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.17957448959350586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.058739662170410156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 6 input nodes size: 179758
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04713726043701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.04713726043701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11410236358642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.11414718627929688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06918048858642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07422924041748047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07422924041748047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 179758
first layer output nodes number: 55646
edges number: 539131
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07603836059570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([179758, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07603836059570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07603836059570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10161352157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.10161352157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15468168258666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55646, 256])
h_self size  torch.Size([55646, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15468168258666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55646, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2077498435974121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.15468168258666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55646, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2077498435974121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22101688385009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55646
----------------output nodes number: 5963
----------------edges number: 138445
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22147655487060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22147655487060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2282400131225586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2282400131225586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22974872589111328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22974872589111328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.23079299926757812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22928428649902344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.22974491119384766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2307896614074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.08409738540649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 7 input nodes size: 157261
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06964111328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06964111328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.12823486328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1282796859741211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06126976013183594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06624603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06624603271484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 157261
first layer output nodes number: 52743
edges number: 519937
----------------------------------------before model layer 0
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06781148910522461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([157261, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06781148910522461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.06781148910522461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09243917465209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.09243917465209961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14273881912231445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52743, 256])
h_self size  torch.Size([52743, 100])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14273881912231445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52743, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1930384635925293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.14273881912231445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52743, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.1930384635925293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2056136131286621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52743
----------------output nodes number: 5999
----------------edges number: 147723
----------------------------------------before mean aggregator
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20605182647705078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.20605182647705078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2129192352294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.2129192352294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21396970748901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5999, 47])
h_self size  torch.Size([5999, 256])
----------------------------------------before rst
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21396970748901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5999, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21508216857910156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21403169631958008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5999, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21357345581054688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.21508264541625977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.07519292831420898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 8 input nodes size: 325263
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.060811519622802734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.4842529296875 GB
    Memory Allocated: 0.060811519622802734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18198156356811523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18202638626098633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12338781356811523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12960195541381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12960195541381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 325263
first layer output nodes number: 70509
edges number: 690738
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1325511932373047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([325263, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1325511932373047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1325511932373047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16439104080200195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16439104080200195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23163366317749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([70509, 256])
h_self size  torch.Size([70509, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23163366317749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([70509, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2988762855529785  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23163366317749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([70509, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2988762855529785  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3156871795654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 70509
----------------output nodes number: 5963
----------------edges number: 136742
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3162574768066406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3162574768066406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.32300853729248047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.32300853729248047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3241252899169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3241252899169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.32516956329345703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3240528106689453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.32411909103393555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.32517004013061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 9 input nodes size: 176156
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12345409393310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12345409393310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18986034393310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18990516662597656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06869029998779297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07340812683105469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07340812683105469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 176156
first layer output nodes number: 49433
edges number: 487237
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0750894546508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([176156, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0750894546508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0750894546508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0973200798034668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0973200798034668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14446306228637695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([49433, 256])
h_self size  torch.Size([49433, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14446306228637695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49433, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1916060447692871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14446306228637695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49433, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1916060447692871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20339202880859375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 49433
----------------output nodes number: 5996
----------------edges number: 145881
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20380544662475586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20380544662475586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21065568923950195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21065568923950195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21177148818969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5996, 47])
h_self size  torch.Size([5996, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21177148818969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5996, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2134566307067871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2123408317565918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5996, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2123398780822754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21402549743652344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08169841766357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 10 input nodes size: 188306
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06868934631347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06868934631347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1388392448425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1388859748840332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07243490219116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07758188247680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07758188247680664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 188306
first layer output nodes number: 55932
edges number: 543347
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07940196990966797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([188306, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07940196990966797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07940196990966797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10499429702758789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10499429702758789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15833520889282227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55932, 256])
h_self size  torch.Size([55932, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15833520889282227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55932, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21167612075805664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15833520889282227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55932, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21167612075805664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22501134872436523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55932
----------------output nodes number: 6245
----------------edges number: 147386
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22547483444213867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22547483444213867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23280954360961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23280954360961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23410558700561523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6245, 47])
h_self size  torch.Size([6245, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23410558700561523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6245, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2351994514465332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2339034080505371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6245, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23388147354125977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23510313034057617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08702850341796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 11 input nodes size: 125701
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07241296768188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07241296768188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11924028396606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11928749084472656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04909086227416992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05452156066894531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05452156066894531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 125701
first layer output nodes number: 46721
edges number: 446101
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05580711364746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([125701, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05580711364746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05580711364746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07717514038085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07717514038085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12209701538085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([46721, 256])
h_self size  torch.Size([46721, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12209701538085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46721, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16665363311767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12173175811767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46721, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16665363311767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1774277687072754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 46721
----------------output nodes number: 6290
----------------edges number: 149575
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17782354354858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17782354354858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18498468399047852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18498468399047852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18608617782592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6290, 47])
h_self size  torch.Size([6290, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18608617782592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6290, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18751907348632812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1864175796508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6290, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18642520904541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18752717971801758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06260156631469727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 12 input nodes size: 222932
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04909849166870117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04909849166870117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13214731216430664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13219451904296875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08531999588012695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09131288528442383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09131288528442383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 222932
first layer output nodes number: 65333
edges number: 643839
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0934610366821289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([222932, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0934610366821289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0934610366821289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12284040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12284040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18534040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([65333, 256])
h_self size  torch.Size([65333, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18534040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65333, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24784040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18534040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65333, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24784040451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26341724395751953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 65333
----------------output nodes number: 6322
----------------edges number: 154369
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26395130157470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26395130157470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27117919921875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27117919921875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2732200622558594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6322, 47])
h_self size  torch.Size([6322, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2732200622558594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6322, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27516603469848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27312517166137695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6322, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2731308937072754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27423858642578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10161113739013672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 13 input nodes size: 273325
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08532571792602539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08532571792602539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1871476173400879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18719244003295898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1040964126586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10929393768310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10929393768310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 273325
first layer output nodes number: 59148
edges number: 574371
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1117715835571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([273325, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1117715835571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1117715835571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13876581192016602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13876581192016602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1951737403869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([59148, 256])
h_self size  torch.Size([59148, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1951737403869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59148, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25158166885375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1951737403869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59148, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25158166885375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.265683650970459  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 59148
----------------output nodes number: 5963
----------------edges number: 123090
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26616954803466797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26616954803466797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27281856536865234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27281856536865234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27405500411987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27405500411987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2760009765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2747645378112793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27489376068115234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27636003494262695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11942434310913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 14 input nodes size: 224616
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10422563552856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10422563552856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18790197372436523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18794918060302734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08608245849609375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09221458435058594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09221458435058594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 224616
first layer output nodes number: 67012
edges number: 665681
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09438800811767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([224616, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09438800811767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09438800811767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12456226348876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12456226348876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18901538848876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([67012, 256])
h_self size  torch.Size([67012, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18901538848876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67012, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25346851348876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18901538848876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67012, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25346851348876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26944541931152344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 67012
----------------output nodes number: 6326
----------------edges number: 157207
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2699923515319824  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2699923515319824  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27779722213745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27779722213745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2792840003967285  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6326, 47])
h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2792840003967285  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2803916931152344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27890491485595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27915525436401367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28118324279785156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1030130386352539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 15 input nodes size: 287285
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08633279800415039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08633279800415039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19335508346557617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19340038299560547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10967683792114258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1154317855834961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1154317855834961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 287285
first layer output nodes number: 63140
edges number: 625231
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1180429458618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([287285, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1180429458618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1180429458618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14645910263061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14645910263061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20700597763061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63140, 256])
h_self size  torch.Size([63140, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20700597763061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63140, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26755285263061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20700597763061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63140, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26755285263061523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2826066017150879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63140
----------------output nodes number: 6025
----------------edges number: 143923
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28312253952026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28312253952026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28998708724975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28998708724975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2910423278808594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6025, 47])
h_self size  torch.Size([6025, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2910423278808594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6025, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2920975685119629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2910423278808594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6025, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2907829284667969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2918386459350586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12559795379638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 16 input nodes size: 171613
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10941743850708008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10941743850708008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17387056350708008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1739177703857422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06685018539428711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07239007949829102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07239007949829102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 171613
first layer output nodes number: 59219
edges number: 586099
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07411050796508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([171613, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07411050796508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07411050796508789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10075902938842773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10075902938842773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15723466873168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([59219, 256])
h_self size  torch.Size([59219, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15723466873168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59219, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21371030807495117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15723466873168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59219, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21371030807495117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2278294563293457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 59219
----------------output nodes number: 6313
----------------edges number: 157314
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2283182144165039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2283182144165039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23555946350097656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23555946350097656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2366652488708496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6313, 47])
h_self size  torch.Size([6313, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2366652488708496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23777103424072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2366652488708496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2365436553955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23764991760253906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08165597915649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 17 input nodes size: 202272
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06672859191894531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06672859191894531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14208078384399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14212560653686523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07762527465820312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08351612091064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08351612091064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 202272
first layer output nodes number: 54744
edges number: 540764
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08543157577514648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([202272, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08543157577514648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08543157577514648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11005878448486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11005878448486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16226673126220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([54744, 256])
h_self size  torch.Size([54744, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16226673126220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54744, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21447467803955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16226673126220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54744, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21447467803955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22752666473388672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 54744
----------------output nodes number: 5964
----------------edges number: 148030
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2279796600341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2279796600341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23551368713378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23551368713378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23748207092285156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5964, 47])
h_self size  torch.Size([5964, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23748207092285156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5964, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2386188507080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2366504669189453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5964, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2365889549255371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2385578155517578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09248971939086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 18 input nodes size: 182314
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07756376266479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07756376266479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14596891403198242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0705718994140625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 182314
first layer output nodes number: 59375
edges number: 588094
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07788228988647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([182314, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07788228988647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07788228988647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10460472106933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10460472106933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16122913360595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([59375, 256])
h_self size  torch.Size([59375, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16122913360595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59375, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21785354614257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16122913360595703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([59375, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21785354614257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2320098876953125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 59375
----------------output nodes number: 6110
----------------edges number: 151243
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2324981689453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2324981689453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23949813842773438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23949813842773438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24063491821289062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6110, 47])
h_self size  torch.Size([6110, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24063491821289062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6110, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24260425567626953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24146747589111328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6110, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2415599822998047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2435297966003418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08556509017944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 19 input nodes size: 272002
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0706644058227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0706644058227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1722269058227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17227411270141602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10386896133422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11051511764526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11051511764526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 272002
first layer output nodes number: 74047
edges number: 734584
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11309385299682617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([272002, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11309385299682617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11309385299682617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14642810821533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14642810821533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21704483032226562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([74047, 256])
h_self size  torch.Size([74047, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21704483032226562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([74047, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2876615524291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21704483032226562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([74047, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2876615524291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3053159713745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 74047
----------------output nodes number: 6327
----------------edges number: 157349
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30591487884521484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30591487884521484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3131694793701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3131694793701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3150463104248047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3150463104248047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31615447998046875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31427764892578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31424903869628906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31612634658813477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12205934524536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 20 input nodes size: 284255
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10384035110473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10384035110473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2097339630126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2097787857055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1081690788269043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11624574661254883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11624574661254883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 284255
first layer output nodes number: 71127
edges number: 701890
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11889410018920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([284255, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11889410018920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11889410018920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15088605880737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15088605880737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21924543380737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([71127, 256])
h_self size  torch.Size([71127, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21924543380737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([71127, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2870774269104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2187180519104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([71127, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2870774269104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30403566360473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 71127
----------------output nodes number: 5963
----------------edges number: 147423
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3046107292175293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3046107292175293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31144094467163086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31144094467163086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3124852180480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3124852180480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.31352949142456055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3124852180480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3124213218688965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3139505386352539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12738513946533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 21 input nodes size: 203838
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10810518264770508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10810518264770508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18404102325439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18408823013305664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07814979553222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08406925201416016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08406925201416016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 203838
first layer output nodes number: 64213
edges number: 637112
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08607673645019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([203838, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08607673645019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08607673645019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11498498916625977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11498498916625977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1762232780456543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64213, 256])
h_self size  torch.Size([64213, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1762232780456543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64213, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23746156692504883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1762232780456543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64213, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23746156692504883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25277137756347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64213
----------------output nodes number: 6326
----------------edges number: 157244
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2532973289489746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2532973289489746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26055002212524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26055002212524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2618117332458496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6326, 47])
h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2618117332458496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26291942596435547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26165771484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2618751525878906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2631373405456543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09441423416137695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 22 input nodes size: 195857
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07836723327636719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07836723327636719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15132999420166016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15137624740600586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0753931999206543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08117818832397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08117818832397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 195857
first layer output nodes number: 63192
edges number: 623467
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08310890197753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([195857, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08310890197753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08310890197753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11217164993286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11217164993286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17271852493286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63192, 256])
h_self size  torch.Size([63192, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17271852493286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63192, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23326539993286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17271852493286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63192, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23326539993286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24833154678344727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63192
----------------output nodes number: 6176
----------------edges number: 152887
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24884891510009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24884891510009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25592517852783203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25592517852783203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2572445869445801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6176, 47])
h_self size  torch.Size([6176, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2572445869445801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6176, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25832605361938477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2570066452026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6176, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2570643424987793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2581462860107422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09174394607543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 23 input nodes size: 202010
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07545089721679688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07545089721679688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15070581436157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15075302124023438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0777440071105957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08411693572998047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08411693572998047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 202010
first layer output nodes number: 63414
edges number: 627340
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08609485626220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([202010, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08609485626220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08609485626220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11463022232055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11463022232055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17517709732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63414, 256])
h_self size  torch.Size([63414, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17517709732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63414, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23572397232055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17517709732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63414, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23572397232055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2508430480957031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63414
----------------output nodes number: 6296
----------------edges number: 156385
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25136280059814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25136280059814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25858020782470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25858020782470703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25968265533447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6296, 47])
h_self size  torch.Size([6296, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25968265533447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6296, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2617034912109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2606010437011719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6296, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26038408279418945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2614870071411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09390020370483398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 24 input nodes size: 172121
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07752704620361328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07752704620361328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14198017120361328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14202547073364258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06672334671020508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07159566879272461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07159566879272461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 172121
first layer output nodes number: 51926
edges number: 505020
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07326555252075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([172121, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07326555252075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07326555252075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09675359725952148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09675359725952148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14627408981323242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([51926, 256])
h_self size  torch.Size([51926, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14627408981323242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51926, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19579458236694336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14627408981323242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51926, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19579458236694336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2081747055053711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 51926
----------------output nodes number: 6076
----------------edges number: 148848
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20860719680786133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20860719680786133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21555662155151367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21555662155151367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2167983055114746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6076, 47])
h_self size  torch.Size([6076, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2167983055114746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6076, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21786260604858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21662092208862305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6076, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2165827751159668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21773338317871094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08005142211914062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 25 input nodes size: 217246
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06668519973754883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06668519973754883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14761590957641602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1476607322692871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08316230773925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08848237991333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08848237991333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 217246
first layer output nodes number: 55350
edges number: 539974
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09051370620727539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([217246, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09051370620727539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09051370620727539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11536359786987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11536359786987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16814947128295898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55350, 256])
h_self size  torch.Size([55350, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16814947128295898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55350, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22093534469604492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16814947128295898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55350, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22093534469604492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2341318130493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55350
----------------output nodes number: 6006
----------------edges number: 146729
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2345890998840332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2345890998840332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24153566360473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24153566360473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24263620376586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6006, 47])
h_self size  torch.Size([6006, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24263620376586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6006, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24451303482055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24341249465942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6006, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24344873428344727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24517822265625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09765386581420898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 26 input nodes size: 230247
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08319854736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08319854736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16897249221801758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16901731491088867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08804178237915039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09384965896606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09384965896606445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 230247
first layer output nodes number: 64848
edges number: 633319
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09604883193969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([230247, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09604883193969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09604883193969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1251673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1251673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1876673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64848, 256])
h_self size  torch.Size([64848, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1876673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64848, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2501673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1876673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64848, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2501673698425293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2656283378601074  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64848
----------------output nodes number: 5990
----------------edges number: 146049
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2661566734313965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2661566734313965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27300310134887695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27300310134887695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2743072509765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5990, 47])
h_self size  torch.Size([5990, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2743072509765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5990, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2753562927246094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27405214309692383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5990, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27425575256347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27596235275268555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10418367385864258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 27 input nodes size: 208676
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08824539184570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08824539184570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16637039184570312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16641759872436523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08059883117675781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08636951446533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08636951446533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 208676
first layer output nodes number: 64240
edges number: 621946
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08840322494506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([208676, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08840322494506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08840322494506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11720800399780273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11720800399780273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17847204208374023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64240, 256])
h_self size  torch.Size([64240, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17847204208374023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64240, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23973608016967773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17847204208374023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64240, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23973608016967773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2550520896911621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64240
----------------output nodes number: 6327
----------------edges number: 152506
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25557804107666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25557804107666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26279640197753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26279640197753906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26403236389160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26403236389160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2651405334472656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2639045715332031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2638363838195801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2650728225708008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09627103805541992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 28 input nodes size: 150788
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08053064346313477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08053064346313477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1367039680480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1367502212524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0585780143737793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06389236450195312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06389236450195312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 150788
first layer output nodes number: 49616
edges number: 479496
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06538629531860352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([150788, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06538629531860352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06538629531860352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08800315856933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08800315856933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13532066345214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([49616, 256])
h_self size  torch.Size([49616, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13532066345214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49616, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18263816833496094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13532066345214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49616, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18263816833496094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19446754455566406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 49616
----------------output nodes number: 6172
----------------edges number: 148499
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1948838233947754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1948838233947754  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20192384719848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20192384719848633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20343446731567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6172, 47])
h_self size  torch.Size([6172, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20343446731567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6172, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2045154571533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2030048370361328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6172, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2032794952392578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20479059219360352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07263326644897461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 29 input nodes size: 183930
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0588526725769043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0588526725769043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12737226486206055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12741708755493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.071197509765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07627582550048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07627582550048828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 183930
first layer output nodes number: 55775
edges number: 537354
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07806205749511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([183930, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07806205749511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07806205749511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10327863693237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10327863693237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15646982192993164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55775, 256])
h_self size  torch.Size([55775, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15646982192993164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55775, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20966100692749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15646982192993164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55775, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20966100692749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22295904159545898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55775
----------------output nodes number: 5965
----------------edges number: 144037
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2234196662902832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2234196662902832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23022699356079102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23022699356079102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23163938522338867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5965, 47])
h_self size  torch.Size([5965, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23163938522338867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23268413543701172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23127174377441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2308058738708496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23221874237060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08487319946289062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 30 input nodes size: 174488
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07073163986206055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07073163986206055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13573360443115234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13578081130981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06721639633178711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0725398063659668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0725398063659668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 174488
first layer output nodes number: 58324
edges number: 561541
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07437896728515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([174488, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07437896728515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07437896728515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1005086898803711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1005086898803711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15613079071044922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58324, 256])
h_self size  torch.Size([58324, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15613079071044922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58324, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21175289154052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15613079071044922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58324, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21175289154052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22565841674804688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58324
----------------output nodes number: 6326
----------------edges number: 152753
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22614049911499023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22614049911499023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23335981369018555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23335981369018555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23450279235839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6326, 47])
h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23450279235839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23636674880981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23522377014160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23528671264648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23643016815185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08184480667114258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 31 input nodes size: 179105
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06727933883666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06727933883666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1340012550354004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1340484619140625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0689992904663086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07424545288085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07424545288085938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 179105
first layer output nodes number: 57421
edges number: 551649
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07631111145019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([179105, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07631111145019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07631111145019531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10221290588378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10221290588378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1578350067138672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57421, 256])
h_self size  torch.Size([57421, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1578350067138672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57421, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21259593963623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15697383880615234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57421, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21259593963623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22542524337768555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57421
----------------output nodes number: 6326
----------------edges number: 152429
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22590065002441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22590065002441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23311710357666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23311710357666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2342538833618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6326, 47])
h_self size  torch.Size([6326, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2342538833618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23536157608032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23422479629516602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6326, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2342538833618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23536205291748047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0836496353149414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0836496353149414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0836496353149414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03181876242160797 |0.0045106858015060425 |0.01088782399892807 |0.00014071166515350342 |0.002545759081840515 |0.002274751663208008 |
----------------------------------------------------------pseudo_mini_loss sum 2.049563407897949
Total (block generation + training)time/epoch 63.06736135482788
Training time/epoch 1.6934638023376465
Training time without block to device /epoch 1.5491218566894531
Training time without total dataloading part /epoch 0.43665218353271484
load block tensor time/epoch 1.018200397491455
block to device time/epoch 0.14434194564819336
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8377443
Number of first layer input nodes during this epoch:  6485292
Number of first layer output nodes during this epoch:  1892151
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0836491584777832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2604796886444092
global_2_local spend time (sec) 0.5033111572265625

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.233 seconds
Metis partitioning: 13.710 seconds
Split the graph: 0.877 seconds
Construct subgraphs: 0.399 seconds
6327
6278
6090
5965
5963
5969
6324
6248
6327
6300
6229
6011
5965
5980
6009
5963
6303
6004
6313
6299
6072
5963
5978
5967
6310
6327
6152
6327
6017
6258
6319
6014
REG metis partition end ----................................
the time spent:  27.372485637664795
total k batches seeds list generation spend  27.892348051071167
after graph partition
graph partition algorithm spend time 28.386132955551147

partition_len_list
[58415, 55631, 47279, 55343, 65722, 49162, 62242, 69590, 64349, 44778, 52392, 68198, 45364, 55447, 54363, 58161, 46802, 52826, 62656, 68550, 67807, 64474, 54144, 67703, 58854, 66923, 67811, 68991, 49640, 61259, 68354, 53843]
REG selection method  spend 29.120468616485596
check_connections_block*********************************
time for parepare 1: 0.2240593433380127
local_output_nid generation: 0.0023620128631591797
local_in_edges_tensor generation: 0.0026445388793945312
mini_batch_src_global generation: 0.005246162414550781

&&&&&&&&&&&&&&& before remove duplicate length: 153962
r_  generation: 0.050638675689697266

local_output_nid generation: 0.0026493072509765625
local_in_edges_tensor generation: 0.0025031566619873047
mini_batch_src_global generation: 0.006108760833740234

&&&&&&&&&&&&&&& before remove duplicate length: 151587
r_  generation: 0.05228137969970703

local_output_nid generation: 0.002625703811645508
local_in_edges_tensor generation: 0.002470731735229492
mini_batch_src_global generation: 0.004473209381103516

&&&&&&&&&&&&&&& before remove duplicate length: 145392
r_  generation: 0.04964327812194824

local_output_nid generation: 0.002569437026977539
local_in_edges_tensor generation: 0.002435922622680664
mini_batch_src_global generation: 0.004587650299072266

&&&&&&&&&&&&&&& before remove duplicate length: 144623
r_  generation: 0.05004739761352539

local_output_nid generation: 0.002573251724243164
local_in_edges_tensor generation: 0.0024275779724121094
mini_batch_src_global generation: 0.004849433898925781

&&&&&&&&&&&&&&& before remove duplicate length: 144941
r_  generation: 0.05876636505126953

local_output_nid generation: 0.0025892257690429688
local_in_edges_tensor generation: 0.0024449825286865234
mini_batch_src_global generation: 0.0049550533294677734

&&&&&&&&&&&&&&& before remove duplicate length: 145974
r_  generation: 0.051596641540527344

local_output_nid generation: 0.002719402313232422
local_in_edges_tensor generation: 0.0025453567504882812
mini_batch_src_global generation: 0.005083560943603516

&&&&&&&&&&&&&&& before remove duplicate length: 153460
r_  generation: 0.05473661422729492

local_output_nid generation: 0.002699136734008789
local_in_edges_tensor generation: 0.002554178237915039
mini_batch_src_global generation: 0.005492448806762695

&&&&&&&&&&&&&&& before remove duplicate length: 150275
r_  generation: 0.054869890213012695

local_output_nid generation: 0.0027375221252441406
local_in_edges_tensor generation: 0.0025937557220458984
mini_batch_src_global generation: 0.005492448806762695

&&&&&&&&&&&&&&& before remove duplicate length: 156746
r_  generation: 0.05768561363220215

local_output_nid generation: 0.00273895263671875
local_in_edges_tensor generation: 0.0030035972595214844
mini_batch_src_global generation: 0.005364894866943359

&&&&&&&&&&&&&&& before remove duplicate length: 154829
r_  generation: 0.05657958984375

local_output_nid generation: 0.0027093887329101562
local_in_edges_tensor generation: 0.00246429443359375
mini_batch_src_global generation: 0.005309581756591797

&&&&&&&&&&&&&&& before remove duplicate length: 152855
r_  generation: 0.05433320999145508

local_output_nid generation: 0.0026137828826904297
local_in_edges_tensor generation: 0.0025000572204589844
mini_batch_src_global generation: 0.005307197570800781

&&&&&&&&&&&&&&& before remove duplicate length: 149696
r_  generation: 0.05525922775268555

local_output_nid generation: 0.002591371536254883
local_in_edges_tensor generation: 0.0024509429931640625
mini_batch_src_global generation: 0.0050144195556640625

&&&&&&&&&&&&&&& before remove duplicate length: 141196
r_  generation: 0.05092978477478027

local_output_nid generation: 0.002584218978881836
local_in_edges_tensor generation: 0.0024118423461914062
mini_batch_src_global generation: 0.004763126373291016

&&&&&&&&&&&&&&& before remove duplicate length: 142494
r_  generation: 0.051012516021728516

local_output_nid generation: 0.0025854110717773438
local_in_edges_tensor generation: 0.0024111270904541016
mini_batch_src_global generation: 0.005032062530517578

&&&&&&&&&&&&&&& before remove duplicate length: 147693
r_  generation: 0.05382490158081055

local_output_nid generation: 0.0025818347930908203
local_in_edges_tensor generation: 0.002416372299194336
mini_batch_src_global generation: 0.0047910213470458984

&&&&&&&&&&&&&&& before remove duplicate length: 137955
r_  generation: 0.051239967346191406

local_output_nid generation: 0.0027284622192382812
local_in_edges_tensor generation: 0.0025064945220947266
mini_batch_src_global generation: 0.0054340362548828125

&&&&&&&&&&&&&&& before remove duplicate length: 149943
r_  generation: 0.05378365516662598

local_output_nid generation: 0.002643585205078125
local_in_edges_tensor generation: 0.0023941993713378906
mini_batch_src_global generation: 0.004801273345947266

&&&&&&&&&&&&&&& before remove duplicate length: 140850
r_  generation: 0.05012083053588867

local_output_nid generation: 0.0027086734771728516
local_in_edges_tensor generation: 0.00293731689453125
mini_batch_src_global generation: 0.005648612976074219

&&&&&&&&&&&&&&& before remove duplicate length: 154446
r_  generation: 0.05545520782470703

local_output_nid generation: 0.002716541290283203
local_in_edges_tensor generation: 0.002767801284790039
mini_batch_src_global generation: 0.005615949630737305

&&&&&&&&&&&&&&& before remove duplicate length: 156723
r_  generation: 0.05847597122192383

local_output_nid generation: 0.002630472183227539
local_in_edges_tensor generation: 0.002421855926513672
mini_batch_src_global generation: 0.0054759979248046875

&&&&&&&&&&&&&&& before remove duplicate length: 147738
r_  generation: 0.05469822883605957

local_output_nid generation: 0.0041675567626953125
local_in_edges_tensor generation: 0.0024039745330810547
mini_batch_src_global generation: 0.0049800872802734375

&&&&&&&&&&&&&&& before remove duplicate length: 133767
r_  generation: 0.050028085708618164

local_output_nid generation: 0.002606630325317383
local_in_edges_tensor generation: 0.002324342727661133
mini_batch_src_global generation: 0.004709482192993164

&&&&&&&&&&&&&&& before remove duplicate length: 128435
r_  generation: 0.045371055603027344

local_output_nid generation: 0.0025975704193115234
local_in_edges_tensor generation: 0.002462148666381836
mini_batch_src_global generation: 0.005276203155517578

&&&&&&&&&&&&&&& before remove duplicate length: 145411
r_  generation: 0.05209684371948242

local_output_nid generation: 0.0027191638946533203
local_in_edges_tensor generation: 0.0029697418212890625
mini_batch_src_global generation: 0.0063021183013916016

&&&&&&&&&&&&&&& before remove duplicate length: 157334
r_  generation: 0.05884289741516113

local_output_nid generation: 0.0027327537536621094
local_in_edges_tensor generation: 0.002520322799682617
mini_batch_src_global generation: 0.005541086196899414

&&&&&&&&&&&&&&& before remove duplicate length: 157144
r_  generation: 0.06080818176269531

local_output_nid generation: 0.0038361549377441406
local_in_edges_tensor generation: 0.0025577545166015625
mini_batch_src_global generation: 0.0056915283203125

&&&&&&&&&&&&&&& before remove duplicate length: 150943
r_  generation: 0.05627036094665527

local_output_nid generation: 0.002768993377685547
local_in_edges_tensor generation: 0.0029926300048828125
mini_batch_src_global generation: 0.00560307502746582

&&&&&&&&&&&&&&& before remove duplicate length: 157521
r_  generation: 0.05952930450439453

local_output_nid generation: 0.002612590789794922
local_in_edges_tensor generation: 0.0025043487548828125
mini_batch_src_global generation: 0.0056915283203125

&&&&&&&&&&&&&&& before remove duplicate length: 147452
r_  generation: 0.05352663993835449

local_output_nid generation: 0.002701997756958008
local_in_edges_tensor generation: 0.002529144287109375
mini_batch_src_global generation: 0.005995750427246094

&&&&&&&&&&&&&&& before remove duplicate length: 155221
r_  generation: 0.05738043785095215

local_output_nid generation: 0.0027217864990234375
local_in_edges_tensor generation: 0.0030717849731445312
mini_batch_src_global generation: 0.006044149398803711

&&&&&&&&&&&&&&& before remove duplicate length: 157628
r_  generation: 0.06295466423034668

local_output_nid generation: 0.0026199817657470703
local_in_edges_tensor generation: 0.0031325817108154297
mini_batch_src_global generation: 0.005380868911743164

&&&&&&&&&&&&&&& before remove duplicate length: 149645
r_  generation: 0.056114912033081055


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7407100200653076
gen group dst list time:  0.054917097091674805
check_connections_block*********************************
time for parepare 1: 0.3694915771484375
local_output_nid generation: 0.01740884780883789
local_in_edges_tensor generation: 0.0893561840057373
mini_batch_src_global generation: 0.025405168533325195

&&&&&&&&&&&&&&& before remove duplicate length: 567653
r_  generation: 0.2251873016357422

local_output_nid generation: 0.01865696907043457
local_in_edges_tensor generation: 0.015718936920166016
mini_batch_src_global generation: 0.022115707397460938

&&&&&&&&&&&&&&& before remove duplicate length: 534946
r_  generation: 0.21480774879455566

local_output_nid generation: 0.01586747169494629
local_in_edges_tensor generation: 0.013456106185913086
mini_batch_src_global generation: 0.017430543899536133

&&&&&&&&&&&&&&& before remove duplicate length: 456390
r_  generation: 0.18571233749389648

local_output_nid generation: 0.017908334732055664
local_in_edges_tensor generation: 0.016225099563598633
mini_batch_src_global generation: 0.0207211971282959

&&&&&&&&&&&&&&& before remove duplicate length: 534029
r_  generation: 0.23239517211914062

local_output_nid generation: 0.021452665328979492
local_in_edges_tensor generation: 0.020165443420410156
mini_batch_src_global generation: 0.031775474548339844

&&&&&&&&&&&&&&& before remove duplicate length: 639997
r_  generation: 0.3017716407775879

local_output_nid generation: 0.01671624183654785
local_in_edges_tensor generation: 0.018845081329345703
mini_batch_src_global generation: 0.02361011505126953

&&&&&&&&&&&&&&& before remove duplicate length: 480665
r_  generation: 0.22268366813659668

local_output_nid generation: 0.026674270629882812
local_in_edges_tensor generation: 0.018880844116210938
mini_batch_src_global generation: 0.030442237854003906

&&&&&&&&&&&&&&& before remove duplicate length: 603466
r_  generation: 0.28960347175598145

local_output_nid generation: 0.022453784942626953
local_in_edges_tensor generation: 0.021183013916015625
mini_batch_src_global generation: 0.03149700164794922

&&&&&&&&&&&&&&& before remove duplicate length: 672201
r_  generation: 0.32967138290405273

local_output_nid generation: 0.020791053771972656
local_in_edges_tensor generation: 0.021435022354125977
mini_batch_src_global generation: 0.030076980590820312

&&&&&&&&&&&&&&& before remove duplicate length: 637959
r_  generation: 0.3126857280731201

local_output_nid generation: 0.016582727432250977
local_in_edges_tensor generation: 0.013434171676635742
mini_batch_src_global generation: 0.022899627685546875

&&&&&&&&&&&&&&& before remove duplicate length: 436458
r_  generation: 0.20082449913024902

local_output_nid generation: 0.017047405242919922
local_in_edges_tensor generation: 0.02139139175415039
mini_batch_src_global generation: 0.0277712345123291

&&&&&&&&&&&&&&& before remove duplicate length: 511394
r_  generation: 0.24507761001586914

local_output_nid generation: 0.021422147750854492
local_in_edges_tensor generation: 0.039772987365722656
mini_batch_src_global generation: 0.030855417251586914

&&&&&&&&&&&&&&& before remove duplicate length: 676195
r_  generation: 0.32338809967041016

local_output_nid generation: 0.02190685272216797
local_in_edges_tensor generation: 0.018576860427856445
mini_batch_src_global generation: 0.023509740829467773

&&&&&&&&&&&&&&& before remove duplicate length: 439862
r_  generation: 0.19670701026916504

local_output_nid generation: 0.019794940948486328
local_in_edges_tensor generation: 0.019148826599121094
mini_batch_src_global generation: 0.024850845336914062

&&&&&&&&&&&&&&& before remove duplicate length: 541544
r_  generation: 0.2379770278930664

local_output_nid generation: 0.017155885696411133
local_in_edges_tensor generation: 0.015597343444824219
mini_batch_src_global generation: 0.026203155517578125

&&&&&&&&&&&&&&& before remove duplicate length: 534429
r_  generation: 0.2350940704345703

local_output_nid generation: 0.018949508666992188
local_in_edges_tensor generation: 0.01827263832092285
mini_batch_src_global generation: 0.026325702667236328

&&&&&&&&&&&&&&& before remove duplicate length: 563545
r_  generation: 0.27086734771728516

local_output_nid generation: 0.014345169067382812
local_in_edges_tensor generation: 0.012437582015991211
mini_batch_src_global generation: 0.02336430549621582

&&&&&&&&&&&&&&& before remove duplicate length: 447049
r_  generation: 0.19836902618408203

local_output_nid generation: 0.016957521438598633
local_in_edges_tensor generation: 0.015156030654907227
mini_batch_src_global generation: 0.024393796920776367

&&&&&&&&&&&&&&& before remove duplicate length: 513474
r_  generation: 0.2504739761352539

local_output_nid generation: 0.01932382583618164
local_in_edges_tensor generation: 0.01761651039123535
mini_batch_src_global generation: 0.030823707580566406

&&&&&&&&&&&&&&& before remove duplicate length: 616400
r_  generation: 0.2922358512878418

local_output_nid generation: 0.02094578742980957
local_in_edges_tensor generation: 0.01823711395263672
mini_batch_src_global generation: 0.029457569122314453

&&&&&&&&&&&&&&& before remove duplicate length: 680453
r_  generation: 0.3236527442932129

local_output_nid generation: 0.021207571029663086
local_in_edges_tensor generation: 0.019258737564086914
mini_batch_src_global generation: 0.033142805099487305

&&&&&&&&&&&&&&& before remove duplicate length: 671883
r_  generation: 0.3209192752838135

local_output_nid generation: 0.02204751968383789
local_in_edges_tensor generation: 0.022830963134765625
mini_batch_src_global generation: 0.030565500259399414

&&&&&&&&&&&&&&& before remove duplicate length: 627651
r_  generation: 0.3275792598724365

local_output_nid generation: 0.025704383850097656
local_in_edges_tensor generation: 0.02026987075805664
mini_batch_src_global generation: 0.030190706253051758

&&&&&&&&&&&&&&& before remove duplicate length: 531776
r_  generation: 0.28798770904541016

local_output_nid generation: 0.02300286293029785
local_in_edges_tensor generation: 0.0811154842376709
mini_batch_src_global generation: 0.0320582389831543

&&&&&&&&&&&&&&& before remove duplicate length: 670394
r_  generation: 0.3571467399597168

local_output_nid generation: 0.025949478149414062
local_in_edges_tensor generation: 0.029596805572509766
mini_batch_src_global generation: 0.02964043617248535

&&&&&&&&&&&&&&& before remove duplicate length: 583125
r_  generation: 0.26918935775756836

local_output_nid generation: 0.023178815841674805
local_in_edges_tensor generation: 0.0252840518951416
mini_batch_src_global generation: 0.03072214126586914

&&&&&&&&&&&&&&& before remove duplicate length: 664342
r_  generation: 0.325974702835083

local_output_nid generation: 0.022863149642944336
local_in_edges_tensor generation: 0.023755788803100586
mini_batch_src_global generation: 0.033260345458984375

&&&&&&&&&&&&&&& before remove duplicate length: 671156
r_  generation: 0.3320901393890381

local_output_nid generation: 0.02293252944946289
local_in_edges_tensor generation: 0.020609617233276367
mini_batch_src_global generation: 0.03364920616149902

&&&&&&&&&&&&&&& before remove duplicate length: 683944
r_  generation: 0.34392714500427246

local_output_nid generation: 0.016753196716308594
local_in_edges_tensor generation: 0.01605510711669922
mini_batch_src_global generation: 0.02809906005859375

&&&&&&&&&&&&&&& before remove duplicate length: 489970
r_  generation: 0.2344973087310791

local_output_nid generation: 0.01993250846862793
local_in_edges_tensor generation: 0.0171205997467041
mini_batch_src_global generation: 0.028113603591918945

&&&&&&&&&&&&&&& before remove duplicate length: 604449
r_  generation: 0.3023664951324463

local_output_nid generation: 0.02187967300415039
local_in_edges_tensor generation: 0.024075984954833984
mini_batch_src_global generation: 0.03458380699157715

&&&&&&&&&&&&&&& before remove duplicate length: 679459
r_  generation: 0.3304178714752197

local_output_nid generation: 0.01751995086669922
local_in_edges_tensor generation: 0.016423702239990234
mini_batch_src_global generation: 0.027407407760620117

&&&&&&&&&&&&&&& before remove duplicate length: 532498
r_  generation: 0.27098798751831055


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0836491584777832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

connection checking time:  16.204240083694458
block generation total time  13.58840560913086
average batch blocks generation time:  0.42463767528533936
block dataloader generation time/epoch 61.081645369529724
pseudo mini batch 0 input nodes size: 187317
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06902742385864258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06902742385864258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1388087272644043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1388559341430664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07208681106567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07746362686157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07746362686157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 187317
first layer output nodes number: 58415
edges number: 567653
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07929468154907227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([187317, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07929468154907227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07929468154907227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10610723495483398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10610723495483398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16181612014770508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58415, 256])
h_self size  torch.Size([58415, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16181612014770508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58415, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21752500534057617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16181612014770508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58415, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21752500534057617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23145246505737305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58415
----------------output nodes number: 6327
----------------edges number: 153962
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2319350242614746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2319350242614746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23978471755981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23978471755981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2414226531982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2414226531982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24319934844970703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2415614128112793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2415328025817871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24264192581176758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08733701705932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 1 input nodes size: 179345
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07205915451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07205915451049805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1388707160949707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1389179229736328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06908941268920898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07420587539672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07420587539672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 179345
first layer output nodes number: 55631
edges number: 534946
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07616853713989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([179345, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07616853713989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07616853713989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10108661651611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10108661651611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15414047241210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55631, 256])
h_self size  torch.Size([55631, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15414047241210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55631, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20719432830810547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15414047241210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55631, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20719432830810547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2204580307006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55631
----------------output nodes number: 6278
----------------edges number: 151587
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22092008590698242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22092008590698242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22808504104614258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22808504104614258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22960519790649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6278, 47])
h_self size  torch.Size([6278, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22960519790649414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6278, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23138189315795898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22986173629760742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6278, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23027372360229492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23190736770629883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08372783660888672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 2 input nodes size: 143470
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06950139999389648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06950139999389648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12294816970825195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12299394607543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05613517761230469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.060619354248046875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.060619354248046875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 143470
first layer output nodes number: 47279
edges number: 456390
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06271791458129883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([143470, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06271791458129883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06271791458129883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08412599563598633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08412599563598633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([47279, 256])
h_self size  torch.Size([47279, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47279, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17430353164672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([47279, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17430353164672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1855759620666504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 47279
----------------output nodes number: 6090
----------------edges number: 145392
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18597412109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18597412109375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19291114807128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19291114807128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19482946395874023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6090, 47])
h_self size  torch.Size([6090, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19482946395874023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6090, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19589614868164062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19397783279418945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6090, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19352436065673828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1951308250427246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06882381439208984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 3 input nodes size: 193993
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.055681705474853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.055681705474853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12795019149780273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12799501419067383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07450246810913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08024263381958008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08024263381958008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 193993
first layer output nodes number: 55343
edges number: 534029
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08210086822509766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([193993, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08210086822509766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08210086822509766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10733509063720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10733509063720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16011428833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55343, 256])
h_self size  torch.Size([55343, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16011428833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55343, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21289348602294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16011428833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55343, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21289348602294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2260885238647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55343
----------------output nodes number: 5965
----------------edges number: 144623
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2265458106994629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2265458106994629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23348283767700195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23348283767700195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23521757125854492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5965, 47])
h_self size  torch.Size([5965, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23521757125854492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23626232147216797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.234527587890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23450565338134766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2360668182373047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0895376205444336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 4 input nodes size: 242190
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07448053359985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07448053359985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.164703369140625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1647481918334961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09243488311767578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09850502014160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09850502014160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 242190
first layer output nodes number: 65722
edges number: 639997
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.100799560546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([242190, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.100799560546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.100799560546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1302967071533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1302967071533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19297409057617188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([65722, 256])
h_self size  torch.Size([65722, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19297409057617188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65722, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25565147399902344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19297409057617188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65722, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25565147399902344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27132081985473633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 65722
----------------output nodes number: 5963
----------------edges number: 144941
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27185535430908203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27185535430908203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2786674499511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2786674499511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2802414894104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2802414894104004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28201723098754883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2804431915283203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2809724807739258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2827486991882324  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10930538177490234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 5 input nodes size: 169964
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09296417236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09296417236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1562809944152832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1563258171081543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06605815887451172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07072830200195312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07072830200195312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 169964
first layer output nodes number: 49162
edges number: 480665
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07236146926879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([169964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07236146926879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07236146926879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09444141387939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09444141387939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1413259506225586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([49162, 256])
h_self size  torch.Size([49162, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1413259506225586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49162, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18821048736572266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1413259506225586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49162, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18821048736572266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19993162155151367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 49162
----------------output nodes number: 5969
----------------edges number: 145974
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20034313201904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20034313201904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2071685791015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2071685791015625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20830488204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5969, 47])
h_self size  torch.Size([5969, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20830488204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21024847030639648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20911216735839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5969, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20867443084716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20989179611206055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07848310470581055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 6 input nodes size: 199963
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06562042236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06562042236328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14011287689208984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14016008377075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0767984390258789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08243846893310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08243846893310547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 199963
first layer output nodes number: 62242
edges number: 603466
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08439254760742188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([199963, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08439254760742188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08439254760742188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11265850067138672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11265850067138672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17201709747314453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62242, 256])
h_self size  torch.Size([62242, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17201709747314453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62242, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23137569427490234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17201709747314453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62242, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23137569427490234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2462153434753418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62242
----------------output nodes number: 6324
----------------edges number: 153460
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24672651290893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24672651290893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2539486885070801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2539486885070801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25513696670532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6324, 47])
h_self size  torch.Size([6324, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25513696670532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6324, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25652122497558594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25533294677734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6324, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2553849220275879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2565736770629883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09257745742797852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 7 input nodes size: 240619
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07685041427612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07685041427612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1664881706237793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1665349006652832  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0919952392578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09812450408935547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09812450408935547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 240619
first layer output nodes number: 69590
edges number: 672201
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10080242156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([240619, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10080242156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10080242156982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13199520111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13199520111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19840145111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([69590, 256])
h_self size  torch.Size([69590, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19840145111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([69590, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26480770111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19840145111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([69590, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26480770111083984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28185176849365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 69590
----------------output nodes number: 6248
----------------edges number: 150275
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28241729736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28241729736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28954315185546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28954315185546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2906374931335449  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6248, 47])
h_self size  torch.Size([6248, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2906374931335449  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6248, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2917318344116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2906374931335449  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6248, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2905435562133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2916383743286133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10906600952148438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 8 input nodes size: 215298
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09190130233764648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09190130233764648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17210626602172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17215347290039062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08246898651123047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08839130401611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08839130401611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 215298
first layer output nodes number: 64349
edges number: 637959
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09058332443237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([215298, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09058332443237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09058332443237305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11954927444458008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11954927444458008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18091726303100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64349, 256])
h_self size  torch.Size([64349, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18091726303100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64349, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24228525161743164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18091726303100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64349, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24228525161743164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2576274871826172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64349
----------------output nodes number: 6327
----------------edges number: 156746
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25815439224243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25815439224243164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26540422439575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26540422439575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26653623580932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26653623580932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26836252212524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2672305107116699  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26726818084716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2684006690979004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09874200820922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 9 input nodes size: 133188
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08250665664672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08250665664672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13212347030639648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1321706771850586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05191850662231445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05632448196411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05632448196411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 133188
first layer output nodes number: 44778
edges number: 436458
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05765104293823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([133188, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05765104293823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05765104293823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07775115966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07775115966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12071990966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([44778, 256])
h_self size  torch.Size([44778, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12071990966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44778, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16368865966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12071990966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([44778, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16368865966796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17436456680297852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 44778
----------------output nodes number: 6300
----------------edges number: 154829
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1747455596923828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1747455596923828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18195533752441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18195533752441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18343544006347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6300, 47])
h_self size  torch.Size([6300, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18343544006347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6300, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1851820945739746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1837019920349121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6300, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18367338180541992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18515396118164062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06392097473144531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 10 input nodes size: 167183
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.051889896392822266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.051889896392822266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11438989639282227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11443662643432617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0647726058959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06972312927246094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06972312927246094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 167183
first layer output nodes number: 52392
edges number: 511394
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07186031341552734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([167183, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07186031341552734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07186031341552734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09538459777832031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09538459777832031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14534950256347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52392, 256])
h_self size  torch.Size([52392, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14534950256347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52392, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1953144073486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14534950256347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52392, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1953144073486328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20780563354492188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52392
----------------output nodes number: 6229
----------------edges number: 152855
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20824289321899414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20824289321899414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21536970138549805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21536970138549805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21680784225463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6229, 47])
h_self size  torch.Size([6229, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21680784225463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6229, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21840524673461914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21696710586547852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6229, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21695470809936523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2180461883544922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07878971099853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 11 input nodes size: 225407
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06476020812988281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06476020812988281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14873123168945312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14877605438232422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08622932434082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09238338470458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09238338470458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 225407
first layer output nodes number: 68198
edges number: 676195
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09457111358642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([225407, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09457111358642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09457111358642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12526941299438477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12526941299438477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1903080940246582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68198, 256])
h_self size  torch.Size([68198, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1903080940246582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68198, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25534677505493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1903080940246582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68198, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25534677505493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2716064453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68198
----------------output nodes number: 6011
----------------edges number: 149696
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2721595764160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2721595764160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.279052734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.279052734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28016090393066406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6011, 47])
h_self size  torch.Size([6011, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28016090393066406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6011, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2815284729003906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28042030334472656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6011, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2804374694824219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2817411422729492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10294198989868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 12 input nodes size: 122028
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08624649047851562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08624649047851562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13170576095581055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13175058364868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.047734737396240234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05215644836425781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05215644836425781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 122028
first layer output nodes number: 45364
edges number: 439862
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05340385437011719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([122028, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05340385437011719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05340385437011719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07375049591064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07375049591064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11701297760009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([45364, 256])
h_self size  torch.Size([45364, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11701297760009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45364, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16027545928955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11701297760009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45364, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16027545928955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17109107971191406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 45364
----------------output nodes number: 5965
----------------edges number: 141196
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17147397994995117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17147397994995117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17826032638549805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17826032638549805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1793050765991211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5965, 47])
h_self size  torch.Size([5965, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1793050765991211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18034982681274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1793050765991211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5965, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17924165725708008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18082904815673828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05946779251098633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 13 input nodes size: 179375
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04767131805419922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04767131805419922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11449384689331055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11453866958618164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06903457641601562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07413196563720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07413196563720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 179375
first layer output nodes number: 55447
edges number: 541544
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([179375, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10173940658569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10173940658569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1546177864074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([55447, 256])
h_self size  torch.Size([55447, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1546177864074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55447, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20749616622924805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1546177864074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([55447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20749616622924805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22071599960327148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 55447
----------------output nodes number: 5980
----------------edges number: 142494
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2211742401123047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2211742401123047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.227996826171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.227996826171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.229583740234375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5980, 47])
h_self size  torch.Size([5980, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.229583740234375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5980, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23063087463378906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22904396057128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5980, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22958612442016602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23124408721923828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08443832397460938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 14 input nodes size: 168391
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06957674026489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06957674026489258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1323075294494629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13235235214233398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06548500061035156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07056808471679688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07056808471679688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 168391
first layer output nodes number: 54363
edges number: 534429
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07269573211669922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([168391, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07269573211669922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07269573211669922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09713315963745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09713315963745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14897775650024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([54363, 256])
h_self size  torch.Size([54363, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14897775650024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54363, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2008223533630371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14897775650024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54363, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2008223533630371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21378374099731445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 54363
----------------output nodes number: 6009
----------------edges number: 147693
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2142338752746582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2142338752746582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22110986709594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22110986709594727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22275829315185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6009, 47])
h_self size  torch.Size([6009, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22275829315185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6009, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22417020797729492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22252178192138672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6009, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22198724746704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22363615036010742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0792226791381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 15 input nodes size: 188919
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06495046615600586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06495046615600586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1353282928466797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13537311553955078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07259750366210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07782459259033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07782459259033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 188919
first layer output nodes number: 58161
edges number: 563545
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07966995239257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([188919, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07966995239257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07966995239257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10653495788574219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10653495788574219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1620016098022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58161, 256])
h_self size  torch.Size([58161, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1620016098022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58161, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21746826171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1620016098022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58161, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21746826171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23133516311645508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58161
----------------output nodes number: 5963
----------------edges number: 137955
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2318134307861328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2318134307861328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2385730743408203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2385730743408203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23979663848876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23979663848876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24084091186523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23961734771728516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2396092414855957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24083328247070312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08763360977172852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 16 input nodes size: 126774
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07258939743041992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07258939743041992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11981678009033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11986398696899414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.04944133758544922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05430746078491211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05430746078491211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 126774
first layer output nodes number: 46802
edges number: 447049
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05560111999511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([126774, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05560111999511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05560111999511719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07697248458862305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07697248458862305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12189435958862305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([46802, 256])
h_self size  torch.Size([46802, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12189435958862305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46802, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16652822494506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12160634994506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46802, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16652822494506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.177398681640625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 46802
----------------output nodes number: 6303
----------------edges number: 149943
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1777949333190918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1777949333190918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18497133255004883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18497133255004883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18657207489013672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6303, 47])
h_self size  torch.Size([6303, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18657207489013672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6303, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18767595291137695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18607521057128906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6303, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1866316795349121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18861675262451172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06292343139648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 17 input nodes size: 197694
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.049997806549072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.049997806549072266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12364482879638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12368965148925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0764150619506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08194303512573242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08194303512573242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 197694
first layer output nodes number: 52826
edges number: 513474
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08380985260009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([197694, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08380985260009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08380985260009766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10831308364868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10831308364868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1586918830871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52826, 256])
h_self size  torch.Size([52826, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1586918830871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52826, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20907068252563477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1586918830871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52826, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20907068252563477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2216653823852539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52826
----------------output nodes number: 6004
----------------edges number: 140850
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22210407257080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22210407257080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22892475128173828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22892475128173828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22997617721557617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6004, 47])
h_self size  torch.Size([6004, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22997617721557617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6004, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23102760314941406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22997617721557617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6004, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22942686080932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2308650016784668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09084224700927734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 18 input nodes size: 208820
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0758657455444336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0758657455444336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1536574363708496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15370464324951172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08001279830932617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08575677871704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08575677871704102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 208820
first layer output nodes number: 62656
edges number: 616400
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08816671371459961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([208820, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08816671371459961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08816671371459961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11633443832397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11633443832397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1768813133239746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62656, 256])
h_self size  torch.Size([62656, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1768813133239746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62656, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2374281883239746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1768813133239746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62656, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2374281883239746  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2523665428161621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62656
----------------output nodes number: 6313
----------------edges number: 154446
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2528805732727051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2528805732727051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2600998878479004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2600998878479004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2615375518798828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6313, 47])
h_self size  torch.Size([6313, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2615375518798828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26264333724975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26120567321777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6313, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26159191131591797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2630953788757324  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09645318984985352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 19 input nodes size: 220812
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0803990364074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0803990364074707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1626582145690918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1627054214477539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08486652374267578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09110546112060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09110546112060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 220812
first layer output nodes number: 68550
edges number: 680453
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0932621955871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([220812, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0932621955871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0932621955871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12441158294677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12441158294677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18978595733642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68550, 256])
h_self size  torch.Size([68550, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18978595733642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68550, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2551603317260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18978595733642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68550, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2551603317260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27150392532348633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68550
----------------output nodes number: 6299
----------------edges number: 156723
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2720623016357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2720623016357422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2792854309082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2792854309082031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28038835525512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6299, 47])
h_self size  torch.Size([6299, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28038835525512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6299, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2814912796020508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28038835525512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6299, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28005361557006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2818331718444824  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1017141342163086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 20 input nodes size: 253848
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08453178405761719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08453178405761719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17909765243530273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17914295196533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09683656692504883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10294485092163086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10294485092163086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 253848
first layer output nodes number: 67807
edges number: 671883
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10544013977050781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([253848, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10544013977050781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10544013977050781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13596010208129883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13596010208129883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20062589645385742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([67807, 256])
h_self size  torch.Size([67807, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20062589645385742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67807, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.265291690826416  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20062589645385742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67807, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.265291690826416  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28145837783813477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 67807
----------------output nodes number: 6072
----------------edges number: 147738
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2820091247558594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2820091247558594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28894710540771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28894710540771484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2903585433959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6072, 47])
h_self size  torch.Size([6072, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2903585433959961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6072, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2920989990234375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.29068756103515625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6072, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.29099607467651367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2927370071411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11403751373291016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 21 input nodes size: 278395
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09714508056640625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09714508056640625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20085573196411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20090055465698242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10628938674926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11196374893188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11196374893188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 278395
first layer output nodes number: 64474
edges number: 627651
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11451864242553711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([278395, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11451864242553711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11451864242553711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14351654052734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14351654052734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2050037384033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([64474, 256])
h_self size  torch.Size([64474, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2050037384033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64474, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2664909362792969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2050037384033203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([64474, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2664909362792969  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.281862735748291  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 64474
----------------output nodes number: 5963
----------------edges number: 133767
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28238821029663086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28238821029663086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28911733627319336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28911733627319336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2901616096496582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2901616096496582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.29165124893188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2906069755554199  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2902398109436035  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.29128456115722656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12191390991210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 22 input nodes size: 251997
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10592222213745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10592222213745117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.199798583984375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1998434066772461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09608793258666992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10156059265136719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10156059265136719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 251997
first layer output nodes number: 54144
edges number: 531776
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10384178161621094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([251997, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10384178161621094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10384178161621094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12817668914794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12817668914794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17981243133544922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([54144, 256])
h_self size  torch.Size([54144, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17981243133544922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54144, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23144817352294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17981243133544922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([54144, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23144817352294922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24435710906982422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 54144
----------------output nodes number: 5978
----------------edges number: 128435
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24480533599853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24480533599853516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2515087127685547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2515087127685547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2527656555175781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5978, 47])
h_self size  torch.Size([5978, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2527656555175781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5978, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2538127899169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25255584716796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5978, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25276851654052734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2544980049133301  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11080694198608398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 23 input nodes size: 289044
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09630060195922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09630060195922852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2039780616760254  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20402288436889648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11010169982910156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1161813735961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1161813735961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 289044
first layer output nodes number: 67703
edges number: 670394
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11883974075317383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([289044, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11883974075317383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11883974075317383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1493086814880371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1493086814880371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21387529373168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([67703, 256])
h_self size  torch.Size([67703, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21387529373168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67703, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2784419059753418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21387529373168945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67703, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2784419059753418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.294583797454834  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 67703
----------------output nodes number: 5967
----------------edges number: 145411
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.295133113861084  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.295133113861084  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3019528388977051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3019528388977051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.303558349609375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5967, 47])
h_self size  torch.Size([5967, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.303558349609375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5967, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30539798736572266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30379247665405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5967, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3041410446166992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30583906173706055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12742853164672852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 24 input nodes size: 162071
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11045026779174805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11045026779174805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17099714279174805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17104434967041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06332206726074219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06884002685546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06884002685546875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 162071
first layer output nodes number: 58854
edges number: 583125
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07048654556274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([162071, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07048654556274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07048654556274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09697580337524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09697580337524414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15310335159301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([58854, 256])
h_self size  torch.Size([58854, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15310335159301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58854, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20923089981079102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15310335159301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([58854, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20923089981079102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22326278686523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 58854
----------------output nodes number: 6310
----------------edges number: 157334
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22374868392944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22374868392944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2309870719909668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2309870719909668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23209190368652344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6310, 47])
h_self size  torch.Size([6310, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23209190368652344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6310, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23319673538208008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23209190368652344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6310, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23184776306152344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23295307159423828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0778818130493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 25 input nodes size: 228622
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06307792663574219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06307792663574219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14824628829956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14829349517822266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08769941329956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09382104873657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09382104873657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 228622
first layer output nodes number: 66923
edges number: 664342
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0960235595703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([228622, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0960235595703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0960235595703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12615442276000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12615442276000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19060754776000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([66923, 256])
h_self size  torch.Size([66923, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19060754776000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66923, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25506067276000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19060754776000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66923, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25506067276000977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27101659774780273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 66923
----------------output nodes number: 6327
----------------edges number: 157144
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2715625762939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2715625762939453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27881526947021484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27881526947021484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28049325942993164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28049325942993164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2816014289855957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2799234390258789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2802400588989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28232240676879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10470151901245117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 26 input nodes size: 235625
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08801603317260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08801603317260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17579364776611328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17583990097045898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09062433242797852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09675073623657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09675073623657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 235625
first layer output nodes number: 67811
edges number: 671156
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09901189804077148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([235625, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09901189804077148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09901189804077148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12952756881713867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12952756881713867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1941971778869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([67811, 256])
h_self size  torch.Size([67811, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1941971778869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67811, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2588667869567871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1941971778869629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67811, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2588667869567871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27503442764282227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 67811
----------------output nodes number: 6152
----------------edges number: 150943
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2755861282348633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2755861282348633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2826251983642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2826251983642578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28403568267822266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6152, 47])
h_self size  torch.Size([6152, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28403568267822266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6152, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28577232360839844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2843618392944336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6152, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28409433364868164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2858314514160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10707664489746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 27 input nodes size: 231020
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09035682678222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09035682678222656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17641878128051758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1764659881591797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08864212036132812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0955510139465332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0955510139465332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 231020
first layer output nodes number: 68991
edges number: 683944
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09778642654418945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([231020, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09778642654418945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09778642654418945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12884140014648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12884140014648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19524765014648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68991, 256])
h_self size  torch.Size([68991, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19524765014648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68991, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2616539001464844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19524765014648438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68991, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2616539001464844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27892112731933594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68991
----------------output nodes number: 6327
----------------edges number: 157521
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.279482364654541  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.279482364654541  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28673791885375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28673791885375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28784608840942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6327, 47])
h_self size  torch.Size([6327, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28784608840942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2889542579650879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28784608840942383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6327, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28754377365112305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2886524200439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10602760314941406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 28 input nodes size: 171337
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08833980560302734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08833980560302734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15279293060302734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15283823013305664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06672906875610352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07147836685180664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07147836685180664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 171337
first layer output nodes number: 49640
edges number: 489970
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07312536239624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([171337, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07312536239624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07312536239624023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09604406356811523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09604406356811523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14338445663452148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([49640, 256])
h_self size  torch.Size([49640, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14338445663452148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49640, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19072484970092773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.14338445663452148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([49640, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19072484970092773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2025599479675293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 49640
----------------output nodes number: 6017
----------------edges number: 147452
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20297527313232422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20297527313232422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20985794067382812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20985794067382812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21134567260742188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6017, 47])
h_self size  torch.Size([6017, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21134567260742188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2133035659790039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21181583404541016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21219539642333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2136836051940918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08075141906738281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 29 input nodes size: 184461
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0671086311340332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0671086311340332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13582611083984375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13587284088134766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07137441635131836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07703542709350586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07703542709350586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 184461
first layer output nodes number: 61259
edges number: 604449
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07886695861816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([184461, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07886695861816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07886695861816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10642051696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10642051696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16501426696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([61259, 256])
h_self size  torch.Size([61259, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16501426696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61259, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22360801696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16501426696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61259, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22360801696777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23821353912353516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 61259
----------------output nodes number: 6258
----------------edges number: 155221
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23871707916259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23871707916259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24588871002197266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24588871002197266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24716520309448242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6258, 47])
h_self size  torch.Size([6258, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24716520309448242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6258, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2489795684814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24770307540893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6258, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24749183654785156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2490677833557129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0864572525024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 30 input nodes size: 219724
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07116317749023438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07116317749023438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15319442749023438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15324163436889648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08447742462158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09071540832519531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09071540832519531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 219724
first layer output nodes number: 68354
edges number: 679459
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09286260604858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([219724, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09286260604858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09286260604858398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12364482879638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12364482879638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18883228302001953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68354, 256])
h_self size  torch.Size([68354, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18883228302001953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68354, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25401973724365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18883228302001953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68354, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25401973724365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27031660079956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68354
----------------output nodes number: 6319
----------------edges number: 157628
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2708735466003418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2708735466003418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2781224250793457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2781224250793457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2793302536010742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6319, 47])
h_self size  torch.Size([6319, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2793302536010742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6319, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2805490493774414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2793412208557129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6319, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27927255630493164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.28049182891845703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10129785537719727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 31 input nodes size: 186402
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08440876007080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08440876007080078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15389394760131836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07181549072265625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07689952850341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07689952850341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 186402
first layer output nodes number: 53843
edges number: 532498
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0786900520324707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([186402, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0786900520324707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0786900520324707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10291719436645508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10291719436645508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1542658805847168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([53843, 256])
h_self size  torch.Size([53843, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1542658805847168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([53843, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20561456680297852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1542658805847168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([53843, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20561456680297852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21845197677612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 53843
----------------output nodes number: 6014
----------------edges number: 149645
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21889829635620117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21889829635620117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22579431533813477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22579431533813477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22713756561279297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6014, 47])
h_self size  torch.Size([6014, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22713756561279297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6014, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22878217697143555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22743892669677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6014, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22757434844970703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22878265380859375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08589553833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08589553833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08589553833007812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03442966192960739 |0.004821427166461945 |0.010995551943778992 |0.00013067573308944702 |0.002713710069656372 |0.0010745525360107422 |
----------------------------------------------------------pseudo_mini_loss sum 1.6215839385986328
Total (block generation + training)time/epoch 62.824408292770386
Training time/epoch 1.7915623188018799
Training time without block to device /epoch 1.6372766494750977
Training time without total dataloading part /epoch 0.4439525604248047
load block tensor time/epoch 1.1017491817474365
block to device time/epoch 0.15428566932678223
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8290369
Number of first layer input nodes during this epoch:  6403296
Number of first layer output nodes during this epoch:  1887073
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08589506149291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2798349857330322
global_2_local spend time (sec) 0.4900329113006592

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.925 seconds
Metis partitioning: 15.383 seconds
Split the graph: 0.862 seconds
Construct subgraphs: 0.395 seconds
6157
6304
5966
6083
6088
6305
6272
5963
6026
5993
5963
6316
6324
5963
6070
6102
6312
6006
5963
5973
5985
6216
6314
5963
6285
6263
6323
5967
6154
6304
6323
6325
REG metis partition end ----................................
the time spent:  28.694668769836426
total k batches seeds list generation spend  29.240071058273315
after graph partition
graph partition algorithm spend time 29.72703528404236

partition_len_list
[60605, 56248, 51081, 45198, 62151, 52101, 57079, 71404, 57133, 62952, 72824, 61969, 65861, 67134, 56724, 50363, 46952, 52982, 57190, 63897, 51919, 45985, 45227, 57844, 70617, 69101, 62147, 62289, 53681, 66376, 68940, 66941]
REG selection method  spend 30.437856912612915
check_connections_block*********************************
time for parepare 1: 0.2286367416381836
local_output_nid generation: 0.0022628307342529297
local_in_edges_tensor generation: 0.0027718544006347656
mini_batch_src_global generation: 0.00554966926574707

&&&&&&&&&&&&&&& before remove duplicate length: 150296
r_  generation: 0.04992341995239258

local_output_nid generation: 0.002671480178833008
local_in_edges_tensor generation: 0.0026886463165283203
mini_batch_src_global generation: 0.006325960159301758

&&&&&&&&&&&&&&& before remove duplicate length: 153478
r_  generation: 0.05291152000427246

local_output_nid generation: 0.002583026885986328
local_in_edges_tensor generation: 0.0025780200958251953
mini_batch_src_global generation: 0.00439000129699707

&&&&&&&&&&&&&&& before remove duplicate length: 144479
r_  generation: 0.04967498779296875

local_output_nid generation: 0.0026657581329345703
local_in_edges_tensor generation: 0.002638578414916992
mini_batch_src_global generation: 0.004840373992919922

&&&&&&&&&&&&&&& before remove duplicate length: 145903
r_  generation: 0.05123090744018555

local_output_nid generation: 0.0026159286499023438
local_in_edges_tensor generation: 0.002638578414916992
mini_batch_src_global generation: 0.0054912567138671875

&&&&&&&&&&&&&&& before remove duplicate length: 147088
r_  generation: 0.052512168884277344

local_output_nid generation: 0.0027208328247070312
local_in_edges_tensor generation: 0.0027184486389160156
mini_batch_src_global generation: 0.005391836166381836

&&&&&&&&&&&&&&& before remove duplicate length: 152493
r_  generation: 0.05411696434020996

local_output_nid generation: 0.0027341842651367188
local_in_edges_tensor generation: 0.0029036998748779297
mini_batch_src_global generation: 0.004877805709838867

&&&&&&&&&&&&&&& before remove duplicate length: 152368
r_  generation: 0.05698823928833008

local_output_nid generation: 0.0025861263275146484
local_in_edges_tensor generation: 0.0028350353240966797
mini_batch_src_global generation: 0.005624294281005859

&&&&&&&&&&&&&&& before remove duplicate length: 141793
r_  generation: 0.051644086837768555

local_output_nid generation: 0.002629995346069336
local_in_edges_tensor generation: 0.0024988651275634766
mini_batch_src_global generation: 0.004779815673828125

&&&&&&&&&&&&&&& before remove duplicate length: 128066
r_  generation: 0.04612898826599121

local_output_nid generation: 0.002613544464111328
local_in_edges_tensor generation: 0.0028350353240966797
mini_batch_src_global generation: 0.004769802093505859

&&&&&&&&&&&&&&& before remove duplicate length: 147882
r_  generation: 0.0542140007019043

local_output_nid generation: 0.002597332000732422
local_in_edges_tensor generation: 0.0028069019317626953
mini_batch_src_global generation: 0.005181789398193359

&&&&&&&&&&&&&&& before remove duplicate length: 146971
r_  generation: 0.05369687080383301

local_output_nid generation: 0.0027418136596679688
local_in_edges_tensor generation: 0.0029315948486328125
mini_batch_src_global generation: 0.005558967590332031

&&&&&&&&&&&&&&& before remove duplicate length: 157445
r_  generation: 0.05885648727416992

local_output_nid generation: 0.0027434825897216797
local_in_edges_tensor generation: 0.002799510955810547
mini_batch_src_global generation: 0.005529642105102539

&&&&&&&&&&&&&&& before remove duplicate length: 156557
r_  generation: 0.05760645866394043

local_output_nid generation: 0.002591371536254883
local_in_edges_tensor generation: 0.002582550048828125
mini_batch_src_global generation: 0.005435943603515625

&&&&&&&&&&&&&&& before remove duplicate length: 147753
r_  generation: 0.0558466911315918

local_output_nid generation: 0.0026433467864990234
local_in_edges_tensor generation: 0.002613067626953125
mini_batch_src_global generation: 0.00528264045715332

&&&&&&&&&&&&&&& before remove duplicate length: 149369
r_  generation: 0.05670046806335449

local_output_nid generation: 0.0026428699493408203
local_in_edges_tensor generation: 0.005334615707397461
mini_batch_src_global generation: 0.0052204132080078125

&&&&&&&&&&&&&&& before remove duplicate length: 149709
r_  generation: 0.05409383773803711

local_output_nid generation: 0.002724885940551758
local_in_edges_tensor generation: 0.004554033279418945
mini_batch_src_global generation: 0.005236625671386719

&&&&&&&&&&&&&&& before remove duplicate length: 150143
r_  generation: 0.0527341365814209

local_output_nid generation: 0.002592325210571289
local_in_edges_tensor generation: 0.003314971923828125
mini_batch_src_global generation: 0.004854679107666016

&&&&&&&&&&&&&&& before remove duplicate length: 141265
r_  generation: 0.0731806755065918

local_output_nid generation: 0.003003835678100586
local_in_edges_tensor generation: 0.0047473907470703125
mini_batch_src_global generation: 0.007054328918457031

&&&&&&&&&&&&&&& before remove duplicate length: 147692
r_  generation: 0.05586504936218262

local_output_nid generation: 0.0026743412017822266
local_in_edges_tensor generation: 0.0037338733673095703
mini_batch_src_global generation: 0.006117343902587891

&&&&&&&&&&&&&&& before remove duplicate length: 145181
r_  generation: 0.05463242530822754

local_output_nid generation: 0.002661466598510742
local_in_edges_tensor generation: 0.003025054931640625
mini_batch_src_global generation: 0.005066633224487305

&&&&&&&&&&&&&&& before remove duplicate length: 142337
r_  generation: 0.05189847946166992

local_output_nid generation: 0.0027501583099365234
local_in_edges_tensor generation: 0.003069639205932617
mini_batch_src_global generation: 0.004995107650756836

&&&&&&&&&&&&&&& before remove duplicate length: 146879
r_  generation: 0.05179762840270996

local_output_nid generation: 0.0027806758880615234
local_in_edges_tensor generation: 0.003284931182861328
mini_batch_src_global generation: 0.0053365230560302734

&&&&&&&&&&&&&&& before remove duplicate length: 155282
r_  generation: 0.05446028709411621

local_output_nid generation: 0.0026471614837646484
local_in_edges_tensor generation: 0.002550363540649414
mini_batch_src_global generation: 0.00506281852722168

&&&&&&&&&&&&&&& before remove duplicate length: 139892
r_  generation: 0.05076432228088379

local_output_nid generation: 0.0027675628662109375
local_in_edges_tensor generation: 0.0031630992889404297
mini_batch_src_global generation: 0.005989789962768555

&&&&&&&&&&&&&&& before remove duplicate length: 156341
r_  generation: 0.058806657791137695

local_output_nid generation: 0.002762317657470703
local_in_edges_tensor generation: 0.0031151771545410156
mini_batch_src_global generation: 0.0057888031005859375

&&&&&&&&&&&&&&& before remove duplicate length: 156159
r_  generation: 0.05941462516784668

local_output_nid generation: 0.0027832984924316406
local_in_edges_tensor generation: 0.002615690231323242
mini_batch_src_global generation: 0.005316972732543945

&&&&&&&&&&&&&&& before remove duplicate length: 141945
r_  generation: 0.05214118957519531

local_output_nid generation: 0.0026755332946777344
local_in_edges_tensor generation: 0.0027823448181152344
mini_batch_src_global generation: 0.005082130432128906

&&&&&&&&&&&&&&& before remove duplicate length: 143726
r_  generation: 0.0509486198425293

local_output_nid generation: 0.0026764869689941406
local_in_edges_tensor generation: 0.002866506576538086
mini_batch_src_global generation: 0.005422830581665039

&&&&&&&&&&&&&&& before remove duplicate length: 153186
r_  generation: 0.05752444267272949

local_output_nid generation: 0.002762317657470703
local_in_edges_tensor generation: 0.0029973983764648438
mini_batch_src_global generation: 0.005644559860229492

&&&&&&&&&&&&&&& before remove duplicate length: 157365
r_  generation: 0.058835744857788086

local_output_nid generation: 0.0027818679809570312
local_in_edges_tensor generation: 0.003149271011352539
mini_batch_src_global generation: 0.0058100223541259766

&&&&&&&&&&&&&&& before remove duplicate length: 157371
r_  generation: 0.059793710708618164

local_output_nid generation: 0.0027675628662109375
local_in_edges_tensor generation: 0.0029473304748535156
mini_batch_src_global generation: 0.0057642459869384766

&&&&&&&&&&&&&&& before remove duplicate length: 157465
r_  generation: 0.05953049659729004


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7465543746948242
gen group dst list time:  0.07161402702331543
check_connections_block*********************************
time for parepare 1: 0.39278602600097656
local_output_nid generation: 0.018582582473754883
local_in_edges_tensor generation: 0.07035589218139648
mini_batch_src_global generation: 0.022703886032104492

&&&&&&&&&&&&&&& before remove duplicate length: 590165
r_  generation: 0.2444765567779541

local_output_nid generation: 0.02217721939086914
local_in_edges_tensor generation: 0.02882242202758789
mini_batch_src_global generation: 0.02462148666381836

&&&&&&&&&&&&&&& before remove duplicate length: 548480
r_  generation: 0.22974109649658203

local_output_nid generation: 0.02418041229248047
local_in_edges_tensor generation: 0.026337146759033203
mini_batch_src_global generation: 0.019253969192504883

&&&&&&&&&&&&&&& before remove duplicate length: 492295
r_  generation: 0.21194720268249512

local_output_nid generation: 0.014756441116333008
local_in_edges_tensor generation: 0.020012378692626953
mini_batch_src_global generation: 0.01959991455078125

&&&&&&&&&&&&&&& before remove duplicate length: 435473
r_  generation: 0.18204784393310547

local_output_nid generation: 0.0196990966796875
local_in_edges_tensor generation: 0.024976491928100586
mini_batch_src_global generation: 0.02483081817626953

&&&&&&&&&&&&&&& before remove duplicate length: 599515
r_  generation: 0.2789466381072998

local_output_nid generation: 0.017039060592651367
local_in_edges_tensor generation: 0.01733708381652832
mini_batch_src_global generation: 0.02854132652282715

&&&&&&&&&&&&&&& before remove duplicate length: 501303
r_  generation: 0.2325282096862793

local_output_nid generation: 0.01799774169921875
local_in_edges_tensor generation: 0.029072046279907227
mini_batch_src_global generation: 0.031232833862304688

&&&&&&&&&&&&&&& before remove duplicate length: 552144
r_  generation: 0.259418249130249

local_output_nid generation: 0.038643598556518555
local_in_edges_tensor generation: 0.034215688705444336
mini_batch_src_global generation: 0.03218531608581543

&&&&&&&&&&&&&&& before remove duplicate length: 689463
r_  generation: 0.32608914375305176

local_output_nid generation: 0.020888090133666992
local_in_edges_tensor generation: 0.023476600646972656
mini_batch_src_global generation: 0.02732992172241211

&&&&&&&&&&&&&&& before remove duplicate length: 560772
r_  generation: 0.28361058235168457

local_output_nid generation: 0.020984649658203125
local_in_edges_tensor generation: 0.021279335021972656
mini_batch_src_global generation: 0.027902841567993164

&&&&&&&&&&&&&&& before remove duplicate length: 623674
r_  generation: 0.3124246597290039

local_output_nid generation: 0.023048877716064453
local_in_edges_tensor generation: 0.02487945556640625
mini_batch_src_global generation: 0.03407573699951172

&&&&&&&&&&&&&&& before remove duplicate length: 720845
r_  generation: 0.35256433486938477

local_output_nid generation: 0.019931554794311523
local_in_edges_tensor generation: 0.020701169967651367
mini_batch_src_global generation: 0.03275275230407715

&&&&&&&&&&&&&&& before remove duplicate length: 614462
r_  generation: 0.2984001636505127

local_output_nid generation: 0.02175140380859375
local_in_edges_tensor generation: 0.025360107421875
mini_batch_src_global generation: 0.03222298622131348

&&&&&&&&&&&&&&& before remove duplicate length: 652291
r_  generation: 0.3261139392852783

local_output_nid generation: 0.021973609924316406
local_in_edges_tensor generation: 0.020252227783203125
mini_batch_src_global generation: 0.03487253189086914

&&&&&&&&&&&&&&& before remove duplicate length: 665358
r_  generation: 0.3252122402191162

local_output_nid generation: 0.01928424835205078
local_in_edges_tensor generation: 0.021908044815063477
mini_batch_src_global generation: 0.02809453010559082

&&&&&&&&&&&&&&& before remove duplicate length: 558966
r_  generation: 0.29851484298706055

local_output_nid generation: 0.024407625198364258
local_in_edges_tensor generation: 0.04172492027282715
mini_batch_src_global generation: 0.0259397029876709

&&&&&&&&&&&&&&& before remove duplicate length: 489927
r_  generation: 0.24044036865234375

local_output_nid generation: 0.014704465866088867
local_in_edges_tensor generation: 0.03446769714355469
mini_batch_src_global generation: 0.022146224975585938

&&&&&&&&&&&&&&& before remove duplicate length: 448661
r_  generation: 0.22155165672302246

local_output_nid generation: 0.031673431396484375
local_in_edges_tensor generation: 0.029163599014282227
mini_batch_src_global generation: 0.026089191436767578

&&&&&&&&&&&&&&& before remove duplicate length: 515133
r_  generation: 0.24733972549438477

local_output_nid generation: 0.019690275192260742
local_in_edges_tensor generation: 0.02269768714904785
mini_batch_src_global generation: 0.027289152145385742

&&&&&&&&&&&&&&& before remove duplicate length: 567201
r_  generation: 0.25908350944519043

local_output_nid generation: 0.020270347595214844
local_in_edges_tensor generation: 0.020993709564208984
mini_batch_src_global generation: 0.029002904891967773

&&&&&&&&&&&&&&& before remove duplicate length: 625659
r_  generation: 0.29889392852783203

local_output_nid generation: 0.01733565330505371
local_in_edges_tensor generation: 0.016526460647583008
mini_batch_src_global generation: 0.026271581649780273

&&&&&&&&&&&&&&& before remove duplicate length: 506382
r_  generation: 0.2314462661743164

local_output_nid generation: 0.014971494674682617
local_in_edges_tensor generation: 0.012054681777954102
mini_batch_src_global generation: 0.021816253662109375

&&&&&&&&&&&&&&& before remove duplicate length: 445447
r_  generation: 0.19800877571105957

local_output_nid generation: 0.01468038558959961
local_in_edges_tensor generation: 0.012523889541625977
mini_batch_src_global generation: 0.022133588790893555

&&&&&&&&&&&&&&& before remove duplicate length: 441781
r_  generation: 0.1968832015991211

local_output_nid generation: 0.018987655639648438
local_in_edges_tensor generation: 0.015340566635131836
mini_batch_src_global generation: 0.025916576385498047

&&&&&&&&&&&&&&& before remove duplicate length: 562214
r_  generation: 0.2521944046020508

local_output_nid generation: 0.022076129913330078
local_in_edges_tensor generation: 0.02088332176208496
mini_batch_src_global generation: 0.03064870834350586

&&&&&&&&&&&&&&& before remove duplicate length: 701012
r_  generation: 0.3326990604400635

local_output_nid generation: 0.023578643798828125
local_in_edges_tensor generation: 0.022726058959960938
mini_batch_src_global generation: 0.03227686882019043

&&&&&&&&&&&&&&& before remove duplicate length: 686566
r_  generation: 0.3351438045501709

local_output_nid generation: 0.020876407623291016
local_in_edges_tensor generation: 0.020415782928466797
mini_batch_src_global generation: 0.0315396785736084

&&&&&&&&&&&&&&& before remove duplicate length: 608518
r_  generation: 0.31000709533691406

local_output_nid generation: 0.021538972854614258
local_in_edges_tensor generation: 0.02196669578552246
mini_batch_src_global generation: 0.031980037689208984

&&&&&&&&&&&&&&& before remove duplicate length: 616134
r_  generation: 0.31200528144836426

local_output_nid generation: 0.017259597778320312
local_in_edges_tensor generation: 0.015422344207763672
mini_batch_src_global generation: 0.027942657470703125

&&&&&&&&&&&&&&& before remove duplicate length: 531251
r_  generation: 0.2498311996459961

local_output_nid generation: 0.02150416374206543
local_in_edges_tensor generation: 0.017462491989135742
mini_batch_src_global generation: 0.03164052963256836

&&&&&&&&&&&&&&& before remove duplicate length: 658407
r_  generation: 0.3095428943634033

local_output_nid generation: 0.02230691909790039
local_in_edges_tensor generation: 0.021706104278564453
mini_batch_src_global generation: 0.0326685905456543

&&&&&&&&&&&&&&& before remove duplicate length: 683421
r_  generation: 0.3285830020904541

local_output_nid generation: 0.02208113670349121
local_in_edges_tensor generation: 0.018012046813964844
mini_batch_src_global generation: 0.03137326240539551

&&&&&&&&&&&&&&& before remove duplicate length: 663492
r_  generation: 0.32419705390930176


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08589506149291992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

connection checking time:  16.36568593978882
block generation total time  13.574312925338745
average batch blocks generation time:  0.4241972789168358
block dataloader generation time/epoch 61.51679436365763
pseudo mini batch 0 input nodes size: 227947
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07194995880126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07194995880126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15686702728271484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15691328048706055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08742809295654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09294605255126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09294605255126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 227947
first layer output nodes number: 60605
edges number: 590165
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09588003158569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([227947, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09588003158569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09588003158569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12308073043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12308073043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18167448043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([60605, 256])
h_self size  torch.Size([60605, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18167448043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60605, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24026823043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18167448043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([60605, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24026823043823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2547178268432617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 60605
----------------output nodes number: 6157
----------------edges number: 150296
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2552156448364258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2552156448364258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2622547149658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2622547149658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26369190216064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6157, 47])
h_self size  torch.Size([6157, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26369190216064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2647700309753418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2633328437805176  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26306772232055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26450586318969727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10322761535644531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 1 input nodes size: 177647
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08716392517089844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08716392517089844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15357017517089844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.15361738204956055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06865406036376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07388496398925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07388496398925781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 177647
first layer output nodes number: 56248
edges number: 548480
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0762643814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([177647, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0762643814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0762643814086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10166168212890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10166168212890625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.155303955078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([56248, 256])
h_self size  torch.Size([56248, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.155303955078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56248, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20894622802734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.155303955078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56248, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20894622802734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.22235679626464844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 56248
----------------output nodes number: 6304
----------------edges number: 153478
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2228231430053711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2228231430053711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2300271987915039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2300271987915039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23113107681274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6304, 47])
h_self size  torch.Size([6304, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23113107681274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23309087753295898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23198699951171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23201274871826172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23311710357666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08372211456298828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 2 input nodes size: 163443
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0686798095703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0686798095703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12956714630126953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.12961196899414062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06315851211547852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06790399551391602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06790399551391602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 163443
first layer output nodes number: 51081
edges number: 492295
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06951427459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([163443, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06951427459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06951427459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.093475341796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.142303466796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([51081, 256])
h_self size  torch.Size([51081, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.142303466796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51081, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.191131591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.142303466796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51081, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.191131591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20331048965454102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 51081
----------------output nodes number: 5966
----------------edges number: 144479
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2037363052368164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2037363052368164  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21054744720458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21054744720458984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2121601104736328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5966, 47])
h_self size  torch.Size([5966, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2121601104736328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5966, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21320486068725586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2115921974182129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5966, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21210098266601562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21320533752441406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07724523544311523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 3 input nodes size: 131376
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06366729736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06366729736328125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1126089096069336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1126546859741211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05172252655029297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05605506896972656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05605506896972656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 131376
first layer output nodes number: 45198
edges number: 435473
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05737113952636719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([131376, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05737113952636719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05737113952636719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07762289047241211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07762289047241211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1207270622253418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([45198, 256])
h_self size  torch.Size([45198, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1207270622253418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45198, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16383123397827148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1207270622253418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45198, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16383123397827148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1746072769165039  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 45198
----------------output nodes number: 6083
----------------edges number: 145903
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17499017715454102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17499017715454102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18192434310913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18192434310913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18298959732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6083, 47])
h_self size  torch.Size([6083, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18298959732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6083, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18405485153198242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18298959732055664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6083, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18300533294677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18407106399536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06354999542236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 4 input nodes size: 203539
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05173826217651367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.05173826217651367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1275625228881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1276082992553711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07862091064453125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08425188064575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08425188064575195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 203539
first layer output nodes number: 62151
edges number: 599515
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08623218536376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([203539, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08623218536376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08623218536376953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11451101303100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11451101303100586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1737828254699707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62151, 256])
h_self size  torch.Size([62151, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1737828254699707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62151, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23305463790893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1737828254699707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62151, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23305463790893555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24787282943725586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62151
----------------output nodes number: 6088
----------------edges number: 147088
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2483820915222168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2483820915222168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25533056259155273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25533056259155273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2566056251525879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6088, 47])
h_self size  torch.Size([6088, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2566056251525879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6088, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2576718330383301  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2563967704772949  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6088, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2560434341430664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25731897354125977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09396171569824219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 5 input nodes size: 159181
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07826757431030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07826757431030273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13756752014160156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13761472702026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06174468994140625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06661701202392578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06661701202392578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 159181
first layer output nodes number: 52101
edges number: 501303
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0682525634765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([159181, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0682525634765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.0682525634765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09171390533447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09171390533447266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1414012908935547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52101, 256])
h_self size  torch.Size([52101, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1414012908935547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52101, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19108867645263672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1414012908935547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52101, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.19108867645263672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20351076126098633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52101
----------------output nodes number: 6305
----------------edges number: 152493
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20394659042358398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20394659042358398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21114397048950195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21114397048950195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2122483253479004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6305, 47])
h_self size  torch.Size([6305, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2122483253479004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6305, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21335268020629883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2122483253479004  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6305, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21207761764526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2138671875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07493972778320312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 6 input nodes size: 190648
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06157398223876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.06157398223876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13259601593017578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1326427459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07329559326171875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07854557037353516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07854557037353516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 190648
first layer output nodes number: 57079
edges number: 552144
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08076000213623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([190648, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08076000213623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08076000213623047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10772371292114258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10772371292114258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16215848922729492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57079, 256])
h_self size  torch.Size([57079, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16215848922729492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57079, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21659326553344727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.16215848922729492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57079, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.21659326553344727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23020219802856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57079
----------------output nodes number: 6272
----------------edges number: 152368
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23067426681518555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23067426681518555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2382183074951172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2382183074951172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23931646347045898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6272, 47])
h_self size  torch.Size([6272, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23931646347045898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6272, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.24041461944580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23931646347045898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6272, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.23931026458740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2412734031677246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.08899259567260742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 7 input nodes size: 259986
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07328939437866211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.07328939437866211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17014217376708984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.17018699645996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09911823272705078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10531234741210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10531234741210938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 259986
first layer output nodes number: 71404
edges number: 689463
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10780715942382812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([259986, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10780715942382812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10780715942382812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13981103897094727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13981103897094727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20817041397094727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([71404, 256])
h_self size  torch.Size([71404, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20817041397094727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([71404, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27626657485961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.20790719985961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([71404, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.27626657485961914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2932906150817871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 71404
----------------output nodes number: 5963
----------------edges number: 141793
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2938675880432129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2938675880432129  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3006558418273926  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3006558418273926  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3017001152038574  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3017001152038574  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30274438858032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3017001152038574  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.3020648956298828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.30310964584350586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.11655426025390625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 8 input nodes size: 262610
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09948301315307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.09948301315307617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1973133087158203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.1973586082458496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10046100616455078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10559463500976562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10559463500976562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 262610
first layer output nodes number: 57133
edges number: 560772
----------------------------------------before model layer 0
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10797739028930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([262610, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10797739028930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.10797739028930664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13405418395996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.13405418395996094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18854045867919922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57133, 256])
h_self size  torch.Size([57133, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18854045867919922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57133, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2430267333984375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.18854045867919922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57133, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2430267333984375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25664854049682617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57133
----------------output nodes number: 6026
----------------edges number: 128066
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25711965560913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.25711965560913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2638669013977051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2638669013977051  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26509666442871094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6026, 47])
h_self size  torch.Size([6026, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26509666442871094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6026, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.26615190505981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2649221420288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6026, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.2645144462585449  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6072998046875 GB
    Memory Allocated: 0.265744686126709  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1145782470703125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 9 input nodes size: 245129
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10005331039428711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10005331039428711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1918501853942871  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1918950080871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09401941299438477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10034656524658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10034656524658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 245129
first layer output nodes number: 62952
edges number: 623674
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10264253616333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([245129, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10264253616333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10264253616333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13097620010375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13097620010375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152307510375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62952, 256])
h_self size  torch.Size([62952, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152307510375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62952, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25206995010375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152307510375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62952, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25206995010375977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26707887649536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62952
----------------output nodes number: 5993
----------------edges number: 147882
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2675929069519043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2675929069519043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27445554733276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27445554733276367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27550506591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5993, 47])
h_self size  torch.Size([5993, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27550506591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5993, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27655458450317383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27550506591796875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5993, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27580928802490234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2768592834472656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11080455780029297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 10 input nodes size: 262607
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09432363510131836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09432363510131836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1921525001525879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19219732284545898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10035562515258789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10682249069213867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 262607
first layer output nodes number: 72824
edges number: 720845
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([262607, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10932207107543945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14209365844726562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14209365844726562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21154403686523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([72824, 256])
h_self size  torch.Size([72824, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21154403686523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([72824, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2809944152832031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21154403686523438  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([72824, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2809944152832031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2983570098876953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 72824
----------------output nodes number: 5963
----------------edges number: 146971
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29894447326660156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29894447326660156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3057718276977539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3057718276977539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3068199157714844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3068199157714844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3080272674560547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3069791793823242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3066678047180176  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.3077125549316406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11772584915161133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 11 input nodes size: 196625
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10004425048828125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10004425048828125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1732931137084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1733403205871582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07546663284301758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08151674270629883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08151674270629883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 196625
first layer output nodes number: 61969
edges number: 614462
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08344411849975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([196625, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08344411849975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08344411849975586  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11133956909179688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11133956909179688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17043781280517578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([61969, 256])
h_self size  torch.Size([61969, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17043781280517578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61969, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2295360565185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17043781280517578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([61969, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2295360565185547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24431085586547852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 61969
----------------output nodes number: 6316
----------------edges number: 157445
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24482011795043945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24482011795043945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25206518173217773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25206518173217773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25351381301879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6316, 47])
h_self size  torch.Size([6316, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25351381301879883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6316, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2546200752258301  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.253171443939209  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6316, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2535719871520996  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2550210952758789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0917668342590332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 12 input nodes size: 234174
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0758671760559082  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0758671760559082  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16310405731201172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16315126419067383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08985519409179688  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09588336944580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09588336944580078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 234174
first layer output nodes number: 65861
edges number: 652291
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09850406646728516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([234174, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09850406646728516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09850406646728516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12871122360229492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12871122360229492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152116775512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([65861, 256])
h_self size  torch.Size([65861, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152116775512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65861, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.254331111907959  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19152116775512695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([65861, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.254331111907959  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2700338363647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 65861
----------------output nodes number: 6324
----------------edges number: 156557
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2705721855163574  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2705721855163574  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2778182029724121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2778182029724121  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2794613838195801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6324, 47])
h_self size  torch.Size([6324, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2794613838195801  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6324, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28056907653808594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27892589569091797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6324, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2791004180908203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2807440757751465  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10749292373657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 13 input nodes size: 211691
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09002971649169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09002971649169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16889095306396484  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16893577575683594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08165168762207031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08840227127075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08840227127075195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 211691
first layer output nodes number: 67134
edges number: 665358
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09047985076904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([211691, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09047985076904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09047985076904297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1206979751586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1206979751586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1851511001586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([67134, 256])
h_self size  torch.Size([67134, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1851511001586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67134, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2496042251586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1851511001586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([67134, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2496042251586914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2656102180480957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 67134
----------------output nodes number: 5963
----------------edges number: 147753
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2661552429199219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2661552429199219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27298831939697266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27298831939697266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27494144439697266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27494144439697266  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2759857177734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2740325927734375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2734537124633789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2754073143005371  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0981302261352539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 14 input nodes size: 202415
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08107280731201172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08107280731201172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1564784049987793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1565237045288086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07761764526367188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08353233337402344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08353233337402344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 202415
first layer output nodes number: 56724
edges number: 558966
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0854635238647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([202415, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0854635238647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0854635238647461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11167716979980469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11167716979980469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1657733917236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([56724, 256])
h_self size  torch.Size([56724, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1657733917236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56724, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21986961364746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1657733917236328  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([56724, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21986961364746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23339366912841797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 56724
----------------output nodes number: 6070
----------------edges number: 149369
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23386192321777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23386192321777344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24080944061279297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24080944061279297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24195289611816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6070, 47])
h_self size  torch.Size([6070, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24195289611816406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6070, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24301576614379883  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24187231063842773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6070, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24197149276733398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2438182830810547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09286785125732422  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 15 input nodes size: 169343
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07771682739257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07771682739257812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14080238342285156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14084815979003906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06539726257324219  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07016372680664062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07016372680664062  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 169343
first layer output nodes number: 50363
edges number: 489927
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07190656661987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([169343, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07190656661987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07190656661987305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09584617614746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09584617614746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14467430114746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([50363, 256])
h_self size  torch.Size([50363, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14467430114746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([50363, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19350242614746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14467430114746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([50363, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19350242614746094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20551013946533203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 50363
----------------output nodes number: 6102
----------------edges number: 149709
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2059311866760254  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2059311866760254  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21291208267211914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21291208267211914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21398067474365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6102, 47])
h_self size  torch.Size([6102, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21398067474365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6102, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21504926681518555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21398067474365234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6102, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21390581130981445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21504974365234375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07910346984863281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 16 input nodes size: 126947
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0653223991394043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0653223991394043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11261415481567383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11266136169433594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.049530029296875  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05399608612060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05399608612060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 126947
first layer output nodes number: 46952
edges number: 448661
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05529212951660156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([126947, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05529212951660156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05529212951660156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07667016983032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07667016983032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12159204483032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([46952, 256])
h_self size  torch.Size([46952, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12159204483032227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46952, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16636896133422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12144708633422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([46952, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16636896133422852  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17741823196411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 46952
----------------output nodes number: 6312
----------------edges number: 150143
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17781543731689453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17781543731689453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18500137329101562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18500137329101562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1864619255065918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6312, 47])
h_self size  torch.Size([6312, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1864619255065918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6312, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18850183486938477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1870412826538086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6312, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18743324279785156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18897008895874023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06240415573120117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 17 input nodes size: 196767
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.04992198944091797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.04992198944091797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12322378158569336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12326860427856445  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07592964172363281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08164596557617188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08164596557617188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 196767
first layer output nodes number: 52982
edges number: 515133
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08350706100463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([196767, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08350706100463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08350706100463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10728073120117188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10728073120117188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1578083038330078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([52982, 256])
h_self size  torch.Size([52982, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1578083038330078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52982, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20833587646484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1578083038330078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([52982, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20833587646484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22096776962280273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 52982
----------------output nodes number: 6006
----------------edges number: 141265
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22140741348266602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22140741348266602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22823286056518555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22823286056518555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22967052459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6006, 47])
h_self size  torch.Size([6006, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22967052459716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6006, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23161935806274414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23018169403076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6006, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23015880584716797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23121118545532227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0902853012084961  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 18 input nodes size: 181778
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07590675354003906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07590675354003906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14426612854003906  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14431095123291016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07096433639526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07629156112670898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07629156112670898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 181778
first layer output nodes number: 57190
edges number: 567201
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07807254791259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([181778, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07807254791259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07807254791259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10417604446411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10417604446411133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15871667861938477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57190, 256])
h_self size  torch.Size([57190, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15871667861938477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57190, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2132573127746582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15871667861938477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57190, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2132573127746582  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22689247131347656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57190
----------------output nodes number: 5963
----------------edges number: 147692
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22736358642578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22736358642578125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23419570922851562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23419570922851562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23523998260498047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23523998260498047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2362842559814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23523998260498047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2348465919494629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23681163787841797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08502674102783203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 19 input nodes size: 238412
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0705709457397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0705709457397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15938663482666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15943145751953125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09102725982666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 238412
first layer output nodes number: 63897
edges number: 625659
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10035276412963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([238412, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10035276412963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10035276412963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12905645370483398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12905645370483398  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18999338150024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([63897, 256])
h_self size  torch.Size([63897, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18999338150024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63897, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2509303092956543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18999338150024414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([63897, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2509303092956543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26616477966308594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 63897
----------------output nodes number: 5973
----------------edges number: 145181
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26668596267700195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26668596267700195  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27350950241088867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27350950241088867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2750725746154785  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5973, 47])
h_self size  torch.Size([5973, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2750725746154785  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5973, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2768893241882324  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2753262519836426  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5973, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2758450508117676  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2774085998535156  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1087183952331543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 20 input nodes size: 156830
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09154605865478516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09154605865478516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15013980865478516  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15018463134765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.061324119567871094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06615924835205078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06615924835205078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 156830
first layer output nodes number: 51919
edges number: 506382
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06771516799926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([156830, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06771516799926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06771516799926758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09121370315551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09121370315551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14072751998901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([51919, 256])
h_self size  torch.Size([51919, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14072751998901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51919, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19024133682250977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14072751998901367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([51919, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19024133682250977  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2026200294494629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 51919
----------------output nodes number: 5985
----------------edges number: 142337
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20305204391479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20305204391479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20986604690551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20986604690551758  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2111811637878418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5985, 47])
h_self size  torch.Size([5985, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2111811637878418  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21222925186157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21091413497924805  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21066617965698242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21250581741333008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07420539855957031  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 21 input nodes size: 114880
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06107616424560547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06107616424560547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10404491424560547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10409164428710938  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.04545307159423828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.04986763000488281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.04986763000488281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 114880
first layer output nodes number: 45985
edges number: 445447
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05106639862060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([114880, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05106639862060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05106639862060547  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07242918014526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07242918014526367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11628389358520508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([45985, 256])
h_self size  torch.Size([45985, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11628389358520508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45985, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16013860702514648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11628389358520508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45985, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16013860702514648  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17110252380371094  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 45985
----------------output nodes number: 6216
----------------edges number: 146879
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1714920997619629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1714920997619629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17856168746948242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17856168746948242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1798868179321289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6216, 47])
h_self size  torch.Size([6216, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1798868179321289  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6216, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1811985969543457  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17987346649169922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6216, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17964696884155273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18073606491088867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0578460693359375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 22 input nodes size: 137214
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0452265739440918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0452265739440918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0963430404663086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0963902473449707  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0533747673034668  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05782461166381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05782461166381836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 137214
first layer output nodes number: 45227
edges number: 441781
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.059473514556884766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([137214, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.059473514556884766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.059473514556884766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0814056396484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0814056396484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12453746795654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([45227, 256])
h_self size  torch.Size([45227, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12453746795654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16766929626464844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12453746795654297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([45227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16766929626464844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1784524917602539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 45227
----------------output nodes number: 6314
----------------edges number: 155282
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17883682250976562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17883682250976562  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1860637664794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1860637664794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18716955184936523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6314, 47])
h_self size  torch.Size([6314, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18716955184936523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6314, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18827533721923828  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18716955184936523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6314, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18718671798706055  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1882929801940918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06673717498779297  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 23 input nodes size: 176468
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05339193344116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.05339193344116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11979818344116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1198430061340332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0686793327331543  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07431221008300781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07431221008300781  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 176468
first layer output nodes number: 57844
edges number: 562214
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07605838775634766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([176468, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07605838775634766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07605838775634766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10201215744018555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10201215744018555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15717649459838867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([57844, 256])
h_self size  torch.Size([57844, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15717649459838867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57844, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2123408317565918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.15717649459838867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([57844, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2123408317565918  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.22613191604614258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 57844
----------------output nodes number: 5963
----------------edges number: 139892
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2266077995300293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2266077995300293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2333817481994629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2333817481994629  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23442602157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5963, 47])
h_self size  torch.Size([5963, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23442602157592773  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23576688766479492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23472261428833008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5963, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23466110229492188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.23570585250854492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08320045471191406  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 24 input nodes size: 241622
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0686178207397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0686178207397461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1586294174194336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1586766242980957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09222555160522461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09861421585083008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09861421585083008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 241622
first layer output nodes number: 70617
edges number: 701012
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10152578353881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([241622, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10152578353881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10152578353881836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13331937789916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13331937789916992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20066499710083008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([70617, 256])
h_self size  torch.Size([70617, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20066499710083008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([70617, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26801061630249023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20066499710083008  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([70617, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26801061630249023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2848472595214844  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 70617
----------------output nodes number: 6285
----------------edges number: 156341
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28542089462280273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28542089462280273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29262781143188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29262781143188477  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29441308975219727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6285, 47])
h_self size  torch.Size([6285, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.29441308975219727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6285, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2960071563720703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2942218780517578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6285, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2942781448364258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2960638999938965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.110260009765625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 25 input nodes size: 231653
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09228181838989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09228181838989258  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17857933044433594  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17862606048583984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08856725692749023  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09484624862670898  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 231653
first layer output nodes number: 69101
edges number: 686566
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09708738327026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([231653, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09708738327026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09708738327026367  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1282029151916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1282029151916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1946091651916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([69101, 256])
h_self size  torch.Size([69101, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1946091651916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([69101, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2610154151916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1946091651916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([69101, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2610154151916504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27785205841064453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 69101
----------------output nodes number: 6263
----------------edges number: 156159
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2784137725830078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2784137725830078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2855968475341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2855968475341797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28719091415405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6263, 47])
h_self size  torch.Size([6263, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28719091415405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6263, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2882876396179199  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2866935729980469  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6263, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28668975830078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28780460357666016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10562610626220703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 26 input nodes size: 261205
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08856344223022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08856344223022461  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18587017059326172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.18591737747192383  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09957313537597656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10516548156738281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10516548156738281  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 261205
first layer output nodes number: 62147
edges number: 608518
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10784006118774414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([261205, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10784006118774414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10784006118774414  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1357583999633789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1357583999633789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19502639770507812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62147, 256])
h_self size  torch.Size([62147, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19502639770507812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62147, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25429439544677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19502639770507812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62147, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25429439544677734  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26911163330078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62147
----------------output nodes number: 6323
----------------edges number: 141945
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2696223258972168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2696223258972168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27675771713256836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27675771713256836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27803659439086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6323, 47])
h_self size  torch.Size([6323, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27803659439086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6323, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2791438102722168  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.277864933013916  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6323, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2780470848083496  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2793264389038086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11567020416259766  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 27 input nodes size: 277349
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09975528717041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09975528717041016  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20307588577270508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20312070846557617  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10576677322387695  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11142873764038086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11142873764038086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 277349
first layer output nodes number: 62289
edges number: 616134
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11395978927612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([277349, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11395978927612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11395978927612305  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14198780059814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.14198780059814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20139122009277344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([62289, 256])
h_self size  torch.Size([62289, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20139122009277344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62289, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26079463958740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20139122009277344  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([62289, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26079463958740234  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27564573287963867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 62289
----------------output nodes number: 5967
----------------edges number: 143726
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2761549949645996  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2761549949645996  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.282961368560791  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.282961368560791  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2841048240661621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([5967, 47])
h_self size  torch.Size([5967, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2841048240661621  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5967, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28515005111694336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28400659561157227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([5967, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28377294540405273  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28491687774658203  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12145519256591797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 28 input nodes size: 160890
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10553312301635742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10553312301635742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16607999801635742  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.16612625122070312  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06276082992553711  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0679330825805664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0679330825805664  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 160890
first layer output nodes number: 53681
edges number: 531251
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06953191757202148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([160890, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06953191757202148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06953191757202148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09368896484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09368896484375  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1448831558227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([53681, 256])
h_self size  torch.Size([53681, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1448831558227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([53681, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1960773468017578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1448831558227539  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([53681, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1960773468017578  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2088761329650879  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 53681
----------------output nodes number: 6154
----------------edges number: 153186
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20932245254516602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.20932245254516602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21637964248657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21637964248657227  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2179102897644043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6154, 47])
h_self size  torch.Size([6154, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2179102897644043  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6154, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21980524063110352  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21827459335327148  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6154, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2183070182800293  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.21983814239501953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0766763687133789  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 29 input nodes size: 196072
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06279325485229492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.06279325485229492  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13583612442016602  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.13588333129882812  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07529020309448242  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08154535293579102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08154535293579102  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 196072
first layer output nodes number: 66376
edges number: 658407
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08393526077270508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([196072, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08393526077270508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08393526077270508  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11436748504638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11436748504638672  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17766857147216797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([66376, 256])
h_self size  torch.Size([66376, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17766857147216797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66376, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24096965789794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.17766857147216797  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66376, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.24096965789794922  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25679492950439453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 66376
----------------output nodes number: 6304
----------------edges number: 157365
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2573370933532715  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2573370933532715  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2645697593688965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2645697593688965  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26572179794311523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6304, 47])
h_self size  torch.Size([6304, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26572179794311523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2674746513366699  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26632261276245117  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6304, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26639699935913086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2675495147705078  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09287405014038086  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 30 input nodes size: 224084
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07536458969116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.07536458969116211  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1588425636291504  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1588897705078125  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0857996940612793  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09206533432006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09206533432006836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 224084
first layer output nodes number: 68940
edges number: 683421
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09424924850463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([224084, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09424924850463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09424924850463867  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12528133392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.12528133392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19168758392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([68940, 256])
h_self size  torch.Size([68940, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19168758392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68940, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25809383392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.19168758392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([68940, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.25809383392333984  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27538013458251953  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 68940
----------------output nodes number: 6323
----------------edges number: 157371
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2759413719177246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2759413719177246  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28319215774536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28319215774536133  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28474855422973633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6323, 47])
h_self size  torch.Size([6323, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28474855422973633  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6323, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.285855770111084  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.284299373626709  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6323, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.28470373153686523  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2867131233215332  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.10319137573242188  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

pseudo mini batch 31 input nodes size: 209816
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08620405197143555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08620405197143555  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1643667221069336  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1644139289855957  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08088874816894531  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0870065689086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.0870065689086914  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

first layer input nodes number: 209816
first layer output nodes number: 66941
edges number: 663492
----------------------------------------before model layer 0
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08906888961791992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([209816, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08906888961791992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.08906888961791992  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11919975280761719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.11919975280761719  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1836528778076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([66941, 256])
h_self size  torch.Size([66941, 100])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1836528778076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66941, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2481060028076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.1836528778076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([66941, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2481060028076172  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.264066219329834  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------input nodes number: 66941
----------------output nodes number: 6325
----------------edges number: 157465
----------------------------------------before mean aggregator
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26461219787597656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.26461219787597656  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2718658447265625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2718658447265625  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27326250076293945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

h_neigh size torch.Size([6325, 47])
h_self size  torch.Size([6325, 256])
----------------------------------------before rst
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27326250076293945  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6325, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2743701934814453  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.27297353744506836  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

torch.Size([6325, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2728137969970703  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.2748851776123047  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09726953506469727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09726953506469727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.6092529296875 GB
    Memory Allocated: 0.09726953506469727  GigaBytes
Max Memory Allocated: 0.4633183479309082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03334375470876694 |0.006071329116821289 |0.012018218636512756 |0.0001415461301803589 |0.002579621970653534 |0.002527952194213867 |
----------------------------------------------------------pseudo_mini_loss sum 1.461746335029602
Total (block generation + training)time/epoch 63.29065227508545
Training time/epoch 1.8358030319213867
Training time without block to device /epoch 1.6415205001831055
Training time without total dataloading part /epoch 0.47418832778930664
load block tensor time/epoch 1.067000150680542
block to device time/epoch 0.19428253173828125
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8323263
Number of first layer input nodes during this epoch:  6430348
Number of first layer output nodes during this epoch:  1892915
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
