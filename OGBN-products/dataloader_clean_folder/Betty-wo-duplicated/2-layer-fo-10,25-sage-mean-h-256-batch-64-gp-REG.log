main start at this time 1660335635.028422
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22816181182861328
global_2_local spend time (sec) 0.36130428314208984

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.985 seconds
Metis partitioning: 14.099 seconds
Split the graph: 0.756 seconds
Construct subgraphs: 0.489 seconds
2981
2982
3162
3160
3024
3065
3067
2981
3075
3064
3053
2981
3131
3121
3135
3157
3163
3111
3055
3163
2984
3156
3154
2981
3075
2981
2985
3160
3053
3017
2981
2981
3111
3161
2981
3162
3036
2981
3156
3137
3159
3150
3066
2982
2997
3025
3163
2998
3096
3156
3156
3137
2981
3017
3106
3131
2981
3135
3162
2983
3001
2985
3111
3029
REG metis partition end ----................................
the time spent:  27.23395323753357
total k batches seeds list generation spend  27.752495050430298
after graph partition
graph partition algorithm spend time 28.20026469230652

partition_len_list
[26902, 30906, 29282, 25401, 24327, 29891, 28062, 30650, 35226, 34300, 29676, 33086, 38001, 32624, 31231, 34449, 29578, 39941, 36242, 38159, 31257, 28977, 29956, 29115, 25578, 32850, 33345, 30879, 27243, 26666, 28581, 29721, 30150, 34619, 42357, 40601, 28359, 29835, 39596, 35590, 36720, 34413, 26575, 34061, 38936, 45598, 39350, 36088, 25805, 27315, 39040, 33890, 34240, 28672, 28796, 24276, 40440, 35447, 34918, 31703, 36583, 28350, 29617, 23682]
REG selection method  spend 28.753316164016724
check_connections_block*********************************
time for parepare 1: 0.23485732078552246
local_output_nid generation: 0.003169536590576172
local_in_edges_tensor generation: 0.0015103816986083984
mini_batch_src_global generation: 0.0024390220642089844

&&&&&&&&&&&&&&& before remove duplicate length: 70928
r_  generation: 0.04089546203613281

local_output_nid generation: 0.0012745857238769531
local_in_edges_tensor generation: 0.0013844966888427734
mini_batch_src_global generation: 0.002832651138305664

&&&&&&&&&&&&&&& before remove duplicate length: 69231
r_  generation: 0.021846532821655273

local_output_nid generation: 0.00133514404296875
local_in_edges_tensor generation: 0.0014007091522216797
mini_batch_src_global generation: 0.002111196517944336

&&&&&&&&&&&&&&& before remove duplicate length: 77599
r_  generation: 0.024216413497924805

local_output_nid generation: 0.0013439655303955078
local_in_edges_tensor generation: 0.0013916492462158203
mini_batch_src_global generation: 0.002170085906982422

&&&&&&&&&&&&&&& before remove duplicate length: 78158
r_  generation: 0.024389982223510742

local_output_nid generation: 0.0013246536254882812
local_in_edges_tensor generation: 0.0012950897216796875
mini_batch_src_global generation: 0.0019452571868896484

&&&&&&&&&&&&&&& before remove duplicate length: 71166
r_  generation: 0.02249622344970703

local_output_nid generation: 0.0013279914855957031
local_in_edges_tensor generation: 0.0012791156768798828
mini_batch_src_global generation: 0.001974821090698242

&&&&&&&&&&&&&&& before remove duplicate length: 72095
r_  generation: 0.023204326629638672

local_output_nid generation: 0.0012960433959960938
local_in_edges_tensor generation: 0.0012907981872558594
mini_batch_src_global generation: 0.0020437240600585938

&&&&&&&&&&&&&&& before remove duplicate length: 71924
r_  generation: 0.023082971572875977

local_output_nid generation: 0.0012667179107666016
local_in_edges_tensor generation: 0.0012423992156982422
mini_batch_src_global generation: 0.0020248889923095703

&&&&&&&&&&&&&&& before remove duplicate length: 71740
r_  generation: 0.02320098876953125

local_output_nid generation: 0.0013048648834228516
local_in_edges_tensor generation: 0.0012607574462890625
mini_batch_src_global generation: 0.0021572113037109375

&&&&&&&&&&&&&&& before remove duplicate length: 74768
r_  generation: 0.024511098861694336

local_output_nid generation: 0.0013039112091064453
local_in_edges_tensor generation: 0.0013287067413330078
mini_batch_src_global generation: 0.0022890567779541016

&&&&&&&&&&&&&&& before remove duplicate length: 76463
r_  generation: 0.025457143783569336

local_output_nid generation: 0.0012972354888916016
local_in_edges_tensor generation: 0.0012919902801513672
mini_batch_src_global generation: 0.0021507740020751953

&&&&&&&&&&&&&&& before remove duplicate length: 74771
r_  generation: 0.02465200424194336

local_output_nid generation: 0.001294851303100586
local_in_edges_tensor generation: 0.0012788772583007812
mini_batch_src_global generation: 0.002107858657836914

&&&&&&&&&&&&&&& before remove duplicate length: 73194
r_  generation: 0.024387836456298828

local_output_nid generation: 0.0013456344604492188
local_in_edges_tensor generation: 0.0012884140014648438
mini_batch_src_global generation: 0.0021800994873046875

&&&&&&&&&&&&&&& before remove duplicate length: 77864
r_  generation: 0.026111841201782227

local_output_nid generation: 0.001338958740234375
local_in_edges_tensor generation: 0.0013535022735595703
mini_batch_src_global generation: 0.0023508071899414062

&&&&&&&&&&&&&&& before remove duplicate length: 77581
r_  generation: 0.026098966598510742

local_output_nid generation: 0.0013434886932373047
local_in_edges_tensor generation: 0.0013279914855957031
mini_batch_src_global generation: 0.002241849899291992

&&&&&&&&&&&&&&& before remove duplicate length: 77994
r_  generation: 0.02563309669494629

local_output_nid generation: 0.0013468265533447266
local_in_edges_tensor generation: 0.0013413429260253906
mini_batch_src_global generation: 0.002315998077392578

&&&&&&&&&&&&&&& before remove duplicate length: 78272
r_  generation: 0.026125431060791016

local_output_nid generation: 0.0013480186462402344
local_in_edges_tensor generation: 0.001363992691040039
mini_batch_src_global generation: 0.0022873878479003906

&&&&&&&&&&&&&&& before remove duplicate length: 77383
r_  generation: 0.025435447692871094

local_output_nid generation: 0.0013222694396972656
local_in_edges_tensor generation: 0.0016193389892578125
mini_batch_src_global generation: 0.002247333526611328

&&&&&&&&&&&&&&& before remove duplicate length: 74668
r_  generation: 0.026053190231323242

local_output_nid generation: 0.001316070556640625
local_in_edges_tensor generation: 0.001596212387084961
mini_batch_src_global generation: 0.0022618770599365234

&&&&&&&&&&&&&&& before remove duplicate length: 73733
r_  generation: 0.025465011596679688

local_output_nid generation: 0.0013515949249267578
local_in_edges_tensor generation: 0.001321554183959961
mini_batch_src_global generation: 0.0022439956665039062

&&&&&&&&&&&&&&& before remove duplicate length: 75658
r_  generation: 0.025928020477294922

local_output_nid generation: 0.0012974739074707031
local_in_edges_tensor generation: 0.0012829303741455078
mini_batch_src_global generation: 0.00225830078125

&&&&&&&&&&&&&&& before remove duplicate length: 72870
r_  generation: 0.024564027786254883

local_output_nid generation: 0.0013446807861328125
local_in_edges_tensor generation: 0.0013964176177978516
mini_batch_src_global generation: 0.0021948814392089844

&&&&&&&&&&&&&&& before remove duplicate length: 75344
r_  generation: 0.024689912796020508

local_output_nid generation: 0.0013446807861328125
local_in_edges_tensor generation: 0.0013606548309326172
mini_batch_src_global generation: 0.0022253990173339844

&&&&&&&&&&&&&&& before remove duplicate length: 75918
r_  generation: 0.024955272674560547

local_output_nid generation: 0.0012693405151367188
local_in_edges_tensor generation: 0.001268625259399414
mini_batch_src_global generation: 0.002187013626098633

&&&&&&&&&&&&&&& before remove duplicate length: 71890
r_  generation: 0.023587942123413086

local_output_nid generation: 0.0013108253479003906
local_in_edges_tensor generation: 0.0012621879577636719
mini_batch_src_global generation: 0.0021436214447021484

&&&&&&&&&&&&&&& before remove duplicate length: 74572
r_  generation: 0.02411031723022461

local_output_nid generation: 0.0012640953063964844
local_in_edges_tensor generation: 0.0012657642364501953
mini_batch_src_global generation: 0.00209808349609375

&&&&&&&&&&&&&&& before remove duplicate length: 72476
r_  generation: 0.023850440979003906

local_output_nid generation: 0.0012786388397216797
local_in_edges_tensor generation: 0.0012433528900146484
mini_batch_src_global generation: 0.0021369457244873047

&&&&&&&&&&&&&&& before remove duplicate length: 72336
r_  generation: 0.023910045623779297

local_output_nid generation: 0.0013420581817626953
local_in_edges_tensor generation: 0.0013120174407958984
mini_batch_src_global generation: 0.0022401809692382812

&&&&&&&&&&&&&&& before remove duplicate length: 77147
r_  generation: 0.02544879913330078

local_output_nid generation: 0.0013077259063720703
local_in_edges_tensor generation: 0.001322031021118164
mini_batch_src_global generation: 0.002222776412963867

&&&&&&&&&&&&&&& before remove duplicate length: 74269
r_  generation: 0.025264263153076172

local_output_nid generation: 0.001458883285522461
local_in_edges_tensor generation: 0.0012881755828857422
mini_batch_src_global generation: 0.0021753311157226562

&&&&&&&&&&&&&&& before remove duplicate length: 71691
r_  generation: 0.023598432540893555

local_output_nid generation: 0.0012984275817871094
local_in_edges_tensor generation: 0.0012617111206054688
mini_batch_src_global generation: 0.0021703243255615234

&&&&&&&&&&&&&&& before remove duplicate length: 72691
r_  generation: 0.02372002601623535

local_output_nid generation: 0.0012814998626708984
local_in_edges_tensor generation: 0.0012536048889160156
mini_batch_src_global generation: 0.002070188522338867

&&&&&&&&&&&&&&& before remove duplicate length: 71571
r_  generation: 0.023786544799804688

local_output_nid generation: 0.0013265609741210938
local_in_edges_tensor generation: 0.001546621322631836
mini_batch_src_global generation: 0.0022687911987304688

&&&&&&&&&&&&&&& before remove duplicate length: 77561
r_  generation: 0.025574922561645508

local_output_nid generation: 0.0013637542724609375
local_in_edges_tensor generation: 0.0013403892517089844
mini_batch_src_global generation: 0.002371549606323242

&&&&&&&&&&&&&&& before remove duplicate length: 78778
r_  generation: 0.026120662689208984

local_output_nid generation: 0.0013225078582763672
local_in_edges_tensor generation: 0.0012857913970947266
mini_batch_src_global generation: 0.002207517623901367

&&&&&&&&&&&&&&& before remove duplicate length: 73605
r_  generation: 0.0251314640045166

local_output_nid generation: 0.0013494491577148438
local_in_edges_tensor generation: 0.0013425350189208984
mini_batch_src_global generation: 0.0022482872009277344

&&&&&&&&&&&&&&& before remove duplicate length: 77562
r_  generation: 0.02625727653503418

local_output_nid generation: 0.0013103485107421875
local_in_edges_tensor generation: 0.0013184547424316406
mini_batch_src_global generation: 0.002168416976928711

&&&&&&&&&&&&&&& before remove duplicate length: 74288
r_  generation: 0.02457714080810547

local_output_nid generation: 0.0012912750244140625
local_in_edges_tensor generation: 0.0013146400451660156
mini_batch_src_global generation: 0.002131223678588867

&&&&&&&&&&&&&&& before remove duplicate length: 73443
r_  generation: 0.023609161376953125

local_output_nid generation: 0.003051280975341797
local_in_edges_tensor generation: 0.0014693737030029297
mini_batch_src_global generation: 0.002270221710205078

&&&&&&&&&&&&&&& before remove duplicate length: 78753
r_  generation: 0.026613712310791016

local_output_nid generation: 0.0013682842254638672
local_in_edges_tensor generation: 0.001394033432006836
mini_batch_src_global generation: 0.0023241043090820312

&&&&&&&&&&&&&&& before remove duplicate length: 78095
r_  generation: 0.026537179946899414

local_output_nid generation: 0.0013549327850341797
local_in_edges_tensor generation: 0.0013613700866699219
mini_batch_src_global generation: 0.0023343563079833984

&&&&&&&&&&&&&&& before remove duplicate length: 78782
r_  generation: 0.02631521224975586

local_output_nid generation: 0.0013430118560791016
local_in_edges_tensor generation: 0.0013535022735595703
mini_batch_src_global generation: 0.0023717880249023438

&&&&&&&&&&&&&&& before remove duplicate length: 78349
r_  generation: 0.02646946907043457

local_output_nid generation: 0.0013322830200195312
local_in_edges_tensor generation: 0.0013284683227539062
mini_batch_src_global generation: 0.00225067138671875

&&&&&&&&&&&&&&& before remove duplicate length: 76297
r_  generation: 0.0252530574798584

local_output_nid generation: 0.0012874603271484375
local_in_edges_tensor generation: 0.0012860298156738281
mini_batch_src_global generation: 0.0022118091583251953

&&&&&&&&&&&&&&& before remove duplicate length: 74272
r_  generation: 0.02455282211303711

local_output_nid generation: 0.0013051033020019531
local_in_edges_tensor generation: 0.0012764930725097656
mini_batch_src_global generation: 0.0022051334381103516

&&&&&&&&&&&&&&& before remove duplicate length: 74703
r_  generation: 0.025132417678833008

local_output_nid generation: 0.0012912750244140625
local_in_edges_tensor generation: 0.0013124942779541016
mini_batch_src_global generation: 0.0021996498107910156

&&&&&&&&&&&&&&& before remove duplicate length: 75231
r_  generation: 0.027556657791137695

local_output_nid generation: 0.0013644695281982422
local_in_edges_tensor generation: 0.0013728141784667969
mini_batch_src_global generation: 0.0023183822631835938

&&&&&&&&&&&&&&& before remove duplicate length: 78497
r_  generation: 0.02704644203186035

local_output_nid generation: 0.0012989044189453125
local_in_edges_tensor generation: 0.0013289451599121094
mini_batch_src_global generation: 0.0022459030151367188

&&&&&&&&&&&&&&& before remove duplicate length: 74544
r_  generation: 0.02506279945373535

local_output_nid generation: 0.0013277530670166016
local_in_edges_tensor generation: 0.0013659000396728516
mini_batch_src_global generation: 0.0022649765014648438

&&&&&&&&&&&&&&& before remove duplicate length: 76753
r_  generation: 0.025140047073364258

local_output_nid generation: 0.0013620853424072266
local_in_edges_tensor generation: 0.0013387203216552734
mini_batch_src_global generation: 0.002284526824951172

&&&&&&&&&&&&&&& before remove duplicate length: 77674
r_  generation: 0.024871110916137695

local_output_nid generation: 0.0013625621795654297
local_in_edges_tensor generation: 0.0013589859008789062
mini_batch_src_global generation: 0.002297639846801758

&&&&&&&&&&&&&&& before remove duplicate length: 77759
r_  generation: 0.026784896850585938

local_output_nid generation: 0.0013377666473388672
local_in_edges_tensor generation: 0.0013120174407958984
mini_batch_src_global generation: 0.0023169517517089844

&&&&&&&&&&&&&&& before remove duplicate length: 77778
r_  generation: 0.026401996612548828

local_output_nid generation: 0.0012891292572021484
local_in_edges_tensor generation: 0.00334930419921875
mini_batch_src_global generation: 0.002148866653442383

&&&&&&&&&&&&&&& before remove duplicate length: 70406
r_  generation: 0.02354574203491211

local_output_nid generation: 0.0012860298156738281
local_in_edges_tensor generation: 0.0012743473052978516
mini_batch_src_global generation: 0.0020797252655029297

&&&&&&&&&&&&&&& before remove duplicate length: 70526
r_  generation: 0.023569583892822266

local_output_nid generation: 0.0013401508331298828
local_in_edges_tensor generation: 0.0012729167938232422
mini_batch_src_global generation: 0.0021066665649414062

&&&&&&&&&&&&&&& before remove duplicate length: 73553
r_  generation: 0.02447652816772461

local_output_nid generation: 0.0013370513916015625
local_in_edges_tensor generation: 0.0013170242309570312
mini_batch_src_global generation: 0.0021750926971435547

&&&&&&&&&&&&&&& before remove duplicate length: 73700
r_  generation: 0.023914098739624023

local_output_nid generation: 0.0012788772583007812
local_in_edges_tensor generation: 0.0012848377227783203
mini_batch_src_global generation: 0.002104043960571289

&&&&&&&&&&&&&&& before remove duplicate length: 72649
r_  generation: 0.024789810180664062

local_output_nid generation: 0.0013384819030761719
local_in_edges_tensor generation: 0.0013287067413330078
mini_batch_src_global generation: 0.002213716506958008

&&&&&&&&&&&&&&& before remove duplicate length: 76366
r_  generation: 0.025972366333007812

local_output_nid generation: 0.001355886459350586
local_in_edges_tensor generation: 0.0013709068298339844
mini_batch_src_global generation: 0.0023071765899658203

&&&&&&&&&&&&&&& before remove duplicate length: 77377
r_  generation: 0.02577352523803711

local_output_nid generation: 0.0012896060943603516
local_in_edges_tensor generation: 0.001230001449584961
mini_batch_src_global generation: 0.0020325183868408203

&&&&&&&&&&&&&&& before remove duplicate length: 62289
r_  generation: 0.02108454704284668

local_output_nid generation: 0.0012922286987304688
local_in_edges_tensor generation: 0.00125885009765625
mini_batch_src_global generation: 0.001992940902709961

&&&&&&&&&&&&&&& before remove duplicate length: 72180
r_  generation: 0.02339959144592285

local_output_nid generation: 0.001291036605834961
local_in_edges_tensor generation: 0.001226663589477539
mini_batch_src_global generation: 0.0020515918731689453

&&&&&&&&&&&&&&& before remove duplicate length: 72126
r_  generation: 0.023237943649291992

local_output_nid generation: 0.0013344287872314453
local_in_edges_tensor generation: 0.0012791156768798828
mini_batch_src_global generation: 0.0020685195922851562

&&&&&&&&&&&&&&& before remove duplicate length: 71733
r_  generation: 0.023239612579345703

local_output_nid generation: 0.001314401626586914
local_in_edges_tensor generation: 0.0012085437774658203
mini_batch_src_global generation: 0.001966714859008789

&&&&&&&&&&&&&&& before remove duplicate length: 60285
r_  generation: 0.020147085189819336


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7235379219055176
gen group dst list time:  0.05869603157043457
check_connections_block*********************************
time for parepare 1: 0.36882853507995605
local_output_nid generation: 0.007631778717041016
local_in_edges_tensor generation: 0.05381202697753906
mini_batch_src_global generation: 0.007860422134399414

&&&&&&&&&&&&&&& before remove duplicate length: 262569
r_  generation: 0.09257936477661133

local_output_nid generation: 0.010234832763671875
local_in_edges_tensor generation: 0.009407520294189453
mini_batch_src_global generation: 0.01166081428527832

&&&&&&&&&&&&&&& before remove duplicate length: 299596
r_  generation: 0.11334681510925293

local_output_nid generation: 0.009931087493896484
local_in_edges_tensor generation: 0.009588479995727539
mini_batch_src_global generation: 0.010590791702270508

&&&&&&&&&&&&&&& before remove duplicate length: 287388
r_  generation: 0.11012125015258789

local_output_nid generation: 0.008810758590698242
local_in_edges_tensor generation: 0.00838327407836914
mini_batch_src_global generation: 0.00965261459350586

&&&&&&&&&&&&&&& before remove duplicate length: 249225
r_  generation: 0.09340882301330566

local_output_nid generation: 0.008439779281616211
local_in_edges_tensor generation: 0.007630825042724609
mini_batch_src_global generation: 0.009521007537841797

&&&&&&&&&&&&&&& before remove duplicate length: 236262
r_  generation: 0.08898639678955078

local_output_nid generation: 0.009363412857055664
local_in_edges_tensor generation: 0.009055852890014648
mini_batch_src_global generation: 0.012321949005126953

&&&&&&&&&&&&&&& before remove duplicate length: 291075
r_  generation: 0.10737347602844238

local_output_nid generation: 0.009259223937988281
local_in_edges_tensor generation: 0.009907722473144531
mini_batch_src_global generation: 0.011768341064453125

&&&&&&&&&&&&&&& before remove duplicate length: 272780
r_  generation: 0.10600662231445312

local_output_nid generation: 0.010020971298217773
local_in_edges_tensor generation: 0.010870218276977539
mini_batch_src_global generation: 0.012680768966674805

&&&&&&&&&&&&&&& before remove duplicate length: 301102
r_  generation: 0.12037444114685059

local_output_nid generation: 0.01108694076538086
local_in_edges_tensor generation: 0.011464357376098633
mini_batch_src_global generation: 0.015575885772705078

&&&&&&&&&&&&&&& before remove duplicate length: 347836
r_  generation: 0.14045166969299316

local_output_nid generation: 0.011185169219970703
local_in_edges_tensor generation: 0.010355949401855469
mini_batch_src_global generation: 0.01501917839050293

&&&&&&&&&&&&&&& before remove duplicate length: 341182
r_  generation: 0.1398303508758545

local_output_nid generation: 0.010152101516723633
local_in_edges_tensor generation: 0.009741783142089844
mini_batch_src_global generation: 0.01646900177001953

&&&&&&&&&&&&&&& before remove duplicate length: 289849
r_  generation: 0.12114596366882324

local_output_nid generation: 0.010922670364379883
local_in_edges_tensor generation: 0.010313272476196289
mini_batch_src_global generation: 0.014215707778930664

&&&&&&&&&&&&&&& before remove duplicate length: 324864
r_  generation: 0.13550782203674316

local_output_nid generation: 0.01204371452331543
local_in_edges_tensor generation: 0.012663602828979492
mini_batch_src_global generation: 0.016865253448486328

&&&&&&&&&&&&&&& before remove duplicate length: 376413
r_  generation: 0.1600029468536377

local_output_nid generation: 0.01287221908569336
local_in_edges_tensor generation: 0.00957798957824707
mini_batch_src_global generation: 0.015151500701904297

&&&&&&&&&&&&&&& before remove duplicate length: 323090
r_  generation: 0.13710808753967285

local_output_nid generation: 0.009485244750976562
local_in_edges_tensor generation: 0.00859379768371582
mini_batch_src_global generation: 0.01386260986328125

&&&&&&&&&&&&&&& before remove duplicate length: 309968
r_  generation: 0.12885403633117676

local_output_nid generation: 0.011072397232055664
local_in_edges_tensor generation: 0.012120246887207031
mini_batch_src_global generation: 0.015316963195800781

&&&&&&&&&&&&&&& before remove duplicate length: 342593
r_  generation: 0.14453768730163574

local_output_nid generation: 0.009315013885498047
local_in_edges_tensor generation: 0.008482217788696289
mini_batch_src_global generation: 0.014064311981201172

&&&&&&&&&&&&&&& before remove duplicate length: 289770
r_  generation: 0.12088894844055176

local_output_nid generation: 0.015119075775146484
local_in_edges_tensor generation: 0.022644758224487305
mini_batch_src_global generation: 0.01636052131652832

&&&&&&&&&&&&&&& before remove duplicate length: 386159
r_  generation: 0.1697235107421875

local_output_nid generation: 0.011903047561645508
local_in_edges_tensor generation: 0.014621257781982422
mini_batch_src_global generation: 0.017282962799072266

&&&&&&&&&&&&&&& before remove duplicate length: 350802
r_  generation: 0.153242826461792

local_output_nid generation: 0.012439250946044922
local_in_edges_tensor generation: 0.015217304229736328
mini_batch_src_global generation: 0.01636958122253418

&&&&&&&&&&&&&&& before remove duplicate length: 367670
r_  generation: 0.16434574127197266

local_output_nid generation: 0.009988784790039062
local_in_edges_tensor generation: 0.010336160659790039
mini_batch_src_global generation: 0.015418529510498047

&&&&&&&&&&&&&&& before remove duplicate length: 304212
r_  generation: 0.13200044631958008

local_output_nid generation: 0.016161680221557617
local_in_edges_tensor generation: 0.009697675704956055
mini_batch_src_global generation: 0.013170242309570312

&&&&&&&&&&&&&&& before remove duplicate length: 276888
r_  generation: 0.1217489242553711

local_output_nid generation: 0.011091232299804688
local_in_edges_tensor generation: 0.018193960189819336
mini_batch_src_global generation: 0.01798725128173828

&&&&&&&&&&&&&&& before remove duplicate length: 289719
r_  generation: 0.12839722633361816

local_output_nid generation: 0.012763023376464844
local_in_edges_tensor generation: 0.012031078338623047
mini_batch_src_global generation: 0.012857675552368164

&&&&&&&&&&&&&&& before remove duplicate length: 279893
r_  generation: 0.12551379203796387

local_output_nid generation: 0.01170969009399414
local_in_edges_tensor generation: 0.011258363723754883
mini_batch_src_global generation: 0.012329339981079102

&&&&&&&&&&&&&&& before remove duplicate length: 249618
r_  generation: 0.10948848724365234

local_output_nid generation: 0.014875411987304688
local_in_edges_tensor generation: 0.013330698013305664
mini_batch_src_global generation: 0.014615535736083984

&&&&&&&&&&&&&&& before remove duplicate length: 321333
r_  generation: 0.14196515083312988

local_output_nid generation: 0.012371063232421875
local_in_edges_tensor generation: 0.01284027099609375
mini_batch_src_global generation: 0.016419410705566406

&&&&&&&&&&&&&&& before remove duplicate length: 326097
r_  generation: 0.14680767059326172

local_output_nid generation: 0.011326074600219727
local_in_edges_tensor generation: 0.011420965194702148
mini_batch_src_global generation: 0.014388084411621094

&&&&&&&&&&&&&&& before remove duplicate length: 300469
r_  generation: 0.1361372470855713

local_output_nid generation: 0.009224653244018555
local_in_edges_tensor generation: 0.008778810501098633
mini_batch_src_global generation: 0.013531923294067383

&&&&&&&&&&&&&&& before remove duplicate length: 265550
r_  generation: 0.11000823974609375

local_output_nid generation: 0.009082794189453125
local_in_edges_tensor generation: 0.008474349975585938
mini_batch_src_global generation: 0.012287378311157227

&&&&&&&&&&&&&&& before remove duplicate length: 257143
r_  generation: 0.1085197925567627

local_output_nid generation: 0.010002851486206055
local_in_edges_tensor generation: 0.01047205924987793
mini_batch_src_global generation: 0.013819694519042969

&&&&&&&&&&&&&&& before remove duplicate length: 276567
r_  generation: 0.12002348899841309

local_output_nid generation: 0.010066032409667969
local_in_edges_tensor generation: 0.009568929672241211
mini_batch_src_global generation: 0.013457298278808594

&&&&&&&&&&&&&&& before remove duplicate length: 286857
r_  generation: 0.12619948387145996

local_output_nid generation: 0.009833574295043945
local_in_edges_tensor generation: 0.009265661239624023
mini_batch_src_global generation: 0.013679027557373047

&&&&&&&&&&&&&&& before remove duplicate length: 298253
r_  generation: 0.12877774238586426

local_output_nid generation: 0.01073765754699707
local_in_edges_tensor generation: 0.009824752807617188
mini_batch_src_global generation: 0.017176389694213867

&&&&&&&&&&&&&&& before remove duplicate length: 343970
r_  generation: 0.14223837852478027

local_output_nid generation: 0.014384031295776367
local_in_edges_tensor generation: 0.0167386531829834
mini_batch_src_global generation: 0.03976845741271973

&&&&&&&&&&&&&&& before remove duplicate length: 419992
r_  generation: 0.1975111961364746

local_output_nid generation: 0.013860225677490234
local_in_edges_tensor generation: 0.01318669319152832
mini_batch_src_global generation: 0.023286104202270508

&&&&&&&&&&&&&&& before remove duplicate length: 402458
r_  generation: 0.18309354782104492

local_output_nid generation: 0.010055303573608398
local_in_edges_tensor generation: 0.009296655654907227
mini_batch_src_global generation: 0.015944242477416992

&&&&&&&&&&&&&&& before remove duplicate length: 279210
r_  generation: 0.12783408164978027

local_output_nid generation: 0.010065317153930664
local_in_edges_tensor generation: 0.009314298629760742
mini_batch_src_global generation: 0.014476299285888672

&&&&&&&&&&&&&&& before remove duplicate length: 295775
r_  generation: 0.12984657287597656

local_output_nid generation: 0.013235330581665039
local_in_edges_tensor generation: 0.012221097946166992
mini_batch_src_global generation: 0.017510175704956055

&&&&&&&&&&&&&&& before remove duplicate length: 393641
r_  generation: 0.17841815948486328

local_output_nid generation: 0.011601924896240234
local_in_edges_tensor generation: 0.013390779495239258
mini_batch_src_global generation: 0.021116971969604492

&&&&&&&&&&&&&&& before remove duplicate length: 352700
r_  generation: 0.1510782241821289

local_output_nid generation: 0.011932611465454102
local_in_edges_tensor generation: 0.01311945915222168
mini_batch_src_global generation: 0.017518997192382812

&&&&&&&&&&&&&&& before remove duplicate length: 365277
r_  generation: 0.15994715690612793

local_output_nid generation: 0.011424779891967773
local_in_edges_tensor generation: 0.011065959930419922
mini_batch_src_global generation: 0.017822265625

&&&&&&&&&&&&&&& before remove duplicate length: 341763
r_  generation: 0.1497023105621338

local_output_nid generation: 0.008735179901123047
local_in_edges_tensor generation: 0.007846355438232422
mini_batch_src_global generation: 0.012822628021240234

&&&&&&&&&&&&&&& before remove duplicate length: 262667
r_  generation: 0.10784697532653809

local_output_nid generation: 0.011466264724731445
local_in_edges_tensor generation: 0.010735750198364258
mini_batch_src_global generation: 0.018987178802490234

&&&&&&&&&&&&&&& before remove duplicate length: 337686
r_  generation: 0.14606308937072754

local_output_nid generation: 0.013437747955322266
local_in_edges_tensor generation: 0.016289710998535156
mini_batch_src_global generation: 0.01782059669494629

&&&&&&&&&&&&&&& before remove duplicate length: 386300
r_  generation: 0.17127490043640137

local_output_nid generation: 0.015653610229492188
local_in_edges_tensor generation: 0.016920089721679688
mini_batch_src_global generation: 0.02019357681274414

&&&&&&&&&&&&&&& before remove duplicate length: 452711
r_  generation: 0.22551321983337402

local_output_nid generation: 0.014049291610717773
local_in_edges_tensor generation: 0.015913724899291992
mini_batch_src_global generation: 0.019733667373657227

&&&&&&&&&&&&&&& before remove duplicate length: 390354
r_  generation: 0.18358421325683594

local_output_nid generation: 0.012206315994262695
local_in_edges_tensor generation: 0.010844707489013672
mini_batch_src_global generation: 0.01789999008178711

&&&&&&&&&&&&&&& before remove duplicate length: 357996
r_  generation: 0.1625964641571045

local_output_nid generation: 0.008261680603027344
local_in_edges_tensor generation: 0.007199287414550781
mini_batch_src_global generation: 0.014035940170288086

&&&&&&&&&&&&&&& before remove duplicate length: 254819
r_  generation: 0.10683631896972656

local_output_nid generation: 0.008410215377807617
local_in_edges_tensor generation: 0.007199287414550781
mini_batch_src_global generation: 0.012345314025878906

&&&&&&&&&&&&&&& before remove duplicate length: 266086
r_  generation: 0.10460281372070312

local_output_nid generation: 0.012098312377929688
local_in_edges_tensor generation: 0.010626077651977539
mini_batch_src_global generation: 0.01677560806274414

&&&&&&&&&&&&&&& before remove duplicate length: 385327
r_  generation: 0.16709351539611816

local_output_nid generation: 0.01071023941040039
local_in_edges_tensor generation: 0.02046990394592285
mini_batch_src_global generation: 0.020645618438720703

&&&&&&&&&&&&&&& before remove duplicate length: 335634
r_  generation: 0.14365768432617188

local_output_nid generation: 0.011383533477783203
local_in_edges_tensor generation: 0.024524688720703125
mini_batch_src_global generation: 0.016229629516601562

&&&&&&&&&&&&&&& before remove duplicate length: 334254
r_  generation: 0.1477336883544922

local_output_nid generation: 0.0161283016204834
local_in_edges_tensor generation: 0.014492034912109375
mini_batch_src_global generation: 0.014636754989624023

&&&&&&&&&&&&&&& before remove duplicate length: 279525
r_  generation: 0.1267070770263672

local_output_nid generation: 0.009752750396728516
local_in_edges_tensor generation: 0.02788376808166504
mini_batch_src_global generation: 0.01373744010925293

&&&&&&&&&&&&&&& before remove duplicate length: 274831
r_  generation: 0.11223983764648438

local_output_nid generation: 0.008219003677368164
local_in_edges_tensor generation: 0.013373374938964844
mini_batch_src_global generation: 0.01197504997253418

&&&&&&&&&&&&&&& before remove duplicate length: 234727
r_  generation: 0.09195661544799805

local_output_nid generation: 0.024068593978881836
local_in_edges_tensor generation: 0.030237436294555664
mini_batch_src_global generation: 0.01687455177307129

&&&&&&&&&&&&&&& before remove duplicate length: 399616
r_  generation: 0.19690299034118652

local_output_nid generation: 0.014968395233154297
local_in_edges_tensor generation: 0.01804041862487793
mini_batch_src_global generation: 0.0217282772064209

&&&&&&&&&&&&&&& before remove duplicate length: 349004
r_  generation: 0.1562511920928955

local_output_nid generation: 0.01214146614074707
local_in_edges_tensor generation: 0.013410568237304688
mini_batch_src_global generation: 0.015476703643798828

&&&&&&&&&&&&&&& before remove duplicate length: 346006
r_  generation: 0.1562042236328125

local_output_nid generation: 0.011492490768432617
local_in_edges_tensor generation: 0.012354612350463867
mini_batch_src_global generation: 0.015961408615112305

&&&&&&&&&&&&&&& before remove duplicate length: 308254
r_  generation: 0.14461088180541992

local_output_nid generation: 0.013230085372924805
local_in_edges_tensor generation: 0.014926433563232422
mini_batch_src_global generation: 0.017979145050048828

&&&&&&&&&&&&&&& before remove duplicate length: 362124
r_  generation: 0.19309234619140625

local_output_nid generation: 0.009868144989013672
local_in_edges_tensor generation: 0.009717941284179688
mini_batch_src_global generation: 0.015268564224243164

&&&&&&&&&&&&&&& before remove duplicate length: 280379
r_  generation: 0.13580703735351562

local_output_nid generation: 0.009962081909179688
local_in_edges_tensor generation: 0.00961756706237793
mini_batch_src_global generation: 0.015100955963134766

&&&&&&&&&&&&&&& before remove duplicate length: 291689
r_  generation: 0.13779902458190918

local_output_nid generation: 0.008333921432495117
local_in_edges_tensor generation: 0.007776021957397461
mini_batch_src_global generation: 0.014992713928222656

&&&&&&&&&&&&&&& before remove duplicate length: 231724
r_  generation: 0.10409903526306152


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  16.51356029510498
block generation total time  15.214422702789307
average batch blocks generation time:  0.23772535473108292
pseudo mini batch 0 input nodes size: 91540
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 0.034381866455078125  GigaBytes
Max Memory Allocated: 0.034381866455078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 0.03440427780151367  GigaBytes
Max Memory Allocated: 0.03440427780151367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.1131591796875 GB
    Memory Allocated: 0.03440427780151367  GigaBytes
Max Memory Allocated: 0.03440427780151367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 0.036966800689697266  GigaBytes
Max Memory Allocated: 0.036966800689697266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 0.036966800689697266  GigaBytes
Max Memory Allocated: 0.036966800689697266  GigaBytes

first layer input nodes number: 91540
first layer output nodes number: 26902
edges number: 262569
----------------------------------------before model layer 0
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 0.03784990310668945  GigaBytes
Max Memory Allocated: 0.038828372955322266  GigaBytes

torch.Size([91540, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 0.03784990310668945  GigaBytes
Max Memory Allocated: 0.038828372955322266  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 0.03784990310668945  GigaBytes
Max Memory Allocated: 0.038828372955322266  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05063343048095703  GigaBytes
Max Memory Allocated: 0.06075620651245117  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05063343048095703  GigaBytes
Max Memory Allocated: 0.06075620651245117  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4139404296875 GB
    Memory Allocated: 0.07628917694091797  GigaBytes
Max Memory Allocated: 0.07628917694091797  GigaBytes

h_neigh size torch.Size([26902, 256])
h_self size  torch.Size([26902, 100])
----------------------------------------before rst
 Nvidia-smi: 7.4139404296875 GB
    Memory Allocated: 0.07628917694091797  GigaBytes
Max Memory Allocated: 0.07628917694091797  GigaBytes

torch.Size([26902, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.1019449234008789  GigaBytes
Max Memory Allocated: 0.12760066986083984  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.07628917694091797  GigaBytes
Max Memory Allocated: 0.12760066986083984  GigaBytes

torch.Size([26902, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.1019449234008789  GigaBytes
Max Memory Allocated: 0.12760066986083984  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.10835886001586914  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------input nodes number: 26902
----------------output nodes number: 2981
----------------edges number: 70928
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.1085820198059082  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.1085820198059082  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11197710037231445  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11197710037231445  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11249923706054688  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11249923706054688  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.1130213737487793  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11249923706054688  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.1130213737487793  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.4705810546875 GB
    Memory Allocated: 0.11354446411132812  GigaBytes
Max Memory Allocated: 0.13401460647583008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.04280853271484375  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

pseudo mini batch 1 input nodes size: 101551
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.03520774841308594  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5252685546875 GB
    Memory Allocated: 0.03520774841308594  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.07303857803344727  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.07306098937988281  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.03893709182739258  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.04180097579956055  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.04180097579956055  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

first layer input nodes number: 101551
first layer output nodes number: 30906
edges number: 299596
----------------------------------------before model layer 0
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.042788028717041016  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

torch.Size([101551, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.042788028717041016  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.042788028717041016  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.05664968490600586  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.05664968490600586  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.08612394332885742  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

h_neigh size torch.Size([30906, 256])
h_self size  torch.Size([30906, 100])
----------------------------------------before rst
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 0.08612394332885742  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

torch.Size([30906, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.11559820175170898  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.08612394332885742  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

torch.Size([30906, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.11559820175170898  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12296676635742188  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------input nodes number: 30906
----------------output nodes number: 2982
----------------edges number: 69231
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12321949005126953  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12321949005126953  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.1266021728515625  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.1266021728515625  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12712430953979492  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12712430953979492  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12764644622802734  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12712430953979492  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12712430953979492  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 0.12764692306518555  GigaBytes
Max Memory Allocated: 0.16167688369750977  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 0.04654741287231445  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 2 input nodes size: 103139
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 0.03893709182739258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6639404296875 GB
    Memory Allocated: 0.03893709182739258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.07799959182739258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.07802343368530273  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04017019271850586  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04289102554321289  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04289102554321289  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 103139
first layer output nodes number: 29282
edges number: 287388
----------------------------------------before model layer 0
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04387807846069336  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([103139, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04387807846069336  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04387807846069336  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.05709362030029297  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.05709362030029297  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.08501911163330078  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([29282, 256])
h_self size  torch.Size([29282, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.08501911163330078  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([29282, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.1129446029663086  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.08501911163330078  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([29282, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.1129446029663086  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.11992597579956055  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 29282
----------------output nodes number: 3162
----------------edges number: 77599
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12016820907592773  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12016820907592773  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12409543991088867  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12409543991088867  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.1246495246887207  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.1246495246887207  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12520360946655273  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.1246495246887207  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12468147277832031  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.12523603439331055  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.047738075256347656  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 3 input nodes size: 84909
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04020214080810547  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.04020214080810547  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.07183361053466797  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.07185745239257812  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03277111053466797  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03521156311035156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03521156311035156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 84909
first layer output nodes number: 25401
edges number: 249225
----------------------------------------before model layer 0
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03603363037109375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([84909, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03603363037109375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.03603363037109375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.04744911193847656  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.04744911193847656  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.07167339324951172  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([25401, 256])
h_self size  torch.Size([25401, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.07167339324951172  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([25401, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.09589767456054688  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.07167339324951172  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([25401, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.09589767456054688  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10195398330688477  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 25401
----------------output nodes number: 3160
----------------edges number: 78158
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10216712951660156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10216712951660156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10589313507080078  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10589313507080078  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([3160, 47])
h_self size  torch.Size([3160, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10700035095214844  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10644674301147461  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3160, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.1064462661743164  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 0.10700035095214844  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03947114944458008  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 4 input nodes size: 73529
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.032770633697509766  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.032770633697509766  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06016254425048828  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06018543243408203  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.028530120849609375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.030820846557617188  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.030820846557617188  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 73529
first layer output nodes number: 24327
edges number: 236262
----------------------------------------before model layer 0
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03155040740966797  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([73529, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03155040740966797  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03155040740966797  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0424647331237793  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0424647331237793  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06566476821899414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([24327, 256])
h_self size  torch.Size([24327, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06566476821899414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([24327, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.08886480331420898  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06566476821899414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([24327, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.08886480331420898  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0946650505065918  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 24327
----------------output nodes number: 3024
----------------edges number: 71166
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09830665588378906  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09830665588378906  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09883642196655273  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([3024, 47])
h_self size  torch.Size([3024, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09883642196655273  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3024, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0993661880493164  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09883642196655273  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3024, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09881258010864258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.09934282302856445  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03474569320678711  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 5 input nodes size: 86077
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.02850627899169922  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.02850627899169922  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06057262420654297  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06059551239013672  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03318071365356445  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03680849075317383  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03680849075317383  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 86077
first layer output nodes number: 29891
edges number: 291075
----------------------------------------before model layer 0
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.037672996520996094  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([86077, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.037672996520996094  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.037672996520996094  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05108976364135742  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05108976364135742  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07959604263305664  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([29891, 256])
h_self size  torch.Size([29891, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07959604263305664  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([29891, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.10810232162475586  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07959604263305664  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([29891, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.10810232162475586  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11522912979125977  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 29891
----------------output nodes number: 3065
----------------edges number: 72095
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11547517776489258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11547517776489258  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11895895004272461  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11895895004272461  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11949586868286133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([3065, 47])
h_self size  torch.Size([3065, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11949586868286133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3065, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12003278732299805  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11949586868286133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3065, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11950302124023438  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.1200404167175293  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04140615463256836  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 6 input nodes size: 91279
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0331878662109375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0331878662109375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.06719207763671875  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0672149658203125  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.035125732421875  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03769493103027344  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03769493103027344  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 91279
first layer output nodes number: 28062
edges number: 272780
----------------------------------------before model layer 0
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03858470916748047  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([91279, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03858470916748047  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.03858470916748047  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05142498016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05142498016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07876873016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([28062, 256])
h_self size  torch.Size([28062, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07876873016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([28062, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.10611248016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07876873016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([28062, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.10611248016357422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11280298233032227  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 28062
----------------output nodes number: 3067
----------------edges number: 71924
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11303520202636719  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11303520202636719  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11651897430419922  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11651897430419922  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11705636978149414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([3067, 47])
h_self size  torch.Size([3067, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11705636978149414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3067, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11759376525878906  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11705636978149414  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([3067, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11705684661865234  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11759471893310547  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04239177703857422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

pseudo mini batch 7 input nodes size: 102621
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0351262092590332  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0351262092590332  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.0741887092590332  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.07421112060546875  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04018402099609375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04296302795410156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04296302795410156  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

first layer input nodes number: 102621
first layer output nodes number: 30650
edges number: 301102
----------------------------------------before model layer 0
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04395627975463867  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([102621, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04395627975463867  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04395627975463867  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05773305892944336  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.05773305892944336  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.08696317672729492  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([30650, 256])
h_self size  torch.Size([30650, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.08696317672729492  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([30650, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11619329452514648  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.08696317672729492  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([30650, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.11619329452514648  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12350082397460938  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------input nodes number: 30650
----------------output nodes number: 2981
----------------edges number: 71740
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12375164031982422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12375164031982422  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.1273355484008789  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.1273355484008789  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12785768508911133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12785768508911133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12837982177734375  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12785768508911133  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12784242630004883  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.12836503982543945  GigaBytes
Max Memory Allocated: 0.18332719802856445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04774618148803711  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

pseudo mini batch 8 input nodes size: 126991
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04016876220703125  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7069091796875 GB
    Memory Allocated: 0.04016876220703125  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.08747673034667969  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.08750009536743164  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.048415184020996094  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.051789283752441406  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.051789283752441406  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

first layer input nodes number: 126991
first layer output nodes number: 35226
edges number: 347836
----------------------------------------before model layer 0
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.05299854278564453  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

torch.Size([126991, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.05299854278564453  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 0.05299854278564453  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.06884527206420898  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.06884527206420898  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.10243940353393555  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

h_neigh size torch.Size([35226, 256])
h_self size  torch.Size([35226, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.10243940353393555  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

torch.Size([35226, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1360335350036621  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.10243940353393555  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

torch.Size([35226, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1360335350036621  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14443206787109375  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------input nodes number: 35226
----------------output nodes number: 3075
----------------edges number: 74768
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14471817016601562  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14471817016601562  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14823246002197266  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14823246002197266  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1487712860107422  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

h_neigh size torch.Size([3075, 47])
h_self size  torch.Size([3075, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1487712860107422  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

torch.Size([3075, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14931011199951172  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1487712860107422  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

torch.Size([3075, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.1487879753112793  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7576904296875 GB
    Memory Allocated: 0.14932727813720703  GigaBytes
Max Memory Allocated: 0.18339300155639648  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 0.05728435516357422  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

pseudo mini batch 9 input nodes size: 118173
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 0.0484318733215332  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 0.0484318733215332  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.0933537483215332  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.09337663650512695  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04604530334472656  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04915809631347656  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04915809631347656  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

first layer input nodes number: 118173
first layer output nodes number: 34300
edges number: 341182
----------------------------------------before model layer 0
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05029439926147461  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([118173, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05029439926147461  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05029439926147461  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.06574249267578125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.06574249267578125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.09845352172851562  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([34300, 256])
h_self size  torch.Size([34300, 100])
----------------------------------------before rst
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.09845352172851562  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([34300, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.13116455078125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.09845352172851562  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([34300, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.13116455078125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1393423080444336  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------input nodes number: 34300
----------------output nodes number: 3064
----------------edges number: 76463
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.13962078094482422  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.13962078094482422  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14313602447509766  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14313602447509766  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14367294311523438  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([3064, 47])
h_self size  torch.Size([3064, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14367294311523438  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3064, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1442098617553711  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14367294311523438  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3064, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14367103576660156  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.14420843124389648  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05452108383178711  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

pseudo mini batch 10 input nodes size: 111073
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04604339599609375  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04604339599609375  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.08742141723632812  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.08744430541992188  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.042499542236328125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04521751403808594  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04521751403808594  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

first layer input nodes number: 111073
first layer output nodes number: 29676
edges number: 289849
----------------------------------------before model layer 0
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04626655578613281  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([111073, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04626655578613281  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04626655578613281  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05959272384643555  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.05959272384643555  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.08789396286010742  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([29676, 256])
h_self size  torch.Size([29676, 100])
----------------------------------------before rst
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.08789396286010742  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([29676, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1161952018737793  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.08789396286010742  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([29676, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1161952018737793  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.12327051162719727  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------input nodes number: 29676
----------------output nodes number: 3053
----------------edges number: 74771
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.12351465225219727  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.12351465225219727  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1270442008972168  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1270442008972168  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1275792121887207  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([3053, 47])
h_self size  torch.Size([3053, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1275792121887207  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3053, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1281142234802246  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1275792121887207  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3053, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.1275773048400879  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.12811279296875  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.050017356872558594  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

pseudo mini batch 11 input nodes size: 124554
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04249763488769531  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8416748046875 GB
    Memory Allocated: 0.04249763488769531  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.08937263488769531  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.08939504623413086  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.047994136810302734  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.05096006393432617  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.05096006393432617  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

first layer input nodes number: 124554
first layer output nodes number: 33086
edges number: 324864
----------------------------------------before model layer 0
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.05213499069213867  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([124554, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.05213499069213867  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.05213499069213867  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.06700468063354492  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.06700468063354492  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.09855794906616211  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([33086, 256])
h_self size  torch.Size([33086, 100])
----------------------------------------before rst
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.09855794906616211  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([33086, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.1301112174987793  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.09855794906616211  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([33086, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.1301112174987793  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.1379995346069336  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------input nodes number: 33086
----------------output nodes number: 2981
----------------edges number: 73194
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.13826847076416016  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.13826847076416016  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.1416797637939453  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.1416797637939453  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14220190048217773  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14220190048217773  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14272403717041016  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14220190048217773  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14218902587890625  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.14271163940429688  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.056160926818847656  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

pseudo mini batch 12 input nodes size: 142162
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.04798126220703125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8885498046875 GB
    Memory Allocated: 0.04798126220703125  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.10094118118286133  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.10096454620361328  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.054067134857177734  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.05777788162231445  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.05777788162231445  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

first layer input nodes number: 142162
first layer output nodes number: 38001
edges number: 376413
----------------------------------------before model layer 0
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.05912065505981445  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([142162, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.05912065505981445  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 0.05912065505981445  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.07622385025024414  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.07622385025024414  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.11246442794799805  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([38001, 256])
h_self size  torch.Size([38001, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.11246442794799805  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([38001, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.14870500564575195  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.11246442794799805  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([38001, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.14870500564575195  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.15796184539794922  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------input nodes number: 38001
----------------output nodes number: 3131
----------------edges number: 77864
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.15826845169067383  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.15826845169067383  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16185903549194336  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16185903549194336  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16240739822387695  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

h_neigh size torch.Size([3131, 47])
h_self size  torch.Size([3131, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16240739822387695  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3131, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16295576095581055  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16240739822387695  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

torch.Size([3131, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16243362426757812  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 0.16298246383666992  GigaBytes
Max Memory Allocated: 0.21318292617797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.06371498107910156  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

pseudo mini batch 13 input nodes size: 122291
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.054093360900878906  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.054093360900878906  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.09965038299560547  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.09967374801635742  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04669046401977539  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04979133605957031  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04979133605957031  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

first layer input nodes number: 122291
first layer output nodes number: 32624
edges number: 323090
----------------------------------------before model layer 0
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05094575881958008  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([122291, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05094575881958008  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05094575881958008  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.06578302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.06578302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.09703302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([32624, 256])
h_self size  torch.Size([32624, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.09703302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([32624, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12828302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.09703302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([32624, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12828302383422852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1360611915588379  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------input nodes number: 32624
----------------output nodes number: 3121
----------------edges number: 77581
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.13632774353027344  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.13632774353027344  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1399068832397461  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1399068832397461  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14045333862304688  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([3121, 47])
h_self size  torch.Size([3121, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14045333862304688  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3121, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14099979400634766  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14045333862304688  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3121, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14045143127441406  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14099836349487305  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05518531799316406  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

pseudo mini batch 14 input nodes size: 94704
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04668855667114258  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04668855667114258  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08196878433227539  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08199214935302734  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03641176223754883  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03930330276489258  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

first layer input nodes number: 94704
first layer output nodes number: 31231
edges number: 309968
----------------------------------------before model layer 0
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04024171829223633  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([94704, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04024171829223633  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04024171829223633  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05462026596069336  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05462026596069336  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08440446853637695  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([31231, 256])
h_self size  torch.Size([31231, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08440446853637695  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([31231, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11418867111206055  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08440446853637695  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([31231, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11418867111206055  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12163496017456055  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------input nodes number: 31231
----------------output nodes number: 3135
----------------edges number: 77994
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12189102172851562  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12189102172851562  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1254863739013672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1254863739013672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1260356903076172  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([3135, 47])
h_self size  torch.Size([3135, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1260356903076172  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3135, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1265850067138672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1260356903076172  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3135, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1260385513305664  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1265883445739746  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04453611373901367  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

pseudo mini batch 15 input nodes size: 129905
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03641462326049805  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03641462326049805  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08524274826049805  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.0852665901184082  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04996299743652344  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.053099632263183594  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.053099632263183594  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

first layer input nodes number: 129905
first layer output nodes number: 34449
edges number: 342593
----------------------------------------before model layer 0
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05432462692260742  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([129905, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05432462692260742  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.05432462692260742  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.0698399543762207  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.0698399543762207  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.10269308090209961  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([34449, 256])
h_self size  torch.Size([34449, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.10269308090209961  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([34449, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.13554620742797852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.10269308090209961  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([34449, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.13554620742797852  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14471197128295898  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------input nodes number: 34449
----------------output nodes number: 3157
----------------edges number: 78272
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14499282836914062  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14499282836914062  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14861106872558594  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14861106872558594  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14916419982910156  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([3157, 47])
h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14916419982910156  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1497173309326172  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14916419982910156  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1491680145263672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.14972162246704102  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.058598995208740234  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

pseudo mini batch 16 input nodes size: 99543
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04996681213378906  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04996681213378906  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08704948425292969  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08707332611083984  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.03822135925292969  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04185771942138672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04185771942138672  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

first layer input nodes number: 99543
first layer output nodes number: 29578
edges number: 289770
----------------------------------------before model layer 0
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04282045364379883  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([99543, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04282045364379883  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04282045364379883  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.056108951568603516  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.056108951568603516  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08431673049926758  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([29578, 256])
h_self size  torch.Size([29578, 100])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08431673049926758  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([29578, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11252450942993164  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.08431673049926758  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([29578, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11252450942993164  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11957645416259766  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------input nodes number: 29578
----------------output nodes number: 3163
----------------edges number: 77383
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11982107162475586  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.11982107162475586  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12346410751342773  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12346410751342773  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12401819229125977  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12401819229125977  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1245722770690918  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12401819229125977  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.12401914596557617  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.1245737075805664  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.04661226272583008  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

pseudo mini batch 17 input nodes size: 158948
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.038222312927246094  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9471435546875 GB
    Memory Allocated: 0.038222312927246094  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.09743547439575195  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.0974588394165039  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.060352325439453125  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.06378650665283203  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.06378650665283203  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

first layer input nodes number: 158948
first layer output nodes number: 39941
edges number: 386159
----------------------------------------before model layer 0
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.06541824340820312  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([158948, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.06541824340820312  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.06541824340820312  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.08332395553588867  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.08332395553588867  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.12238645553588867  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([39941, 256])
h_self size  torch.Size([39941, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.12238645553588867  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([39941, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.1604771614074707  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.1214146614074707  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([39941, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.1604771614074707  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.1700000762939453  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------input nodes number: 39941
----------------output nodes number: 3111
----------------edges number: 74668
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17032146453857422  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17032146453857422  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17476654052734375  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17476654052734375  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17531156539916992  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

h_neigh size torch.Size([3111, 47])
h_self size  torch.Size([3111, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17531156539916992  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3111, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.1758565902709961  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17531156539916992  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

torch.Size([3111, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17530250549316406  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0076904296875 GB
    Memory Allocated: 0.17584800720214844  GigaBytes
Max Memory Allocated: 0.23209142684936523  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07003211975097656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 18 input nodes size: 128100
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060343265533447266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060343265533447266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10806465148925781  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10808753967285156  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04885101318359375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05201530456542969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05201530456542969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 128100
first layer output nodes number: 36242
edges number: 350802
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.053240299224853516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([128100, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.053240299224853516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.053240299224853516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06949138641357422  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06949138641357422  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10464763641357422  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([36242, 256])
h_self size  torch.Size([36242, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10464763641357422  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([36242, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13921070098876953  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10405445098876953  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([36242, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13921070098876953  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1483154296875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 36242
----------------output nodes number: 3055
----------------edges number: 73733
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14860868453979492  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14860868453979492  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15209531784057617  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15209531784057617  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15263032913208008  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3055, 47])
h_self size  torch.Size([3055, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15263032913208008  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3055, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15316534042358398  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15263032913208008  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3055, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1526203155517578  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15315580368041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.057520389556884766  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 19 input nodes size: 150593
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.048840999603271484  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.048840999603271484  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10494136810302734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1049652099609375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0572209358215332  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06052541732788086  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06052541732788086  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 150593
first layer output nodes number: 38159
edges number: 367670
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06251668930053711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([150593, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06251668930053711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06251668930053711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07961463928222656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07961463928222656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11600589752197266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([38159, 256])
h_self size  torch.Size([38159, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11600589752197266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([38159, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15239715576171875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11600589752197266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([38159, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.15239715576171875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16149520874023438  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 38159
----------------output nodes number: 3163
----------------edges number: 75658
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1618037223815918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1618037223815918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16540861129760742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16540861129760742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16596269607543945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16596269607543945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16651678085327148  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16596269607543945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.16598176956176758  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1665363311767578  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06701040267944336  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 20 input nodes size: 116933
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05724000930786133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05724000930786133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10080099105834961  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10082340240478516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04469919204711914  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04773712158203125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04773712158203125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 116933
first layer output nodes number: 31257
edges number: 304212
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04884195327758789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([116933, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04884195327758789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04884195327758789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06287002563476562  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06287002563476562  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09267902374267578  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([31257, 256])
h_self size  torch.Size([31257, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09267902374267578  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([31257, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12248802185058594  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09267902374267578  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([31257, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12248802185058594  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12994050979614258  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 31257
----------------output nodes number: 2984
----------------edges number: 72870
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13019609451293945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13019609451293945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13360834121704102  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13360834121704102  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13413095474243164  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2984, 47])
h_self size  torch.Size([2984, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13413095474243164  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2984, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13465356826782227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13413095474243164  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2984, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13409948348999023  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13462257385253906  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05266523361206055  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 21 input nodes size: 105301
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.044667720794677734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.044667720794677734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08389568328857422  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08391952514648438  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04033613204956055  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04296159744262695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04296159744262695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 105301
first layer output nodes number: 28977
edges number: 276888
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04396247863769531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([105301, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04396247863769531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04396247863769531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.056929588317871094  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.056929588317871094  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.084564208984375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([28977, 256])
h_self size  torch.Size([28977, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.084564208984375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([28977, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1121988296508789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.084564208984375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([28977, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1121988296508789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11910772323608398  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 28977
----------------output nodes number: 3156
----------------edges number: 75344
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11934757232666016  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11934757232666016  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12354850769042969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12354850769042969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12410116195678711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12410116195678711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12465381622314453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12410116195678711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1241312026977539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12468433380126953  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.047647953033447266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 22 input nodes size: 109580
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.040366172790527344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.040366172790527344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08118820190429688  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08121204376220703  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04196023941040039  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04468584060668945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04468584060668945  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 109580
first layer output nodes number: 29956
edges number: 289719
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04572629928588867  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([109580, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04572629928588867  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04572629928588867  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06001853942871094  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06001853942871094  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08858680725097656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([29956, 256])
h_self size  torch.Size([29956, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08858680725097656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29956, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11715507507324219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08858680725097656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29956, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11715507507324219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12444686889648438  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 29956
----------------output nodes number: 3154
----------------edges number: 75918
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1246943473815918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1246943473815918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12829256057739258  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12829256057739258  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12884521484375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3154, 47])
h_self size  torch.Size([3154, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12884521484375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3154, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12939786911010742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12884521484375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3154, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12884521484375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12939834594726562  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05036306381225586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 23 input nodes size: 113595
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04196023941040039  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04196023941040039  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08427810668945312  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08430051803588867  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043454647064208984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.046076297760009766  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.046076297760009766  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 113595
first layer output nodes number: 29115
edges number: 279893
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.047139644622802734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([113595, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.047139644622802734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.047139644622802734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06056642532348633  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06056642532348633  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([29115, 256])
h_self size  torch.Size([29115, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29115, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11609888076782227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0883326530456543  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29115, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11609888076782227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12304067611694336  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 29115
----------------output nodes number: 2981
----------------edges number: 71890
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12328004837036133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12328004837036133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12732267379760742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12732267379760742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12784481048583984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12784481048583984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12836694717407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12784481048583984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12781429290771484  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12833690643310547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.051120758056640625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 24 input nodes size: 104976
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043424129486083984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043424129486083984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08253097534179688  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08255434036254883  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04021406173706055  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.042630672454833984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.042630672454833984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 104976
first layer output nodes number: 25578
edges number: 249618
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04360389709472656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([104976, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04360389709472656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04360389709472656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05508852005004883  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05508852005004883  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07948160171508789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([25578, 256])
h_self size  torch.Size([25578, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07948160171508789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([25578, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10387468338012695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07948160171508789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([25578, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10387468338012695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10997295379638672  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 25578
----------------output nodes number: 3075
----------------edges number: 74572
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11018705368041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11018705368041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11371755599975586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11371755599975586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11425638198852539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3075, 47])
h_self size  torch.Size([3075, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11425638198852539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3075, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11479520797729492  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11425638198852539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3075, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1142730712890625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11481237411499023  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.047009944915771484  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 25 input nodes size: 138800
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.040230751037597656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.040230751037597656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09193801879882812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09196043014526367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05283021926879883  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0563511848449707  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0563511848449707  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 138800
first layer output nodes number: 32850
edges number: 321333
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05763053894042969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([138800, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05763053894042969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05763053894042969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0724954605102539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0724954605102539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10382366180419922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([32850, 256])
h_self size  torch.Size([32850, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10382366180419922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([32850, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13515186309814453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10382366180419922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([32850, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13515186309814453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14298391342163086  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 32850
----------------output nodes number: 2981
----------------edges number: 72476
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1432514190673828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1432514190673828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14665794372558594  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14665794372558594  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14718008041381836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14718008041381836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14770221710205078  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14718008041381836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14716339111328125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14768600463867188  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06172370910644531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 26 input nodes size: 139499
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05281352996826172  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05281352996826172  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1047811508178711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10480356216430664  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.053073883056640625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05604362487792969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05604362487792969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 139499
first layer output nodes number: 33345
edges number: 326097
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05733203887939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([139499, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05733203887939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05733203887939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07230854034423828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07230854034423828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10410881042480469  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([33345, 256])
h_self size  torch.Size([33345, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10410881042480469  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([33345, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1359090805053711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10410881042480469  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([33345, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1359090805053711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1438593864440918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 33345
----------------output nodes number: 2985
----------------edges number: 72336
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14413070678710938  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14413070678710938  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14846181869506836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14846181869506836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1489849090576172  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2985, 47])
h_self size  torch.Size([2985, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1489849090576172  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14950799942016602  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1489849090576172  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1489858627319336  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14950942993164062  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06137418746948242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 27 input nodes size: 122666
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05307483673095703  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05307483673095703  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09877157211303711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09879541397094727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.046805381774902344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04967832565307617  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04967832565307617  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 122666
first layer output nodes number: 30879
edges number: 300469
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05082273483276367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([122666, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05082273483276367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05082273483276367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0646810531616211  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0646810531616211  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09412956237792969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([30879, 256])
h_self size  torch.Size([30879, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09412956237792969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([30879, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12357807159423828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09412956237792969  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([30879, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12357807159423828  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13094043731689453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 30879
----------------output nodes number: 3160
----------------edges number: 77147
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1311945915222168  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1311945915222168  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13480710983276367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13480710983276367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1353607177734375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3160, 47])
h_self size  torch.Size([3160, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1353607177734375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13591432571411133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1353607177734375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3160, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1353912353515625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13594532012939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05473947525024414  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 28 input nodes size: 87624
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.046835899353027344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.046835899353027344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07947874069213867  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07950162887573242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03378105163574219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03684854507446289  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03684854507446289  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 87624
first layer output nodes number: 27243
edges number: 265550
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0377049446105957  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([87624, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0377049446105957  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0377049446105957  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05051469802856445  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05051469802856445  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07649564743041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([27243, 256])
h_self size  torch.Size([27243, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07649564743041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([27243, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10247659683227539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07649564743041992  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([27243, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10247659683227539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10897207260131836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 27243
----------------output nodes number: 3053
----------------edges number: 74269
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10919809341430664  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10919809341430664  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1126866340637207  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1126866340637207  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11322164535522461  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3053, 47])
h_self size  torch.Size([3053, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11322164535522461  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3053, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11375665664672852  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11322164535522461  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3053, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11320304870605469  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1137385368347168  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0417943000793457  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 29 input nodes size: 94524
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.033762454986572266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.033762454986572266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06897544860839844  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.06899833679199219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03633260726928711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03878355026245117  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03878355026245117  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 94524
first layer output nodes number: 26666
edges number: 257143
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03968667984008789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([94524, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03968667984008789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03968667984008789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0516362190246582  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0516362190246582  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07706689834594727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([26666, 256])
h_self size  torch.Size([26666, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07706689834594727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([26666, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10249757766723633  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07706689834594727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([26666, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10249757766723633  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1088552474975586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 26666
----------------output nodes number: 3017
----------------edges number: 71691
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.10907697677612305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11348438262939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11348438262939453  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1140127182006836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3017, 47])
h_self size  torch.Size([3017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1140127182006836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11454105377197266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1140127182006836  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11400604248046875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11453485488891602  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04309844970703125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 30 input nodes size: 114140
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.036325931549072266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.036325931549072266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07884645462036133  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07886886596679688  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04363298416137695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04657602310180664  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04657602310180664  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 114140
first layer output nodes number: 28581
edges number: 276567
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04763984680175781  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([114140, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04763984680175781  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04763984680175781  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060495853424072266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060495853424072266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08783960342407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([28581, 256])
h_self size  torch.Size([28581, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08783960342407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([28581, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11518335342407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08783960342407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([28581, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11518335342407227  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12199783325195312  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 28581
----------------output nodes number: 2981
----------------edges number: 72691
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12223339080810547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12223339080810547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.125640869140625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.125640869140625  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12616300582885742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12616300582885742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12668514251708984  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12616300582885742  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12615680694580078  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1266794204711914  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.051279544830322266  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 31 input nodes size: 112744
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04362678527832031  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04362678527832031  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08562755584716797  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08564996719360352  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043107032775878906  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04577922821044922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04577922821044922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 112744
first layer output nodes number: 29721
edges number: 286857
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04684114456176758  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([112744, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04684114456176758  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04684114456176758  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060760498046875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.060760498046875  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08910465240478516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([29721, 256])
h_self size  torch.Size([29721, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08910465240478516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29721, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11744880676269531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08910465240478516  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([29721, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11744880676269531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12453508377075195  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 29721
----------------output nodes number: 2981
----------------edges number: 71571
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12477922439575195  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12477922439575195  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12824201583862305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12824201583862305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1292862892150879  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1292867660522461  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05112314224243164  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 32 input nodes size: 92319
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043107032775878906  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.043107032775878906  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0782632827758789  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07828664779663086  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.036263465881347656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03906440734863281  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.03906440734863281  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 92319
first layer output nodes number: 30150
edges number: 298253
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0399775505065918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([92319, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0399775505065918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0399775505065918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05354499816894531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.05354499816894531  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08229827880859375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([30150, 256])
h_self size  torch.Size([30150, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08229827880859375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([30150, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11105155944824219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.08229827880859375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([30150, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11105155944824219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1182398796081543  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 30150
----------------output nodes number: 3111
----------------edges number: 77561
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11848831176757812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.11848831176757812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12219953536987305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12219953536987305  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3111, 47])
h_self size  torch.Size([3111, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3111, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12328958511352539  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12274456024169922  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3111, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12276744842529297  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12331295013427734  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04386472702026367  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 33 input nodes size: 112144
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.036286354064941406  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.036286354064941406  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0780634880065918  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.07808732986450195  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04290771484375  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04663991928100586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04663991928100586  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 112144
first layer output nodes number: 34619
edges number: 343970
----------------------------------------before model layer 0
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04773378372192383  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([112144, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04773378372192383  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.04773378372192383  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0633234977722168  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0633234977722168  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09633874893188477  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([34619, 256])
h_self size  torch.Size([34619, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09633874893188477  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([34619, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12935400009155273  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.09633874893188477  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([34619, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.12935400009155273  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13760805130004883  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 34619
----------------output nodes number: 3161
----------------edges number: 78778
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13788986206054688  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.13788986206054688  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14151573181152344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14151573181152344  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14206933975219727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14206933975219727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.1426229476928711  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14206933975219727  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14207792282104492  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.14263200759887695  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.0520329475402832  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

pseudo mini batch 34 input nodes size: 195678
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.042916297912597656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.042916297912597656  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.11581230163574219  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.11583471298217773  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.07403373718261719  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.0777130126953125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.0777130126953125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

first layer input nodes number: 195678
first layer output nodes number: 42357
edges number: 419992
----------------------------------------before model layer 0
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.07948684692382812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([195678, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.07948684692382812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0838623046875 GB
    Memory Allocated: 0.07948684692382812  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.09917593002319336  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.09917593002319336  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1395707130432129  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([42357, 256])
h_self size  torch.Size([42357, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1395707130432129  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([42357, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.17996549606323242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1395707130432129  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([42357, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.17996549606323242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1900644302368164  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------input nodes number: 42357
----------------output nodes number: 2981
----------------edges number: 73605
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19040250778198242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19040250778198242  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1946120262145996  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.1946120262145996  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19513416290283203  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19513416290283203  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19565629959106445  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19513416290283203  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19510269165039062  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0858154296875 GB
    Memory Allocated: 0.19562530517578125  GigaBytes
Max Memory Allocated: 0.24874114990234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0877685546875 GB
    Memory Allocated: 0.08497095108032227  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 35 input nodes size: 174904
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0877685546875 GB
    Memory Allocated: 0.07400226593017578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0877685546875 GB
    Memory Allocated: 0.07400226593017578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1391592025756836  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.13918304443359375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06626462936401367  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06984186172485352  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06984186172485352  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 174904
first layer output nodes number: 40601
edges number: 402458
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07144784927368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([174904, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07144784927368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07144784927368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08972406387329102  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08972406387329102  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12878656387329102  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([40601, 256])
h_self size  torch.Size([40601, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12878656387329102  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([40601, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16750669479370117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12844419479370117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([40601, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16750669479370117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1771869659423828  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 40601
----------------output nodes number: 3162
----------------edges number: 77562
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17751359939575195  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17751359939575195  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.18130159378051758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.18130159378051758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1818556785583496  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1818556785583496  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.18240976333618164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1818556785583496  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.18188762664794922  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.18244218826293945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07627677917480469  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 36 input nodes size: 121859
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06629657745361328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06629657745361328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11169290542602539  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11171579360961914  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04653501510620117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04960823059082031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04960823059082031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 121859
first layer output nodes number: 28359
edges number: 279210
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05072832107543945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([121859, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05072832107543945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05072832107543945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06347990036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06347990036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09082365036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([28359, 256])
h_self size  torch.Size([28359, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09082365036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([28359, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11816740036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09082365036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([28359, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11816740036010742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12505292892456055  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 28359
----------------output nodes number: 3036
----------------edges number: 74288
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12528753280639648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12528753280639648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12875986099243164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12875986099243164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12929153442382812  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3036, 47])
h_self size  torch.Size([3036, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12929153442382812  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3036, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1298232078552246  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12929153442382812  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3036, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12926912307739258  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12980127334594727  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.054352760314941406  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 37 input nodes size: 109788
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.046512603759765625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.046512603759765625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08741188049316406  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08743429183959961  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04201507568359375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04476642608642578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04476642608642578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 109788
first layer output nodes number: 29835
edges number: 295775
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0458073616027832  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([109788, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0458073616027832  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0458073616027832  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.059954166412353516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.059954166412353516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08840703964233398  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([29835, 256])
h_self size  torch.Size([29835, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08840703964233398  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([29835, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11685991287231445  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08840703964233398  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([29835, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11685991287231445  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12417459487915039  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 29835
----------------output nodes number: 2981
----------------edges number: 73443
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1244196891784668  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1244196891784668  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12783288955688477  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12783288955688477  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1283550262451172  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1283550262451172  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1288771629333496  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1283550262451172  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12834548950195312  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12886810302734375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05029296875  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 38 input nodes size: 147342
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04200553894042969  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04200553894042969  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09689474105834961  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09691858291625977  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05599689483642578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.059517860412597656  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.059517860412597656  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 147342
first layer output nodes number: 39596
edges number: 393641
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06091117858886719  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([147342, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06091117858886719  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06091117858886719  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0789027214050293  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0789027214050293  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11666440963745117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([39596, 256])
h_self size  torch.Size([39596, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11666440963745117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([39596, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15442609786987305  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11666440963745117  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([39596, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15442609786987305  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16386651992797852  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 39596
----------------output nodes number: 3156
----------------edges number: 78753
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1641855239868164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1641855239868164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16780662536621094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16780662536621094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16835927963256836  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16835927963256836  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16891193389892578  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16835927963256836  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16838979721069336  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16894292831420898  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06583595275878906  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 39 input nodes size: 112068
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05602741241455078  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05602741241455078  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09777641296386719  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09780025482177734  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.042887210845947266  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04664278030395508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04664278030395508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 112068
first layer output nodes number: 35590
edges number: 352700
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.047743797302246094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([112068, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.047743797302246094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.047743797302246094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06376361846923828  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06376361846923828  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09770488739013672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([35590, 256])
h_self size  torch.Size([35590, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09770488739013672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([35590, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.13164615631103516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09770488739013672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([35590, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.13164615631103516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14013147354125977  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 35590
----------------output nodes number: 3137
----------------edges number: 78095
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14042091369628906  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14042091369628906  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14467191696166992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14467191696166992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14522123336791992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3137, 47])
h_self size  torch.Size([3137, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14522123336791992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3137, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14577054977416992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14522123336791992  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3137, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1452178955078125  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1457676887512207  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05210161209106445  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 40 input nodes size: 126790
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.042883872985839844  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.042883872985839844  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09011697769165039  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09014081954956055  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.048367977142333984  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.051911354064941406  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.051911354064941406  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 126790
first layer output nodes number: 36720
edges number: 365277
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.053130149841308594  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([126790, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.053130149841308594  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.053130149841308594  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06966829299926758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06966829299926758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10482454299926758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([36720, 256])
h_self size  torch.Size([36720, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10482454299926758  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([36720, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.13984346389770508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10468721389770508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([36720, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.13984346389770508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14859819412231445  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 36720
----------------output nodes number: 3159
----------------edges number: 78782
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1488957405090332  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1488957405090332  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15251970291137695  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15251970291137695  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15307283401489258  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3159, 47])
h_self size  torch.Size([3159, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15307283401489258  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3159, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1536259651184082  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15307283401489258  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3159, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1530766487121582  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15363025665283203  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05761384963989258  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 41 input nodes size: 132756
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04837179183959961  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04837179183959961  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09782743453979492  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09785127639770508  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.050594329833984375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0537261962890625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0537261962890625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 132756
first layer output nodes number: 34413
edges number: 341763
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.054972171783447266  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([132756, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.054972171783447266  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.054972171783447266  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07123279571533203  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07123279571533203  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10405158996582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([34413, 256])
h_self size  torch.Size([34413, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10405158996582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([34413, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1368703842163086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10405158996582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([34413, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1368703842163086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14507532119750977  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 34413
----------------output nodes number: 3150
----------------edges number: 78349
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1453557014465332  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1453557014465332  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14896821975708008  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14896821975708008  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1495199203491211  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3150, 47])
h_self size  torch.Size([3150, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1495199203491211  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3150, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1500716209411621  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1495199203491211  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3150, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14951848983764648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1500706672668457  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06000089645385742  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 42 input nodes size: 82354
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.050592899322509766  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.050592899322509766  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08184289932250977  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08186578750610352  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03238630294799805  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03491353988647461  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03491353988647461  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 82354
first layer output nodes number: 26575
edges number: 262667
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03572559356689453  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([82354, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03572559356689453  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03572559356689453  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07384824752807617  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([26575, 256])
h_self size  torch.Size([26575, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07384824752807617  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([26575, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09919214248657227  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07384824752807617  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([26575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09919214248657227  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10552835464477539  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 26575
----------------output nodes number: 3066
----------------edges number: 76297
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10574960708618164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10574960708618164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10926580429077148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10926580429077148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3066, 47])
h_self size  torch.Size([3066, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3066, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11033964157104492  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1098027229309082  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3066, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1097879409790039  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.11032533645629883  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.04006004333496094  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 43 input nodes size: 149696
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03237152099609375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.03237152099609375  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08813762664794922  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.08816003799438477  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.056887149810791016  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05995798110961914  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05995798110961914  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 149696
first layer output nodes number: 34061
edges number: 337686
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.061327457427978516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([149696, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.061327457427978516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.061327457427978516  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0766606330871582  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.0766606330871582  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10914373397827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([34061, 256])
h_self size  torch.Size([34061, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10914373397827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([34061, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14162683486938477  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.10914373397827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([34061, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.14162683486938477  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1497478485107422  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 34061
----------------output nodes number: 2982
----------------edges number: 74272
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1500244140625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1500244140625  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15344524383544922  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15344524383544922  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15396738052368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15396738052368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15448951721191406  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15396738052368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15395259857177734  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.15447521209716797  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06548023223876953  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 44 input nodes size: 175940
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05687236785888672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.05687236785888672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12327861785888672  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12330102920532227  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06751251220703125  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07094764709472656  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07094764709472656  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 175940
first layer output nodes number: 38936
edges number: 386300
----------------------------------------before model layer 0
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07254934310913086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([175940, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07254934310913086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07254934310913086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09007787704467773  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.09007787704467773  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12721014022827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([38936, 256])
h_self size  torch.Size([38936, 100])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12721014022827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([38936, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16434240341186523  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.12721014022827148  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([38936, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.16434240341186523  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17362546920776367  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 38936
----------------output nodes number: 2997
----------------edges number: 74703
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17393827438354492  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17393827438354492  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17737627029418945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17737627029418945  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1779012680053711  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([2997, 47])
h_self size  torch.Size([2997, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1779012680053711  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2997, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17842626571655273  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1779012680053711  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([2997, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.1779041290283203  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.17842960357666016  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.07715940475463867  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

pseudo mini batch 45 input nodes size: 205696
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06751537322998047  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1541748046875 GB
    Memory Allocated: 0.06751537322998047  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.14414310455322266  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.1441659927368164  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.07773733139038086  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.08167123794555664  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.08167123794555664  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

first layer input nodes number: 205696
first layer output nodes number: 45598
edges number: 452711
----------------------------------------before model layer 0
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.08354377746582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([205696, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.08354377746582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.08354377746582031  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.10493183135986328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.10493183135986328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.14841747283935547  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([45598, 256])
h_self size  torch.Size([45598, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.14841747283935547  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([45598, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.19190311431884766  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.14841747283935547  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([45598, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.19190311431884766  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.2027745246887207  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------input nodes number: 45598
----------------output nodes number: 3025
----------------edges number: 75231
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20313739776611328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20313739776611328  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.2066059112548828  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.2066059112548828  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20713567733764648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

h_neigh size torch.Size([3025, 47])
h_self size  torch.Size([3025, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20713567733764648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3025, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20766544342041016  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20713567733764648  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

torch.Size([3025, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.20714044570922852  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2322998046875 GB
    Memory Allocated: 0.2076706886291504  GigaBytes
Max Memory Allocated: 0.2724289894104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0896158218383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 46 input nodes size: 157862
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07774209976196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07774209976196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1365504264831543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13657426834106445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059923648834228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06370210647583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06370210647583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 157862
first layer output nodes number: 39350
edges number: 390354
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06517171859741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([157862, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06517171859741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06517171859741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0828866958618164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0828866958618164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12041378021240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([39350, 256])
h_self size  torch.Size([39350, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12041378021240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39350, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15794086456298828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12041378021240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39350, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15794086456298828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16732263565063477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 39350
----------------output nodes number: 3163
----------------edges number: 78497
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16763973236083984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16763973236083984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1712656021118164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1712656021118164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17181968688964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17181968688964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17237377166748047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17181968688964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1718440055847168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17239856719970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06989860534667969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 47 input nodes size: 134611
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059947967529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059947967529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11009454727172852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11011695861816406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0512847900390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.054508209228515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.054508209228515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 134611
first layer output nodes number: 36088
edges number: 357996
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.056650638580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([134611, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.056650638580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.056650638580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07289648056030273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07289648056030273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10805273056030273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36088, 256])
h_self size  torch.Size([36088, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10805273056030273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36088, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14246892929077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10731267929077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14246892929077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15107297897338867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36088
----------------output nodes number: 2998
----------------edges number: 74544
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15136432647705078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15136432647705078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1553630828857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1553630828857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15588808059692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2998, 47])
h_self size  torch.Size([2998, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15588808059692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15641307830810547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15588808059692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2998, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15585899353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15638446807861328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06097269058227539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 48 input nodes size: 81893
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05125570297241211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05125570297241211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08250570297241211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08252906799316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032360076904296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03483104705810547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03483104705810547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 81893
first layer output nodes number: 25805
edges number: 254819
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03563404083251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([81893, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03563404083251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03563404083251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04724264144897461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04724264144897461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07185220718383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25805, 256])
h_self size  torch.Size([25805, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07185220718383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25805, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09646177291870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07185220718383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25805, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09646177291870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1026144027709961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25805
----------------output nodes number: 3096
----------------edges number: 76753
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10283041000366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10283041000366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10637903213500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10637903213500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10692119598388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3096, 47])
h_self size  torch.Size([3096, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10692119598388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3096, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10746335983276367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10692119598388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3096, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10693836212158203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10748100280761719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.039114952087402344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 49 input nodes size: 85860
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03237724304199219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03237724304199219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06436300277709961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06438684463500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03311347961425781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.035675048828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.035675048828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 85860
first layer output nodes number: 27315
edges number: 266086
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03651857376098633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([85860, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03651857376098633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03651857376098633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04952716827392578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04952716827392578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0755767822265625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27315, 256])
h_self size  torch.Size([27315, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0755767822265625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27315, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10162639617919922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0755767822265625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27315, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10162639617919922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1081390380859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27315
----------------output nodes number: 3156
----------------edges number: 77674
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10836648941040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10836648941040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11197900772094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11197900772094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11253166198730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11253166198730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11308431625366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11253166198730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11254215240478516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11309528350830078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04086112976074219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 50 input nodes size: 140317
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03312397003173828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03312397003173828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08539628982543945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08542013168334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05341053009033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05686187744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05686187744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 140317
first layer output nodes number: 39040
edges number: 385327
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05819845199584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([140317, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05819845199584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05819845199584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0757594108581543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0757594108581543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1129908561706543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([39040, 256])
h_self size  torch.Size([39040, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1129908561706543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39040, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1502223014831543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1129908561706543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39040, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1502223014831543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1595301628112793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 39040
----------------output nodes number: 3156
----------------edges number: 77759
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15984487533569336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15984487533569336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16345834732055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16345834732055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16401100158691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16401100158691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16456365585327148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16401100158691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16401100158691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1645641326904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06284809112548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 51 input nodes size: 115282
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05341053009033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05341053009033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09635686874389648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09638071060180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04408454895019531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047890663146972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047890663146972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 115282
first layer output nodes number: 33890
edges number: 335634
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049002647399902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([115282, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049002647399902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049002647399902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0642557144165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0642557144165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09657573699951172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([33890, 256])
h_self size  torch.Size([33890, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09657573699951172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33890, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12889575958251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09657573699951172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33890, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12889575958251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13697576522827148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 33890
----------------output nodes number: 3137
----------------edges number: 77778
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1372523307800293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1372523307800293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14084768295288086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14084768295288086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14139699935913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3137, 47])
h_self size  torch.Size([3137, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14139699935913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3137, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14194631576538086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14139699935913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3137, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14139366149902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14194345474243164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05320167541503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 52 input nodes size: 142964
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04408121109008789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04408121109008789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09733963012695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09736204147338867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05439186096191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.057591915130615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.057591915130615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 142964
first layer output nodes number: 34240
edges number: 334254
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05891227722167969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([142964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05891227722167969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05891227722167969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07428646087646484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07428646087646484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10694026947021484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34240, 256])
h_self size  torch.Size([34240, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10694026947021484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34240, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13959407806396484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10694026947021484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34240, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13959407806396484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14775753021240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34240
----------------output nodes number: 2981
----------------edges number: 70406
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14803504943847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14803504943847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1514263153076172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1514263153076172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1519484519958496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1519484519958496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15247058868408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1519484519958496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15192127227783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15244388580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06297159194946289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 53 input nodes size: 124887
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.054364681243896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.054364681243896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10123968124389648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10126256942749023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04798173904418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05059003829956055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05059003829956055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 124887
first layer output nodes number: 28672
edges number: 279525
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05173444747924805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([124887, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05173444747924805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05173444747924805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06512451171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06512451171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09246826171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28672, 256])
h_self size  torch.Size([28672, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09246826171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28672, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11981201171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09246826171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28672, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11981201171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12664794921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28672
----------------output nodes number: 3017
----------------edges number: 70526
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12688446044921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12688446044921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13080406188964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13080406188964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1313323974609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3017, 47])
h_self size  torch.Size([3017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1313323974609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13186073303222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1313323974609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13133859634399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1318674087524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055855751037597656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 54 input nodes size: 89004
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047987937927246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047987937927246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08114480972290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08116817474365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034270286560058594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0378422737121582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0378422737121582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 89004
first layer output nodes number: 28796
edges number: 274831
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038720130920410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([89004, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038720130920410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038720130920410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05221414566040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05221414566040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07967615127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28796, 256])
h_self size  torch.Size([28796, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07967615127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28796, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10713815689086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07967615127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28796, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10713815689086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11400365829467773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28796
----------------output nodes number: 3106
----------------edges number: 73553
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1142416000366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1142416000366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11860179901123047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11860179901123047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11914587020874023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3106, 47])
h_self size  torch.Size([3106, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11914587020874023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3106, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11968994140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11914587020874023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3106, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11916160583496094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1197061538696289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04295635223388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 55 input nodes size: 75196
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0342860221862793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0342860221862793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.062322139739990234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029141902923583984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03144025802612305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03144025802612305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 75196
first layer output nodes number: 24276
edges number: 234727
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032181739807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([75196, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032181739807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032181739807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04306507110595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04306507110595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06621646881103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([24276, 256])
h_self size  torch.Size([24276, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06621646881103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24276, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08936786651611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06621646881103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24276, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08936786651611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09515571594238281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 24276
----------------output nodes number: 3131
----------------edges number: 73700
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09536027908325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09536027908325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09891939163208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09891939163208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09946775436401367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3131, 47])
h_self size  torch.Size([3131, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09946775436401367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3131, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10001611709594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09946775436401367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3131, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0994720458984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1000208854675293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0354313850402832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 56 input nodes size: 201777
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029146194458007812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029146194458007812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10431432723999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10433673858642578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07630062103271484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0798196792602539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0798196792602539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 201777
first layer output nodes number: 40440
edges number: 399616
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08162450790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([201777, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08162450790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08162450790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09981775283813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09981775283813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13888025283813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([40440, 256])
h_self size  torch.Size([40440, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13888025283813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([40440, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17744684219360352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13838434219360352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([40440, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17744684219360352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1870884895324707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 40440
----------------output nodes number: 2981
----------------edges number: 72649
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.18741226196289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.18741226196289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19148921966552734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19148921966552734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19201135635375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19201135635375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1925334930419922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19201135635375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1919851303100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.19250774383544922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08629560470581055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 57 input nodes size: 132815
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07627439498901367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07627439498901367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12575197219848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12577533721923828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05058479309082031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05375480651855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05375480651855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 132815
first layer output nodes number: 35447
edges number: 349004
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055008888244628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([132815, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055008888244628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055008888244628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07126569747924805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07126569747924805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10507059097290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35447, 256])
h_self size  torch.Size([35447, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10507059097290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35447, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13887548446655273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10507059097290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13887548446655273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14732694625854492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35447
----------------output nodes number: 3135
----------------edges number: 76366
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1476144790649414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1476144790649414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1511974334716797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1511974334716797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1517467498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3135, 47])
h_self size  torch.Size([3135, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1517467498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3135, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1522960662841797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1517467498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3135, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15177392959594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15232372283935547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059658050537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 58 input nodes size: 142943
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05061197280883789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05061197280883789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10386276245117188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10388660430908203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05438566207885742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0575413703918457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0575413703918457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 142943
first layer output nodes number: 34918
edges number: 346006
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05886697769165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([142943, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05886697769165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05886697769165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0745840072631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0745840072631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10788440704345703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34918, 256])
h_self size  torch.Size([34918, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10788440704345703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34918, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14118480682373047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10788440704345703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34918, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14118480682373047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14950990676879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34918
----------------output nodes number: 3162
----------------edges number: 77377
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1497941017150879  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1497941017150879  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1534104347229004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1534104347229004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15396451950073242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15396451950073242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15451860427856445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15396451950073242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15396928787231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1545238494873047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06316089630126953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 59 input nodes size: 157624
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05439043045043945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05439043045043945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11311006546020508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11313247680664062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059857845306396484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06261968612670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06261968612670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 157624
first layer output nodes number: 31703
edges number: 308254
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06403064727783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([157624, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06403064727783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06403064727783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07825660705566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07825660705566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1084909439086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31703, 256])
h_self size  torch.Size([31703, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1084909439086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31703, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13872528076171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1084909439086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31703, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13872528076171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1462841033935547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31703
----------------output nodes number: 2983
----------------edges number: 62289
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14654302597045898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14654302597045898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14987516403198242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14987516403198242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15039777755737305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2983, 47])
h_self size  torch.Size([2983, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15039777755737305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15092039108276367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15039777755737305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2983, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15036630630493164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15088939666748047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06773233413696289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 60 input nodes size: 186524
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05982637405395508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05982637405395508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12931203842163086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1293344497680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07059240341186523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07382917404174805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07382917404174805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 186524
first layer output nodes number: 36583
edges number: 362124
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07613611221313477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([186524, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07613611221313477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07613611221313477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09259986877441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09259986877441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12775611877441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36583, 256])
h_self size  torch.Size([36583, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12775611877441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36583, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1626443862915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1274881362915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36583, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1626443862915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17136669158935547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36583
----------------output nodes number: 3001
----------------edges number: 72180
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1716618537902832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1716618537902832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17542648315429688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17542648315429688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17595195770263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3001, 47])
h_self size  torch.Size([3001, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17595195770263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3001, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17647743225097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17595195770263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3001, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17595481872558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.17648077011108398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08049297332763672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 61 input nodes size: 131525
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07059526443481445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07059526443481445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11959218978881836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1196146011352539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05010652542114258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0527338981628418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0527338981628418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 131525
first layer output nodes number: 28350
edges number: 280379
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.053925514221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([131525, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.053925514221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.053925514221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06679487228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06679487228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28350, 256])
h_self size  torch.Size([28350, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28350, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12148237228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28350, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12148237228393555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12824153900146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28350
----------------output nodes number: 2985
----------------edges number: 72126
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12847518920898438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12847518920898438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1318826675415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1318826675415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13240575790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2985, 47])
h_self size  torch.Size([2985, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13240575790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13292884826660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13240575790405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13240337371826172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13292694091796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.057657718658447266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 62 input nodes size: 118075
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05010414123535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05010414123535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09502601623535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09504938125610352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04603004455566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04873847961425781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04873847961425781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 118075
first layer output nodes number: 29617
edges number: 291689
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049839019775390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([118075, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049839019775390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.049839019775390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0631566047668457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0631566047668457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09140157699584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29617, 256])
h_self size  torch.Size([29617, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09140157699584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29617, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11964654922485352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09140157699584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29617, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11964654922485352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1267080307006836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29617
----------------output nodes number: 3111
----------------edges number: 71733
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1269521713256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1269521713256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13051605224609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13051605224609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13106107711791992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3111, 47])
h_self size  torch.Size([3111, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13106107711791992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3111, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1316061019897461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13106107711791992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3111, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13108301162719727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13162851333618164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05358171463012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 63 input nodes size: 109232
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046051979064941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046051979064941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08674430847167969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08676719665527344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.041821956634521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04399824142456055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04399824142456055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 109232
first layer output nodes number: 23682
edges number: 231724
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04498910903930664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([109232, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04498910903930664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04498910903930664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05562734603881836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05562734603881836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07821226119995117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([23682, 256])
h_self size  torch.Size([23682, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07821226119995117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23682, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10079717636108398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07821226119995117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23682, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10079717636108398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1069798469543457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 23682
----------------output nodes number: 3029
----------------edges number: 60285
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10717964172363281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10717964172363281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11054039001464844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11054039001464844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11107110977172852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3029, 47])
h_self size  torch.Size([3029, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11107110977172852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3029, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1116018295288086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11107110977172852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3029, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11105680465698242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1115880012512207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0479888916015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.048549652099609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.048549652099609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02275640144944191 |0.009657084941864014 |0.024037636816501617 |0.00014449283480644226 |0.002723056823015213 |0.0013244152069091797 |
----------------------------------------------------------pseudo_mini_loss sum 6.2551188468933105
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9937513
Number of first layer input nodes during this epoch:  7869789
Number of first layer output nodes during this epoch:  2067724
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04854917526245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2877061367034912
global_2_local spend time (sec) 0.4111943244934082

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.088 seconds
Metis partitioning: 15.001 seconds
Split the graph: 0.737 seconds
Construct subgraphs: 0.405 seconds
2981
3131
3025
2981
3124
3102
2981
2981
3153
3142
3069
2981
2988
3161
3161
3141
2981
2981
3028
3147
3093
2981
3040
3162
3100
3071
3162
3124
3087
3033
3040
3162
3018
2981
3028
3142
2981
3071
3128
3141
2998
3161
2992
3162
3056
2981
3075
3113
3079
3048
3138
2981
3092
2981
3162
3034
3076
3154
3053
2981
3158
3162
3108
3042
REG metis partition end ----................................
the time spent:  28.371304750442505
total k batches seeds list generation spend  28.928650617599487
after graph partition
graph partition algorithm spend time 29.39577054977417

partition_len_list
[24489, 30208, 28646, 32441, 27608, 24976, 32528, 29640, 37663, 35592, 32921, 34721, 26912, 31451, 37190, 26273, 30522, 27673, 27117, 28676, 26058, 35342, 28709, 29385, 36168, 29266, 38871, 35467, 31421, 28900, 34048, 31058, 29210, 35613, 24196, 28792, 25428, 33939, 34996, 31195, 27591, 39109, 32308, 42435, 32726, 41375, 43804, 42396, 37577, 36676, 35452, 31467, 36628, 30016, 33862, 30906, 34327, 32229, 29025, 37949, 38539, 30902, 35087, 33610]
REG selection method  spend 30.040317058563232
check_connections_block*********************************
time for parepare 1: 0.24142074584960938
local_output_nid generation: 0.0012798309326171875
local_in_edges_tensor generation: 0.002214670181274414
mini_batch_src_global generation: 0.0034656524658203125

&&&&&&&&&&&&&&& before remove duplicate length: 70066
r_  generation: 0.023784160614013672

local_output_nid generation: 0.0013170242309570312
local_in_edges_tensor generation: 0.001569986343383789
mini_batch_src_global generation: 0.00323486328125

&&&&&&&&&&&&&&& before remove duplicate length: 73780
r_  generation: 0.025159358978271484

local_output_nid generation: 0.001344919204711914
local_in_edges_tensor generation: 0.0014462471008300781
mini_batch_src_global generation: 0.0024566650390625

&&&&&&&&&&&&&&& before remove duplicate length: 71205
r_  generation: 0.023014068603515625

local_output_nid generation: 0.0013353824615478516
local_in_edges_tensor generation: 0.001428842544555664
mini_batch_src_global generation: 0.002007722854614258

&&&&&&&&&&&&&&& before remove duplicate length: 71790
r_  generation: 0.023134469985961914

local_output_nid generation: 0.0014107227325439453
local_in_edges_tensor generation: 0.0014951229095458984
mini_batch_src_global generation: 0.0022428035736083984

&&&&&&&&&&&&&&& before remove duplicate length: 76082
r_  generation: 0.02485823631286621

local_output_nid generation: 0.0014204978942871094
local_in_edges_tensor generation: 0.00142669677734375
mini_batch_src_global generation: 0.0021071434020996094

&&&&&&&&&&&&&&& before remove duplicate length: 76790
r_  generation: 0.025202035903930664

local_output_nid generation: 0.0013837814331054688
local_in_edges_tensor generation: 0.0013897418975830078
mini_batch_src_global generation: 0.0020971298217773438

&&&&&&&&&&&&&&& before remove duplicate length: 71701
r_  generation: 0.023778915405273438

local_output_nid generation: 0.0013942718505859375
local_in_edges_tensor generation: 0.0014040470123291016
mini_batch_src_global generation: 0.002028942108154297

&&&&&&&&&&&&&&& before remove duplicate length: 68227
r_  generation: 0.022737979888916016

local_output_nid generation: 0.0014748573303222656
local_in_edges_tensor generation: 0.0014390945434570312
mini_batch_src_global generation: 0.002153158187866211

&&&&&&&&&&&&&&& before remove duplicate length: 78307
r_  generation: 0.026543378829956055

local_output_nid generation: 0.0014526844024658203
local_in_edges_tensor generation: 0.0014374256134033203
mini_batch_src_global generation: 0.002466917037963867

&&&&&&&&&&&&&&& before remove duplicate length: 78445
r_  generation: 0.02639937400817871

local_output_nid generation: 0.0014104843139648438
local_in_edges_tensor generation: 0.0014171600341796875
mini_batch_src_global generation: 0.0022470951080322266

&&&&&&&&&&&&&&& before remove duplicate length: 75105
r_  generation: 0.025826454162597656

local_output_nid generation: 0.0013926029205322266
local_in_edges_tensor generation: 0.0013799667358398438
mini_batch_src_global generation: 0.0022430419921875

&&&&&&&&&&&&&&& before remove duplicate length: 74411
r_  generation: 0.0254974365234375

local_output_nid generation: 0.0014102458953857422
local_in_edges_tensor generation: 0.0013742446899414062
mini_batch_src_global generation: 0.0022690296173095703

&&&&&&&&&&&&&&& before remove duplicate length: 74550
r_  generation: 0.02505040168762207

local_output_nid generation: 0.0014638900756835938
local_in_edges_tensor generation: 0.0014312267303466797
mini_batch_src_global generation: 0.002274751663208008

&&&&&&&&&&&&&&& before remove duplicate length: 78227
r_  generation: 0.027306318283081055

local_output_nid generation: 0.0014979839324951172
local_in_edges_tensor generation: 0.001730203628540039
mini_batch_src_global generation: 0.0024340152740478516

&&&&&&&&&&&&&&& before remove duplicate length: 78278
r_  generation: 0.027087926864624023

local_output_nid generation: 0.0014927387237548828
local_in_edges_tensor generation: 0.0014996528625488281
mini_batch_src_global generation: 0.00238037109375

&&&&&&&&&&&&&&& before remove duplicate length: 74699
r_  generation: 0.025196552276611328

local_output_nid generation: 0.0013854503631591797
local_in_edges_tensor generation: 0.0013506412506103516
mini_batch_src_global generation: 0.0021865367889404297

&&&&&&&&&&&&&&& before remove duplicate length: 72378
r_  generation: 0.04260730743408203

local_output_nid generation: 0.0019497871398925781
local_in_edges_tensor generation: 0.0017082691192626953
mini_batch_src_global generation: 0.0032629966735839844

&&&&&&&&&&&&&&& before remove duplicate length: 71630
r_  generation: 0.024599790573120117

local_output_nid generation: 0.0014264583587646484
local_in_edges_tensor generation: 0.0014388561248779297
mini_batch_src_global generation: 0.002146482467651367

&&&&&&&&&&&&&&& before remove duplicate length: 71737
r_  generation: 0.02402973175048828

local_output_nid generation: 0.0014753341674804688
local_in_edges_tensor generation: 0.0037505626678466797
mini_batch_src_global generation: 0.0022432804107666016

&&&&&&&&&&&&&&& before remove duplicate length: 76587
r_  generation: 0.026085615158081055

local_output_nid generation: 0.0014505386352539062
local_in_edges_tensor generation: 0.0030715465545654297
mini_batch_src_global generation: 0.002279520034790039

&&&&&&&&&&&&&&& before remove duplicate length: 76043
r_  generation: 0.02545952796936035

local_output_nid generation: 0.0014426708221435547
local_in_edges_tensor generation: 0.0024640560150146484
mini_batch_src_global generation: 0.002240419387817383

&&&&&&&&&&&&&&& before remove duplicate length: 72743
r_  generation: 0.024461984634399414

local_output_nid generation: 0.001447439193725586
local_in_edges_tensor generation: 0.002224445343017578
mini_batch_src_global generation: 0.0022149085998535156

&&&&&&&&&&&&&&& before remove duplicate length: 74428
r_  generation: 0.02533745765686035

local_output_nid generation: 0.0014786720275878906
local_in_edges_tensor generation: 0.002034425735473633
mini_batch_src_global generation: 0.0022764205932617188

&&&&&&&&&&&&&&& before remove duplicate length: 77603
r_  generation: 0.025571346282958984

local_output_nid generation: 0.001462697982788086
local_in_edges_tensor generation: 0.0018227100372314453
mini_batch_src_global generation: 0.0022521018981933594

&&&&&&&&&&&&&&& before remove duplicate length: 74776
r_  generation: 0.02600860595703125

local_output_nid generation: 0.001428365707397461
local_in_edges_tensor generation: 0.0016510486602783203
mini_batch_src_global generation: 0.002313852310180664

&&&&&&&&&&&&&&& before remove duplicate length: 74788
r_  generation: 0.025299549102783203

local_output_nid generation: 0.0014770030975341797
local_in_edges_tensor generation: 0.0016448497772216797
mini_batch_src_global generation: 0.0023157596588134766

&&&&&&&&&&&&&&& before remove duplicate length: 75559
r_  generation: 0.025706768035888672

local_output_nid generation: 0.001476287841796875
local_in_edges_tensor generation: 0.0017545223236083984
mini_batch_src_global generation: 0.002421855926513672

&&&&&&&&&&&&&&& before remove duplicate length: 75757
r_  generation: 0.02687382698059082

local_output_nid generation: 0.0014595985412597656
local_in_edges_tensor generation: 0.0014767646789550781
mini_batch_src_global generation: 0.0022928714752197266

&&&&&&&&&&&&&&& before remove duplicate length: 75291
r_  generation: 0.025588512420654297

local_output_nid generation: 0.0014240741729736328
local_in_edges_tensor generation: 0.0014297962188720703
mini_batch_src_global generation: 0.0022459030151367188

&&&&&&&&&&&&&&& before remove duplicate length: 72381
r_  generation: 0.024522066116333008

local_output_nid generation: 0.00144195556640625
local_in_edges_tensor generation: 0.0014185905456542969
mini_batch_src_global generation: 0.0022182464599609375

&&&&&&&&&&&&&&& before remove duplicate length: 73258
r_  generation: 0.025014400482177734

local_output_nid generation: 0.0014615058898925781
local_in_edges_tensor generation: 0.0015339851379394531
mini_batch_src_global generation: 0.0023267269134521484

&&&&&&&&&&&&&&& before remove duplicate length: 76257
r_  generation: 0.025995731353759766

local_output_nid generation: 0.0014126300811767578
local_in_edges_tensor generation: 0.0013606548309326172
mini_batch_src_global generation: 0.002179861068725586

&&&&&&&&&&&&&&& before remove duplicate length: 70455
r_  generation: 0.023782014846801758

local_output_nid generation: 0.001382589340209961
local_in_edges_tensor generation: 0.0013384819030761719
mini_batch_src_global generation: 0.0021562576293945312

&&&&&&&&&&&&&&& before remove duplicate length: 71365
r_  generation: 0.024240732192993164

local_output_nid generation: 0.001428842544555664
local_in_edges_tensor generation: 0.0013391971588134766
mini_batch_src_global generation: 0.0020990371704101562

&&&&&&&&&&&&&&& before remove duplicate length: 71296
r_  generation: 0.023745059967041016

local_output_nid generation: 0.0014567375183105469
local_in_edges_tensor generation: 0.0015857219696044922
mini_batch_src_global generation: 0.0021910667419433594

&&&&&&&&&&&&&&& before remove duplicate length: 75264
r_  generation: 0.03563499450683594

local_output_nid generation: 0.002012968063354492
local_in_edges_tensor generation: 0.0024695396423339844
mini_batch_src_global generation: 0.007524251937866211

&&&&&&&&&&&&&&& before remove duplicate length: 74131
r_  generation: 0.026861190795898438

local_output_nid generation: 0.0014715194702148438
local_in_edges_tensor generation: 0.0013937950134277344
mini_batch_src_global generation: 0.0022585391998291016

&&&&&&&&&&&&&&& before remove duplicate length: 75921
r_  generation: 0.03345918655395508

local_output_nid generation: 0.0023560523986816406
local_in_edges_tensor generation: 0.002306699752807617
mini_batch_src_global generation: 0.007589578628540039

&&&&&&&&&&&&&&& before remove duplicate length: 78120
r_  generation: 0.029952287673950195

local_output_nid generation: 0.0016412734985351562
local_in_edges_tensor generation: 0.001436471939086914
mini_batch_src_global generation: 0.0023789405822753906

&&&&&&&&&&&&&&& before remove duplicate length: 77441
r_  generation: 0.026111364364624023

local_output_nid generation: 0.0015418529510498047
local_in_edges_tensor generation: 0.0013580322265625
mini_batch_src_global generation: 0.0023086071014404297

&&&&&&&&&&&&&&& before remove duplicate length: 72602
r_  generation: 0.023488521575927734

local_output_nid generation: 0.0015823841094970703
local_in_edges_tensor generation: 0.0014390945434570312
mini_batch_src_global generation: 0.002292156219482422

&&&&&&&&&&&&&&& before remove duplicate length: 78824
r_  generation: 0.026868581771850586

local_output_nid generation: 0.0015323162078857422
local_in_edges_tensor generation: 0.0013561248779296875
mini_batch_src_global generation: 0.002447366714477539

&&&&&&&&&&&&&&& before remove duplicate length: 74140
r_  generation: 0.02576303482055664

local_output_nid generation: 0.0015482902526855469
local_in_edges_tensor generation: 0.001405477523803711
mini_batch_src_global generation: 0.0023279190063476562

&&&&&&&&&&&&&&& before remove duplicate length: 78490
r_  generation: 0.02720189094543457

local_output_nid generation: 0.0015096664428710938
local_in_edges_tensor generation: 0.0013968944549560547
mini_batch_src_global generation: 0.002402782440185547

&&&&&&&&&&&&&&& before remove duplicate length: 75818
r_  generation: 0.026555299758911133

local_output_nid generation: 0.0014743804931640625
local_in_edges_tensor generation: 0.0013713836669921875
mini_batch_src_global generation: 0.0023076534271240234

&&&&&&&&&&&&&&& before remove duplicate length: 74147
r_  generation: 0.02545022964477539

local_output_nid generation: 0.0015053749084472656
local_in_edges_tensor generation: 0.0013849735260009766
mini_batch_src_global generation: 0.0023543834686279297

&&&&&&&&&&&&&&& before remove duplicate length: 76608
r_  generation: 0.02713632583618164

local_output_nid generation: 0.0015263557434082031
local_in_edges_tensor generation: 0.0014276504516601562
mini_batch_src_global generation: 0.0023698806762695312

&&&&&&&&&&&&&&& before remove duplicate length: 77524
r_  generation: 0.027204513549804688

local_output_nid generation: 0.0015134811401367188
local_in_edges_tensor generation: 0.0014090538024902344
mini_batch_src_global generation: 0.0024285316467285156

&&&&&&&&&&&&&&& before remove duplicate length: 76549
r_  generation: 0.026738405227661133

local_output_nid generation: 0.0014810562133789062
local_in_edges_tensor generation: 0.0013751983642578125
mini_batch_src_global generation: 0.002288341522216797

&&&&&&&&&&&&&&& before remove duplicate length: 73078
r_  generation: 0.024670124053955078

local_output_nid generation: 0.0015192031860351562
local_in_edges_tensor generation: 0.0014178752899169922
mini_batch_src_global generation: 0.002324819564819336

&&&&&&&&&&&&&&& before remove duplicate length: 78192
r_  generation: 0.027082443237304688

local_output_nid generation: 0.0014259815216064453
local_in_edges_tensor generation: 0.0012996196746826172
mini_batch_src_global generation: 0.002156972885131836

&&&&&&&&&&&&&&& before remove duplicate length: 66085
r_  generation: 0.022159337997436523

local_output_nid generation: 0.0014846324920654297
local_in_edges_tensor generation: 0.0013670921325683594
mini_batch_src_global generation: 0.002168893814086914

&&&&&&&&&&&&&&& before remove duplicate length: 76279
r_  generation: 0.02740645408630371

local_output_nid generation: 0.0014367103576660156
local_in_edges_tensor generation: 0.00122833251953125
mini_batch_src_global generation: 0.001985788345336914

&&&&&&&&&&&&&&& before remove duplicate length: 60034
r_  generation: 0.020730018615722656

local_output_nid generation: 0.0015115737915039062
local_in_edges_tensor generation: 0.0019240379333496094
mini_batch_src_global generation: 0.0021927356719970703

&&&&&&&&&&&&&&& before remove duplicate length: 76212
r_  generation: 0.025699138641357422

local_output_nid generation: 0.0014619827270507812
local_in_edges_tensor generation: 0.0012552738189697266
mini_batch_src_global generation: 0.002048015594482422

&&&&&&&&&&&&&&& before remove duplicate length: 61925
r_  generation: 0.021353721618652344

local_output_nid generation: 0.0014832019805908203
local_in_edges_tensor generation: 0.0015718936920166016
mini_batch_src_global generation: 0.002223968505859375

&&&&&&&&&&&&&&& before remove duplicate length: 76472
r_  generation: 0.0344090461730957

local_output_nid generation: 0.00223541259765625
local_in_edges_tensor generation: 0.0020079612731933594
mini_batch_src_global generation: 0.007787466049194336

&&&&&&&&&&&&&&& before remove duplicate length: 78344
r_  generation: 0.02812361717224121

local_output_nid generation: 0.0015025138854980469
local_in_edges_tensor generation: 0.0013790130615234375
mini_batch_src_global generation: 0.0023453235626220703

&&&&&&&&&&&&&&& before remove duplicate length: 74962
r_  generation: 0.026731491088867188

local_output_nid generation: 0.0014514923095703125
local_in_edges_tensor generation: 0.0013277530670166016
mini_batch_src_global generation: 0.002178192138671875

&&&&&&&&&&&&&&& before remove duplicate length: 71977
r_  generation: 0.02422356605529785

local_output_nid generation: 0.0015175342559814453
local_in_edges_tensor generation: 0.0013768672943115234
mini_batch_src_global generation: 0.002309083938598633

&&&&&&&&&&&&&&& before remove duplicate length: 78694
r_  generation: 0.027344703674316406

local_output_nid generation: 0.0015194416046142578
local_in_edges_tensor generation: 0.0020830631256103516
mini_batch_src_global generation: 0.0024690628051757812

&&&&&&&&&&&&&&& before remove duplicate length: 78677
r_  generation: 0.026917219161987305

local_output_nid generation: 0.0015032291412353516
local_in_edges_tensor generation: 0.0017197132110595703
mini_batch_src_global generation: 0.0024106502532958984

&&&&&&&&&&&&&&& before remove duplicate length: 76717
r_  generation: 0.026897907257080078

local_output_nid generation: 0.0014595985412597656
local_in_edges_tensor generation: 0.001458883285522461
mini_batch_src_global generation: 0.002343416213989258

&&&&&&&&&&&&&&& before remove duplicate length: 74657
r_  generation: 0.03301429748535156


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6997056007385254
gen group dst list time:  0.0712735652923584
check_connections_block*********************************
time for parepare 1: 0.3751964569091797
local_output_nid generation: 0.0073680877685546875
local_in_edges_tensor generation: 0.07237815856933594
mini_batch_src_global generation: 0.0071909427642822266

&&&&&&&&&&&&&&& before remove duplicate length: 237714
r_  generation: 0.08082914352416992

local_output_nid generation: 0.009859800338745117
local_in_edges_tensor generation: 0.008269786834716797
mini_batch_src_global generation: 0.011167287826538086

&&&&&&&&&&&&&&& before remove duplicate length: 294207
r_  generation: 0.10542631149291992

local_output_nid generation: 0.009799003601074219
local_in_edges_tensor generation: 0.010404825210571289
mini_batch_src_global generation: 0.011339426040649414

&&&&&&&&&&&&&&& before remove duplicate length: 278840
r_  generation: 0.1068732738494873

local_output_nid generation: 0.010646581649780273
local_in_edges_tensor generation: 0.01109623908996582
mini_batch_src_global generation: 0.012204647064208984

&&&&&&&&&&&&&&& before remove duplicate length: 318591
r_  generation: 0.12792038917541504

local_output_nid generation: 0.009284496307373047
local_in_edges_tensor generation: 0.009716033935546875
mini_batch_src_global generation: 0.011570215225219727

&&&&&&&&&&&&&&& before remove duplicate length: 269974
r_  generation: 0.11044192314147949

local_output_nid generation: 0.008320808410644531
local_in_edges_tensor generation: 0.009341239929199219
mini_batch_src_global generation: 0.010477304458618164

&&&&&&&&&&&&&&& before remove duplicate length: 244896
r_  generation: 0.09500670433044434

local_output_nid generation: 0.01079416275024414
local_in_edges_tensor generation: 0.009931802749633789
mini_batch_src_global generation: 0.013208389282226562

&&&&&&&&&&&&&&& before remove duplicate length: 319566
r_  generation: 0.12870478630065918

local_output_nid generation: 0.009651660919189453
local_in_edges_tensor generation: 0.010053634643554688
mini_batch_src_global generation: 0.01303863525390625

&&&&&&&&&&&&&&& before remove duplicate length: 286604
r_  generation: 0.11936402320861816

local_output_nid generation: 0.01224827766418457
local_in_edges_tensor generation: 0.011248111724853516
mini_batch_src_global generation: 0.016317129135131836

&&&&&&&&&&&&&&& before remove duplicate length: 372685
r_  generation: 0.16422557830810547

local_output_nid generation: 0.011556148529052734
local_in_edges_tensor generation: 0.011086463928222656
mini_batch_src_global generation: 0.015938758850097656

&&&&&&&&&&&&&&& before remove duplicate length: 354014
r_  generation: 0.1522541046142578

local_output_nid generation: 0.011265993118286133
local_in_edges_tensor generation: 0.02941107749938965
mini_batch_src_global generation: 0.014992475509643555

&&&&&&&&&&&&&&& before remove duplicate length: 323840
r_  generation: 0.1394639015197754

local_output_nid generation: 0.01158595085144043
local_in_edges_tensor generation: 0.01715397834777832
mini_batch_src_global generation: 0.017039775848388672

&&&&&&&&&&&&&&& before remove duplicate length: 345526
r_  generation: 0.14928555488586426

local_output_nid generation: 0.008353710174560547
local_in_edges_tensor generation: 0.011025190353393555
mini_batch_src_global generation: 0.01285552978515625

&&&&&&&&&&&&&&& before remove duplicate length: 267578
r_  generation: 0.1046142578125

local_output_nid generation: 0.01008152961730957
local_in_edges_tensor generation: 0.01285696029663086
mini_batch_src_global generation: 0.013847112655639648

&&&&&&&&&&&&&&& before remove duplicate length: 311367
r_  generation: 0.13092470169067383

local_output_nid generation: 0.011950016021728516
local_in_edges_tensor generation: 0.015499591827392578
mini_batch_src_global generation: 0.01640629768371582

&&&&&&&&&&&&&&& before remove duplicate length: 369030
r_  generation: 0.1610090732574463

local_output_nid generation: 0.008020877838134766
local_in_edges_tensor generation: 0.012511253356933594
mini_batch_src_global generation: 0.01256251335144043

&&&&&&&&&&&&&&& before remove duplicate length: 253165
r_  generation: 0.10241889953613281

local_output_nid generation: 0.02325725555419922
local_in_edges_tensor generation: 0.025255918502807617
mini_batch_src_global generation: 0.016791105270385742

&&&&&&&&&&&&&&& before remove duplicate length: 294867
r_  generation: 0.12711381912231445

local_output_nid generation: 0.0178377628326416
local_in_edges_tensor generation: 0.014396429061889648
mini_batch_src_global generation: 0.013245105743408203

&&&&&&&&&&&&&&& before remove duplicate length: 267038
r_  generation: 0.11364960670471191

local_output_nid generation: 0.011404275894165039
local_in_edges_tensor generation: 0.014324665069580078
mini_batch_src_global generation: 0.011701345443725586

&&&&&&&&&&&&&&& before remove duplicate length: 261388
r_  generation: 0.11475658416748047

local_output_nid generation: 0.010310173034667969
local_in_edges_tensor generation: 0.009976625442504883
mini_batch_src_global generation: 0.012784242630004883

&&&&&&&&&&&&&&& before remove duplicate length: 279309
r_  generation: 0.11998128890991211

local_output_nid generation: 0.010057687759399414
local_in_edges_tensor generation: 0.011805057525634766
mini_batch_src_global generation: 0.011862993240356445

&&&&&&&&&&&&&&& before remove duplicate length: 255187
r_  generation: 0.11203289031982422

local_output_nid generation: 0.012572288513183594
local_in_edges_tensor generation: 0.013746500015258789
mini_batch_src_global generation: 0.016193151473999023

&&&&&&&&&&&&&&& before remove duplicate length: 345994
r_  generation: 0.15157723426818848

local_output_nid generation: 0.01037454605102539
local_in_edges_tensor generation: 0.009701967239379883
mini_batch_src_global generation: 0.013824939727783203

&&&&&&&&&&&&&&& before remove duplicate length: 279480
r_  generation: 0.12189388275146484

local_output_nid generation: 0.010455608367919922
local_in_edges_tensor generation: 0.01004934310913086
mini_batch_src_global generation: 0.01423954963684082

&&&&&&&&&&&&&&& before remove duplicate length: 286858
r_  generation: 0.12854361534118652

local_output_nid generation: 0.012536048889160156
local_in_edges_tensor generation: 0.011817216873168945
mini_batch_src_global generation: 0.01612401008605957

&&&&&&&&&&&&&&& before remove duplicate length: 352178
r_  generation: 0.15387177467346191

local_output_nid generation: 0.009734153747558594
local_in_edges_tensor generation: 0.008213996887207031
mini_batch_src_global generation: 0.014167308807373047

&&&&&&&&&&&&&&& before remove duplicate length: 286647
r_  generation: 0.1245875358581543

local_output_nid generation: 0.012945413589477539
local_in_edges_tensor generation: 0.01341557502746582
mini_batch_src_global generation: 0.016228199005126953

&&&&&&&&&&&&&&& before remove duplicate length: 374424
r_  generation: 0.16824769973754883

local_output_nid generation: 0.012151002883911133
local_in_edges_tensor generation: 0.011178255081176758
mini_batch_src_global generation: 0.017033100128173828

&&&&&&&&&&&&&&& before remove duplicate length: 343995
r_  generation: 0.15501022338867188

local_output_nid generation: 0.010310888290405273
local_in_edges_tensor generation: 0.00899958610534668
mini_batch_src_global generation: 0.024552583694458008

&&&&&&&&&&&&&&& before remove duplicate length: 306034
r_  generation: 0.13621091842651367

local_output_nid generation: 0.010092735290527344
local_in_edges_tensor generation: 0.008533239364624023
mini_batch_src_global generation: 0.01638340950012207

&&&&&&&&&&&&&&& before remove duplicate length: 276889
r_  generation: 0.12169075012207031

local_output_nid generation: 0.011684417724609375
local_in_edges_tensor generation: 0.01120448112487793
mini_batch_src_global generation: 0.015447616577148438

&&&&&&&&&&&&&&& before remove duplicate length: 329178
r_  generation: 0.1482377052307129

local_output_nid generation: 0.011008262634277344
local_in_edges_tensor generation: 0.009228706359863281
mini_batch_src_global generation: 0.016003131866455078

&&&&&&&&&&&&&&& before remove duplicate length: 300272
r_  generation: 0.1349027156829834

local_output_nid generation: 0.010385513305664062
local_in_edges_tensor generation: 0.009758949279785156
mini_batch_src_global generation: 0.014609336853027344

&&&&&&&&&&&&&&& before remove duplicate length: 284879
r_  generation: 0.12801909446716309

local_output_nid generation: 0.011913537979125977
local_in_edges_tensor generation: 0.010236501693725586
mini_batch_src_global generation: 0.01685023307800293

&&&&&&&&&&&&&&& before remove duplicate length: 348036
r_  generation: 0.15347838401794434

local_output_nid generation: 0.008260250091552734
local_in_edges_tensor generation: 0.0067255496978759766
mini_batch_src_global generation: 0.012225627899169922

&&&&&&&&&&&&&&& before remove duplicate length: 234574
r_  generation: 0.09763431549072266

local_output_nid generation: 0.009006261825561523
local_in_edges_tensor generation: 0.007042407989501953
mini_batch_src_global generation: 0.012216329574584961

&&&&&&&&&&&&&&& before remove duplicate length: 274710
r_  generation: 0.1075448989868164

local_output_nid generation: 0.008348464965820312
local_in_edges_tensor generation: 0.007107734680175781
mini_batch_src_global generation: 0.011977434158325195

&&&&&&&&&&&&&&& before remove duplicate length: 251308
r_  generation: 0.09958600997924805

local_output_nid generation: 0.010571479797363281
local_in_edges_tensor generation: 0.010083436965942383
mini_batch_src_global generation: 0.015124082565307617

&&&&&&&&&&&&&&& before remove duplicate length: 335324
r_  generation: 0.1410212516784668

local_output_nid generation: 0.011870622634887695
local_in_edges_tensor generation: 0.010302305221557617
mini_batch_src_global generation: 0.015906572341918945

&&&&&&&&&&&&&&& before remove duplicate length: 347851
r_  generation: 0.14693355560302734

local_output_nid generation: 0.010056018829345703
local_in_edges_tensor generation: 0.008425712585449219
mini_batch_src_global generation: 0.014355897903442383

&&&&&&&&&&&&&&& before remove duplicate length: 307373
r_  generation: 0.13156986236572266

local_output_nid generation: 0.009394407272338867
local_in_edges_tensor generation: 0.008785009384155273
mini_batch_src_global generation: 0.013163089752197266

&&&&&&&&&&&&&&& before remove duplicate length: 273075
r_  generation: 0.11984992027282715

local_output_nid generation: 0.01329350471496582
local_in_edges_tensor generation: 0.013486385345458984
mini_batch_src_global generation: 0.01743006706237793

&&&&&&&&&&&&&&& before remove duplicate length: 388305
r_  generation: 0.17239022254943848

local_output_nid generation: 0.011203289031982422
local_in_edges_tensor generation: 0.010996341705322266
mini_batch_src_global generation: 0.016747236251831055

&&&&&&&&&&&&&&& before remove duplicate length: 319386
r_  generation: 0.13741016387939453

local_output_nid generation: 0.014463424682617188
local_in_edges_tensor generation: 0.01256108283996582
mini_batch_src_global generation: 0.01835012435913086

&&&&&&&&&&&&&&& before remove duplicate length: 421745
r_  generation: 0.18939876556396484

local_output_nid generation: 0.011222362518310547
local_in_edges_tensor generation: 0.009132862091064453
mini_batch_src_global generation: 0.016541004180908203

&&&&&&&&&&&&&&& before remove duplicate length: 324016
r_  generation: 0.14298677444458008

local_output_nid generation: 0.013972997665405273
local_in_edges_tensor generation: 0.014497041702270508
mini_batch_src_global generation: 0.017661094665527344

&&&&&&&&&&&&&&& before remove duplicate length: 410472
r_  generation: 0.20256924629211426

local_output_nid generation: 0.015462636947631836
local_in_edges_tensor generation: 0.01598644256591797
mini_batch_src_global generation: 0.022220611572265625

&&&&&&&&&&&&&&& before remove duplicate length: 434968
r_  generation: 0.22762823104858398

local_output_nid generation: 0.02251434326171875
local_in_edges_tensor generation: 0.032805681228637695
mini_batch_src_global generation: 0.019547462463378906

&&&&&&&&&&&&&&& before remove duplicate length: 421446
r_  generation: 0.20957326889038086

local_output_nid generation: 0.02067852020263672
local_in_edges_tensor generation: 0.016687870025634766
mini_batch_src_global generation: 0.019160985946655273

&&&&&&&&&&&&&&& before remove duplicate length: 373213
r_  generation: 0.17213177680969238

local_output_nid generation: 0.019030094146728516
local_in_edges_tensor generation: 0.025266408920288086
mini_batch_src_global generation: 0.018360614776611328

&&&&&&&&&&&&&&& before remove duplicate length: 362523
r_  generation: 0.19392108917236328

local_output_nid generation: 0.013963937759399414
local_in_edges_tensor generation: 0.011943340301513672
mini_batch_src_global generation: 0.018326997756958008

&&&&&&&&&&&&&&& before remove duplicate length: 352681
r_  generation: 0.16724038124084473

local_output_nid generation: 0.011436700820922852
local_in_edges_tensor generation: 0.010768651962280273
mini_batch_src_global generation: 0.01570606231689453

&&&&&&&&&&&&&&& before remove duplicate length: 309100
r_  generation: 0.14646458625793457

local_output_nid generation: 0.01285099983215332
local_in_edges_tensor generation: 0.011272907257080078
mini_batch_src_global generation: 0.01726365089416504

&&&&&&&&&&&&&&& before remove duplicate length: 360537
r_  generation: 0.17228412628173828

local_output_nid generation: 0.010304927825927734
local_in_edges_tensor generation: 0.008814096450805664
mini_batch_src_global generation: 0.015149831771850586

&&&&&&&&&&&&&&& before remove duplicate length: 295073
r_  generation: 0.13546538352966309

local_output_nid generation: 0.011690855026245117
local_in_edges_tensor generation: 0.010280847549438477
mini_batch_src_global generation: 0.016020536422729492

&&&&&&&&&&&&&&& before remove duplicate length: 334864
r_  generation: 0.15980005264282227

local_output_nid generation: 0.011017084121704102
local_in_edges_tensor generation: 0.01022958755493164
mini_batch_src_global generation: 0.015615224838256836

&&&&&&&&&&&&&&& before remove duplicate length: 298995
r_  generation: 0.14469099044799805

local_output_nid generation: 0.011598825454711914
local_in_edges_tensor generation: 0.011561155319213867
mini_batch_src_global generation: 0.01709461212158203

&&&&&&&&&&&&&&& before remove duplicate length: 340437
r_  generation: 0.15543651580810547

local_output_nid generation: 0.010854721069335938
local_in_edges_tensor generation: 0.008813619613647461
mini_batch_src_global generation: 0.015826940536499023

&&&&&&&&&&&&&&& before remove duplicate length: 319490
r_  generation: 0.15087080001831055

local_output_nid generation: 0.010513782501220703
local_in_edges_tensor generation: 0.00921320915222168
mini_batch_src_global generation: 0.015087127685546875

&&&&&&&&&&&&&&& before remove duplicate length: 286457
r_  generation: 0.12837481498718262

local_output_nid generation: 0.013501405715942383
local_in_edges_tensor generation: 0.011636018753051758
mini_batch_src_global generation: 0.017270803451538086

&&&&&&&&&&&&&&& before remove duplicate length: 375048
r_  generation: 0.20003366470336914

local_output_nid generation: 0.013277530670166016
local_in_edges_tensor generation: 0.013046026229858398
mini_batch_src_global generation: 0.019258975982666016

&&&&&&&&&&&&&&& before remove duplicate length: 383229
r_  generation: 0.17680716514587402

local_output_nid generation: 0.010339975357055664
local_in_edges_tensor generation: 0.008143901824951172
mini_batch_src_global generation: 0.015661954879760742

&&&&&&&&&&&&&&& before remove duplicate length: 306255
r_  generation: 0.1363534927368164

local_output_nid generation: 0.011816978454589844
local_in_edges_tensor generation: 0.009775161743164062
mini_batch_src_global generation: 0.016821622848510742

&&&&&&&&&&&&&&& before remove duplicate length: 345698
r_  generation: 0.15443992614746094

local_output_nid generation: 0.011914730072021484
local_in_edges_tensor generation: 0.01020359992980957
mini_batch_src_global generation: 0.01641845703125

&&&&&&&&&&&&&&& before remove duplicate length: 330201
r_  generation: 0.15093207359313965


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04854917526245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

connection checking time:  16.88722038269043
block generation total time  14.69724726676941
average batch blocks generation time:  0.22964448854327202
pseudo mini batch 0 input nodes size: 75214
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04236745834350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04236745834350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07038688659667969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07040929794311523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029694080352783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03198862075805664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03198862075805664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 75214
first layer output nodes number: 24489
edges number: 237714
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03273200988769531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([75214, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03273200988769531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03273200988769531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.043718814849853516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.043718814849853516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06707334518432617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([24489, 256])
h_self size  torch.Size([24489, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06707334518432617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24489, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09042787551879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06707334518432617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24489, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09042787551879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0962667465209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 24489
----------------output nodes number: 2981
----------------edges number: 70066
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09647178649902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09647178649902344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09986019134521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09986019134521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10038232803344727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10038232803344727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10090446472167969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10038232803344727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10037374496459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10089683532714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.035941123962402344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 1 input nodes size: 86317
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029686450958251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.029686450958251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06184244155883789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061865806579589844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03382396697998047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03737449645996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03737449645996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 86317
first layer output nodes number: 30208
edges number: 294207
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03824281692504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([86317, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03824281692504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03824281692504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05180168151855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05180168151855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08061027526855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30208, 256])
h_self size  torch.Size([30208, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08061027526855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30208, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10941886901855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08061027526855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30208, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10941886901855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11662101745605469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30208
----------------output nodes number: 3131
----------------edges number: 73780
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11686944961547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11686944961547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12042951583862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12042951583862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12097787857055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3131, 47])
h_self size  torch.Size([3131, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12097787857055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3131, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12152624130249023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12097787857055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3131, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12100410461425781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12155294418334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04204845428466797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 2 input nodes size: 95408
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03385019302368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03385019302368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06939268112182617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06941556930541992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03723621368408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03984546661376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03984546661376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 95408
first layer output nodes number: 28646
edges number: 278840
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04077005386352539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([95408, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04077005386352539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04077005386352539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05403757095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05403757095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138132095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28646, 256])
h_self size  torch.Size([28646, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138132095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28646, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10872507095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138132095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28646, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10872507095336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1155548095703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28646
----------------output nodes number: 3025
----------------edges number: 71205
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11579132080078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11579132080078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11923027038574219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11923027038574219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3025, 47])
h_self size  torch.Size([3025, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3025, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12028980255126953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3025, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11974143981933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12027168273925781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04476451873779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 3 input nodes size: 114764
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03721761703491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03721761703491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0799708366394043  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07999324798583984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04442787170410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047336578369140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.047336578369140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 114764
first layer output nodes number: 32441
edges number: 318591
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.048433780670166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([114764, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.048433780670166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.048433780670166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0633387565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0633387565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0945887565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32441, 256])
h_self size  torch.Size([32441, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0945887565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32441, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1258387565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0945887565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32441, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1258387565612793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1335735321044922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32441
----------------output nodes number: 2981
----------------edges number: 71790
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13383769989013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13383769989013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1372385025024414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1372385025024414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13776063919067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13776063919067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13828277587890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13776063919067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13775300979614258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1382756233215332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.052712440490722656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 4 input nodes size: 97566
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04442024230957031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04442024230957031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08076667785644531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08079004287719727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03801441192626953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04129791259765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04129791259765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 97566
first layer output nodes number: 27608
edges number: 269974
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042231082916259766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([97566, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042231082916259766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042231082916259766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055058956146240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055058956146240234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138799667358398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27608, 256])
h_self size  torch.Size([27608, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138799667358398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27608, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10771703720092773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08138799667358398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27608, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10771703720092773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11429929733276367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27608
----------------output nodes number: 3124
----------------edges number: 76082
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11452865600585938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11452865600585938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11809921264648438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11809921264648438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3124, 47])
h_self size  torch.Size([3124, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3124, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11919403076171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3124, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11867189407348633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11921977996826172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04627847671508789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 5 input nodes size: 83989
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0380396842956543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0380396842956543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06932830810546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0693516731262207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03298187255859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03537940979003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03537940979003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 83989
first layer output nodes number: 24976
edges number: 244896
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03619194030761719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([83989, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03619194030761719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03619194030761719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04741525650024414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04741525650024414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07123422622680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([24976, 256])
h_self size  torch.Size([24976, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07123422622680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24976, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09505319595336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07123422622680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24976, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09505319595336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10100793838500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 24976
----------------output nodes number: 3102
----------------edges number: 76790
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10121774673461914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10121774673461914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10533857345581055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10533857345581055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10588216781616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3102, 47])
h_self size  torch.Size([3102, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10588216781616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3102, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10642576217651367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10588216781616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3102, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10587835311889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10642242431640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0395665168762207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 6 input nodes size: 132620
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032978057861328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.032978057861328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0823831558227539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08240556716918945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05109357833862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05400991439819336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05400991439819336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 132620
first layer output nodes number: 32528
edges number: 319566
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05524110794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([132620, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05524110794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05524110794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07058382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07058382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10183382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32528, 256])
h_self size  torch.Size([32528, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10183382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32528, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13308382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10183382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32528, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13308382034301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1408390998840332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32528
----------------output nodes number: 2981
----------------edges number: 71701
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14110422134399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14110422134399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14450502395629883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14450502395629883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14502716064453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14502716064453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14554929733276367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14502716064453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1450057029724121  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14552831649780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.059912681579589844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 7 input nodes size: 106111
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.051072120666503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.051072120666503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09060192108154297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09062433242797852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.043842315673828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.043842315673828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 106111
first layer output nodes number: 29640
edges number: 286604
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.044854164123535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([106111, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.044854164123535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.044854164123535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05814313888549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05814313888549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0864100456237793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29640, 256])
h_self size  torch.Size([29640, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0864100456237793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29640, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11467695236206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0864100456237793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29640, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11467695236206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12174367904663086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29640
----------------output nodes number: 2981
----------------edges number: 68227
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12198734283447266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12198734283447266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1255025863647461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1255025863647461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12602472305297852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12602472305297852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12654685974121094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12602472305297852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12602472305297852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12654733657836914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04848527908325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 8 input nodes size: 147292
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04119682312011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09606742858886719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09609127044677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.056539058685302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05989980697631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05989980697631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 147292
first layer output nodes number: 37663
edges number: 372685
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061278343200683594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([147292, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061278343200683594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061278343200683594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07863998413085938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07863998413085938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11455821990966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([37663, 256])
h_self size  torch.Size([37663, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11455821990966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37663, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15047645568847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11455821990966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37663, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15047645568847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15948009490966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 37663
----------------output nodes number: 3153
----------------edges number: 78307
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15978479385375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15978479385375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16339921951293945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16339921951293945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16395139694213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3153, 47])
h_self size  torch.Size([3153, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16395139694213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3153, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1645035743713379  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16395139694213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3153, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16398143768310547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1645340919494629  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06626367568969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 9 input nodes size: 131177
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05656909942626953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05656909942626953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10543680191040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10546064376831055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05056619644165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05378866195678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05378866195678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 131177
first layer output nodes number: 35592
edges number: 354014
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055031776428222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([131177, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055031776428222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.055031776428222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07194757461547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07194757461547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10589075088500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35592, 256])
h_self size  torch.Size([35592, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10589075088500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35592, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13983392715454102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10589075088500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35592, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13983392715454102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14831972122192383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35592
----------------output nodes number: 3142
----------------edges number: 78445
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14860916137695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14860916137695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15221405029296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15221405029296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15276432037353516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3142, 47])
h_self size  torch.Size([3142, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15276432037353516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3142, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15331459045410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15276432037353516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3142, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15276241302490234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15331315994262695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.060289859771728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 10 input nodes size: 117126
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05056428909301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05056428909301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09419727325439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09422016143798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.045328617095947266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04838371276855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04838371276855469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 117126
first layer output nodes number: 32921
edges number: 323840
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04950237274169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([117126, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04950237274169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04950237274169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0643310546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0643310546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09572696685791016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32921, 256])
h_self size  torch.Size([32921, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09572696685791016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32921, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1271228790283203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09572696685791016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32921, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1271228790283203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13497209548950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32921
----------------output nodes number: 3069
----------------edges number: 75105
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1352405548095703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1352405548095703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1387500762939453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1387500762939453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13928747177124023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3069, 47])
h_self size  torch.Size([3069, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13928747177124023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3069, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13982486724853516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13928747177124023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3069, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13927459716796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13981246948242188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05357646942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 11 input nodes size: 120405
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04531574249267578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04531574249267578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09017038345336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09019279479980469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046536922454833984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0503997802734375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0503997802734375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 120405
first layer output nodes number: 34721
edges number: 345526
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05155611038208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([120405, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05155611038208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05155611038208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06719541549682617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06719541549682617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10030794143676758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34721, 256])
h_self size  torch.Size([34721, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10030794143676758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34721, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13342046737670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10030794143676758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34721, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13342046737670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14169883728027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34721
----------------output nodes number: 2981
----------------edges number: 74411
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14198017120361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14198017120361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1454010009765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1454010009765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14644527435302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14592313766479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14590787887573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14643049240112305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05577802658081055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 12 input nodes size: 78256
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046521663665771484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046521663665771484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07567453384399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07569694519042969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03081989288330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03347301483154297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03347301483154297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 78256
first layer output nodes number: 26912
edges number: 267578
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034256935119628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([78256, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034256935119628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034256935119628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0470733642578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0470733642578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0727386474609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([26912, 256])
h_self size  torch.Size([26912, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0727386474609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26912, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0984039306640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0727386474609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26912, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0984039306640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10482025146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 26912
----------------output nodes number: 2988
----------------edges number: 74550
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10504341125488281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10504341125488281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10847187042236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10847187042236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10899543762207031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2988, 47])
h_self size  torch.Size([2988, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10899543762207031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2988, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10951900482177734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10899543762207031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2988, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10899686813354492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10952091217041016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03849649429321289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 13 input nodes size: 109551
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03082132339477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03082132339477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07163238525390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0716562271118164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0424809455871582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.045384883880615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.045384883880615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 109551
first layer output nodes number: 31451
edges number: 311367
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04643583297729492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([109551, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04643583297729492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04643583297729492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061220645904541016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.061220645904541016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09121465682983398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31451, 256])
h_self size  torch.Size([31451, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09121465682983398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31451, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12120866775512695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09121465682983398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31451, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12120866775512695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1287074089050293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31451
----------------output nodes number: 3161
----------------edges number: 78227
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1289658546447754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1289658546447754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13258790969848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13258790969848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13369512557983398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13314151763916016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13317155838012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13372564315795898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.051088809967041016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 14 input nodes size: 142610
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042510986328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042510986328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09563779830932617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09566164016723633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05482673645019531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05834627151489258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05834627151489258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 142610
first layer output nodes number: 37190
edges number: 369030
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05968666076660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([142610, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05968666076660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05968666076660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0764303207397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0764303207397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11189746856689453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([37190, 256])
h_self size  torch.Size([37190, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11189746856689453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37190, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14736461639404297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11189746856689453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37190, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.14736461639404297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1566452980041504  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 37190
----------------output nodes number: 3161
----------------edges number: 78278
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15694665908813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.15694665908813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1605687141418457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1605687141418457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16112232208251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16112232208251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16167593002319336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16112232208251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16112232208251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.16167640686035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.06419515609741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 15 input nodes size: 79096
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05482673645019531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05482673645019531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08429241180419922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08431625366210938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.031165599822998047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03360891342163086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03360891342163086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 79096
first layer output nodes number: 26273
edges number: 253165
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034394264221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([79096, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034394264221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.034394264221191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046166419982910156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046166419982910156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07122230529785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([26273, 256])
h_self size  torch.Size([26273, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07122230529785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26273, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09627819061279297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07122230529785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26273, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09627819061279297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10254240036010742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 26273
----------------output nodes number: 3141
----------------edges number: 74699
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10276222229003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10276222229003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1063385009765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1063385009765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1068887710571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3141, 47])
h_self size  torch.Size([3141, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1068887710571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3141, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10743904113769531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1068887710571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3141, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10688543319702148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1074361801147461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03781938552856445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 16 input nodes size: 118640
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.031162261962890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.031162261962890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07608413696289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07610654830932617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04661703109741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04935407638549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04935407638549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 118640
first layer output nodes number: 30522
edges number: 294867
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05046558380126953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([118640, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05046558380126953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05046558380126953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0641474723815918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0641474723815918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09325551986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30522, 256])
h_self size  torch.Size([30522, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09325551986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30522, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12236356735229492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.09325551986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30522, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12236356735229492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1296405792236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30522
----------------output nodes number: 2981
----------------edges number: 72378
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12989044189453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12989044189453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1335735321044922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1335735321044922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1340956687927246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1340956687927246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13461780548095703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1340956687927246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13406753540039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.13459014892578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05420351028442383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 17 input nodes size: 99528
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046588897705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.046588897705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08366632461547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08368873596191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038744449615478516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04126882553100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04126882553100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 99528
first layer output nodes number: 27673
edges number: 267038
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042217254638671875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([99528, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042217254638671875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.042217254638671875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05462026596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.05462026596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08196401596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27673, 256])
h_self size  torch.Size([27673, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08196401596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27673, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10930776596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.08196401596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27673, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10930776596069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11653947830200195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27673
----------------output nodes number: 2981
----------------edges number: 71630
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11676836013793945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11676836013793945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12016820907592773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12016820907592773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12069034576416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12069034576416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12121248245239258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12069034576416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12069034576416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.12121295928955078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04572296142578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 18 input nodes size: 96027
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038744449615478516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.038744449615478516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07451772689819336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07454061508178711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03744077682495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03992414474487305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.03992414474487305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 96027
first layer output nodes number: 27117
edges number: 261388
----------------------------------------before model layer 0
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04084205627441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([96027, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04084205627441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.04084205627441406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0529937744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.0529937744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07885456085205078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27117, 256])
h_self size  torch.Size([27117, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07885456085205078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27117, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10471534729003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.07885456085205078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27117, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.10471534729003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11118078231811523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27117
----------------output nodes number: 3028
----------------edges number: 71737
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11140584945678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11140584945678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11525297164916992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11525297164916992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1157832145690918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3028, 47])
h_self size  torch.Size([3028, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1157832145690918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3028, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11631345748901367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.1157832145690918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3028, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11579132080078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 0.11632204055786133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04430723190307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 19 input nodes size: 92124
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037448883056640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037448883056640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07260513305664062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07262897491455078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03683280944824219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039485931396484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039485931396484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 92124
first layer output nodes number: 28676
edges number: 279309
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04038667678833008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([92124, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04038667678833008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04038667678833008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053780555725097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053780555725097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112812042236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28676, 256])
h_self size  torch.Size([28676, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112812042236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28676, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1084756851196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112812042236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28676, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1084756851196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11531257629394531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28676
----------------output nodes number: 3147
----------------edges number: 76587
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11555051803588867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11555051803588867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12004804611206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12004804611206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12059926986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3147, 47])
h_self size  torch.Size([3147, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12059926986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3147, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12115049362182617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12059926986694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3147, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1206202507019043  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12117195129394531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04461812973022461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 20 input nodes size: 105785
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.036853790283203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.036853790283203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07626199722290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07628536224365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04110527038574219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04357433319091797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04357433319091797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 105785
first layer output nodes number: 26058
edges number: 255187
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04455709457397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([105785, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04455709457397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04455709457397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05626344680786133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05626344680786133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111429214477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([26058, 256])
h_self size  torch.Size([26058, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111429214477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26058, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10596513748168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111429214477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26058, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10596513748168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11217784881591797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 26058
----------------output nodes number: 3093
----------------edges number: 76043
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1123957633972168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1123957633972168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1159367561340332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1159367561340332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11647844314575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3093, 47])
h_self size  torch.Size([3093, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11647844314575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3093, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1170201301574707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11647844314575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3093, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11646890640258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11701107025146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04800844192504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 21 input nodes size: 149880
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041095733642578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041095733642578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09693050384521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09695291519165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05752134323120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06064271926879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06064271926879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 149880
first layer output nodes number: 35342
edges number: 345994
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.062023162841796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([149880, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.062023162841796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.062023162841796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07789993286132812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07789993286132812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11160469055175781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35342, 256])
h_self size  torch.Size([35342, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11160469055175781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35342, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1453094482421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11160469055175781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35342, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1453094482421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15373563766479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35342
----------------output nodes number: 2981
----------------edges number: 72743
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1540217399597168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1540217399597168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15837383270263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15837383270263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15889596939086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15889596939086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15941810607910156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15889596939086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1588764190673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15939903259277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06622934341430664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 22 input nodes size: 108295
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057501792907714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057501792907714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09784507751464844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09786796569824219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04201078414916992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04464864730834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04464864730834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 108295
first layer output nodes number: 28709
edges number: 279480
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0456700325012207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([108295, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0456700325012207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0456700325012207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05896806716918945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05896806716918945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08634710311889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28709, 256])
h_self size  torch.Size([28709, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08634710311889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11372613906860352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08634710311889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11372613906860352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12057113647460938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28709
----------------output nodes number: 3040
----------------edges number: 74428
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12080812454223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12080812454223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12525701522827148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12525701522827148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12578964233398438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3040, 47])
h_self size  torch.Size([3040, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12578964233398438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3040, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12632226943969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12578964233398438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3040, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12580013275146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12633323669433594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04974937438964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 23 input nodes size: 107948
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04202127456665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04202127456665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08223533630371094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0822591781616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04189300537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044610023498535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044610023498535156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 107948
first layer output nodes number: 29385
edges number: 286858
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([107948, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045633792877197266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05882883071899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05882883071899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0868525505065918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29385, 256])
h_self size  torch.Size([29385, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0868525505065918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29385, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11487627029418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0868525505065918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29385, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11487627029418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12188243865966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29385
----------------output nodes number: 3162
----------------edges number: 77603
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12212562561035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12212562561035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12595462799072266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12595462799072266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1265087127685547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1265087127685547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12706279754638672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1265087127685547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12653017044067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12708473205566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049425601959228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 24 input nodes size: 141217
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04191446304321289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04191446304321289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09452199935913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09454536437988281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05430746078491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0582575798034668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0582575798034668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 141217
first layer output nodes number: 36168
edges number: 352178
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05957984924316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([141217, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05957984924316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05957984924316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07581329345703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07581329345703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11096954345703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36168, 256])
h_self size  torch.Size([36168, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11096954345703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36168, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1454620361328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1103057861328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36168, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1454620361328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1548161506652832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36168
----------------output nodes number: 3100
----------------edges number: 74776
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15510940551757812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15510940551757812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1586475372314453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1586475372314453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15919065475463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3100, 47])
h_self size  torch.Size([3100, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15919065475463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3100, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15973377227783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15919065475463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3100, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1591796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15972328186035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06388425827026367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 25 input nodes size: 98068
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05429649353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05429649353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09082984924316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09085273742675781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03822183609008789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04130887985229492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04130887985229492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 98068
first layer output nodes number: 29266
edges number: 286647
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042258262634277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([98068, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042258262634277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042258262634277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05540657043457031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05540657043457031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29266, 256])
h_self size  torch.Size([29266, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29266, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11122703552246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29266, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11122703552246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11820459365844727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29266
----------------output nodes number: 3071
----------------edges number: 74788
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11844587326049805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11844587326049805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12236642837524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12236642837524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12290430068969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3071, 47])
h_self size  torch.Size([3071, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12290430068969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3071, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344217300415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12290430068969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3071, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12289905548095703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12343740463256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04597616195678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 26 input nodes size: 150504
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038216590881347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038216590881347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0942840576171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09430789947509766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05775165557861328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06110572814941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06110572814941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 150504
first layer output nodes number: 38871
edges number: 374424
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06308460235595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([150504, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06308460235595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06308460235595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08050060272216797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08050060272216797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11757087707519531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([38871, 256])
h_self size  torch.Size([38871, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11757087707519531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38871, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15464115142822266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11757087707519531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38871, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15464115142822266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1639089584350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 38871
----------------output nodes number: 3162
----------------edges number: 75559
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16422271728515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16422271728515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16782569885253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16782569885253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1683797836303711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1683797836303711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16893386840820312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1683797836303711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16839599609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16895055770874023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06763410568237305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 27 input nodes size: 124999
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05776786804199219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05776786804199219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10464286804199219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10466623306274414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857492446899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05170297622680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05170297622680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 124999
first layer output nodes number: 35467
edges number: 343995
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289936065673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([124999, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289936065673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289936065673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06880807876586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06880807876586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10263204574584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35467, 256])
h_self size  torch.Size([35467, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10263204574584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35467, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13645601272583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10263204574584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35467, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13645601272583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14561128616333008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35467
----------------output nodes number: 3124
----------------edges number: 75757
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14589929580688477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14589929580688477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14946699142456055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14946699142456055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15001440048217773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3124, 47])
h_self size  torch.Size([3124, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15001440048217773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3124, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15056180953979492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15001440048217773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3124, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1500077247619629  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15055561065673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05715036392211914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 28 input nodes size: 115808
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0485682487487793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0485682487487793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09171009063720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09173345565795898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04483509063720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04831695556640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04831695556640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 115808
first layer output nodes number: 31421
edges number: 306034
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04941415786743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([115808, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04941415786743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04941415786743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06351709365844727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06351709365844727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09348249435424805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31421, 256])
h_self size  torch.Size([31421, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09348249435424805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31421, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344789505004883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09348249435424805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31421, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344789505004883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13093948364257812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31421
----------------output nodes number: 3087
----------------edges number: 75291
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1311969757080078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1311969757080078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13472652435302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13472652435302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1352672576904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3087, 47])
h_self size  torch.Size([3087, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1352672576904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3087, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13580799102783203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1352672576904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3087, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13526058197021484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1358017921447754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053315162658691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 29 input nodes size: 109829
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04482841491699219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04482841491699219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08574295043945312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08576583862304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04260063171386719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04520416259765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04520416259765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 109829
first layer output nodes number: 28900
edges number: 276889
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04623842239379883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([109829, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04623842239379883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04623842239379883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05917644500732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05917644500732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08673763275146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28900, 256])
h_self size  torch.Size([28900, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08673763275146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28900, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11429882049560547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08673763275146484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28900, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11429882049560547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12118911743164062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28900
----------------output nodes number: 3033
----------------edges number: 72381
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12142753601074219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12142753601074219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12567901611328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12567901611328125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12621021270751953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3033, 47])
h_self size  torch.Size([3033, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12621021270751953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3033, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1267414093017578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12621021270751953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3033, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12620067596435547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12673234939575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049837589263916016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 30 input nodes size: 137330
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042591094970703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042591094970703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0937509536743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09377384185791016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05283641815185547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055835723876953125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055835723876953125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 137330
first layer output nodes number: 34048
edges number: 329178
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05716419219970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([137330, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05716419219970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05716419219970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07242822647094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07242822647094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10489892959594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34048, 256])
h_self size  torch.Size([34048, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10489892959594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34048, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13736963272094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10489892959594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34048, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13736963272094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14548730850219727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34048
----------------output nodes number: 3040
----------------edges number: 73258
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14576387405395508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14576387405395508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1492323875427246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1492323875427246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1497650146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3040, 47])
h_self size  torch.Size([3040, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1497650146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3040, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1502976417541504  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1497650146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3040, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1497664451599121  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1502995491027832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061254024505615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 31 input nodes size: 112854
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05283784866333008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05283784866333008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0948796272277832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09490346908569336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04372072219848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04716920852661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04716920852661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 112854
first layer output nodes number: 31058
edges number: 300272
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824209213256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([112854, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824209213256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824209213256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06216573715209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06216573715209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09178495407104492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31058, 256])
h_self size  torch.Size([31058, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09178495407104492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31058, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12140417098999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09178495407104492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31058, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12140417098999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12880897521972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31058
----------------output nodes number: 3162
----------------edges number: 76257
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12906455993652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12906455993652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13267230987548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13267230987548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1332263946533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1332263946533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13378047943115234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1332263946533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13324785232543945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1338024139404297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052136898040771484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 32 input nodes size: 129697
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04374217987060547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04374217987060547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09257030487060547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09259319305419922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05052757263183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053175926208496094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053175926208496094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 129697
first layer output nodes number: 29210
edges number: 284879
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054360389709472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([129697, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054360389709472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054360389709472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06763219833374023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06763219833374023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0954890251159668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29210, 256])
h_self size  torch.Size([29210, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0954890251159668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29210, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12334585189819336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0954890251159668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29210, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12334585189819336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13031005859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29210
----------------output nodes number: 3018
----------------edges number: 70455
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13055086135864258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13055086135864258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1344923973083496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1344923973083496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13502120971679688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3018, 47])
h_self size  torch.Size([3018, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13502120971679688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3018, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13555002212524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13502120971679688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3018, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1349959373474121  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13552522659301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05813741683959961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 33 input nodes size: 148222
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05050230026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05050230026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10571956634521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10574197769165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05689096450805664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06001710891723633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06001710891723633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 148222
first layer output nodes number: 35613
edges number: 348036
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061387062072753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([148222, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061387062072753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061387062072753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07771539688110352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07771539688110352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1116786003112793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35613, 256])
h_self size  torch.Size([35613, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1116786003112793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35613, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14564180374145508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1116786003112793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35613, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14564180374145508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15413284301757812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35613
----------------output nodes number: 2981
----------------edges number: 71365
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1544208526611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1544208526611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15781879425048828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15781879425048828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1583409309387207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1583409309387207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15886306762695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1583409309387207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15833425521850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15885686874389648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06593847274780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 34 input nodes size: 79283
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0568842887878418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0568842887878418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08641958236694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08644247055053711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03120279312133789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03348207473754883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03348207473754883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 79283
first layer output nodes number: 24196
edges number: 234574
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034253597259521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([79283, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034253597259521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034253597259521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04510641098022461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04510641098022461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06818151473999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([24196, 256])
h_self size  torch.Size([24196, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06818151473999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24196, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09125661849975586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06818151473999023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([24196, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09125661849975586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09702539443969727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 24196
----------------output nodes number: 3028
----------------edges number: 71296
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09722900390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09722900390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10067081451416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10067081451416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10120105743408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3028, 47])
h_self size  torch.Size([3028, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10120105743408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3028, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1017313003540039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10120105743408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3028, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10120916366577148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10173988342285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03746843338012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 35 input nodes size: 86853
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.031210899353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.031210899353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06356620788574219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06359004974365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03403186798095703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03739356994628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03739356994628906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 86853
first layer output nodes number: 28792
edges number: 274710
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03825569152832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([86853, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03825569152832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03825569152832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05113649368286133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05113649368286133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07859468460083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28792, 256])
h_self size  torch.Size([28792, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07859468460083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28792, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10605287551879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07859468460083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28792, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10605287551879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11291742324829102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28792
----------------output nodes number: 3142
----------------edges number: 75264
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11315584182739258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11315584182739258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11753225326538086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11753225326538086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808252334594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3142, 47])
h_self size  torch.Size([3142, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808252334594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3142, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11863279342651367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808252334594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3142, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1181025505065918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1186532974243164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04190969467163086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 36 input nodes size: 82050
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03405189514160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03405189514160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06530189514160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06532430648803711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03294515609741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03537130355834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03537130355834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 82050
first layer output nodes number: 25428
edges number: 251308
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03617286682128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([82050, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03617286682128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03617286682128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04761362075805664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04761362075805664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07186365127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25428, 256])
h_self size  torch.Size([25428, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07186365127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25428, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09611368179321289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07186365127563477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25428, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09611368179321289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10217618942260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25428
----------------output nodes number: 2981
----------------edges number: 74131
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10238838195800781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10238838195800781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10605812072753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10605812072753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10658025741577148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10658025741577148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1071023941040039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10658025741577148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1065521240234375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10707473754882812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03953742980957031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 37 input nodes size: 124895
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032917022705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032917022705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07979202270507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07981491088867188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04854249954223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051607608795166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051607608795166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 124895
first layer output nodes number: 33939
edges number: 335324
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052791595458984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([124895, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052791595458984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052791595458984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06806039810180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06806039810180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10042715072631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([33939, 256])
h_self size  torch.Size([33939, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10042715072631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33939, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13279390335083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10042715072631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33939, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13279390335083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1408858299255371  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 33939
----------------output nodes number: 3071
----------------edges number: 75921
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14116191864013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14116191864013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14468002319335938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14468002319335938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1452178955078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3071, 47])
h_self size  torch.Size([3071, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1452178955078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3071, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14575576782226562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1452178955078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3071, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1452336311340332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14577198028564453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 38 input nodes size: 126552
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04855823516845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04855823516845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0957026481628418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09572601318359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05239057540893555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05239057540893555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 126552
first layer output nodes number: 34996
edges number: 347851
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05359458923339844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([126552, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05359458923339844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05359458923339844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06935453414916992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06935453414916992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10272932052612305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34996, 256])
h_self size  torch.Size([34996, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10272932052612305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34996, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13610410690307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10272932052612305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34996, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13610410690307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14444780349731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34996
----------------output nodes number: 3128
----------------edges number: 78120
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14473199844360352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14473199844360352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14832162857055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14832162857055664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14886951446533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3128, 47])
h_self size  torch.Size([3128, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14886951446533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3128, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14941740036010742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14886951446533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3128, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1488795280456543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1494278907775879  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05791950225830078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 39 input nodes size: 101229
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048838138580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048838138580322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08654928207397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08657312393188477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03940534591674805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0424799919128418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0424799919128418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 101229
first layer output nodes number: 31195
edges number: 307373
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043467044830322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([101229, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043467044830322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043467044830322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0574955940246582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0574955940246582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08724546432495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31195, 256])
h_self size  torch.Size([31195, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08724546432495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31195, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11699533462524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08724546432495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31195, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11699533462524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12443304061889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31195
----------------output nodes number: 3141
----------------edges number: 77441
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12468957901000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12468957901000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12828683853149414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12828683853149414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12883710861206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3141, 47])
h_self size  torch.Size([3141, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12883710861206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3141, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12938737869262695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12883710861206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3141, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12883949279785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12939023971557617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04741716384887695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 40 input nodes size: 125227
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03940773010253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03940773010253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08628273010253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08630514144897461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857015609741211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0511469841003418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0511469841003418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 125227
first layer output nodes number: 27591
edges number: 273075
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05228614807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([125227, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05228614807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05228614807128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06479835510253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06479835510253906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0911111831665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27591, 256])
h_self size  torch.Size([27591, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0911111831665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27591, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11742401123046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0911111831665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27591, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11742401123046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12400245666503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27591
----------------output nodes number: 2998
----------------edges number: 72602
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12423086166381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12423086166381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1276545524597168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1276545524597168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12817955017089844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2998, 47])
h_self size  torch.Size([2998, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12817955017089844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12870454788208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12817955017089844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2998, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12815427780151367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12867975234985352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05592060089111328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 41 input nodes size: 133217
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048544883728027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048544883728027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09817218780517578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09819602966308594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05129861831665039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0547795295715332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0547795295715332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 133217
first layer output nodes number: 39109
edges number: 388305
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([133217, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07367277145385742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07367277145385742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11097002029418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([39109, 256])
h_self size  torch.Size([39109, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11097002029418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39109, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14826726913452148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11097002029418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39109, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14826726913452148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1575918197631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 39109
----------------output nodes number: 3161
----------------edges number: 78824
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15790748596191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15790748596191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16153335571289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16153335571289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16208696365356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16208696365356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16264057159423828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16208696365356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16211557388305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16266965866088867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06078052520751953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 42 input nodes size: 112117
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05132722854614258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05132722854614258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0930943489074707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09311676025390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043465614318847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047173500061035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047173500061035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 112117
first layer output nodes number: 32308
edges number: 319386
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824972152709961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([112117, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824972152709961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04824972152709961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0631413459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0631413459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0943913459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32308, 256])
h_self size  torch.Size([32308, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0943913459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32308, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1256413459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0943913459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32308, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1256413459777832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13334417343139648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32308
----------------output nodes number: 2992
----------------edges number: 74140
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1336073875427246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1336073875427246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13703680038452148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13703680038452148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2992, 47])
h_self size  torch.Size([2992, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13808488845825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13756084442138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13753128051757812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13805580139160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05257749557495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 43 input nodes size: 178178
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04343605041503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04343605041503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10984230041503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10986614227294922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06807661056518555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07180452346801758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07180452346801758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 178178
first layer output nodes number: 42435
edges number: 421745
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07344913482666016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([178178, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07344913482666016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07344913482666016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0931386947631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0931386947631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1336078643798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([42435, 256])
h_self size  torch.Size([42435, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1336078643798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([42435, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17407703399658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1336078643798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([42435, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17407703399658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18419456481933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 42435
----------------output nodes number: 3162
----------------edges number: 78490
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18453502655029297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18453502655029297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18853473663330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18853473663330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1890888214111328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1890888214111328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18964290618896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1890888214111328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1891188621520996  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18967342376708984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07904195785522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 44 input nodes size: 115474
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06810665130615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06810665130615234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11112451553344727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11114740371704102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04471731185913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048394203186035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048394203186035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 115474
first layer output nodes number: 32726
edges number: 324016
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494990348815918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([115474, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494990348815918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494990348815918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06432342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06432342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09557342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32726, 256])
h_self size  torch.Size([32726, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09557342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32726, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12682342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09557342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32726, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12682342529296875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13462591171264648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32726
----------------output nodes number: 3056
----------------edges number: 75818
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13489294052124023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13489294052124023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1383957862854004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1383957862854004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1389312744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3056, 47])
h_self size  torch.Size([3056, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1389312744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3056, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1394667625427246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1389312744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3056, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13891267776489258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1394486427307129  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053644657135009766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 45 input nodes size: 180835
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04469871520996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04469871520996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11206531524658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11208772659301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0690469741821289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07265853881835938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07265853881835938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 180835
first layer output nodes number: 41375
edges number: 410472
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07431459426879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([180835, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07431459426879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07431459426879883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09385824203491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09385824203491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1333165168762207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([41375, 256])
h_self size  torch.Size([41375, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1333165168762207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([41375, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1727747917175293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1333165168762207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([41375, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1727747917175293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18263959884643555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 41375
----------------output nodes number: 2981
----------------edges number: 74147
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18297052383422852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18297052383422852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18638944625854492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18638944625854492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18691158294677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18691158294677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18743371963500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18691158294677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18689823150634766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18742084503173828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08003425598144531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 46 input nodes size: 190302
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06903362274169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06903362274169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13992691040039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13995027542114258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07256126403808594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07637405395507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07637405395507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 190302
first layer output nodes number: 43804
edges number: 434968
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07811880111694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([190302, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07811880111694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07811880111694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09879350662231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09879350662231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14056825637817383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([43804, 256])
h_self size  torch.Size([43804, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14056825637817383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([43804, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1823430061340332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14056825637817383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([43804, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1823430061340332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19336843490600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 43804
----------------output nodes number: 3075
----------------edges number: 76608
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19371843338012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19371843338012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19724607467651367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19724607467651367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1977849006652832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3075, 47])
h_self size  torch.Size([3075, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1977849006652832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3075, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19832372665405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1977849006652832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3075, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1978015899658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19834089279174805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08415985107421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 47 input nodes size: 180190
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07257795333862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07257795333862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13970422744750977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13972759246826172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06881093978881836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07252931594848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07252931594848633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 180190
first layer output nodes number: 42396
edges number: 421446
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.074188232421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([180190, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.074188232421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.074188232421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09328079223632812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09328079223632812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1337127685546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([42396, 256])
h_self size  torch.Size([42396, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1337127685546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([42396, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17414474487304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1337127685546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([42396, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17414474487304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18425273895263672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 42396
----------------output nodes number: 3113
----------------edges number: 77524
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18459224700927734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18459224700927734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18866825103759766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18866825103759766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18921375274658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3113, 47])
h_self size  torch.Size([3113, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18921375274658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3113, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1897592544555664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18921375274658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3113, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18922042846679688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18976640701293945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07915925979614258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 48 input nodes size: 147925
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0688176155090332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0688176155090332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12392425537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1239476203918457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05679798126220703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060150146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060150146484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 147925
first layer output nodes number: 37577
edges number: 373213
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06153297424316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([147925, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06153297424316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06153297424316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07861948013305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07861948013305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1144556999206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([37577, 256])
h_self size  torch.Size([37577, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1144556999206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37577, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15029191970825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1144556999206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37577, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15029191970825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1593775749206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 37577
----------------output nodes number: 3079
----------------edges number: 76549
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1596813201904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1596813201904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16321277618408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16321277618408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16375207901000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3079, 47])
h_self size  torch.Size([3079, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16375207901000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3079, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1642913818359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16375207901000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3079, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16374588012695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16428565979003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06621265411376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 49 input nodes size: 189507
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05679178237915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05679178237915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12738895416259766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1274118423461914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0722818374633789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07644796371459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07644796371459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 189507
first layer output nodes number: 36676
edges number: 362523
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07813405990600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([189507, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07813405990600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07813405990600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0946359634399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0946359634399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1297922134399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36676, 256])
h_self size  torch.Size([36676, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1297922134399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36676, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16476917266845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12961292266845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36676, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16476917266845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17351341247558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36676
----------------output nodes number: 3048
----------------edges number: 73078
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17381000518798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17381000518798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17728424072265625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17728424072265625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17781829833984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3048, 47])
h_self size  torch.Size([3048, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17781829833984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3048, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17835235595703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17781829833984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3048, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17781305313110352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17834758758544922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08250141143798828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 50 input nodes size: 128518
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07227659225463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07227659225463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12110471725463867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12112855911254883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05050849914550781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053719520568847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053719520568847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 128518
first layer output nodes number: 35452
edges number: 352681
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054941654205322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([128518, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054941654205322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054941654205322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07090902328491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07090902328491211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10471868515014648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35452, 256])
h_self size  torch.Size([35452, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10471868515014648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35452, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13852834701538086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10471868515014648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35452, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13852834701538086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14761877059936523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35452
----------------output nodes number: 3138
----------------edges number: 78192
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14790678024291992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14790678024291992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1515059471130371  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1515059471130371  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1520557403564453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3138, 47])
h_self size  torch.Size([3138, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1520557403564453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15260553359985352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1520557403564453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15207147598266602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15262174606323242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05931520462036133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 51 input nodes size: 157576
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050524234771728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050524234771728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10922622680664062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10924863815307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060396671295166016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06388616561889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06388616561889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 157576
first layer output nodes number: 31467
edges number: 309100
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06529521942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([157576, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06529521942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06529521942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803375244140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803375244140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11034679412841797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([31467, 256])
h_self size  torch.Size([31467, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11034679412841797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31467, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14035606384277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11034679412841797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([31467, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14035606384277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1478586196899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 31467
----------------output nodes number: 2981
----------------edges number: 66085
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1481156349182129  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1481156349182129  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1514744758605957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1514744758605957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15199661254882812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15199661254882812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15251874923706055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15199661254882812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15196895599365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15249156951904297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06995916366577148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 52 input nodes size: 151471
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060369014739990234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060369014739990234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11679649353027344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11681985855102539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058095455169677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061350345611572266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 151471
first layer output nodes number: 36628
edges number: 360537
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([151471, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08001136779785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08001136779785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11516761779785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36628, 256])
h_self size  torch.Size([36628, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11516761779785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36628, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1500988006591797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11494255065917969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36628, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1500988006591797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15883159637451172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36628
----------------output nodes number: 3092
----------------edges number: 76279
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15912818908691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15912818908691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16266918182373047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16266918182373047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16321086883544922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3092, 47])
h_self size  torch.Size([3092, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16321086883544922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3092, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16375255584716797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16321086883544922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3092, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16323041915893555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1637725830078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06796789169311523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 53 input nodes size: 135331
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05811500549316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05811500549316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10853004455566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10855245590209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05210161209106445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0547490119934082  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0547490119934082  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 135331
first layer output nodes number: 30016
edges number: 295073
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05598115921020508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([135331, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05598115921020508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05598115921020508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0694742202758789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0694742202758789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30016, 256])
h_self size  torch.Size([30016, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30016, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1267251968383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0980997085571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30016, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1267251968383789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1338815689086914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30016
----------------output nodes number: 2981
----------------edges number: 60034
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13412761688232422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13412761688232422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13744163513183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13744163513183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13796377182006836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13796377182006836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13848590850830078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13796377182006836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13794422149658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13846683502197266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059538841247558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 54 input nodes size: 152993
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052082061767578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052082061767578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10907649993896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.109100341796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05866289138793945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061727046966552734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061727046966552734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 152993
first layer output nodes number: 33862
edges number: 334864
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06311988830566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([152993, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06311988830566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06311988830566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07835674285888672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07835674285888672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11065006256103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([33862, 256])
h_self size  torch.Size([33862, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11065006256103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33862, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1429433822631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11065006256103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33862, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1429433822631836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1510167121887207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 33862
----------------output nodes number: 3162
----------------edges number: 76212
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15129327774047852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15129327774047852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15490102767944336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15490102767944336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1554551124572754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1554551124572754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15600919723510742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1554551124572754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.155487060546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15604162216186523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06732559204101562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 55 input nodes size: 155404
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05869483947753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05869483947753906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11658763885498047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11661052703857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059592247009277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06228160858154297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06228160858154297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 155404
first layer output nodes number: 30906
edges number: 298995
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06367015838623047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([155404, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06367015838623047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06367015838623047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07752704620361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07752704620361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10700130462646484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30906, 256])
h_self size  torch.Size([30906, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10700130462646484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30906, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1364755630493164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10700130462646484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30906, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1364755630493164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14449310302734375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30906
----------------output nodes number: 3034
----------------edges number: 61925
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1447463035583496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1447463035583496  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14812421798706055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14812421798706055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14865589141845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3034, 47])
h_self size  torch.Size([3034, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14865589141845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3034, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14918756484985352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14865589141845703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3034, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14863348007202148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14916563034057617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06729412078857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 56 input nodes size: 99266
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0595698356628418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0595698356628418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09654951095581055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0965728759765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038657188415527344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042578697204589844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042578697204589844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 99266
first layer output nodes number: 34327
edges number: 340437
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04357481002807617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([99266, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04357481002807617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04357481002807617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059027671813964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059027671813964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09176445007324219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34327, 256])
h_self size  torch.Size([34327, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09176445007324219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34327, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12450122833251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09176445007324219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34327, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12450122833251953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13268566131591797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34327
----------------output nodes number: 3076
----------------edges number: 76472
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.132965087890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.132965087890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13649272918701172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13649272918701172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13703155517578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3076, 47])
h_self size  torch.Size([3076, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13703155517578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3076, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13757038116455078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13703155517578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3076, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1370387077331543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13757801055908203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04780721664428711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 57 input nodes size: 117585
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03866434097290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03866434097290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08246850967407227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08249235153198242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04548931121826172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048455238342285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048455238342285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 117585
first layer output nodes number: 32229
edges number: 319490
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049571990966796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([117585, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049571990966796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049571990966796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06446123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06446123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09571123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32229, 256])
h_self size  torch.Size([32229, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09571123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32229, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12696123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09571123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32229, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12696123123168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1346454620361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32229
----------------output nodes number: 3154
----------------edges number: 78344
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13490962982177734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13490962982177734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13852596282958984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13852596282958984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13907861709594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3154, 47])
h_self size  torch.Size([3154, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13907861709594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3154, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396312713623047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13907861709594727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3154, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13909244537353516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13964557647705078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05403423309326172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 58 input nodes size: 127569
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04550313949584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04550313949584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09302663803100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09304952621459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04922151565551758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052152156829833984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052152156829833984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 127569
first layer output nodes number: 29025
edges number: 286457
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053319454193115234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([127569, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053319454193115234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053319454193115234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06655597686767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06655597686767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09423637390136719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29025, 256])
h_self size  torch.Size([29025, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09423637390136719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29025, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1219167709350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09423637390136719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29025, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1219167709350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12883710861206055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29025
----------------output nodes number: 3053
----------------edges number: 74962
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12907648086547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12907648086547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13322782516479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13322782516479492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13376283645629883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3053, 47])
h_self size  torch.Size([3053, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13376283645629883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3053, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13429784774780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13376283645629883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3053, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1337451934814453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13428068161010742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05720233917236328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 59 input nodes size: 186720
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04920387268066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04920387268066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11876249313354492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11878490447998047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07123851776123047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0745706558227539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0745706558227539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 186720
first layer output nodes number: 37949
edges number: 375048
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07671833038330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([186720, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07671833038330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07671833038330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09379243850708008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09379243850708008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12998342514038086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([37949, 256])
h_self size  torch.Size([37949, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12998342514038086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37949, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16617441177368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12998342514038086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37949, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16617441177368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17522239685058594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 37949
----------------output nodes number: 2981
----------------edges number: 71977
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17552757263183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17552757263183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17893028259277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17893028259277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17945241928100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17945241928100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17997455596923828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17945241928100586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17943954467773438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.179962158203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08117437362670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 60 input nodes size: 141995
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07122564315795898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07122564315795898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12412309646606445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12414693832397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0545659065246582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058370113372802734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058370113372802734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 141995
first layer output nodes number: 38539
edges number: 383229
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05971574783325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([141995, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05971574783325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05971574783325195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0770721435546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0770721435546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11382579803466797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([38539, 256])
h_self size  torch.Size([38539, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11382579803466797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38539, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15057945251464844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11382579803466797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38539, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15057945251464844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15981245040893555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 38539
----------------output nodes number: 3158
----------------edges number: 78694
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1601238250732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1601238250732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16374588012695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16374588012695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16429901123046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3158, 47])
h_self size  torch.Size([3158, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16429901123046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3158, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16485214233398438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16429901123046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3158, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16433000564575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16488361358642578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06438636779785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 61 input nodes size: 104694
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054596900939941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054596900939941406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0936594009399414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09368324279785156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04076194763183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04363059997558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04363059997558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 104694
first layer output nodes number: 30902
edges number: 306255
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04464101791381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([104694, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04464101791381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04464101791381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05855083465576172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05855083465576172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08802127838134766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30902, 256])
h_self size  torch.Size([30902, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08802127838134766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30902, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174917221069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08802127838134766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30902, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174917221069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12485933303833008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30902
----------------output nodes number: 3162
----------------edges number: 78677
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12511348724365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12511348724365234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1287393569946289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1287393569946289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12929344177246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12929344177246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12984752655029297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12929344177246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12929439544677734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12984895706176758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048593997955322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 62 input nodes size: 126910
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040762901306152344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040762901306152344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08804082870483398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08806419372558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04897785186767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05238819122314453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05238819122314453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 126910
first layer output nodes number: 35087
edges number: 345698
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053595542907714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([126910, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053595542907714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053595542907714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06937360763549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06937360763549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35087, 256])
h_self size  torch.Size([35087, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35087, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13629674911499023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10283517837524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35087, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13629674911499023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14466238021850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35087
----------------output nodes number: 3108
----------------edges number: 76717
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14494752883911133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14494752883911133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14850759506225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14850759506225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14905214309692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3108, 47])
h_self size  torch.Size([3108, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14905214309692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3108, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1495966911315918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14905214309692383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3108, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14904260635375977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14958763122558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05786561965942383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 63 input nodes size: 134467
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04896831512451172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04896831512451172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09906148910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09908437728881836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051783084869384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05480051040649414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05480051040649414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 134467
first layer output nodes number: 33610
edges number: 330201
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05605363845825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([134467, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05605363845825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05605363845825195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07116031646728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07116031646728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10321331024169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([33610, 256])
h_self size  torch.Size([33610, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10321331024169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33610, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13526630401611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10321331024169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33610, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13526630401611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1432795524597168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 33610
----------------output nodes number: 3042
----------------edges number: 74657
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1435532569885254  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1435532569885254  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14783859252929688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14783859252929688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14837121963500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3042, 47])
h_self size  torch.Size([3042, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14837121963500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3042, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14890384674072266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14837121963500977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3042, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1483592987060547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14889240264892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06015205383300781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06015205383300781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06015205383300781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023090384900569916 |0.0034582801163196564 |0.01181042194366455 |0.00014171376824378967 |0.0024399198591709137 |0.002924203872680664 |
----------------------------------------------------------pseudo_mini_loss sum 3.4135258197784424
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10019895
Number of first layer input nodes during this epoch:  7938590
Number of first layer output nodes during this epoch:  2081305
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06015157699584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2839241027832031
global_2_local spend time (sec) 0.4645371437072754

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.955 seconds
Metis partitioning: 14.578 seconds
Split the graph: 0.700 seconds
Construct subgraphs: 0.387 seconds
3005
3163
3133
3163
3140
3160
3099
3034
3129
3163
3161
2995
3117
2981
2982
2984
3146
2981
3152
2981
3009
3017
3138
3010
2981
2981
3066
3138
2990
2981
2981
3009
3003
3162
3019
3052
2981
3020
3129
3122
2992
3003
3000
2982
3163
3123
3137
3157
3095
2981
3162
3078
3155
3139
3135
3155
3156
3047
3127
3161
3002
3162
3014
2987
REG metis partition end ----................................
the time spent:  27.83939552307129
total k batches seeds list generation spend  28.317397356033325
after graph partition
graph partition algorithm spend time 28.781153917312622

partition_len_list
[34377, 27822, 30468, 23804, 28574, 37181, 28377, 25038, 36934, 30942, 30460, 29498, 25551, 34851, 27246, 27204, 25712, 38153, 30826, 35759, 32087, 27596, 29788, 39578, 30937, 29704, 23350, 27470, 30117, 33773, 26756, 28818, 32863, 36683, 25815, 30249, 34379, 34887, 39737, 46776, 20264, 29822, 24975, 30297, 34757, 36827, 35747, 34358, 38583, 41057, 36511, 36444, 34087, 34114, 29729, 34034, 35063, 34137, 39966, 33357, 27289, 36614, 33310, 33139]
REG selection method  spend 29.458819150924683
check_connections_block*********************************
time for parepare 1: 0.24418878555297852
local_output_nid generation: 0.0013675689697265625
local_in_edges_tensor generation: 0.0015323162078857422
mini_batch_src_global generation: 0.0024449825286865234

&&&&&&&&&&&&&&& before remove duplicate length: 71835
r_  generation: 0.02297806739807129

local_output_nid generation: 0.0014164447784423828
local_in_edges_tensor generation: 0.0013699531555175781
mini_batch_src_global generation: 0.0028116703033447266

&&&&&&&&&&&&&&& before remove duplicate length: 73706
r_  generation: 0.0228731632232666

local_output_nid generation: 0.0013420581817626953
local_in_edges_tensor generation: 0.0013508796691894531
mini_batch_src_global generation: 0.0019974708557128906

&&&&&&&&&&&&&&& before remove duplicate length: 75360
r_  generation: 0.023928165435791016

local_output_nid generation: 0.0013685226440429688
local_in_edges_tensor generation: 0.0013284683227539062
mini_batch_src_global generation: 0.002106189727783203

&&&&&&&&&&&&&&& before remove duplicate length: 74296
r_  generation: 0.0235598087310791

local_output_nid generation: 0.0013608932495117188
local_in_edges_tensor generation: 0.0013394355773925781
mini_batch_src_global generation: 0.0020956993103027344

&&&&&&&&&&&&&&& before remove duplicate length: 75567
r_  generation: 0.02436542510986328

local_output_nid generation: 0.0013675689697265625
local_in_edges_tensor generation: 0.0013277530670166016
mini_batch_src_global generation: 0.002204418182373047

&&&&&&&&&&&&&&& before remove duplicate length: 75611
r_  generation: 0.025317668914794922

local_output_nid generation: 0.0013535022735595703
local_in_edges_tensor generation: 0.0013539791107177734
mini_batch_src_global generation: 0.002288818359375

&&&&&&&&&&&&&&& before remove duplicate length: 75681
r_  generation: 0.041701316833496094

local_output_nid generation: 0.001726388931274414
local_in_edges_tensor generation: 0.0017774105072021484
mini_batch_src_global generation: 0.0034470558166503906

&&&&&&&&&&&&&&& before remove duplicate length: 75224
r_  generation: 0.027196407318115234

local_output_nid generation: 0.0013957023620605469
local_in_edges_tensor generation: 0.0013420581817626953
mini_batch_src_global generation: 0.002784252166748047

&&&&&&&&&&&&&&& before remove duplicate length: 75475
r_  generation: 0.029408693313598633

local_output_nid generation: 0.0020453929901123047
local_in_edges_tensor generation: 0.005096435546875
mini_batch_src_global generation: 0.0030241012573242188

&&&&&&&&&&&&&&& before remove duplicate length: 76357
r_  generation: 0.028458833694458008

local_output_nid generation: 0.0014164447784423828
local_in_edges_tensor generation: 0.004048347473144531
mini_batch_src_global generation: 0.002871990203857422

&&&&&&&&&&&&&&& before remove duplicate length: 75570
r_  generation: 0.025733470916748047

local_output_nid generation: 0.0013513565063476562
local_in_edges_tensor generation: 0.003146648406982422
mini_batch_src_global generation: 0.002339601516723633

&&&&&&&&&&&&&&& before remove duplicate length: 72706
r_  generation: 0.024757862091064453

local_output_nid generation: 0.0013854503631591797
local_in_edges_tensor generation: 0.0027725696563720703
mini_batch_src_global generation: 0.0023076534271240234

&&&&&&&&&&&&&&& before remove duplicate length: 74772
r_  generation: 0.024886608123779297

local_output_nid generation: 0.0013337135314941406
local_in_edges_tensor generation: 0.002306222915649414
mini_batch_src_global generation: 0.002259492874145508

&&&&&&&&&&&&&&& before remove duplicate length: 71785
r_  generation: 0.04642343521118164

local_output_nid generation: 0.0017726421356201172
local_in_edges_tensor generation: 0.002991199493408203
mini_batch_src_global generation: 0.003958702087402344

&&&&&&&&&&&&&&& before remove duplicate length: 72673
r_  generation: 0.025711774826049805

local_output_nid generation: 0.0013594627380371094
local_in_edges_tensor generation: 0.0019304752349853516
mini_batch_src_global generation: 0.002200603485107422

&&&&&&&&&&&&&&& before remove duplicate length: 71834
r_  generation: 0.03767275810241699

local_output_nid generation: 0.001920938491821289
local_in_edges_tensor generation: 0.0025365352630615234
mini_batch_src_global generation: 0.005370140075683594

&&&&&&&&&&&&&&& before remove duplicate length: 77066
r_  generation: 0.026946067810058594

local_output_nid generation: 0.0013422966003417969
local_in_edges_tensor generation: 0.001569986343383789
mini_batch_src_global generation: 0.002274751663208008

&&&&&&&&&&&&&&& before remove duplicate length: 72635
r_  generation: 0.04322361946105957

local_output_nid generation: 0.0018155574798583984
local_in_edges_tensor generation: 0.0023059844970703125
mini_batch_src_global generation: 0.003803730010986328

&&&&&&&&&&&&&&& before remove duplicate length: 77589
r_  generation: 0.02756190299987793

local_output_nid generation: 0.0013704299926757812
local_in_edges_tensor generation: 0.0015277862548828125
mini_batch_src_global generation: 0.002210378646850586

&&&&&&&&&&&&&&& before remove duplicate length: 71750
r_  generation: 0.03965950012207031

local_output_nid generation: 0.0018913745880126953
local_in_edges_tensor generation: 0.0020797252655029297
mini_batch_src_global generation: 0.005448579788208008

&&&&&&&&&&&&&&& before remove duplicate length: 74370
r_  generation: 0.02837395668029785

local_output_nid generation: 0.0013654232025146484
local_in_edges_tensor generation: 0.001523733139038086
mini_batch_src_global generation: 0.0022783279418945312

&&&&&&&&&&&&&&& before remove duplicate length: 74245
r_  generation: 0.0451359748840332

local_output_nid generation: 0.0019440650939941406
local_in_edges_tensor generation: 0.0021135807037353516
mini_batch_src_global generation: 0.0034873485565185547

&&&&&&&&&&&&&&& before remove duplicate length: 76721
r_  generation: 0.026241540908813477

local_output_nid generation: 0.0013782978057861328
local_in_edges_tensor generation: 0.0015001296997070312
mini_batch_src_global generation: 0.0023152828216552734

&&&&&&&&&&&&&&& before remove duplicate length: 72155
r_  generation: 0.039903879165649414

local_output_nid generation: 0.0018699169158935547
local_in_edges_tensor generation: 0.0019447803497314453
mini_batch_src_global generation: 0.004977226257324219

&&&&&&&&&&&&&&& before remove duplicate length: 67744
r_  generation: 0.02639174461364746

local_output_nid generation: 0.0013947486877441406
local_in_edges_tensor generation: 0.0014057159423828125
mini_batch_src_global generation: 0.002153635025024414

&&&&&&&&&&&&&&& before remove duplicate length: 71239
r_  generation: 0.04258847236633301

local_output_nid generation: 0.0019390583038330078
local_in_edges_tensor generation: 0.001993894577026367
mini_batch_src_global generation: 0.0036695003509521484

&&&&&&&&&&&&&&& before remove duplicate length: 75782
r_  generation: 0.03088092803955078

local_output_nid generation: 0.002652883529663086
local_in_edges_tensor generation: 0.0013527870178222656
mini_batch_src_global generation: 0.002343893051147461

&&&&&&&&&&&&&&& before remove duplicate length: 76641
r_  generation: 0.03523874282836914

local_output_nid generation: 0.0023314952850341797
local_in_edges_tensor generation: 0.0017571449279785156
mini_batch_src_global generation: 0.015664339065551758

&&&&&&&&&&&&&&& before remove duplicate length: 70415
r_  generation: 0.02407073974609375

local_output_nid generation: 0.0014142990112304688
local_in_edges_tensor generation: 0.0012195110321044922
mini_batch_src_global generation: 0.004129886627197266

&&&&&&&&&&&&&&& before remove duplicate length: 71606
r_  generation: 0.02474069595336914

local_output_nid generation: 0.0014011859893798828
local_in_edges_tensor generation: 0.0012323856353759766
mini_batch_src_global generation: 0.002192974090576172

&&&&&&&&&&&&&&& before remove duplicate length: 70660
r_  generation: 0.024070262908935547

local_output_nid generation: 0.0014154911041259766
local_in_edges_tensor generation: 0.001264810562133789
mini_batch_src_global generation: 0.0022017955780029297

&&&&&&&&&&&&&&& before remove duplicate length: 71540
r_  generation: 0.023931026458740234

local_output_nid generation: 0.0013895034790039062
local_in_edges_tensor generation: 0.0014498233795166016
mini_batch_src_global generation: 0.002535104751586914

&&&&&&&&&&&&&&& before remove duplicate length: 73565
r_  generation: 0.025156021118164062

local_output_nid generation: 0.0014545917510986328
local_in_edges_tensor generation: 0.0015420913696289062
mini_batch_src_global generation: 0.0024394989013671875

&&&&&&&&&&&&&&& before remove duplicate length: 78967
r_  generation: 0.05019736289978027

local_output_nid generation: 0.0018415451049804688
local_in_edges_tensor generation: 0.0018763542175292969
mini_batch_src_global generation: 0.0033178329467773438

&&&&&&&&&&&&&&& before remove duplicate length: 75121
r_  generation: 0.025752544403076172

local_output_nid generation: 0.0014243125915527344
local_in_edges_tensor generation: 0.001300811767578125
mini_batch_src_global generation: 0.0023221969604492188

&&&&&&&&&&&&&&& before remove duplicate length: 75423
r_  generation: 0.041399240493774414

local_output_nid generation: 0.002193450927734375
local_in_edges_tensor generation: 0.002637624740600586
mini_batch_src_global generation: 0.013306617736816406

&&&&&&&&&&&&&&& before remove duplicate length: 74153
r_  generation: 0.027513504028320312

local_output_nid generation: 0.0015938282012939453
local_in_edges_tensor generation: 0.0015172958374023438
mini_batch_src_global generation: 0.0023429393768310547

&&&&&&&&&&&&&&& before remove duplicate length: 75058
r_  generation: 0.03842306137084961

local_output_nid generation: 0.0021419525146484375
local_in_edges_tensor generation: 0.0024633407592773438
mini_batch_src_global generation: 0.00580906867980957

&&&&&&&&&&&&&&& before remove duplicate length: 77800
r_  generation: 0.02928328514099121

local_output_nid generation: 0.001522064208984375
local_in_edges_tensor generation: 0.001562356948852539
mini_batch_src_global generation: 0.0024919509887695312

&&&&&&&&&&&&&&& before remove duplicate length: 77607
r_  generation: 0.029945850372314453

local_output_nid generation: 0.0014972686767578125
local_in_edges_tensor generation: 0.0012142658233642578
mini_batch_src_global generation: 0.001966238021850586

&&&&&&&&&&&&&&& before remove duplicate length: 54643
r_  generation: 0.01743626594543457

local_output_nid generation: 0.001531839370727539
local_in_edges_tensor generation: 0.0011820793151855469
mini_batch_src_global generation: 0.0018546581268310547

&&&&&&&&&&&&&&& before remove duplicate length: 60997
r_  generation: 0.020021438598632812

local_output_nid generation: 0.0014503002166748047
local_in_edges_tensor generation: 0.0012271404266357422
mini_batch_src_global generation: 0.002090930938720703

&&&&&&&&&&&&&&& before remove duplicate length: 72642
r_  generation: 0.02395796775817871

local_output_nid generation: 0.0014622211456298828
local_in_edges_tensor generation: 0.001451730728149414
mini_batch_src_global generation: 0.002213716506958008

&&&&&&&&&&&&&&& before remove duplicate length: 73254
r_  generation: 0.024378061294555664

local_output_nid generation: 0.0015239715576171875
local_in_edges_tensor generation: 0.0012903213500976562
mini_batch_src_global generation: 0.0023267269134521484

&&&&&&&&&&&&&&& before remove duplicate length: 77094
r_  generation: 0.02576613426208496

local_output_nid generation: 0.0014882087707519531
local_in_edges_tensor generation: 0.0014045238494873047
mini_batch_src_global generation: 0.0023589134216308594

&&&&&&&&&&&&&&& before remove duplicate length: 76451
r_  generation: 0.039578914642333984

local_output_nid generation: 0.0020296573638916016
local_in_edges_tensor generation: 0.0018906593322753906
mini_batch_src_global generation: 0.005944967269897461

&&&&&&&&&&&&&&& before remove duplicate length: 78259
r_  generation: 0.029768943786621094

local_output_nid generation: 0.00150299072265625
local_in_edges_tensor generation: 0.0019636154174804688
mini_batch_src_global generation: 0.0024297237396240234

&&&&&&&&&&&&&&& before remove duplicate length: 78570
r_  generation: 0.04874563217163086

local_output_nid generation: 0.001978635787963867
local_in_edges_tensor generation: 0.001991748809814453
mini_batch_src_global generation: 0.003701448440551758

&&&&&&&&&&&&&&& before remove duplicate length: 75407
r_  generation: 0.027306795120239258

local_output_nid generation: 0.0014362335205078125
local_in_edges_tensor generation: 0.0012753009796142578
mini_batch_src_global generation: 0.0023512840270996094

&&&&&&&&&&&&&&& before remove duplicate length: 73719
r_  generation: 0.04894304275512695

local_output_nid generation: 0.002063751220703125
local_in_edges_tensor generation: 0.0017001628875732422
mini_batch_src_global generation: 0.0033333301544189453

&&&&&&&&&&&&&&& before remove duplicate length: 78653
r_  generation: 0.028156518936157227

local_output_nid generation: 0.0014824867248535156
local_in_edges_tensor generation: 0.0013000965118408203
mini_batch_src_global generation: 0.0024566650390625

&&&&&&&&&&&&&&& before remove duplicate length: 76476
r_  generation: 0.038973331451416016

local_output_nid generation: 0.002331256866455078
local_in_edges_tensor generation: 0.0021381378173828125
mini_batch_src_global generation: 0.008509635925292969

&&&&&&&&&&&&&&& before remove duplicate length: 78792
r_  generation: 0.030295610427856445

local_output_nid generation: 0.0016460418701171875
local_in_edges_tensor generation: 0.0013849735260009766
mini_batch_src_global generation: 0.002493143081665039

&&&&&&&&&&&&&&& before remove duplicate length: 78093
r_  generation: 0.02728891372680664

local_output_nid generation: 0.001611471176147461
local_in_edges_tensor generation: 0.0012812614440917969
mini_batch_src_global generation: 0.0024700164794921875

&&&&&&&&&&&&&&& before remove duplicate length: 77476
r_  generation: 0.026869535446166992

local_output_nid generation: 0.0015861988067626953
local_in_edges_tensor generation: 0.0015234947204589844
mini_batch_src_global generation: 0.002471446990966797

&&&&&&&&&&&&&&& before remove duplicate length: 78547
r_  generation: 0.026863813400268555

local_output_nid generation: 0.0015652179718017578
local_in_edges_tensor generation: 0.001291513442993164
mini_batch_src_global generation: 0.002521514892578125

&&&&&&&&&&&&&&& before remove duplicate length: 78570
r_  generation: 0.027393102645874023

local_output_nid generation: 0.001497030258178711
local_in_edges_tensor generation: 0.0014944076538085938
mini_batch_src_global generation: 0.002414226531982422

&&&&&&&&&&&&&&& before remove duplicate length: 75683
r_  generation: 0.0263364315032959

local_output_nid generation: 0.0015299320220947266
local_in_edges_tensor generation: 0.001505136489868164
mini_batch_src_global generation: 0.0023949146270751953

&&&&&&&&&&&&&&& before remove duplicate length: 77356
r_  generation: 0.049588680267333984

local_output_nid generation: 0.0019998550415039062
local_in_edges_tensor generation: 0.0018608570098876953
mini_batch_src_global generation: 0.003826618194580078

&&&&&&&&&&&&&&& before remove duplicate length: 78629
r_  generation: 0.028487682342529297

local_output_nid generation: 0.0014576911926269531
local_in_edges_tensor generation: 0.0012793540954589844
mini_batch_src_global generation: 0.002349853515625

&&&&&&&&&&&&&&& before remove duplicate length: 72835
r_  generation: 0.04346036911010742

local_output_nid generation: 0.0019240379333496094
local_in_edges_tensor generation: 0.0018591880798339844
mini_batch_src_global generation: 0.004235982894897461

&&&&&&&&&&&&&&& before remove duplicate length: 78243
r_  generation: 0.027962207794189453

local_output_nid generation: 0.001461029052734375
local_in_edges_tensor generation: 0.0012364387512207031
mini_batch_src_global generation: 0.0023543834686279297

&&&&&&&&&&&&&&& before remove duplicate length: 72355
r_  generation: 0.03809165954589844

local_output_nid generation: 0.0019373893737792969
local_in_edges_tensor generation: 0.0023500919342041016
mini_batch_src_global generation: 0.005115509033203125

&&&&&&&&&&&&&&& before remove duplicate length: 72831
r_  generation: 0.02702498435974121


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6833889484405518
gen group dst list time:  0.06543445587158203
check_connections_block*********************************
time for parepare 1: 0.3732292652130127
local_output_nid generation: 0.00959324836730957
local_in_edges_tensor generation: 0.05848360061645508
mini_batch_src_global generation: 0.012679100036621094

&&&&&&&&&&&&&&& before remove duplicate length: 335401
r_  generation: 0.12229275703430176

local_output_nid generation: 0.009779214859008789
local_in_edges_tensor generation: 0.011732101440429688
mini_batch_src_global generation: 0.012552976608276367

&&&&&&&&&&&&&&& before remove duplicate length: 270535
r_  generation: 0.10715007781982422

local_output_nid generation: 0.009451627731323242
local_in_edges_tensor generation: 0.011373281478881836
mini_batch_src_global generation: 0.010912656784057617

&&&&&&&&&&&&&&& before remove duplicate length: 290283
r_  generation: 0.10670065879821777

local_output_nid generation: 0.0077915191650390625
local_in_edges_tensor generation: 0.0069119930267333984
mini_batch_src_global generation: 0.009241342544555664

&&&&&&&&&&&&&&& before remove duplicate length: 230870
r_  generation: 0.08539271354675293

local_output_nid generation: 0.00890040397644043
local_in_edges_tensor generation: 0.008161306381225586
mini_batch_src_global generation: 0.010529279708862305

&&&&&&&&&&&&&&& before remove duplicate length: 276199
r_  generation: 0.10974359512329102

local_output_nid generation: 0.011941671371459961
local_in_edges_tensor generation: 0.013599157333374023
mini_batch_src_global generation: 0.015485763549804688

&&&&&&&&&&&&&&& before remove duplicate length: 358557
r_  generation: 0.1495954990386963

local_output_nid generation: 0.008705854415893555
local_in_edges_tensor generation: 0.0075626373291015625
mini_batch_src_global generation: 0.01269388198852539

&&&&&&&&&&&&&&& before remove duplicate length: 275806
r_  generation: 0.11425042152404785

local_output_nid generation: 0.007650613784790039
local_in_edges_tensor generation: 0.008849620819091797
mini_batch_src_global generation: 0.010749101638793945

&&&&&&&&&&&&&&& before remove duplicate length: 247232
r_  generation: 0.09564328193664551

local_output_nid generation: 0.011948347091674805
local_in_edges_tensor generation: 0.011484622955322266
mini_batch_src_global generation: 0.016065120697021484

&&&&&&&&&&&&&&& before remove duplicate length: 357643
r_  generation: 0.1507861614227295

local_output_nid generation: 0.010697364807128906
local_in_edges_tensor generation: 0.010935544967651367
mini_batch_src_global generation: 0.01422262191772461

&&&&&&&&&&&&&&& before remove duplicate length: 299185
r_  generation: 0.13045954704284668

local_output_nid generation: 0.010374069213867188
local_in_edges_tensor generation: 0.012725114822387695
mini_batch_src_global generation: 0.013290166854858398

&&&&&&&&&&&&&&& before remove duplicate length: 291547
r_  generation: 0.12482118606567383

local_output_nid generation: 0.010245561599731445
local_in_edges_tensor generation: 0.009246110916137695
mini_batch_src_global generation: 0.013605117797851562

&&&&&&&&&&&&&&& before remove duplicate length: 286425
r_  generation: 0.1246943473815918

local_output_nid generation: 0.008780479431152344
local_in_edges_tensor generation: 0.007796525955200195
mini_batch_src_global generation: 0.01174783706665039

&&&&&&&&&&&&&&& before remove duplicate length: 247696
r_  generation: 0.10114526748657227

local_output_nid generation: 0.011638164520263672
local_in_edges_tensor generation: 0.0109405517578125
mini_batch_src_global generation: 0.014569759368896484

&&&&&&&&&&&&&&& before remove duplicate length: 338494
r_  generation: 0.14388155937194824

local_output_nid generation: 0.009510040283203125
local_in_edges_tensor generation: 0.008767366409301758
mini_batch_src_global generation: 0.013156414031982422

&&&&&&&&&&&&&&& before remove duplicate length: 262898
r_  generation: 0.11348152160644531

local_output_nid generation: 0.008932113647460938
local_in_edges_tensor generation: 0.009927511215209961
mini_batch_src_global generation: 0.011744499206542969

&&&&&&&&&&&&&&& before remove duplicate length: 262558
r_  generation: 0.11288714408874512

local_output_nid generation: 0.008951187133789062
local_in_edges_tensor generation: 0.00837564468383789
mini_batch_src_global generation: 0.012059688568115234

&&&&&&&&&&&&&&& before remove duplicate length: 251487
r_  generation: 0.1114048957824707

local_output_nid generation: 0.013021707534790039
local_in_edges_tensor generation: 0.01603388786315918
mini_batch_src_global generation: 0.01773524284362793

&&&&&&&&&&&&&&& before remove duplicate length: 373860
r_  generation: 0.17437076568603516

local_output_nid generation: 0.010752439498901367
local_in_edges_tensor generation: 0.009859323501586914
mini_batch_src_global generation: 0.014666318893432617

&&&&&&&&&&&&&&& before remove duplicate length: 301782
r_  generation: 0.13681602478027344

local_output_nid generation: 0.012261629104614258
local_in_edges_tensor generation: 0.05031609535217285
mini_batch_src_global generation: 0.015920400619506836

&&&&&&&&&&&&&&& before remove duplicate length: 347301
r_  generation: 0.15910696983337402

local_output_nid generation: 0.01281881332397461
local_in_edges_tensor generation: 0.018888473510742188
mini_batch_src_global generation: 0.01590871810913086

&&&&&&&&&&&&&&& before remove duplicate length: 317494
r_  generation: 0.1440119743347168

local_output_nid generation: 0.008980751037597656
local_in_edges_tensor generation: 0.012605667114257812
mini_batch_src_global generation: 0.013089179992675781

&&&&&&&&&&&&&&& before remove duplicate length: 271541
r_  generation: 0.12175631523132324

local_output_nid generation: 0.009385824203491211
local_in_edges_tensor generation: 0.01182866096496582
mini_batch_src_global generation: 0.017263174057006836

&&&&&&&&&&&&&&& before remove duplicate length: 291832
r_  generation: 0.13100457191467285

local_output_nid generation: 0.025434255599975586
local_in_edges_tensor generation: 0.019108057022094727
mini_batch_src_global generation: 0.017093420028686523

&&&&&&&&&&&&&&& before remove duplicate length: 382660
r_  generation: 0.1822192668914795

local_output_nid generation: 0.015915632247924805
local_in_edges_tensor generation: 0.01055002212524414
mini_batch_src_global generation: 0.015518426895141602

&&&&&&&&&&&&&&& before remove duplicate length: 298683
r_  generation: 0.13174080848693848

local_output_nid generation: 0.012115001678466797
local_in_edges_tensor generation: 0.00994253158569336
mini_batch_src_global generation: 0.01341104507446289

&&&&&&&&&&&&&&& before remove duplicate length: 290816
r_  generation: 0.12839293479919434

local_output_nid generation: 0.008802413940429688
local_in_edges_tensor generation: 0.008240699768066406
mini_batch_src_global generation: 0.01203012466430664

&&&&&&&&&&&&&&& before remove duplicate length: 228850
r_  generation: 0.09628653526306152

local_output_nid generation: 0.009388208389282227
local_in_edges_tensor generation: 0.00894927978515625
mini_batch_src_global generation: 0.012673616409301758

&&&&&&&&&&&&&&& before remove duplicate length: 268007
r_  generation: 0.1164250373840332

local_output_nid generation: 0.010863542556762695
local_in_edges_tensor generation: 0.011274576187133789
mini_batch_src_global generation: 0.014532089233398438

&&&&&&&&&&&&&&& before remove duplicate length: 293730
r_  generation: 0.12465691566467285

local_output_nid generation: 0.011600494384765625
local_in_edges_tensor generation: 0.011343240737915039
mini_batch_src_global generation: 0.014710664749145508

&&&&&&&&&&&&&&& before remove duplicate length: 331888
r_  generation: 0.1439216136932373

local_output_nid generation: 0.00958395004272461
local_in_edges_tensor generation: 0.008010149002075195
mini_batch_src_global generation: 0.012959957122802734

&&&&&&&&&&&&&&& before remove duplicate length: 260642
r_  generation: 0.10850000381469727

local_output_nid generation: 0.009755611419677734
local_in_edges_tensor generation: 0.009174585342407227
mini_batch_src_global generation: 0.013216972351074219

&&&&&&&&&&&&&&& before remove duplicate length: 281236
r_  generation: 0.11547446250915527

local_output_nid generation: 0.011466741561889648
local_in_edges_tensor generation: 0.013638496398925781
mini_batch_src_global generation: 0.01463627815246582

&&&&&&&&&&&&&&& before remove duplicate length: 322513
r_  generation: 0.14130878448486328

local_output_nid generation: 0.012413501739501953
local_in_edges_tensor generation: 0.011269807815551758
mini_batch_src_global generation: 0.01634049415588379

&&&&&&&&&&&&&&& before remove duplicate length: 364203
r_  generation: 0.15582561492919922

local_output_nid generation: 0.008609533309936523
local_in_edges_tensor generation: 0.0072116851806640625
mini_batch_src_global generation: 0.013022422790527344

&&&&&&&&&&&&&&& before remove duplicate length: 255175
r_  generation: 0.10635042190551758

local_output_nid generation: 0.010236501693725586
local_in_edges_tensor generation: 0.009964466094970703
mini_batch_src_global generation: 0.014127254486083984

&&&&&&&&&&&&&&& before remove duplicate length: 297552
r_  generation: 0.12822604179382324

local_output_nid generation: 0.011813640594482422
local_in_edges_tensor generation: 0.013105154037475586
mini_batch_src_global generation: 0.016806840896606445

&&&&&&&&&&&&&&& before remove duplicate length: 340499
r_  generation: 0.15027976036071777

local_output_nid generation: 0.011679649353027344
local_in_edges_tensor generation: 0.010144472122192383
mini_batch_src_global generation: 0.015948772430419922

&&&&&&&&&&&&&&& before remove duplicate length: 345845
r_  generation: 0.15189599990844727

local_output_nid generation: 0.013724088668823242
local_in_edges_tensor generation: 0.013923168182373047
mini_batch_src_global generation: 0.01774144172668457

&&&&&&&&&&&&&&& before remove duplicate length: 394447
r_  generation: 0.17735767364501953

local_output_nid generation: 0.01639842987060547
local_in_edges_tensor generation: 0.018926620483398438
mini_batch_src_global generation: 0.02262115478515625

&&&&&&&&&&&&&&& before remove duplicate length: 464788
r_  generation: 0.22805333137512207

local_output_nid generation: 0.00765681266784668
local_in_edges_tensor generation: 0.006741523742675781
mini_batch_src_global generation: 0.012289762496948242

&&&&&&&&&&&&&&& before remove duplicate length: 195667
r_  generation: 0.09297919273376465

local_output_nid generation: 0.01038670539855957
local_in_edges_tensor generation: 0.009928464889526367
mini_batch_src_global generation: 0.012502670288085938

&&&&&&&&&&&&&&& before remove duplicate length: 289031
r_  generation: 0.1335592269897461

local_output_nid generation: 0.008725166320800781
local_in_edges_tensor generation: 0.007604360580444336
mini_batch_src_global generation: 0.012442588806152344

&&&&&&&&&&&&&&& before remove duplicate length: 245582
r_  generation: 0.11161684989929199

local_output_nid generation: 0.010385274887084961
local_in_edges_tensor generation: 0.009085416793823242
mini_batch_src_global generation: 0.014144659042358398

&&&&&&&&&&&&&&& before remove duplicate length: 300295
r_  generation: 0.13520574569702148

local_output_nid generation: 0.0113983154296875
local_in_edges_tensor generation: 0.01067972183227539
mini_batch_src_global generation: 0.017082929611206055

&&&&&&&&&&&&&&& before remove duplicate length: 345042
r_  generation: 0.15492701530456543

local_output_nid generation: 0.011397361755371094
local_in_edges_tensor generation: 0.010251522064208984
mini_batch_src_global generation: 0.016547203063964844

&&&&&&&&&&&&&&& before remove duplicate length: 362573
r_  generation: 0.16262531280517578

local_output_nid generation: 0.011874198913574219
local_in_edges_tensor generation: 0.013599157333374023
mini_batch_src_global generation: 0.017074108123779297

&&&&&&&&&&&&&&& before remove duplicate length: 355711
r_  generation: 0.16325783729553223

local_output_nid generation: 0.011416196823120117
local_in_edges_tensor generation: 0.010149717330932617
mini_batch_src_global generation: 0.016402482986450195

&&&&&&&&&&&&&&& before remove duplicate length: 341333
r_  generation: 0.15435791015625

local_output_nid generation: 0.012271881103515625
local_in_edges_tensor generation: 0.011993885040283203
mini_batch_src_global generation: 0.020559310913085938

&&&&&&&&&&&&&&& before remove duplicate length: 382289
r_  generation: 0.1742997169494629

local_output_nid generation: 0.014114618301391602
local_in_edges_tensor generation: 0.01544499397277832
mini_batch_src_global generation: 0.019336700439453125

&&&&&&&&&&&&&&& before remove duplicate length: 406937
r_  generation: 0.18837952613830566

local_output_nid generation: 0.012766122817993164
local_in_edges_tensor generation: 0.011233329772949219
mini_batch_src_global generation: 0.01883697509765625

&&&&&&&&&&&&&&& before remove duplicate length: 363206
r_  generation: 0.17033147811889648

local_output_nid generation: 0.012685298919677734
local_in_edges_tensor generation: 0.010958671569824219
mini_batch_src_global generation: 0.017322778701782227

&&&&&&&&&&&&&&& before remove duplicate length: 361503
r_  generation: 0.16602635383605957

local_output_nid generation: 0.01161646842956543
local_in_edges_tensor generation: 0.009689569473266602
mini_batch_src_global generation: 0.016687631607055664

&&&&&&&&&&&&&&& before remove duplicate length: 338454
r_  generation: 0.1510758399963379

local_output_nid generation: 0.010917425155639648
local_in_edges_tensor generation: 0.009615659713745117
mini_batch_src_global generation: 0.015735149383544922

&&&&&&&&&&&&&&& before remove duplicate length: 338406
r_  generation: 0.14885878562927246

local_output_nid generation: 0.009840011596679688
local_in_edges_tensor generation: 0.008594036102294922
mini_batch_src_global generation: 0.01425313949584961

&&&&&&&&&&&&&&& before remove duplicate length: 293298
r_  generation: 0.1384279727935791

local_output_nid generation: 0.011183500289916992
local_in_edges_tensor generation: 0.010323047637939453
mini_batch_src_global generation: 0.015926122665405273

&&&&&&&&&&&&&&& before remove duplicate length: 338114
r_  generation: 0.16145944595336914

local_output_nid generation: 0.011681556701660156
local_in_edges_tensor generation: 0.027219295501708984
mini_batch_src_global generation: 0.016321420669555664

&&&&&&&&&&&&&&& before remove duplicate length: 347720
r_  generation: 0.15447235107421875

local_output_nid generation: 0.017421245574951172
local_in_edges_tensor generation: 0.01629352569580078
mini_batch_src_global generation: 0.01588606834411621

&&&&&&&&&&&&&&& before remove duplicate length: 339504
r_  generation: 0.1527111530303955

local_output_nid generation: 0.014133930206298828
local_in_edges_tensor generation: 0.017637252807617188
mini_batch_src_global generation: 0.019504547119140625

&&&&&&&&&&&&&&& before remove duplicate length: 396488
r_  generation: 0.17910456657409668

local_output_nid generation: 0.01075124740600586
local_in_edges_tensor generation: 0.010651826858520508
mini_batch_src_global generation: 0.015880823135375977

&&&&&&&&&&&&&&& before remove duplicate length: 330664
r_  generation: 0.14778757095336914

local_output_nid generation: 0.009382247924804688
local_in_edges_tensor generation: 0.01005864143371582
mini_batch_src_global generation: 0.013782024383544922

&&&&&&&&&&&&&&& before remove duplicate length: 269766
r_  generation: 0.12425422668457031

local_output_nid generation: 0.02243661880493164
local_in_edges_tensor generation: 0.011845111846923828
mini_batch_src_global generation: 0.01623082160949707

&&&&&&&&&&&&&&& before remove duplicate length: 363691
r_  generation: 0.17014217376708984

local_output_nid generation: 0.013551950454711914
local_in_edges_tensor generation: 0.012886762619018555
mini_batch_src_global generation: 0.016609668731689453

&&&&&&&&&&&&&&& before remove duplicate length: 329176
r_  generation: 0.15796923637390137

local_output_nid generation: 0.014198541641235352
local_in_edges_tensor generation: 0.011245489120483398
mini_batch_src_global generation: 0.015839099884033203

&&&&&&&&&&&&&&& before remove duplicate length: 326859
r_  generation: 0.15473246574401855


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06015157699584961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

connection checking time:  17.091139554977417
block generation total time  14.42300534248352
average batch blocks generation time:  0.225359458476305
block dataloader generation time/epoch 62.91543388366699
pseudo mini batch 0 input nodes size: 127806
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05177021026611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05177021026611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09938192367553711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09940433502197266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049288272857666016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05232381820678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05232381820678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 127806
first layer output nodes number: 34377
edges number: 335401
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05353260040283203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([127806, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05353260040283203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05353260040283203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06896734237670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06896734237670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10175180435180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34377, 256])
h_self size  torch.Size([34377, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10175180435180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34377, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1345362663269043  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10175180435180664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34377, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1345362663269043  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1427326202392578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34377
----------------output nodes number: 3005
----------------edges number: 71835
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14301156997680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14301156997680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14643621444702148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14643621444702148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14696264266967773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3005, 47])
h_self size  torch.Size([3005, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14696264266967773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3005, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14748907089233398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14696264266967773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3005, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1469564437866211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14748382568359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05764579772949219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 1 input nodes size: 110707
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04928302764892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04928302764892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09052467346191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09054851531982422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042914390563964844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045479774475097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045479774475097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 110707
first layer output nodes number: 27822
edges number: 270535
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04651212692260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([110707, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04651212692260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04651212692260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05999898910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05999898910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08734273910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27822, 256])
h_self size  torch.Size([27822, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08734273910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27822, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11468648910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08734273910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27822, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11468648910522461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12131977081298828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27822
----------------output nodes number: 3163
----------------edges number: 73706
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1215510368347168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1215510368347168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12514066696166992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12514066696166992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12569475173950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12569475173950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12624883651733398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12569475173950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12572240829467773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12627696990966797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05110788345336914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 2 input nodes size: 89459
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042942047119140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042942047119140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07626819610595703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07629156112670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03502607345581055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03849935531616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03849935531616211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 89459
first layer output nodes number: 30468
edges number: 290283
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03939342498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([89459, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03939342498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03939342498779297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05302095413208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05302095413208008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0820775032043457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30468, 256])
h_self size  torch.Size([30468, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0820775032043457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30468, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11113405227661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0820775032043457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30468, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11113405227661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11839818954467773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30468
----------------output nodes number: 3133
----------------edges number: 75360
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11864900588989258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11864900588989258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1222224235534668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1222224235534668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1227712631225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3133, 47])
h_self size  torch.Size([3133, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1227712631225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3133, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12332010269165039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1227712631225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3133, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12276601791381836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12331533432006836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04316520690917969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 3 input nodes size: 76008
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03502082824707031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06333637237548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06336021423339844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030010700225830078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032285213470458984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032285213470458984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 76008
first layer output nodes number: 23804
edges number: 230870
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03302907943725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([76008, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03302907943725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03302907943725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04370594024658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04370594024658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0664072036743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([23804, 256])
h_self size  torch.Size([23804, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0664072036743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23804, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08910846710205078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0664072036743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23804, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08910846710205078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09478378295898438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 23804
----------------output nodes number: 3163
----------------edges number: 74296
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0949850082397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0949850082397461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09857940673828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09857940673828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09913349151611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09913349151611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09968757629394531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09913349151611328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09913873672485352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09969329833984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03625345230102539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 4 input nodes size: 96797
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030015945434570312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030015945434570312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06607580184936523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06609964370727539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037760257720947266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04132652282714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04132652282714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 96797
first layer output nodes number: 28574
edges number: 276199
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04226112365722656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([96797, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04226112365722656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04226112365722656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055115699768066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055115699768066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0824594497680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28574, 256])
h_self size  torch.Size([28574, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0824594497680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28574, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1098031997680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0824594497680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28574, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1098031997680664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11661577224731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28574
----------------output nodes number: 3140
----------------edges number: 75567
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1168527603149414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1168527603149414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12043476104736328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12043476104736328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12098455429077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3140, 47])
h_self size  torch.Size([3140, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12098455429077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3140, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12153434753417969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12098455429077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3140, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12098026275634766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12153053283691406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045949459075927734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 5 input nodes size: 144348
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03775596618652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03775596618652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09244346618652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0924673080444336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056383609771728516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05961942672729492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05961942672729492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 144348
first layer output nodes number: 37181
edges number: 358557
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06097221374511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([144348, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06097221374511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06097221374511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07763433456420898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07763433456420898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11309289932250977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([37181, 256])
h_self size  torch.Size([37181, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11309289932250977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37181, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14855146408081055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11309289932250977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([37181, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14855146408081055  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15801477432250977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 37181
----------------output nodes number: 3160
----------------edges number: 75611
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15831565856933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15831565856933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16191673278808594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16191673278808594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16247034072875977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3160, 47])
h_self size  torch.Size([3160, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16247034072875977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1630239486694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16247034072875977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3160, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1624741554260254  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16302824020385742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06536579132080078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 6 input nodes size: 94849
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05638742446899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05638742446899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0917215347290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09174489974975586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0370335578918457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03965330123901367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 94849
first layer output nodes number: 28377
edges number: 275806
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040572166442871094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([94849, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040572166442871094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040572166442871094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05406999588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05406999588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08141374588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28377, 256])
h_self size  torch.Size([28377, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08141374588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28377, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10875749588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08141374588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28377, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10875749588012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1155233383178711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28377
----------------output nodes number: 3099
----------------edges number: 75681
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11575841903686523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11575841903686523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11930227279663086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11930227279663086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11984491348266602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3099, 47])
h_self size  torch.Size([3099, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11984491348266602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3099, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12038755416870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11984491348266602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3099, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11983394622802734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1203770637512207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04496955871582031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 7 input nodes size: 79785
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03702259063720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03702259063720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06674528121948242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06676816940307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03141069412231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0338139533996582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 79785
first layer output nodes number: 25038
edges number: 247232
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034595489501953125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([79785, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034595489501953125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.034595489501953125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04585886001586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04585886001586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06973695755004883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25038, 256])
h_self size  torch.Size([25038, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06973695755004883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25038, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09361505508422852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06973695755004883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25038, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09361505508422852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09958457946777344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25038
----------------output nodes number: 3034
----------------edges number: 75224
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09979438781738281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10384368896484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10384368896484375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10437536239624023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3034, 47])
h_self size  torch.Size([3034, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10437536239624023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3034, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10490703582763672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10437536239624023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3034, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10436439514160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10489654541015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03795671463012695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 8 input nodes size: 129022
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03139972686767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03139972686767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08022785186767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08025121688842773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050505638122558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05373382568359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05373382568359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 129022
first layer output nodes number: 36934
edges number: 357643
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054970741271972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([129022, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054970741271972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054970741271972656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.071533203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.071533203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36934, 256])
h_self size  torch.Size([36934, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36934, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14197921752929688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10675621032714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36934, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14197921752929688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1510324478149414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36934
----------------output nodes number: 3129
----------------edges number: 75475
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15133142471313477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15133142471313477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15575742721557617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15575742721557617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15630531311035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3129, 47])
h_self size  torch.Size([3129, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15630531311035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3129, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15685319900512695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15630531311035156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3129, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15632152557373047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15686988830566406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05936431884765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 9 input nodes size: 110995
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0505218505859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0505218505859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09187078475952148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09189462661743164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04304313659667969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04584217071533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04584217071533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 110995
first layer output nodes number: 30942
edges number: 299185
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046900272369384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([110995, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046900272369384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046900272369384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061000823974609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061000823974609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09050941467285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30942, 256])
h_self size  torch.Size([30942, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09050941467285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30942, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12001800537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09050941467285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30942, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12001800537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1273951530456543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30942
----------------output nodes number: 3163
----------------edges number: 76357
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12764978408813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12764978408813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13125944137573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13125944137573242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13181352615356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13181352615356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13236761093139648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13181352615356445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1318197250366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13237428665161133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05100059509277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 10 input nodes size: 112112
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04304933547973633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04304933547973633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08481454849243164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0848383903503418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043465614318847656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04620170593261719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04620170593261719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 112112
first layer output nodes number: 30460
edges number: 291547
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04726409912109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([112112, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04726409912109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04726409912109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06166219711303711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06166219711303711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09071111679077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30460, 256])
h_self size  torch.Size([30460, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09071111679077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30460, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09071111679077148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30460, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11976003646850586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1279439926147461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30460
----------------output nodes number: 3161
----------------edges number: 75570
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12819480895996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12819480895996094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13179683685302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13179683685302734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13235044479370117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13235044479370117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.132904052734375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13235044479370117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13234996795654297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.132904052734375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051817893981933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 11 input nodes size: 115429
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04346513748168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04346513748168945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08646583557128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08648824691772461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04469919204711914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04823017120361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04823017120361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 115429
first layer output nodes number: 29498
edges number: 286425
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04931020736694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([115429, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04931020736694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04931020736694336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06254863739013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06254863739013672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09068012237548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29498, 256])
h_self size  torch.Size([29498, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09068012237548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29498, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11881160736083984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09068012237548828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29498, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11881160736083984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12584447860717773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29498
----------------output nodes number: 2995
----------------edges number: 72706
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12608671188354492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12608671188354492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12977075576782227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12977075576782227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1302952766418457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2995, 47])
h_self size  torch.Size([2995, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1302952766418457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2995, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13081979751586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1302952766418457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2995, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1302661895751953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13079118728637695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052979469299316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 12 input nodes size: 83081
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04467010498046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04467010498046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07592010498046875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0759434700012207  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03292036056518555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0353245735168457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0353245735168457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 83081
first layer output nodes number: 25551
edges number: 247696
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03613471984863281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([83081, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03613471984863281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03613471984863281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04759502410888672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04759502410888672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07196235656738281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25551, 256])
h_self size  torch.Size([25551, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07196235656738281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25551, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0963296890258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07196235656738281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25551, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0963296890258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10242176055908203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25551
----------------output nodes number: 3117
----------------edges number: 74772
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10263586044311523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10263586044311523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10619401931762695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10619401931762695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10673999786376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3117, 47])
h_self size  torch.Size([3117, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10673999786376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3117, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10728597640991211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10673999786376953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3117, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10676145553588867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10730791091918945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0395350456237793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 13 input nodes size: 131025
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03294181823730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03294181823730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08176994323730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08179235458374023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05051898956298828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05357646942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05357646942138672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 131025
first layer output nodes number: 34851
edges number: 338494
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05481290817260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([131025, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05481290817260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05481290817260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0704488754272461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0704488754272461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10368537902832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34851, 256])
h_self size  torch.Size([34851, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10368537902832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34851, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13692188262939453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10368537902832031  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34851, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13692188262939453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1461181640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34851
----------------output nodes number: 2981
----------------edges number: 71785
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14640045166015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14640045166015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14980125427246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14980125427246094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15032339096069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15032339096069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15084552764892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15032339096069336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1502995491027832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15082216262817383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05893564224243164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 14 input nodes size: 103304
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08955764770507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08958005905151367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04323005676269531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04323005676269531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 103304
first layer output nodes number: 27246
edges number: 262898
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04420328140258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([103304, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04420328140258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04420328140258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056980133056640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08296394348144531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27246, 256])
h_self size  torch.Size([27246, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08296394348144531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27246, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10894775390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08296394348144531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27246, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10894775390625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11544370651245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27246
----------------output nodes number: 2982
----------------edges number: 72673
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11566925048828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11566925048828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11907768249511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11907768249511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11959981918334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11959981918334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12012195587158203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11959981918334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11959981918334961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12012243270874023  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048252105712890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 15 input nodes size: 95578
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07633543014526367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07635784149169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03727293014526367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03976583480834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03976583480834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 95578
first layer output nodes number: 27204
edges number: 262558
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04068136215209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([95578, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04068136215209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04068136215209961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0540013313293457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0540013313293457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07994508743286133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27204, 256])
h_self size  torch.Size([27204, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07994508743286133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27204, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10588884353637695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07994508743286133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27204, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10588884353637695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11237478256225586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27204
----------------output nodes number: 2984
----------------edges number: 71834
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11260032653808594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11260032653808594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11600494384765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11600494384765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11652755737304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2984, 47])
h_self size  torch.Size([2984, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11652755737304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2984, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1170501708984375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11652755737304688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2984, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11652803421020508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1170511245727539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04527759552001953  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 16 input nodes size: 103112
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037273406982421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037273406982421875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07633590698242188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07635974884033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04073143005371094  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04318046569824219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04318046569824219  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 103112
first layer output nodes number: 25712
edges number: 251487
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04414081573486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([103112, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04414081573486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04414081573486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055689334869384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055689334869384766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08021020889282227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25712, 256])
h_self size  torch.Size([25712, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08021020889282227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25712, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10473108291625977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08021020889282227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25712, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10473108291625977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11086130142211914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25712
----------------output nodes number: 3146
----------------edges number: 77066
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11107683181762695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11107683181762695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11467599868774414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11467599868774414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11522722244262695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3146, 47])
h_self size  torch.Size([3146, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11522722244262695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3146, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11577844619750977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11522722244262695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3146, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11525583267211914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11580753326416016  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047612667083740234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 17 input nodes size: 176801
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040760040283203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040760040283203125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10716629028320312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10718870162963867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06810235977172852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07142972946166992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07142972946166992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 176801
first layer output nodes number: 38153
edges number: 373860
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07303190231323242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([176801, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07303190231323242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07303190231323242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09017372131347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09017372131347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12655925750732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([38153, 256])
h_self size  torch.Size([38153, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12655925750732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38153, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16294479370117188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12655925750732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([38153, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16294479370117188  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1720414161682129  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 38153
----------------output nodes number: 2981
----------------edges number: 72635
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1723484992980957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1723484992980957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17575597763061523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17575597763061523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17627811431884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17627811431884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17680025100708008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17627811431884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17624902725219727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1767716407775879  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07747554779052734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 18 input nodes size: 114356
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06807327270507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06807327270507812  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11067438125610352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11069822311401367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044269561767578125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04716920852661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04716920852661133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 114356
first layer output nodes number: 30826
edges number: 301782
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04825115203857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([114356, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04825115203857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04825115203857422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06209850311279297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06209850311279297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09149646759033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30826, 256])
h_self size  torch.Size([30826, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09149646759033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30826, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1208944320678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09149646759033203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30826, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1208944320678711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12824392318725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30826
----------------output nodes number: 3152
----------------edges number: 77589
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12849760055541992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12849760055541992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13210630416870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13210630416870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1326584815979004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3152, 47])
h_self size  torch.Size([3152, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1326584815979004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3152, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1332106590270996  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1326584815979004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3152, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1326885223388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1332411766052246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05218315124511719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 19 input nodes size: 155593
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04429960250854492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04429960250854492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10226297378540039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10228538513183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05966043472290039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06278371810913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06278371810913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 155593
first layer output nodes number: 35759
edges number: 347301
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06433963775634766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([155593, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06433963775634766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06433963775634766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803828239440918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803828239440918  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11448526382446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([35759, 256])
h_self size  torch.Size([35759, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11448526382446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35759, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14858770370483398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11448526382446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([35759, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14858770370483398  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15711355209350586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 35759
----------------output nodes number: 2981
----------------edges number: 71750
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15740251541137695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15740251541137695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16080331802368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16080331802368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16132545471191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16132545471191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16184759140014648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16132545471191406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16129541397094727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1618180274963379  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06853532791137695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 20 input nodes size: 116891
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059630393981933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059630393981933594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10317611694335938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10319900512695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04521322250366211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04832744598388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04832744598388672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 116891
first layer output nodes number: 32087
edges number: 317494
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494379997253418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([116891, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494379997253418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0494379997253418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06435728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06435728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09560728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32087, 256])
h_self size  torch.Size([32087, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09560728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32087, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12685728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09560728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32087, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12685728073120117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1345076560974121  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32087
----------------output nodes number: 3009
----------------edges number: 74370
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13476991653442383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13476991653442383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13821744918823242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13821744918823242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13874435424804688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3009, 47])
h_self size  torch.Size([3009, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13874435424804688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3009, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13927125930786133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13874435424804688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3009, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1387491226196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13927650451660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05391216278076172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 21 input nodes size: 96491
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04521799087524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04521799087524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08116388320922852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08118677139282227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037618160247802734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04019594192504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04019594192504883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 96491
first layer output nodes number: 27596
edges number: 271541
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04112100601196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([96491, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04112100601196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04112100601196289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05403566360473633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05403566360473633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803532600402832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27596, 256])
h_self size  torch.Size([27596, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803532600402832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27596, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10667085647583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0803532600402832  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27596, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10667085647583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1132502555847168  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27596
----------------output nodes number: 3017
----------------edges number: 74245
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1134791374206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1134791374206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11693334579467773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11693334579467773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174616813659668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3017, 47])
h_self size  torch.Size([3017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174616813659668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11799001693725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174616813659668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174631118774414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11799192428588867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.045207977294921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 22 input nodes size: 99650
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037619590759277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037619590759277344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07474231719970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07476615905761719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03879737854003906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04239654541015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04239654541015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 99650
first layer output nodes number: 29788
edges number: 291832
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043361663818359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([99650, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043361663818359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043361663818359375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05674409866333008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05674409866333008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515214920043945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29788, 256])
h_self size  torch.Size([29788, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515214920043945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29788, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11356019973754883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515214920043945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29788, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11356019973754883  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12066221237182617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29788
----------------output nodes number: 3138
----------------edges number: 76721
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12090826034545898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12090826034545898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1244969367980957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1244969367980957  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1250467300415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3138, 47])
h_self size  torch.Size([3138, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1250467300415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1255965232849121  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1250467300415039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12506818771362305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12561845779418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04718208312988281  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 23 input nodes size: 158752
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0388188362121582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0388188362121582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09795856475830078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09798145294189453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06083488464355469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0642242431640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0642242431640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 158752
first layer output nodes number: 39578
edges number: 382660
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([158752, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08367013931274414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08367013931274414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1214146614074707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([39578, 256])
h_self size  torch.Size([39578, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1214146614074707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39578, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15915918350219727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1214146614074707  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39578, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15915918350219727  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1685953140258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 39578
----------------output nodes number: 3010
----------------edges number: 72155
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1689133644104004  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17234468460083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17234468460083008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17287206649780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3010, 47])
h_self size  torch.Size([3010, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17287206649780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3010, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1733994483947754  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17287206649780273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3010, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1728496551513672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17337751388549805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07045650482177734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 24 input nodes size: 101877
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06081247329711914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06081247329711914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09876489639282227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09878730773925781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039624691009521484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042356014251708984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042356014251708984  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 101877
first layer output nodes number: 30937
edges number: 298683
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04334592819213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([101877, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04334592819213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04334592819213867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05721235275268555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05721235275268555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0867161750793457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30937, 256])
h_self size  torch.Size([30937, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0867161750793457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30937, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11621999740600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0867161750793457  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30937, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11621999740600586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12359619140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30937
----------------output nodes number: 2981
----------------edges number: 67744
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12384939193725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12384939193725586  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12731504440307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12731504440307617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1278371810913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1278371810913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12835931777954102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1278371810913086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12783193588256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12835454940795898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0470728874206543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 25 input nodes size: 113254
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03961944580078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03961944580078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08180999755859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0818324089050293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043857574462890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047120094299316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047120094299316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 113254
first layer output nodes number: 29704
edges number: 290816
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04818582534790039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([113254, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04818582534790039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04818582534790039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06152963638305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06152963638305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08985757827758789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([29704, 256])
h_self size  torch.Size([29704, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08985757827758789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29704, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11818552017211914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08985757827758789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([29704, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11818552017211914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12526750564575195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 29704
----------------output nodes number: 2981
----------------edges number: 71239
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12551164627075195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12551164627075195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12898778915405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12898778915405273  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12950992584228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12950992584228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13003206253051758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12950992584228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12950992584228516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13003253936767578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051892757415771484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 26 input nodes size: 78396
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043857574462890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043857574462890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07306241989135742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07308530807495117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030872344970703125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033143043518066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033143043518066406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 78396
first layer output nodes number: 23350
edges number: 228850
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033901214599609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([78396, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033901214599609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033901214599609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04439258575439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04439258575439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06666088104248047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([23350, 256])
h_self size  torch.Size([23350, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06666088104248047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23350, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0889291763305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06666088104248047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([23350, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0889291763305664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09449625015258789  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 23350
----------------output nodes number: 3066
----------------edges number: 75782
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09469318389892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09469318389892578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09820556640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09820556640625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09874248504638672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3066, 47])
h_self size  torch.Size([3066, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09874248504638672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3066, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09927940368652344  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09874248504638672  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3066, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09875726699829102  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09929466247558594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03713512420654297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 27 input nodes size: 95890
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030887126922607422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030887126922607422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06660938262939453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06663322448730469  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03740549087524414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03997373580932617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03997373580932617  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 95890
first layer output nodes number: 27470
edges number: 268007
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0408935546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([95890, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0408935546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0408935546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054058074951171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054058074951171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08025550842285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([27470, 256])
h_self size  torch.Size([27470, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08025550842285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27470, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10645294189453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08025550842285156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([27470, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10645294189453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11300230026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 27470
----------------output nodes number: 3138
----------------edges number: 76641
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11323118209838867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11323118209838867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11681890487670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11681890487670898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11736869812011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3138, 47])
h_self size  torch.Size([3138, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11736869812011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11791849136352539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11736869812011719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3138, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11738157272338867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11793184280395508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04532337188720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 28 input nodes size: 105702
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037418365478515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037418365478515625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07679557800292969  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07681798934936523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04107189178466797  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043786048889160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043786048889160156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 105702
first layer output nodes number: 30117
edges number: 293730
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04479837417602539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([105702, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04479837417602539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04479837417602539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058319091796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058319091796875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08704090118408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30117, 256])
h_self size  torch.Size([30117, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08704090118408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30117, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11576271057128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08704090118408203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30117, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11576271057128906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12294340133666992  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30117
----------------output nodes number: 2990
----------------edges number: 70415
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12319040298461914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12319040298461914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12659025192260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12659025192260742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12711381912231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2990, 47])
h_self size  torch.Size([2990, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12711381912231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2990, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12763738632202148  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12711381912231445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2990, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12708759307861328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12761163711547852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04849529266357422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 29 input nodes size: 130431
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0410456657409668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0410456657409668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0898737907409668  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08989620208740234  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050496578216552734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05350351333618164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05350351333618164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 130431
first layer output nodes number: 33773
edges number: 331888
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05472707748413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([130431, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05472707748413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05472707748413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06990766525268555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06990766525268555  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10211610794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([33773, 256])
h_self size  torch.Size([33773, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10211610794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33773, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1343245506286621  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10211610794067383  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([33773, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1343245506286621  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14237689971923828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 33773
----------------output nodes number: 2981
----------------edges number: 71606
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14265108108520508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14265108108520508  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14605093002319336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14605093002319336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14657306671142578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14657306671142578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1470952033996582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14657306671142578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14657163619995117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1470942497253418  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05880403518676758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 30 input nodes size: 90087
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08405542373657227  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08407783508300781  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035227298736572266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03769731521606445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03769731521606445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 90087
first layer output nodes number: 26756
edges number: 260642
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03856849670410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([90087, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03856849670410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03856849670410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050579071044921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050579071044921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0760955810546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([26756, 256])
h_self size  torch.Size([26756, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0760955810546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26756, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10161209106445312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0760955810546875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([26756, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10161209106445312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10799121856689453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 26756
----------------output nodes number: 2981
----------------edges number: 70660
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10821342468261719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10821342468261719  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11160659790039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11160659790039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11212873458862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11212873458862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11265087127685547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11212873458862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11212873458862305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11265134811401367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04199981689453125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 31 input nodes size: 86428
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035227298736572266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035227298736572266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06742429733276367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06744718551635742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033864498138427734  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03735685348510742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03735685348510742  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 86428
first layer output nodes number: 28818
edges number: 281236
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03821611404418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([86428, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03821611404418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03821611404418945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051156044006347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051156044006347656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07863903045654297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([28818, 256])
h_self size  torch.Size([28818, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07863903045654297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28818, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10612201690673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07863903045654297  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([28818, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10612201690673828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11299276351928711  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 28818
----------------output nodes number: 3009
----------------edges number: 71540
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11323070526123047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11323070526123047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1175537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1175537109375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808061599731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3009, 47])
h_self size  torch.Size([3009, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808061599731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3009, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1186075210571289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808061599731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3009, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11808538436889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11861276626586914  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041848182678222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 32 input nodes size: 132174
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033869266510009766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033869266510009766  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08310794830322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0831303596496582  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05091047286987305  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05386209487915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05386209487915039  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 132174
first layer output nodes number: 32863
edges number: 322513
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([132174, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05509233474731445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07071971893310547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07071971893310547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10206031799316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([32863, 256])
h_self size  torch.Size([32863, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10206031799316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32863, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13340091705322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10206031799316406  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([32863, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13340091705322266  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1412363052368164  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 32863
----------------output nodes number: 3003
----------------edges number: 73565
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14150381088256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14150381088256836  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14493894577026367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14493894577026367  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14546489715576172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3003, 47])
h_self size  torch.Size([3003, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14546489715576172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3003, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14599084854125977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14546489715576172  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3003, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1454639434814453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14599037170410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05997419357299805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 33 input nodes size: 117037
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05090951919555664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05090951919555664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09450960159301758  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09453344345092773  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0452723503112793  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857492446899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857492446899414  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 117037
first layer output nodes number: 36683
edges number: 364203
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04972076416015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([117037, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04972076416015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04972076416015625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0662374496459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0662374496459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1013936996459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([36683, 256])
h_self size  torch.Size([36683, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1013936996459961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36683, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13637733459472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10122108459472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([36683, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13637733459472656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14538192749023438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 36683
----------------output nodes number: 3162
----------------edges number: 78967
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14567947387695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14567947387695312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1493072509765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1493072509765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14986133575439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14986133575439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15041542053222656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14986133575439453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14988946914672852  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15044403076171875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054223060607910156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 34 input nodes size: 83652
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04530048370361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04530048370361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07655048370361328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07657337188720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03294944763183594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03541088104248047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03541088104248047  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 83652
first layer output nodes number: 25815
edges number: 255175
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03622722625732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([83652, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03622722625732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03622722625732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04784202575683594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04784202575683594  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07246112823486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([25815, 256])
h_self size  torch.Size([25815, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07246112823486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25815, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09708023071289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07246112823486328  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([25815, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09708023071289062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10323524475097656  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 25815
----------------output nodes number: 3019
----------------edges number: 75121
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10345077514648438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10345077514648438  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10691261291503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10691261291503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10744142532348633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3019, 47])
h_self size  torch.Size([3019, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10744142532348633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3019, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1079702377319336  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10744142532348633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3019, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10741615295410156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10794544219970703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0396428108215332  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 35 input nodes size: 119717
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03292417526245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03292417526245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07784605026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07786893844604492  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04659605026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04937601089477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04937601089477539  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 119717
first layer output nodes number: 30249
edges number: 297552
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050493717193603516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([119717, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050493717193603516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050493717193603516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06409311294555664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06409311294555664  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0929408073425293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([30249, 256])
h_self size  torch.Size([30249, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0929408073425293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30249, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12178850173950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0929408073425293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([30249, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12178850173950195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12900066375732422  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 30249
----------------output nodes number: 3052
----------------edges number: 75423
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12924909591674805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12924909591674805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13296890258789062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13296890258789062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13350343704223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3052, 47])
h_self size  torch.Size([3052, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13350343704223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3052, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13403797149658203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13350343704223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3052, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13350915908813477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13404417037963867  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054327964782714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 36 input nodes size: 155187
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04660177230834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04660177230834961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10441350936889648  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10443592071533203  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05949115753173828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06277942657470703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06277942657470703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 155187
first layer output nodes number: 34379
edges number: 340499
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06419229507446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([155187, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06419229507446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06419229507446289  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0796656608581543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0796656608581543  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11245203018188477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34379, 256])
h_self size  torch.Size([34379, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11245203018188477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34379, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14523839950561523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11245203018188477  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34379, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14523839950561523  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15343523025512695  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34379
----------------output nodes number: 2981
----------------edges number: 74153
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15371417999267578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15371417999267578  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1571331024169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1571331024169922  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1576552391052246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1576552391052246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15817737579345703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1576552391052246  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15764284133911133  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15816545486450195  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06837081909179688  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 37 input nodes size: 119999
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059478759765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059478759765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.104400634765625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10442352294921875  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04658937454223633  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049726009368896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.049726009368896484  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 119999
first layer output nodes number: 34887
edges number: 345845
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05088043212890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([119999, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05088043212890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05088043212890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06658411026000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06658411026000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09985494613647461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([34887, 256])
h_self size  torch.Size([34887, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09985494613647461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34887, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13312578201293945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09985494613647461  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([34887, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13312578201293945  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14226770401000977  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 34887
----------------output nodes number: 3020
----------------edges number: 75058
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14255094528198242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14255094528198242  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14601373672485352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14601373672485352  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14654254913330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3020, 47])
h_self size  torch.Size([3020, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14654254913330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3020, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14707136154174805  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14654254913330078  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3020, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14654922485351562  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1470785140991211  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055138587951660156  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 38 input nodes size: 160329
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04659605026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04659605026245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10714292526245117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10716629028320312  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.062221527099609375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06574058532714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06574058532714844  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 160329
first layer output nodes number: 39737
edges number: 394447
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06723165512084961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([160329, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06723165512084961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06723165512084961  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08512258529663086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08512258529663086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12301874160766602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([39737, 256])
h_self size  torch.Size([39737, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12301874160766602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39737, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16091489791870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12301874160766602  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([39737, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16091489791870117  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17038917541503906  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 39737
----------------output nodes number: 3129
----------------edges number: 77800
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17070865631103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17070865631103516  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17429637908935547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17429637908935547  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17484426498413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3129, 47])
h_self size  torch.Size([3129, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17484426498413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3129, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17539215087890625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17484426498413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3129, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17486333847045898  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17541170120239258  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07197761535644531  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

pseudo mini batch 39 input nodes size: 205864
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0622406005859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0622406005859375  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1389312744140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13895463943481445  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0783843994140625  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0824270248413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0824270248413086  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

first layer input nodes number: 205864
first layer output nodes number: 46776
edges number: 464788
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08430957794189453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([205864, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08430957794189453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08430957794189453  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10574722290039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10574722290039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15066909790039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([46776, 256])
h_self size  torch.Size([46776, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15066909790039062  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([46776, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19527816772460938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15035629272460938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([46776, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19527816772460938  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2061176300048828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------input nodes number: 46776
----------------output nodes number: 3122
----------------edges number: 77607
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.20648956298828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.20648956298828125  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2100696563720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2100696563720703  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2106165885925293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

h_neigh size torch.Size([3122, 47])
h_self size  torch.Size([3122, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2106165885925293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.21116352081298828  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2106165885925293  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

torch.Size([3122, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.2106156349182129  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.21116304397583008  GigaBytes
Max Memory Allocated: 0.29141712188720703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09003686904907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 40 input nodes size: 103243
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0783834457397461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0783834457397461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1174459457397461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11746835708618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04075431823730469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04261970520019531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04261970520019531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 103243
first layer output nodes number: 20264
edges number: 195667
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04354047775268555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([103243, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04354047775268555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04354047775268555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052623748779296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052623748779296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07194900512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([20264, 256])
h_self size  torch.Size([20264, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07194900512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([20264, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09127426147460938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07194900512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([20264, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09127426147460938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09610557556152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 20264
----------------output nodes number: 2992
----------------edges number: 54643
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09627914428710938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09627914428710938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0995626449584961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0995626449584961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10008668899536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2992, 47])
h_self size  torch.Size([2992, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10008668899536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10061073303222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10008668899536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10006380081176758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10058832168579102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0461268424987793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 41 input nodes size: 147933
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04073143005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04073143005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0958409309387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09586334228515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0567784309387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0593876838684082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0593876838684082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 147933
first layer output nodes number: 29822
edges number: 289031
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060712337493896484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([147933, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060712337493896484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060712337493896484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07411384582519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07411384582519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29822, 256])
h_self size  torch.Size([29822, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29822, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1309947967529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1025543212890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29822, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1309947967529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13810491561889648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29822
----------------output nodes number: 3003
----------------edges number: 60997
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1383495330810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1383495330810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1416912078857422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1416912078857422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14221715927124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3003, 47])
h_self size  torch.Size([3003, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14221715927124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3003, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14274311065673828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14221715927124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3003, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14221906661987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1427454948425293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06428289413452148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 42 input nodes size: 101519
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056780338287353516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056780338287353516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09459924697875977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09462165832519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03948974609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041861534118652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041861534118652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 101519
first layer output nodes number: 24975
edges number: 245582
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042804718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([101519, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042804718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042804718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054032325744628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054032325744628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.077850341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24975, 256])
h_self size  torch.Size([24975, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.077850341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24975, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1016683578491211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.077850341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24975, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1016683578491211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10762310028076172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24975
----------------output nodes number: 3000
----------------edges number: 72642
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10783195495605469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10783195495605469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1119222640991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1119222640991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11244773864746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3000, 47])
h_self size  torch.Size([3000, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11244773864746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3000, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11297321319580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11244773864746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3000, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11244726181030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11297321319580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046124935150146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 43 input nodes size: 114714
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0394892692565918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0394892692565918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08222389221191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08224630355834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04440498352050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04718971252441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04718971252441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 114714
first layer output nodes number: 30297
edges number: 300295
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04827070236206055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([114714, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04827070236206055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04827070236206055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061908721923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061908721923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09080219268798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30297, 256])
h_self size  torch.Size([30297, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09080219268798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30297, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11969566345214844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09080219268798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30297, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11969566345214844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12691926956176758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30297
----------------output nodes number: 2982
----------------edges number: 73254
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1271677017211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1271677017211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13058090209960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13058090209960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1311030387878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1311030387878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13162517547607422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1311030387878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13109970092773438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.131622314453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05208444595336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 44 input nodes size: 147024
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04440164566040039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04440164566040039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09917259216308594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0991964340209961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05643939971923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0595855712890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0595855712890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 147024
first layer output nodes number: 34757
edges number: 345042
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06094074249267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([147024, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06094074249267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06094074249267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07756853103637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07756853103637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11071538925170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34757, 256])
h_self size  torch.Size([34757, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11071538925170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34757, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14386224746704102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11071538925170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34757, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14386224746704102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15214920043945312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34757
----------------output nodes number: 3163
----------------edges number: 77094
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15243244171142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15243244171142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15604782104492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15604782104492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1566019058227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1566019058227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15715599060058594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1566019058227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15663385391235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15718841552734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06622743606567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 45 input nodes size: 133631
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05647134780883789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05647134780883789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10625314712524414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1062765121459961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05148172378540039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054753780364990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054753780364990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 133631
first layer output nodes number: 36827
edges number: 362573
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05602407455444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([133631, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05602407455444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05602407455444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07258272171020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07258272171020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10773897171020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36827, 256])
h_self size  torch.Size([36827, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10773897171020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36827, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14285993576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10770368576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36827, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14285993576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1516404151916504  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36827
----------------output nodes number: 3123
----------------edges number: 76451
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15193843841552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15193843841552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15647411346435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15647411346435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15702104568481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3123, 47])
h_self size  torch.Size([3123, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15702104568481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3123, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15756797790527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15702104568481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3123, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1570138931274414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1575613021850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060443878173828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 46 input nodes size: 124146
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051474571228027344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051474571228027344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09834957122802734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0983734130859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0485682487487793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05180215835571289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05180215835571289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 124146
first layer output nodes number: 35747
edges number: 355711
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0529937744140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([124146, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0529937744140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0529937744140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06909465789794922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06909465789794922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10318565368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35747, 256])
h_self size  torch.Size([35747, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10318565368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35747, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13727664947509766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10318565368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35747, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13727664947509766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1463451385498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35747
----------------output nodes number: 3137
----------------edges number: 78259
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1466355323791504  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1466355323791504  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15023469924926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15023469924926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15078401565551758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3137, 47])
h_self size  torch.Size([3137, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15078401565551758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15133333206176758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15078401565551758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1507863998413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1513361930847168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057383060455322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 47 input nodes size: 125005
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857063293457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857063293457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0951390266418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09516286849975586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0482640266418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05139303207397461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05139303207397461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 125005
first layer output nodes number: 34358
edges number: 341333
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052580833435058594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([125005, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052580833435058594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052580833435058594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06805229187011719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06805229187011719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10081863403320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34358, 256])
h_self size  torch.Size([34358, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10081863403320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34358, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13358497619628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10081863403320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34358, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13358497619628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14177656173706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34358
----------------output nodes number: 3157
----------------edges number: 78570
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14205646514892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14205646514892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1456766128540039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1456766128540039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14622974395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3157, 47])
h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14622974395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14678287506103516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14622974395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14623355865478516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14678716659545898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056847572326660156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 48 input nodes size: 143255
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04826784133911133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04826784133911133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10163450241088867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10165786743164062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05506563186645508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058476924896240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.058476924896240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 143255
first layer output nodes number: 38583
edges number: 382289
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060085296630859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([143255, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060085296630859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.060085296630859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07745122909545898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07745122909545898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11424684524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38583, 256])
h_self size  torch.Size([38583, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11424684524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38583, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15104246139526367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11424684524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38583, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15104246139526367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16024160385131836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38583
----------------output nodes number: 3095
----------------edges number: 75407
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1605525016784668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1605525016784668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16409063339233398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16409063339233398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16463279724121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3095, 47])
h_self size  torch.Size([3095, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16463279724121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3095, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1651749610900879  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16463279724121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3095, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16462182998657227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16516447067260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06465911865234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 49 input nodes size: 181041
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055054664611816406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055054664611816406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1224980354309082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12252044677734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06913042068481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07271242141723633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07271242141723633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 181041
first layer output nodes number: 41057
edges number: 406937
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07436752319335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([181041, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07436752319335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07436752319335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09372568130493164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09372568130493164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13288068771362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([41057, 256])
h_self size  torch.Size([41057, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13288068771362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([41057, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17203569412231445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13288068771362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([41057, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17203569412231445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1818246841430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 41057
----------------output nodes number: 2981
----------------edges number: 73719
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18215322494506836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18215322494506836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18556833267211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18556833267211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18609046936035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18609046936035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18661260604858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18609046936035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18607044219970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18659305572509766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0800023078918457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 50 input nodes size: 138972
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06911039352416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06911039352416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12088155746459961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12090539932250977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05343961715698242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05694246292114258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05694246292114258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 138972
first layer output nodes number: 36511
edges number: 363206
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05825042724609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([138972, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05825042724609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05825042724609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07469511032104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07469511032104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10985136032104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36511, 256])
h_self size  torch.Size([36511, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10985136032104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36511, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14467096328735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10951471328735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36511, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14467096328735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15337610244750977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36511
----------------output nodes number: 3162
----------------edges number: 78653
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1536722183227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1536722183227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15729808807373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15729808807373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1578521728515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1578521728515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15840625762939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1578521728515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1578841209411621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15843868255615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06274271011352539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 51 input nodes size: 125582
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05347156524658203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05347156524658203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10034656524658203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10036993026733398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857492446899414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051839351654052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051839351654052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 125582
first layer output nodes number: 36444
edges number: 361503
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05304718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([125582, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05304718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05304718017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06945371627807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06945371627807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10460996627807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36444, 256])
h_self size  torch.Size([36444, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10460996627807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36444, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13936567306518555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10420942306518555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36444, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13936567306518555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1483902931213379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36444
----------------output nodes number: 3078
----------------edges number: 76476
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14868545532226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14868545532226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15221500396728516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15221500396728516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1527543067932129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3078, 47])
h_self size  torch.Size([3078, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1527543067932129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3078, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15329360961914062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1527543067932129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3078, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1527395248413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15327930450439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05744600296020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 52 input nodes size: 119745
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048560142517089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048560142517089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09348201751708984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.093505859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04660749435424805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04971742630004883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04971742630004883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 119745
first layer output nodes number: 34087
edges number: 338454
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050864219665527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([119745, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050864219665527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050864219665527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06621265411376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06621265411376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09872055053710938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34087, 256])
h_self size  torch.Size([34087, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09872055053710938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34087, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13122844696044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09872055053710938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34087, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13122844696044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13935565948486328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34087
----------------output nodes number: 3155
----------------edges number: 78792
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396336555480957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396336555480957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14325380325317383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14325380325317383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3155, 47])
h_self size  torch.Size([3155, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3155, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14435911178588867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14380645751953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3155, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14381980895996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14437294006347656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05511951446533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 53 input nodes size: 109453
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046620845794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046620845794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08739566802978516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08741950988769531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042473793029785156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0455780029296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0455780029296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 109453
first layer output nodes number: 34114
edges number: 338406
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046648502349853516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([109453, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046648502349853516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046648502349853516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06200599670410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06200599670410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09453964233398438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34114, 256])
h_self size  torch.Size([34114, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09453964233398438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34114, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1270732879638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09453964233398438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34114, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1270732879638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1352066993713379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34114
----------------output nodes number: 3139
----------------edges number: 78093
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13548517227172852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13548517227172852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1390852928161621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1390852928161621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396350860595703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3139, 47])
h_self size  torch.Size([3139, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396350860595703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3139, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14018487930297852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396350860595703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3139, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1396322250366211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1401824951171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05087757110595703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 54 input nodes size: 101983
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04247093200683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04247093200683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08046293258666992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08048629760742188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0396876335144043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04245138168334961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04245138168334961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 101983
first layer output nodes number: 29729
edges number: 293298
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043433189392089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([101983, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043433189392089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043433189392089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05680513381958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05680513381958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515691757202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29729, 256])
h_self size  torch.Size([29729, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515691757202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29729, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11350870132446289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08515691757202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29729, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11350870132446289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12059688568115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29729
----------------output nodes number: 3135
----------------edges number: 77476
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12084197998046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12084197998046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1247243881225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1247243881225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1252737045288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3135, 47])
h_self size  torch.Size([3135, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1252737045288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3135, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1258230209350586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1252737045288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3135, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1252732276916504  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1258230209350586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04725360870361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 55 input nodes size: 131328
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039687156677246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039687156677246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08861064910888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08863449096679688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05061912536621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05372428894042969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05372428894042969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 131328
first layer output nodes number: 34034
edges number: 338114
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05495643615722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([131328, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05495643615722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05495643615722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07083511352539062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07083511352539062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10329246520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34034, 256])
h_self size  torch.Size([34034, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10329246520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34034, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13574981689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10329246520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34034, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13574981689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14386415481567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34034
----------------output nodes number: 3155
----------------edges number: 78547
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14414167404174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14414167404174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14775991439819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14775991439819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14831256866455078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3155, 47])
h_self size  torch.Size([3155, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14831256866455078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3155, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1488652229309082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14831256866455078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3155, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1483159065246582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14886903762817383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059746742248535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 56 input nodes size: 129973
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05062246322631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05062246322631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09945058822631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09947443008422852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050527095794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 129973
first layer output nodes number: 35063
edges number: 347720
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05493354797363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([129973, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05493354797363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05493354797363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07071733474731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07071733474731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35063, 256])
h_self size  torch.Size([35063, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35063, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13759469985961914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1041560173034668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35063, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13759469985961914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14672231674194336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35063
----------------output nodes number: 3156
----------------edges number: 78570
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14700746536254883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14700746536254883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15062665939331055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15062665939331055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15117931365966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15117931365966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1517319679260254  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15117931365966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15117931365966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1517324447631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05925416946411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 57 input nodes size: 132651
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050527095794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050527095794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09994363784790039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09996652603149414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.051114559173583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054209232330322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.054209232330322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 132651
first layer output nodes number: 34137
edges number: 339504
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05545234680175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([132651, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05545234680175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05545234680175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07180356979370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07180356979370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10435914993286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34137, 256])
h_self size  torch.Size([34137, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10435914993286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34137, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13691473007202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10435914993286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34137, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13691473007202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14505386352539062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34137
----------------output nodes number: 3047
----------------edges number: 75683
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14533138275146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14533138275146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14882469177246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14882469177246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14935827255249023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3047, 47])
h_self size  torch.Size([3047, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14935827255249023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3047, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14989185333251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14935827255249023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3047, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1493391990661621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1498732566833496  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06061267852783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 58 input nodes size: 154355
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05109548568725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05109548568725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1085972785949707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10862064361572266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05918121337890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06280326843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06280326843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 154355
first layer output nodes number: 39966
edges number: 396488
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06425142288208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([154355, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06425142288208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06425142288208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0822439193725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0822439193725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1213064193725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([39966, 256])
h_self size  torch.Size([39966, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1213064193725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([39966, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15942096710205078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12035846710205078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([39966, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15942096710205078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16894960403442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 39966
----------------output nodes number: 3127
----------------edges number: 77356
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16927099227905273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16927099227905273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17369699478149414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17369699478149414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17424488067626953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3127, 47])
h_self size  torch.Size([3127, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17424488067626953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3127, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17479276657104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17424488067626953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3127, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17425918579101562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17480754852294922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06900596618652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 59 input nodes size: 99911
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059195518493652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.059195518493652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09641551971435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09643936157226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03891420364379883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04257535934448242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04257535934448242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 99911
first layer output nodes number: 33357
edges number: 330664
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043569087982177734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([99911, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043569087982177734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043569087982177734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05858469009399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05858469009399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09039640426635742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33357, 256])
h_self size  torch.Size([33357, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09039640426635742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33357, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1222081184387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09039640426635742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33357, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1222081184387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13016128540039062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33357
----------------output nodes number: 3161
----------------edges number: 78629
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1304340362548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1304340362548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13405895233154297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13405895233154297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1346125602722168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1346125602722168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13516616821289062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1346125602722168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13461828231811523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13517236709594727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.047745704650878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 60 input nodes size: 124947
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038919925689697266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038919925689697266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08579492568969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08581733703613281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04857349395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05112743377685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05112743377685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 124947
first layer output nodes number: 27289
edges number: 269766
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052262306213378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([124947, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052262306213378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052262306213378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06485939025878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06485939025878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09088420867919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27289, 256])
h_self size  torch.Size([27289, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09088420867919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27289, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11690902709960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09088420867919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27289, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11690902709960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12341547012329102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27289
----------------output nodes number: 3002
----------------edges number: 72835
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1236414909362793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1236414909362793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12707090377807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12707090377807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12759685516357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3002, 47])
h_self size  torch.Size([3002, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12759685516357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3002, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12812280654907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12759685516357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3002, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12756919860839844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1280956268310547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056092262268066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 61 input nodes size: 148861
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04854583740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04854583740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10400104522705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10402488708496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05712747573852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06042146682739258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06042146682739258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 148861
first layer output nodes number: 36614
edges number: 363691
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06180381774902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([148861, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06180381774902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06180381774902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07829093933105469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07829093933105469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11344718933105469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36614, 256])
h_self size  torch.Size([36614, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11344718933105469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36614, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14836502075195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11320877075195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36614, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14836502075195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15709447860717773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36614
----------------output nodes number: 3162
----------------edges number: 78243
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15739154815673828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15739154815673828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16101455688476562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16101455688476562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16156864166259766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16156864166259766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1621227264404297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16156864166259766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16159677505493164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16215133666992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06629228591918945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 62 input nodes size: 168010
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057155609130859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057155609130859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11974430084228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1197671890258789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06428813934326172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06728076934814453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06728076934814453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 168010
first layer output nodes number: 33310
edges number: 329176
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0688939094543457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([168010, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0688939094543457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0688939094543457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08388042449951172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1156473159790039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33310, 256])
h_self size  torch.Size([33310, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1156473159790039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33310, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1474142074584961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1156473159790039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33310, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1474142074584961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15535593032836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33310
----------------output nodes number: 3014
----------------edges number: 72355
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15562725067138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15562725067138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15996694564819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15996694564819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16049480438232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3014, 47])
h_self size  torch.Size([3014, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16049480438232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3014, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16102266311645508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16049480438232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3014, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16046857833862305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1609969139099121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07293176651000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 63 input nodes size: 148325
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06426191329956055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06426191329956055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11951732635498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11953973770141602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.056928157806396484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0599064826965332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0599064826965332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 148325
first layer output nodes number: 33139
edges number: 326859
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061258792877197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([148325, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061258792877197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.061258792877197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07669591903686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07669591903686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10829973220825195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33139, 256])
h_self size  torch.Size([33139, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10829973220825195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33139, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13990354537963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10829973220825195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33139, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13990354537963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14780473709106445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33139
----------------output nodes number: 2987
----------------edges number: 72831
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14807415008544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14807415008544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15245723724365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15245723724365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15298032760620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2987, 47])
h_self size  torch.Size([2987, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15298032760620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2987, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15350341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15298032760620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2987, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15297555923461914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15349912643432617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06583547592163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06583547592163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06583547592163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019666094332933426 |0.0031895041465759277 |0.01152050867676735 |0.0001446269452571869 |0.0023518837988376617 |0.00305938720703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.0438241958618164
Total (block generation + training)time/epoch 65.47694325447083
Training time/epoch 2.56121826171875
Training time without block to device /epoch 2.3570899963378906
Training time without total dataloading part /epoch 0.9001486301422119
load block tensor time/epoch 1.2586300373077393
block to device time/epoch 0.20412826538085938
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  9828203
Number of first layer input nodes during this epoch:  7773582
Number of first layer output nodes during this epoch:  2054621
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06583499908447266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.25705957412719727
global_2_local spend time (sec) 0.48593616485595703

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.157 seconds
Metis partitioning: 15.327 seconds
Split the graph: 0.833 seconds
Construct subgraphs: 0.370 seconds
3017
3122
2981
2981
2999
2983
2981
3010
3150
3046
3043
2998
2983
3023
3021
3162
3163
3153
3157
3163
2982
3163
3014
3140
3163
2991
2981
2985
3162
3161
3115
3110
3159
2981
3098
3151
3137
3026
2981
3111
3096
2992
3043
3158
3150
3074
3140
2981
2992
2981
3136
3002
2981
3162
3163
2981
3132
3158
3005
3019
3037
3163
3122
3156
REG metis partition end ----................................
the time spent:  28.62380361557007
total k batches seeds list generation spend  29.08386516571045
after graph partition
graph partition algorithm spend time 29.53222131729126

partition_len_list
[27364, 24623, 28907, 30091, 30693, 34733, 25859, 29478, 27320, 23338, 34709, 27147, 38245, 27144, 29524, 36578, 40007, 43810, 33103, 34051, 42316, 40646, 35524, 37412, 33381, 31440, 30083, 29330, 33397, 36628, 37021, 36281, 36509, 37508, 32274, 36854, 37874, 28396, 28839, 30245, 28186, 27320, 32340, 29926, 30547, 35050, 38296, 33732, 31534, 38004, 27910, 27267, 28595, 31161, 34680, 33935, 33795, 35243, 29605, 26143, 35770, 23251, 24381, 29565]
REG selection method  spend 30.238893747329712
check_connections_block*********************************
time for parepare 1: 0.22935152053833008
local_output_nid generation: 0.0012161731719970703
local_in_edges_tensor generation: 0.0014584064483642578
mini_batch_src_global generation: 0.00316619873046875

&&&&&&&&&&&&&&& before remove duplicate length: 73203
r_  generation: 0.024554729461669922

local_output_nid generation: 0.0012688636779785156
local_in_edges_tensor generation: 0.0013575553894042969
mini_batch_src_global generation: 0.003459453582763672

&&&&&&&&&&&&&&& before remove duplicate length: 77140
r_  generation: 0.025981426239013672

local_output_nid generation: 0.001293182373046875
local_in_edges_tensor generation: 0.0012705326080322266
mini_batch_src_global generation: 0.0025496482849121094

&&&&&&&&&&&&&&& before remove duplicate length: 70793
r_  generation: 0.022084474563598633

local_output_nid generation: 0.0013000965118408203
local_in_edges_tensor generation: 0.0012371540069580078
mini_batch_src_global generation: 0.0019497871398925781

&&&&&&&&&&&&&&& before remove duplicate length: 67616
r_  generation: 0.02225470542907715

local_output_nid generation: 0.0013353824615478516
local_in_edges_tensor generation: 0.0012428760528564453
mini_batch_src_global generation: 0.0019545555114746094

&&&&&&&&&&&&&&& before remove duplicate length: 71136
r_  generation: 0.022820234298706055

local_output_nid generation: 0.0013077259063720703
local_in_edges_tensor generation: 0.0012516975402832031
mini_batch_src_global generation: 0.0019469261169433594

&&&&&&&&&&&&&&& before remove duplicate length: 71436
r_  generation: 0.05104231834411621

local_output_nid generation: 0.0013899803161621094
local_in_edges_tensor generation: 0.0014262199401855469
mini_batch_src_global generation: 0.0022716522216796875

&&&&&&&&&&&&&&& before remove duplicate length: 70259
r_  generation: 0.02366781234741211

local_output_nid generation: 0.0013387203216552734
local_in_edges_tensor generation: 0.0013837814331054688
mini_batch_src_global generation: 0.001993417739868164

&&&&&&&&&&&&&&& before remove duplicate length: 71555
r_  generation: 0.02379012107849121

local_output_nid generation: 0.0013751983642578125
local_in_edges_tensor generation: 0.0013132095336914062
mini_batch_src_global generation: 0.0022683143615722656

&&&&&&&&&&&&&&& before remove duplicate length: 76953
r_  generation: 0.025434017181396484

local_output_nid generation: 0.0013544559478759766
local_in_edges_tensor generation: 0.0012710094451904297
mini_batch_src_global generation: 0.002139568328857422

&&&&&&&&&&&&&&& before remove duplicate length: 75245
r_  generation: 0.024482250213623047

local_output_nid generation: 0.001336812973022461
local_in_edges_tensor generation: 0.0013141632080078125
mini_batch_src_global generation: 0.0021958351135253906

&&&&&&&&&&&&&&& before remove duplicate length: 75298
r_  generation: 0.025187015533447266

local_output_nid generation: 0.0013430118560791016
local_in_edges_tensor generation: 0.0012798309326171875
mini_batch_src_global generation: 0.0022029876708984375

&&&&&&&&&&&&&&& before remove duplicate length: 74309
r_  generation: 0.025098562240600586

local_output_nid generation: 0.0013325214385986328
local_in_edges_tensor generation: 0.0013339519500732422
mini_batch_src_global generation: 0.0021407604217529297

&&&&&&&&&&&&&&& before remove duplicate length: 72356
r_  generation: 0.02452874183654785

local_output_nid generation: 0.0013384819030761719
local_in_edges_tensor generation: 0.0013513565063476562
mini_batch_src_global generation: 0.0021500587463378906

&&&&&&&&&&&&&&& before remove duplicate length: 73748
r_  generation: 0.024509906768798828

local_output_nid generation: 0.0013439655303955078
local_in_edges_tensor generation: 0.0012598037719726562
mini_batch_src_global generation: 0.002116680145263672

&&&&&&&&&&&&&&& before remove duplicate length: 74513
r_  generation: 0.024931669235229492

local_output_nid generation: 0.0013980865478515625
local_in_edges_tensor generation: 0.001306772232055664
mini_batch_src_global generation: 0.002278566360473633

&&&&&&&&&&&&&&& before remove duplicate length: 75669
r_  generation: 0.02586078643798828

local_output_nid generation: 0.0013835430145263672
local_in_edges_tensor generation: 0.001333475112915039
mini_batch_src_global generation: 0.0023059844970703125

&&&&&&&&&&&&&&& before remove duplicate length: 78473
r_  generation: 0.05945014953613281

local_output_nid generation: 0.0017070770263671875
local_in_edges_tensor generation: 0.0017178058624267578
mini_batch_src_global generation: 0.003208637237548828

&&&&&&&&&&&&&&& before remove duplicate length: 78045
r_  generation: 0.028101682662963867

local_output_nid generation: 0.0014150142669677734
local_in_edges_tensor generation: 0.00135040283203125
mini_batch_src_global generation: 0.0023169517517089844

&&&&&&&&&&&&&&& before remove duplicate length: 78675
r_  generation: 0.048946380615234375

local_output_nid generation: 0.0029735565185546875
local_in_edges_tensor generation: 0.006531715393066406
mini_batch_src_global generation: 0.0024895668029785156

&&&&&&&&&&&&&&& before remove duplicate length: 78783
r_  generation: 0.027132034301757812

local_output_nid generation: 0.0027022361755371094
local_in_edges_tensor generation: 0.0039653778076171875
mini_batch_src_global generation: 0.0023505687713623047

&&&&&&&&&&&&&&& before remove duplicate length: 71988
r_  generation: 0.047299861907958984

local_output_nid generation: 0.0020966529846191406
local_in_edges_tensor generation: 0.0045239925384521484
mini_batch_src_global generation: 0.003172636032104492

&&&&&&&&&&&&&&& before remove duplicate length: 78739
r_  generation: 0.029959917068481445

local_output_nid generation: 0.0013926029205322266
local_in_edges_tensor generation: 0.0027313232421875
mini_batch_src_global generation: 0.0023071765899658203

&&&&&&&&&&&&&&& before remove duplicate length: 74864
r_  generation: 0.04127812385559082

local_output_nid generation: 0.00193023681640625
local_in_edges_tensor generation: 0.003876924514770508
mini_batch_src_global generation: 0.0049130916595458984

&&&&&&&&&&&&&&& before remove duplicate length: 78062
r_  generation: 0.02996063232421875

local_output_nid generation: 0.0014116764068603516
local_in_edges_tensor generation: 0.0020143985748291016
mini_batch_src_global generation: 0.0023584365844726562

&&&&&&&&&&&&&&& before remove duplicate length: 77736
r_  generation: 0.042376041412353516

local_output_nid generation: 0.0018301010131835938
local_in_edges_tensor generation: 0.0030694007873535156
mini_batch_src_global generation: 0.006606578826904297

&&&&&&&&&&&&&&& before remove duplicate length: 73502
r_  generation: 0.029442787170410156

local_output_nid generation: 0.0013532638549804688
local_in_edges_tensor generation: 0.001825094223022461
mini_batch_src_global generation: 0.0021936893463134766

&&&&&&&&&&&&&&& before remove duplicate length: 73066
r_  generation: 0.024827957153320312

local_output_nid generation: 0.001355886459350586
local_in_edges_tensor generation: 0.0017845630645751953
mini_batch_src_global generation: 0.002205371856689453

&&&&&&&&&&&&&&& before remove duplicate length: 73119
r_  generation: 0.024807453155517578

local_output_nid generation: 0.0014204978942871094
local_in_edges_tensor generation: 0.0015795230865478516
mini_batch_src_global generation: 0.0023148059844970703

&&&&&&&&&&&&&&& before remove duplicate length: 78749
r_  generation: 0.026420116424560547

local_output_nid generation: 0.0014166831970214844
local_in_edges_tensor generation: 0.0016283988952636719
mini_batch_src_global generation: 0.002347707748413086

&&&&&&&&&&&&&&& before remove duplicate length: 78564
r_  generation: 0.027593135833740234

local_output_nid generation: 0.0013959407806396484
local_in_edges_tensor generation: 0.0017025470733642578
mini_batch_src_global generation: 0.002362489700317383

&&&&&&&&&&&&&&& before remove duplicate length: 77491
r_  generation: 0.026712894439697266

local_output_nid generation: 0.0014033317565917969
local_in_edges_tensor generation: 0.0016722679138183594
mini_batch_src_global generation: 0.002389669418334961

&&&&&&&&&&&&&&& before remove duplicate length: 77598
r_  generation: 0.042783260345458984

local_output_nid generation: 0.002405405044555664
local_in_edges_tensor generation: 0.0029914379119873047
mini_batch_src_global generation: 0.008365392684936523

&&&&&&&&&&&&&&& before remove duplicate length: 78870
r_  generation: 0.02941107749938965

local_output_nid generation: 0.0015077590942382812
local_in_edges_tensor generation: 0.0012366771697998047
mini_batch_src_global generation: 0.0023195743560791016

&&&&&&&&&&&&&&& before remove duplicate length: 73799
r_  generation: 0.04705238342285156

local_output_nid generation: 0.0018696784973144531
local_in_edges_tensor generation: 0.001634359359741211
mini_batch_src_global generation: 0.003587484359741211

&&&&&&&&&&&&&&& before remove duplicate length: 76369
r_  generation: 0.02650618553161621

local_output_nid generation: 0.0015094280242919922
local_in_edges_tensor generation: 0.0014922618865966797
mini_batch_src_global generation: 0.002333402633666992

&&&&&&&&&&&&&&& before remove duplicate length: 78640
r_  generation: 0.04212522506713867

local_output_nid generation: 0.0020279884338378906
local_in_edges_tensor generation: 0.0019414424896240234
mini_batch_src_global generation: 0.0056874752044677734

&&&&&&&&&&&&&&& before remove duplicate length: 76764
r_  generation: 0.02898240089416504

local_output_nid generation: 0.0014910697937011719
local_in_edges_tensor generation: 0.0012290477752685547
mini_batch_src_global generation: 0.002277374267578125

&&&&&&&&&&&&&&& before remove duplicate length: 74325
r_  generation: 0.04559803009033203

local_output_nid generation: 0.0019273757934570312
local_in_edges_tensor generation: 0.002017498016357422
mini_batch_src_global generation: 0.004069805145263672

&&&&&&&&&&&&&&& before remove duplicate length: 72619
r_  generation: 0.026193857192993164

local_output_nid generation: 0.0014798641204833984
local_in_edges_tensor generation: 0.001463174819946289
mini_batch_src_global generation: 0.002257108688354492

&&&&&&&&&&&&&&& before remove duplicate length: 75150
r_  generation: 0.04212546348571777

local_output_nid generation: 0.0018832683563232422
local_in_edges_tensor generation: 0.0030481815338134766
mini_batch_src_global generation: 0.003110170364379883

&&&&&&&&&&&&&&& before remove duplicate length: 75102
r_  generation: 0.025725364685058594

local_output_nid generation: 0.0014004707336425781
local_in_edges_tensor generation: 0.001224517822265625
mini_batch_src_global generation: 0.002226114273071289

&&&&&&&&&&&&&&& before remove duplicate length: 71088
r_  generation: 0.02396225929260254

local_output_nid generation: 0.0014290809631347656
local_in_edges_tensor generation: 0.001249551773071289
mini_batch_src_global generation: 0.0022008419036865234

&&&&&&&&&&&&&&& before remove duplicate length: 74362
r_  generation: 0.02495408058166504

local_output_nid generation: 0.0014595985412597656
local_in_edges_tensor generation: 0.0014941692352294922
mini_batch_src_global generation: 0.002252340316772461

&&&&&&&&&&&&&&& before remove duplicate length: 75448
r_  generation: 0.025695085525512695

local_output_nid generation: 0.001466989517211914
local_in_edges_tensor generation: 0.001271963119506836
mini_batch_src_global generation: 0.002271413803100586

&&&&&&&&&&&&&&& before remove duplicate length: 75856
r_  generation: 0.025446414947509766

local_output_nid generation: 0.0014357566833496094
local_in_edges_tensor generation: 0.0012679100036621094
mini_batch_src_global generation: 0.002252817153930664

&&&&&&&&&&&&&&& before remove duplicate length: 74456
r_  generation: 0.026485204696655273

local_output_nid generation: 0.0014503002166748047
local_in_edges_tensor generation: 0.0015189647674560547
mini_batch_src_global generation: 0.002524852752685547

&&&&&&&&&&&&&&& before remove duplicate length: 74943
r_  generation: 0.026153087615966797

local_output_nid generation: 0.0014040470123291016
local_in_edges_tensor generation: 0.0013263225555419922
mini_batch_src_global generation: 0.0022792816162109375

&&&&&&&&&&&&&&& before remove duplicate length: 71790
r_  generation: 0.025049209594726562

local_output_nid generation: 0.0013844966888427734
local_in_edges_tensor generation: 0.0012438297271728516
mini_batch_src_global generation: 0.0021979808807373047

&&&&&&&&&&&&&&& before remove duplicate length: 72858
r_  generation: 0.023588895797729492

local_output_nid generation: 0.0013802051544189453
local_in_edges_tensor generation: 0.0015153884887695312
mini_batch_src_global generation: 0.002065896987915039

&&&&&&&&&&&&&&& before remove duplicate length: 69215
r_  generation: 0.023720264434814453

local_output_nid generation: 0.0014405250549316406
local_in_edges_tensor generation: 0.0012664794921875
mini_batch_src_global generation: 0.0021164417266845703

&&&&&&&&&&&&&&& before remove duplicate length: 72155
r_  generation: 0.037732839584350586

local_output_nid generation: 0.0018579959869384766
local_in_edges_tensor generation: 0.0017192363739013672
mini_batch_src_global generation: 0.005153179168701172

&&&&&&&&&&&&&&& before remove duplicate length: 63005
r_  generation: 0.023647308349609375

local_output_nid generation: 0.0013813972473144531
local_in_edges_tensor generation: 0.0011892318725585938
mini_batch_src_global generation: 0.0019338130950927734

&&&&&&&&&&&&&&& before remove duplicate length: 62508
r_  generation: 0.021071910858154297

local_output_nid generation: 0.0014307498931884766
local_in_edges_tensor generation: 0.0015087127685546875
mini_batch_src_global generation: 0.002408266067504883

&&&&&&&&&&&&&&& before remove duplicate length: 75866
r_  generation: 0.04053163528442383

local_output_nid generation: 0.001962900161743164
local_in_edges_tensor generation: 0.0035774707794189453
mini_batch_src_global generation: 0.004819393157958984

&&&&&&&&&&&&&&& before remove duplicate length: 75879
r_  generation: 0.026076078414916992

local_output_nid generation: 0.0013659000396728516
local_in_edges_tensor generation: 0.0017273426055908203
mini_batch_src_global generation: 0.0021822452545166016

&&&&&&&&&&&&&&& before remove duplicate length: 73472
r_  generation: 0.045588016510009766

local_output_nid generation: 0.001706838607788086
local_in_edges_tensor generation: 0.00156402587890625
mini_batch_src_global generation: 0.0054514408111572266

&&&&&&&&&&&&&&& before remove duplicate length: 77873
r_  generation: 0.026699542999267578

local_output_nid generation: 0.0014643669128417969
local_in_edges_tensor generation: 0.0020694732666015625
mini_batch_src_global generation: 0.006912946701049805

&&&&&&&&&&&&&&& before remove duplicate length: 78597
r_  generation: 0.05587506294250488

local_output_nid generation: 0.0032186508178710938
local_in_edges_tensor generation: 0.003499269485473633
mini_batch_src_global generation: 0.008025884628295898

&&&&&&&&&&&&&&& before remove duplicate length: 73743
r_  generation: 0.026821136474609375

local_output_nid generation: 0.001483917236328125
local_in_edges_tensor generation: 0.0015096664428710938
mini_batch_src_global generation: 0.002180337905883789

&&&&&&&&&&&&&&& before remove duplicate length: 75089
r_  generation: 0.02559494972229004

local_output_nid generation: 0.0014662742614746094
local_in_edges_tensor generation: 0.0012459754943847656
mini_batch_src_global generation: 0.002197742462158203

&&&&&&&&&&&&&&& before remove duplicate length: 71621
r_  generation: 0.024238109588623047

local_output_nid generation: 0.001508951187133789
local_in_edges_tensor generation: 0.001241922378540039
mini_batch_src_global generation: 0.0022139549255371094

&&&&&&&&&&&&&&& before remove duplicate length: 74261
r_  generation: 0.024875640869140625

local_output_nid generation: 0.0014770030975341797
local_in_edges_tensor generation: 0.001486063003540039
mini_batch_src_global generation: 0.0021593570709228516

&&&&&&&&&&&&&&& before remove duplicate length: 73534
r_  generation: 0.023817777633666992

local_output_nid generation: 0.0014715194702148438
local_in_edges_tensor generation: 0.0015027523040771484
mini_batch_src_global generation: 0.0021991729736328125

&&&&&&&&&&&&&&& before remove duplicate length: 75939
r_  generation: 0.02543187141418457


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6764628887176514
gen group dst list time:  0.06662201881408691
check_connections_block*********************************
time for parepare 1: 0.3836534023284912
local_output_nid generation: 0.0077478885650634766
local_in_edges_tensor generation: 0.052614688873291016
mini_batch_src_global generation: 0.008930206298828125

&&&&&&&&&&&&&&& before remove duplicate length: 265922
r_  generation: 0.09449958801269531

local_output_nid generation: 0.007808685302734375
local_in_edges_tensor generation: 0.008823394775390625
mini_batch_src_global generation: 0.009893655776977539

&&&&&&&&&&&&&&& before remove duplicate length: 243211
r_  generation: 0.08495330810546875

local_output_nid generation: 0.009852170944213867
local_in_edges_tensor generation: 0.010462760925292969
mini_batch_src_global generation: 0.009958505630493164

&&&&&&&&&&&&&&& before remove duplicate length: 282269
r_  generation: 0.10801863670349121

local_output_nid generation: 0.009620428085327148
local_in_edges_tensor generation: 0.008622407913208008
mini_batch_src_global generation: 0.012253522872924805

&&&&&&&&&&&&&&& before remove duplicate length: 290188
r_  generation: 0.11593484878540039

local_output_nid generation: 0.01036524772644043
local_in_edges_tensor generation: 0.009527444839477539
mini_batch_src_global generation: 0.012730836868286133

&&&&&&&&&&&&&&& before remove duplicate length: 299543
r_  generation: 0.11948299407958984

local_output_nid generation: 0.011708974838256836
local_in_edges_tensor generation: 0.011868715286254883
mini_batch_src_global generation: 0.014075279235839844

&&&&&&&&&&&&&&& before remove duplicate length: 341631
r_  generation: 0.14067482948303223

local_output_nid generation: 0.009062767028808594
local_in_edges_tensor generation: 0.008438825607299805
mini_batch_src_global generation: 0.012194395065307617

&&&&&&&&&&&&&&& before remove duplicate length: 251336
r_  generation: 0.10045623779296875

local_output_nid generation: 0.009735107421875
local_in_edges_tensor generation: 0.00857853889465332
mini_batch_src_global generation: 0.012955665588378906

&&&&&&&&&&&&&&& before remove duplicate length: 287592
r_  generation: 0.1167900562286377

local_output_nid generation: 0.009231805801391602
local_in_edges_tensor generation: 0.008544445037841797
mini_batch_src_global generation: 0.012175798416137695

&&&&&&&&&&&&&&& before remove duplicate length: 267178
r_  generation: 0.11193108558654785

local_output_nid generation: 0.007899284362792969
local_in_edges_tensor generation: 0.00734400749206543
mini_batch_src_global generation: 0.01045370101928711

&&&&&&&&&&&&&&& before remove duplicate length: 228346
r_  generation: 0.09144949913024902

local_output_nid generation: 0.011339426040649414
local_in_edges_tensor generation: 0.010141372680664062
mini_batch_src_global generation: 0.014467000961303711

&&&&&&&&&&&&&&& before remove duplicate length: 343640
r_  generation: 0.14330530166625977

local_output_nid generation: 0.008312463760375977
local_in_edges_tensor generation: 0.0070683956146240234
mini_batch_src_global generation: 0.012833833694458008

&&&&&&&&&&&&&&& before remove duplicate length: 269656
r_  generation: 0.10715293884277344

local_output_nid generation: 0.012861967086791992
local_in_edges_tensor generation: 0.013803720474243164
mini_batch_src_global generation: 0.016536474227905273

&&&&&&&&&&&&&&& before remove duplicate length: 375075
r_  generation: 0.1593635082244873

local_output_nid generation: 0.00982046127319336
local_in_edges_tensor generation: 0.008728742599487305
mini_batch_src_global generation: 0.013738155364990234

&&&&&&&&&&&&&&& before remove duplicate length: 265410
r_  generation: 0.16688227653503418

local_output_nid generation: 0.009592056274414062
local_in_edges_tensor generation: 0.00809931755065918
mini_batch_src_global generation: 0.013204574584960938

&&&&&&&&&&&&&&& before remove duplicate length: 290947
r_  generation: 0.12448573112487793

local_output_nid generation: 0.012133121490478516
local_in_edges_tensor generation: 0.013002157211303711
mini_batch_src_global generation: 0.016147375106811523

&&&&&&&&&&&&&&& before remove duplicate length: 353255
r_  generation: 0.15311670303344727

local_output_nid generation: 0.013659954071044922
local_in_edges_tensor generation: 0.016712188720703125
mini_batch_src_global generation: 0.019040346145629883

&&&&&&&&&&&&&&& before remove duplicate length: 396952
r_  generation: 0.18441534042358398

local_output_nid generation: 0.014505386352539062
local_in_edges_tensor generation: 0.015529394149780273
mini_batch_src_global generation: 0.019622325897216797

&&&&&&&&&&&&&&& before remove duplicate length: 434716
r_  generation: 0.21460437774658203

local_output_nid generation: 0.010725975036621094
local_in_edges_tensor generation: 0.008972406387329102
mini_batch_src_global generation: 0.016480684280395508

&&&&&&&&&&&&&&& before remove duplicate length: 328262
r_  generation: 0.15455245971679688

local_output_nid generation: 0.011219978332519531
local_in_edges_tensor generation: 0.009707450866699219
mini_batch_src_global generation: 0.016011476516723633

&&&&&&&&&&&&&&& before remove duplicate length: 337467
r_  generation: 0.15476727485656738

local_output_nid generation: 0.014538049697875977
local_in_edges_tensor generation: 0.018163442611694336
mini_batch_src_global generation: 0.019773483276367188

&&&&&&&&&&&&&&& before remove duplicate length: 418878
r_  generation: 0.21207857131958008

local_output_nid generation: 0.01419830322265625
local_in_edges_tensor generation: 0.04464268684387207
mini_batch_src_global generation: 0.021700143814086914

&&&&&&&&&&&&&&& before remove duplicate length: 403493
r_  generation: 0.19563865661621094

local_output_nid generation: 0.011851787567138672
local_in_edges_tensor generation: 0.020135164260864258
mini_batch_src_global generation: 0.017470359802246094

&&&&&&&&&&&&&&& before remove duplicate length: 351882
r_  generation: 0.16439557075500488

local_output_nid generation: 0.012837886810302734
local_in_edges_tensor generation: 0.018188953399658203
mini_batch_src_global generation: 0.021655559539794922

&&&&&&&&&&&&&&& before remove duplicate length: 371447
r_  generation: 0.178816556930542

local_output_nid generation: 0.028840065002441406
local_in_edges_tensor generation: 0.016621112823486328
mini_batch_src_global generation: 0.01683330535888672

&&&&&&&&&&&&&&& before remove duplicate length: 327345
r_  generation: 0.15128755569458008

local_output_nid generation: 0.014954805374145508
local_in_edges_tensor generation: 0.013572216033935547
mini_batch_src_global generation: 0.016740083694458008

&&&&&&&&&&&&&&& before remove duplicate length: 309998
r_  generation: 0.14062047004699707

local_output_nid generation: 0.012115716934204102
local_in_edges_tensor generation: 0.011505126953125
mini_batch_src_global generation: 0.014929771423339844

&&&&&&&&&&&&&&& before remove duplicate length: 294223
r_  generation: 0.13421392440795898

local_output_nid generation: 0.010890483856201172
local_in_edges_tensor generation: 0.010605573654174805
mini_batch_src_global generation: 0.014353752136230469

&&&&&&&&&&&&&&& before remove duplicate length: 285767
r_  generation: 0.12935614585876465

local_output_nid generation: 0.011315584182739258
local_in_edges_tensor generation: 0.010678291320800781
mini_batch_src_global generation: 0.015185356140136719

&&&&&&&&&&&&&&& before remove duplicate length: 332208
r_  generation: 0.1479637622833252

local_output_nid generation: 0.012403249740600586
local_in_edges_tensor generation: 0.014049291610717773
mini_batch_src_global generation: 0.01692032814025879

&&&&&&&&&&&&&&& before remove duplicate length: 362951
r_  generation: 0.1617417335510254

local_output_nid generation: 0.011938333511352539
local_in_edges_tensor generation: 0.011343955993652344
mini_batch_src_global generation: 0.018032312393188477

&&&&&&&&&&&&&&& before remove duplicate length: 367126
r_  generation: 0.16406488418579102

local_output_nid generation: 0.012377738952636719
local_in_edges_tensor generation: 0.011054039001464844
mini_batch_src_global generation: 0.017136812210083008

&&&&&&&&&&&&&&& before remove duplicate length: 360806
r_  generation: 0.1626584529876709

local_output_nid generation: 0.012448310852050781
local_in_edges_tensor generation: 0.011142492294311523
mini_batch_src_global generation: 0.017400026321411133

&&&&&&&&&&&&&&& before remove duplicate length: 362493
r_  generation: 0.16103482246398926

local_output_nid generation: 0.013094902038574219
local_in_edges_tensor generation: 0.011783361434936523
mini_batch_src_global generation: 0.020486116409301758

&&&&&&&&&&&&&&& before remove duplicate length: 372464
r_  generation: 0.16934633255004883

local_output_nid generation: 0.011248111724853516
local_in_edges_tensor generation: 0.009850502014160156
mini_batch_src_global generation: 0.016131162643432617

&&&&&&&&&&&&&&& before remove duplicate length: 317550
r_  generation: 0.14573383331298828

local_output_nid generation: 0.01235055923461914
local_in_edges_tensor generation: 0.010255813598632812
mini_batch_src_global generation: 0.016464948654174805

&&&&&&&&&&&&&&& before remove duplicate length: 366783
r_  generation: 0.16646957397460938

local_output_nid generation: 0.012522697448730469
local_in_edges_tensor generation: 0.012274980545043945
mini_batch_src_global generation: 0.01860952377319336

&&&&&&&&&&&&&&& before remove duplicate length: 370699
r_  generation: 0.1688852310180664

local_output_nid generation: 0.010158300399780273
local_in_edges_tensor generation: 0.009028911590576172
mini_batch_src_global generation: 0.014532089233398438

&&&&&&&&&&&&&&& before remove duplicate length: 279487
r_  generation: 0.1279304027557373

local_output_nid generation: 0.01040196418762207
local_in_edges_tensor generation: 0.009145259857177734
mini_batch_src_global generation: 0.013616323471069336

&&&&&&&&&&&&&&& before remove duplicate length: 280138
r_  generation: 0.12784361839294434

local_output_nid generation: 0.010420799255371094
local_in_edges_tensor generation: 0.008700847625732422
mini_batch_src_global generation: 0.014121055603027344

&&&&&&&&&&&&&&& before remove duplicate length: 292436
r_  generation: 0.13199305534362793

local_output_nid generation: 0.009753227233886719
local_in_edges_tensor generation: 0.00826263427734375
mini_batch_src_global generation: 0.01360774040222168

&&&&&&&&&&&&&&& before remove duplicate length: 274243
r_  generation: 0.12171292304992676

local_output_nid generation: 0.009595394134521484
local_in_edges_tensor generation: 0.008481502532958984
mini_batch_src_global generation: 0.012803316116333008

&&&&&&&&&&&&&&& before remove duplicate length: 264086
r_  generation: 0.11614799499511719

local_output_nid generation: 0.010547637939453125
local_in_edges_tensor generation: 0.008898735046386719
mini_batch_src_global generation: 0.01432347297668457

&&&&&&&&&&&&&&& before remove duplicate length: 315671
r_  generation: 0.13956236839294434

local_output_nid generation: 0.0105743408203125
local_in_edges_tensor generation: 0.009019136428833008
mini_batch_src_global generation: 0.014071941375732422

&&&&&&&&&&&&&&& before remove duplicate length: 286681
r_  generation: 0.1314549446105957

local_output_nid generation: 0.010788679122924805
local_in_edges_tensor generation: 0.009595394134521484
mini_batch_src_global generation: 0.013768911361694336

&&&&&&&&&&&&&&& before remove duplicate length: 295366
r_  generation: 0.13664698600769043

local_output_nid generation: 0.012145519256591797
local_in_edges_tensor generation: 0.011760473251342773
mini_batch_src_global generation: 0.016147851943969727

&&&&&&&&&&&&&&& before remove duplicate length: 339528
r_  generation: 0.15252161026000977

local_output_nid generation: 0.012947797775268555
local_in_edges_tensor generation: 0.011862754821777344
mini_batch_src_global generation: 0.016889572143554688

&&&&&&&&&&&&&&& before remove duplicate length: 369005
r_  generation: 0.16688847541809082

local_output_nid generation: 0.011767148971557617
local_in_edges_tensor generation: 0.009935140609741211
mini_batch_src_global generation: 0.016091346740722656

&&&&&&&&&&&&&&& before remove duplicate length: 325244
r_  generation: 0.1486067771911621

local_output_nid generation: 0.01103067398071289
local_in_edges_tensor generation: 0.009708642959594727
mini_batch_src_global generation: 0.015132665634155273

&&&&&&&&&&&&&&& before remove duplicate length: 312415
r_  generation: 0.14435052871704102

local_output_nid generation: 0.013124704360961914
local_in_edges_tensor generation: 0.012593507766723633
mini_batch_src_global generation: 0.019176006317138672

&&&&&&&&&&&&&&& before remove duplicate length: 374890
r_  generation: 0.190443754196167

local_output_nid generation: 0.009806632995605469
local_in_edges_tensor generation: 0.00812840461730957
mini_batch_src_global generation: 0.014757156372070312

&&&&&&&&&&&&&&& before remove duplicate length: 274914
r_  generation: 0.13081979751586914

local_output_nid generation: 0.00977945327758789
local_in_edges_tensor generation: 0.008985042572021484
mini_batch_src_global generation: 0.013750076293945312

&&&&&&&&&&&&&&& before remove duplicate length: 268406
r_  generation: 0.12363290786743164

local_output_nid generation: 0.009941816329956055
local_in_edges_tensor generation: 0.008919477462768555
mini_batch_src_global generation: 0.01443934440612793

&&&&&&&&&&&&&&& before remove duplicate length: 275846
r_  generation: 0.12744545936584473

local_output_nid generation: 0.01056361198425293
local_in_edges_tensor generation: 0.008957386016845703
mini_batch_src_global generation: 0.014913558959960938

&&&&&&&&&&&&&&& before remove duplicate length: 307995
r_  generation: 0.1420612335205078

local_output_nid generation: 0.01169896125793457
local_in_edges_tensor generation: 0.010046005249023438
mini_batch_src_global generation: 0.01694512367248535

&&&&&&&&&&&&&&& before remove duplicate length: 343315
r_  generation: 0.1606156826019287

local_output_nid generation: 0.01060795783996582
local_in_edges_tensor generation: 0.008805036544799805
mini_batch_src_global generation: 0.016211271286010742

&&&&&&&&&&&&&&& before remove duplicate length: 336792
r_  generation: 0.15183210372924805

local_output_nid generation: 0.011291980743408203
local_in_edges_tensor generation: 0.00949859619140625
mini_batch_src_global generation: 0.01596355438232422

&&&&&&&&&&&&&&& before remove duplicate length: 335448
r_  generation: 0.1510601043701172

local_output_nid generation: 0.011351823806762695
local_in_edges_tensor generation: 0.009932994842529297
mini_batch_src_global generation: 0.016779422760009766

&&&&&&&&&&&&&&& before remove duplicate length: 350204
r_  generation: 0.15799760818481445

local_output_nid generation: 0.010165691375732422
local_in_edges_tensor generation: 0.008693218231201172
mini_batch_src_global generation: 0.014914751052856445

&&&&&&&&&&&&&&& before remove duplicate length: 291092
r_  generation: 0.13033604621887207

local_output_nid generation: 0.008592605590820312
local_in_edges_tensor generation: 0.006967067718505859
mini_batch_src_global generation: 0.012699604034423828

&&&&&&&&&&&&&&& before remove duplicate length: 258124
r_  generation: 0.10781288146972656

local_output_nid generation: 0.01155400276184082
local_in_edges_tensor generation: 0.009786367416381836
mini_batch_src_global generation: 0.014893293380737305

&&&&&&&&&&&&&&& before remove duplicate length: 350327
r_  generation: 0.15642666816711426

local_output_nid generation: 0.007990121841430664
local_in_edges_tensor generation: 0.006369113922119141
mini_batch_src_global generation: 0.012870550155639648

&&&&&&&&&&&&&&& before remove duplicate length: 224427
r_  generation: 0.09407448768615723

local_output_nid generation: 0.008210182189941406
local_in_edges_tensor generation: 0.006782054901123047
mini_batch_src_global generation: 0.010336160659790039

&&&&&&&&&&&&&&& before remove duplicate length: 235614
r_  generation: 0.09131002426147461

local_output_nid generation: 0.00937962532043457
local_in_edges_tensor generation: 0.007272243499755859
mini_batch_src_global generation: 0.012090444564819336

&&&&&&&&&&&&&&& before remove duplicate length: 282621
r_  generation: 0.11071133613586426


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06583499908447266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

connection checking time:  17.13250160217285
block generation total time  15.292271614074707
average batch blocks generation time:  0.2389417439699173
block dataloader generation time/epoch 63.724966287612915
pseudo mini batch 0 input nodes size: 97399
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05692243576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05692243576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09320640563964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09322929382324219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03795146942138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0412755012512207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0412755012512207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 97399
first layer output nodes number: 27364
edges number: 265922
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0422053337097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([97399, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0422053337097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0422053337097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05501699447631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05501699447631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27364, 256])
h_self size  torch.Size([27364, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27364, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10720968246459961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27364, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10720968246459961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11373376846313477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27364
----------------output nodes number: 3017
----------------edges number: 73203
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11396074295043945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11396074295043945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11740636825561523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11740636825561523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1179347038269043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3017, 47])
h_self size  torch.Size([3017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1179347038269043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11846303939819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1179347038269043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11793994903564453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11846923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04626035690307617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 1 input nodes size: 72878
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03795766830444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03795766830444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06530141830444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06532478332519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.029017925262451172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03140592575073242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03140592575073242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 72878
first layer output nodes number: 24623
edges number: 243211
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032132625579833984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([72878, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032132625579833984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032132625579833984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043210506439208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043210506439208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06669282913208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24623, 256])
h_self size  torch.Size([24623, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06669282913208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24623, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09017515182495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06669282913208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24623, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09017515182495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09604597091674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24623
----------------output nodes number: 3122
----------------edges number: 77140
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0962529182434082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0962529182434082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10071325302124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10071325302124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10126018524169922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3122, 47])
h_self size  torch.Size([3122, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10126018524169922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1018071174621582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10126018524169922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3122, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10127878189086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10182619094848633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035517215728759766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 2 input nodes size: 106436
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.029036521911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.029036521911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06868743896484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0687098503112793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.041342735290527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043974876403808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043974876403808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 106436
first layer output nodes number: 28907
edges number: 282269
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([106436, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044983863830566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057964324951171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057964324951171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08553218841552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28907, 256])
h_self size  torch.Size([28907, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08553218841552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28907, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11310005187988281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08553218841552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28907, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11310005187988281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11999225616455078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28907
----------------output nodes number: 2981
----------------edges number: 70793
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12023019790649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12023019790649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12446355819702148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12446355819702148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1249856948852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1249856948852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12550783157348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1249856948852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12496089935302734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12548351287841797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0485844612121582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 3 input nodes size: 102583
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04131793975830078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08038043975830078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08040285110473633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043396949768066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.043396949768066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 102583
first layer output nodes number: 30091
edges number: 290188
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04438591003417969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([102583, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04438591003417969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04438591003417969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057871341705322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057871341705322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08656835556030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30091, 256])
h_self size  torch.Size([30091, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08656835556030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30091, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1152653694152832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08656835556030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30091, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1152653694152832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12243986129760742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30091
----------------output nodes number: 2981
----------------edges number: 67616
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12268686294555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12268686294555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12652969360351562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12652969360351562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12705183029174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12705183029174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12757396697998047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12705183029174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12705183029174805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12757444381713867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048041343688964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 4 input nodes size: 107984
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08095693588256836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0809793472290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04189443588256836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044657230377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.044657230377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 107984
first layer output nodes number: 30693
edges number: 299543
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04569101333618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([107984, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04569101333618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04569101333618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05970144271850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08897256851196289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30693, 256])
h_self size  torch.Size([30693, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08897256851196289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30693, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11824369430541992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08897256851196289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30693, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11824369430541992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1263408660888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30693
----------------output nodes number: 2999
----------------edges number: 71136
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12659215927124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12659215927124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1300053596496582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1300053596496582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13053083419799805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2999, 47])
h_self size  torch.Size([2999, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13053083419799805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2999, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1310563087463379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13053083419799805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2999, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13053417205810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13106012344360352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04970836639404297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 5 input nodes size: 137502
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04189777374267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04189777374267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09312152862548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09314393997192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289411544799805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05689096450805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05689096450805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 137502
first layer output nodes number: 34733
edges number: 341631
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05817461013793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([137502, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05817461013793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05817461013793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07378911972045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07378911972045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10691308975219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34733, 256])
h_self size  torch.Size([34733, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10691308975219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34733, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14003705978393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10691308975219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34733, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14003705978393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14831829071044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34733
----------------output nodes number: 2983
----------------edges number: 71436
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14859962463378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14859962463378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15200042724609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15200042724609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15252304077148438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2983, 47])
h_self size  torch.Size([2983, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15252304077148438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.153045654296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15252304077148438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15252017974853516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15304327011108398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06233549118041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 6 input nodes size: 83645
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289125442504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05289125442504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08414125442504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08416366577148438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03291749954223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035314083099365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035314083099365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 83645
first layer output nodes number: 25859
edges number: 251336
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.036130428314208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([83645, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.036130428314208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.036130428314208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04773378372192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04773378372192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07239484786987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([25859, 256])
h_self size  torch.Size([25859, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07239484786987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25859, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09705591201782227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07239484786987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25859, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09705591201782227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10322141647338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 25859
----------------output nodes number: 2981
----------------edges number: 70259
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10343694686889648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10343694686889648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1068263053894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1068263053894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10734844207763672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10734844207763672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10787057876586914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10734844207763672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10734796524047852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10787057876586914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.039470672607421875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 7 input nodes size: 91291
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032917022705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.032917022705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0669260025024414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06694889068603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03567647933959961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03842926025390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03842926025390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 91291
first layer output nodes number: 29478
edges number: 287592
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03932952880859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([91291, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03932952880859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03932952880859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052564144134521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.052564144134521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08067655563354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29478, 256])
h_self size  torch.Size([29478, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08067655563354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29478, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10878896713256836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08067655563354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29478, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10878896713256836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11581707000732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29478
----------------output nodes number: 3010
----------------edges number: 71555
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11605978012084961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11605978012084961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11975431442260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11975431442260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12028169631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3010, 47])
h_self size  torch.Size([3010, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12028169631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3010, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12080907821655273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12028169631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3010, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12028694152832031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12081480026245117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04302024841308594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 8 input nodes size: 99198
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035681724548339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035681724548339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07263612747192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07265996932983398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03862810134887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04131031036376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04131031036376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 99198
first layer output nodes number: 27320
edges number: 267178
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04225301742553711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([99198, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04225301742553711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04225301742553711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0550694465637207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0550694465637207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112382888793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27320, 256])
h_self size  torch.Size([27320, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112382888793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27320, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1071782112121582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08112382888793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27320, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1071782112121582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11369180679321289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27320
----------------output nodes number: 3150
----------------edges number: 76953
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11391925811767578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11391925811767578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11752128601074219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11752128601074219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1180729866027832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3150, 47])
h_self size  torch.Size([3150, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1180729866027832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11862468719482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1180729866027832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11809730529785156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11864948272705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046405792236328125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 9 input nodes size: 78529
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03865242004394531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03865242004394531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06790685653686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06792974472045898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030951499938964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03321361541748047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03321361541748047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 78529
first layer output nodes number: 23338
edges number: 228346
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03397321701049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([78529, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03397321701049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03397321701049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04445600509643555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04445600509643555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06671285629272461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([23338, 256])
h_self size  torch.Size([23338, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06671285629272461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23338, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08896970748901367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06671285629272461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23338, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08896970748901367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09453392028808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 23338
----------------output nodes number: 3046
----------------edges number: 75245
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09473085403442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09473085403442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09821939468383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09821939468383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09875297546386719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3046, 47])
h_self size  torch.Size([3046, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09875297546386719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3046, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09928655624389648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09875297546386719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3046, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09873485565185547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09926891326904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03716087341308594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 10 input nodes size: 130345
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030933380126953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.030933380126953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07976150512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07978439331054688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0505070686340332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053629398345947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.053629398345947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 130345
first layer output nodes number: 34709
edges number: 343640
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05485963821411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([130345, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05485963821411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05485963821411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0704803466796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0704803466796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10358142852783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34709, 256])
h_self size  torch.Size([34709, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10358142852783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13668251037597656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10358142852783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13668251037597656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14584064483642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34709
----------------output nodes number: 3043
----------------edges number: 75298
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14612245559692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14612245559692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14960908889770508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14960908889770508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15014219284057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3043, 47])
h_self size  torch.Size([3043, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15014219284057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3043, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15067529678344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15014219284057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3043, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15014171600341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15067529678344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05909585952758789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 11 input nodes size: 75205
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050506591796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.050506591796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0785226821899414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07854509353637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.029694080352783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0322575569152832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0322575569152832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 75205
first layer output nodes number: 27147
edges number: 269656
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([75205, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.033020973205566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0460658073425293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0460658073425293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07195520401000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27147, 256])
h_self size  torch.Size([27147, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07195520401000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27147, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09784460067749023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07195520401000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27147, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09784460067749023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10431718826293945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27147
----------------output nodes number: 2998
----------------edges number: 74309
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10454225540161133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10454225540161133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10797834396362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10797834396362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10850334167480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2998, 47])
h_self size  torch.Size([2998, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10850334167480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2998, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10902833938598633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10850334167480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2998, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10849523544311523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10902070999145508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.037390708923339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 12 input nodes size: 180448
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.02968597412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.02968597412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0969080924987793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09693050384521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06889200210571289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07222700119018555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07222700119018555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 180448
first layer output nodes number: 38245
edges number: 375075
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07385683059692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([180448, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07385683059692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07385683059692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09110355377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09110355377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1275768280029297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38245, 256])
h_self size  torch.Size([38245, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1275768280029297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38245, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16405010223388672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1275768280029297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38245, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16405010223388672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17316865921020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38245
----------------output nodes number: 2983
----------------edges number: 72356
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1734762191772461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1734762191772461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17688369750976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17688369750976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17740631103515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2983, 47])
h_self size  torch.Size([2983, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17740631103515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17792892456054688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17740631103515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17740392684936523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17792701721191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07839488983154297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 13 input nodes size: 112787
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06888961791992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06888961791992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11090612411499023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11092901229858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04368448257446289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04714012145996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04714012145996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 112787
first layer output nodes number: 27144
edges number: 265410
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048183441162109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([112787, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048183441162109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.048183441162109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06099271774291992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06099271774291992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08687925338745117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27144, 256])
h_self size  torch.Size([27144, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08687925338745117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27144, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11276578903198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08687925338745117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27144, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11276578903198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11923742294311523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27144
----------------output nodes number: 3023
----------------edges number: 73748
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11946296691894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11946296691894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12291908264160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12291908264160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344884872436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3023, 47])
h_self size  torch.Size([3023, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344884872436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3023, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1239786148071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12344884872436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3023, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12345600128173828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12398624420166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05232667922973633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 14 input nodes size: 90394
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04369163513183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04369163513183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07736635208129883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07738924026489258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03534984588623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03847169876098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03847169876098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 90394
first layer output nodes number: 29524
edges number: 290947
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([90394, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03936576843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0526432991027832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0526432991027832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08079957962036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29524, 256])
h_self size  torch.Size([29524, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08079957962036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29524, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10895586013793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08079957962036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29524, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10895586013793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11599493026733398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29524
----------------output nodes number: 3021
----------------edges number: 74513
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11623811721801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11623811721801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11991071701049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11991071701049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12044000625610352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3021, 47])
h_self size  torch.Size([3021, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12044000625610352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3021, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12096929550170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12044000625610352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3021, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12043952941894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12096929550170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0431208610534668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 15 input nodes size: 144106
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035349369049072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.035349369049072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08903312683105469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08905696868896484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0553593635559082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05855607986450195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05855607986450195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 144106
first layer output nodes number: 36578
edges number: 353255
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05990266799926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([144106, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05990266799926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05990266799926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07629776000976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07629776000976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11145401000976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36578, 256])
h_self size  torch.Size([36578, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11145401000976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36578, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14633750915527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11118125915527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36578, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14633750915527344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1550583839416504  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36578
----------------output nodes number: 3162
----------------edges number: 75669
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15535497665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15535497665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15895891189575195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15895891189575195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15951299667358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15951299667358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16006708145141602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15951299667358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.15953779220581055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16009235382080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06427001953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 16 input nodes size: 165561
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055384159088134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.055384159088134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11706066131591797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.11708450317382812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06337690353393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06692075729370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06692075729370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 165561
first layer output nodes number: 40007
edges number: 396952
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06899070739746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([165561, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06899070739746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06899070739746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08700227737426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08700227737426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12606477737426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([40007, 256])
h_self size  torch.Size([40007, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12606477737426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40007, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16421842575073242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12515592575073242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40007, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.16421842575073242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17375707626342773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 40007
----------------output nodes number: 3163
----------------edges number: 78473
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17407941818237305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17407941818237305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17844057083129883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17844057083129883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17899465560913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17899465560913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1795487403869629  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17899465560913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.17899465560913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1795492172241211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07375288009643555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 17 input nodes size: 188200
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06337690353393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06337690353393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13348722457885742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13351106643676758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07181072235107422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07650089263916016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07650089263916016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 188200
first layer output nodes number: 43810
edges number: 434716
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07822990417480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([188200, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07822990417480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07822990417480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09795379638671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.09795379638671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13973426818847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([43810, 256])
h_self size  torch.Size([43810, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13973426818847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([43810, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18151473999023438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13973426818847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([43810, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.18151473999023438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19253778457641602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 43810
----------------output nodes number: 3153
----------------edges number: 78045
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1928882598876953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1928882598876953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1965007781982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1965007781982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1970529556274414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3153, 47])
h_self size  torch.Size([3153, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1970529556274414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3153, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19760513305664062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1970529556274414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3153, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1970510482788086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.19760370254516602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08332061767578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 18 input nodes size: 98854
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0718088150024414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0718088150024414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.10863494873046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1086587905883789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.038524627685546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04155731201171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04155731201171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 98854
first layer output nodes number: 33103
edges number: 328262
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0425410270690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([98854, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0425410270690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0425410270690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057442665100097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.057442665100097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08901214599609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33103, 256])
h_self size  torch.Size([33103, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08901214599609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33103, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12058162689208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.08901214599609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33103, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12058162689208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12847423553466797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33103
----------------output nodes number: 3157
----------------edges number: 78675
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12874507904052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12874507904052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13236618041992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13236618041992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1329193115234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3157, 47])
h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1329193115234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13347244262695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1329193115234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1329202651977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13347387313842773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.046690940856933594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 19 input nodes size: 109642
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03852558135986328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.03852558135986328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07937049865722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.07939434051513672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04254436492919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04564666748046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04564666748046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 109642
first layer output nodes number: 34051
edges number: 337467
----------------------------------------before model layer 0
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([109642, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.04671812057495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06290960311889648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.06290960311889648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0953831672668457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34051, 256])
h_self size  torch.Size([34051, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0953831672668457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34051, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12785673141479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.0953831672668457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34051, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.12785673141479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13597536087036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34051
----------------output nodes number: 3163
----------------edges number: 78783
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13625335693359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13625335693359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13988113403320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.13988113403320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14043521881103516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14043521881103516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1409893035888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14043521881103516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.14043617248535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.1409907341003418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.05181741714477539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 20 input nodes size: 210719
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042545318603515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2381591796875 GB
    Memory Allocated: 0.042545318603515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12104463577270508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12106704711914062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08019828796386719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08387470245361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08387470245361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 210719
first layer output nodes number: 42316
edges number: 418878
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576059341430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([210719, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576059341430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576059341430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10544967651367188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10544967651367188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14580535888671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([42316, 256])
h_self size  torch.Size([42316, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14580535888671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([42316, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18616104125976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14580535888671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([42316, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18616104125976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19624996185302734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 42316
----------------output nodes number: 2982
----------------edges number: 71988
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19658803939819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19658803939819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20082330703735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20082330703735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20134544372558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20134544372558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20186758041381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20134544372558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20131349563598633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.20183610916137695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09123468399047852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 21 input nodes size: 160010
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08016633987426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08016633987426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14071321487426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14073705673217773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.062215328216552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06580972671508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06580972671508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 160010
first layer output nodes number: 40646
edges number: 403493
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0673055648803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([160010, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0673055648803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0673055648803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08560609817504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08560609817504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12466859817504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([40646, 256])
h_self size  torch.Size([40646, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12466859817504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40646, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16343164443969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12436914443969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40646, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16343164443969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17312240600585938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 40646
----------------output nodes number: 3163
----------------edges number: 78739
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17344951629638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17344951629638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17720317840576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17720317840576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17775726318359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17775726318359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17831134796142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17775726318359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17778921127319336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1783437728881836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07216167449951172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 22 input nodes size: 121949
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.062247276306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.062247276306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10767698287963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10769987106323242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047129154205322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05044364929199219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05044364929199219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 121949
first layer output nodes number: 35524
edges number: 351882
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05161762237548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([121949, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05161762237548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05161762237548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06760692596435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06760692596435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1014852523803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35524, 256])
h_self size  torch.Size([35524, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1014852523803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35524, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13536357879638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1014852523803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35524, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13536357879638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14383316040039062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35524
----------------output nodes number: 3014
----------------edges number: 74864
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1441211700439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1441211700439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14757633209228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14757633209228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14810419082641602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3014, 47])
h_self size  torch.Size([3014, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14810419082641602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3014, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14863204956054688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14810419082641602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3014, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14807796478271484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1486063003540039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05589437484741211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 23 input nodes size: 158470
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047102928161621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047102928161621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10613775253295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10616159439086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06070899963378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06418657302856445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06418657302856445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 158470
first layer output nodes number: 37412
edges number: 371447
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06564664840698242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([158470, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06564664840698242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06564664840698242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08249139785766602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08249139785766602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11817026138305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37412, 256])
h_self size  torch.Size([37412, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11817026138305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37412, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11817026138305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37412, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15384912490844727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16300296783447266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37412
----------------output nodes number: 3140
----------------edges number: 78062
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16330575942993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16330575942993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16690587997436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16690587997436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16745567321777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3140, 47])
h_self size  torch.Size([3140, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16745567321777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3140, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16800546646118164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16745567321777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3140, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16747760772705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1680278778076172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07019376754760742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 24 input nodes size: 117573
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060730934143066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060730934143066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10453033447265625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1045541763305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04549551010131836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04851484298706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04851484298706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 117573
first layer output nodes number: 33381
edges number: 327345
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04964017868041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([117573, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04964017868041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04964017868041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06463956832885742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06463956832885742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09647417068481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33381, 256])
h_self size  torch.Size([33381, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09647417068481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33381, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12830877304077148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09647417068481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33381, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12830877304077148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13626766204833984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33381
----------------output nodes number: 3163
----------------edges number: 77736
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13654041290283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13654041290283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14016056060791016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14016056060791016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1407146453857422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1407146453857422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14126873016357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1407146453857422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14071893692016602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14127349853515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053777217864990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 25 input nodes size: 111964
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04549980163574219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04549980163574219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08720970153808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08723211288452148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043408870697021484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046267032623291016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046267032623291016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 111964
first layer output nodes number: 31440
edges number: 309998
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04733610153198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([111964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04733610153198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04733610153198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06202125549316406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06202125549316406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09200477600097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31440, 256])
h_self size  torch.Size([31440, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09200477600097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31440, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12198829650878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09200477600097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31440, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12198829650878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298069953918457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31440
----------------output nodes number: 2991
----------------edges number: 73502
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1300640106201172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1300640106201172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13348770141601562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13348770141601562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13401174545288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2991, 47])
h_self size  torch.Size([2991, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13401174545288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2991, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1345357894897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13401174545288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2991, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13398170471191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1345062255859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05176115036010742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 26 input nodes size: 119134
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04337882995605469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04337882995605469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08830070495605469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08832311630249023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04659080505371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049327850341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049327850341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 119134
first layer output nodes number: 30083
edges number: 294223
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050440311431884766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([119134, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050440311431884766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050440311431884766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06395244598388672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06395244598388672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09264183044433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30083, 256])
h_self size  torch.Size([30083, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09264183044433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30083, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12133121490478516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09264183044433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30083, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12133121490478516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12850379943847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30083
----------------output nodes number: 2981
----------------edges number: 73066
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12875080108642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12875080108642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13260698318481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13260698318481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13312911987304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13312911987304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1336512565612793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13312911987304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13312721252441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1336498260498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05420351028442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 27 input nodes size: 115425
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046588897705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046588897705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08958816528320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08961057662963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044666290283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047341346740722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047341346740722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 115425
first layer output nodes number: 29330
edges number: 285767
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04842042922973633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([115425, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04842042922973633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04842042922973633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06226778030395508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06226778030395508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29330, 256])
h_self size  torch.Size([29330, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29330, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1182103157043457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29330, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1182103157043457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12575006484985352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29330
----------------output nodes number: 2985
----------------edges number: 73119
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1259913444519043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1259913444519043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298384666442871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298384666442871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13036155700683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2985, 47])
h_self size  torch.Size([2985, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13036155700683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13088464736938477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13036155700683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13036251068115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13088607788085938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05279541015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 28 input nodes size: 118166
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04466724395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04466724395751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08958911895751953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08961296081542969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04659128189086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049654483795166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 118166
first layer output nodes number: 33397
edges number: 332208
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05078411102294922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([118166, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05078411102294922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05078411102294922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0658259391784668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0658259391784668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09767580032348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33397, 256])
h_self size  torch.Size([33397, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09767580032348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33397, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12952566146850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09767580032348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33397, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12952566146850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13748836517333984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33397
----------------output nodes number: 3162
----------------edges number: 78749
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13776111602783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13776111602783203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.141387939453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.141387939453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14194202423095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14194202423095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14249610900878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14194202423095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14197301864624023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14252758026123047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054999351501464844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 29 input nodes size: 142266
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046622276306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046622276306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09962081909179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09964466094970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054698944091796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058325767517089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058325767517089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 142266
first layer output nodes number: 36628
edges number: 362951
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05965900421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([142266, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05965900421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05965900421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07614564895629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07614564895629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11130189895629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36628, 256])
h_self size  torch.Size([36628, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11130189895629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36628, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14623308181762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11107683181762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36628, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14623308181762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15553951263427734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36628
----------------output nodes number: 3161
----------------edges number: 78564
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1558365821838379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1558365821838379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15946054458618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15946054458618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16001415252685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16001415252685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1605677604675293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16001415252685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16001367568969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1605677604675293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0641169548034668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 30 input nodes size: 129524
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05469846725463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05469846725463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10352659225463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10354995727539062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05052757263183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053841590881347656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053841590881347656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 129524
first layer output nodes number: 37021
edges number: 367126
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05508279800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([129524, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05508279800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05508279800415039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07174873352050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07174873352050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1070547103881836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37021, 256])
h_self size  torch.Size([37021, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1070547103881836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37021, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14236068725585938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1070547103881836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37021, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14236068725585938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15134334564208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37021
----------------output nodes number: 3115
----------------edges number: 77491
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1516427993774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1516427993774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15600109100341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15600109100341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15654659271240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3115, 47])
h_self size  torch.Size([3115, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15654659271240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3115, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15709209442138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15654659271240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3115, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1565384864807129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15708446502685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0595545768737793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 31 input nodes size: 128736
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050519466400146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050519466400146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09847736358642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09850072860717773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04964923858642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052916526794433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052916526794433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 128736
first layer output nodes number: 36281
edges number: 360806
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05414628982543945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([128736, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05414628982543945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05414628982543945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07048606872558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07048606872558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10564231872558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36281, 256])
h_self size  torch.Size([36281, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10564231872558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36281, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1402425765991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1050863265991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36281, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1402425765991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14889287948608398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36281
----------------output nodes number: 3110
----------------edges number: 77598
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1491866111755371  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1491866111755371  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1527552604675293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1527552604675293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15329980850219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3110, 47])
h_self size  torch.Size([3110, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15329980850219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3110, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15384435653686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15329980850219727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3110, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15329885482788086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15384387969970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05856800079345703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 32 input nodes size: 115089
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049648284912109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049648284912109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09252262115478516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09254646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04456520080566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855155944824219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855155944824219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 115089
first layer output nodes number: 36509
edges number: 362493
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049681663513183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([115089, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049681663513183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049681663513183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06611967086791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06611967086791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10127592086791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36509, 256])
h_self size  torch.Size([36509, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10127592086791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36509, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1360936164855957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1009373664855957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36509, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1360936164855957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14479827880859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36509
----------------output nodes number: 3159
----------------edges number: 78870
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1450943946838379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1450943946838379  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14871931076049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14871931076049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14927244186401367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3159, 47])
h_self size  torch.Size([3159, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14927244186401367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3159, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1498255729675293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14927244186401367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3159, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14928102493286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14983463287353516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05414867401123047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 33 input nodes size: 165889
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04457378387451172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04457378387451172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10637235641479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10639476776123047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06349658966064453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06682205200195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06682205200195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 165889
first layer output nodes number: 37508
edges number: 372464
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06893444061279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([165889, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06893444061279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06893444061279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08582305908203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08582305908203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12159347534179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37508, 256])
h_self size  torch.Size([37508, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12159347534179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37508, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1573638916015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12159347534179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37508, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1573638916015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16651535034179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37508
----------------output nodes number: 2981
----------------edges number: 73799
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16681766510009766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16681766510009766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17023372650146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17023372650146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17075586318969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17075586318969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1712779998779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17075586318969727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17072486877441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1712474822998047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07337331771850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 34 input nodes size: 123960
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06346559524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06346559524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11034059524536133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11036396026611328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04854297637939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05147838592529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05147838592529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 123960
first layer output nodes number: 32274
edges number: 317550
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052642822265625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([123960, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052642822265625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052642822265625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06756258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06756258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09881258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32274, 256])
h_self size  torch.Size([32274, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09881258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32274, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13006258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09881258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32274, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13006258010864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1377573013305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32274
----------------output nodes number: 3098
----------------edges number: 76369
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13802146911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13802146911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1415691375732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1415691375732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14211177825927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3098, 47])
h_self size  torch.Size([3098, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14211177825927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3098, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1426544189453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14211177825927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3098, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14213228225708008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14267539978027344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05709505081176758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 35 input nodes size: 128449
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048563480377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048563480377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09641456604003906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09643840789794922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049540042877197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05285978317260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05285978317260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 128449
first layer output nodes number: 36854
edges number: 366783
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0540919303894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([128449, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0540919303894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0540919303894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07069206237792969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07069206237792969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10584831237792969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36854, 256])
h_self size  torch.Size([36854, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10584831237792969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36854, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14099502563476562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10583877563476562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36854, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14099502563476562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1499805450439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36854
----------------output nodes number: 3151
----------------edges number: 78640
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15027904510498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15027904510498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15480518341064453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15480518341064453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15535736083984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3151, 47])
h_self size  torch.Size([3151, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15535736083984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3151, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15590953826904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15535736083984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3151, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1553668975830078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15591955184936523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058592796325683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 36 input nodes size: 149792
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04954957962036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04954957962036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10535144805908203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10537528991699219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.057500362396240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06083536148071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06083536148071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 149792
first layer output nodes number: 37874
edges number: 370699
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06309986114501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([149792, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06309986114501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06309986114501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08011341094970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08011341094970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11623287200927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37874, 256])
h_self size  torch.Size([37874, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11623287200927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37874, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15235233306884766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11623287200927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37874, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15235233306884766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16138219833374023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37874
----------------output nodes number: 3137
----------------edges number: 76764
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16168832778930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16168832778930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16527605056762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16527605056762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16582536697387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3137, 47])
h_self size  torch.Size([3137, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16582536697387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16637468338012695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16582536697387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16582250595092773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16637229919433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06760454177856445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 37 input nodes size: 121740
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.057497501373291016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.057497501373291016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10284948348999023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10287237167358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047046661376953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05016517639160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05016517639160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 121740
first layer output nodes number: 28396
edges number: 279487
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0512843132019043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([121740, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0512843132019043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0512843132019043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06405162811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06405162811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09139537811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28396, 256])
h_self size  torch.Size([28396, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09139537811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28396, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873912811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09139537811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28396, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873912811279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1256089210510254  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28396
----------------output nodes number: 3026
----------------edges number: 74325
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12584352493286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12584352493286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12930631637573242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12930631637573242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298365592956543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3026, 47])
h_self size  torch.Size([3026, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298365592956543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3026, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13036680221557617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1298365592956543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3026, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12981748580932617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13034820556640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054913997650146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 38 input nodes size: 113809
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047027587890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047027587890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08942508697509766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0894474983215332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044072628021240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04713869094848633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04713869094848633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 113809
first layer output nodes number: 28839
edges number: 280138
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0482020378112793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([113809, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0482020378112793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0482020378112793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061141014099121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061141014099121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08864402770996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28839, 256])
h_self size  torch.Size([28839, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08864402770996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28839, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11614704132080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08864402770996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28839, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11614704132080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12302303314208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28839
----------------output nodes number: 2981
----------------edges number: 72619
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.123260498046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.123260498046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12757205963134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12757205963134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12809419631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12809419631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1286163330078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12809419631958008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12808609008789062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12860870361328125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05182933807373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 39 input nodes size: 108742
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04406452178955078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04406452178955078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08457422256469727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08459758758544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042177677154541016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04491758346557617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04491758346557617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 108742
first layer output nodes number: 30245
edges number: 292436
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04595375061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([108742, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04595375061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04595375061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059513092041015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059513092041015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08835697174072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30245, 256])
h_self size  torch.Size([30245, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08835697174072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30245, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11720085144042969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08835697174072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30245, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11720085144042969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12441205978393555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30245
----------------output nodes number: 3111
----------------edges number: 75150
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12466096878051758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12466096878051758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12821245193481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12821245193481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12875747680664062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3111, 47])
h_self size  torch.Size([3111, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12875747680664062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3111, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1293025016784668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12875747680664062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3111, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12878036499023438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12932586669921875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049764156341552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 40 input nodes size: 91568
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042200565338134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042200565338134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07631254196166992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07633590698242188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03580284118652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03842878341674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03842878341674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 91568
first layer output nodes number: 28186
edges number: 274243
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0393214225769043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([91568, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0393214225769043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0393214225769043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0519709587097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0519709587097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0793147087097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28186, 256])
h_self size  torch.Size([28186, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0793147087097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28186, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0793147087097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28186, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1066584587097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11364555358886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28186
----------------output nodes number: 3096
----------------edges number: 75102
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11387920379638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11387920379638672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1174154281616211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1174154281616211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11795759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3096, 47])
h_self size  torch.Size([3096, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11795759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3096, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.118499755859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11795759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3096, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11795473098754883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11849737167358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042938232421875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 41 input nodes size: 102632
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03579998016357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03579998016357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07486248016357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07488489151000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.040749549865722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04324817657470703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04324817657470703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 102632
first layer output nodes number: 27320
edges number: 264086
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04421663284301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([102632, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04421663284301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04421663284301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0569615364074707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0569615364074707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08301591873168945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27320, 256])
h_self size  torch.Size([27320, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08301591873168945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27320, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1090703010559082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08301591873168945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27320, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1090703010559082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11558389663696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27320
----------------output nodes number: 2992
----------------edges number: 71088
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11580991744995117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11580991744995117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1192164421081543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1192164421081543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974048614501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2992, 47])
h_self size  torch.Size([2992, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974048614501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12026453018188477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974048614501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11972236633300781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12024688720703125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04816579818725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 42 input nodes size: 119605
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04073143005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04073143005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08565330505371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08567619323730469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04659128189086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04949808120727539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04949808120727539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 119605
first layer output nodes number: 32340
edges number: 315671
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05063056945800781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([119605, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05063056945800781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05063056945800781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06557750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06557750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09682750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32340, 256])
h_self size  torch.Size([32340, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09682750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32340, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12807750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09682750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32340, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12807750701904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1357879638671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32340
----------------output nodes number: 3043
----------------edges number: 74362
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13605213165283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13605213165283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13953113555908203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13953113555908203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14006423950195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3043, 47])
h_self size  torch.Size([3043, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14006423950195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3043, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14059734344482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14006423950195312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3043, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14007329940795898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14060688018798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05504322052001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 43 input nodes size: 110299
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046600341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046600341796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08769035339355469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08771419525146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042769432067871094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04546833038330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04546833038330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 110299
first layer output nodes number: 29926
edges number: 286681
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([110299, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059909820556640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059909820556640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08844947814941406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29926, 256])
h_self size  torch.Size([29926, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08844947814941406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29926, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1169891357421875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08844947814941406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29926, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1169891357421875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12412405014038086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29926
----------------output nodes number: 3158
----------------edges number: 75448
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12437105178833008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12437105178833008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12796926498413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12852239608764648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3158, 47])
h_self size  torch.Size([3158, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12852239608764648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3158, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1290755271911621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12852239608764648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3158, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12854242324829102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12909603118896484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0502772331237793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 44 input nodes size: 109554
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042789459228515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042789459228515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08362579345703125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042511940002441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04527854919433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04527854919433594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 109554
first layer output nodes number: 30547
edges number: 295366
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04632282257080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([109554, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04632282257080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04632282257080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060825347900390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060825347900390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08995723724365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30547, 256])
h_self size  torch.Size([30547, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08995723724365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30547, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11908912658691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08995723724365234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30547, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11908912658691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1263723373413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30547
----------------output nodes number: 3150
----------------edges number: 75856
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12662410736083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12662410736083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1302175521850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1302175521850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1307692527770996  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3150, 47])
h_self size  torch.Size([3150, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1307692527770996  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13132095336914062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1307692527770996  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.130767822265625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13131999969482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050952911376953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 45 input nodes size: 123602
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0425105094909668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0425105094909668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0893855094909668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08940887451171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048572540283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051657676696777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051657676696777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 123602
first layer output nodes number: 35050
edges number: 339528
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052840232849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([123602, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052840232849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052840232849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0685582160949707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0685582160949707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10198450088500977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35050, 256])
h_self size  torch.Size([35050, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10198450088500977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35050, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13541078567504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10198450088500977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35050, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13541078567504883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14459943771362305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35050
----------------output nodes number: 3074
----------------edges number: 74456
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1448841094970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1448841094970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14839458465576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14839458465576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14893293380737305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3074, 47])
h_self size  torch.Size([3074, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14893293380737305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3074, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14947128295898438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14893293380737305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3074, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14891958236694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1494584083557129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05702495574951172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 46 input nodes size: 146250
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855918884277344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855918884277344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10324668884277344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1032705307006836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05637216567993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05968046188354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05968046188354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 146250
first layer output nodes number: 38296
edges number: 369005
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06105613708496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([146250, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06105613708496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06105613708496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07821512222290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07821512222290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11473703384399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38296, 256])
h_self size  torch.Size([38296, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11473703384399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38296, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1512589454650879  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11473703384399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38296, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1512589454650879  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16038942337036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38296
----------------output nodes number: 3140
----------------edges number: 74943
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16069889068603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16069889068603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.164276123046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.164276123046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1648259162902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3140, 47])
h_self size  torch.Size([3140, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1648259162902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3140, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1653757095336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1648259162902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3140, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16483736038208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16538763046264648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06554222106933594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 47 input nodes size: 141658
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.056383609771728516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.056383609771728516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10915565490722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10917806625366211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05446672439575195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05742502212524414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05742502212524414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 141658
first layer output nodes number: 33732
edges number: 325244
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05873250961303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([141658, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05873250961303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05873250961303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07384824752807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07384824752807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1060175895690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33732, 256])
h_self size  torch.Size([33732, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1060175895690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33732, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13818693161010742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1060175895690918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33732, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13818693161010742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14622926712036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33732
----------------output nodes number: 2981
----------------edges number: 71790
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14650344848632812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14650344848632812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15073776245117188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15073776245117188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1512598991394043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1512598991394043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15178203582763672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1512598991394043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15123224258422852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15175485610961914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06273555755615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 48 input nodes size: 153625
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05443906784057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05443906784057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11166906356811523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11169147491455078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05889701843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061768531799316406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061768531799316406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 153625
first layer output nodes number: 31534
edges number: 312415
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06314849853515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([153625, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06314849853515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06314849853515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07734155654907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07734155654907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10741472244262695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31534, 256])
h_self size  torch.Size([31534, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10741472244262695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31534, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13748788833618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10741472244262695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31534, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13748788833618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1450061798095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31534
----------------output nodes number: 2992
----------------edges number: 72858
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.145263671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.145263671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1486835479736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1486835479736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14920759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2992, 47])
h_self size  torch.Size([2992, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14920759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14973163604736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14920759201049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2992, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14920949935913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1497340202331543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06707000732421875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 49 input nodes size: 189498
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05889892578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05889892578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12949275970458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1295151710510254  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07226276397705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07640361785888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07640361785888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 189498
first layer output nodes number: 38004
edges number: 374890
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07809877395629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([189498, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07809877395629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07809877395629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09519147872924805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09519147872924805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13143491744995117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38004, 256])
h_self size  torch.Size([38004, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13143491744995117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38004, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1676783561706543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13143491744995117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38004, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1676783561706543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17673921585083008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38004
----------------output nodes number: 2981
----------------edges number: 69215
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17704486846923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17704486846923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18042659759521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18042659759521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18094873428344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18094873428344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1814708709716797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18094873428344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18094682693481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18146944046020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08252239227294922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 50 input nodes size: 114905
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07226085662841797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07226085662841797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1150665283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11508989334106445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04447364807128906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047127723693847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047127723693847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 114905
first layer output nodes number: 27910
edges number: 274914
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048192501068115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([114905, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048192501068115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048192501068115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06103992462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06103992462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08838367462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27910, 256])
h_self size  torch.Size([27910, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08838367462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27910, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11572742462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08838367462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27910, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11572742462158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12238168716430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27910
----------------output nodes number: 3136
----------------edges number: 72155
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12261343002319336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12261343002319336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12616586685180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12616586685180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12671518325805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3136, 47])
h_self size  torch.Size([3136, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12671518325805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3136, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12726449966430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12671518325805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3136, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12674236297607422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12729215621948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052093505859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 51 input nodes size: 110068
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04450082778930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04450082778930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08550453186035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08552694320678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042697906494140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04516792297363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04516792297363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 110068
first layer output nodes number: 27267
edges number: 268406
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04619169235229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([110068, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04619169235229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04619169235229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059012413024902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059012413024902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08501625061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27267, 256])
h_self size  torch.Size([27267, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08501625061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27267, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11102008819580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08501625061035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27267, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11102008819580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11752128601074219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27267
----------------output nodes number: 3002
----------------edges number: 63005
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11774730682373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11774730682373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12111234664916992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12111234664916992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12163829803466797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3002, 47])
h_self size  torch.Size([3002, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12163829803466797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3002, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12216424942016602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12163829803466797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3002, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12161493301391602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12214136123657227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050110816955566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 52 input nodes size: 130903
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04267454147338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04267454147338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09150266647338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09152507781982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05049896240234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05302143096923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05302143096923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 130903
first layer output nodes number: 28595
edges number: 275846
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05421018600463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([130903, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05421018600463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05421018600463867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06768083572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06768083572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09502458572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28595, 256])
h_self size  torch.Size([28595, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09502458572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28595, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12236833572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09502458572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28595, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12236833572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12918615341186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28595
----------------output nodes number: 2981
----------------edges number: 62508
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12942171096801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12942171096801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13275384902954102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13275384902954102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13327598571777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13327598571777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13379812240600586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13327598571777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1332721710205078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13379478454589844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05831098556518555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 53 input nodes size: 137329
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050495147705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1016545295715332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10167837142944336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05282783508300781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05568885803222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05568885803222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 137329
first layer output nodes number: 31161
edges number: 307995
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05715370178222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([137329, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05715370178222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05715370178222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07117414474487305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07117414474487305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1008915901184082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31161, 256])
h_self size  torch.Size([31161, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1008915901184082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31161, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13060903549194336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1008915901184082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31161, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13060903549194336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13803863525390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31161
----------------output nodes number: 3162
----------------edges number: 75866
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13829469680786133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13829469680786133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14189958572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14189958572387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14245367050170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14245367050170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14300775527954102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14245367050170898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1424856185913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14304018020629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06111288070678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 54 input nodes size: 153470
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05285978317260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05285978317260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1100320816040039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11005592346191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06281280517578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06281280517578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 153470
first layer output nodes number: 34680
edges number: 343315
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06421470642089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([153470, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06421470642089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06421470642089844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07982206344604492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07982206344604492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11289548873901367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34680, 256])
h_self size  torch.Size([34680, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11289548873901367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34680, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14596891403198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11289548873901367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34680, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14596891403198242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1542372703552246  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34680
----------------output nodes number: 3163
----------------edges number: 75879
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15451955795288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15451955795288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1581254005432129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1581254005432129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15867948532104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15867948532104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15923357009887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15867948532104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15867948532104492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15923404693603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06845712661743164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 55 input nodes size: 116987
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05887269973754883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10245418548583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10247659683227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04842329025268555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04842329025268555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 116987
first layer output nodes number: 33935
edges number: 336792
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04954814910888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([116987, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04954814910888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04954814910888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06482696533203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06482696533203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09718990325927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33935, 256])
h_self size  torch.Size([33935, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09718990325927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33935, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12955284118652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09718990325927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33935, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12955284118652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13764381408691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33935
----------------output nodes number: 2981
----------------edges number: 73472
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13791942596435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13791942596435547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14133262634277344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14133262634277344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14185476303100586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14185476303100586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14237689971923828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14185476303100586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14182281494140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14234542846679688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05366182327270508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 56 input nodes size: 130547
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04524850845336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04524850845336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09407663345336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0940999984741211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05049610137939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05357646942138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05357646942138672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 130547
first layer output nodes number: 33795
edges number: 335448
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05480146408081055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([130547, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05480146408081055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05480146408081055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07001733779907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07001733779907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224676132202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33795, 256])
h_self size  torch.Size([33795, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224676132202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33795, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1344761848449707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224676132202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33795, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1344761848449707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1425337791442871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33795
----------------output nodes number: 3132
----------------edges number: 77873
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14280939102172852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14280939102172852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14640092849731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14640092849731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14694976806640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3132, 47])
h_self size  torch.Size([3132, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14694976806640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3132, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14749860763549805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14694976806640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3132, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14697647094726562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14752578735351562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059029579162597656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 57 input nodes size: 127358
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050522804260253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050522804260253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09796762466430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0979914665222168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049139976501464844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05233573913574219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05233573913574219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 127358
first layer output nodes number: 35243
edges number: 350204
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05354738235473633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([127358, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05354738235473633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05354738235473633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06941747665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06941747665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1030278205871582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35243, 256])
h_self size  torch.Size([35243, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1030278205871582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35243, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13663816452026367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1030278205871582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35243, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13663816452026367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14504098892211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35243
----------------output nodes number: 3158
----------------edges number: 78597
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14894962310791016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14894962310791016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14950275421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3158, 47])
h_self size  torch.Size([3158, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14950275421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3158, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1500558853149414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14950275421142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3158, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1495070457458496  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15006065368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.057895660400390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 58 input nodes size: 122036
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04914426803588867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04914426803588867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09460639953613281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09462881088256836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04716014862060547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050208091735839844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050208091735839844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 122036
first layer output nodes number: 29605
edges number: 291092
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05133819580078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([122036, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05133819580078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05133819580078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06464719772338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06464719772338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0928807258605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29605, 256])
h_self size  torch.Size([29605, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0928807258605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29605, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12111425399780273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0928807258605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29605, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12111425399780273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1281728744506836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29605
----------------output nodes number: 3005
----------------edges number: 73743
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1284160614013672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1284160614013672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1320056915283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1320056915283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13253211975097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3005, 47])
h_self size  torch.Size([3005, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13253211975097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3005, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1330585479736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13253211975097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3005, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1325054168701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13303232192993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.055057525634765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 59 input nodes size: 83976
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047133445739746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047133445739746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07841730117797852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07844018936157227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03295564651489258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03543901443481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03543901443481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 83976
first layer output nodes number: 26143
edges number: 258124
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036260128021240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([83976, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036260128021240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036260128021240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04802083969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04802083969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0729527473449707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([26143, 256])
h_self size  torch.Size([26143, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0729527473449707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26143, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0978846549987793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0729527473449707  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26143, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0978846549987793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10411787033081055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 26143
----------------output nodes number: 3019
----------------edges number: 75089
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10433578491210938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10433578491210938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10779762268066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10779762268066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10832643508911133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3019, 47])
h_self size  torch.Size([3019, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10832643508911133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3019, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1088552474975586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10832643508911133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3019, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10832881927490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10885810852050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03973054885864258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 60 input nodes size: 143807
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.032958030700683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.032958030700683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08653068542480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08655357360839844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.055246829986572266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05839109420776367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05839109420776367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 143807
first layer output nodes number: 35770
edges number: 350327
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059772491455078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([143807, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059772491455078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059772491455078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07584190368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07584190368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.109954833984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35770, 256])
h_self size  torch.Size([35770, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.109954833984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35770, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14406776428222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.109954833984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35770, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14406776428222656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15317630767822266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35770
----------------output nodes number: 3037
----------------edges number: 71621
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15346574783325195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15346574783325195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15691900253295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15691900253295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15745115280151367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3037, 47])
h_self size  torch.Size([3037, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15745115280151367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3037, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15798330307006836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15745115280151367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3037, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1574544906616211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15798711776733398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06402206420898438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 61 input nodes size: 76757
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05525016784667969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05525016784667969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08384466171264648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08386850357055664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.030272960662841797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03249979019165039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03249979019165039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 76757
first layer output nodes number: 23251
edges number: 224427
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03324556350708008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([76757, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03324556350708008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03324556350708008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043666839599609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043666839599609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0658407211303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([23251, 256])
h_self size  torch.Size([23251, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0658407211303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23251, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08801460266113281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0658407211303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23251, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08801460266113281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09355831146240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 23251
----------------output nodes number: 3163
----------------edges number: 74261
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09375572204589844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09375572204589844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0973501205444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0973501205444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09790420532226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09790420532226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09845829010009766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09790420532226562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09792613983154297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0984807014465332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036431312561035156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 62 input nodes size: 76647
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03029489517211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03029489517211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05884838104248047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05887174606323242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03025341033935547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03255748748779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03255748748779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 76647
first layer output nodes number: 24381
edges number: 235614
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0333104133605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([76647, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0333104133605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0333104133605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04423999786376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04423999786376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06749153137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24381, 256])
h_self size  torch.Size([24381, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06749153137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24381, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0907430648803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06749153137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24381, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0907430648803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09655618667602539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24381
----------------output nodes number: 3122
----------------edges number: 73534
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09676122665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09676122665405273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1003108024597168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1003108024597168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3122, 47])
h_self size  torch.Size([3122, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10140466690063477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10085773468017578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3122, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10085058212280273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10139799118041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036554813385009766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 63 input nodes size: 89531
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.030246257781982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.030246257781982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0635995864868164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06362342834472656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03504657745361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03846883773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03846883773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 89531
first layer output nodes number: 29565
edges number: 282621
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.039356231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([89531, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.039356231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.039356231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05268049240112305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05268049240112305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29565, 256])
h_self size  torch.Size([29565, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29565, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10907125473022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08087587356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29565, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10907125473022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1161203384399414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29565
----------------output nodes number: 3156
----------------edges number: 75939
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1163644790649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1163644790649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1200094223022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1200094223022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12056207656860352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3156, 47])
h_self size  torch.Size([3156, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12056207656860352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12111473083496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12056207656860352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12056779861450195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12112092971801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04317140579223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04317140579223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04317140579223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02457461878657341 |0.0040122270584106445 |0.01350395753979683 |0.00013631582260131836 |0.0024190284311771393 |0.001749277114868164 |
----------------------------------------------------------pseudo_mini_loss sum 1.6183478832244873
Total (block generation + training)time/epoch 66.54069817066193
Training time/epoch 3.069719076156616
Training time without block to device /epoch 2.812936544418335
Training time without total dataloading part /epoch 1.0295445919036865
load block tensor time/epoch 1.5727756023406982
block to device time/epoch 0.25678253173828125
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  9901923
Number of first layer input nodes during this epoch:  7837005
Number of first layer output nodes during this epoch:  2064918
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043170928955078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.26775097846984863
global_2_local spend time (sec) 0.45896148681640625

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.241 seconds
Metis partitioning: 15.091 seconds
Split the graph: 0.580 seconds
Construct subgraphs: 0.382 seconds
3163
2985
2983
3160
3075
3128
3161
2981
2981
3162
2991
3157
3147
3050
3104
3049
3163
2996
3150
3141
2981
2981
2982
3151
3138
3145
2981
2981
3099
2981
2981
3004
3095
2981
3152
3024
3060
3161
3078
3017
3148
3163
3148
2981
3157
2981
3163
2995
3137
3148
3047
3145
3143
3104
2981
3163
2984
2984
2984
3076
3144
3125
2989
2981
REG metis partition end ----................................
the time spent:  28.546706914901733
total k batches seeds list generation spend  29.05049705505371
after graph partition
graph partition algorithm spend time 29.560062646865845

partition_len_list
[29576, 28816, 32670, 26956, 36393, 34653, 35420, 35524, 27686, 31687, 32967, 29957, 37105, 36383, 29600, 43141, 35675, 29191, 32866, 32281, 30886, 27265, 32872, 25836, 27585, 24421, 29514, 33332, 29646, 24209, 31752, 29505, 23800, 37623, 29061, 24120, 32735, 34319, 26562, 32474, 38819, 40390, 37697, 31991, 38377, 39502, 42315, 41256, 34179, 34261, 33771, 36800, 36082, 31540, 34647, 37054, 30407, 31044, 28236, 26860, 25492, 33883, 36431, 36443]
REG selection method  spend 30.239441394805908
check_connections_block*********************************
time for parepare 1: 0.23265767097473145
local_output_nid generation: 0.0013456344604492188
local_in_edges_tensor generation: 0.0060482025146484375
mini_batch_src_global generation: 0.0030760765075683594

&&&&&&&&&&&&&&& before remove duplicate length: 77679
r_  generation: 0.026833772659301758

local_output_nid generation: 0.0012755393981933594
local_in_edges_tensor generation: 0.0042476654052734375
mini_batch_src_global generation: 0.003366231918334961

&&&&&&&&&&&&&&& before remove duplicate length: 72968
r_  generation: 0.026510000228881836

local_output_nid generation: 0.0013320446014404297
local_in_edges_tensor generation: 0.0032966136932373047
mini_batch_src_global generation: 0.0025482177734375

&&&&&&&&&&&&&&& before remove duplicate length: 72934
r_  generation: 0.025789737701416016

local_output_nid generation: 0.0014331340789794922
local_in_edges_tensor generation: 0.0029802322387695312
mini_batch_src_global generation: 0.002691507339477539

&&&&&&&&&&&&&&& before remove duplicate length: 77630
r_  generation: 0.02718043327331543

local_output_nid generation: 0.001367330551147461
local_in_edges_tensor generation: 0.0023429393768310547
mini_batch_src_global generation: 0.002661466598510742

&&&&&&&&&&&&&&& before remove duplicate length: 76566
r_  generation: 0.026558637619018555

local_output_nid generation: 0.001398324966430664
local_in_edges_tensor generation: 0.0021865367889404297
mini_batch_src_global generation: 0.0023467540740966797

&&&&&&&&&&&&&&& before remove duplicate length: 77539
r_  generation: 0.028765201568603516

local_output_nid generation: 0.002466917037963867
local_in_edges_tensor generation: 0.001898050308227539
mini_batch_src_global generation: 0.002220630645751953

&&&&&&&&&&&&&&& before remove duplicate length: 78678
r_  generation: 0.026805877685546875

local_output_nid generation: 0.0013692378997802734
local_in_edges_tensor generation: 0.0016548633575439453
mini_batch_src_global generation: 0.002229928970336914

&&&&&&&&&&&&&&& before remove duplicate length: 72838
r_  generation: 0.025066137313842773

local_output_nid generation: 0.001338958740234375
local_in_edges_tensor generation: 0.0016169548034667969
mini_batch_src_global generation: 0.002131938934326172

&&&&&&&&&&&&&&& before remove duplicate length: 71728
r_  generation: 0.023976564407348633

local_output_nid generation: 0.0014071464538574219
local_in_edges_tensor generation: 0.0016167163848876953
mini_batch_src_global generation: 0.002199888229370117

&&&&&&&&&&&&&&& before remove duplicate length: 76257
r_  generation: 0.025605201721191406

local_output_nid generation: 0.0013587474822998047
local_in_edges_tensor generation: 0.0014660358428955078
mini_batch_src_global generation: 0.002263784408569336

&&&&&&&&&&&&&&& before remove duplicate length: 73104
r_  generation: 0.024888992309570312

local_output_nid generation: 0.0014007091522216797
local_in_edges_tensor generation: 0.0014939308166503906
mini_batch_src_global generation: 0.0022017955780029297

&&&&&&&&&&&&&&& before remove duplicate length: 75533
r_  generation: 0.025645732879638672

local_output_nid generation: 0.0014045238494873047
local_in_edges_tensor generation: 0.001486063003540039
mini_batch_src_global generation: 0.0022153854370117188

&&&&&&&&&&&&&&& before remove duplicate length: 75688
r_  generation: 0.025897741317749023

local_output_nid generation: 0.0013890266418457031
local_in_edges_tensor generation: 0.0013074874877929688
mini_batch_src_global generation: 0.002261638641357422

&&&&&&&&&&&&&&& before remove duplicate length: 73694
r_  generation: 0.026353836059570312

local_output_nid generation: 0.001392364501953125
local_in_edges_tensor generation: 0.0014030933380126953
mini_batch_src_global generation: 0.002261638641357422

&&&&&&&&&&&&&&& before remove duplicate length: 76009
r_  generation: 0.02609992027282715

local_output_nid generation: 0.0013475418090820312
local_in_edges_tensor generation: 0.0013821125030517578
mini_batch_src_global generation: 0.0021729469299316406

&&&&&&&&&&&&&&& before remove duplicate length: 72540
r_  generation: 0.02517986297607422

local_output_nid generation: 0.0014045238494873047
local_in_edges_tensor generation: 0.0014574527740478516
mini_batch_src_global generation: 0.002343416213989258

&&&&&&&&&&&&&&& before remove duplicate length: 77944
r_  generation: 0.02744007110595703

local_output_nid generation: 0.010035037994384766
local_in_edges_tensor generation: 0.001329660415649414
mini_batch_src_global generation: 0.0022759437561035156

&&&&&&&&&&&&&&& before remove duplicate length: 73457
r_  generation: 0.02563619613647461

local_output_nid generation: 0.0020134449005126953
local_in_edges_tensor generation: 0.0014121532440185547
mini_batch_src_global generation: 0.0022792816162109375

&&&&&&&&&&&&&&& before remove duplicate length: 77935
r_  generation: 0.02608799934387207

local_output_nid generation: 0.001477956771850586
local_in_edges_tensor generation: 0.0013282299041748047
mini_batch_src_global generation: 0.0023224353790283203

&&&&&&&&&&&&&&& before remove duplicate length: 78320
r_  generation: 0.026958465576171875

local_output_nid generation: 0.001336812973022461
local_in_edges_tensor generation: 0.0012774467468261719
mini_batch_src_global generation: 0.002215862274169922

&&&&&&&&&&&&&&& before remove duplicate length: 71577
r_  generation: 0.04404759407043457

local_output_nid generation: 0.0018334388732910156
local_in_edges_tensor generation: 0.0019180774688720703
mini_batch_src_global generation: 0.004034996032714844

&&&&&&&&&&&&&&& before remove duplicate length: 72647
r_  generation: 0.025627613067626953

local_output_nid generation: 0.00133514404296875
local_in_edges_tensor generation: 0.001245260238647461
mini_batch_src_global generation: 0.002138376235961914

&&&&&&&&&&&&&&& before remove duplicate length: 70108
r_  generation: 0.024260520935058594

local_output_nid generation: 0.0013763904571533203
local_in_edges_tensor generation: 0.0013072490692138672
mini_batch_src_global generation: 0.002214193344116211

&&&&&&&&&&&&&&& before remove duplicate length: 75659
r_  generation: 0.024976253509521484

local_output_nid generation: 0.0014009475708007812
local_in_edges_tensor generation: 0.0014162063598632812
mini_batch_src_global generation: 0.0022580623626708984

&&&&&&&&&&&&&&& before remove duplicate length: 76559
r_  generation: 0.02556777000427246

local_output_nid generation: 0.0013875961303710938
local_in_edges_tensor generation: 0.0014247894287109375
mini_batch_src_global generation: 0.0023021697998046875

&&&&&&&&&&&&&&& before remove duplicate length: 77752
r_  generation: 0.025628089904785156

local_output_nid generation: 0.0013403892517089844
local_in_edges_tensor generation: 0.0012707710266113281
mini_batch_src_global generation: 0.0021865367889404297

&&&&&&&&&&&&&&& before remove duplicate length: 71159
r_  generation: 0.02385735511779785

local_output_nid generation: 0.0013229846954345703
local_in_edges_tensor generation: 0.0012466907501220703
mini_batch_src_global generation: 0.002074718475341797

&&&&&&&&&&&&&&& before remove duplicate length: 68370
r_  generation: 0.024721622467041016

local_output_nid generation: 0.0013942718505859375
local_in_edges_tensor generation: 0.0012497901916503906
mini_batch_src_global generation: 0.002097606658935547

&&&&&&&&&&&&&&& before remove duplicate length: 73065
r_  generation: 0.025037050247192383

local_output_nid generation: 0.0013427734375
local_in_edges_tensor generation: 0.0012040138244628906
mini_batch_src_global generation: 0.0021452903747558594

&&&&&&&&&&&&&&& before remove duplicate length: 70132
r_  generation: 0.023084402084350586

local_output_nid generation: 0.0013267993927001953
local_in_edges_tensor generation: 0.001239776611328125
mini_batch_src_global generation: 0.002134084701538086

&&&&&&&&&&&&&&& before remove duplicate length: 71649
r_  generation: 0.024121761322021484

local_output_nid generation: 0.0013422966003417969
local_in_edges_tensor generation: 0.0012600421905517578
mini_batch_src_global generation: 0.002162456512451172

&&&&&&&&&&&&&&& before remove duplicate length: 70875
r_  generation: 0.02422046661376953

local_output_nid generation: 0.001386880874633789
local_in_edges_tensor generation: 0.0012509822845458984
mini_batch_src_global generation: 0.0021436214447021484

&&&&&&&&&&&&&&& before remove duplicate length: 73445
r_  generation: 0.024011850357055664

local_output_nid generation: 0.0013279914855957031
local_in_edges_tensor generation: 0.0012218952178955078
mini_batch_src_global generation: 0.002089977264404297

&&&&&&&&&&&&&&& before remove duplicate length: 69399
r_  generation: 0.023653745651245117

local_output_nid generation: 0.0014104843139648438
local_in_edges_tensor generation: 0.001285552978515625
mini_batch_src_global generation: 0.002207517623901367

&&&&&&&&&&&&&&& before remove duplicate length: 75936
r_  generation: 0.025688648223876953

local_output_nid generation: 0.0013570785522460938
local_in_edges_tensor generation: 0.0012621879577636719
mini_batch_src_global generation: 0.002179861068725586

&&&&&&&&&&&&&&& before remove duplicate length: 70934
r_  generation: 0.023562908172607422

local_output_nid generation: 0.0013701915740966797
local_in_edges_tensor generation: 0.0012726783752441406
mini_batch_src_global generation: 0.0023467540740966797

&&&&&&&&&&&&&&& before remove duplicate length: 75936
r_  generation: 0.025264501571655273

local_output_nid generation: 0.001392364501953125
local_in_edges_tensor generation: 0.0016677379608154297
mini_batch_src_global generation: 0.002348661422729492

&&&&&&&&&&&&&&& before remove duplicate length: 78937
r_  generation: 0.026948213577270508

local_output_nid generation: 0.0013661384582519531
local_in_edges_tensor generation: 0.0015156269073486328
mini_batch_src_global generation: 0.002312898635864258

&&&&&&&&&&&&&&& before remove duplicate length: 76528
r_  generation: 0.025664091110229492

local_output_nid generation: 0.001344442367553711
local_in_edges_tensor generation: 0.0012636184692382812
mini_batch_src_global generation: 0.002265453338623047

&&&&&&&&&&&&&&& before remove duplicate length: 74289
r_  generation: 0.02550506591796875

local_output_nid generation: 0.001402139663696289
local_in_edges_tensor generation: 0.0013127326965332031
mini_batch_src_global generation: 0.0023403167724609375

&&&&&&&&&&&&&&& before remove duplicate length: 78063
r_  generation: 0.026840925216674805

local_output_nid generation: 0.0014243125915527344
local_in_edges_tensor generation: 0.00157928466796875
mini_batch_src_global generation: 0.002368927001953125

&&&&&&&&&&&&&&& before remove duplicate length: 78216
r_  generation: 0.02701401710510254

local_output_nid generation: 0.001413583755493164
local_in_edges_tensor generation: 0.0015904903411865234
mini_batch_src_global generation: 0.002357006072998047

&&&&&&&&&&&&&&& before remove duplicate length: 78383
r_  generation: 0.02723979949951172

local_output_nid generation: 0.0013668537139892578
local_in_edges_tensor generation: 0.0015234947204589844
mini_batch_src_global generation: 0.0023140907287597656

&&&&&&&&&&&&&&& before remove duplicate length: 74014
r_  generation: 0.025621414184570312

local_output_nid generation: 0.0014138221740722656
local_in_edges_tensor generation: 0.0013201236724853516
mini_batch_src_global generation: 0.002352476119995117

&&&&&&&&&&&&&&& before remove duplicate length: 78628
r_  generation: 0.027109622955322266

local_output_nid generation: 0.001331329345703125
local_in_edges_tensor generation: 0.0015003681182861328
mini_batch_src_global generation: 0.0023169517517089844

&&&&&&&&&&&&&&& before remove duplicate length: 74282
r_  generation: 0.025777578353881836

local_output_nid generation: 0.0014295578002929688
local_in_edges_tensor generation: 0.0015621185302734375
mini_batch_src_global generation: 0.002363920211791992

&&&&&&&&&&&&&&& before remove duplicate length: 78833
r_  generation: 0.027895212173461914

local_output_nid generation: 0.0013513565063476562
local_in_edges_tensor generation: 0.001500844955444336
mini_batch_src_global generation: 0.002311229705810547

&&&&&&&&&&&&&&& before remove duplicate length: 74038
r_  generation: 0.04106950759887695

local_output_nid generation: 0.0019927024841308594
local_in_edges_tensor generation: 0.002388477325439453
mini_batch_src_global generation: 0.005357980728149414

&&&&&&&&&&&&&&& before remove duplicate length: 78107
r_  generation: 0.029326677322387695

local_output_nid generation: 0.0014209747314453125
local_in_edges_tensor generation: 0.0015764236450195312
mini_batch_src_global generation: 0.0023584365844726562

&&&&&&&&&&&&&&& before remove duplicate length: 78120
r_  generation: 0.0270230770111084

local_output_nid generation: 0.0013921260833740234
local_in_edges_tensor generation: 0.0017120838165283203
mini_batch_src_global generation: 0.0023293495178222656

&&&&&&&&&&&&&&& before remove duplicate length: 74516
r_  generation: 0.025511741638183594

local_output_nid generation: 0.001413583755493164
local_in_edges_tensor generation: 0.0015270709991455078
mini_batch_src_global generation: 0.002360105514526367

&&&&&&&&&&&&&&& before remove duplicate length: 78588
r_  generation: 0.027372360229492188

local_output_nid generation: 0.0014138221740722656
local_in_edges_tensor generation: 0.0015630722045898438
mini_batch_src_global generation: 0.0023806095123291016

&&&&&&&&&&&&&&& before remove duplicate length: 78024
r_  generation: 0.027482271194458008

local_output_nid generation: 0.0013995170593261719
local_in_edges_tensor generation: 0.0014181137084960938
mini_batch_src_global generation: 0.0021638870239257812

&&&&&&&&&&&&&&& before remove duplicate length: 64921
r_  generation: 0.02263808250427246

local_output_nid generation: 0.0013587474822998047
local_in_edges_tensor generation: 0.001268148422241211
mini_batch_src_global generation: 0.0021049976348876953

&&&&&&&&&&&&&&& before remove duplicate length: 73247
r_  generation: 0.039038896560668945

local_output_nid generation: 0.002298116683959961
local_in_edges_tensor generation: 0.002232789993286133
mini_batch_src_global generation: 0.0029458999633789062

&&&&&&&&&&&&&&& before remove duplicate length: 75776
r_  generation: 0.02736210823059082

local_output_nid generation: 0.0020494461059570312
local_in_edges_tensor generation: 0.0017800331115722656
mini_batch_src_global generation: 0.004778146743774414

&&&&&&&&&&&&&&& before remove duplicate length: 57149
r_  generation: 0.022093534469604492

local_output_nid generation: 0.0014405250549316406
local_in_edges_tensor generation: 0.0012788772583007812
mini_batch_src_global generation: 0.00200653076171875

&&&&&&&&&&&&&&& before remove duplicate length: 72939
r_  generation: 0.023923873901367188

local_output_nid generation: 0.0014309883117675781
local_in_edges_tensor generation: 0.0015060901641845703
mini_batch_src_global generation: 0.002125978469848633

&&&&&&&&&&&&&&& before remove duplicate length: 72105
r_  generation: 0.02461385726928711

local_output_nid generation: 0.0014803409576416016
local_in_edges_tensor generation: 0.00154876708984375
mini_batch_src_global generation: 0.002191781997680664

&&&&&&&&&&&&&&& before remove duplicate length: 75706
r_  generation: 0.02437448501586914

local_output_nid generation: 0.0014853477478027344
local_in_edges_tensor generation: 0.001676321029663086
mini_batch_src_global generation: 0.0022535324096679688

&&&&&&&&&&&&&&& before remove duplicate length: 78133
r_  generation: 0.0258181095123291

local_output_nid generation: 0.00147247314453125
local_in_edges_tensor generation: 0.0012695789337158203
mini_batch_src_global generation: 0.0021958351135253906

&&&&&&&&&&&&&&& before remove duplicate length: 73138
r_  generation: 0.02465224266052246

local_output_nid generation: 0.0014166831970214844
local_in_edges_tensor generation: 0.0012443065643310547
mini_batch_src_global generation: 0.0021190643310546875

&&&&&&&&&&&&&&& before remove duplicate length: 71354
r_  generation: 0.023992300033569336

local_output_nid generation: 0.0014371871948242188
local_in_edges_tensor generation: 0.0014472007751464844
mini_batch_src_global generation: 0.0023250579833984375

&&&&&&&&&&&&&&& before remove duplicate length: 73602
r_  generation: 0.024892807006835938


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7052249908447266
gen group dst list time:  0.0622560977935791
check_connections_block*********************************
time for parepare 1: 0.3722116947174072
local_output_nid generation: 0.010796546936035156
local_in_edges_tensor generation: 0.0728003978729248
mini_batch_src_global generation: 0.009720087051391602

&&&&&&&&&&&&&&& before remove duplicate length: 288830
r_  generation: 0.10679936408996582

local_output_nid generation: 0.011741161346435547
local_in_edges_tensor generation: 0.012460470199584961
mini_batch_src_global generation: 0.012960433959960938

&&&&&&&&&&&&&&& before remove duplicate length: 280664
r_  generation: 0.11390304565429688

local_output_nid generation: 0.010960578918457031
local_in_edges_tensor generation: 0.012198448181152344
mini_batch_src_global generation: 0.011485099792480469

&&&&&&&&&&&&&&& before remove duplicate length: 321402
r_  generation: 0.12948012351989746

local_output_nid generation: 0.009456634521484375
local_in_edges_tensor generation: 0.012012481689453125
mini_batch_src_global generation: 0.01131129264831543

&&&&&&&&&&&&&&& before remove duplicate length: 263784
r_  generation: 0.110504150390625

local_output_nid generation: 0.011827707290649414
local_in_edges_tensor generation: 0.015272855758666992
mini_batch_src_global generation: 0.014850854873657227

&&&&&&&&&&&&&&& before remove duplicate length: 361326
r_  generation: 0.15230798721313477

local_output_nid generation: 0.011734247207641602
local_in_edges_tensor generation: 0.013759851455688477
mini_batch_src_global generation: 0.01603984832763672

&&&&&&&&&&&&&&& before remove duplicate length: 342637
r_  generation: 0.14898371696472168

local_output_nid generation: 0.011689424514770508
local_in_edges_tensor generation: 0.01368093490600586
mini_batch_src_global generation: 0.015438318252563477

&&&&&&&&&&&&&&& before remove duplicate length: 351034
r_  generation: 0.15121984481811523

local_output_nid generation: 0.0120697021484375
local_in_edges_tensor generation: 0.010856866836547852
mini_batch_src_global generation: 0.015853166580200195

&&&&&&&&&&&&&&& before remove duplicate length: 346615
r_  generation: 0.15366148948669434

local_output_nid generation: 0.009557485580444336
local_in_edges_tensor generation: 0.008730411529541016
mini_batch_src_global generation: 0.013666629791259766

&&&&&&&&&&&&&&& before remove duplicate length: 266363
r_  generation: 0.12044286727905273

local_output_nid generation: 0.010721445083618164
local_in_edges_tensor generation: 0.01318979263305664
mini_batch_src_global generation: 0.014458894729614258

&&&&&&&&&&&&&&& before remove duplicate length: 306482
r_  generation: 0.1375138759613037

local_output_nid generation: 0.01061558723449707
local_in_edges_tensor generation: 0.01038360595703125
mini_batch_src_global generation: 0.015986204147338867

&&&&&&&&&&&&&&& before remove duplicate length: 321755
r_  generation: 0.1425771713256836

local_output_nid generation: 0.01016688346862793
local_in_edges_tensor generation: 0.011267900466918945
mini_batch_src_global generation: 0.013793706893920898

&&&&&&&&&&&&&&& before remove duplicate length: 286454
r_  generation: 0.12973809242248535

local_output_nid generation: 0.012160301208496094
local_in_edges_tensor generation: 0.011568069458007812
mini_batch_src_global generation: 0.015965700149536133

&&&&&&&&&&&&&&& before remove duplicate length: 358024
r_  generation: 0.16087985038757324

local_output_nid generation: 0.012113809585571289
local_in_edges_tensor generation: 0.014403343200683594
mini_batch_src_global generation: 0.016849040985107422

&&&&&&&&&&&&&&& before remove duplicate length: 352288
r_  generation: 0.16443991661071777

local_output_nid generation: 0.009566307067871094
local_in_edges_tensor generation: 0.009785652160644531
mini_batch_src_global generation: 0.015021800994873047

&&&&&&&&&&&&&&& before remove duplicate length: 290124
r_  generation: 0.12893056869506836

local_output_nid generation: 0.014410018920898438
local_in_edges_tensor generation: 0.017792224884033203
mini_batch_src_global generation: 0.018982410430908203

&&&&&&&&&&&&&&& before remove duplicate length: 417449
r_  generation: 0.2087993621826172

local_output_nid generation: 0.012061119079589844
local_in_edges_tensor generation: 0.010548591613769531
mini_batch_src_global generation: 0.017745256423950195

&&&&&&&&&&&&&&& before remove duplicate length: 353733
r_  generation: 0.16508936882019043

local_output_nid generation: 0.009284496307373047
local_in_edges_tensor generation: 0.030803680419921875
mini_batch_src_global generation: 0.014188528060913086

&&&&&&&&&&&&&&& before remove duplicate length: 284368
r_  generation: 0.12746405601501465

local_output_nid generation: 0.010546207427978516
local_in_edges_tensor generation: 0.02623772621154785
mini_batch_src_global generation: 0.01683497428894043

&&&&&&&&&&&&&&& before remove duplicate length: 325469
r_  generation: 0.1428523063659668

local_output_nid generation: 0.010425090789794922
local_in_edges_tensor generation: 0.0192720890045166
mini_batch_src_global generation: 0.014882326126098633

&&&&&&&&&&&&&&& before remove duplicate length: 320579
r_  generation: 0.1415407657623291

local_output_nid generation: 0.010111331939697266
local_in_edges_tensor generation: 0.018085479736328125
mini_batch_src_global generation: 0.01576709747314453

&&&&&&&&&&&&&&& before remove duplicate length: 298471
r_  generation: 0.13410425186157227

local_output_nid generation: 0.009137153625488281
local_in_edges_tensor generation: 0.011089801788330078
mini_batch_src_global generation: 0.012877464294433594

&&&&&&&&&&&&&&& before remove duplicate length: 264861
r_  generation: 0.11871838569641113

local_output_nid generation: 0.01105046272277832
local_in_edges_tensor generation: 0.01446390151977539
mini_batch_src_global generation: 0.015469789505004883

&&&&&&&&&&&&&&& before remove duplicate length: 317913
r_  generation: 0.1388111114501953

local_output_nid generation: 0.00885009765625
local_in_edges_tensor generation: 0.013259649276733398
mini_batch_src_global generation: 0.013233661651611328

&&&&&&&&&&&&&&& before remove duplicate length: 250082
r_  generation: 0.10568428039550781

local_output_nid generation: 0.009187698364257812
local_in_edges_tensor generation: 0.009296655654907227
mini_batch_src_global generation: 0.012188911437988281

&&&&&&&&&&&&&&& before remove duplicate length: 269418
r_  generation: 0.11869621276855469

local_output_nid generation: 0.008284807205200195
local_in_edges_tensor generation: 0.007958650588989258
mini_batch_src_global generation: 0.011409997940063477

&&&&&&&&&&&&&&& before remove duplicate length: 239247
r_  generation: 0.10081076622009277

local_output_nid generation: 0.009791135787963867
local_in_edges_tensor generation: 0.009624958038330078
mini_batch_src_global generation: 0.012565374374389648

&&&&&&&&&&&&&&& before remove duplicate length: 288935
r_  generation: 0.1277327537536621

local_output_nid generation: 0.010914325714111328
local_in_edges_tensor generation: 0.010004043579101562
mini_batch_src_global generation: 0.015694618225097656

&&&&&&&&&&&&&&& before remove duplicate length: 323433
r_  generation: 0.14404082298278809

local_output_nid generation: 0.009833097457885742
local_in_edges_tensor generation: 0.00865793228149414
mini_batch_src_global generation: 0.013527631759643555

&&&&&&&&&&&&&&& before remove duplicate length: 288919
r_  generation: 0.1264352798461914

local_output_nid generation: 0.013792991638183594
local_in_edges_tensor generation: 0.007895708084106445
mini_batch_src_global generation: 0.011795997619628906

&&&&&&&&&&&&&&& before remove duplicate length: 234865
r_  generation: 0.09542059898376465

local_output_nid generation: 0.011559009552001953
local_in_edges_tensor generation: 0.016109466552734375
mini_batch_src_global generation: 0.01505422592163086

&&&&&&&&&&&&&&& before remove duplicate length: 312234
r_  generation: 0.13353323936462402

local_output_nid generation: 0.0245664119720459
local_in_edges_tensor generation: 0.009032011032104492
mini_batch_src_global generation: 0.013856649398803711

&&&&&&&&&&&&&&& before remove duplicate length: 287445
r_  generation: 0.1227715015411377

local_output_nid generation: 0.011082649230957031
local_in_edges_tensor generation: 0.0070476531982421875
mini_batch_src_global generation: 0.012001991271972656

&&&&&&&&&&&&&&& before remove duplicate length: 230288
r_  generation: 0.09130573272705078

local_output_nid generation: 0.013745784759521484
local_in_edges_tensor generation: 0.012166023254394531
mini_batch_src_global generation: 0.015471458435058594

&&&&&&&&&&&&&&& before remove duplicate length: 368497
r_  generation: 0.16553282737731934

local_output_nid generation: 0.00951242446899414
local_in_edges_tensor generation: 0.008765459060668945
mini_batch_src_global generation: 0.014174461364746094

&&&&&&&&&&&&&&& before remove duplicate length: 277465
r_  generation: 0.11319470405578613

local_output_nid generation: 0.008044958114624023
local_in_edges_tensor generation: 0.006533145904541016
mini_batch_src_global generation: 0.010769367218017578

&&&&&&&&&&&&&&& before remove duplicate length: 233471
r_  generation: 0.09303760528564453

local_output_nid generation: 0.010381937026977539
local_in_edges_tensor generation: 0.00866556167602539
mini_batch_src_global generation: 0.014004707336425781

&&&&&&&&&&&&&&& before remove duplicate length: 324540
r_  generation: 0.13621306419372559

local_output_nid generation: 0.01160120964050293
local_in_edges_tensor generation: 0.009595870971679688
mini_batch_src_global generation: 0.015369415283203125

&&&&&&&&&&&&&&& before remove duplicate length: 340578
r_  generation: 0.14546751976013184

local_output_nid generation: 0.008820295333862305
local_in_edges_tensor generation: 0.007445096969604492
mini_batch_src_global generation: 0.01245260238647461

&&&&&&&&&&&&&&& before remove duplicate length: 262478
r_  generation: 0.1078033447265625

local_output_nid generation: 0.010543346405029297
local_in_edges_tensor generation: 0.008611202239990234
mini_batch_src_global generation: 0.013904809951782227

&&&&&&&&&&&&&&& before remove duplicate length: 318950
r_  generation: 0.13473224639892578

local_output_nid generation: 0.012776374816894531
local_in_edges_tensor generation: 0.014979124069213867
mini_batch_src_global generation: 0.018037080764770508

&&&&&&&&&&&&&&& before remove duplicate length: 384876
r_  generation: 0.16739749908447266

local_output_nid generation: 0.01420903205871582
local_in_edges_tensor generation: 0.01688981056213379
mini_batch_src_global generation: 0.019087791442871094

&&&&&&&&&&&&&&& before remove duplicate length: 400689
r_  generation: 0.18159699440002441

local_output_nid generation: 0.012919425964355469
local_in_edges_tensor generation: 0.011013031005859375
mini_batch_src_global generation: 0.017962932586669922

&&&&&&&&&&&&&&& before remove duplicate length: 374560
r_  generation: 0.17073559761047363

local_output_nid generation: 0.010915040969848633
local_in_edges_tensor generation: 0.009206771850585938
mini_batch_src_global generation: 0.01609516143798828

&&&&&&&&&&&&&&& before remove duplicate length: 316786
r_  generation: 0.14555954933166504

local_output_nid generation: 0.012871742248535156
local_in_edges_tensor generation: 0.011281013488769531
mini_batch_src_global generation: 0.01888251304626465

&&&&&&&&&&&&&&& before remove duplicate length: 380506
r_  generation: 0.16794133186340332

local_output_nid generation: 0.013655424118041992
local_in_edges_tensor generation: 0.013411283493041992
mini_batch_src_global generation: 0.01878666877746582

&&&&&&&&&&&&&&& before remove duplicate length: 391795
r_  generation: 0.19515752792358398

local_output_nid generation: 0.014907121658325195
local_in_edges_tensor generation: 0.01379251480102539
mini_batch_src_global generation: 0.021701574325561523

&&&&&&&&&&&&&&& before remove duplicate length: 420481
r_  generation: 0.19512009620666504

local_output_nid generation: 0.01472330093383789
local_in_edges_tensor generation: 0.01611948013305664
mini_batch_src_global generation: 0.019663572311401367

&&&&&&&&&&&&&&& before remove duplicate length: 409784
r_  generation: 0.1961674690246582

local_output_nid generation: 0.010994195938110352
local_in_edges_tensor generation: 0.00860452651977539
mini_batch_src_global generation: 0.01751708984375

&&&&&&&&&&&&&&& before remove duplicate length: 338973
r_  generation: 0.15235495567321777

local_output_nid generation: 0.011432170867919922
local_in_edges_tensor generation: 0.009611845016479492
mini_batch_src_global generation: 0.0161130428314209

&&&&&&&&&&&&&&& before remove duplicate length: 338881
r_  generation: 0.1505417823791504

local_output_nid generation: 0.011898994445800781
local_in_edges_tensor generation: 0.010231733322143555
mini_batch_src_global generation: 0.0166933536529541

&&&&&&&&&&&&&&& before remove duplicate length: 331632
r_  generation: 0.15249133110046387

local_output_nid generation: 0.014831066131591797
local_in_edges_tensor generation: 0.010434150695800781
mini_batch_src_global generation: 0.0171201229095459

&&&&&&&&&&&&&&& before remove duplicate length: 365336
r_  generation: 0.1642932891845703

local_output_nid generation: 0.011670351028442383
local_in_edges_tensor generation: 0.009452104568481445
mini_batch_src_global generation: 0.01676464080810547

&&&&&&&&&&&&&&& before remove duplicate length: 356984
r_  generation: 0.16132545471191406

local_output_nid generation: 0.011218070983886719
local_in_edges_tensor generation: 0.010367393493652344
mini_batch_src_global generation: 0.015844106674194336

&&&&&&&&&&&&&&& before remove duplicate length: 308780
r_  generation: 0.14438319206237793

local_output_nid generation: 0.010925769805908203
local_in_edges_tensor generation: 0.009783267974853516
mini_batch_src_global generation: 0.016118526458740234

&&&&&&&&&&&&&&& before remove duplicate length: 344100
r_  generation: 0.15913963317871094

local_output_nid generation: 0.012370586395263672
local_in_edges_tensor generation: 0.011716365814208984
mini_batch_src_global generation: 0.017771244049072266

&&&&&&&&&&&&&&& before remove duplicate length: 364965
r_  generation: 0.17153286933898926

local_output_nid generation: 0.011162996292114258
local_in_edges_tensor generation: 0.009716510772705078
mini_batch_src_global generation: 0.015808582305908203

&&&&&&&&&&&&&&& before remove duplicate length: 297367
r_  generation: 0.14480948448181152

local_output_nid generation: 0.010716438293457031
local_in_edges_tensor generation: 0.010900020599365234
mini_batch_src_global generation: 0.01455235481262207

&&&&&&&&&&&&&&& before remove duplicate length: 307770
r_  generation: 0.14787530899047852

local_output_nid generation: 0.009829521179199219
local_in_edges_tensor generation: 0.008428096771240234
mini_batch_src_global generation: 0.014785051345825195

&&&&&&&&&&&&&&& before remove duplicate length: 278844
r_  generation: 0.12859058380126953

local_output_nid generation: 0.009401321411132812
local_in_edges_tensor generation: 0.008061408996582031
mini_batch_src_global generation: 0.013402462005615234

&&&&&&&&&&&&&&& before remove duplicate length: 264784
r_  generation: 0.11755990982055664

local_output_nid generation: 0.008062601089477539
local_in_edges_tensor generation: 0.006920576095581055
mini_batch_src_global generation: 0.012209892272949219

&&&&&&&&&&&&&&& before remove duplicate length: 252274
r_  generation: 0.1029658317565918

local_output_nid generation: 0.011047601699829102
local_in_edges_tensor generation: 0.009960651397705078
mini_batch_src_global generation: 0.014621257781982422

&&&&&&&&&&&&&&& before remove duplicate length: 334853
r_  generation: 0.14700698852539062

local_output_nid generation: 0.01270151138305664
local_in_edges_tensor generation: 0.011394739151000977
mini_batch_src_global generation: 0.017014026641845703

&&&&&&&&&&&&&&& before remove duplicate length: 360129
r_  generation: 0.18625545501708984

local_output_nid generation: 0.012677192687988281
local_in_edges_tensor generation: 0.012214422225952148
mini_batch_src_global generation: 0.01717853546142578

&&&&&&&&&&&&&&& before remove duplicate length: 362104
r_  generation: 0.17308878898620605


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043170928955078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

connection checking time:  16.923425674438477
block generation total time  14.950164794921875
average batch blocks generation time:  0.2335963249206543
block dataloader generation time/epoch 63.824436267217
pseudo mini batch 0 input nodes size: 108322
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03505134582519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03505134582519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07540464401245117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07542848587036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04205131530761719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04478263854980469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04478263854980469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 108322
first layer output nodes number: 29576
edges number: 288830
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045810699462890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([108322, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045810699462890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045810699462890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059355735778808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059355735778808594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08756160736083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29576, 256])
h_self size  torch.Size([29576, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08756160736083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29576, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1157674789428711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08756160736083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29576, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1157674789428711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1228189468383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29576
----------------output nodes number: 3163
----------------edges number: 77679
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12306356430053711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12306356430053711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1267104148864746  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1267104148864746  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12726449966430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12726449966430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12781858444213867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12726449966430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12726593017578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1278209686279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049864768981933594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 1 input nodes size: 107363
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0420536994934082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08204984664916992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08207225799560547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04169511795043945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04433107376098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04433107376098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 107363
first layer output nodes number: 28816
edges number: 280664
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04534626007080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([107363, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04534626007080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04534626007080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05828046798706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05828046798706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576154708862305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28816, 256])
h_self size  torch.Size([28816, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576154708862305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28816, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11324262619018555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08576154708862305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28816, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11324262619018555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12011289596557617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28816
----------------output nodes number: 2985
----------------edges number: 72968
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12035036087036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12035036087036133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12468671798706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12468671798706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12520980834960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2985, 47])
h_self size  torch.Size([2985, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12520980834960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2985, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1257328987121582  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12520980834960938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2985, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12517881393432617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1257023811340332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048960208892822266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 2 input nodes size: 134943
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04166412353515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04166412353515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0919346809387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09195709228515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051938533782958984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05487680435180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05487680435180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 134943
first layer output nodes number: 32670
edges number: 321402
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05612611770629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([134943, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05612611770629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05612611770629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07099008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07099008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32670, 256])
h_self size  torch.Size([32670, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32670, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13349008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10224008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32670, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13349008560180664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1412792205810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32670
----------------output nodes number: 2983
----------------edges number: 72934
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14154529571533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14154529571533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1449565887451172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1449565887451172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1454792022705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2983, 47])
h_self size  torch.Size([2983, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1454792022705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14600181579589844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1454792022705078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2983, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1454787254333496  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14600181579589844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06030559539794922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 3 input nodes size: 106042
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05193805694580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05193805694580078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09144210815429688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09146595001220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04117298126220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043717384338378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043717384338378906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 106042
first layer output nodes number: 26956
edges number: 263784
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0447087287902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([106042, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0447087287902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0447087287902832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0575108528137207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0575108528137207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08321809768676758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([26956, 256])
h_self size  torch.Size([26956, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08321809768676758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26956, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10892534255981445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08321809768676758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26956, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10892534255981445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11535215377807617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 26956
----------------output nodes number: 3160
----------------edges number: 77630
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11557722091674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11557722091674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11919355392456055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11919355392456055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974716186523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3160, 47])
h_self size  torch.Size([3160, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974716186523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3160, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1203007698059082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11974716186523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3160, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11977815628051758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12033224105834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048995018005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 4 input nodes size: 124738
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041203975677490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041203975677490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08807897567749023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08810234069824219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04857444763183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051837921142578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051837921142578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 124738
first layer output nodes number: 36393
edges number: 361326
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0530390739440918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([124738, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0530390739440918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0530390739440918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06942510604858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06942510604858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10458135604858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36393, 256])
h_self size  torch.Size([36393, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10458135604858398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36393, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13928842544555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10413217544555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36393, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13928842544555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1483149528503418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36393
----------------output nodes number: 3075
----------------edges number: 76566
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14860963821411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14860963821411133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15213727951049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15213727951049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15267610549926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3075, 47])
h_self size  torch.Size([3075, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15267610549926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3075, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1532149314880371  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15267610549926758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3075, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15266132354736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15320062637329102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05743741989135742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 5 input nodes size: 123450
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855966567993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855966567993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09454870223999023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09457206726074219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047673702239990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05109071731567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05109071731567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 123450
first layer output nodes number: 34653
edges number: 342637
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05226898193359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([123450, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05226898193359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05226898193359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06786060333251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06786060333251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10090827941894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34653, 256])
h_self size  torch.Size([34653, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10090827941894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34653, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1339559555053711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10090827941894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34653, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1339559555053711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14221811294555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34653
----------------output nodes number: 3128
----------------edges number: 77539
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1424999237060547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1424999237060547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14608478546142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14608478546142578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14663267135620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3128, 47])
h_self size  torch.Size([3128, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14663267135620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3128, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14718055725097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14663267135620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3128, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14664173126220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14719009399414062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.056539058685302734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 6 input nodes size: 138959
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047682762145996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047682762145996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09944915771484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0994729995727539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05346059799194336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05696821212768555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05696821212768555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 138959
first layer output nodes number: 35420
edges number: 351034
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058268070220947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([138959, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058268070220947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058268070220947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07421112060546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07421112060546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10799026489257812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35420, 256])
h_self size  torch.Size([35420, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10799026489257812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35420, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1417694091796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10799026489257812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35420, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1417694091796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15021419525146484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35420
----------------output nodes number: 3161
----------------edges number: 78678
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15050220489501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15050220489501953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1541271209716797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1541271209716797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15468072891235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15468072891235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15523433685302734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15468072891235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15468645095825195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15524053573608398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06262683868408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 7 input nodes size: 153852
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0534663200378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0534663200378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11078071594238281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11080312728881836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05901288986206055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0627889633178711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0627889633178711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 153852
first layer output nodes number: 35524
edges number: 346615
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06420040130615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([153852, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06420040130615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06420040130615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08014965057373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08014965057373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1140279769897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35524, 256])
h_self size  torch.Size([35524, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1140279769897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35524, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14790630340576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1140279769897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35524, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14790630340576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15637588500976562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35524
----------------output nodes number: 2981
----------------edges number: 72838
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1566634178161621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1566634178161621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16007280349731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16007280349731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16059494018554688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16059494018554688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1611170768737793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16059494018554688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16056346893310547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1610860824584961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06840276718139648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 8 input nodes size: 107036
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05898141860961914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05898141860961914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09885549545288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0988779067993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041541099548339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044060707092285156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044060707092285156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 107036
first layer output nodes number: 27686
edges number: 266363
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04506492614746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([107036, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04506492614746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04506492614746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05787944793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05787944793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08522319793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27686, 256])
h_self size  torch.Size([27686, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08522319793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27686, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11256694793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08522319793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27686, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11256694793701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11916780471801758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27686
----------------output nodes number: 2981
----------------edges number: 71728
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11939668655395508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11939668655395508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12279748916625977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12279748916625977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12331962585449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12331962585449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12384176254272461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12331962585449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12331962585449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12384223937988281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04897928237915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 9 input nodes size: 114269
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041541099548339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041541099548339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08410978317260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08413362503051758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04423713684082031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047089576721191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047089576721191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 114269
first layer output nodes number: 31687
edges number: 306482
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([114269, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04817771911621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06326484680175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06326484680175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09348392486572266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31687, 256])
h_self size  torch.Size([31687, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09348392486572266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31687, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1237030029296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09348392486572266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31687, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1237030029296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1312580108642578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31687
----------------output nodes number: 3162
----------------edges number: 76257
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13151836395263672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13151836395263672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13512611389160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13512611389160156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1356801986694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3162, 47])
h_self size  torch.Size([3162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1356801986694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13623428344726562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1356801986694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3162, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1357121467590332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13626670837402344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05301952362060547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 10 input nodes size: 131831
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04426908493041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04426908493041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09337997436523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09340238571166992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05080986022949219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053752899169921875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053752899169921875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 131831
first layer output nodes number: 32967
edges number: 321755
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054981231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([131831, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054981231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054981231689453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06978321075439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06978321075439453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10122299194335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32967, 256])
h_self size  torch.Size([32967, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10122299194335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32967, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13266277313232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10122299194335938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32967, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13266277313232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14052295684814453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32967
----------------output nodes number: 2991
----------------edges number: 73104
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1407914161682129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1407914161682129  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1442122459411621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1442122459411621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14473628997802734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2991, 47])
h_self size  torch.Size([2991, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14473628997802734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2991, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14526033401489258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14473628997802734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2991, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14470624923706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14523077011108398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05896568298339844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 11 input nodes size: 110457
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05077981948852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05077981948852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09192848205566406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09195232391357422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04281902313232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0455169677734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0455169677734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 110457
first layer output nodes number: 29957
edges number: 286454
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656362533569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([110457, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656362533569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656362533569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060541629791259766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060541629791259766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891108512878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29957, 256])
h_self size  torch.Size([29957, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891108512878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29957, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11768007278442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891108512878418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29957, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11768007278442383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1249842643737793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29957
----------------output nodes number: 3157
----------------edges number: 75533
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12523174285888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12523174285888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1288299560546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1288299560546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12938308715820312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3157, 47])
h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12938308715820312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12993621826171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12938308715820312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12941217422485352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12996578216552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05090951919555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 12 input nodes size: 145563
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04284811019897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04284811019897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09753561019897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09755945205688477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05638694763183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059619903564453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.059619903564453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 145563
first layer output nodes number: 37105
edges number: 358024
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06098127365112305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([145563, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06098127365112305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06098127365112305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07761096954345703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07761096954345703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11299705505371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37105, 256])
h_self size  torch.Size([37105, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11299705505371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37105, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14838314056396484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11299705505371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37105, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14838314056396484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15791893005371094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37105
----------------output nodes number: 3147
----------------edges number: 75688
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1582193374633789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1582193374633789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16180896759033203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16180896759033203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16236019134521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3147, 47])
h_self size  torch.Size([3147, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16236019134521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3147, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16291141510009766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16236019134521484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3147, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16235828399658203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16290998458862305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06536579132080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 13 input nodes size: 130413
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.056385040283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.056385040283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10521316528320312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10523605346679688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05052471160888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053699493408203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053699493408203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 130413
first layer output nodes number: 36383
edges number: 352288
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05494260787963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([130413, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05494260787963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05494260787963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0712580680847168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0712580680847168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1064143180847168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36383, 256])
h_self size  torch.Size([36383, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1064143180847168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36383, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1411118507385254  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10595560073852539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36383, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1411118507385254  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15020513534545898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36383
----------------output nodes number: 3050
----------------edges number: 73694
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1504993438720703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1504993438720703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15398025512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15398025512695312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15451431274414062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3050, 47])
h_self size  torch.Size([3050, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15451431274414062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3050, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15504837036132812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15451431274414062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3050, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1544971466064453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15503168106079102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05922698974609375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 14 input nodes size: 96756
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050507545471191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050507545471191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08655214309692383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08657550811767578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03772449493408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04130887985229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04130887985229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 96756
first layer output nodes number: 29600
edges number: 290124
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042250633239746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([96756, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042250633239746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042250633239746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05555009841918945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05555009841918945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08377885818481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29600, 256])
h_self size  torch.Size([29600, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08377885818481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29600, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11200761795043945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08377885818481445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29600, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11200761795043945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1190648078918457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29600
----------------output nodes number: 3104
----------------edges number: 76009
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1193089485168457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1193089485168457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12292051315307617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12292051315307617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12346410751342773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3104, 47])
h_self size  torch.Size([3104, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12346410751342773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3104, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1240077018737793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12346410751342773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3104, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1234736442565918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12401771545410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04603242874145508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 15 input nodes size: 183666
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037734031677246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037734031677246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1061553955078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10617828369140625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07011032104492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0737619400024414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0737619400024414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 183666
first layer output nodes number: 43141
edges number: 417449
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07545232772827148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([183666, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07545232772827148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07545232772827148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09514474868774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09514474868774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13628721237182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([43141, 256])
h_self size  torch.Size([43141, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13628721237182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([43141, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1774296760559082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13628721237182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([43141, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1774296760559082  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1877155303955078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 43141
----------------output nodes number: 3049
----------------edges number: 72540
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18806028366088867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18806028366088867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19153165817260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19153165817260742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19206571578979492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3049, 47])
h_self size  torch.Size([3049, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19206571578979492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3049, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19259977340698242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19206571578979492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3049, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19205617904663086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.19259071350097656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08066272735595703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 16 input nodes size: 131574
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07010078430175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07010078430175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11911630630493164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1191401481628418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05069589614868164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05391263961791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05391263961791992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 131574
first layer output nodes number: 35675
edges number: 353733
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05515909194946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([131574, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05515909194946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05515909194946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07195615768432617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07195615768432617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10597848892211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([35675, 256])
h_self size  torch.Size([35675, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10597848892211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35675, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1400008201599121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10597848892211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([35675, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1400008201599121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14850664138793945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 35675
----------------output nodes number: 3163
----------------edges number: 77944
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14879655838012695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14879655838012695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15241765975952148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15241765975952148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15297174453735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15297174453735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15352582931518555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15297174453735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15299177169799805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15354633331298828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060282230377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 17 input nodes size: 113465
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05071592330932617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05071592330932617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09298515319824219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09300756454467773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04396820068359375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04716825485229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04716825485229492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 113465
first layer output nodes number: 29191
edges number: 284368
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823160171508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([113465, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823160171508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823160171508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06133460998535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06133460998535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891733169555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29191, 256])
h_self size  torch.Size([29191, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891733169555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29191, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11701202392578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0891733169555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29191, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11701202392578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12397193908691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29191
----------------output nodes number: 2996
----------------edges number: 73457
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12421226501464844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12421226501464844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12819385528564453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12819385528564453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12871885299682617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2996, 47])
h_self size  torch.Size([2996, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12871885299682617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2996, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1292438507080078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12871885299682617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2996, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12868976593017578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12921524047851562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.051886558532714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 18 input nodes size: 114959
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04393911361694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04393911361694336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08676481246948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08678865432739258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044497013092041016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047502994537353516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.047502994537353516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 114959
first layer output nodes number: 32866
edges number: 325469
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04860496520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([114959, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04860496520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04860496520996094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06380796432495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06380796432495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09515142440795898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32866, 256])
h_self size  torch.Size([32866, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09515142440795898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32866, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1264948844909668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09515142440795898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32866, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1264948844909668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13433074951171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32866
----------------output nodes number: 3150
----------------edges number: 77935
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1345996856689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1345996856689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13908720016479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13908720016479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13963890075683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3150, 47])
h_self size  torch.Size([3150, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13963890075683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14019060134887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13963890075683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3150, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1396656036376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14021778106689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05315589904785156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 19 input nodes size: 115794
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04452371597290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04452371597290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0876607894897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08768463134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04483509063720703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04839801788330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04839801788330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 115794
first layer output nodes number: 32281
edges number: 320579
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049501895904541016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([115794, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049501895904541016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049501895904541016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0643758773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0643758773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0956258773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32281, 256])
h_self size  torch.Size([32281, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0956258773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32281, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1268758773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0956258773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32281, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1268758773803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13457250595092773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32281
----------------output nodes number: 3141
----------------edges number: 78320
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13483715057373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13483715057373047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13844013214111328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13844013214111328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1389904022216797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3141, 47])
h_self size  torch.Size([3141, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1389904022216797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3141, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1395406723022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1389904022216797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3141, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13898897171020508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1395397186279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053913116455078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 20 input nodes size: 114613
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04483366012573242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04483366012573242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08753061294555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08755302429199219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04439210891723633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0471501350402832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0471501350402832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 114613
first layer output nodes number: 30886
edges number: 298471
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823446273803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([114613, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823446273803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04823446273803711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06292200088500977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06292200088500977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0923771858215332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30886, 256])
h_self size  torch.Size([30886, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0923771858215332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30886, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12183237075805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0923771858215332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30886, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12183237075805664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1291961669921875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30886
----------------output nodes number: 2981
----------------edges number: 71577
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12944889068603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12944889068603516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13284873962402344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13284873962402344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13337087631225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13337087631225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13389301300048828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13337087631225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13334274291992188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1338653564453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05283546447753906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 21 input nodes size: 92545
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044363975524902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044363975524902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07952022552490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07954263687133789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036823272705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03933906555175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03933906555175781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 92545
first layer output nodes number: 27265
edges number: 264861
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04023265838623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([92545, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04023265838623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04023265838623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05295753479003906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05295753479003906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07895946502685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27265, 256])
h_self size  torch.Size([27265, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07895946502685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27265, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10496139526367188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07895946502685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27265, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10496139526367188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11146211624145508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27265
----------------output nodes number: 2981
----------------edges number: 72647
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11168813705444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11168813705444336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11509561538696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11509561538696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11561775207519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11561775207519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11613988876342773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11561775207519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11561775207519531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11614036560058594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04422330856323242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 22 input nodes size: 122444
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036823272705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036823272705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08243751525878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08245992660522461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04728126525878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05024909973144531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05024909973144531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 122444
first layer output nodes number: 32872
edges number: 317913
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0514068603515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([122444, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0514068603515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0514068603515625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06632280349731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06632280349731445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0976719856262207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32872, 256])
h_self size  torch.Size([32872, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0976719856262207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32872, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12902116775512695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0976719856262207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32872, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12902116775512695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13685846328735352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32872
----------------output nodes number: 2982
----------------edges number: 70108
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13712596893310547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13712596893310547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14051532745361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14051532745361328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1410374641418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2982, 47])
h_self size  torch.Size([2982, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1410374641418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14155960083007812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1410374641418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2982, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1410374641418457  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14156007766723633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05552339553833008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 23 input nodes size: 86227
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04728126525878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04728126525878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07940340042114258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07942724227905273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03379058837890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03621864318847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03621864318847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 86227
first layer output nodes number: 25836
edges number: 250082
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03705406188964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([86227, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03705406188964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03705406188964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04863882064819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04863882064819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07327795028686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([25836, 256])
h_self size  torch.Size([25836, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07327795028686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25836, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09791707992553711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07327795028686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25836, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09791707992553711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10407686233520508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 25836
----------------output nodes number: 3151
----------------edges number: 75659
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1042933464050293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1042933464050293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1086282730102539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1086282730102539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10918045043945312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3151, 47])
h_self size  torch.Size([3151, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10918045043945312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3151, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10973262786865234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10918045043945312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3151, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10921049118041992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10976314544677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.040497779846191406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 24 input nodes size: 97203
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03382062911987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03382062911987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07003164291381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07005548477172852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037909507751464844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041332244873046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041332244873046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 97203
first layer output nodes number: 27585
edges number: 269418
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04226255416870117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([97203, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04226255416870117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04226255416870117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.055088043212890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.055088043212890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08139514923095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([27585, 256])
h_self size  torch.Size([27585, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08139514923095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27585, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10770225524902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08139514923095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([27585, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10770225524902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11427927017211914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 27585
----------------output nodes number: 3138
----------------edges number: 76559
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11450910568237305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11450910568237305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11809682846069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11809682846069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3138, 47])
h_self size  torch.Size([3138, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3138, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11919641494750977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11864662170410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3138, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11864423751831055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11919450759887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04629659652709961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 25 input nodes size: 81563
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03790712356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03790712356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06915712356567383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06918096542358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.032946109771728516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0353093147277832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0353093147277832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 81563
first layer output nodes number: 24421
edges number: 239247
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03609943389892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([81563, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03609943389892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03609943389892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04707145690917969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04707145690917969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07036113739013672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24421, 256])
h_self size  torch.Size([24421, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07036113739013672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24421, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09365081787109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07036113739013672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24421, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09365081787109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09947347640991211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24421
----------------output nodes number: 3145
----------------edges number: 77752
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09967947006225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09967947006225586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10328245162963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10328245162963867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10383319854736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3145, 47])
h_self size  torch.Size([3145, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10383319854736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3145, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10438394546508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10383319854736328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3145, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10383415222167969  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1043853759765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0394434928894043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 26 input nodes size: 112266
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03294706344604492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03294706344604492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07476949691772461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07479190826416016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04351806640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04714775085449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04714775085449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 112266
first layer output nodes number: 29514
edges number: 288935
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048204898834228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([112266, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048204898834228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.048204898834228516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061463356018066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061463356018066406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08961009979248047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29514, 256])
h_self size  torch.Size([29514, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08961009979248047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29514, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11775684356689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08961009979248047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29514, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11775684356689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12479352951049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29514
----------------output nodes number: 2981
----------------edges number: 71159
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12503623962402344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12503623962402344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.128692626953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.128692626953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12973690032958984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12921476364135742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12918615341186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12970876693725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0518646240234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 27 input nodes size: 132834
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04348945617675781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04348945617675781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09297418594360352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09299659729003906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05115175247192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054071903228759766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054071903228759766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 132834
first layer output nodes number: 33332
edges number: 323433
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05531024932861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([132834, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05531024932861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05531024932861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07085990905761719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07085990905761719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10264778137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33332, 256])
h_self size  torch.Size([33332, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10264778137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33332, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13443565368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10264778137207031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33332, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13443565368652344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14238262176513672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33332
----------------output nodes number: 2981
----------------edges number: 68370
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1426534652709961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1426534652709961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1469583511352539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1469583511352539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14748048782348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14748048782348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14800262451171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14748048782348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14748048782348633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14800310134887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05986976623535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 28 input nodes size: 83486
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05115175247192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05115175247192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08240175247192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08242511749267578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03291797637939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03561592102050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03561592102050781  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 83486
first layer output nodes number: 29646
edges number: 288919
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03645944595336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([83486, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03645944595336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03645944595336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049767494201660156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049767494201660156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07804012298583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29646, 256])
h_self size  torch.Size([29646, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07804012298583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29646, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10631275177001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07804012298583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29646, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10631275177001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11338090896606445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29646
----------------output nodes number: 3099
----------------edges number: 73065
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11362552642822266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11362552642822266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11714935302734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11714935302734375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1176919937133789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3099, 47])
h_self size  torch.Size([3099, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1176919937133789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3099, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11823463439941406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1176919937133789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3099, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11771249771118164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.118255615234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.040200233459472656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 29 input nodes size: 72767
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.032938480377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.032938480377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060282230377197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06030464172363281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.02903127670288086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03130388259887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03130388259887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 72767
first layer output nodes number: 24209
edges number: 234865
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03202676773071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([72767, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03202676773071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03202676773071289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04288625717163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04288625717163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06597375869750977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24209, 256])
h_self size  torch.Size([24209, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06597375869750977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24209, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08906126022338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06597375869750977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24209, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08906126022338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0948333740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24209
----------------output nodes number: 2981
----------------edges number: 70132
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09503650665283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09503650665283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09842491149902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09842491149902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09894704818725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09894704818725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09946918487548828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09894704818725586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09892654418945312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09944915771484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03519725799560547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 30 input nodes size: 110781
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029010772705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029010772705078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07028007507324219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07030248641967773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04293632507324219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04579734802246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04579734802246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 110781
first layer output nodes number: 31752
edges number: 312234
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0468597412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([110781, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0468597412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0468597412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06129646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06129646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09254646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31752, 256])
h_self size  torch.Size([31752, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09254646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31752, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12379646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09254646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31752, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12379646301269531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13136672973632812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31752
----------------output nodes number: 2981
----------------edges number: 71649
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13162612915039062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13162612915039062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1350259780883789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1350259780883789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13554811477661133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13554811477661133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13607025146484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13554811477661133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13554811477661133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13607072830200195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050925254821777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 31 input nodes size: 101418
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04293632507324219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04293632507324219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08071756362915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08073997497558594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03944826126098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042328834533691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042328834533691406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 101418
first layer output nodes number: 29505
edges number: 287445
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0433049201965332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([101418, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0433049201965332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0433049201965332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0565485954284668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0565485954284668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0846867561340332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29505, 256])
h_self size  torch.Size([29505, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0846867561340332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29505, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11282491683959961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0846867561340332  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29505, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11282491683959961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11985969543457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29505
----------------output nodes number: 3004
----------------edges number: 70875
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1201024055480957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1201024055480957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12376546859741211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12376546859741211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12429189682006836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3004, 47])
h_self size  torch.Size([3004, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12429189682006836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3004, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12481832504272461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12429189682006836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3004, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12429618835449219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12482309341430664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0469822883605957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 32 input nodes size: 78043
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.039452552795410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.039452552795410156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0685262680053711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06854963302612305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.030745983123779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.033010005950927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.033010005950927734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 78043
first layer output nodes number: 23800
edges number: 230288
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03376913070678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([78043, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03376913070678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03376913070678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04444074630737305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04444074630737305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0671381950378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([23800, 256])
h_self size  torch.Size([23800, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0671381950378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23800, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08983564376831055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0671381950378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([23800, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08983564376831055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09551000595092773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 23800
----------------output nodes number: 3095
----------------edges number: 73445
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09571075439453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09571075439453125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09923362731933594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09923362731933594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3095, 47])
h_self size  torch.Size([3095, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3095, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10031795501708984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09977579116821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3095, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0997915267944336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10033416748046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036986351013183594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 33 input nodes size: 170315
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03076171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03076171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09420919418334961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09423160552978516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06513452529907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06861114501953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06861114501953125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 170315
first layer output nodes number: 37623
edges number: 368497
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0701608657836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([170315, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0701608657836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0701608657836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08706235885620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08706235885620117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12294244766235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37623, 256])
h_self size  torch.Size([37623, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12294244766235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37623, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15882253646850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12294244766235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37623, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15882253646850586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16786432266235352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37623
----------------output nodes number: 2981
----------------edges number: 69399
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1681671142578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1681671142578125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17155075073242188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17155075073242188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1720728874206543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1720728874206543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17259502410888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1720728874206543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17205286026000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1725754737854004  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07451677322387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 34 input nodes size: 86415
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06511449813842773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06511449813842773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09730672836303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09733057022094727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03386068344116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03739118576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03739118576049805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 86415
first layer output nodes number: 29061
edges number: 277465
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03825235366821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([86415, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03825235366821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03825235366821289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0512547492980957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0512547492980957  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07896947860717773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([29061, 256])
h_self size  torch.Size([29061, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07896947860717773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29061, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10668420791625977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07896947860717773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([29061, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10668420791625977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11361312866210938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 29061
----------------output nodes number: 3152
----------------edges number: 75936
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11385393142700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11385393142700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11797952651977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11797952651977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11853170394897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3152, 47])
h_self size  torch.Size([3152, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11853170394897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3152, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11908388137817383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11853170394897461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3152, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1185617446899414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11911439895629883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.041953086853027344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 35 input nodes size: 74114
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.033890724182128906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.033890724182128906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06150054931640625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0615234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.02930736541748047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03157615661621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03157615661621094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 74114
first layer output nodes number: 24120
edges number: 233471
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03230857849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([74114, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03230857849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03230857849121094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043123722076416016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043123722076416016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06612634658813477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([24120, 256])
h_self size  torch.Size([24120, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06612634658813477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24120, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08912897109985352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06612634658813477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([24120, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08912897109985352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0948796272277832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 24120
----------------output nodes number: 3024
----------------edges number: 70934
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09508228302001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09508228302001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09851837158203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09851837158203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09904813766479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3024, 47])
h_self size  torch.Size([3024, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09904813766479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3024, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0995779037475586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09904813766479492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3024, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09902572631835938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09955596923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03547859191894531  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 36 input nodes size: 100152
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029284954071044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029284954071044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06659460067749023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06661748886108398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03898477554321289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042513370513916016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.042513370513916016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 100152
first layer output nodes number: 32735
edges number: 324540
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043503761291503906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([100152, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043503761291503906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043503761291503906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05832052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05832052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08957052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32735, 256])
h_self size  torch.Size([32735, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08957052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32735, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12082052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08957052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32735, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12082052230834961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12862539291381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32735
----------------output nodes number: 3060
----------------edges number: 75936
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1288924217224121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1288924217224121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1324000358581543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1324000358581543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1329360008239746  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3060, 47])
h_self size  torch.Size([3060, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1329360008239746  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3060, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13347196578979492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1329360008239746  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3060, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13294219970703125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13347864151000977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04766511917114258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 37 input nodes size: 122065
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03899097442626953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03899097442626953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08446407318115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0844879150390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04715538024902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0504145622253418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0504145622253418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 122065
first layer output nodes number: 34319
edges number: 340578
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05158042907714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([122065, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05158042907714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05158042907714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0670313835144043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0670313835144043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09976053237915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34319, 256])
h_self size  torch.Size([34319, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09976053237915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34319, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13248968124389648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09976053237915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34319, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13248968124389648  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1406722068786621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34319
----------------output nodes number: 3161
----------------edges number: 78937
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14095211029052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14095211029052734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1445789337158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1445789337158203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14513254165649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3161, 47])
h_self size  torch.Size([3161, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14513254165649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14568614959716797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14513254165649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3161, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14515018463134766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1457042694091797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05586099624633789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 38 input nodes size: 85871
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04717302322387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04717302322387695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07916259765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07918596267700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.033689022064208984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03621530532836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03621530532836914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 85871
first layer output nodes number: 26562
edges number: 262478
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037053585052490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([85871, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037053585052490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.037053585052490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05008220672607422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05008220672607422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07541370391845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([26562, 256])
h_self size  torch.Size([26562, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07541370391845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26562, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10074520111083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07541370391845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26562, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10074520111083984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10707807540893555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 26562
----------------output nodes number: 3078
----------------edges number: 76528
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1072998046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1072998046875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11082935333251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11082935333251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11136865615844727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3078, 47])
h_self size  torch.Size([3078, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11136865615844727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3078, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.111907958984375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11136865615844727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3078, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11135435104370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11189413070678711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04164600372314453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 39 input nodes size: 123491
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03367471694946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03367471694946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08054971694946289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08057260513305664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04855966567993164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05149030685424805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05149030685424805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 123491
first layer output nodes number: 32474
edges number: 318950
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052652835845947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([123491, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052652835845947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052652835845947266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06755208969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06755208969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09880208969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([32474, 256])
h_self size  torch.Size([32474, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09880208969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32474, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1300520896911621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09880208969116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([32474, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1300520896911621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13779449462890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 32474
----------------output nodes number: 3017
----------------edges number: 74289
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1380596160888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1380596160888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14151382446289062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14151382446289062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1420421600341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3017, 47])
h_self size  torch.Size([3017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1420421600341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14257049560546875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1420421600341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3017, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14203119277954102  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14256000518798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05694913864135742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 40 input nodes size: 153434
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04854869842529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04854869842529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10570764541625977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10573148727416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05883359909057617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06280326843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06280326843261719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 153434
first layer output nodes number: 38819
edges number: 384876
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06423616409301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([153434, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06423616409301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06423616409301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0817103385925293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0817103385925293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873102188110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38819, 256])
h_self size  torch.Size([38819, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873102188110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38819, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15575170516967773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873102188110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38819, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15575170516967773  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1650071144104004  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38819
----------------output nodes number: 3148
----------------edges number: 78063
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16532039642333984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16532039642333984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1689281463623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1689281463623047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1694793701171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3148, 47])
h_self size  torch.Size([3148, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1694793701171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1700305938720703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1694793701171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16950225830078125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17005395889282227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06890535354614258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 41 input nodes size: 170665
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05885648727416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05885648727416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12243461608886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12245845794677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06527566909790039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06884527206420898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06884527206420898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 170665
first layer output nodes number: 40390
edges number: 400689
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07048177719116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([170665, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07048177719116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07048177719116211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08866500854492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08866500854492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12772750854492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([40390, 256])
h_self size  torch.Size([40390, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12772750854492188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40390, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1662464141845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1271839141845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([40390, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1662464141845703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17647218704223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 40390
----------------output nodes number: 3163
----------------edges number: 78216
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17679738998413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17679738998413086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18079137802124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18079137802124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18134546279907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18134546279907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1818995475769043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18134546279907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18134832382202148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18190288543701172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07527637481689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 42 input nodes size: 151355
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06527853012084961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06527853012084961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12166309356689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12168693542480469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058084964752197266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06146097183227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06146097183227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 151355
first layer output nodes number: 37697
edges number: 374560
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06311321258544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([151355, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06311321258544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06311321258544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08008861541748047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08008861541748047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11603927612304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37697, 256])
h_self size  torch.Size([37697, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11603927612304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37697, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15198993682861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11603927612304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37697, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15198993682861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16097784042358398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37697
----------------output nodes number: 3148
----------------edges number: 78383
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16128301620483398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16128301620483398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16489362716674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16489362716674805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16544485092163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3148, 47])
h_self size  torch.Size([3148, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16544485092163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16599607467651367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16544485092163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16544198989868164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16599369049072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06766939163208008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 43 input nodes size: 135390
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05808210372924805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05808210372924805  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10851907730102539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10854148864746094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05213308334350586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05504560470581055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05504560470581055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 135390
first layer output nodes number: 31991
edges number: 316786
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0571742057800293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([135390, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0571742057800293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0571742057800293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07210397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07210397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10335397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31991, 256])
h_self size  torch.Size([31991, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10335397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31991, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13460397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10335397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31991, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13460397720336914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14223146438598633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31991
----------------output nodes number: 2981
----------------edges number: 74014
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14249229431152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14249229431152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14591026306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14591026306152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14643239974975586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14643239974975586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14695453643798828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14643239974975586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14640331268310547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1469259262084961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06165313720703125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 44 input nodes size: 139021
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05210399627685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05210399627685547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10389375686645508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10391759872436523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.053458213806152344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05687999725341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05687999725341797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 139021
first layer output nodes number: 38377
edges number: 380506
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058202266693115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([139021, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058202266693115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.058202266693115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07547760009765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07547760009765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1120767593383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([38377, 256])
h_self size  torch.Size([38377, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1120767593383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38377, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14867591857910156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1120767593383789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([38377, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14867591857910156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15782594680786133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 38377
----------------output nodes number: 3157
----------------edges number: 78628
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15813589096069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15813589096069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1617569923400879  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1617569923400879  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16231012344360352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3157, 47])
h_self size  torch.Size([3157, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16231012344360352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16286325454711914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16231012344360352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3157, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16234111785888672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16289472579956055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06284952163696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 45 input nodes size: 183764
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05348920822143555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05348920822143555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12194681167602539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12196922302246094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07015562057495117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07362890243530273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07362890243530273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 183764
first layer output nodes number: 39502
edges number: 391795
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07529306411743164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([183764, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07529306411743164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07529306411743164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09308815002441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09308815002441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13076019287109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([39502, 256])
h_self size  torch.Size([39502, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13076019287109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([39502, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16843223571777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13076019287109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([39502, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16843223571777344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17785024642944336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 39502
----------------output nodes number: 2981
----------------edges number: 74282
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17816734313964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17816734313964844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18158721923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18158721923828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18210935592651367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18210935592651367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1826314926147461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18210935592651367  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18207836151123047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1826009750366211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.079925537109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 46 input nodes size: 175991
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07012462615966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07012462615966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13653087615966797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13655471801757812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06807470321655273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07179594039916992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07179594039916992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 175991
first layer output nodes number: 42315
edges number: 420481
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07342290878295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([175991, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07342290878295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07342290878295898  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09311199188232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09311199188232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1334667205810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([42315, 256])
h_self size  torch.Size([42315, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1334667205810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([42315, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17382144927978516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1334667205810547  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([42315, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17382144927978516  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18391036987304688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 42315
----------------output nodes number: 3163
----------------edges number: 78833
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1842498779296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1842498779296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18836498260498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18836498260498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1889190673828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1889190673828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18947315216064453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1889190673828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1889510154724121  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18950557708740234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07906436920166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 47 input nodes size: 170782
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06810665130615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06810665130615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1317281723022461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13175058364868164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06532049179077148  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06892633438110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06892633438110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 170782
first layer output nodes number: 41256
edges number: 409784
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07050657272338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([170782, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07050657272338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07050657272338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0892477035522461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0892477035522461  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12859249114990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([41256, 256])
h_self size  torch.Size([41256, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12859249114990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([41256, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1679372787475586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12859249114990234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([41256, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1679372787475586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17777347564697266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 41256
----------------output nodes number: 2995
----------------edges number: 74038
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17810344696044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17810344696044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1815347671508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1815347671508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18205928802490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2995, 47])
h_self size  torch.Size([2995, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18205928802490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2995, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18258380889892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18205928802490234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2995, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.18202972412109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1825547218322754  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07544851303100586  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 48 input nodes size: 104325
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06529092788696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06529092788696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10435342788696289  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10437726974487305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04073333740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043842315673828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043842315673828125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 104325
first layer output nodes number: 34179
edges number: 338973
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044875144958496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([104325, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044875144958496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.044875144958496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060262203216552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060262203216552734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09285783767700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34179, 256])
h_self size  torch.Size([34179, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09285783767700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34179, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12545347213745117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09285783767700195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34179, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12545347213745117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13360261917114258  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34179
----------------output nodes number: 3137
----------------edges number: 78107
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1338815689086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1338815689086914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1374797821044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1374797821044922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1380290985107422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3137, 47])
h_self size  torch.Size([3137, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1380290985107422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1385784149169922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1380290985107422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3137, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13805389404296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13860368728637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04913806915283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 49 input nodes size: 120335
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04075813293457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04075813293457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08568000793457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08570384979248047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04661750793457031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04972553253173828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04972553253173828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 120335
first layer output nodes number: 34261
edges number: 338881
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050878047943115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([120335, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050878047943115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.050878047943115234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06629467010498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06629467010498047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.098968505859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34261, 256])
h_self size  torch.Size([34261, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.098968505859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34261, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13164234161376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.098968505859375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34261, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13164234161376953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13981103897094727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34261
----------------output nodes number: 3148
----------------edges number: 78120
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1400904655456543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1400904655456543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14369916915893555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14369916915893555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14425039291381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3148, 47])
h_self size  torch.Size([3148, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14425039291381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14480161666870117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14425039291381836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3148, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14425230026245117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1448040008544922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05511760711669922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 50 input nodes size: 134462
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046619415283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046619415283203125  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0967106819152832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09673357009887695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0517878532409668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054814815521240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054814815521240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 134462
first layer output nodes number: 33771
edges number: 331632
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05606842041015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([134462, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05606842041015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05606842041015625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07124614715576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07124614715576172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10345268249511719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33771, 256])
h_self size  torch.Size([33771, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10345268249511719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33771, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13565921783447266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10345268249511719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33771, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13565921783447266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14371109008789062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33771
----------------output nodes number: 3047
----------------edges number: 74516
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14398574829101562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14398574829101562  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14823150634765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14823150634765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14876508712768555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3047, 47])
h_self size  torch.Size([3047, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14876508712768555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3047, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14929866790771484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14876508712768555  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3047, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14874744415283203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14928150177001953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06017160415649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 51 input nodes size: 116889
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05177021026611328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05177021026611328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09531497955322266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09533882141113281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045224666595458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04854869842529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04854869842529297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 116889
first layer output nodes number: 36800
edges number: 365336
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([116889, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.049694061279296875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06626319885253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06626319885253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10141944885253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36800, 256])
h_self size  torch.Size([36800, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10141944885253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36800, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13651466369628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10135841369628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36800, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13651466369628906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14528846740722656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36800
----------------output nodes number: 3145
----------------edges number: 78588
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14558649063110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14558649063110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1501631736755371  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1501631736755371  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15071392059326172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3145, 47])
h_self size  torch.Size([3145, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15071392059326172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3145, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15126466751098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15071392059326172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3145, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15073108673095703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15128231048583984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05418968200683594  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 52 input nodes size: 131915
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0452418327331543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0452418327331543  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09438419342041016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09440803527832031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05083942413330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054080963134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.054080963134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 131915
first layer output nodes number: 36082
edges number: 356984
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05533313751220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([131915, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05533313751220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05533313751220703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07214164733886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07214164733886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10729789733886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36082, 256])
h_self size  torch.Size([36082, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10729789733886719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36082, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1417083740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1065521240234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36082, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1417083740234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15031099319458008  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36082
----------------output nodes number: 3143
----------------edges number: 78024
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1506037712097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1506037712097168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1542067527770996  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1542067527770996  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15475749969482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3143, 47])
h_self size  torch.Size([3143, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15475749969482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3143, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15530824661254883  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15475749969482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3143, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15475749969482422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15530872344970703  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0603022575378418  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 53 input nodes size: 150470
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05083942413330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05083942413330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10689401626586914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1069173812866211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05775117874145508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060536861419677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.060536861419677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 150470
first layer output nodes number: 31540
edges number: 308780
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061893463134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([150470, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061893463134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.061893463134765625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07694053649902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07694053649902344  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10701942443847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31540, 256])
h_self size  torch.Size([31540, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10701942443847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31540, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1370983123779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10701942443847656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31540, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1370983123779297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14461803436279297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31540
----------------output nodes number: 3104
----------------edges number: 64921
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14487648010253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14487648010253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1483449935913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1483449935913086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14888858795166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3104, 47])
h_self size  torch.Size([3104, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14888858795166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3104, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14943218231201172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14888858795166016  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3104, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1488814353942871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14942550659179688  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06654071807861328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 54 input nodes size: 120766
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05774402618408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05774402618408203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10273313522338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10275554656982422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046677589416503906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05039215087890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05039215087890625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 120766
first layer output nodes number: 34647
edges number: 344100
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05155038833618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([120766, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05155038833618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05155038833618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06715106964111328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06715106964111328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10019302368164062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([34647, 256])
h_self size  torch.Size([34647, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10019302368164062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34647, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13323497772216797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10019302368164062  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([34647, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13323497772216797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1414957046508789  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 34647
----------------output nodes number: 2981
----------------edges number: 73247
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14177656173706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14177656173706055  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1451888084411621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1451888084411621  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14571094512939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14571094512939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14623308181762695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14571094512939453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1456894874572754  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14621210098266602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05573701858520508  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 55 input nodes size: 170888
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046656131744384766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046656131744384766  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11031723022460938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11034107208251953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06532955169677734  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06863927841186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06863927841186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 170888
first layer output nodes number: 37054
edges number: 364965
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07018899917602539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([170888, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07018899917602539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07018899917602539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08685111999511719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08685111999511719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12218856811523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([37054, 256])
h_self size  torch.Size([37054, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12218856811523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37054, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15752601623535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12218856811523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([37054, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15752601623535156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16711044311523438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 37054
----------------output nodes number: 3163
----------------edges number: 75776
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16741037368774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16741037368774414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17101526260375977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17101526260375977  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1715693473815918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3163, 47])
h_self size  torch.Size([3163, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1715693473815918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17212343215942383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1715693473815918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3163, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1716012954711914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17215585708618164  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07465839385986328  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 56 input nodes size: 167380
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06536149978637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06536149978637695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1277155876159668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12773799896240234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06405305862426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0666956901550293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0666956901550293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 167380
first layer output nodes number: 30407
edges number: 297367
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06817007064819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([167380, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06817007064819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06817007064819336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08182764053344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08182764053344727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11082601547241211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([30407, 256])
h_self size  torch.Size([30407, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11082601547241211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30407, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13982439041137695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11082601547241211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([30407, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13982439041137695  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14802789688110352  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 30407
----------------output nodes number: 2984
----------------edges number: 57149
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14827728271484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14827728271484375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15191936492919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15191936492919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15244197845458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2984, 47])
h_self size  torch.Size([2984, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15244197845458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15296459197998047  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15244197845458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15241050720214844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15293359756469727  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07169532775878906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 57 input nodes size: 146198
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06402158737182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06402158737182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11870908737182617  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11873149871826172  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05635499954223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05919218063354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05919218063354492  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 146198
first layer output nodes number: 31044
edges number: 307770
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06051349639892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([146198, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06051349639892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06051349639892578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10409402847290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([31044, 256])
h_self size  torch.Size([31044, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10409402847290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31044, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13369989395141602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10409402847290039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([31044, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13369989395141602  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14203548431396484  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 31044
----------------output nodes number: 2984
----------------edges number: 72939
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1422896385192871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1422896385192871  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14570188522338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14570188522338867  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1462244987487793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2984, 47])
h_self size  torch.Size([2984, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1462244987487793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14674711227416992  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1462244987487793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1462244987487793  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14674758911132812  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0643916130065918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 58 input nodes size: 101291
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05635499954223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05635499954223633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09408903121948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09411144256591797  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03940153121948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04230690002441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04230690002441406  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 101291
first layer output nodes number: 28236
edges number: 278844
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([101291, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05597496032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05597496032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08331871032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([28236, 256])
h_self size  torch.Size([28236, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08331871032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28236, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11066246032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08331871032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([28236, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11066246032714844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11759662628173828  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 28236
----------------output nodes number: 2984
----------------edges number: 72105
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11782979965209961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11782979965209961  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12123632431030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12123632431030273  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12175893783569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2984, 47])
h_self size  torch.Size([2984, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12175893783569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12228155136108398  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12175893783569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2984, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12175893783569336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12228202819824219  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.046881675720214844  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 59 input nodes size: 110956
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03940153121948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03940153121948242  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08073616027832031  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08075952529907227  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.043003082275390625  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045540809631347656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.045540809631347656  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 110956
first layer output nodes number: 26860
edges number: 264784
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([110956, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04656791687011719  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06000089645385742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06000089645385742  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0856165885925293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([26860, 256])
h_self size  torch.Size([26860, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0856165885925293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26860, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11123228073120117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0856165885925293  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([26860, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11123228073120117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.11763620376586914  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 26860
----------------output nodes number: 3076
----------------edges number: 75706
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1178598403930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1178598403930664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12138175964355469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12138175964355469  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12192058563232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3076, 47])
h_self size  torch.Size([3076, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12192058563232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3076, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12245941162109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12192058563232422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3076, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12193679809570312  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12247610092163086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05147552490234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 60 input nodes size: 74409
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04301929473876953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04301929473876953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0707392692565918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07076311111450195  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.02940511703491211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03186750411987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03186750411987305  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 74409
first layer output nodes number: 25492
edges number: 252274
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([74409, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.03261232376098633  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.04408407211303711  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06839513778686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([25492, 256])
h_self size  torch.Size([25492, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06839513778686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25492, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09270620346069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06839513778686523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([25492, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09270620346069336  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09878396987915039  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 25492
----------------output nodes number: 3144
----------------edges number: 78133
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0989980697631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0989980697631836  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10263729095458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10263729095458984  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10318803787231445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3144, 47])
h_self size  torch.Size([3144, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10318803787231445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3144, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10373878479003906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10318803787231445  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3144, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10319995880126953  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10375118255615234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.036086082458496094  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 61 input nodes size: 136387
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029417037963867188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.029417037963867188  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08022546768188477  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08024883270263672  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0525050163269043  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05554628372192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05554628372192383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 136387
first layer output nodes number: 33883
edges number: 334853
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05718231201171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([136387, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05718231201171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.05718231201171875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07242727279663086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07242727279663086  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10474061965942383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([33883, 256])
h_self size  torch.Size([33883, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10474061965942383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33883, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1370539665222168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10474061965942383  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([33883, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1370539665222168  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14513254165649414  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 33883
----------------output nodes number: 3125
----------------edges number: 73138
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14540863037109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14540863037109375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1489582061767578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1489582061767578  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.149505615234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([3125, 47])
h_self size  torch.Size([3125, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.149505615234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3125, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1500530242919922  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.149505615234375  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([3125, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.14950227737426758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15005016326904297  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06130647659301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 62 input nodes size: 189448
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052501678466796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.052501678466796875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1230769157409668  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12309932708740234  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07226753234863281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07644319534301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07644319534301758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 189448
first layer output nodes number: 36431
edges number: 360129
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07812690734863281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([189448, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07812690734863281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07812690734863281  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09451818466186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09451818466186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12967443466186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36431, 256])
h_self size  torch.Size([36431, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12967443466186523  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36431, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16441774368286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12926149368286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36431, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16441774368286133  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17310380935668945  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36431
----------------output nodes number: 2989
----------------edges number: 71354
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17339801788330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17339801788330078  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1768035888671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1768035888671875  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17732715606689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2989, 47])
h_self size  torch.Size([2989, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17732715606689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2989, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17785072326660156  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17732715606689453  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2989, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.17730331420898438  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1778273582458496  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.0824284553527832  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

pseudo mini batch 63 input nodes size: 167515
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07224369049072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07224369049072266  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13464832305908203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13467073440551758  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06407308578491211  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06732034683227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06732034683227539  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

first layer input nodes number: 167515
first layer output nodes number: 36443
edges number: 362104
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06889581680297852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([167515, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06889581680297852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06889581680297852  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08530616760253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08530616760253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12046241760253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([36443, 256])
h_self size  torch.Size([36443, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12046241760253906  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36443, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15521717071533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.12006092071533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([36443, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15521717071533203  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16390609741210938  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------input nodes number: 36443
----------------output nodes number: 2981
----------------edges number: 73602
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1642003059387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1642003059387207  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1680293083190918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1680293083190918  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16855144500732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

h_neigh size torch.Size([2981, 47])
h_self size  torch.Size([2981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16855144500732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16907358169555664  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16855144500732422  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

torch.Size([2981, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1685500144958496  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.16907262802124023  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07326841354370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07326841354370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07326841354370117  GigaBytes
Max Memory Allocated: 0.2973642349243164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021604638546705246 |0.0053921714425086975 |0.011883694678544998 |0.00014903396368026733 |0.002519700676202774 |0.0010883808135986328 |
----------------------------------------------------------pseudo_mini_loss sum 1.460783839225769
Total (block generation + training)time/epoch 66.66138164202373
Training time/epoch 2.8791024684906006
Training time without block to device /epoch 2.534003496170044
Training time without total dataloading part /epoch 0.9324438571929932
load block tensor time/epoch 1.3826968669891357
block to device time/epoch 0.34509897232055664
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  10049642
Number of first layer input nodes during this epoch:  7966101
Number of first layer output nodes during this epoch:  2083541
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
