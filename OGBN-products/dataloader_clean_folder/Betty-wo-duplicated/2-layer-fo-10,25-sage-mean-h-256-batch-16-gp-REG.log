main start at this time 1660334970.7468326
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.24321866035461426
global_2_local spend time (sec) 0.3731386661529541

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.026 seconds
Metis partitioning: 12.288 seconds
Split the graph: 1.237 seconds
Construct subgraphs: 0.448 seconds
12583
12603
12654
12499
12442
12630
11979
11940
12620
11927
11945
12613
11927
12309
11971
11929
REG metis partition end ----................................
the time spent:  26.40264916419983
total k batches seeds list generation spend  26.922318696975708
after graph partition
graph partition algorithm spend time 27.489118099212646

partition_len_list
[120018, 103753, 81420, 91580, 97277, 116808, 104570, 92936, 117168, 108091, 122713, 114145, 120470, 89900, 114191, 112449]
REG selection method  spend 28.041112422943115
check_connections_block*********************************
time for parepare 1: 0.22620844841003418
local_output_nid generation: 0.0038709640502929688
local_in_edges_tensor generation: 0.004457712173461914
mini_batch_src_global generation: 0.011955022811889648

&&&&&&&&&&&&&&& before remove duplicate length: 312212
r_  generation: 0.12044835090637207

local_output_nid generation: 0.005658388137817383
local_in_edges_tensor generation: 0.005223989486694336
mini_batch_src_global generation: 0.01493525505065918

&&&&&&&&&&&&&&& before remove duplicate length: 311202
r_  generation: 0.11812138557434082

local_output_nid generation: 0.0046939849853515625
local_in_edges_tensor generation: 0.004332542419433594
mini_batch_src_global generation: 0.011322736740112305

&&&&&&&&&&&&&&& before remove duplicate length: 299247
r_  generation: 0.10669517517089844

local_output_nid generation: 0.004633188247680664
local_in_edges_tensor generation: 0.004315853118896484
mini_batch_src_global generation: 0.013189554214477539

&&&&&&&&&&&&&&& before remove duplicate length: 302114
r_  generation: 0.11560654640197754

local_output_nid generation: 0.004706382751464844
local_in_edges_tensor generation: 0.0043315887451171875
mini_batch_src_global generation: 0.013650894165039062

&&&&&&&&&&&&&&& before remove duplicate length: 299999
r_  generation: 0.11705970764160156

local_output_nid generation: 0.0046846866607666016
local_in_edges_tensor generation: 0.004386425018310547
mini_batch_src_global generation: 0.014489173889160156

&&&&&&&&&&&&&&& before remove duplicate length: 304347
r_  generation: 0.13098621368408203

local_output_nid generation: 0.005957126617431641
local_in_edges_tensor generation: 0.004315376281738281
mini_batch_src_global generation: 0.014460563659667969

&&&&&&&&&&&&&&& before remove duplicate length: 290923
r_  generation: 0.11828207969665527

local_output_nid generation: 0.004515171051025391
local_in_edges_tensor generation: 0.004151821136474609
mini_batch_src_global generation: 0.014336585998535156

&&&&&&&&&&&&&&& before remove duplicate length: 287701
r_  generation: 0.11677145957946777

local_output_nid generation: 0.004671335220336914
local_in_edges_tensor generation: 0.004393100738525391
mini_batch_src_global generation: 0.015824317932128906

&&&&&&&&&&&&&&& before remove duplicate length: 313210
r_  generation: 0.13456964492797852

local_output_nid generation: 0.004516124725341797
local_in_edges_tensor generation: 0.004205226898193359
mini_batch_src_global generation: 0.015743494033813477

&&&&&&&&&&&&&&& before remove duplicate length: 293699
r_  generation: 0.12489581108093262

local_output_nid generation: 0.004463672637939453
local_in_edges_tensor generation: 0.006879091262817383
mini_batch_src_global generation: 0.015169858932495117

&&&&&&&&&&&&&&& before remove duplicate length: 296905
r_  generation: 0.18028521537780762

local_output_nid generation: 0.009248971939086914
local_in_edges_tensor generation: 0.005383014678955078
mini_batch_src_global generation: 0.022680282592773438

&&&&&&&&&&&&&&& before remove duplicate length: 314191
r_  generation: 0.13515830039978027

local_output_nid generation: 0.0048334598541259766
local_in_edges_tensor generation: 0.004297018051147461
mini_batch_src_global generation: 0.013327836990356445

&&&&&&&&&&&&&&& before remove duplicate length: 292837
r_  generation: 0.12579894065856934

local_output_nid generation: 0.0048313140869140625
local_in_edges_tensor generation: 0.0042994022369384766
mini_batch_src_global generation: 0.013276338577270508

&&&&&&&&&&&&&&& before remove duplicate length: 290724
r_  generation: 0.11928272247314453

local_output_nid generation: 0.004625558853149414
local_in_edges_tensor generation: 0.004132270812988281
mini_batch_src_global generation: 0.012040853500366211

&&&&&&&&&&&&&&& before remove duplicate length: 275758
r_  generation: 0.11616349220275879

local_output_nid generation: 0.004588603973388672
local_in_edges_tensor generation: 0.004151105880737305
mini_batch_src_global generation: 0.012890815734863281

&&&&&&&&&&&&&&& before remove duplicate length: 278810
r_  generation: 0.11478090286254883


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.723358154296875
gen group dst list time:  0.04753303527832031
check_connections_block*********************************
time for parepare 1: 0.3725731372833252
local_output_nid generation: 0.028908491134643555
local_in_edges_tensor generation: 0.09810042381286621
mini_batch_src_global generation: 0.03927206993103027

&&&&&&&&&&&&&&& before remove duplicate length: 1189672
r_  generation: 0.4835481643676758

local_output_nid generation: 0.03176116943359375
local_in_edges_tensor generation: 0.03984212875366211
mini_batch_src_global generation: 0.0537874698638916

&&&&&&&&&&&&&&& before remove duplicate length: 1020474
r_  generation: 0.4590120315551758

local_output_nid generation: 0.04703807830810547
local_in_edges_tensor generation: 0.04482889175415039
mini_batch_src_global generation: 0.03254055976867676

&&&&&&&&&&&&&&& before remove duplicate length: 786110
r_  generation: 0.32163286209106445

local_output_nid generation: 0.0280301570892334
local_in_edges_tensor generation: 0.0308535099029541
mini_batch_src_global generation: 0.03513216972351074

&&&&&&&&&&&&&&& before remove duplicate length: 890624
r_  generation: 0.3820013999938965

local_output_nid generation: 0.02872180938720703
local_in_edges_tensor generation: 0.03740525245666504
mini_batch_src_global generation: 0.04057788848876953

&&&&&&&&&&&&&&& before remove duplicate length: 930786
r_  generation: 0.4134068489074707

local_output_nid generation: 0.03388214111328125
local_in_edges_tensor generation: 0.03962516784667969
mini_batch_src_global generation: 0.04485917091369629

&&&&&&&&&&&&&&& before remove duplicate length: 1123664
r_  generation: 0.5208981037139893

local_output_nid generation: 0.03223419189453125
local_in_edges_tensor generation: 0.037102460861206055
mini_batch_src_global generation: 0.04527735710144043

&&&&&&&&&&&&&&& before remove duplicate length: 1017313
r_  generation: 0.48363685607910156

local_output_nid generation: 0.028577089309692383
local_in_edges_tensor generation: 0.031118154525756836
mini_batch_src_global generation: 0.04153180122375488

&&&&&&&&&&&&&&& before remove duplicate length: 893983
r_  generation: 0.4108109474182129

local_output_nid generation: 0.03569650650024414
local_in_edges_tensor generation: 0.03696179389953613
mini_batch_src_global generation: 0.04892873764038086

&&&&&&&&&&&&&&& before remove duplicate length: 1156417
r_  generation: 0.5263645648956299

local_output_nid generation: 0.0318753719329834
local_in_edges_tensor generation: 0.033080339431762695
mini_batch_src_global generation: 0.047309160232543945

&&&&&&&&&&&&&&& before remove duplicate length: 1068291
r_  generation: 0.48722410202026367

local_output_nid generation: 0.03721165657043457
local_in_edges_tensor generation: 0.04017138481140137
mini_batch_src_global generation: 0.05341339111328125

&&&&&&&&&&&&&&& before remove duplicate length: 1215686
r_  generation: 0.637601375579834

local_output_nid generation: 0.05623197555541992
local_in_edges_tensor generation: 0.09569835662841797
mini_batch_src_global generation: 0.05025506019592285

&&&&&&&&&&&&&&& before remove duplicate length: 1131322
r_  generation: 0.5323812961578369

local_output_nid generation: 0.036182403564453125
local_in_edges_tensor generation: 0.04449295997619629
mini_batch_src_global generation: 0.0506436824798584

&&&&&&&&&&&&&&& before remove duplicate length: 1187708
r_  generation: 0.5974404811859131

local_output_nid generation: 0.02542591094970703
local_in_edges_tensor generation: 0.0219728946685791
mini_batch_src_global generation: 0.04319119453430176

&&&&&&&&&&&&&&& before remove duplicate length: 863406
r_  generation: 0.39464902877807617

local_output_nid generation: 0.0358579158782959
local_in_edges_tensor generation: 0.033257246017456055
mini_batch_src_global generation: 0.04612874984741211

&&&&&&&&&&&&&&& before remove duplicate length: 1124352
r_  generation: 0.5797989368438721

local_output_nid generation: 0.033960580825805664
local_in_edges_tensor generation: 0.030700206756591797
mini_batch_src_global generation: 0.053145647048950195

&&&&&&&&&&&&&&& before remove duplicate length: 1105915
r_  generation: 0.5740666389465332


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  14.862279415130615
block generation total time  13.726721286773682
average batch blocks generation time:  0.8579200804233551
pseudo mini batch 0 input nodes size: 338781
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2049560546875 GB
    Memory Allocated: 0.12723350524902344  GigaBytes
Max Memory Allocated: 0.12723350524902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2049560546875 GB
    Memory Allocated: 0.12732744216918945  GigaBytes
Max Memory Allocated: 0.12732744216918945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2049560546875 GB
    Memory Allocated: 0.12732744216918945  GigaBytes
Max Memory Allocated: 0.12732744216918945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.1385188102722168  GigaBytes
Max Memory Allocated: 0.1385188102722168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.1385188102722168  GigaBytes
Max Memory Allocated: 0.1385188102722168  GigaBytes

first layer input nodes number: 338781
first layer output nodes number: 120018
edges number: 1189672
----------------------------------------before model layer 0
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.1419377326965332  GigaBytes
Max Memory Allocated: 0.14636993408203125  GigaBytes

torch.Size([338781, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.1419377326965332  GigaBytes
Max Memory Allocated: 0.14636993408203125  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.2889404296875 GB
    Memory Allocated: 0.1419377326965332  GigaBytes
Max Memory Allocated: 0.14636993408203125  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 0.19617128372192383  GigaBytes
Max Memory Allocated: 0.24154043197631836  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6385498046875 GB
    Memory Allocated: 0.19617128372192383  GigaBytes
Max Memory Allocated: 0.24154043197631836  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 0.31140565872192383  GigaBytes
Max Memory Allocated: 0.31140565872192383  GigaBytes

h_neigh size torch.Size([120018, 256])
h_self size  torch.Size([120018, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 0.31140565872192383  GigaBytes
Max Memory Allocated: 0.31140565872192383  GigaBytes

torch.Size([120018, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.42664003372192383  GigaBytes
Max Memory Allocated: 0.5418744087219238  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.31140565872192383  GigaBytes
Max Memory Allocated: 0.5418744087219238  GigaBytes

torch.Size([120018, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.42664003372192383  GigaBytes
Max Memory Allocated: 0.5418744087219238  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.45525455474853516  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------input nodes number: 120018
----------------output nodes number: 12583
----------------edges number: 312212
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.45624303817749023  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.45624303817749023  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.4708843231201172  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.4708843231201172  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47308778762817383  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

h_neigh size torch.Size([12583, 47])
h_self size  torch.Size([12583, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47308778762817383  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

torch.Size([12583, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47529125213623047  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47308778762817383  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

torch.Size([12583, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47529125213623047  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.47841644287109375  GigaBytes
Max Memory Allocated: 0.5704889297485352  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1605091094970703  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 1 input nodes size: 284342
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12981224060058594  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12981224060058594  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.23573827743530273  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.23583221435546875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10878515243530273  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11907434463500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11907434463500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 284342
first layer output nodes number: 103753
edges number: 1020474
----------------------------------------before model layer 0
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12196636199951172  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([284342, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12196636199951172  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12196636199951172  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16913080215454102  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16913080215454102  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.26807737350463867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([103753, 256])
h_self size  torch.Size([103753, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.26807737350463867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([103753, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36702394485473633  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.26807737350463867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([103753, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36702394485473633  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.39176082611083984  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 103753
----------------output nodes number: 12603
----------------edges number: 311202
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.39262819290161133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.39262819290161133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4075336456298828  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4075336456298828  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.409761905670166  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12603, 47])
h_self size  torch.Size([12603, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.409761905670166  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12603, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4119687080383301  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4097404479980469  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12603, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.40976524353027344  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4119725227355957  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1369166374206543  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 2 input nodes size: 175818
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1088099479675293  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1088099479675293  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.17430734634399414  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.17440176010131836  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.06838178634643555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.07646894454956055  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.07646894454956055  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 175818
first layer output nodes number: 81420
edges number: 786110
----------------------------------------before model layer 0
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.07838630676269531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([175818, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.07838630676269531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.07838630676269531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11487913131713867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11487913131713867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19252729415893555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([81420, 256])
h_self size  torch.Size([81420, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19252729415893555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([81420, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2701754570007324  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19252729415893555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([81420, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2701754570007324  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2897067070007324  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 81420
----------------output nodes number: 12654
----------------edges number: 299247
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2904081344604492  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2904081344604492  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.30509281158447266  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.30509281158447266  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3073086738586426  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3073086738586426  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3095245361328125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3073086738586426  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12654, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3072962760925293  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.31032848358154297  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.09033966064453125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 3 input nodes size: 251527
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.06836938858032227  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.06836938858032227  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16207075119018555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16216421127319336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.0965723991394043  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10626363754272461  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10626363754272461  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 251527
first layer output nodes number: 91580
edges number: 890624
----------------------------------------before model layer 0
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10882043838500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([251527, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10882043838500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10882043838500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.14991378784179688  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.14991378784179688  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.23725128173828125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([91580, 256])
h_self size  torch.Size([91580, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.23725128173828125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([91580, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3245887756347656  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.23725128173828125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([91580, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3245887756347656  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3464231491088867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 91580
----------------output nodes number: 12499
----------------edges number: 302114
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3471989631652832  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3471989631652832  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36164426803588867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36164426803588867  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.363832950592041  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12499, 47])
h_self size  torch.Size([12499, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.363832950592041  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12499, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36602163314819336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.363832950592041  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12499, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36380577087402344  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.36602210998535156  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1223745346069336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 4 input nodes size: 270588
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.09654521942138672  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.09654521942138672  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19734716415405273  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19744014739990234  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10364532470703125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11358070373535156  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11358070373535156  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 270588
first layer output nodes number: 97277
edges number: 930786
----------------------------------------before model layer 0
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11632156372070312  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([270588, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11632156372070312  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.11632156372070312  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16075372695922852  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.16075372695922852  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2535243034362793  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([97277, 256])
h_self size  torch.Size([97277, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2535243034362793  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([97277, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3462948799133301  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2535243034362793  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([97277, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3462948799133301  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3694877624511719  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 97277
----------------output nodes number: 12442
----------------edges number: 299999
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.37030553817749023  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.37030553817749023  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38456249237060547  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38456249237060547  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38674116134643555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12442, 47])
h_self size  torch.Size([12442, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38674116134643555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12442, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3889198303222656  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38674116134643555  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12442, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3867311477661133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.38891029357910156  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.1302652359008789  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 5 input nodes size: 325756
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10363531112670898  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.10363531112670898  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2249889373779297  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.2250833511352539  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12418842315673828  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.13527488708496094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.13527488708496094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 325756
first layer output nodes number: 116808
edges number: 1123664
----------------------------------------before model layer 0
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.13857269287109375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([325756, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.13857269287109375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.13857269287109375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19089508056640625  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.19089508056640625  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3022918701171875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([116808, 256])
h_self size  torch.Size([116808, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3022918701171875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([116808, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.41368865966796875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.3022918701171875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([116808, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.41368865966796875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.44153785705566406  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 116808
----------------output nodes number: 12630
----------------edges number: 304347
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4425029754638672  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4425029754638672  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4571833610534668  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4571833610534668  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4598870277404785  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12630, 47])
h_self size  torch.Size([12630, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4598870277404785  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12630, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4620985984802246  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.4593949317932129  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12630, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.45991992950439453  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.46213197708129883  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.15416193008422852  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 6 input nodes size: 351291
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12471342086791992  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.2186279296875 GB
    Memory Allocated: 0.12471342086791992  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.25557994842529297  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.25566959381103516  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.13422155380249023  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.14483118057250977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.14483118057250977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 351291
first layer output nodes number: 104570
edges number: 1017313
----------------------------------------before model layer 0
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.14822769165039062  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([351291, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.14822769165039062  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.14822769165039062  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.19573450088500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.19573450088500977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.29546022415161133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([104570, 256])
h_self size  torch.Size([104570, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.29546022415161133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([104570, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3951859474182129  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.29546022415161133  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([104570, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3951859474182129  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4201173782348633  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 104570
----------------output nodes number: 11979
----------------edges number: 290923
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4209861755371094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4209861755371094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43466758728027344  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43466758728027344  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.436765193939209  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([11979, 47])
h_self size  torch.Size([11979, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.436765193939209  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11979, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43912792205810547  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4370303153991699  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11979, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43642425537109375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4385223388671875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.16229534149169922  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 7 input nodes size: 263596
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.13361549377441406  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.13361549377441406  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2319021224975586  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.10094594955444336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1099700927734375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1099700927734375  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 263596
first layer output nodes number: 92936
edges number: 893983
----------------------------------------before model layer 0
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11262702941894531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([263596, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11262702941894531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11262702941894531  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.15464067459106445  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.15464067459106445  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2432713508605957  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([92936, 256])
h_self size  torch.Size([92936, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2432713508605957  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([92936, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.33190202713012695  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2432713508605957  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([92936, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.33190202713012695  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.35405969619750977  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 92936
----------------output nodes number: 11940
----------------edges number: 287701
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3548417091369629  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3548417091369629  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.36846208572387695  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.36846208572387695  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.37055301666259766  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([11940, 47])
h_self size  torch.Size([11940, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.37055301666259766  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11940, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3708171844482422  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11940, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.37081050872802734  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.37290191650390625  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1256847381591797  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 8 input nodes size: 322131
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.10093927383422852  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.10093927383422852  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.22094249725341797  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2210369110107422  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.12275028228759766  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.13372182846069336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.13372182846069336  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 322131
first layer output nodes number: 117168
edges number: 1156417
----------------------------------------before model layer 0
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1372365951538086  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([322131, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1372365951538086  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1372365951538086  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.18993854522705078  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.18993854522705078  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3016786575317383  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([117168, 256])
h_self size  torch.Size([117168, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3016786575317383  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([117168, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4134187698364258  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.3016786575317383  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([117168, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4134187698364258  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.44135379791259766  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 117168
----------------output nodes number: 12620
----------------edges number: 313210
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4423213005065918  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4423213005065918  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4568910598754883  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4568910598754883  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.45921850204467773  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([12620, 47])
h_self size  torch.Size([12620, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.45921850204467773  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12620, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.461428165435791  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.45910072326660156  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([12620, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4593372344970703  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4615473747253418  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.15303564071655273  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 9 input nodes size: 307195
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1229867935180664  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1229867935180664  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2382211685180664  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2383103370666504  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11821269989013672  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.12836170196533203  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.12836170196533203  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 307195
first layer output nodes number: 108091
edges number: 1068291
----------------------------------------before model layer 0
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1314558982849121  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([307195, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1314558982849121  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1314558982849121  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.18076086044311523  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.18076086044311523  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2838444709777832  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([108091, 256])
h_self size  torch.Size([108091, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2838444709777832  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([108091, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.38692808151245117  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.2838444709777832  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([108091, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.38692808151245117  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.41269922256469727  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 108091
----------------output nodes number: 11927
----------------edges number: 293699
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.41359376907348633  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.41359376907348633  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4282999038696289  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4282999038696289  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43048858642578125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43048858642578125  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.43257713317871094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4303884506225586  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4302496910095215  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.4323387145996094  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.1472759246826172  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

pseudo mini batch 10 input nodes size: 377433
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11807394027709961  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3514404296875 GB
    Memory Allocated: 0.11807394027709961  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.2586989402770996  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.2587881088256836  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.1434645652770996  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.1550002098083496  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.1550002098083496  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

first layer input nodes number: 377433
first layer output nodes number: 122713
edges number: 1215686
----------------------------------------before model layer 0
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.15872716903686523  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([377433, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.15872716903686523  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.15872716903686523  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4959716796875 GB
    Memory Allocated: 0.2139568328857422  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4959716796875 GB
    Memory Allocated: 0.2139568328857422  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4959716796875 GB
    Memory Allocated: 0.33098506927490234  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([122713, 256])
h_self size  torch.Size([122713, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4959716796875 GB
    Memory Allocated: 0.33098506927490234  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([122713, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.44817256927490234  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.3311443328857422  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([122713, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.44817256927490234  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.4774298667907715  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------input nodes number: 122713
----------------output nodes number: 11945
----------------edges number: 296905
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.47843360900878906  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.47843360900878906  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49243640899658203  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49243640899658203  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49452829360961914  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

h_neigh size torch.Size([11945, 47])
h_self size  torch.Size([11945, 256])
----------------------------------------before rst
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49452829360961914  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11945, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49662017822265625  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49452829360961914  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

torch.Size([11945, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.4946727752685547  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.6131591796875 GB
    Memory Allocated: 0.49676513671875  GigaBytes
Max Memory Allocated: 0.6947922706604004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.17462682723999023  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

pseudo mini batch 11 input nodes size: 321406
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.14360904693603516  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.14360904693603516  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.26334238052368164  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.26343679428100586  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.12272262573242188  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.13445234298706055  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.13445234298706055  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

first layer input nodes number: 321406
first layer output nodes number: 114145
edges number: 1131322
----------------------------------------before model layer 0
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.13769769668579102  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([321406, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.13769769668579102  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.13769769668579102  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.18910455703735352  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.18910455703735352  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.2979617118835449  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

h_neigh size torch.Size([114145, 256])
h_self size  torch.Size([114145, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.2979617118835449  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([114145, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.40681886672973633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.2979617118835449  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([114145, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.40681886672973633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4340333938598633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------input nodes number: 114145
----------------output nodes number: 12613
----------------edges number: 314191
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4349784851074219  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4349784851074219  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4501066207885742  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4501066207885742  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4523153305053711  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

h_neigh size torch.Size([12613, 47])
h_self size  torch.Size([12613, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4523153305053711  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([12613, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.45452404022216797  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4523153305053711  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([12613, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.4521908760070801  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.45452451705932617  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.1540689468383789  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

pseudo mini batch 12 input nodes size: 406448
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.12259817123413086  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.7322998046875 GB
    Memory Allocated: 0.12259817123413086  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.27494192123413086  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.27503108978271484  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.15520334243774414  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.16710329055786133  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.16710329055786133  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

first layer input nodes number: 406448
first layer output nodes number: 120470
edges number: 1187708
----------------------------------------before model layer 0
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.17102956771850586  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([406448, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.17102956771850586  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.17102956771850586  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.2252497673034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.2252497673034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3404841423034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

h_neigh size torch.Size([120470, 256])
h_self size  torch.Size([120470, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3404841423034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([120470, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4557185173034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3404841423034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([120470, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4557185173034668  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.48444080352783203  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------input nodes number: 120470
----------------output nodes number: 11927
----------------edges number: 292837
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4854278564453125  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4854278564453125  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4998159408569336  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.4998159408569336  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.5019044876098633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.5019044876098633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.503993034362793  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.5019044876098633  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.5017843246459961  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.5041704177856445  GigaBytes
Max Memory Allocated: 0.7180304527282715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.18679475784301758  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 13 input nodes size: 247497
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.15508317947387695  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.15508317947387695  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.2472834587097168  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.24737548828125  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.09494256973266602  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.10371685028076172  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.10371685028076172  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 247497
first layer output nodes number: 89900
edges number: 863406
----------------------------------------before model layer 0
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.1062312126159668  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([247497, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.1062312126159668  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.1062312126159668  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.146881103515625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.146881103515625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.23261642456054688  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([89900, 256])
h_self size  torch.Size([89900, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.23261642456054688  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([89900, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.31835174560546875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.23261642456054688  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([89900, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.31835174560546875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3397855758666992  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 89900
----------------output nodes number: 12309
----------------edges number: 290724
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3405475616455078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3405475616455078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3552722930908203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3552722930908203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.35742759704589844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12309, 47])
h_self size  torch.Size([12309, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.35742759704589844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12309, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.35958290100097656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.35742759704589844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12309, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3574943542480469  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.3596501350402832  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.11988162994384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 14 input nodes size: 423480
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.09500932693481445  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 0.09500932693481445  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25321245193481445  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25330209732055664  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1610097885131836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17186307907104492  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17186307907104492  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 423480
first layer output nodes number: 114191
edges number: 1124352
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17586946487426758  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([423480, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17586946487426758  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17586946487426758  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.22721195220947266  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.22721195220947266  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33611297607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([114191, 256])
h_self size  torch.Size([114191, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33611297607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([114191, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.44501399993896484  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33611297607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([114191, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.44501399993896484  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47223949432373047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 114191
----------------output nodes number: 11971
----------------edges number: 275758
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47318029403686523  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47318029403686523  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4868631362915039  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4868631362915039  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4896402359008789  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([11971, 47])
h_self size  torch.Size([11971, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4896402359008789  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11971, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.49173641204833984  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.48895931243896484  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11971, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4895811080932617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.49167776107788086  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19126462936401367  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 15 input nodes size: 390137
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16163158416748047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16163158416748047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.30696916580200195  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.30705833435058594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14876556396484375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15989160537719727  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15989160537719727  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 390137
first layer output nodes number: 112449
edges number: 1105915
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1636366844177246  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([390137, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1636366844177246  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1636366844177246  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2141861915588379  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2141861915588379  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3214259147644043  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([112449, 256])
h_self size  torch.Size([112449, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3214259147644043  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([112449, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4286656379699707  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3214259147644043  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([112449, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4286656379699707  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4554758071899414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 112449
----------------output nodes number: 11929
----------------edges number: 278810
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4564032554626465  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4564032554626465  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4703960418701172  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4703960418701172  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4724850654602051  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([11929, 47])
h_self size  torch.Size([11929, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4724850654602051  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11929, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47457408905029297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4724850654602051  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11929, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47179698944091797  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.47388648986816406  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1783151626586914  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17887592315673828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17887592315673828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055084675550460815 |0.029949620366096497 |0.05965414643287659 |0.00013822317123413086 |0.003335237503051758 |0.0012793540954589844 |
----------------------------------------------------------pseudo_mini_loss sum 6.263719081878662
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6764915
Number of first layer input nodes during this epoch:  5057426
Number of first layer output nodes during this epoch:  1707489
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17887544631958008  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.31187939643859863
global_2_local spend time (sec) 0.4272792339324951

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.174 seconds
Metis partitioning: 13.461 seconds
Split the graph: 1.259 seconds
Construct subgraphs: 0.361 seconds
12250
11927
12647
12321
12650
12601
11927
12471
12527
11957
12092
12609
11935
11927
12636
12094
REG metis partition end ----................................
the time spent:  27.42921543121338
total k batches seeds list generation spend  27.935186624526978
after graph partition
graph partition algorithm spend time 28.53397297859192

partition_len_list
[100331, 112615, 97557, 106013, 115363, 103812, 89076, 80123, 109903, 100382, 85380, 124793, 117443, 114707, 118718, 121160]
REG selection method  spend 29.167889833450317
check_connections_block*********************************
time for parepare 1: 0.22807025909423828
local_output_nid generation: 0.003888368606567383
local_in_edges_tensor generation: 0.004881858825683594
mini_batch_src_global generation: 0.010081291198730469

&&&&&&&&&&&&&&& before remove duplicate length: 298247
r_  generation: 0.10106658935546875

local_output_nid generation: 0.004525184631347656
local_in_edges_tensor generation: 0.004460573196411133
mini_batch_src_global generation: 0.012314796447753906

&&&&&&&&&&&&&&& before remove duplicate length: 286636
r_  generation: 0.10492610931396484

local_output_nid generation: 0.004775285720825195
local_in_edges_tensor generation: 0.004632472991943359
mini_batch_src_global generation: 0.010260820388793945

&&&&&&&&&&&&&&& before remove duplicate length: 304867
r_  generation: 0.1147303581237793

local_output_nid generation: 0.004653453826904297
local_in_edges_tensor generation: 0.004540681838989258
mini_batch_src_global generation: 0.010568618774414062

&&&&&&&&&&&&&&& before remove duplicate length: 297063
r_  generation: 0.11468267440795898

local_output_nid generation: 0.00480341911315918
local_in_edges_tensor generation: 0.004746913909912109
mini_batch_src_global generation: 0.012200593948364258

&&&&&&&&&&&&&&& before remove duplicate length: 314355
r_  generation: 0.1239776611328125

local_output_nid generation: 0.004746437072753906
local_in_edges_tensor generation: 0.004682064056396484
mini_batch_src_global generation: 0.012488603591918945

&&&&&&&&&&&&&&& before remove duplicate length: 311576
r_  generation: 0.12554574012756348

local_output_nid generation: 0.004559755325317383
local_in_edges_tensor generation: 0.004573822021484375
mini_batch_src_global generation: 0.012124300003051758

&&&&&&&&&&&&&&& before remove duplicate length: 287116
r_  generation: 0.11628389358520508

local_output_nid generation: 0.004786491394042969
local_in_edges_tensor generation: 0.006203889846801758
mini_batch_src_global generation: 0.012585878372192383

&&&&&&&&&&&&&&& before remove duplicate length: 294627
r_  generation: 0.1091923713684082

local_output_nid generation: 0.004721641540527344
local_in_edges_tensor generation: 0.004884243011474609
mini_batch_src_global generation: 0.012516260147094727

&&&&&&&&&&&&&&& before remove duplicate length: 292612
r_  generation: 0.11479759216308594

local_output_nid generation: 0.004597902297973633
local_in_edges_tensor generation: 0.009647846221923828
mini_batch_src_global generation: 0.011958599090576172

&&&&&&&&&&&&&&& before remove duplicate length: 274093
r_  generation: 0.11061549186706543

local_output_nid generation: 0.004636526107788086
local_in_edges_tensor generation: 0.006280660629272461
mini_batch_src_global generation: 0.011578798294067383

&&&&&&&&&&&&&&& before remove duplicate length: 285303
r_  generation: 0.10980892181396484

local_output_nid generation: 0.0047991275787353516
local_in_edges_tensor generation: 0.0051457881927490234
mini_batch_src_global generation: 0.013244152069091797

&&&&&&&&&&&&&&& before remove duplicate length: 309563
r_  generation: 0.13046932220458984

local_output_nid generation: 0.00467991828918457
local_in_edges_tensor generation: 0.005780935287475586
mini_batch_src_global generation: 0.013820886611938477

&&&&&&&&&&&&&&& before remove duplicate length: 296145
r_  generation: 0.1317138671875

local_output_nid generation: 0.004661083221435547
local_in_edges_tensor generation: 0.004586458206176758
mini_batch_src_global generation: 0.01308441162109375

&&&&&&&&&&&&&&& before remove duplicate length: 296159
r_  generation: 0.1270139217376709

local_output_nid generation: 0.004781007766723633
local_in_edges_tensor generation: 0.004858732223510742
mini_batch_src_global generation: 0.014147520065307617

&&&&&&&&&&&&&&& before remove duplicate length: 314854
r_  generation: 0.1445779800415039

local_output_nid generation: 0.004669666290283203
local_in_edges_tensor generation: 0.010663509368896484
mini_batch_src_global generation: 0.014330148696899414

&&&&&&&&&&&&&&& before remove duplicate length: 300663
r_  generation: 0.14101505279541016


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7606823444366455
gen group dst list time:  0.048737525939941406
check_connections_block*********************************
time for parepare 1: 0.37645459175109863
local_output_nid generation: 0.026406526565551758
local_in_edges_tensor generation: 0.07617688179016113
mini_batch_src_global generation: 0.03251338005065918

&&&&&&&&&&&&&&& before remove duplicate length: 974284
r_  generation: 0.3855094909667969

local_output_nid generation: 0.034810543060302734
local_in_edges_tensor generation: 0.04259848594665527
mini_batch_src_global generation: 0.04364442825317383

&&&&&&&&&&&&&&& before remove duplicate length: 1088672
r_  generation: 0.4955711364746094

local_output_nid generation: 0.029161691665649414
local_in_edges_tensor generation: 0.02633380889892578
mini_batch_src_global generation: 0.03611040115356445

&&&&&&&&&&&&&&& before remove duplicate length: 936875
r_  generation: 0.4150230884552002

local_output_nid generation: 0.03113722801208496
local_in_edges_tensor generation: 0.03348660469055176
mini_batch_src_global generation: 0.04330778121948242

&&&&&&&&&&&&&&& before remove duplicate length: 1015997
r_  generation: 0.46247434616088867

local_output_nid generation: 0.03247499465942383
local_in_edges_tensor generation: 0.033644676208496094
mini_batch_src_global generation: 0.048866987228393555

&&&&&&&&&&&&&&& before remove duplicate length: 1143547
r_  generation: 0.5213141441345215

local_output_nid generation: 0.030406951904296875
local_in_edges_tensor generation: 0.029056072235107422
mini_batch_src_global generation: 0.04403185844421387

&&&&&&&&&&&&&&& before remove duplicate length: 1021058
r_  generation: 0.4701879024505615

local_output_nid generation: 0.02593398094177246
local_in_edges_tensor generation: 0.021767377853393555
mini_batch_src_global generation: 0.04042696952819824

&&&&&&&&&&&&&&& before remove duplicate length: 865522
r_  generation: 0.4001755714416504

local_output_nid generation: 0.022278308868408203
local_in_edges_tensor generation: 0.017682790756225586
mini_batch_src_global generation: 0.03554844856262207

&&&&&&&&&&&&&&& before remove duplicate length: 772615
r_  generation: 0.3298788070678711

local_output_nid generation: 0.03044295310974121
local_in_edges_tensor generation: 0.028657197952270508
mini_batch_src_global generation: 0.043746232986450195

&&&&&&&&&&&&&&& before remove duplicate length: 1079678
r_  generation: 0.5041706562042236

local_output_nid generation: 0.030541419982910156
local_in_edges_tensor generation: 0.04802441596984863
mini_batch_src_global generation: 0.04428672790527344

&&&&&&&&&&&&&&& before remove duplicate length: 988043
r_  generation: 0.5057740211486816

local_output_nid generation: 0.023598670959472656
local_in_edges_tensor generation: 0.02157735824584961
mini_batch_src_global generation: 0.03822612762451172

&&&&&&&&&&&&&&& before remove duplicate length: 818600
r_  generation: 0.3821585178375244

local_output_nid generation: 0.03376150131225586
local_in_edges_tensor generation: 0.03652310371398926
mini_batch_src_global generation: 0.04916977882385254

&&&&&&&&&&&&&&& before remove duplicate length: 1227409
r_  generation: 0.6047744750976562

local_output_nid generation: 0.03403949737548828
local_in_edges_tensor generation: 0.03370928764343262
mini_batch_src_global generation: 0.05185651779174805

&&&&&&&&&&&&&&& before remove duplicate length: 1162723
r_  generation: 0.5454623699188232

local_output_nid generation: 0.03343987464904785
local_in_edges_tensor generation: 0.04398608207702637
mini_batch_src_global generation: 0.04934430122375488

&&&&&&&&&&&&&&& before remove duplicate length: 1134520
r_  generation: 0.5451149940490723

local_output_nid generation: 0.04207634925842285
local_in_edges_tensor generation: 0.033421993255615234
mini_batch_src_global generation: 0.052107810974121094

&&&&&&&&&&&&&&& before remove duplicate length: 1178306
r_  generation: 0.5512118339538574

local_output_nid generation: 0.049520015716552734
local_in_edges_tensor generation: 0.03880643844604492
mini_batch_src_global generation: 0.052285194396972656

&&&&&&&&&&&&&&& before remove duplicate length: 1199918
r_  generation: 0.6122181415557861


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17887544631958008  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

connection checking time:  14.519310474395752
block generation total time  12.063481092453003
average batch blocks generation time:  0.7539675682783127
pseudo mini batch 0 input nodes size: 295009
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1486372947692871  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1486372947692871  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25853681564331055  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25862836837768555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11320161819458008  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12327766418457031  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12327766418457031  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 295009
first layer output nodes number: 100331
edges number: 974284
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12622356414794922  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([295009, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12622356414794922  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12622356414794922  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17151927947998047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17151927947998047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26720237731933594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([100331, 256])
h_self size  torch.Size([100331, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26720237731933594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([100331, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3628854751586914  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26720237731933594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([100331, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3628854751586914  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3868064880371094  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 100331
----------------output nodes number: 12250
----------------edges number: 298247
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3876457214355469  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3876457214355469  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4023571014404297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4023571014404297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40450239181518555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12250, 47])
h_self size  torch.Size([12250, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40450239181518555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12250, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4066476821899414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40450239181518555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12250, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4045586585998535  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4067049026489258  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14071321487426758  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 1 input nodes size: 373721
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11325883865356445  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11325883865356445  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25248098373413086  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.25257015228271484  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1425790786743164  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15316200256347656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15316200256347656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 373721
first layer output nodes number: 112615
edges number: 1088672
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1567859649658203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([373721, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1567859649658203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1567859649658203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2077927589416504  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2077927589416504  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.31519079208374023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([112615, 256])
h_self size  torch.Size([112615, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.31519079208374023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([112615, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4225888252258301  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.31519079208374023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([112615, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4225888252258301  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.44943857192993164  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 112615
----------------output nodes number: 11927
----------------edges number: 286636
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4503669738769531  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4503669738769531  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46419668197631836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46419668197631836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46628522872924805  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46628522872924805  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46837377548217773  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46628522872924805  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4662284851074219  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.46831750869750977  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17172861099243164  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 2 input nodes size: 250938
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14252233505249023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14252233505249023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23600435256958008  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2360987663269043  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0967874526977539  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10604000091552734  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10604000091552734  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 250938
first layer output nodes number: 97557
edges number: 936875
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10863685607910156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([250938, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10863685607910156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10863685607910156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15276384353637695  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15276384353637695  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.24580144882202148  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([97557, 256])
h_self size  torch.Size([97557, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.24580144882202148  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([97557, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.338839054107666  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.24580144882202148  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([97557, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.338839054107666  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.36209869384765625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 97557
----------------output nodes number: 12647
----------------edges number: 304867
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.36292028427124023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.36292028427124023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3780026435852051  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3780026435852051  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3802170753479004  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12647, 47])
h_self size  torch.Size([12647, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3802170753479004  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12647, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3824315071105957  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3802170753479004  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12647, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.380342960357666  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3826723098754883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12393045425415039  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 3 input nodes size: 298622
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09691333770751953  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09691333770751953  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2081589698791504  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2082509994506836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11467456817626953  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12499666213989258  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12499666213989258  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 298622
first layer output nodes number: 106013
edges number: 1015997
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12801170349121094  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([298622, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12801170349121094  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12801170349121094  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17607688903808594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.17607688903808594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2771787643432617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([106013, 256])
h_self size  torch.Size([106013, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2771787643432617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([106013, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3782806396484375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2771787643432617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([106013, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3782806396484375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40355634689331055  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 106013
----------------output nodes number: 12321
----------------edges number: 297063
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40443849563598633  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40443849563598633  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.41866350173950195  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.41866350173950195  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.42104578018188477  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12321, 47])
h_self size  torch.Size([12321, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.42104578018188477  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12321, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4238615036010742  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4214792251586914  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12321, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.42142248153686523  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.42363739013671875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14261531829833984  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 4 input nodes size: 317666
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11461782455444336  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11461782455444336  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2329578399658203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23305225372314453  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12171459197998047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13257694244384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13257694244384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 317666
first layer output nodes number: 115363
edges number: 1143547
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1358036994934082  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([317666, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1358036994934082  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1358036994934082  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.18836021423339844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.18836021423339844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.29837894439697266  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([115363, 256])
h_self size  torch.Size([115363, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.29837894439697266  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([115363, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4083976745605469  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.29837894439697266  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([115363, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4083976745605469  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43590259552001953  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 115363
----------------output nodes number: 12650
----------------edges number: 314355
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.436856746673584  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.436856746673584  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45258188247680664  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45258188247680664  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45479679107666016  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12650, 47])
h_self size  torch.Size([12650, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45479679107666016  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12650, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45701169967651367  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45479679107666016  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12650, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4556398391723633  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.457855224609375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15438222885131836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 5 input nodes size: 277033
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1225576400756836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1225576400756836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.22576093673706055  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.22585487365722656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10742044448852539  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11761188507080078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11761188507080078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 277033
first layer output nodes number: 103812
edges number: 1021058
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12045001983642578  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([277033, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12045001983642578  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12045001983642578  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16711902618408203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16711902618408203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26612186431884766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([103812, 256])
h_self size  torch.Size([103812, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26612186431884766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([103812, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3651247024536133  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26612186431884766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([103812, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3651247024536133  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3898754119873047  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 103812
----------------output nodes number: 12601
----------------edges number: 311576
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3907432556152344  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3907432556152344  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40529918670654297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40529918670654297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40750551223754883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12601, 47])
h_self size  torch.Size([12601, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40750551223754883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12601, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4097118377685547  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.40750551223754883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12601, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4067111015319824  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4097123146057129  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13446426391601562  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 6 input nodes size: 249194
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10662603378295898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10662603378295898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19945812225341797  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19954729080200195  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09625005722045898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10565662384033203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10565662384033203  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 249194
first layer output nodes number: 89076
edges number: 865522
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10817718505859375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([249194, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10817718505859375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10817718505859375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14814138412475586  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14814138412475586  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23309087753295898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([89076, 256])
h_self size  torch.Size([89076, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23309087753295898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([89076, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3180403709411621  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23309087753295898  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([89076, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3180403709411621  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3392777442932129  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 89076
----------------output nodes number: 11927
----------------edges number: 287116
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3400306701660156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3400306701660156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.35466527938842773  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.35466527938842773  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3567538261413574  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3567538261413574  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3592104911804199  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.35712194442749023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.35700416564941406  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.35909318923950195  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.12034463882446289  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 7 input nodes size: 176885
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09613227844238281  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09613227844238281  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16202735900878906  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16212034225463867  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0691990852355957  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.07772064208984375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.07772064208984375  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 176885
first layer output nodes number: 80123
edges number: 772615
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0796356201171875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([176885, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0796356201171875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0796356201171875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1155400276184082  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1155400276184082  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19195127487182617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([80123, 256])
h_self size  torch.Size([80123, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19195127487182617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([80123, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26836252212524414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.19195127487182617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([80123, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.26836252212524414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.28789377212524414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 80123
----------------output nodes number: 12471
----------------edges number: 294627
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.28858375549316406  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.28858375549316406  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3035140037536621  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3035140037536621  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3056979179382324  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12471, 47])
h_self size  torch.Size([12471, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3056979179382324  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12471, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.30788183212280273  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3056979179382324  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12471, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.30579328536987305  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.30797767639160156  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09196090698242188  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 8 input nodes size: 358520
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.06929445266723633  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.06929445266723633  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.20285367965698242  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.20294713973999023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13695907592773438  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14752578735351562  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14752578735351562  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 358520
first layer output nodes number: 109903
edges number: 1079678
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1510162353515625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([358520, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1510162353515625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1510162353515625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.20041227340698242  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.20041227340698242  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3052239418029785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([109903, 256])
h_self size  torch.Size([109903, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3052239418029785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([109903, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4100356101989746  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3052239418029785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([109903, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4100356101989746  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43623876571655273  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 109903
----------------output nodes number: 12527
----------------edges number: 292612
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4371514320373535  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4371514320373535  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45232248306274414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45232248306274414  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4545159339904785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12527, 47])
h_self size  torch.Size([12527, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4545159339904785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12527, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4567093849182129  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4545159339904785  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12527, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4545254707336426  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.45671939849853516  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16616344451904297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 9 input nodes size: 376142
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13696861267089844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.13696861267089844  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.27709245681762695  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.27718162536621094  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14352893829345703  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15362262725830078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15362262725830078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 376142
first layer output nodes number: 100382
edges number: 988043
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15717363357543945  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([376142, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15717363357543945  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15717363357543945  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2030658721923828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2030658721923828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.298797607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([100382, 256])
h_self size  torch.Size([100382, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.298797607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([100382, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3945293426513672  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.298797607421875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([100382, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3945293426513672  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.41846227645874023  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 100382
----------------output nodes number: 11957
----------------edges number: 274093
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4192996025085449  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4192996025085449  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43283510208129883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43283510208129883  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43492889404296875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([11957, 47])
h_self size  torch.Size([11957, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43492889404296875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11957, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43702268600463867  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.43492889404296875  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([11957, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4348292350769043  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4369235038757324  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.1716938018798828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 10 input nodes size: 235248
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14342927932739258  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14342927932739258  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.23106622695922852  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2311563491821289  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0909433364868164  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0994257926940918  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.0994257926940918  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 235248
first layer output nodes number: 85380
edges number: 818600
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10181522369384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([235248, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10181522369384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.10181522369384766  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14004039764404297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14004039764404297  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2214651107788086  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([85380, 256])
h_self size  torch.Size([85380, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2214651107788086  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([85380, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3028898239135742  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2214651107788086  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([85380, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3028898239135742  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3232460021972656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 85380
----------------output nodes number: 12092
----------------edges number: 285303
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3239727020263672  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3239727020263672  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3381338119506836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3381338119506836  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.34025144577026367  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12092, 47])
h_self size  torch.Size([12092, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.34025144577026367  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12092, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.34325742721557617  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.3411397933959961  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12092, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.34116363525390625  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.34328174591064453  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.11540460586547852  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

pseudo mini batch 11 input nodes size: 380775
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09096717834472656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.09096717834472656  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2328171730041504  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.2329115867614746  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.14518451690673828  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15718793869018555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.15718793869018555  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

first layer input nodes number: 380775
first layer output nodes number: 124793
edges number: 1227409
----------------------------------------before model layer 0
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16173171997070312  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([380775, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16173171997070312  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.16173171997070312  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.21783161163330078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.21783161163330078  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33684349060058594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([124793, 256])
h_self size  torch.Size([124793, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33684349060058594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([124793, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4558553695678711  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.33684349060058594  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([124793, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4558553695678711  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4856085777282715  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------input nodes number: 124793
----------------output nodes number: 12609
----------------edges number: 309563
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4866328239440918  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.4866328239440918  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.501685619354248  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.501685619354248  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.5038933753967285  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

h_neigh size torch.Size([12609, 47])
h_self size  torch.Size([12609, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.5038933753967285  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12609, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.506101131439209  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.5038933753967285  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

torch.Size([12609, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.5039834976196289  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 0.5061917304992676  GigaBytes
Max Memory Allocated: 0.721031665802002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17870330810546875  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 12 input nodes size: 347377
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14527463912963867  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14527463912963867  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27468299865722656  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27477216720581055  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1328277587890625  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14369773864746094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14369773864746094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 347377
first layer output nodes number: 117443
edges number: 1162723
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14716148376464844  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([347377, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14716148376464844  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14716148376464844  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2000136375427246  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2000136375427246  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31201601028442383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([117443, 256])
h_self size  torch.Size([117443, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31201601028442383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([117443, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42401838302612305  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31201601028442383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([117443, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42401838302612305  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45201921463012695  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 117443
----------------output nodes number: 11935
----------------edges number: 296145
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4529838562011719  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4529838562011719  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4668235778808594  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4668235778808594  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46891355514526367  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([11935, 47])
h_self size  torch.Size([11935, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46891355514526367  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([11935, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47100353240966797  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46891355514526367  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([11935, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4687957763671875  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47100400924682617  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1628422737121582  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 13 input nodes size: 314238
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13270998001098633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13270998001098633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24989748001098633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2499866485595703  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12048912048339844  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13118791580200195  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13118791580200195  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 314238
first layer output nodes number: 114707
edges number: 1134520
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([314238, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1343841552734375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18599700927734375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18599700927734375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.29539012908935547  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([114707, 256])
h_self size  torch.Size([114707, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.29539012908935547  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([114707, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4047832489013672  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.29539012908935547  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([114707, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4047832489013672  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4321317672729492  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 114707
----------------output nodes number: 11927
----------------edges number: 296159
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4330759048461914  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4330759048461914  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4470710754394531  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4470710754394531  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4492611885070801  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4492611885070801  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4515862464904785  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44939613342285156  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44939470291137695  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4515852928161621  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14983654022216797  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 14 input nodes size: 323316
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12048768997192383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12048768997192383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24093246459960938  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2410268783569336  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12375020980834961  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13582134246826172  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13582134246826172  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 323316
first layer output nodes number: 118718
edges number: 1178306
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13928556442260742  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([323316, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13928556442260742  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13928556442260742  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19342947006225586  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19342947006225586  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30664777755737305  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([118718, 256])
h_self size  torch.Size([118718, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30664777755737305  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([118718, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41986608505249023  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30664777755737305  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([118718, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41986608505249023  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44817066192626953  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 118718
----------------output nodes number: 12636
----------------edges number: 314854
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44914960861206055  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44914960861206055  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46532678604125977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46532678604125977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46753931045532227  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([12636, 47])
h_self size  torch.Size([12636, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46753931045532227  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12636, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46975183486938477  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46753931045532227  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12636, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4676632881164551  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4707193374633789  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1564784049987793  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 15 input nodes size: 370309
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12387418746948242  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12387418746948242  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2618250846862793  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2619152069091797  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14137601852416992  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15299081802368164  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15299081802368164  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 370309
first layer output nodes number: 121160
edges number: 1199918
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15694952011108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([370309, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15694952011108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15694952011108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21232986450195312  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21232986450195312  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3278770446777344  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([121160, 256])
h_self size  torch.Size([121160, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3278770446777344  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([121160, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4434242248535156  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3278770446777344  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([121160, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4434242248535156  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47231101989746094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 121160
----------------output nodes number: 12094
----------------edges number: 300663
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47330427169799805  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47330427169799805  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4876890182495117  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4876890182495117  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4898066520690918  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([12094, 47])
h_self size  torch.Size([12094, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4898066520690918  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12094, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4919242858886719  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4898066520690918  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12094, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4897117614746094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4919247627258301  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17500734329223633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17500734329223633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17500734329223633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04993085563182831 |0.008072003722190857 |0.012343868613243103 |0.00013512372970581055 |0.002950221300125122 |0.0010554790496826172 |
----------------------------------------------------------pseudo_mini_loss sum 3.425381898880005
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6642369
Number of first layer input nodes during this epoch:  4944993
Number of first layer output nodes during this epoch:  1697376
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17500686645507812  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.26619982719421387
global_2_local spend time (sec) 0.48427462577819824

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.545 seconds
Metis partitioning: 13.193 seconds
Split the graph: 1.229 seconds
Construct subgraphs: 0.415 seconds
12144
12630
12268
12030
12249
11978
12605
12056
12653
12622
11927
12294
12633
11941
11948
12593
REG metis partition end ----................................
the time spent:  27.68917751312256
total k batches seeds list generation spend  28.241020441055298
after graph partition
graph partition algorithm spend time 28.824727058410645

partition_len_list
[110869, 119891, 123256, 93542, 85563, 119638, 111764, 116543, 108758, 118591, 93661, 79088, 108010, 100747, 91679, 115289]
REG selection method  spend 29.53110361099243
check_connections_block*********************************
time for parepare 1: 0.22634339332580566
local_output_nid generation: 0.003970623016357422
local_in_edges_tensor generation: 0.004635810852050781
mini_batch_src_global generation: 0.009752750396728516

&&&&&&&&&&&&&&& before remove duplicate length: 283723
r_  generation: 0.09594559669494629

local_output_nid generation: 0.0048677921295166016
local_in_edges_tensor generation: 0.0044422149658203125
mini_batch_src_global generation: 0.012912273406982422

&&&&&&&&&&&&&&& before remove duplicate length: 313491
r_  generation: 0.12001609802246094

local_output_nid generation: 0.004742145538330078
local_in_edges_tensor generation: 0.004333972930908203
mini_batch_src_global generation: 0.010033845901489258

&&&&&&&&&&&&&&& before remove duplicate length: 296110
r_  generation: 0.11543011665344238

local_output_nid generation: 0.0046956539154052734
local_in_edges_tensor generation: 0.004317760467529297
mini_batch_src_global generation: 0.009783744812011719

&&&&&&&&&&&&&&& before remove duplicate length: 281625
r_  generation: 0.10934162139892578

local_output_nid generation: 0.004785299301147461
local_in_edges_tensor generation: 0.004338502883911133
mini_batch_src_global generation: 0.01038980484008789

&&&&&&&&&&&&&&& before remove duplicate length: 289738
r_  generation: 0.10637950897216797

local_output_nid generation: 0.004651069641113281
local_in_edges_tensor generation: 0.004295825958251953
mini_batch_src_global generation: 0.012610197067260742

&&&&&&&&&&&&&&& before remove duplicate length: 293904
r_  generation: 0.12352943420410156

local_output_nid generation: 0.004868984222412109
local_in_edges_tensor generation: 0.0045773983001708984
mini_batch_src_global generation: 0.012839555740356445

&&&&&&&&&&&&&&& before remove duplicate length: 314027
r_  generation: 0.14049363136291504

local_output_nid generation: 0.004717826843261719
local_in_edges_tensor generation: 0.004369497299194336
mini_batch_src_global generation: 0.012459039688110352

&&&&&&&&&&&&&&& before remove duplicate length: 299752
r_  generation: 0.1270008087158203

local_output_nid generation: 0.0048847198486328125
local_in_edges_tensor generation: 0.0045545101165771484
mini_batch_src_global generation: 0.01639699935913086

&&&&&&&&&&&&&&& before remove duplicate length: 312991
r_  generation: 0.1320054531097412

local_output_nid generation: 0.0048601627349853516
local_in_edges_tensor generation: 0.005471944808959961
mini_batch_src_global generation: 0.013344049453735352

&&&&&&&&&&&&&&& before remove duplicate length: 313715
r_  generation: 0.13672471046447754

local_output_nid generation: 0.004691362380981445
local_in_edges_tensor generation: 0.011467456817626953
mini_batch_src_global generation: 0.013613224029541016

&&&&&&&&&&&&&&& before remove duplicate length: 285649
r_  generation: 0.12362170219421387

local_output_nid generation: 0.00477147102355957
local_in_edges_tensor generation: 0.005944252014160156
mini_batch_src_global generation: 0.0181577205657959

&&&&&&&&&&&&&&& before remove duplicate length: 291787
r_  generation: 0.11165404319763184

local_output_nid generation: 0.004846811294555664
local_in_edges_tensor generation: 0.0048863887786865234
mini_batch_src_global generation: 0.013330459594726562

&&&&&&&&&&&&&&& before remove duplicate length: 305488
r_  generation: 0.1286168098449707

local_output_nid generation: 0.004706382751464844
local_in_edges_tensor generation: 0.004811525344848633
mini_batch_src_global generation: 0.01258540153503418

&&&&&&&&&&&&&&& before remove duplicate length: 290877
r_  generation: 0.1213231086730957

local_output_nid generation: 0.004701852798461914
local_in_edges_tensor generation: 0.005318164825439453
mini_batch_src_global generation: 0.012325763702392578

&&&&&&&&&&&&&&& before remove duplicate length: 288055
r_  generation: 0.12026262283325195

local_output_nid generation: 0.004827976226806641
local_in_edges_tensor generation: 0.007261514663696289
mini_batch_src_global generation: 0.013387680053710938

&&&&&&&&&&&&&&& before remove duplicate length: 302947
r_  generation: 0.1282205581665039


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.758765697479248
gen group dst list time:  0.05212998390197754
check_connections_block*********************************
time for parepare 1: 0.3798506259918213
local_output_nid generation: 0.030920743942260742
local_in_edges_tensor generation: 0.082275390625
mini_batch_src_global generation: 0.03407740592956543

&&&&&&&&&&&&&&& before remove duplicate length: 1088812
r_  generation: 0.49004125595092773

local_output_nid generation: 0.03743934631347656
local_in_edges_tensor generation: 0.04230833053588867
mini_batch_src_global generation: 0.04660511016845703

&&&&&&&&&&&&&&& before remove duplicate length: 1186425
r_  generation: 0.5261640548706055

local_output_nid generation: 0.03671455383300781
local_in_edges_tensor generation: 0.041860342025756836
mini_batch_src_global generation: 0.0449066162109375

&&&&&&&&&&&&&&& before remove duplicate length: 1218331
r_  generation: 0.5854246616363525

local_output_nid generation: 0.029254436492919922
local_in_edges_tensor generation: 0.03583192825317383
mini_batch_src_global generation: 0.04184722900390625

&&&&&&&&&&&&&&& before remove duplicate length: 920038
r_  generation: 0.42748308181762695

local_output_nid generation: 0.024010419845581055
local_in_edges_tensor generation: 0.028566360473632812
mini_batch_src_global generation: 0.037136077880859375

&&&&&&&&&&&&&&& before remove duplicate length: 819816
r_  generation: 0.3771984577178955

local_output_nid generation: 0.03448057174682617
local_in_edges_tensor generation: 0.03581428527832031
mini_batch_src_global generation: 0.04678845405578613

&&&&&&&&&&&&&&& before remove duplicate length: 1174886
r_  generation: 0.5892133712768555

local_output_nid generation: 0.033057451248168945
local_in_edges_tensor generation: 0.03150629997253418
mini_batch_src_global generation: 0.04838252067565918

&&&&&&&&&&&&&&& before remove duplicate length: 1106213
r_  generation: 0.5214660167694092

local_output_nid generation: 0.03541994094848633
local_in_edges_tensor generation: 0.03016972541809082
mini_batch_src_global generation: 0.04779338836669922

&&&&&&&&&&&&&&& before remove duplicate length: 1153504
r_  generation: 0.5642476081848145

local_output_nid generation: 0.03319430351257324
local_in_edges_tensor generation: 0.027788162231445312
mini_batch_src_global generation: 0.04903602600097656

&&&&&&&&&&&&&&& before remove duplicate length: 1071953
r_  generation: 0.5102095603942871

local_output_nid generation: 0.034967899322509766
local_in_edges_tensor generation: 0.02855062484741211
mini_batch_src_global generation: 0.050826311111450195

&&&&&&&&&&&&&&& before remove duplicate length: 1176228
r_  generation: 0.5748405456542969

local_output_nid generation: 0.028526782989501953
local_in_edges_tensor generation: 0.03821921348571777
mini_batch_src_global generation: 0.044944047927856445

&&&&&&&&&&&&&&& before remove duplicate length: 909331
r_  generation: 0.43332695960998535

local_output_nid generation: 0.022835493087768555
local_in_edges_tensor generation: 0.023120403289794922
mini_batch_src_global generation: 0.03623795509338379

&&&&&&&&&&&&&&& before remove duplicate length: 763923
r_  generation: 0.3506913185119629

local_output_nid generation: 0.03252744674682617
local_in_edges_tensor generation: 0.029378652572631836
mini_batch_src_global generation: 0.04447054862976074

&&&&&&&&&&&&&&& before remove duplicate length: 1039963
r_  generation: 0.4915950298309326

local_output_nid generation: 0.032166242599487305
local_in_edges_tensor generation: 0.029510021209716797
mini_batch_src_global generation: 0.044179677963256836

&&&&&&&&&&&&&&& before remove duplicate length: 979182
r_  generation: 0.4858715534210205

local_output_nid generation: 0.02820873260498047
local_in_edges_tensor generation: 0.023818016052246094
mini_batch_src_global generation: 0.04194045066833496

&&&&&&&&&&&&&&& before remove duplicate length: 881172
r_  generation: 0.4311332702636719

local_output_nid generation: 0.041086673736572266
local_in_edges_tensor generation: 0.03193306922912598
mini_batch_src_global generation: 0.04737687110900879

&&&&&&&&&&&&&&& before remove duplicate length: 1110598
r_  generation: 0.5607986450195312


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17500686645507812  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

connection checking time:  14.758573532104492
block generation total time  12.635421752929688
average batch blocks generation time:  0.7897138595581055
block dataloader generation time/epoch 58.89136791229248
pseudo mini batch 0 input nodes size: 375492
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1412801742553711  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1412801742553711  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2811622619628906  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2812528610229492  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14321184158325195  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15343904495239258  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15343904495239258  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 375492
first layer output nodes number: 110869
edges number: 1088812
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15706348419189453  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([375492, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15706348419189453  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15706348419189453  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2068920135498047  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2068920135498047  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3126249313354492  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([110869, 256])
h_self size  torch.Size([110869, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3126249313354492  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([110869, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41835784912109375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3126249313354492  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([110869, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41835784912109375  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.444791316986084  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 110869
----------------output nodes number: 12144
----------------edges number: 283723
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4457082748413086  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4457082748413086  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46081972122192383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46081972122192383  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46294641494750977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([12144, 47])
h_self size  torch.Size([12144, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46294641494750977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12144, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4650731086730957  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46294641494750977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12144, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4629554748535156  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46508312225341797  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1725292205810547  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 1 input nodes size: 344647
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14322185516357422  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14322185516357422  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27161312103271484  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27170753479003906  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13173484802246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1429123878479004  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1429123878479004  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 344647
first layer output nodes number: 119891
edges number: 1186425
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14637422561645508  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([344647, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14637422561645508  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14637422561645508  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20058250427246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20058250427246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31581687927246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([119891, 256])
h_self size  torch.Size([119891, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31581687927246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([119891, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43105125427246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31581687927246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([119891, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43105125427246094  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45963573455810547  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 119891
----------------output nodes number: 12630
----------------edges number: 313491
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46062374114990234  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46062374114990234  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47597169876098633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47597169876098633  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4781832695007324  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([12630, 47])
h_self size  torch.Size([12630, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4781832695007324  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12630, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4804835319519043  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4782719612121582  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12630, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47835683822631836  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.48056888580322266  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16373109817504883  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

pseudo mini batch 2 input nodes size: 409315
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1318197250366211  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1318197250366211  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2843017578125  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.284393310546875  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15590763092041016  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16727113723754883  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16727113723754883  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

first layer input nodes number: 409315
first layer output nodes number: 123256
edges number: 1218331
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17159795761108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([409315, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17159795761108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17159795761108398  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2270517349243164  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2270517349243164  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34459781646728516  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([123256, 256])
h_self size  torch.Size([123256, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34459781646728516  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([123256, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4621438980102539  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34459781646728516  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([123256, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4621438980102539  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4915304183959961  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------input nodes number: 123256
----------------output nodes number: 12268
----------------edges number: 296110
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4925403594970703  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4925403594970703  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5068106651306152  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5068106651306152  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5092740058898926  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

h_neigh size torch.Size([12268, 47])
h_self size  torch.Size([12268, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5092740058898926  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12268, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5114221572875977  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5089588165283203  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

torch.Size([12268, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5092105865478516  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.5113592147827148  GigaBytes
Max Memory Allocated: 0.7309937477111816  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18758773803710938  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 3 input nodes size: 302950
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1561594009399414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1561594009399414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26901721954345703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2691068649291992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11653327941894531  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1257648468017578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1257648468017578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 302950
first layer output nodes number: 93542
edges number: 920038
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12871932983398438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([302950, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12871932983398438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12871932983398438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17077016830444336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17077016830444336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2599787712097168  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([93542, 256])
h_self size  torch.Size([93542, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2599787712097168  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([93542, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34918737411499023  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2599787712097168  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([93542, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34918737411499023  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3714895248413086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 93542
----------------output nodes number: 12030
----------------edges number: 281625
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37227630615234375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37227630615234375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3859376907348633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3859376907348633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3880443572998047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12030, 47])
h_self size  torch.Size([12030, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3880443572998047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12030, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3901510238647461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3880443572998047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12030, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38768768310546875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38979482650756836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14101552963256836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 4 input nodes size: 231523
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11617660522460938  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11617660522460938  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20242595672607422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20251750946044922  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.0895700454711914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09857606887817383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09857606887817383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 231523
first layer output nodes number: 85563
edges number: 819816
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10093879699707031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([231523, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10093879699707031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10093879699707031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13982629776000977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13982629776000977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22142553329467773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([85563, 256])
h_self size  torch.Size([85563, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22142553329467773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([85563, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3030247688293457  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22142553329467773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([85563, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3030247688293457  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3234248161315918  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 85563
----------------output nodes number: 12249
----------------edges number: 289738
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3241539001464844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3241539001464844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33837175369262695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33837175369262695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3405165672302246  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12249, 47])
h_self size  torch.Size([12249, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3405165672302246  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12249, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34270429611206055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3405594825744629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12249, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34059762954711914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.342742919921875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11368703842163086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 5 input nodes size: 387373
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.08960819244384766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.08960819244384766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2339162826538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23400592803955078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14766502380371094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1595773696899414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1595773696899414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 387373
first layer output nodes number: 119638
edges number: 1174886
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16335535049438477  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([387373, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16335535049438477  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16335535049438477  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21747684478759766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21747684478759766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3315725326538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([119638, 256])
h_self size  torch.Size([119638, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3315725326538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([119638, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44566822052001953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3315725326538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([119638, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44566822052001953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47419214248657227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 119638
----------------output nodes number: 11978
----------------edges number: 293904
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4751734733581543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4751734733581543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.48896360397338867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.48896360397338867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.49152708053588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11978, 47])
h_self size  torch.Size([11978, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.49152708053588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11978, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4936246871948242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4910612106323242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11978, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4910140037536621  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4935779571533203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17882061004638672  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 6 input nodes size: 275131
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14761781692504883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14761781692504883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25011253356933594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25020647048950195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10580873489379883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11689376831054688  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11689376831054688  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 275131
first layer output nodes number: 111764
edges number: 1106213
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11977672576904297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([275131, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11977672576904297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11977672576904297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17024898529052734  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17024898529052734  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27683544158935547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([111764, 256])
h_self size  torch.Size([111764, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27683544158935547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([111764, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3834218978881836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.27683544158935547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([111764, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3834218978881836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4100685119628906  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 111764
----------------output nodes number: 12605
----------------edges number: 314027
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4109954833984375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4109954833984375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4268760681152344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4268760681152344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42908334732055664  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12605, 47])
h_self size  torch.Size([12605, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42908334732055664  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12605, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4312906265258789  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42908334732055664  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12605, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42919301986694336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43140077590942383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1360917091369629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 7 input nodes size: 350274
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10591840744018555  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10591840744018555  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2364058494567871  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2364959716796875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13390731811523438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14473533630371094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14473533630371094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 350274
first layer output nodes number: 116543
edges number: 1153504
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14821386337280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([350274, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14821386337280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14821386337280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20065879821777344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.20065879821777344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31180286407470703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([116543, 256])
h_self size  torch.Size([116543, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31180286407470703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([116543, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4229469299316406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31180286407470703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([116543, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4229469299316406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4507331848144531  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 116543
----------------output nodes number: 12056
----------------edges number: 299752
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4516916275024414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4516916275024414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46561431884765625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46561431884765625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46795654296875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12056, 47])
h_self size  torch.Size([12056, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46795654296875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12056, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.47006750106811523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4677252769470215  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12056, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46786022186279297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4699716567993164  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1637730598449707  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 8 input nodes size: 308240
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13404226303100586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13404226303100586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24927663803100586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24937105178833008  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11879348754882812  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12911319732666016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12911319732666016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 308240
first layer output nodes number: 108758
edges number: 1071953
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13222074508666992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([308240, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13222074508666992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13222074508666992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18212032318115234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18212032318115234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2858400344848633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([108758, 256])
h_self size  torch.Size([108758, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2858400344848633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([108758, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3895597457885742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2858400344848633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([108758, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3895597457885742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41548967361450195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 108758
----------------output nodes number: 12653
----------------edges number: 312991
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4163947105407715  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4163947105407715  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4310750961303711  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4310750961303711  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.433290958404541  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12653, 47])
h_self size  torch.Size([12653, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.433290958404541  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12653, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43550682067871094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.433290958404541  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12653, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4331645965576172  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43550729751586914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14769697189331055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 9 input nodes size: 331703
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1186671257019043  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1186671257019043  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24223613739013672  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24233055114746094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12700176239013672  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13896989822387695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13896989822387695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 331703
first layer output nodes number: 118591
edges number: 1176228
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14232492446899414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([331703, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14232492446899414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14232492446899414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19728422164916992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19728422164916992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3103814125061035  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([118591, 256])
h_self size  torch.Size([118591, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3103814125061035  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([118591, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4234786033630371  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3103814125061035  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([118591, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4234786033630371  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4517531394958496  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 118591
----------------output nodes number: 12622
----------------edges number: 313715
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4527311325073242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4527311325073242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46913719177246094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46913719177246094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4713473320007324  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12622, 47])
h_self size  torch.Size([12622, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4713473320007324  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12622, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4735574722290039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4713473320007324  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12622, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.471341609954834  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4735579490661621  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16043567657470703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 10 input nodes size: 268124
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12699604034423828  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12699604034423828  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22688007354736328  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22696924209594727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10330581665039062  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11315536499023438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11315536499023438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 268124
first layer output nodes number: 93661
edges number: 909331
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11585140228271484  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([268124, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11585140228271484  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11585140228271484  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1578679084777832  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1578679084777832  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24718999862670898  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([93661, 256])
h_self size  torch.Size([93661, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24718999862670898  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([93661, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33651208877563477  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24718999862670898  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([93661, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33651208877563477  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3588428497314453  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 93661
----------------output nodes number: 11927
----------------edges number: 285649
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.35963010787963867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.35963010787963867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37322282791137695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37322282791137695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37574005126953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37574005126953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37782859802246094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37531137466430664  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37518978118896484  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3776555061340332  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12868165969848633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 11 input nodes size: 176078
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10318422317504883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10318422317504883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1687784194946289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1688704490661621  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.06889724731445312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07738447189331055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07738447189331055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 176078
first layer output nodes number: 79088
edges number: 763923
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07928609848022461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([176078, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07928609848022461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07928609848022461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11473608016967773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11473608016967773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19016027450561523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([79088, 256])
h_self size  torch.Size([79088, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19016027450561523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([79088, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26558446884155273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19016027450561523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([79088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26558446884155273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.28511571884155273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 79088
----------------output nodes number: 12294
----------------edges number: 291787
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.285797119140625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.285797119140625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30017518997192383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30017518997192383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3032994270324707  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12294, 47])
h_self size  torch.Size([12294, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3032994270324707  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12294, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3054523468017578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30232810974121094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12294, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3033638000488281  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30551719665527344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09226322174072266  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 12 input nodes size: 290524
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.06993293762207031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.06993293762207031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17816162109375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17825603485107422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11256980895996094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12308645248413086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12308645248413086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 290524
first layer output nodes number: 108010
edges number: 1039963
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12702274322509766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([290524, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12702274322509766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12702274322509766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17638111114501953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.17638111114501953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2793874740600586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([108010, 256])
h_self size  torch.Size([108010, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2793874740600586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([108010, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38239383697509766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2793874740600586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([108010, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38239383697509766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4081454277038574  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 108010
----------------output nodes number: 12633
----------------edges number: 305488
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4090447425842285  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4090447425842285  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42376136779785156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42376136779785156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42597341537475586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12633, 47])
h_self size  torch.Size([12633, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42597341537475586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12633, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4283785820007324  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4261665344238281  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12633, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42525434494018555  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42746686935424805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1414318084716797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 13 input nodes size: 323492
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11165761947631836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11165761947631836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23216819763183594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23225736618041992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12393426895141602  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13402462005615234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13402462005615234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 323492
first layer output nodes number: 100747
edges number: 979182
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13718605041503906  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([323492, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13718605041503906  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13718605041503906  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18248367309570312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18248367309570312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2785634994506836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([100747, 256])
h_self size  torch.Size([100747, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2785634994506836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([100747, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37464332580566406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2785634994506836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([100747, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37464332580566406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3986635208129883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 100747
----------------output nodes number: 11941
----------------edges number: 290877
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3995037078857422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3995037078857422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4138507843017578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4138507843017578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4159417152404785  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11941, 47])
h_self size  torch.Size([11941, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4159417152404785  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11941, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4180326461791992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4159417152404785  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11941, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4158205986022949  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.41791200637817383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15117359161376953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 14 input nodes size: 254166
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12381315231323242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12381315231323242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21849775314331055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.21858692169189453  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09798717498779297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10694599151611328  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10694599151611328  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 254166
first layer output nodes number: 91679
edges number: 881172
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10952329635620117  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([254166, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10952329635620117  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10952329635620117  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15058469772338867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15058469772338867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23801660537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([91679, 256])
h_self size  torch.Size([91679, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23801660537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([91679, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.32544851303100586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23801660537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([91679, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.32544851303100586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3473067283630371  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 91679
----------------output nodes number: 11948
----------------edges number: 288055
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34807920455932617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34807920455932617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3617100715637207  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3617100715637207  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.363802433013916  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11948, 47])
h_self size  torch.Size([11948, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.363802433013916  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11948, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36589479446411133  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.363802433013916  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11948, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3638038635253906  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36589670181274414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12188529968261719  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 15 input nodes size: 336749
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09798860549926758  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09798860549926758  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22343778610229492  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22353172302246094  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12875795364379883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1404438018798828  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1404438018798828  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 336749
first layer output nodes number: 115289
edges number: 1110598
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1438121795654297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([336749, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1438121795654297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1438121795654297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1960759162902832  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1960759162902832  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30602407455444336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([115289, 256])
h_self size  torch.Size([115289, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30602407455444336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115289, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4159722328186035  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30602407455444336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115289, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4159722328186035  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.44345951080322266  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 115289
----------------output nodes number: 12593
----------------edges number: 302947
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4444127082824707  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4444127082824707  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4595456123352051  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4595456123352051  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46180295944213867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12593, 47])
h_self size  torch.Size([12593, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46180295944213867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12593, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46488428115844727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.46262693405151367  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12593, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4627394676208496  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4649972915649414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16162443161010742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16162443161010742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16162443161010742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04886171221733093 |0.012384504079818726 |0.012370437383651733 |0.00014159083366394043 |0.002729862928390503 |0.0022509098052978516 |
----------------------------------------------------------pseudo_mini_loss sum 2.04295015335083
Total (block generation + training)time/epoch 60.16962480545044
Training time/epoch 1.2779998779296875
Training time without block to device /epoch 1.079847812652588
Training time without total dataloading part /epoch 0.24612116813659668
load block tensor time/epoch 0.7817873954772949
block to device time/epoch 0.1981520652770996
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  6662670
Number of first layer input nodes during this epoch:  4965781
Number of first layer output nodes during this epoch:  1696889
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16162395477294922  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.30390477180480957
global_2_local spend time (sec) 0.42969322204589844

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.204 seconds
Metis partitioning: 13.174 seconds
Split the graph: 1.129 seconds
Construct subgraphs: 0.437 seconds
11962
11954
12479
12565
12335
12503
12336
12654
11928
12111
12156
11997
12623
12611
11976
12381
REG metis partition end ----................................
the time spent:  27.37914729118347
total k batches seeds list generation spend  27.925387382507324
after graph partition
graph partition algorithm spend time 28.495352268218994

partition_len_list
[103760, 92280, 97413, 115326, 114239, 102739, 90253, 82439, 119118, 84600, 117287, 110625, 115433, 120634, 126092, 121515]
REG selection method  spend 29.1281635761261
check_connections_block*********************************
time for parepare 1: 0.21321797370910645
local_output_nid generation: 0.0039882659912109375
local_in_edges_tensor generation: 0.004425764083862305
mini_batch_src_global generation: 0.011945486068725586

&&&&&&&&&&&&&&& before remove duplicate length: 293280
r_  generation: 0.10416340827941895

local_output_nid generation: 0.004667520523071289
local_in_edges_tensor generation: 0.004119873046875
mini_batch_src_global generation: 0.014109611511230469

&&&&&&&&&&&&&&& before remove duplicate length: 286961
r_  generation: 0.1080324649810791

local_output_nid generation: 0.004815816879272461
local_in_edges_tensor generation: 0.005055904388427734
mini_batch_src_global generation: 0.013076305389404297

&&&&&&&&&&&&&&& before remove duplicate length: 300890
r_  generation: 0.11449551582336426

local_output_nid generation: 0.00486302375793457
local_in_edges_tensor generation: 0.004237651824951172
mini_batch_src_global generation: 0.013195991516113281

&&&&&&&&&&&&&&& before remove duplicate length: 302843
r_  generation: 0.11983108520507812

local_output_nid generation: 0.004807472229003906
local_in_edges_tensor generation: 0.00420379638671875
mini_batch_src_global generation: 0.013918876647949219

&&&&&&&&&&&&&&& before remove duplicate length: 305189
r_  generation: 0.12600445747375488

local_output_nid generation: 0.004900217056274414
local_in_edges_tensor generation: 0.00519108772277832
mini_batch_src_global generation: 0.014438152313232422

&&&&&&&&&&&&&&& before remove duplicate length: 309142
r_  generation: 0.1275169849395752

local_output_nid generation: 0.004842281341552734
local_in_edges_tensor generation: 0.005180835723876953
mini_batch_src_global generation: 0.016621112823486328

&&&&&&&&&&&&&&& before remove duplicate length: 298190
r_  generation: 0.12153506278991699

local_output_nid generation: 0.004931449890136719
local_in_edges_tensor generation: 0.00418853759765625
mini_batch_src_global generation: 0.015529394149780273

&&&&&&&&&&&&&&& before remove duplicate length: 298884
r_  generation: 0.11426091194152832

local_output_nid generation: 0.004652976989746094
local_in_edges_tensor generation: 0.0041351318359375
mini_batch_src_global generation: 0.016762733459472656

&&&&&&&&&&&&&&& before remove duplicate length: 289921
r_  generation: 0.11836719512939453

local_output_nid generation: 0.004779338836669922
local_in_edges_tensor generation: 0.004163265228271484
mini_batch_src_global generation: 0.014774799346923828

&&&&&&&&&&&&&&& before remove duplicate length: 286853
r_  generation: 0.11137509346008301

local_output_nid generation: 0.004754304885864258
local_in_edges_tensor generation: 0.0041713714599609375
mini_batch_src_global generation: 0.014298677444458008

&&&&&&&&&&&&&&& before remove duplicate length: 284828
r_  generation: 0.1283416748046875

local_output_nid generation: 0.004732370376586914
local_in_edges_tensor generation: 0.004004240036010742
mini_batch_src_global generation: 0.014989614486694336

&&&&&&&&&&&&&&& before remove duplicate length: 276133
r_  generation: 0.11741471290588379

local_output_nid generation: 0.004976034164428711
local_in_edges_tensor generation: 0.004267454147338867
mini_batch_src_global generation: 0.012772560119628906

&&&&&&&&&&&&&&& before remove duplicate length: 313162
r_  generation: 0.13483095169067383

local_output_nid generation: 0.0060083866119384766
local_in_edges_tensor generation: 0.0042514801025390625
mini_batch_src_global generation: 0.014942169189453125

&&&&&&&&&&&&&&& before remove duplicate length: 314109
r_  generation: 0.13448095321655273

local_output_nid generation: 0.00480961799621582
local_in_edges_tensor generation: 0.00457310676574707
mini_batch_src_global generation: 0.013153076171875

&&&&&&&&&&&&&&& before remove duplicate length: 297346
r_  generation: 0.13525867462158203

local_output_nid generation: 0.004868507385253906
local_in_edges_tensor generation: 0.004683017730712891
mini_batch_src_global generation: 0.014153242111206055

&&&&&&&&&&&&&&& before remove duplicate length: 306148
r_  generation: 0.13394761085510254


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7543008327484131
gen group dst list time:  0.04976463317871094
check_connections_block*********************************
time for parepare 1: 0.3681180477142334
local_output_nid generation: 0.028525114059448242
local_in_edges_tensor generation: 0.0856022834777832
mini_batch_src_global generation: 0.03519487380981445

&&&&&&&&&&&&&&& before remove duplicate length: 1015938
r_  generation: 0.4341297149658203

local_output_nid generation: 0.029569625854492188
local_in_edges_tensor generation: 0.03445792198181152
mini_batch_src_global generation: 0.039385318756103516

&&&&&&&&&&&&&&& before remove duplicate length: 887383
r_  generation: 0.3831808567047119

local_output_nid generation: 0.0300750732421875
local_in_edges_tensor generation: 0.026330947875976562
mini_batch_src_global generation: 0.0393826961517334

&&&&&&&&&&&&&&& before remove duplicate length: 932598
r_  generation: 0.41100597381591797

local_output_nid generation: 0.03367757797241211
local_in_edges_tensor generation: 0.0330965518951416
mini_batch_src_global generation: 0.04625225067138672

&&&&&&&&&&&&&&& before remove duplicate length: 1108168
r_  generation: 0.5254607200622559

local_output_nid generation: 0.03755497932434082
local_in_edges_tensor generation: 0.03605365753173828
mini_batch_src_global generation: 0.055643320083618164

&&&&&&&&&&&&&&& before remove duplicate length: 1127892
r_  generation: 0.5299510955810547

local_output_nid generation: 0.030707359313964844
local_in_edges_tensor generation: 0.04160428047180176
mini_batch_src_global generation: 0.047527313232421875

&&&&&&&&&&&&&&& before remove duplicate length: 1009914
r_  generation: 0.47688913345336914

local_output_nid generation: 0.026905059814453125
local_in_edges_tensor generation: 0.043523311614990234
mini_batch_src_global generation: 0.04016876220703125

&&&&&&&&&&&&&&& before remove duplicate length: 877900
r_  generation: 0.4341740608215332

local_output_nid generation: 0.04624485969543457
local_in_edges_tensor generation: 0.024636030197143555
mini_batch_src_global generation: 0.03719520568847656

&&&&&&&&&&&&&&& before remove duplicate length: 795107
r_  generation: 0.35544776916503906

local_output_nid generation: 0.03714179992675781
local_in_edges_tensor generation: 0.035247802734375
mini_batch_src_global generation: 0.05277204513549805

&&&&&&&&&&&&&&& before remove duplicate length: 1175944
r_  generation: 0.5855181217193604

local_output_nid generation: 0.03254127502441406
local_in_edges_tensor generation: 0.022426843643188477
mini_batch_src_global generation: 0.04140114784240723

&&&&&&&&&&&&&&& before remove duplicate length: 811290
r_  generation: 0.3771686553955078

local_output_nid generation: 0.034729719161987305
local_in_edges_tensor generation: 0.02982950210571289
mini_batch_src_global generation: 0.04738664627075195

&&&&&&&&&&&&&&& before remove duplicate length: 1151495
r_  generation: 0.5910017490386963

local_output_nid generation: 0.03555941581726074
local_in_edges_tensor generation: 0.03154134750366211
mini_batch_src_global generation: 0.050263166427612305

&&&&&&&&&&&&&&& before remove duplicate length: 1089242
r_  generation: 0.5628697872161865

local_output_nid generation: 0.03491497039794922
local_in_edges_tensor generation: 0.03032207489013672
mini_batch_src_global generation: 0.04906868934631348

&&&&&&&&&&&&&&& before remove duplicate length: 1139380
r_  generation: 0.5616238117218018

local_output_nid generation: 0.03521132469177246
local_in_edges_tensor generation: 0.03582477569580078
mini_batch_src_global generation: 0.05605673789978027

&&&&&&&&&&&&&&& before remove duplicate length: 1196228
r_  generation: 0.5955510139465332

local_output_nid generation: 0.04850149154663086
local_in_edges_tensor generation: 0.10954666137695312
mini_batch_src_global generation: 0.05683279037475586

&&&&&&&&&&&&&&& before remove duplicate length: 1248932
r_  generation: 0.6560654640197754

local_output_nid generation: 0.04574155807495117
local_in_edges_tensor generation: 0.04388856887817383
mini_batch_src_global generation: 0.05526423454284668

&&&&&&&&&&&&&&& before remove duplicate length: 1202644
r_  generation: 0.6359970569610596


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16162395477294922  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

connection checking time:  15.19677186012268
block generation total time  13.119367599487305
average batch blocks generation time:  0.8199604749679565
block dataloader generation time/epoch 59.16353464126587
pseudo mini batch 0 input nodes size: 326405
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12886953353881836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12886953353881836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25046491622924805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25055408477783203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12501096725463867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13566255569458008  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13566255569458008  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 326405
first layer output nodes number: 103760
edges number: 1015938
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1388683319091797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([326405, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1388683319091797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1388683319091797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18608522415161133  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18608522415161133  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.28503847122192383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([103760, 256])
h_self size  torch.Size([103760, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.28503847122192383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([103760, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38399171829223633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.28503847122192383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([103760, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38399171829223633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.40873003005981445  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 103760
----------------output nodes number: 11962
----------------edges number: 293280
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4095926284790039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4095926284790039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4233975410461426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4233975410461426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4254922866821289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11962, 47])
h_self size  torch.Size([11962, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4254922866821289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11962, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.42758703231811523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4254922866821289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11962, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.425382137298584  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4274778366088867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15430164337158203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 1 input nodes size: 258523
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12490177154541016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12490177154541016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22120952606201172  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2212986946105957  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09961414337158203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10923147201538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10923147201538086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 258523
first layer output nodes number: 92280
edges number: 887383
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11184549331665039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([258523, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11184549331665039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11184549331665039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15414905548095703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15414905548095703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24215412139892578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([92280, 256])
h_self size  torch.Size([92280, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24215412139892578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([92280, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33015918731689453  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.24215412139892578  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([92280, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.33015918731689453  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3521604537963867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 92280
----------------output nodes number: 11954
----------------edges number: 286961
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3529372215270996  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3529372215270996  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36752748489379883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36752748489379883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36962080001831055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11954, 47])
h_self size  torch.Size([11954, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36962080001831055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11954, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37171411514282227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36962080001831055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11954, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36961936950683594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.37171459197998047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1261744499206543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 2 input nodes size: 268296
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09961271286010742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09961271286010742  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19956111907958984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19965410232543945  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1032571792602539  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11331510543823242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11331510543823242  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 268296
first layer output nodes number: 97413
edges number: 932598
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11604070663452148  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([268296, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11604070663452148  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11604070663452148  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15964174270629883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.15964174270629883  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25254201889038086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([97413, 256])
h_self size  torch.Size([97413, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25254201889038086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([97413, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3454422950744629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.25254201889038086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([97413, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3454422950744629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3686676025390625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 97413
----------------output nodes number: 12479
----------------edges number: 300890
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36948680877685547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36948680877685547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38377952575683594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38377952575683594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38596487045288086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12479, 47])
h_self size  torch.Size([12479, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38596487045288086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12479, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3881502151489258  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38596487045288086  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12479, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38605690002441406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3882427215576172  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1307382583618164  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 3 input nodes size: 322292
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10334920883178711  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10334920883178711  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22341251373291016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22350645065307617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12346506118774414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13416671752929688  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13416671752929688  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 322292
first layer output nodes number: 115326
edges number: 1108168
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13742733001708984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([322292, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13742733001708984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13742733001708984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18907642364501953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.18907642364501953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2990598678588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([115326, 256])
h_self size  torch.Size([115326, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2990598678588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115326, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4090433120727539  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2990598678588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115326, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4090433120727539  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4365391731262207  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 115326
----------------output nodes number: 12565
----------------edges number: 302843
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43749237060546875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.43749237060546875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45244550704956055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45244550704956055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45464563369750977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12565, 47])
h_self size  torch.Size([12565, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45464563369750977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12565, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.456845760345459  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45464563369750977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12565, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45551109313964844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45771169662475586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1543726921081543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 4 input nodes size: 326323
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12433052062988281  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12433052062988281  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2458953857421875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2459874153137207  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12583017349243164  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13707780838012695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.13707780838012695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 326323
first layer output nodes number: 114239
edges number: 1127892
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14036035537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([326323, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14036035537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14036035537719727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19174766540527344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19174766540527344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30069446563720703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([114239, 256])
h_self size  torch.Size([114239, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30069446563720703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([114239, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4096412658691406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.30069446563720703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([114239, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4096412658691406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4368782043457031  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 114239
----------------output nodes number: 12335
----------------edges number: 305189
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4378213882446289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4378213882446289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4520416259765625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4520416259765625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45476531982421875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12335, 47])
h_self size  torch.Size([12335, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45476531982421875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12335, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4569253921508789  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45420169830322266  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12335, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4533109664916992  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.45603513717651367  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1548023223876953  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 5 input nodes size: 274277
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1249394416809082  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1249394416809082  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22711563110351562  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.22720909118652344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10555219650268555  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11645030975341797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11645030975341797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 274277
first layer output nodes number: 102739
edges number: 1009914
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11925983428955078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([274277, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11925983428955078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11925983428955078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16544055938720703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16544055938720703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26342010498046875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([102739, 256])
h_self size  torch.Size([102739, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26342010498046875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([102739, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36139965057373047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.26342010498046875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([102739, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36139965057373047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.385894775390625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 102739
----------------output nodes number: 12503
----------------edges number: 309142
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38675403594970703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.38675403594970703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.40172481536865234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.40172481536865234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4039139747619629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12503, 47])
h_self size  torch.Size([12503, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4039139747619629  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12503, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.40618419647216797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4039950370788574  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12503, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.4040241241455078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.40621376037597656  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.1343250274658203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 6 input nodes size: 249611
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10558128356933594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10558128356933594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19856882095336914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19866085052490234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09639120101928711  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 249611
first layer output nodes number: 90253
edges number: 877900
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10776519775390625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([249611, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10776519775390625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.10776519775390625  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14826536178588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.14826536178588867  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23433732986450195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([90253, 256])
h_self size  torch.Size([90253, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23433732986450195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([90253, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.32040929794311523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.23433732986450195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([90253, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.32040929794311523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34265613555908203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 90253
----------------output nodes number: 12336
----------------edges number: 298190
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34342098236083984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.34342098236083984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3577694892883301  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3577694892883301  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.35992956161499023  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12336, 47])
h_self size  torch.Size([12336, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.35992956161499023  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12336, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36226511001586914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.360105037689209  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12336, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3600759506225586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.36223649978637695  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.12047529220581055  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 7 input nodes size: 182652
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09636211395263672  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09636211395263672  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16440534591674805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.16449975967407227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07142019271850586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07999181747436523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07999181747436523  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 182652
first layer output nodes number: 82439
edges number: 795107
----------------------------------------before model layer 0
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.08196735382080078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([182652, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.08196735382080078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.08196735382080078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11891031265258789  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.11891031265258789  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19753026962280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([82439, 256])
h_self size  torch.Size([82439, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19753026962280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([82439, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2761502265930176  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.19753026962280273  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([82439, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2761502265930176  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.2958054542541504  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 82439
----------------output nodes number: 12654
----------------edges number: 298884
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.29651451110839844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.29651451110839844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31130504608154297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31130504608154297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3135209083557129  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3135209083557129  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3157367706298828  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3135209083557129  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12654, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.31357669830322266  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.3162527084350586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.09417486190795898  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 8 input nodes size: 430823
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07147598266601562  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.0447998046875 GB
    Memory Allocated: 0.07147598266601562  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23197031021118164  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23205947875976562  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16392183303833008  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17537975311279297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17537975311279297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 430823
first layer output nodes number: 119118
edges number: 1175944
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17947769165039062  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([430823, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17947769165039062  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17947769165039062  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23360586166381836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23360586166381836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.34720563888549805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([119118, 256])
h_self size  torch.Size([119118, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.34720563888549805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([119118, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.46080541610717773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.34720563888549805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([119118, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.46080541610717773  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.48920536041259766  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 119118
----------------output nodes number: 11928
----------------edges number: 289921
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.49018239974975586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.49018239974975586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5048770904541016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5048770904541016  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5069656372070312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11928, 47])
h_self size  torch.Size([11928, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5069656372070312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11928, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5090541839599609  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5069656372070312  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11928, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.506838321685791  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.5089273452758789  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1967921257019043  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 9 input nodes size: 227986
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16379451751708984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16379451751708984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.24872636795043945  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.24881696701049805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.08823347091674805  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.0967264175415039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.0967264175415039  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 227986
first layer output nodes number: 84600
edges number: 811290
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.09905576705932617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([227986, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.09905576705932617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.09905576705932617  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.136932373046875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.136932373046875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.21761322021484375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([84600, 256])
h_self size  torch.Size([84600, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.21761322021484375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([84600, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2982940673828125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.21761322021484375  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([84600, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2982940673828125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3184642791748047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 84600
----------------output nodes number: 12111
----------------edges number: 286853
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3191852569580078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3191852569580078  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33388710021972656  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33388710021972656  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33600807189941406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12111, 47])
h_self size  torch.Size([12111, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33600807189941406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12111, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33812904357910156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.33600807189941406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12111, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3360404968261719  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3381619453430176  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.11224508285522461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 10 input nodes size: 397882
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.08826589584350586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.08826589584350586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23648881912231445  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23657941818237305  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15155696868896484  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16276884078979492  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16276884078979492  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 397882
first layer output nodes number: 117287
edges number: 1151495
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1667022705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([397882, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1667022705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1667022705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.21941280364990234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.21941280364990234  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3312664031982422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([117287, 256])
h_self size  torch.Size([117287, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3312664031982422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([117287, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.44312000274658203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3312664031982422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([117287, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.44312000274658203  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4710836410522461  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 117287
----------------output nodes number: 12156
----------------edges number: 284828
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.472048282623291  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.472048282623291  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4862189292907715  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4862189292907715  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4885902404785156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12156, 47])
h_self size  torch.Size([12156, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4885902404785156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12156, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4907188415527344  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.48834753036499023  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12156, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4885978698730469  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.49072694778442383  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18208599090576172  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 11 input nodes size: 406354
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15180730819702148  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15180730819702148  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.30318641662597656  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.30327606201171875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15496253967285156  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16584444046020508  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16584444046020508  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 406354
first layer output nodes number: 110625
edges number: 1089242
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16969680786132812  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([406354, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16969680786132812  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16969680786132812  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2194361686706543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2194361686706543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3249363899230957  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([110625, 256])
h_self size  torch.Size([110625, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3249363899230957  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([110625, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4304366111755371  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3249363899230957  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([110625, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4304366111755371  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45681190490722656  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 110625
----------------output nodes number: 11997
----------------edges number: 276133
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45772600173950195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45772600173950195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4722442626953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4722442626953125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4749259948730469  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11997, 47])
h_self size  torch.Size([11997, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4749259948730469  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11997, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.47702693939208984  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.47434520721435547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11997, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4740748405456543  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.47644662857055664  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18468475341796875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 12 input nodes size: 316668
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1546921730041504  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1546921730041504  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2726602554321289  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2727546691894531  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.12128591537475586  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13268661499023438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13268661499023438  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 316668
first layer output nodes number: 115433
edges number: 1139380
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13590621948242188  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([316668, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13590621948242188  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13590621948242188  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18782854080200195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18782854080200195  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2979140281677246  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([115433, 256])
h_self size  torch.Size([115433, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2979140281677246  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115433, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.40799951553344727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2979140281677246  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([115433, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.40799951553344727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.43552112579345703  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 115433
----------------output nodes number: 12623
----------------edges number: 313162
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4364757537841797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4364757537841797  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45147085189819336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45147085189819336  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4540233612060547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12623, 47])
h_self size  torch.Size([12623, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4540233612060547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12623, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4562339782714844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45368146896362305  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12623, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4541330337524414  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.45707178115844727  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15299510955810547  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 13 input nodes size: 314448
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.12173748016357422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.12173748016357422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23892498016357422  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.23901939392089844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1209568977355957  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13221025466918945  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.13221025466918945  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 314448
first layer output nodes number: 120634
edges number: 1196228
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1354522705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([314448, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1354522705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.1354522705078125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18975496292114258  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.18975496292114258  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3049893379211426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([120634, 256])
h_self size  torch.Size([120634, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3049893379211426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([120634, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4202237129211426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.3049893379211426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([120634, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4202237129211426  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.44898509979248047  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 120634
----------------output nodes number: 12611
----------------edges number: 314109
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4499783515930176  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4499783515930176  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4651474952697754  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4651474952697754  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.46819543838500977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([12611, 47])
h_self size  torch.Size([12611, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.46819543838500977  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12611, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.47040367126464844  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.46735572814941406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([12611, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.4678511619567871  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.470059871673584  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.15218877792358398  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

pseudo mini batch 14 input nodes size: 420264
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.12145233154296875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.12145233154296875  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2780132293701172  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.2781028747558594  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.16082096099853516  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17287731170654297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17287731170654297  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

first layer input nodes number: 420264
first layer output nodes number: 126092
edges number: 1248932
----------------------------------------before model layer 0
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17694854736328125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([420264, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17694854736328125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2069091796875 GB
    Memory Allocated: 0.17694854736328125  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.2346177101135254  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.2346177101135254  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.35486841201782227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([126092, 256])
h_self size  torch.Size([126092, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.35486841201782227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([126092, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.47511911392211914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.35486841201782227  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([126092, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.47511911392211914  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5051817893981934  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------input nodes number: 126092
----------------output nodes number: 11976
----------------edges number: 297346
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5062112808227539  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5062112808227539  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5199708938598633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5199708938598633  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5225081443786621  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

h_neigh size torch.Size([11976, 47])
h_self size  torch.Size([11976, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5225081443786621  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11976, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5246052742004395  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5220680236816406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

torch.Size([11976, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5211172103881836  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2088623046875 GB
    Memory Allocated: 0.5236549377441406  GigaBytes
Max Memory Allocated: 0.7330756187438965  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1930241584777832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 15 input nodes size: 366212
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15987014770507812  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15987014770507812  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.296295166015625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2963876724243164  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13973712921142578  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15134239196777344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15134239196777344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 366212
first layer output nodes number: 121515
edges number: 1202644
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15530729293823242  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([366212, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15530729293823242  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15530729293823242  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20998907089233398  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20998907089233398  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32587480545043945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([121515, 256])
h_self size  torch.Size([121515, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32587480545043945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([121515, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4417605400085449  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32587480545043945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([121515, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4417605400085449  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4707322120666504  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 121515
----------------output nodes number: 12381
----------------edges number: 306148
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47173023223876953  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47173023223876953  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.486541748046875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.486541748046875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4887099266052246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12381, 47])
h_self size  torch.Size([12381, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4887099266052246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12381, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4909067153930664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4887385368347168  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12381, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.48880958557128906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4909782409667969  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17197513580322266  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17197513580322266  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17197513580322266  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050758689641952515 |0.010690286755561829 |0.01270468533039093 |0.00014378130435943604 |0.002804994583129883 |0.0010557174682617188 |
----------------------------------------------------------pseudo_mini_loss sum 1.6147671937942505
Total (block generation + training)time/epoch 60.447924733161926
Training time/epoch 1.290224313735962
Training time without block to device /epoch 1.1191797256469727
Training time without total dataloading part /epoch 0.2515110969543457
load block tensor time/epoch 0.8121390342712402
block to device time/epoch 0.17104458808898926
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6802769
Number of first layer input nodes during this epoch:  5089016
Number of first layer output nodes during this epoch:  1713753
----------------------------------------before generate dataloader block 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17197465896606445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2636890411376953
global_2_local spend time (sec) 0.45712971687316895

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.149 seconds
Metis partitioning: 13.405 seconds
Split the graph: 1.191 seconds
Construct subgraphs: 0.420 seconds
12099
11927
11948
12654
12030
12643
12615
12653
12551
11956
12165
12496
12647
12113
11952
12122
REG metis partition end ----................................
the time spent:  27.35911512374878
total k batches seeds list generation spend  27.905410766601562
after graph partition
graph partition algorithm spend time 28.50871777534485

partition_len_list
[77702, 105668, 90025, 112688, 104950, 119790, 123863, 107103, 89680, 110343, 122273, 114496, 98748, 111376, 108091, 112093]
REG selection method  spend 29.182841777801514
check_connections_block*********************************
time for parepare 1: 0.24653196334838867
local_output_nid generation: 0.004033088684082031
local_in_edges_tensor generation: 0.004407644271850586
mini_batch_src_global generation: 0.011343955993652344

&&&&&&&&&&&&&&& before remove duplicate length: 285778
r_  generation: 0.10780477523803711

local_output_nid generation: 0.0056612491607666016
local_in_edges_tensor generation: 0.004304409027099609
mini_batch_src_global generation: 0.013923168182373047

&&&&&&&&&&&&&&& before remove duplicate length: 286028
r_  generation: 0.10869884490966797

local_output_nid generation: 0.004674434661865234
local_in_edges_tensor generation: 0.004361867904663086
mini_batch_src_global generation: 0.01082301139831543

&&&&&&&&&&&&&&& before remove duplicate length: 294050
r_  generation: 0.1125192642211914

local_output_nid generation: 0.004960775375366211
local_in_edges_tensor generation: 0.004492759704589844
mini_batch_src_global generation: 0.011354207992553711

&&&&&&&&&&&&&&& before remove duplicate length: 313138
r_  generation: 0.12304472923278809

local_output_nid generation: 0.007299661636352539
local_in_edges_tensor generation: 0.004268646240234375
mini_batch_src_global generation: 0.011126279830932617

&&&&&&&&&&&&&&& before remove duplicate length: 267248
r_  generation: 0.10467362403869629

local_output_nid generation: 0.00494384765625
local_in_edges_tensor generation: 0.004584074020385742
mini_batch_src_global generation: 0.012453556060791016

&&&&&&&&&&&&&&& before remove duplicate length: 312781
r_  generation: 0.13069868087768555

local_output_nid generation: 0.004930734634399414
local_in_edges_tensor generation: 0.006419181823730469
mini_batch_src_global generation: 0.013044118881225586

&&&&&&&&&&&&&&& before remove duplicate length: 311539
r_  generation: 0.1310722827911377

local_output_nid generation: 0.004953145980834961
local_in_edges_tensor generation: 0.004676103591918945
mini_batch_src_global generation: 0.012890100479125977

&&&&&&&&&&&&&&& before remove duplicate length: 312707
r_  generation: 0.13172078132629395

local_output_nid generation: 0.004887104034423828
local_in_edges_tensor generation: 0.005594968795776367
mini_batch_src_global generation: 0.013248920440673828

&&&&&&&&&&&&&&& before remove duplicate length: 296653
r_  generation: 0.11922216415405273

local_output_nid generation: 0.004714012145996094
local_in_edges_tensor generation: 0.0044324398040771484
mini_batch_src_global generation: 0.012546539306640625

&&&&&&&&&&&&&&& before remove duplicate length: 288007
r_  generation: 0.1167454719543457

local_output_nid generation: 0.0047473907470703125
local_in_edges_tensor generation: 0.004569292068481445
mini_batch_src_global generation: 0.013516426086425781

&&&&&&&&&&&&&&& before remove duplicate length: 302358
r_  generation: 0.1298236846923828

local_output_nid generation: 0.0048732757568359375
local_in_edges_tensor generation: 0.0047664642333984375
mini_batch_src_global generation: 0.013519763946533203

&&&&&&&&&&&&&&& before remove duplicate length: 311603
r_  generation: 0.13634490966796875

local_output_nid generation: 0.004975795745849609
local_in_edges_tensor generation: 0.005499601364135742
mini_batch_src_global generation: 0.013649702072143555

&&&&&&&&&&&&&&& before remove duplicate length: 305124
r_  generation: 0.12961673736572266

local_output_nid generation: 0.0047566890716552734
local_in_edges_tensor generation: 0.004454374313354492
mini_batch_src_global generation: 0.01318359375

&&&&&&&&&&&&&&& before remove duplicate length: 292079
r_  generation: 0.12650752067565918

local_output_nid generation: 0.004721403121948242
local_in_edges_tensor generation: 0.004477500915527344
mini_batch_src_global generation: 0.013124465942382812

&&&&&&&&&&&&&&& before remove duplicate length: 289769
r_  generation: 0.12377381324768066

local_output_nid generation: 0.004806995391845703
local_in_edges_tensor generation: 0.0044972896575927734
mini_batch_src_global generation: 0.013000249862670898

&&&&&&&&&&&&&&& before remove duplicate length: 295017
r_  generation: 0.12935781478881836


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7642679214477539
gen group dst list time:  0.04860877990722656
check_connections_block*********************************
time for parepare 1: 0.38663148880004883
local_output_nid generation: 0.019388437271118164
local_in_edges_tensor generation: 0.08935117721557617
mini_batch_src_global generation: 0.02403879165649414

&&&&&&&&&&&&&&& before remove duplicate length: 749456
r_  generation: 0.289201021194458

local_output_nid generation: 0.03275799751281738
local_in_edges_tensor generation: 0.03412365913391113
mini_batch_src_global generation: 0.04078483581542969

&&&&&&&&&&&&&&& before remove duplicate length: 1032042
r_  generation: 0.4502079486846924

local_output_nid generation: 0.028011083602905273
local_in_edges_tensor generation: 0.03431439399719238
mini_batch_src_global generation: 0.04338431358337402

&&&&&&&&&&&&&&& before remove duplicate length: 881724
r_  generation: 0.39905405044555664

local_output_nid generation: 0.03379082679748535
local_in_edges_tensor generation: 0.031639814376831055
mini_batch_src_global generation: 0.04414224624633789

&&&&&&&&&&&&&&& before remove duplicate length: 1111497
r_  generation: 0.5103487968444824

local_output_nid generation: 0.03125786781311035
local_in_edges_tensor generation: 0.034670352935791016
mini_batch_src_global generation: 0.04245328903198242

&&&&&&&&&&&&&&& before remove duplicate length: 1026632
r_  generation: 0.48273539543151855

local_output_nid generation: 0.03490257263183594
local_in_edges_tensor generation: 0.0380251407623291
mini_batch_src_global generation: 0.048119306564331055

&&&&&&&&&&&&&&& before remove duplicate length: 1189035
r_  generation: 0.5716564655303955

local_output_nid generation: 0.036826372146606445
local_in_edges_tensor generation: 0.03389692306518555
mini_batch_src_global generation: 0.059973955154418945

&&&&&&&&&&&&&&& before remove duplicate length: 1224679
r_  generation: 0.6338703632354736

local_output_nid generation: 0.03244209289550781
local_in_edges_tensor generation: 0.03256344795227051
mini_batch_src_global generation: 0.04776453971862793

&&&&&&&&&&&&&&& before remove duplicate length: 1053704
r_  generation: 0.5033600330352783

local_output_nid generation: 0.028864145278930664
local_in_edges_tensor generation: 0.02336406707763672
mini_batch_src_global generation: 0.04053354263305664

&&&&&&&&&&&&&&& before remove duplicate length: 859937
r_  generation: 0.39792823791503906

local_output_nid generation: 0.03399467468261719
local_in_edges_tensor generation: 0.03096747398376465
mini_batch_src_global generation: 0.04733753204345703

&&&&&&&&&&&&&&& before remove duplicate length: 1090343
r_  generation: 0.5616867542266846

local_output_nid generation: 0.03731679916381836
local_in_edges_tensor generation: 0.03257393836975098
mini_batch_src_global generation: 0.07368230819702148

&&&&&&&&&&&&&&& before remove duplicate length: 1211536
r_  generation: 0.6366093158721924

local_output_nid generation: 0.03327155113220215
local_in_edges_tensor generation: 0.028348445892333984
mini_batch_src_global generation: 0.050647735595703125

&&&&&&&&&&&&&&& before remove duplicate length: 1133688
r_  generation: 0.5622043609619141

local_output_nid generation: 0.029831647872924805
local_in_edges_tensor generation: 0.03125309944152832
mini_batch_src_global generation: 0.0452418327331543

&&&&&&&&&&&&&&& before remove duplicate length: 948072
r_  generation: 0.4556734561920166

local_output_nid generation: 0.03357720375061035
local_in_edges_tensor generation: 0.02744770050048828
mini_batch_src_global generation: 0.04757213592529297

&&&&&&&&&&&&&&& before remove duplicate length: 1074641
r_  generation: 0.5290319919586182

local_output_nid generation: 0.033952951431274414
local_in_edges_tensor generation: 0.03081965446472168
mini_batch_src_global generation: 0.04745078086853027

&&&&&&&&&&&&&&& before remove duplicate length: 1046521
r_  generation: 0.5223712921142578

local_output_nid generation: 0.03318190574645996
local_in_edges_tensor generation: 0.10056352615356445
mini_batch_src_global generation: 0.05012035369873047

&&&&&&&&&&&&&&& before remove duplicate length: 1086323
r_  generation: 0.5408201217651367


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17197465896606445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

connection checking time:  15.020084857940674
block generation total time  12.386784791946411
average batch blocks generation time:  0.7741740494966507
block dataloader generation time/epoch 58.95813957850138
pseudo mini batch 0 input nodes size: 170269
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13980722427368164  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13980722427368164  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20323753356933594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20332813262939453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.06681060791015625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.0745248794555664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.0745248794555664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 170269
first layer output nodes number: 77702
edges number: 749456
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.07637310028076172  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([170269, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.07637310028076172  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.07637310028076172  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11138486862182617  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11138486862182617  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1854872703552246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([77702, 256])
h_self size  torch.Size([77702, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1854872703552246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([77702, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.25958967208862305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1854872703552246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([77702, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.25958967208862305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.27811527252197266  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 77702
----------------output nodes number: 12099
----------------edges number: 285778
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.27878522872924805  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.27878522872924805  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.292543888092041  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.292543888092041  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.29485130310058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12099, 47])
h_self size  torch.Size([12099, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.29485130310058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12099, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2969698905944824  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2946624755859375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12099, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2946128845214844  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2969212532043457  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.08783197402954102  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 1 input nodes size: 318026
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.06676197052001953  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.06676197052001953  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.18523597717285156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.18532514572143555  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12180423736572266  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13258886337280273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13258886337280273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 318026
first layer output nodes number: 105668
edges number: 1032042
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13574647903442383  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([318026, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13574647903442383  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13574647903442383  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.183502197265625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.183502197265625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2842750549316406  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([105668, 256])
h_self size  torch.Size([105668, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2842750549316406  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([105668, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38504791259765625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2842750549316406  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([105668, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38504791259765625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.41024112701416016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 105668
----------------output nodes number: 11927
----------------edges number: 286028
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4111180305480957  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4111180305480957  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42523908615112305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42523908615112305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42732763290405273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42732763290405273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4294161796569824  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42732763290405273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11927, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42729759216308594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4294166564941406  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15009021759033203  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 2 input nodes size: 268167
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12177419662475586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12177419662475586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.22167444229125977  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.22176361083984375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10320043563842773  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11214542388916016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11214542388916016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 268167
first layer output nodes number: 90025
edges number: 881724
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11481475830078125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([268167, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11481475830078125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11481475830078125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1552577018737793  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1552577018737793  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.24111223220825195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([90025, 256])
h_self size  torch.Size([90025, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.24111223220825195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([90025, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3269667625427246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.24111223220825195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([90025, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3269667625427246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3484306335449219  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 90025
----------------output nodes number: 11948
----------------edges number: 294050
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.34919071197509766  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.34919071197509766  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36305809020996094  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36305809020996094  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3652491569519043  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([11948, 47])
h_self size  torch.Size([11948, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3652491569519043  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11948, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3673415184020996  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36515045166015625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11948, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3652529716491699  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36734580993652344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12753820419311523  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 3 input nodes size: 324249
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1033029556274414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1033029556274414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.22409534454345703  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.22418975830078125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12420034408569336  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1357893943786621  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1357893943786621  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 324249
first layer output nodes number: 112688
edges number: 1111497
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13904523849487305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([324249, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13904523849487305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13904523849487305  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1897268295288086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1897268295288086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2971944808959961  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([112688, 256])
h_self size  torch.Size([112688, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2971944808959961  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([112688, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4046621322631836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2971944808959961  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([112688, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4046621322631836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43152904510498047  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 112688
----------------output nodes number: 12654
----------------edges number: 313138
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4324631690979004  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4324631690979004  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44698476791381836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44698476791381836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44931793212890625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44931793212890625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45153379440307617  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4492006301879883  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12654, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4493427276611328  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4522852897644043  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15459203720092773  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 4 input nodes size: 351332
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12434244155883789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12434244155883789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.25522422790527344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2553138732910156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13442707061767578  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14519977569580078  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14519977569580078  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 351332
first layer output nodes number: 104950
edges number: 1026632
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14859962463378906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([351332, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14859962463378906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14859962463378906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19573736190795898  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19573736190795898  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2958254814147949  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([104950, 256])
h_self size  torch.Size([104950, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2958254814147949  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([104950, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.39591360092163086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2958254814147949  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([104950, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.39591360092163086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42093563079833984  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 104950
----------------output nodes number: 12030
----------------edges number: 267248
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42180728912353516  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42180728912353516  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4362788200378418  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4362788200378418  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4383854866027832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12030, 47])
h_self size  torch.Size([12030, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4383854866027832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12030, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4404921531677246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4383854866027832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12030, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4381589889526367  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4404926300048828  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1626300811767578  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 5 input nodes size: 354111
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1342005729675293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1342005729675293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.26611757278442383  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.26621198654174805  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1352405548095703  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14643096923828125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14643096923828125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 354111
first layer output nodes number: 119790
edges number: 1189035
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1499619483947754  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([354111, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1499619483947754  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1499619483947754  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20389318466186523  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20389318466186523  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3181338310241699  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([119790, 256])
h_self size  torch.Size([119790, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3181338310241699  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([119790, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4323744773864746  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3181338310241699  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([119790, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4323744773864746  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4609346389770508  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 119790
----------------output nodes number: 12643
----------------edges number: 312781
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.46192169189453125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.46192169189453125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4771003723144531  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4771003723144531  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47931432723999023  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12643, 47])
h_self size  torch.Size([12643, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47931432723999023  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12643, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.48152828216552734  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47931432723999023  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12643, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47942161560058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4824681282043457  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.16662836074829102  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 6 input nodes size: 374685
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13534784317016602  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13534784317016602  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2749290466308594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2750234603881836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14301204681396484  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1551828384399414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1551828384399414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 374685
first layer output nodes number: 123863
edges number: 1224679
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1597437858581543  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([374685, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1597437858581543  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1597437858581543  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21547269821166992  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21547269821166992  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.33359766006469727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([123863, 256])
h_self size  torch.Size([123863, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.33359766006469727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([123863, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4517226219177246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.33359766006469727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([123863, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4517226219177246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.48125410079956055  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 123863
----------------output nodes number: 12615
----------------edges number: 311539
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.482271671295166  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.482271671295166  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4970536231994629  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4970536231994629  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49926280975341797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12615, 47])
h_self size  torch.Size([12615, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49926280975341797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12615, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.5022001266479492  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49999094009399414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12615, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4999861717224121  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.5022006034851074  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17633867263793945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 7 input nodes size: 306576
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1430072784423828  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1430072784423828  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2572159767150879  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2573103904724121  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11763477325439453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12816286087036133  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12816286087036133  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 306576
first layer output nodes number: 107103
edges number: 1053704
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13124561309814453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([306576, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13124561309814453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13124561309814453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1799793243408203  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1799793243408203  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2821207046508789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([107103, 256])
h_self size  torch.Size([107103, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2821207046508789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([107103, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3842620849609375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2821207046508789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([107103, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3842620849609375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.40979766845703125  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 107103
----------------output nodes number: 12653
----------------edges number: 312707
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4106903076171875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4106903076171875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4251823425292969  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4251823425292969  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4278740882873535  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12653, 47])
h_self size  torch.Size([12653, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4278740882873535  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12653, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43008995056152344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4273982048034668  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12653, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42740488052368164  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4300971031188965  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1460871696472168  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 8 input nodes size: 242720
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11764144897460938  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11764144897460938  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20806169509887695  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20815563201904297  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09385251998901367  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10247087478637695  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10247087478637695  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 242720
first layer output nodes number: 89680
edges number: 859937
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10539817810058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([242720, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10539817810058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10539817810058594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14554882049560547  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14554882049560547  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.23107433319091797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([89680, 256])
h_self size  torch.Size([89680, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.23107433319091797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([89680, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.31659984588623047  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.23107433319091797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([89680, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.31659984588623047  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3379812240600586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 89680
----------------output nodes number: 12551
----------------edges number: 296653
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3387436866760254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3387436866760254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.35301828384399414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.35301828384399414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3559131622314453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12551, 47])
h_self size  torch.Size([12551, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3559131622314453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12551, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3581109046936035  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.35521602630615234  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12551, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3551979064941406  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.35809326171875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11854934692382812  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 9 input nodes size: 390281
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09383440017700195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09383440017700195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2392258644104004  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.23931503295898438  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14880084991455078  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1593003273010254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1593003273010254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 390281
first layer output nodes number: 110343
edges number: 1090343
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.16303110122680664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([390281, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.16303110122680664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.16303110122680664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21361017227172852  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21361017227172852  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.31884145736694336  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([110343, 256])
h_self size  torch.Size([110343, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.31884145736694336  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([110343, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4240727424621582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.31884145736694336  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([110343, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4240727424621582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.450380802154541  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 110343
----------------output nodes number: 11956
----------------edges number: 288007
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4512925148010254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4512925148010254  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.46567440032958984  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.46567440032958984  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.468416690826416  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([11956, 47])
h_self size  torch.Size([11956, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.468416690826416  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11956, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47051048278808594  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.46776819229125977  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11956, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4676642417907715  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4698624610900879  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17885589599609375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 10 input nodes size: 368518
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1486968994140625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1486968994140625  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2859807014465332  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.28607177734375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14059114456176758  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1522669792175293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1522669792175293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 368518
first layer output nodes number: 122273
edges number: 1211536
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15592432022094727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([368518, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15592432022094727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15592432022094727  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21095800399780273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21095800399780273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32814550399780273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([122273, 256])
h_self size  torch.Size([122273, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32814550399780273  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([122273, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44475412368774414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.32756662368774414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([122273, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44475412368774414  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4739065170288086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 122273
----------------output nodes number: 12165
----------------edges number: 302358
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47490882873535156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.47490882873535156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4900178909301758  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4900178909301758  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4922323226928711  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12165, 47])
h_self size  torch.Size([12165, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4922323226928711  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12165, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49436235427856445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49214792251586914  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12165, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.49226856231689453  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4943990707397461  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.17270183563232422  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 11 input nodes size: 283376
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14071178436279297  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14071178436279297  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2462778091430664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.24637126922607422  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10899639129638672  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11982583999633789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11982583999633789  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 283376
first layer output nodes number: 114496
edges number: 1133688
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12279033660888672  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([283376, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12279033660888672  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12279033660888672  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1743168830871582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1743168830871582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2835087776184082  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([114496, 256])
h_self size  torch.Size([114496, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2835087776184082  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([114496, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3927006721496582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2835087776184082  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([114496, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3927006721496582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4199986457824707  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 114496
----------------output nodes number: 12496
----------------edges number: 311603
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4209451675415039  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4209451675415039  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43527793884277344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43527793884277344  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4374661445617676  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12496, 47])
h_self size  torch.Size([12496, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4374661445617676  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12496, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4396543502807617  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4374661445617676  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12496, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4374399185180664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43962860107421875  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13820695877075195  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 12 input nodes size: 257146
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10897016525268555  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10897016525268555  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20476484298706055  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.20485925674438477  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09919977188110352  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10906648635864258  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.10906648635864258  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 257146
first layer output nodes number: 98748
edges number: 948072
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([257146, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15593671798706055  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15593671798706055  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2501101493835449  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([98748, 256])
h_self size  torch.Size([98748, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2501101493835449  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([98748, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3442835807800293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2501101493835449  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([98748, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3442835807800293  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3678269386291504  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 98748
----------------output nodes number: 12647
----------------edges number: 305124
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36865711212158203  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.36865711212158203  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38318777084350586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38318777084350586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38540220260620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12647, 47])
h_self size  torch.Size([12647, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38540220260620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12647, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.3876166343688965  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38540220260620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12647, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38542842864990234  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.38764333724975586  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12673521041870117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 13 input nodes size: 321160
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09922599792480469  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.09922599792480469  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21886777877807617  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.21895837783813477  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12306928634643555  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13418149948120117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13418149948120117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 321160
first layer output nodes number: 111376
edges number: 1074641
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1383194923400879  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([321160, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1383194923400879  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1383194923400879  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1882328987121582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1882328987121582  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2944493293762207  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([111376, 256])
h_self size  torch.Size([111376, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2944493293762207  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([111376, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4006657600402832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2944493293762207  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([111376, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4006657600402832  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42721986770629883  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 111376
----------------output nodes number: 12113
----------------edges number: 292079
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42814064025878906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42814064025878906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4419593811035156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4419593811035156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4440803527832031  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12113, 47])
h_self size  torch.Size([12113, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4440803527832031  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12113, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4462013244628906  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4440803527832031  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12113, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4439868927001953  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.446108341217041  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15285682678222656  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 14 input nodes size: 345916
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12297582626342773  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.12297582626342773  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.25183963775634766  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.25192880630493164  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13219642639160156  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14251947402954102  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14251947402954102  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 345916
first layer output nodes number: 108091
edges number: 1046521
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14590215682983398  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([345916, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14590215682983398  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14590215682983398  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19440793991088867  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19440793991088867  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.29749155044555664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([108091, 256])
h_self size  torch.Size([108091, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.29749155044555664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([108091, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4005751609802246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.29749155044555664  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([108091, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4005751609802246  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4263463020324707  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 108091
----------------output nodes number: 11952
----------------edges number: 289769
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42724084854125977  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.42724084854125977  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44197654724121094  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44197654724121094  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44406938552856445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([11952, 47])
h_self size  torch.Size([11952, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44406938552856445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11952, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44616222381591797  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44406938552856445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([11952, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44404125213623047  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4461345672607422  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.16037893295288086  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

pseudo mini batch 15 input nodes size: 334612
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13216829299926758  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.13216829299926758  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2568211555480957  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.2569117546081543  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1279587745666504  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1383528709411621  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.1383528709411621  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

first layer input nodes number: 334612
first layer output nodes number: 112093
edges number: 1086323
----------------------------------------before model layer 0
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14174985885620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([334612, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14174985885620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.14174985885620117  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19201946258544922  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.19201946258544922  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.298919677734375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([112093, 256])
h_self size  torch.Size([112093, 100])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.298919677734375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([112093, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4058198928833008  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.298919677734375  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([112093, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4058198928833008  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.43254518508911133  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------input nodes number: 112093
----------------output nodes number: 12122
----------------edges number: 295017
----------------------------------------before mean aggregator
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4334712028503418  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.4334712028503418  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44820308685302734  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.44820308685302734  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45044755935668945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

h_neigh size torch.Size([12122, 47])
h_self size  torch.Size([12122, 256])
----------------------------------------before rst
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45044755935668945  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45257043838500977  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45032596588134766  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

torch.Size([12122, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45035600662231445  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.45260095596313477  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15731191635131836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15731191635131836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 9.2108154296875 GB
    Memory Allocated: 0.15731191635131836  GigaBytes
Max Memory Allocated: 0.751063346862793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05310186743736267 |0.007671967148780823 |0.011835098266601562 |0.0001382678747177124 |0.002859249711036682 |0.00225830078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4562480449676514
Total (block generation + training)time/epoch 60.23418768246969
Training time/epoch 1.2591297626495361
Training time without block to device /epoch 1.136378288269043
Training time without total dataloading part /epoch 0.2395801544189453
load block tensor time/epoch 0.8496298789978027
block to device time/epoch 0.12275147438049316
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  6720033
Number of first layer input nodes during this epoch:  5011144
Number of first layer output nodes during this epoch:  1708889
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
