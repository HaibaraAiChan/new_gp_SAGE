main start at this time 1660334345.7607155
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.19875288009643555
global_2_local spend time (sec) 0.3643321990966797

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.929 seconds
Metis partitioning: 11.179 seconds
Split the graph: 3.091 seconds
Construct subgraphs: 0.068 seconds
48485
49243
48224
50619
REG metis partition end ----................................
the time spent:  26.196115255355835
total k batches seeds list generation spend  26.720547914505005
after graph partition
graph partition algorithm spend time 27.43699312210083

partition_len_list
[317026, 333571, 368364, 381675]
REG selection method  spend 27.963926076889038
check_connections_block*********************************
time for parepare 1: 0.22886419296264648
local_output_nid generation: 0.00793600082397461
local_in_edges_tensor generation: 0.013178348541259766
mini_batch_src_global generation: 0.037392377853393555

&&&&&&&&&&&&&&& before remove duplicate length: 1170835
r_  generation: 0.4765467643737793

local_output_nid generation: 0.011052846908569336
local_in_edges_tensor generation: 0.07903885841369629
mini_batch_src_global generation: 0.057393789291381836

&&&&&&&&&&&&&&& before remove duplicate length: 1197396
r_  generation: 0.5202276706695557

local_output_nid generation: 0.01101231575012207
local_in_edges_tensor generation: 0.021121501922607422
mini_batch_src_global generation: 0.03960609436035156

&&&&&&&&&&&&&&& before remove duplicate length: 1138750
r_  generation: 0.5249507427215576

local_output_nid generation: 0.01006627082824707
local_in_edges_tensor generation: 0.015690326690673828
mini_batch_src_global generation: 0.05562996864318848

&&&&&&&&&&&&&&& before remove duplicate length: 1256898
r_  generation: 0.6420674324035645


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6984140872955322
gen group dst list time:  0.03827834129333496
check_connections_block*********************************
time for parepare 1: 0.3593900203704834
local_output_nid generation: 0.05608725547790527
local_in_edges_tensor generation: 0.13837575912475586
mini_batch_src_global generation: 0.09900903701782227

&&&&&&&&&&&&&&& before remove duplicate length: 3026852
r_  generation: 1.3398423194885254

local_output_nid generation: 0.07463693618774414
local_in_edges_tensor generation: 0.1035616397857666
mini_batch_src_global generation: 0.12213873863220215

&&&&&&&&&&&&&&& before remove duplicate length: 3255908
r_  generation: 1.5289161205291748

local_output_nid generation: 0.0853261947631836
local_in_edges_tensor generation: 0.10744309425354004
mini_batch_src_global generation: 0.12828516960144043

&&&&&&&&&&&&&&& before remove duplicate length: 3596309
r_  generation: 1.7835161685943604

local_output_nid generation: 0.08385705947875977
local_in_edges_tensor generation: 0.10302376747131348
mini_batch_src_global generation: 0.1410360336303711

&&&&&&&&&&&&&&& before remove duplicate length: 3766453
r_  generation: 1.968351125717163


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  12.617065668106079
block generation total time  12.517858266830444
average batch blocks generation time:  3.129464566707611
pseudo mini batch 0 input nodes size: 653033
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 0.24442100524902344  GigaBytes
Max Memory Allocated: 0.24442100524902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 0.2447824478149414  GigaBytes
Max Memory Allocated: 0.2447824478149414  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3221435546875 GB
    Memory Allocated: 0.2447824478149414  GigaBytes
Max Memory Allocated: 0.2447824478149414  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.4295654296875 GB
    Memory Allocated: 0.2769441604614258  GigaBytes
Max Memory Allocated: 0.2769441604614258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.4295654296875 GB
    Memory Allocated: 0.2769441604614258  GigaBytes
Max Memory Allocated: 0.2769441604614258  GigaBytes

first layer input nodes number: 653033
first layer output nodes number: 317026
edges number: 3026852
----------------------------------------before model layer 0
 Nvidia-smi: 7.4412841796875 GB
    Memory Allocated: 0.28417205810546875  GigaBytes
Max Memory Allocated: 0.29589080810546875  GigaBytes

torch.Size([653033, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4412841796875 GB
    Memory Allocated: 0.28417205810546875  GigaBytes
Max Memory Allocated: 0.29589080810546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4412841796875 GB
    Memory Allocated: 0.28417205810546875  GigaBytes
Max Memory Allocated: 0.29589080810546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0643310546875 GB
    Memory Allocated: 0.4268922805786133  GigaBytes
Max Memory Allocated: 0.5461750030517578  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0643310546875 GB
    Memory Allocated: 0.4268922805786133  GigaBytes
Max Memory Allocated: 0.5461750030517578  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 0.7296266555786133  GigaBytes
Max Memory Allocated: 0.7296266555786133  GigaBytes

h_neigh size torch.Size([317026, 256])
h_self size  torch.Size([317026, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 0.7296266555786133  GigaBytes
Max Memory Allocated: 0.7296266555786133  GigaBytes

torch.Size([317026, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.0323610305786133  GigaBytes
Max Memory Allocated: 1.3350954055786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 0.7296266555786133  GigaBytes
Max Memory Allocated: 1.3350954055786133  GigaBytes

torch.Size([317026, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.0323610305786133  GigaBytes
Max Memory Allocated: 1.3350954055786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1079459190368652  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------input nodes number: 317026
----------------output nodes number: 48485
----------------edges number: 1170835
----------------------------------------before mean aggregator
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1107053756713867  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1107053756713867  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.166029930114746  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.166029930114746  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1745195388793945  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

h_neigh size torch.Size([48485, 47])
h_self size  torch.Size([48485, 256])
----------------------------------------before rst
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1745195388793945  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

torch.Size([48485, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.183009147644043  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1745195388793945  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

torch.Size([48485, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.183009147644043  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.9725341796875 GB
    Memory Allocated: 1.1914997100830078  GigaBytes
Max Memory Allocated: 1.4106802940368652  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.34004640579223633  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

pseudo mini batch 1 input nodes size: 687062
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.2535533905029297  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.2535533905029297  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.5095043182373047  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.5098714828491211  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.2653694152832031  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.2985496520996094  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.2985496520996094  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

first layer input nodes number: 687062
first layer output nodes number: 333571
edges number: 3255908
----------------------------------------before model layer 0
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.306610107421875  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

torch.Size([687062, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.306610107421875  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.5916748046875 GB
    Memory Allocated: 0.306610107421875  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.5975341796875 GB
    Memory Allocated: 0.45713138580322266  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.5975341796875 GB
    Memory Allocated: 0.45713138580322266  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.9158935546875 GB
    Memory Allocated: 0.7754907608032227  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

h_neigh size torch.Size([333571, 256])
h_self size  torch.Size([333571, 100])
----------------------------------------before rst
 Nvidia-smi: 9.9158935546875 GB
    Memory Allocated: 0.7754907608032227  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

torch.Size([333571, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 1.0938501358032227  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 0.7754907608032227  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

torch.Size([333571, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 1.0938501358032227  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 1.173379898071289  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------input nodes number: 333571
----------------output nodes number: 49243
----------------edges number: 1197396
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 1.1771173477172852  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5526123046875 GB
    Memory Allocated: 1.1771173477172852  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.233367919921875  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.233367919921875  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.241990089416504  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

h_neigh size torch.Size([49243, 47])
h_self size  torch.Size([49243, 256])
----------------------------------------before rst
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.241990089416504  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

torch.Size([49243, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.2506122589111328  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.241990089416504  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

torch.Size([49243, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.2421226501464844  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5545654296875 GB
    Memory Allocated: 1.2507452964782715  GigaBytes
Max Memory Allocated: 1.7444796562194824  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8885498046875 GB
    Memory Allocated: 0.3560061454772949  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

pseudo mini batch 2 input nodes size: 883976
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8885498046875 GB
    Memory Allocated: 0.2655019760131836  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8885498046875 GB
    Memory Allocated: 0.2655019760131836  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.5955801010131836  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.5959396362304688  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.33962154388427734  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.37490177154541016  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.37490177154541016  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

first layer input nodes number: 883976
first layer output nodes number: 368364
edges number: 3596309
----------------------------------------before model layer 0
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.384584903717041  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

torch.Size([883976, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.384584903717041  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.2186279296875 GB
    Memory Allocated: 0.384584903717041  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.2322998046875 GB
    Memory Allocated: 0.5504980087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.2322998046875 GB
    Memory Allocated: 0.5504980087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.5838623046875 GB
    Memory Allocated: 0.9020605087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

h_neigh size torch.Size([368364, 256])
h_self size  torch.Size([368364, 100])
----------------------------------------before rst
 Nvidia-smi: 11.5838623046875 GB
    Memory Allocated: 0.9020605087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

torch.Size([368364, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.2536230087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 0.9020605087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

torch.Size([368364, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.2536230087280273  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.3414478302001953  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------input nodes number: 368364
----------------output nodes number: 48224
----------------edges number: 1138750
----------------------------------------before mean aggregator
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.3445520401000977  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.3445520401000977  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.3993864059448242  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.3993864059448242  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.4078302383422852  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

h_neigh size torch.Size([48224, 47])
h_self size  torch.Size([48224, 256])
----------------------------------------before rst
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.4078302383422852  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

torch.Size([48224, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.416274070739746  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.4078302383422852  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

torch.Size([48224, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.4076519012451172  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2869873046875 GB
    Memory Allocated: 1.4162745475769043  GigaBytes
Max Memory Allocated: 1.8332390785217285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.43490171432495117  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

pseudo mini batch 3 input nodes size: 741066
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.3394432067871094  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.3394432067871094  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.6155118942260742  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.6158890724182129  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.28545141220092773  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.3236966133117676  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.3236966133117676  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

first layer input nodes number: 741066
first layer output nodes number: 381675
edges number: 3766453
----------------------------------------before model layer 0
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.33249330520629883  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

torch.Size([741066, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.33249330520629883  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6717529296875 GB
    Memory Allocated: 0.33249330520629883  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6756591796875 GB
    Memory Allocated: 0.5041632652282715  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6756591796875 GB
    Memory Allocated: 0.5041632652282715  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.0408935546875 GB
    Memory Allocated: 0.868156909942627  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

h_neigh size torch.Size([381675, 256])
h_self size  torch.Size([381675, 100])
----------------------------------------before rst
 Nvidia-smi: 13.0408935546875 GB
    Memory Allocated: 0.868156909942627  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

torch.Size([381675, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.2321505546569824  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.868156909942627  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

torch.Size([381675, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.2321505546569824  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3231492042541504  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------input nodes number: 381675
----------------output nodes number: 50619
----------------edges number: 1256898
----------------------------------------before mean aggregator
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3268280029296875  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3268280029296875  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3848447799682617  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3848447799682617  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3937077522277832  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

h_neigh size torch.Size([50619, 47])
h_self size  torch.Size([50619, 256])
----------------------------------------before rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3937077522277832  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

torch.Size([50619, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.4025707244873047  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3937077522277832  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

torch.Size([50619, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.3941268920898438  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.4029903411865234  GigaBytes
Max Memory Allocated: 2.0662035942077637  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3865504264831543  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.38711118698120117  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.38711118698120117  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11923551559448242 |0.09618115425109863 |0.2125651240348816 |0.00018644332885742188 |0.01139378547668457 |0.0027484893798828125 |
----------------------------------------------------------pseudo_mini_loss sum 6.244782447814941
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4365773
Number of first layer input nodes during this epoch:  2965137
Number of first layer output nodes during this epoch:  1400636
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.38711071014404297  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.28620386123657227
global_2_local spend time (sec) 0.37642717361450195

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.462 seconds
Metis partitioning: 12.287 seconds
Split the graph: 3.227 seconds
Construct subgraphs: 0.053 seconds
49794
49101
47750
49926
REG metis partition end ----................................
the time spent:  28.4350528717041
total k batches seeds list generation spend  29.068342208862305
after graph partition
graph partition algorithm spend time 29.78213906288147

partition_len_list
[338862, 324942, 377698, 383386]
REG selection method  spend 30.336708545684814
check_connections_block*********************************
time for parepare 1: 0.22553491592407227
local_output_nid generation: 0.00934147834777832
local_in_edges_tensor generation: 0.020886898040771484
mini_batch_src_global generation: 0.03987622261047363

&&&&&&&&&&&&&&& before remove duplicate length: 1211648
r_  generation: 0.4587371349334717

local_output_nid generation: 0.009705543518066406
local_in_edges_tensor generation: 0.02598428726196289
mini_batch_src_global generation: 0.0465087890625

&&&&&&&&&&&&&&& before remove duplicate length: 1186463
r_  generation: 0.4801321029663086

local_output_nid generation: 0.00941610336303711
local_in_edges_tensor generation: 0.01810932159423828
mini_batch_src_global generation: 0.03862714767456055

&&&&&&&&&&&&&&& before remove duplicate length: 1125057
r_  generation: 0.5015256404876709

local_output_nid generation: 0.009760856628417969
local_in_edges_tensor generation: 0.015900135040283203
mini_batch_src_global generation: 0.04853105545043945

&&&&&&&&&&&&&&& before remove duplicate length: 1240711
r_  generation: 0.6089959144592285


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.812192440032959
gen group dst list time:  0.04175400733947754
check_connections_block*********************************
time for parepare 1: 0.36985158920288086
local_output_nid generation: 0.06421732902526855
local_in_edges_tensor generation: 0.1488182544708252
mini_batch_src_global generation: 0.0967860221862793

&&&&&&&&&&&&&&& before remove duplicate length: 3309416
r_  generation: 1.4795658588409424

local_output_nid generation: 0.07303094863891602
local_in_edges_tensor generation: 0.11526012420654297
mini_batch_src_global generation: 0.11301732063293457

&&&&&&&&&&&&&&& before remove duplicate length: 3106270
r_  generation: 1.495772123336792

local_output_nid generation: 0.11856222152709961
local_in_edges_tensor generation: 0.1182410717010498
mini_batch_src_global generation: 0.1290271282196045

&&&&&&&&&&&&&&& before remove duplicate length: 3689274
r_  generation: 1.8337242603302002

local_output_nid generation: 0.08859610557556152
local_in_edges_tensor generation: 0.11641311645507812
mini_batch_src_global generation: 0.14194178581237793

&&&&&&&&&&&&&&& before remove duplicate length: 3785130
r_  generation: 1.9662590026855469


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.38711071014404297  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

connection checking time:  12.698283433914185
block generation total time  11.3249671459198
average batch blocks generation time:  2.83124178647995
pseudo mini batch 0 input nodes size: 693155
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.28643035888671875  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.28643035888671875  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5446510314941406  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5450224876403809  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.26857662200927734  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3022613525390625  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3022613525390625  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

first layer input nodes number: 693155
first layer output nodes number: 338862
edges number: 3309416
----------------------------------------before model layer 0
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.31011486053466797  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([693155, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.31011486053466797  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.31011486053466797  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.46243858337402344  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.46243858337402344  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7856025695800781  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([338862, 256])
h_self size  torch.Size([338862, 100])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7856025695800781  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([338862, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1087665557861328  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7856025695800781  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([338862, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1087665557861328  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1895575523376465  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------input nodes number: 338862
----------------output nodes number: 49794
----------------edges number: 1211648
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1927847862243652  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1927847862243652  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.249671459197998  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.249671459197998  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.258389949798584  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([49794, 47])
h_self size  torch.Size([49794, 256])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.258389949798584  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([49794, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.26710844039917  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.258389949798584  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([49794, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2582454681396484  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2671093940734863  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.35960865020751953  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

pseudo mini batch 1 input nodes size: 665629
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.2684330940246582  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.2684330940246582  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5163993835449219  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5167655944824219  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.25817346572875977  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.2904515266418457  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.2904515266418457  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

first layer input nodes number: 665629
first layer output nodes number: 324942
edges number: 3106270
----------------------------------------before model layer 0
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.29828929901123047  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([665629, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.29828929901123047  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.29828929901123047  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.4436941146850586  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.4436941146850586  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7535829544067383  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([324942, 256])
h_self size  torch.Size([324942, 100])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7535829544067383  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([324942, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.063471794128418  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.7535829544067383  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([324942, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.063471794128418  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.140944004058838  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------input nodes number: 324942
----------------output nodes number: 49101
----------------edges number: 1186463
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1437315940856934  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1437315940856934  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1997647285461426  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.1997647285461426  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.208362102508545  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([49101, 47])
h_self size  torch.Size([49101, 256])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.208362102508545  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([49101, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2169594764709473  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.208362102508545  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([49101, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2082409858703613  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2169599533081055  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3447542190551758  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

pseudo mini batch 2 input nodes size: 932229
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.25805234909057617  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.25805234909057617  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.6053347587585449  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.6056909561157227  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.357358455657959  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.39331769943237305  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.39331769943237305  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

first layer input nodes number: 932229
first layer output nodes number: 377698
edges number: 3689274
----------------------------------------before model layer 0
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.4030780792236328  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([932229, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.4030780792236328  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.4030780792236328  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5728654861450195  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.5728654861450195  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.9330663681030273  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([377698, 256])
h_self size  torch.Size([377698, 100])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.9330663681030273  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([377698, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2932672500610352  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.9330663681030273  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([377698, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.2932672500610352  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.383317470550537  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------input nodes number: 377698
----------------output nodes number: 47750
----------------edges number: 1125057
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.3864879608154297  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.3864879608154297  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4416074752807617  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4416074752807617  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4499683380126953  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

h_neigh size torch.Size([47750, 47])
h_self size  torch.Size([47750, 256])
----------------------------------------before rst
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4499683380126953  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([47750, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.458329200744629  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4499683380126953  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

torch.Size([47750, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.4497318267822266  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 1.458329677581787  GigaBytes
Max Memory Allocated: 2.075709342956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.45505475997924805  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

pseudo mini batch 3 input nodes size: 754104
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.35712194442749023  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.35712194442749023  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.6380476951599121  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.6384201049804688  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.29078149795532227  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.32903623580932617  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.32903623580932617  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

first layer input nodes number: 754104
first layer output nodes number: 383386
edges number: 3785130
----------------------------------------before model layer 0
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3377399444580078  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([754104, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3377399444580078  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 0.3377399444580078  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.1522216796875 GB
    Memory Allocated: 0.5101933479309082  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.1522216796875 GB
    Memory Allocated: 0.5101933479309082  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.5194091796875 GB
    Memory Allocated: 0.8758187294006348  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([383386, 256])
h_self size  torch.Size([383386, 100])
----------------------------------------before rst
 Nvidia-smi: 14.5194091796875 GB
    Memory Allocated: 0.8758187294006348  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([383386, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.2414441108703613  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 0.8758187294006348  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([383386, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.2414441108703613  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.332850456237793  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------input nodes number: 383386
----------------output nodes number: 49926
----------------edges number: 1240711
----------------------------------------before mean aggregator
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.3360795974731445  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.3360795974731445  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.393402099609375  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.393402099609375  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.402143955230713  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([49926, 47])
h_self size  torch.Size([49926, 256])
----------------------------------------before rst
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.402143955230713  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([49926, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.4108858108520508  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.402143955230713  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([49926, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.4025249481201172  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2537841796875 GB
    Memory Allocated: 1.4112672805786133  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3913106918334961  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3913106918334961  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3913106918334961  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12477618455886841 |0.02945411205291748 |0.024900496006011963 |0.00014859437942504883 |0.0049498677253723145 |0.002301454544067383 |
----------------------------------------------------------pseudo_mini_loss sum 3.43021559715271
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  4470005
Number of first layer input nodes during this epoch:  3045117
Number of first layer output nodes during this epoch:  1424888
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3913102149963379  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.29058837890625
global_2_local spend time (sec) 0.41439270973205566

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.033 seconds
Metis partitioning: 12.371 seconds
Split the graph: 3.067 seconds
Construct subgraphs: 0.075 seconds
48567
49622
47766
50616
REG metis partition end ----................................
the time spent:  27.821133613586426
total k batches seeds list generation spend  28.465505123138428
after graph partition
graph partition algorithm spend time 29.20035672187805

partition_len_list
[322116, 337368, 384624, 388526]
REG selection method  spend 29.80970048904419
check_connections_block*********************************
time for parepare 1: 0.2296762466430664
local_output_nid generation: 0.008906841278076172
local_in_edges_tensor generation: 0.03765296936035156
mini_batch_src_global generation: 0.03788328170776367

&&&&&&&&&&&&&&& before remove duplicate length: 1174967
r_  generation: 0.46785879135131836

local_output_nid generation: 0.010419130325317383
local_in_edges_tensor generation: 0.021872758865356445
mini_batch_src_global generation: 0.05406546592712402

&&&&&&&&&&&&&&& before remove duplicate length: 1206151
r_  generation: 0.5057780742645264

local_output_nid generation: 0.01015329360961914
local_in_edges_tensor generation: 0.011634349822998047
mini_batch_src_global generation: 0.040069580078125

&&&&&&&&&&&&&&& before remove duplicate length: 1125112
r_  generation: 0.5295875072479248

local_output_nid generation: 0.010820388793945312
local_in_edges_tensor generation: 0.012804746627807617
mini_batch_src_global generation: 0.04812479019165039

&&&&&&&&&&&&&&& before remove duplicate length: 1257649
r_  generation: 0.6386137008666992


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.856304407119751
gen group dst list time:  0.044527292251586914
check_connections_block*********************************
time for parepare 1: 0.3791372776031494
local_output_nid generation: 0.06549835205078125
local_in_edges_tensor generation: 0.16548919677734375
mini_batch_src_global generation: 0.1014399528503418

&&&&&&&&&&&&&&& before remove duplicate length: 3080144
r_  generation: 1.4516017436981201

local_output_nid generation: 0.10377383232116699
local_in_edges_tensor generation: 0.15284109115600586
mini_batch_src_global generation: 0.12920451164245605

&&&&&&&&&&&&&&& before remove duplicate length: 3290613
r_  generation: 1.5654211044311523

local_output_nid generation: 0.09918594360351562
local_in_edges_tensor generation: 0.11523795127868652
mini_batch_src_global generation: 0.13825488090515137

&&&&&&&&&&&&&&& before remove duplicate length: 3758744
r_  generation: 1.948460578918457

local_output_nid generation: 0.09481143951416016
local_in_edges_tensor generation: 0.10688376426696777
mini_batch_src_global generation: 0.1611936092376709

&&&&&&&&&&&&&&& before remove duplicate length: 3836230
r_  generation: 2.0780508518218994


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3913102149963379  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

connection checking time:  13.252903938293457
block generation total time  11.738123178482056
average batch blocks generation time:  2.934530794620514
block dataloader generation time/epoch 56.83079814910889
pseudo mini batch 0 input nodes size: 666904
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29116153717041016  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29116153717041016  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5396027565002441  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5399646759033203  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.2586665153503418  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29085874557495117  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29085874557495117  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

first layer input nodes number: 666904
first layer output nodes number: 322116
edges number: 3080144
----------------------------------------before model layer 0
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29879188537597656  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([666904, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29879188537597656  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.29879188537597656  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.44293928146362305  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.44293928146362305  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7501330375671387  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([322116, 256])
h_self size  torch.Size([322116, 100])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7501330375671387  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([322116, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.0573267936706543  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7501330375671387  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([322116, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.0573267936706543  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1341252326965332  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------input nodes number: 322116
----------------output nodes number: 48567
----------------edges number: 1174967
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.136887550354004  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.136887550354004  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.19232177734375  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.19232177734375  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2008256912231445  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([48567, 47])
h_self size  torch.Size([48567, 256])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2008256912231445  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([48567, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.209329605102539  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2008256912231445  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([48567, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2005877494812012  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2093305587768555  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.34490156173706055  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

pseudo mini batch 1 input nodes size: 689144
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.25842952728271484  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.25842952728271484  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5151557922363281  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5155258178710938  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.2667226791381836  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.30022716522216797  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.30022716522216797  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

first layer input nodes number: 689144
first layer output nodes number: 337368
edges number: 3290613
----------------------------------------before model layer 0
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.30802345275878906  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([689144, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.30802345275878906  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.30802345275878906  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.45977067947387695  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.45977067947387695  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7815098762512207  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([337368, 256])
h_self size  torch.Size([337368, 100])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7815098762512207  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([337368, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1032490730285645  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.7815098762512207  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([337368, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1032490730285645  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1836838722229004  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------input nodes number: 337368
----------------output nodes number: 49622
----------------edges number: 1206151
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1868329048156738  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.1868329048156738  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.243513584136963  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.243513584136963  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.252202033996582  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([49622, 47])
h_self size  torch.Size([49622, 256])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.252202033996582  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([49622, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2608904838562012  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.252202033996582  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([49622, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.2523865699768066  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.261075496673584  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3577761650085449  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

pseudo mini batch 2 input nodes size: 959553
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.2669072151184082  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.2669072151184082  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.6243686676025391  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.6247248649597168  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3676285743713379  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.40401697158813477  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.40401697158813477  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

first layer input nodes number: 959553
first layer output nodes number: 384624
edges number: 3758744
----------------------------------------before model layer 0
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.4141969680786133  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([959553, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.4141969680786133  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.4141969680786133  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5877714157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.5877714157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.9549589157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([384624, 256])
h_self size  torch.Size([384624, 100])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.9549589157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([384624, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.3221464157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.9549589157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([384624, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.3221464157104492  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4138479232788086  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------input nodes number: 384624
----------------output nodes number: 47766
----------------edges number: 1125112
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.41778564453125  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.41778564453125  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4720783233642578  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4720783233642578  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4804420471191406  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

h_neigh size torch.Size([47766, 47])
h_self size  torch.Size([47766, 256])
----------------------------------------before rst
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4804420471191406  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([47766, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4888057708740234  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4804420471191406  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

torch.Size([47766, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4801173210144043  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 1.4888062477111816  GigaBytes
Max Memory Allocated: 2.126612663269043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.4667830467224121  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

pseudo mini batch 3 input nodes size: 748942
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.36730384826660156  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.36730384826660156  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.6463065147399902  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.6466836929321289  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.2888660430908203  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3273739814758301  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.3273739814758301  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 748942
first layer output nodes number: 388526
edges number: 3836230
----------------------------------------before model layer 0
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.33630943298339844  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([748942, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.33630943298339844  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 15.6229248046875 GB
    Memory Allocated: 0.33630943298339844  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 15.6248779296875 GB
    Memory Allocated: 0.5110769271850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 15.6248779296875 GB
    Memory Allocated: 0.5110769271850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 15.9959716796875 GB
    Memory Allocated: 0.8821706771850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([388526, 256])
h_self size  torch.Size([388526, 100])
----------------------------------------before rst
 Nvidia-smi: 15.9959716796875 GB
    Memory Allocated: 0.8821706771850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([388526, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.2532644271850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 0.8821706771850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([388526, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.2532644271850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.3458962440490723  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 388526
----------------output nodes number: 50616
----------------edges number: 1257649
----------------------------------------before mean aggregator
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.3492865562438965  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.3492865562438965  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.40730619430542  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.40730619430542  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.416452407836914  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([50616, 47])
h_self size  torch.Size([50616, 256])
----------------------------------------before rst
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.416452407836914  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50616, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.4253149032592773  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.4161686897277832  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50616, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.4169511795043945  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.7381591796875 GB
    Memory Allocated: 1.4263920783996582  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.3908958435058594  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.3908958435058594  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.3908958435058594  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1327897310256958 |0.02755260467529297 |0.02530348300933838 |0.00014573335647583008 |0.006861388683319092 |0.002273082733154297 |
----------------------------------------------------------pseudo_mini_loss sum 2.043828010559082
Total (block generation + training)time/epoch 57.62603235244751
Training time/epoch 0.7949349880218506
Training time without block to device /epoch 0.6847245693206787
Training time without total dataloading part /epoch 0.1315155029296875
load block tensor time/epoch 0.5311589241027832
block to device time/epoch 0.11021041870117188
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  4497177
Number of first layer input nodes during this epoch:  3064543
Number of first layer output nodes during this epoch:  1432634
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.39089536666870117  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.27010607719421387
global_2_local spend time (sec) 0.43662166595458984

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.052 seconds
Metis partitioning: 12.218 seconds
Split the graph: 3.117 seconds
Construct subgraphs: 0.068 seconds
47850
50603
50272
47846
REG metis partition end ----................................
the time spent:  27.34939169883728
total k batches seeds list generation spend  28.020975351333618
after graph partition
graph partition algorithm spend time 28.799910306930542

partition_len_list
[379779, 390744, 341890, 315684]
REG selection method  spend 29.437095165252686
check_connections_block*********************************
time for parepare 1: 0.2159881591796875
local_output_nid generation: 0.009075164794921875
local_in_edges_tensor generation: 0.013105392456054688
mini_batch_src_global generation: 0.03673434257507324

&&&&&&&&&&&&&&& before remove duplicate length: 1128434
r_  generation: 0.453690767288208

local_output_nid generation: 0.011034727096557617
local_in_edges_tensor generation: 0.025262117385864258
mini_batch_src_global generation: 0.05675482749938965

&&&&&&&&&&&&&&& before remove duplicate length: 1256888
r_  generation: 0.5827445983886719

local_output_nid generation: 0.010633468627929688
local_in_edges_tensor generation: 0.014946699142456055
mini_batch_src_global generation: 0.04349565505981445

&&&&&&&&&&&&&&& before remove duplicate length: 1222800
r_  generation: 0.5467133522033691

local_output_nid generation: 0.010445833206176758
local_in_edges_tensor generation: 0.0333402156829834
mini_batch_src_global generation: 0.04607701301574707

&&&&&&&&&&&&&&& before remove duplicate length: 1155757
r_  generation: 0.5409517288208008


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8055496215820312
gen group dst list time:  0.044716596603393555
check_connections_block*********************************
time for parepare 1: 0.36116957664489746
local_output_nid generation: 0.08454656600952148
local_in_edges_tensor generation: 0.17946243286132812
mini_batch_src_global generation: 0.12352776527404785

&&&&&&&&&&&&&&& before remove duplicate length: 3712770
r_  generation: 1.797182559967041

local_output_nid generation: 0.09653520584106445
local_in_edges_tensor generation: 0.11677670478820801
mini_batch_src_global generation: 0.15878629684448242

&&&&&&&&&&&&&&& before remove duplicate length: 3859044
r_  generation: 1.996922492980957

local_output_nid generation: 0.07945108413696289
local_in_edges_tensor generation: 0.06679368019104004
mini_batch_src_global generation: 0.12769365310668945

&&&&&&&&&&&&&&& before remove duplicate length: 3334816
r_  generation: 1.6512227058410645

local_output_nid generation: 0.07493710517883301
local_in_edges_tensor generation: 0.06175565719604492
mini_batch_src_global generation: 0.12108659744262695

&&&&&&&&&&&&&&& before remove duplicate length: 3014376
r_  generation: 1.53977370262146


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.39089536666870117  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

connection checking time:  13.005244493484497
block generation total time  11.880050897598267
average batch blocks generation time:  2.9700127243995667
block dataloader generation time/epoch 56.5350387096405
pseudo mini batch 0 input nodes size: 927156
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.28964757919311523  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.28964757919311523  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.635040283203125  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.6353969573974609  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.3560171127319336  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.392547607421875  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.392547607421875  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 927156
first layer output nodes number: 379779
edges number: 3712770
----------------------------------------before model layer 0
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.4022855758666992  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([927156, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.4022855758666992  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.4022855758666992  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.5729236602783203  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.5729236602783203  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.9351091384887695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([379779, 256])
h_self size  torch.Size([379779, 100])
----------------------------------------before rst
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.9351091384887695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([379779, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.2972946166992188  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.9351091384887695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([379779, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.2972946166992188  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.3878412246704102  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 379779
----------------output nodes number: 47850
----------------edges number: 1128434
----------------------------------------before mean aggregator
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.3912467956542969  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.3912467956542969  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4456443786621094  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4456443786621094  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4540224075317383  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([47850, 47])
h_self size  torch.Size([47850, 256])
----------------------------------------before rst
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4540224075317383  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47850, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4624004364013672  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4540224075317383  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47850, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.453254222869873  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 1.4624013900756836  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.4527139663696289  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

pseudo mini batch 1 input nodes size: 757525
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.35524988174438477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.35524988174438477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.6374502182006836  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.6378273963928223  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.29207801818847656  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.33066797256469727  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.33066797256469727  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 757525
first layer output nodes number: 390744
edges number: 3859044
----------------------------------------before model layer 0
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.33965301513671875  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([757525, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.33965301513671875  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.33965301513671875  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.515444278717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 17.1131591796875 GB
    Memory Allocated: 0.515444278717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 17.4862060546875 GB
    Memory Allocated: 0.888491153717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([390744, 256])
h_self size  torch.Size([390744, 100])
----------------------------------------before rst
 Nvidia-smi: 17.4862060546875 GB
    Memory Allocated: 0.888491153717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([390744, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.261538028717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 0.888491153717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([390744, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.261538028717041  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.354698657989502  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 390744
----------------output nodes number: 50603
----------------edges number: 1256888
----------------------------------------before mean aggregator
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.357987403869629  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.357987403869629  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4159889221191406  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4159889221191406  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4250502586364746  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([50603, 47])
h_self size  torch.Size([50603, 256])
----------------------------------------before rst
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4250502586364746  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50603, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4339103698730469  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.424849033355713  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50603, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.425532341003418  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.2322998046875 GB
    Memory Allocated: 1.4343929290771484  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3951253890991211  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

pseudo mini batch 2 input nodes size: 707773
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.29276132583618164  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.29276132583618164  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5564274787902832  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5568022727966309  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.27422475814819336  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3081831932067871  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3081831932067871  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 707773
first layer output nodes number: 341890
edges number: 3334816
----------------------------------------before model layer 0
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3160085678100586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([707773, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3160085678100586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3160085678100586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.4701094627380371  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.4701094627380371  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7961611747741699  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([341890, 256])
h_self size  torch.Size([341890, 100])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7961611747741699  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([341890, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1222128868103027  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7961611747741699  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([341890, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1222128868103027  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.203725814819336  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 341890
----------------output nodes number: 50272
----------------edges number: 1222800
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.206648349761963  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.206648349761963  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2640776634216309  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2640776634216309  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2728800773620605  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([50272, 47])
h_self size  torch.Size([50272, 256])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2728800773620605  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50272, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2816824913024902  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2728800773620605  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50272, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2726211547851562  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2814240455627441  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3657217025756836  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

pseudo mini batch 3 input nodes size: 665016
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.27396583557128906  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.27396583557128906  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5217037200927734  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5220603942871094  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.25801944732666016  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2900686264038086  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2900686264038086  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 665016
first layer output nodes number: 315684
edges number: 3014376
----------------------------------------before model layer 0
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2979397773742676  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([665016, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2979397773742676  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2979397773742676  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.43953943252563477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.43953943252563477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7405991554260254  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([315684, 256])
h_self size  torch.Size([315684, 100])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7405991554260254  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([315684, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.041658878326416  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.7405991554260254  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([315684, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.041658878326416  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1169238090515137  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 315684
----------------output nodes number: 47846
----------------edges number: 1155757
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1203875541687012  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1203875541687012  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.174985408782959  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.174985408782959  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1833629608154297  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([47846, 47])
h_self size  torch.Size([47846, 256])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1833629608154297  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47846, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1917405128479004  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1833629608154297  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47846, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1829380989074707  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.1917409896850586  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.34467220306396484  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.34467220306396484  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.34467220306396484  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12399488687515259 |0.028094589710235596 |0.024653732776641846 |0.00014787912368774414 |0.005396008491516113 |0.0013210773468017578 |
----------------------------------------------------------pseudo_mini_loss sum 1.6164036989212036
Total (block generation + training)time/epoch 57.31053626537323
Training time/epoch 0.7554726600646973
Training time without block to device /epoch 0.6430943012237549
Training time without total dataloading part /epoch 0.12211155891418457
load block tensor time/epoch 0.49597954750061035
block to device time/epoch 0.11237835884094238
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  4485567
Number of first layer input nodes during this epoch:  3057470
Number of first layer output nodes during this epoch:  1428097
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.34467172622680664  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2513163089752197
global_2_local spend time (sec) 0.4322388172149658

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.328 seconds
Metis partitioning: 13.439 seconds
Split the graph: 3.064 seconds
Construct subgraphs: 0.079 seconds
50463
47730
50404
47974
REG metis partition end ----................................
the time spent:  29.02312731742859
total k batches seeds list generation spend  29.6691255569458
after graph partition
graph partition algorithm spend time 30.379502296447754

partition_len_list
[376860, 398001, 340864, 317196]
REG selection method  spend 31.007425785064697
check_connections_block*********************************
time for parepare 1: 0.23691201210021973
local_output_nid generation: 0.011832952499389648
local_in_edges_tensor generation: 0.01298379898071289
mini_batch_src_global generation: 0.04151463508605957

&&&&&&&&&&&&&&& before remove duplicate length: 1240068
r_  generation: 0.5250122547149658

local_output_nid generation: 0.012994766235351562
local_in_edges_tensor generation: 0.011554479598999023
mini_batch_src_global generation: 0.048547983169555664

&&&&&&&&&&&&&&& before remove duplicate length: 1138927
r_  generation: 0.5283401012420654

local_output_nid generation: 0.010724782943725586
local_in_edges_tensor generation: 0.013143062591552734
mini_batch_src_global generation: 0.046355485916137695

&&&&&&&&&&&&&&& before remove duplicate length: 1224839
r_  generation: 0.5587806701660156

local_output_nid generation: 0.010472297668457031
local_in_edges_tensor generation: 0.020023822784423828
mini_batch_src_global generation: 0.05623745918273926

&&&&&&&&&&&&&&& before remove duplicate length: 1160045
r_  generation: 0.5812399387359619


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8254051208496094
gen group dst list time:  0.045279741287231445
check_connections_block*********************************
time for parepare 1: 0.3766810894012451
local_output_nid generation: 0.07724452018737793
local_in_edges_tensor generation: 0.19251322746276855
mini_batch_src_global generation: 0.11502432823181152

&&&&&&&&&&&&&&& before remove duplicate length: 3697324
r_  generation: 1.7836847305297852

local_output_nid generation: 0.0995645523071289
local_in_edges_tensor generation: 0.14556646347045898
mini_batch_src_global generation: 0.17727136611938477

&&&&&&&&&&&&&&& before remove duplicate length: 3915847
r_  generation: 1.9793734550476074

local_output_nid generation: 0.0794379711151123
local_in_edges_tensor generation: 0.10656094551086426
mini_batch_src_global generation: 0.12825894355773926

&&&&&&&&&&&&&&& before remove duplicate length: 3327640
r_  generation: 1.6760408878326416

local_output_nid generation: 0.07455277442932129
local_in_edges_tensor generation: 0.06489944458007812
mini_batch_src_global generation: 0.11637139320373535

&&&&&&&&&&&&&&& before remove duplicate length: 3027108
r_  generation: 1.512331485748291


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.34467172622680664  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

connection checking time:  13.081751823425293
block generation total time  11.315186738967896
average batch blocks generation time:  2.828796684741974
block dataloader generation time/epoch 56.78262575467428
pseudo mini batch 0 input nodes size: 751438
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.25759363174438477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.25759363174438477  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5375261306762695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5379023551940918  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.2898077964782715  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3265957832336426  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3265957832336426  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 751438
first layer output nodes number: 376860
edges number: 3697324
----------------------------------------before model layer 0
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3350028991699219  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([751438, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3350028991699219  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.3350028991699219  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5044417381286621  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.5044417381286621  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.8638434410095215  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([376860, 256])
h_self size  torch.Size([376860, 100])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.8638434410095215  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([376860, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2232451438903809  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.8638434410095215  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([376860, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.2232451438903809  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3130955696105957  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 376860
----------------output nodes number: 50463
----------------edges number: 1240068
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3162798881530762  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3162798881530762  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3740220069885254  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3740220069885254  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3830499649047852  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([50463, 47])
h_self size  torch.Size([50463, 256])
----------------------------------------before rst
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3830499649047852  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50463, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.391885757446289  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3828577995300293  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([50463, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3835082054138184  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 1.3931727409362793  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.38795900344848633  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

pseudo mini batch 1 input nodes size: 945809
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.29045915603637695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.29045915603637695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.6428008079528809  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.6431565284729004  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.36284780502319336  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.40120983123779297  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.40120983123779297  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

first layer input nodes number: 945809
first layer output nodes number: 398001
edges number: 3915847
----------------------------------------before model layer 0
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.4112224578857422  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([945809, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.4112224578857422  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.6072998046875 GB
    Memory Allocated: 0.4112224578857422  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.6092529296875 GB
    Memory Allocated: 0.5903067588806152  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.6092529296875 GB
    Memory Allocated: 0.5903067588806152  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.9901123046875 GB
    Memory Allocated: 0.9698700904846191  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([398001, 256])
h_self size  torch.Size([398001, 100])
----------------------------------------before rst
 Nvidia-smi: 18.9901123046875 GB
    Memory Allocated: 0.9698700904846191  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([398001, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.349433422088623  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 0.9698700904846191  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([398001, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.349433422088623  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.4443244934082031  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------input nodes number: 398001
----------------output nodes number: 47730
----------------edges number: 1138927
----------------------------------------before mean aggregator
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.447645664215088  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.447645664215088  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5023698806762695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5023698806762695  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5107269287109375  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

h_neigh size torch.Size([47730, 47])
h_self size  torch.Size([47730, 256])
----------------------------------------before rst
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5107269287109375  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47730, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5190839767456055  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5107269287109375  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

torch.Size([47730, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5100560188293457  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.7518310546875 GB
    Memory Allocated: 1.5184135437011719  GigaBytes
Max Memory Allocated: 2.1705188751220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.46407318115234375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

pseudo mini batch 2 input nodes size: 701122
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.36217689514160156  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.36217689514160156  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.6233654022216797  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.6237411499023438  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.2710437774658203  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.3049640655517578  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.3049640655517578  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

first layer input nodes number: 701122
first layer output nodes number: 340864
edges number: 3327640
----------------------------------------before model layer 0
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.3127593994140625  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([701122, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.3127593994140625  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.3127593994140625  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.4658050537109375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.4658050537109375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7908782958984375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

h_neigh size torch.Size([340864, 256])
h_self size  torch.Size([340864, 100])
----------------------------------------before rst
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7908782958984375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([340864, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1159515380859375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7908782958984375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([340864, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1159515380859375  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1972198486328125  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------input nodes number: 340864
----------------output nodes number: 50404
----------------edges number: 1224839
----------------------------------------before mean aggregator
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2001352310180664  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2001352310180664  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.257706642150879  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.257706642150879  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2665319442749023  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

h_neigh size torch.Size([50404, 47])
h_self size  torch.Size([50404, 256])
----------------------------------------before rst
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2665319442749023  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([50404, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2753572463989258  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2665319442749023  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([50404, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2670001983642578  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.2758259773254395  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.36318111419677734  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

pseudo mini batch 3 input nodes size: 661431
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.2715120315551758  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.2715120315551758  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.5179142951965332  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.5182719230651855  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.25670766830444336  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.2887883186340332  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.2887883186340332  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

first layer input nodes number: 661431
first layer output nodes number: 317196
edges number: 3027108
----------------------------------------before model layer 0
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.29660987854003906  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([661431, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.29660987854003906  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.29660987854003906  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.4394869804382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.4394869804382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7422213554382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

h_neigh size torch.Size([317196, 256])
h_self size  torch.Size([317196, 100])
----------------------------------------before rst
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7422213554382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([317196, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.0449557304382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.7422213554382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([317196, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.0449557304382324  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1205811500549316  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------input nodes number: 317196
----------------output nodes number: 47974
----------------edges number: 1160045
----------------------------------------before mean aggregator
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1233024597167969  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1233024597167969  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1781601905822754  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1781601905822754  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1865601539611816  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

h_neigh size torch.Size([47974, 47])
h_self size  torch.Size([47974, 256])
----------------------------------------before rst
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1865601539611816  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([47974, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.194960117340088  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1865601539611816  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

torch.Size([47974, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.1861348152160645  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 1.194960594177246  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.34210634231567383  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.34210634231567383  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.1405029296875 GB
    Memory Allocated: 0.34210634231567383  GigaBytes
Max Memory Allocated: 2.225485324859619  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13319212198257446 |0.031027674674987793 |0.024474740028381348 |0.00016301870346069336 |0.00523906946182251 |0.001062631607055664 |
----------------------------------------------------------pseudo_mini_loss sum 1.4549413919448853
Total (block generation + training)time/epoch 57.56801621119181
Training time/epoch 0.8048641681671143
Training time without block to device /epoch 0.6807534694671631
Training time without total dataloading part /epoch 0.12056994438171387
load block tensor time/epoch 0.5327684879302979
block to device time/epoch 0.12411069869995117
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  4492721
Number of first layer input nodes during this epoch:  3059800
Number of first layer output nodes during this epoch:  1432921
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
