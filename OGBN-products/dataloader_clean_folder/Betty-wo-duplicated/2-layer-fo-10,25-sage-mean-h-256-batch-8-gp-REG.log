main start at this time 1660334657.0573761
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.21985864639282227
global_2_local spend time (sec) 0.3640139102935791

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.900 seconds
Metis partitioning: 11.461 seconds
Split the graph: 1.590 seconds
Construct subgraphs: 0.244 seconds
24397
25231
25304
24351
23957
24001
25239
24091
REG metis partition end ----................................
the time spent:  25.013285875320435
total k batches seeds list generation spend  25.5028178691864
after graph partition
graph partition algorithm spend time 26.102900505065918

partition_len_list
[193142, 175535, 199752, 179927, 210660, 206459, 216385, 191087]
REG selection method  spend 26.63031506538391
check_connections_block*********************************
time for parepare 1: 0.22226524353027344
local_output_nid generation: 0.005678415298461914
local_in_edges_tensor generation: 0.0070683956146240234
mini_batch_src_global generation: 0.0205991268157959

&&&&&&&&&&&&&&& before remove duplicate length: 591771
r_  generation: 0.21905159950256348

local_output_nid generation: 0.007058143615722656
local_in_edges_tensor generation: 0.012120246887207031
mini_batch_src_global generation: 0.0282289981842041

&&&&&&&&&&&&&&& before remove duplicate length: 609097
r_  generation: 0.23141026496887207

local_output_nid generation: 0.007127285003662109
local_in_edges_tensor generation: 0.00884866714477539
mini_batch_src_global generation: 0.02520585060119629

&&&&&&&&&&&&&&& before remove duplicate length: 626329
r_  generation: 0.2644963264465332

local_output_nid generation: 0.006869077682495117
local_in_edges_tensor generation: 0.006913423538208008
mini_batch_src_global generation: 0.027538061141967773

&&&&&&&&&&&&&&& before remove duplicate length: 580772
r_  generation: 0.24644231796264648

local_output_nid generation: 0.006921052932739258
local_in_edges_tensor generation: 0.006620168685913086
mini_batch_src_global generation: 0.021999597549438477

&&&&&&&&&&&&&&& before remove duplicate length: 553161
r_  generation: 0.24157357215881348

local_output_nid generation: 0.006945610046386719
local_in_edges_tensor generation: 0.0067729949951171875
mini_batch_src_global generation: 0.026851892471313477

&&&&&&&&&&&&&&& before remove duplicate length: 578717
r_  generation: 0.27011704444885254

local_output_nid generation: 0.007158994674682617
local_in_edges_tensor generation: 0.007252693176269531
mini_batch_src_global generation: 0.02805352210998535

&&&&&&&&&&&&&&& before remove duplicate length: 628288
r_  generation: 0.2900350093841553

local_output_nid generation: 0.006902217864990234
local_in_edges_tensor generation: 0.008534908294677734
mini_batch_src_global generation: 0.026787757873535156

&&&&&&&&&&&&&&& before remove duplicate length: 595744
r_  generation: 0.2747213840484619


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6420576572418213
gen group dst list time:  0.041625022888183594
check_connections_block*********************************
time for parepare 1: 0.3635978698730469
local_output_nid generation: 0.046715736389160156
local_in_edges_tensor generation: 0.14871454238891602
mini_batch_src_global generation: 0.05382513999938965

&&&&&&&&&&&&&&& before remove duplicate length: 1865939
r_  generation: 0.8035428524017334

local_output_nid generation: 0.04608011245727539
local_in_edges_tensor generation: 0.057404518127441406
mini_batch_src_global generation: 0.06458497047424316

&&&&&&&&&&&&&&& before remove duplicate length: 1674327
r_  generation: 0.73917555809021

local_output_nid generation: 0.05452442169189453
local_in_edges_tensor generation: 0.06250667572021484
mini_batch_src_global generation: 0.06906938552856445

&&&&&&&&&&&&&&& before remove duplicate length: 1970111
r_  generation: 0.9048943519592285

local_output_nid generation: 0.04644465446472168
local_in_edges_tensor generation: 0.039339542388916016
mini_batch_src_global generation: 0.06945538520812988

&&&&&&&&&&&&&&& before remove duplicate length: 1746393
r_  generation: 0.8106899261474609

local_output_nid generation: 0.05794835090637207
local_in_edges_tensor generation: 0.06997275352478027
mini_batch_src_global generation: 0.08260011672973633

&&&&&&&&&&&&&&& before remove duplicate length: 2070341
r_  generation: 1.0116236209869385

local_output_nid generation: 0.0535740852355957
local_in_edges_tensor generation: 0.05666685104370117
mini_batch_src_global generation: 0.08443331718444824

&&&&&&&&&&&&&&& before remove duplicate length: 2012771
r_  generation: 0.9803130626678467

local_output_nid generation: 0.058054208755493164
local_in_edges_tensor generation: 0.06330633163452148
mini_batch_src_global generation: 0.0845956802368164

&&&&&&&&&&&&&&& before remove duplicate length: 2142065
r_  generation: 1.088886022567749

local_output_nid generation: 0.05232048034667969
local_in_edges_tensor generation: 0.054187774658203125
mini_batch_src_global generation: 0.08369326591491699

&&&&&&&&&&&&&&& before remove duplicate length: 1882130
r_  generation: 0.9058284759521484


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  13.570921421051025
block generation total time  12.26115894317627
average batch blocks generation time:  1.5326448678970337
pseudo mini batch 0 input nodes size: 509578
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2694091796875 GB
    Memory Allocated: 0.19011306762695312  GigaBytes
Max Memory Allocated: 0.19011306762695312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2694091796875 GB
    Memory Allocated: 0.19029521942138672  GigaBytes
Max Memory Allocated: 0.19029521942138672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2694091796875 GB
    Memory Allocated: 0.19029521942138672  GigaBytes
Max Memory Allocated: 0.19029521942138672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 0.20860767364501953  GigaBytes
Max Memory Allocated: 0.20860767364501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 0.20860767364501953  GigaBytes
Max Memory Allocated: 0.20860767364501953  GigaBytes

first layer input nodes number: 509578
first layer output nodes number: 193142
edges number: 1865939
----------------------------------------before model layer 0
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.21397829055786133  GigaBytes
Max Memory Allocated: 0.22092962265014648  GigaBytes

torch.Size([509578, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.21397829055786133  GigaBytes
Max Memory Allocated: 0.22092962265014648  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.21397829055786133  GigaBytes
Max Memory Allocated: 0.22092962265014648  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 0.30086612701416016  GigaBytes
Max Memory Allocated: 0.37385129928588867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 0.30086612701416016  GigaBytes
Max Memory Allocated: 0.37385129928588867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.4850606918334961  GigaBytes
Max Memory Allocated: 0.4850606918334961  GigaBytes

h_neigh size torch.Size([193142, 256])
h_self size  torch.Size([193142, 100])
----------------------------------------before rst
 Nvidia-smi: 8.0096435546875 GB
    Memory Allocated: 0.4850606918334961  GigaBytes
Max Memory Allocated: 0.4850606918334961  GigaBytes

torch.Size([193142, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.669255256652832  GigaBytes
Max Memory Allocated: 0.853449821472168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.4850606918334961  GigaBytes
Max Memory Allocated: 0.853449821472168  GigaBytes

torch.Size([193142, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.669255256652832  GigaBytes
Max Memory Allocated: 0.853449821472168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.715303897857666  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------input nodes number: 193142
----------------output nodes number: 24397
----------------edges number: 591771
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7173175811767578  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7173175811767578  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7461133003234863  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7461133003234863  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7503852844238281  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

h_neigh size torch.Size([24397, 47])
h_self size  torch.Size([24397, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7503852844238281  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

torch.Size([24397, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7550697326660156  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7507977485656738  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

torch.Size([24397, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7550697326660156  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3807373046875 GB
    Memory Allocated: 0.7593426704406738  GigaBytes
Max Memory Allocated: 0.899498462677002  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.24573469161987305  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

pseudo mini batch 1 input nodes size: 392845
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.19484853744506836  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.19484853744506836  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.34119510650634766  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.3413834571838379  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.1513686180114746  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.1689591407775879  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.1689591407775879  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

first layer input nodes number: 392845
first layer output nodes number: 175535
edges number: 1674327
----------------------------------------before model layer 0
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.17319440841674805  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([392845, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.17319440841674805  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7596435546875 GB
    Memory Allocated: 0.17319440841674805  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.2523517608642578  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.2523517608642578  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.4197549819946289  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

h_neigh size torch.Size([175535, 256])
h_self size  torch.Size([175535, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.4197549819946289  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([175535, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.587158203125  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.4197549819946289  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([175535, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.587158203125  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6290092468261719  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------input nodes number: 175535
----------------output nodes number: 25231
----------------edges number: 609097
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6305055618286133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6305055618286133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6592950820922852  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6592950820922852  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6637129783630371  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

h_neigh size torch.Size([25231, 47])
h_self size  torch.Size([25231, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6637129783630371  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([25231, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6681308746337891  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6637129783630371  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([25231, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6638588905334473  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.6682772636413574  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.1985483169555664  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

pseudo mini batch 2 input nodes size: 486282
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.15151453018188477  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.15151453018188477  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.3326687812805176  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.332857608795166  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.18632268905639648  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.20566892623901367  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.20566892623901367  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

first layer input nodes number: 486282
first layer output nodes number: 199752
edges number: 1970111
----------------------------------------before model layer 0
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.21110916137695312  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([486282, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.21110916137695312  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7615966796875 GB
    Memory Allocated: 0.21110916137695312  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.3018922805786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.3018922805786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.4932985305786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

h_neigh size torch.Size([199752, 256])
h_self size  torch.Size([199752, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 0.4932985305786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([199752, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.6847047805786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.4932985305786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([199752, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.6847047805786133  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7323293685913086  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------input nodes number: 199752
----------------output nodes number: 25304
----------------edges number: 626329
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7345771789550781  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7345771789550781  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7635650634765625  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7635650634765625  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7679958343505859  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

h_neigh size torch.Size([25304, 47])
h_self size  torch.Size([25304, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7679958343505859  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([25304, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7724266052246094  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7679958343505859  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

torch.Size([25304, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7680087089538574  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.1483154296875 GB
    Memory Allocated: 0.7724399566650391  GigaBytes
Max Memory Allocated: 1.1006364822387695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.2399125099182129  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

pseudo mini batch 3 input nodes size: 434080
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18633556365966797  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18633556365966797  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.34804296493530273  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.3482246398925781  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.16688156127929688  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18463945388793945  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18463945388793945  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

first layer input nodes number: 434080
first layer output nodes number: 179927
edges number: 1746393
----------------------------------------before model layer 0
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18952465057373047  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([434080, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18952465057373047  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.18952465057373047  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.2702484130859375  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.2702484130859375  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.44184017181396484  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

h_neigh size torch.Size([179927, 256])
h_self size  torch.Size([179927, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.44184017181396484  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([179927, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6134319305419922  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.44184017181396484  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([179927, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6134319305419922  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6563301086425781  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------input nodes number: 179927
----------------output nodes number: 24351
----------------edges number: 580772
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6578526496887207  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6578526496887207  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6855854988098145  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6855854988098145  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6898493766784668  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

h_neigh size torch.Size([24351, 47])
h_self size  torch.Size([24351, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6898493766784668  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([24351, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.694333553314209  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6900696754455566  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([24351, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6899027824401855  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.6941671371459961  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.21399307250976562  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

pseudo mini batch 4 input nodes size: 639375
----------------------------------------before load block subtensor 
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.16671466827392578  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 9.3455810546875 GB
    Memory Allocated: 0.16671466827392578  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.4049959182739258  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.40517473220825195  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2432856559753418  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2628331184387207  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2628331184387207  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

first layer input nodes number: 639375
first layer output nodes number: 210660
edges number: 2070341
----------------------------------------before model layer 0
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2691669464111328  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([639375, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2691669464111328  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.5838623046875 GB
    Memory Allocated: 0.2691669464111328  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.5877685546875 GB
    Memory Allocated: 0.36405420303344727  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.5877685546875 GB
    Memory Allocated: 0.36405420303344727  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 0.5652260780334473  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

h_neigh size torch.Size([210660, 256])
h_self size  torch.Size([210660, 100])
----------------------------------------before rst
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 0.5652260780334473  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([210660, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.7663979530334473  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.5652260780334473  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([210660, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.7663979530334473  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8166232109069824  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------input nodes number: 210660
----------------output nodes number: 23957
----------------edges number: 553161
----------------------------------------before mean aggregator
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8183803558349609  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8183803558349609  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8455286026000977  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8455286026000977  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8497233390808105  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

h_neigh size torch.Size([23957, 47])
h_self size  torch.Size([23957, 256])
----------------------------------------before rst
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8497233390808105  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([23957, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8539180755615234  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8497233390808105  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

torch.Size([23957, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8496541976928711  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.1912841796875 GB
    Memory Allocated: 0.8539185523986816  GigaBytes
Max Memory Allocated: 1.1275763511657715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4022216796875 GB
    Memory Allocated: 0.2970743179321289  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 5 input nodes size: 573941
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4022216796875 GB
    Memory Allocated: 0.24321651458740234  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4022216796875 GB
    Memory Allocated: 0.24321651458740234  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.45702648162841797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.45720577239990234  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.21874570846557617  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.23865079879760742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.23865079879760742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 573941
first layer output nodes number: 206459
edges number: 2012771
----------------------------------------before model layer 0
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.24446535110473633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([573941, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.24446535110473633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.24446535110473633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.3377718925476074  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.3377718925476074  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5346665382385254  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([206459, 256])
h_self size  torch.Size([206459, 100])
----------------------------------------before rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5346665382385254  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([206459, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7315611839294434  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.5346665382385254  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([206459, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7315611839294434  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.780785083770752  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 206459
----------------output nodes number: 24001
----------------edges number: 578717
----------------------------------------before mean aggregator
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7825026512145996  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.7825026512145996  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8100395202636719  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8100395202636719  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8143167495727539  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([24001, 47])
h_self size  torch.Size([24001, 256])
----------------------------------------before rst
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8143167495727539  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([24001, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8189473152160645  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8146700859069824  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([24001, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8146777153015137  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.8189554214477539  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.27222442626953125  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 6 input nodes size: 519461
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.21875333786010742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.21875333786010742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.41226768493652344  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.41245603561401367  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.19846677780151367  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.21910810470581055  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.21910810470581055  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 519461
first layer output nodes number: 216385
edges number: 2142065
----------------------------------------before model layer 0
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.22526836395263672  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([519461, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.22526836395263672  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.6170654296875 GB
    Memory Allocated: 0.22526836395263672  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.6190185546875 GB
    Memory Allocated: 0.3226442337036133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.6190185546875 GB
    Memory Allocated: 0.3226442337036133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.6190185546875 GB
    Memory Allocated: 0.5290050506591797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([216385, 256])
h_self size  torch.Size([216385, 100])
----------------------------------------before rst
 Nvidia-smi: 10.6190185546875 GB
    Memory Allocated: 0.5290050506591797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([216385, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7360363006591797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.5296754837036133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([216385, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7360363006591797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7876267433166504  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 216385
----------------output nodes number: 25239
----------------edges number: 628288
----------------------------------------before mean aggregator
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7894277572631836  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.7894277572631836  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8183679580688477  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8183679580688477  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8227872848510742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([25239, 47])
h_self size  torch.Size([25239, 256])
----------------------------------------before rst
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8227872848510742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25239, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8272066116333008  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8227872848510742  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25239, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8230042457580566  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8260498046875 GB
    Memory Allocated: 0.8274240493774414  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25493907928466797  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 7 input nodes size: 456496
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1986837387084961  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1986837387084961  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3687419891357422  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.36892175674438477  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17521905899047852  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.19368219375610352  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.19368219375610352  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 456496
first layer output nodes number: 191087
edges number: 1882130
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1985483169555664  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([456496, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1985483169555664  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1985483169555664  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.28524208068847656  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.28524208068847656  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.46747684478759766  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([191087, 256])
h_self size  torch.Size([191087, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.46747684478759766  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([191087, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6497116088867188  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.46747684478759766  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([191087, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6497116088867188  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6952705383300781  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 191087
----------------output nodes number: 24091
----------------edges number: 595744
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6968741416931152  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6968741416931152  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.724761962890625  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.724761962890625  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7289800643920898  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([24091, 47])
h_self size  torch.Size([24091, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7289800643920898  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([24091, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.733375072479248  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7291569709777832  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([24091, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7289557456970215  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7331743240356445  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2254328727722168  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.22599363327026367  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.22599363327026367  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0788460373878479 |0.0511317253112793 |0.1128767728805542 |0.00017154216766357422 |0.004738539457321167 |0.0012917518615722656 |
----------------------------------------------------------pseudo_mini_loss sum 6.261519432067871
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5585005
Number of first layer input nodes during this epoch:  4012058
Number of first layer output nodes during this epoch:  1572947
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.22599315643310547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.29039549827575684
global_2_local spend time (sec) 0.38338327407836914

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.150 seconds
Metis partitioning: 12.205 seconds
Split the graph: 1.908 seconds
Construct subgraphs: 0.039 seconds
25308
25063
25287
23930
23854
23956
23870
25303
REG metis partition end ----................................
the time spent:  26.462729692459106
total k batches seeds list generation spend  27.123222827911377
after graph partition
graph partition algorithm spend time 27.81528639793396

partition_len_list
[202066, 156984, 191991, 190387, 207193, 193303, 222329, 204666]
REG selection method  spend 28.382153749465942
check_connections_block*********************************
time for parepare 1: 0.24714136123657227
local_output_nid generation: 0.006484508514404297
local_in_edges_tensor generation: 0.010640144348144531
mini_batch_src_global generation: 0.0215606689453125

&&&&&&&&&&&&&&& before remove duplicate length: 626064
r_  generation: 0.23536419868469238

local_output_nid generation: 0.007547855377197266
local_in_edges_tensor generation: 0.008406639099121094
mini_batch_src_global generation: 0.025077342987060547

&&&&&&&&&&&&&&& before remove duplicate length: 598491
r_  generation: 0.22481036186218262

local_output_nid generation: 0.0075266361236572266
local_in_edges_tensor generation: 0.008048534393310547
mini_batch_src_global generation: 0.02090001106262207

&&&&&&&&&&&&&&& before remove duplicate length: 610107
r_  generation: 0.26149988174438477

local_output_nid generation: 0.0073621273040771484
local_in_edges_tensor generation: 0.007901430130004883
mini_batch_src_global generation: 0.022821903228759766

&&&&&&&&&&&&&&& before remove duplicate length: 579873
r_  generation: 0.26038455963134766

local_output_nid generation: 0.007398366928100586
local_in_edges_tensor generation: 0.007926464080810547
mini_batch_src_global generation: 0.022170066833496094

&&&&&&&&&&&&&&& before remove duplicate length: 570503
r_  generation: 0.2640535831451416

local_output_nid generation: 0.007512331008911133
local_in_edges_tensor generation: 0.009154319763183594
mini_batch_src_global generation: 0.023996353149414062

&&&&&&&&&&&&&&& before remove duplicate length: 555568
r_  generation: 0.2582564353942871

local_output_nid generation: 0.007456541061401367
local_in_edges_tensor generation: 0.007667064666748047
mini_batch_src_global generation: 0.02485203742980957

&&&&&&&&&&&&&&& before remove duplicate length: 593196
r_  generation: 0.2841184139251709

local_output_nid generation: 0.007616758346557617
local_in_edges_tensor generation: 0.0099639892578125
mini_batch_src_global generation: 0.02924513816833496

&&&&&&&&&&&&&&& before remove duplicate length: 630077
r_  generation: 0.3222191333770752


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8220484256744385
gen group dst list time:  0.05052804946899414
check_connections_block*********************************
time for parepare 1: 0.39643263816833496
local_output_nid generation: 0.0505831241607666
local_in_edges_tensor generation: 0.11691880226135254
mini_batch_src_global generation: 0.057861328125

&&&&&&&&&&&&&&& before remove duplicate length: 1993654
r_  generation: 0.8692538738250732

local_output_nid generation: 0.040274858474731445
local_in_edges_tensor generation: 0.06872677803039551
mini_batch_src_global generation: 0.06267952919006348

&&&&&&&&&&&&&&& before remove duplicate length: 1517095
r_  generation: 0.6765124797821045

local_output_nid generation: 0.074615478515625
local_in_edges_tensor generation: 0.06999683380126953
mini_batch_src_global generation: 0.06528639793395996

&&&&&&&&&&&&&&& before remove duplicate length: 1834722
r_  generation: 0.8470401763916016

local_output_nid generation: 0.05504035949707031
local_in_edges_tensor generation: 0.06501555442810059
mini_batch_src_global generation: 0.07492303848266602

&&&&&&&&&&&&&&& before remove duplicate length: 1841651
r_  generation: 0.8712053298950195

local_output_nid generation: 0.05672144889831543
local_in_edges_tensor generation: 0.06026196479797363
mini_batch_src_global generation: 0.07813143730163574

&&&&&&&&&&&&&&& before remove duplicate length: 2015482
r_  generation: 0.9943575859069824

local_output_nid generation: 0.07278776168823242
local_in_edges_tensor generation: 0.101348876953125
mini_batch_src_global generation: 0.09070587158203125

&&&&&&&&&&&&&&& before remove duplicate length: 1898131
r_  generation: 0.9671578407287598

local_output_nid generation: 0.07813572883605957
local_in_edges_tensor generation: 0.10376811027526855
mini_batch_src_global generation: 0.09120488166809082

&&&&&&&&&&&&&&& before remove duplicate length: 2200830
r_  generation: 1.1264574527740479

local_output_nid generation: 0.06339907646179199
local_in_edges_tensor generation: 0.05143880844116211
mini_batch_src_global generation: 0.08518195152282715

&&&&&&&&&&&&&&& before remove duplicate length: 2024601
r_  generation: 0.9825985431671143


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.22599315643310547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

connection checking time:  14.074533939361572
block generation total time  12.438401699066162
average batch blocks generation time:  1.5548002123832703
pseudo mini batch 0 input nodes size: 471419
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17557764053344727  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17557764053344727  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3511953353881836  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.35138416290283203  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.18114614486694336  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2008352279663086  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2008352279663086  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 471419
first layer output nodes number: 202066
edges number: 1993654
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20640993118286133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([471419, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20640993118286133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20640993118286133  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2980637550354004  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2980637550354004  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4907689094543457  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([202066, 256])
h_self size  torch.Size([202066, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4907689094543457  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([202066, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.683474063873291  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4907689094543457  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([202066, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.683474063873291  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7316503524780273  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 202066
----------------output nodes number: 25308
----------------edges number: 626064
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7333450317382812  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7333450317382812  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7623348236083984  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7623348236083984  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7667660713195801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([25308, 47])
h_self size  torch.Size([25308, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7667660713195801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25308, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7711973190307617  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7667660713195801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25308, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7669792175292969  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7714114189147949  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.23487472534179688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 1 input nodes size: 345127
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.18136024475097656  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.18136024475097656  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.30993032455444336  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.310117244720459  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.13431072235107422  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.15007400512695312  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.15007400512695312  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 345127
first layer output nodes number: 156984
edges number: 1517095
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1544208526611328  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([345127, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1544208526611328  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1544208526611328  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2247910499572754  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2247910499572754  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.37450265884399414  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([156984, 256])
h_self size  torch.Size([156984, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.37450265884399414  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([156984, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5242142677307129  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.37450265884399414  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([156984, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5242142677307129  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5616421699523926  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 156984
----------------output nodes number: 25063
----------------edges number: 598491
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.563849925994873  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.563849925994873  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5927443504333496  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5927443504333496  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.597132682800293  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([25063, 47])
h_self size  torch.Size([25063, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.597132682800293  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25063, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6015210151672363  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.597132682800293  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25063, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5970897674560547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6015214920043945  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17841815948486328  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 2 input nodes size: 463977
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.13426780700683594  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.13426780700683594  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3071131706237793  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.30730199813842773  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1785449981689453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1967611312866211  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1967611312866211  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 463977
first layer output nodes number: 191991
edges number: 1834722
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20173263549804688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([463977, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20173263549804688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.20173263549804688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2876400947570801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2876400947570801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4707369804382324  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([191991, 256])
h_self size  torch.Size([191991, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4707369804382324  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([191991, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6538338661193848  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4707369804382324  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([191991, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.6538338661193848  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.699608325958252  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 191991
----------------output nodes number: 25287
----------------edges number: 610107
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7017521858215332  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7017521858215332  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7307796478271484  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7307796478271484  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7352075576782227  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([25287, 47])
h_self size  torch.Size([25287, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7352075576782227  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25287, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7396354675292969  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7352075576782227  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([25287, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7352471351623535  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7396755218505859  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.22916698455810547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 3 input nodes size: 507924
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17858457565307617  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.17858457565307617  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3678011894226074  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3679795265197754  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.1949453353881836  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.21301698684692383  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.21301698684692383  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 507924
first layer output nodes number: 190387
edges number: 1841651
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.21822023391723633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([507924, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.21822023391723633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.21822023391723633  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3035759925842285  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.3035759925842285  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.48514318466186523  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([190387, 256])
h_self size  torch.Size([190387, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.48514318466186523  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([190387, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.666710376739502  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.48514318466186523  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([190387, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.666710376739502  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7121024131774902  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 190387
----------------output nodes number: 23930
----------------edges number: 579873
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7136993408203125  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7136993408203125  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7414207458496094  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7414207458496094  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7456107139587402  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([23930, 47])
h_self size  torch.Size([23930, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7456107139587402  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23930, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7498006820678711  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7456107139587402  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23930, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7453727722167969  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7498011589050293  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2438516616821289  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 4 input nodes size: 608422
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.19470739364624023  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.19470739364624023  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.42136240005493164  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.4215402603149414  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2321453094482422  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25141334533691406  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25141334533691406  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 608422
first layer output nodes number: 207193
edges number: 2015482
----------------------------------------before model layer 0
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25793886184692383  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([608422, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25793886184692383  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.25793886184692383  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.35152149200439453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.35152149200439453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5491161346435547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([207193, 256])
h_self size  torch.Size([207193, 100])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5491161346435547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([207193, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7467107772827148  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.5491161346435547  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([207193, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7467107772827148  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.796109676361084  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 207193
----------------output nodes number: 23854
----------------edges number: 570503
----------------------------------------before mean aggregator
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7986149787902832  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.7986149787902832  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8261165618896484  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8261165618896484  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8302931785583496  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([23854, 47])
h_self size  torch.Size([23854, 256])
----------------------------------------before rst
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8302931785583496  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23854, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8344697952270508  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8302931785583496  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23854, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8304286003112793  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.8346190452575684  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.2866635322570801  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 5 input nodes size: 580426
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.23228073120117188  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 0.23228073120117188  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.4490776062011719  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.44925642013549805  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.22242355346679688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.2407064437866211  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.2407064437866211  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 580426
first layer output nodes number: 193303
edges number: 1898131
----------------------------------------before model layer 0
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.24648237228393555  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([580426, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.24648237228393555  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.24648237228393555  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.33361148834228516  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.33361148834228516  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.5179595947265625  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([193303, 256])
h_self size  torch.Size([193303, 100])
----------------------------------------before rst
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.5179595947265625  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([193303, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7023077011108398  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.5179595947265625  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([193303, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7023077011108398  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7483949661254883  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 193303
----------------output nodes number: 23956
----------------edges number: 555568
----------------------------------------before mean aggregator
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7500557899475098  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7500557899475098  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7776947021484375  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7776947021484375  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7819232940673828  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([23956, 47])
h_self size  torch.Size([23956, 256])
----------------------------------------before rst
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7819232940673828  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23956, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7861180305480957  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7818894386291504  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23956, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7817587852478027  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.7859878540039062  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.27252817153930664  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

pseudo mini batch 6 input nodes size: 555758
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.22229290008544922  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.22229290008544922  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.42932891845703125  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.429506778717041  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.21253108978271484  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.23334884643554688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.23334884643554688  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

first layer input nodes number: 555758
first layer output nodes number: 222329
edges number: 2200830
----------------------------------------before model layer 0
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.23914623260498047  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([555758, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.23914623260498047  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.2557373046875 GB
    Memory Allocated: 0.23914623260498047  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 0.33919620513916016  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 0.33919620513916016  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 0.5512256622314453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([222329, 256])
h_self size  torch.Size([222329, 100])
----------------------------------------before rst
 Nvidia-smi: 11.2576904296875 GB
    Memory Allocated: 0.5512256622314453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([222329, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.7641162872314453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.5520868301391602  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([222329, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.7641162872314453  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8171238899230957  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------input nodes number: 222329
----------------output nodes number: 23870
----------------edges number: 593196
----------------------------------------before mean aggregator
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8189582824707031  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8189582824707031  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8463211059570312  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8463211059570312  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8505005836486816  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

h_neigh size torch.Size([23870, 47])
h_self size  torch.Size([23870, 256])
----------------------------------------before rst
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8505005836486816  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23870, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.854680061340332  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8505005836486816  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

torch.Size([23870, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8504853248596191  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4705810546875 GB
    Memory Allocated: 0.8546805381774902  GigaBytes
Max Memory Allocated: 1.2304649353027344  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2682313919067383  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 7 input nodes size: 457391
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21251583099365234  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21251583099365234  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3829073905944824  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.38309621810913086  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17588233947753906  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1961812973022461  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1961812973022461  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 457391
first layer output nodes number: 204666
edges number: 2024601
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.201446533203125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([457391, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.201446533203125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.201446533203125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.29407835006713867  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.29407835006713867  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.48926305770874023  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([204666, 256])
h_self size  torch.Size([204666, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.48926305770874023  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([204666, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6844477653503418  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.48926305770874023  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([204666, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6844477653503418  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7332439422607422  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 204666
----------------output nodes number: 25303
----------------edges number: 630077
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7349576950073242  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7349576950073242  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.763972282409668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.763972282409668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7684025764465332  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25303, 47])
h_self size  torch.Size([25303, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7684025764465332  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25303, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7728328704833984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7684025764465332  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25303, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.768653392791748  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7738699913024902  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23004531860351562  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23004531860351562  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23004531860351562  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08402171730995178 |0.014085114002227783 |0.016300112009048462 |0.00013646483421325684 |0.003407120704650879 |0.0013308525085449219 |
----------------------------------------------------------pseudo_mini_loss sum 3.433753252029419
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5559363
Number of first layer input nodes during this epoch:  3990444
Number of first layer output nodes during this epoch:  1568919
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23004484176635742  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.23955941200256348
global_2_local spend time (sec) 0.46042895317077637

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.211 seconds
Metis partitioning: 12.759 seconds
Split the graph: 1.708 seconds
Construct subgraphs: 0.085 seconds
23856
23861
25237
24468
23878
25171
24931
25169
REG metis partition end ----................................
the time spent:  26.944554328918457
total k batches seeds list generation spend  27.595354318618774
after graph partition
graph partition algorithm spend time 28.252824544906616

partition_len_list
[151848, 208049, 188440, 173611, 208709, 220937, 206785, 202901]
REG selection method  spend 28.93372917175293
check_connections_block*********************************
time for parepare 1: 0.2374420166015625
local_output_nid generation: 0.0063741207122802734
local_in_edges_tensor generation: 0.007452487945556641
mini_batch_src_global generation: 0.019150495529174805

&&&&&&&&&&&&&&& before remove duplicate length: 568398
r_  generation: 0.19107842445373535

local_output_nid generation: 0.007298946380615234
local_in_edges_tensor generation: 0.01470637321472168
mini_batch_src_global generation: 0.02453446388244629

&&&&&&&&&&&&&&& before remove duplicate length: 588914
r_  generation: 0.24077439308166504

local_output_nid generation: 0.007569313049316406
local_in_edges_tensor generation: 0.006922721862792969
mini_batch_src_global generation: 0.022661447525024414

&&&&&&&&&&&&&&& before remove duplicate length: 609253
r_  generation: 0.26488733291625977

local_output_nid generation: 0.007429599761962891
local_in_edges_tensor generation: 0.01728534698486328
mini_batch_src_global generation: 0.030796289443969727

&&&&&&&&&&&&&&& before remove duplicate length: 594455
r_  generation: 0.24769163131713867

local_output_nid generation: 0.0074462890625
local_in_edges_tensor generation: 0.008665084838867188
mini_batch_src_global generation: 0.024524450302124023

&&&&&&&&&&&&&&& before remove duplicate length: 554601
r_  generation: 0.24413633346557617

local_output_nid generation: 0.007615804672241211
local_in_edges_tensor generation: 0.0095672607421875
mini_batch_src_global generation: 0.026717662811279297

&&&&&&&&&&&&&&& before remove duplicate length: 619025
r_  generation: 0.29236841201782227

local_output_nid generation: 0.007666349411010742
local_in_edges_tensor generation: 0.01355123519897461
mini_batch_src_global generation: 0.026208877563476562

&&&&&&&&&&&&&&& before remove duplicate length: 602832
r_  generation: 0.28385090827941895

local_output_nid generation: 0.007600307464599609
local_in_edges_tensor generation: 0.01015472412109375
mini_batch_src_global generation: 0.029581069946289062

&&&&&&&&&&&&&&& before remove duplicate length: 626401
r_  generation: 0.3073756694793701


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8061707019805908
gen group dst list time:  0.04825186729431152
check_connections_block*********************************
time for parepare 1: 0.39894628524780273
local_output_nid generation: 0.036133527755737305
local_in_edges_tensor generation: 0.11081647872924805
mini_batch_src_global generation: 0.05148148536682129

&&&&&&&&&&&&&&& before remove duplicate length: 1465336
r_  generation: 0.5979461669921875

local_output_nid generation: 0.055487632751464844
local_in_edges_tensor generation: 0.08086109161376953
mini_batch_src_global generation: 0.08079648017883301

&&&&&&&&&&&&&&& before remove duplicate length: 2052141
r_  generation: 1.0021898746490479

local_output_nid generation: 0.07607603073120117
local_in_edges_tensor generation: 0.0652306079864502
mini_batch_src_global generation: 0.07222795486450195

&&&&&&&&&&&&&&& before remove duplicate length: 1801687
r_  generation: 0.8577015399932861

local_output_nid generation: 0.049703121185302734
local_in_edges_tensor generation: 0.04616832733154297
mini_batch_src_global generation: 0.06467175483703613

&&&&&&&&&&&&&&& before remove duplicate length: 1673606
r_  generation: 0.8132328987121582

local_output_nid generation: 0.059473514556884766
local_in_edges_tensor generation: 0.0666496753692627
mini_batch_src_global generation: 0.08916568756103516

&&&&&&&&&&&&&&& before remove duplicate length: 2049482
r_  generation: 1.0374174118041992

local_output_nid generation: 0.06951475143432617
local_in_edges_tensor generation: 0.08703470230102539
mini_batch_src_global generation: 0.11153578758239746

&&&&&&&&&&&&&&& before remove duplicate length: 2186615
r_  generation: 1.124753475189209

local_output_nid generation: 0.08086585998535156
local_in_edges_tensor generation: 0.07950282096862793
mini_batch_src_global generation: 0.08355164527893066

&&&&&&&&&&&&&&& before remove duplicate length: 2013732
r_  generation: 1.012390375137329

local_output_nid generation: 0.06228756904602051
local_in_edges_tensor generation: 0.04633736610412598
mini_batch_src_global generation: 0.08861875534057617

&&&&&&&&&&&&&&& before remove duplicate length: 2005732
r_  generation: 0.9855854511260986


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23004484176635742  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

connection checking time:  14.136793851852417
block generation total time  12.484588861465454
average batch blocks generation time:  1.5605736076831818
block dataloader generation time/epoch 57.487736225128174
pseudo mini batch 0 input nodes size: 337627
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1761322021484375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1761322021484375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3019084930419922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.30208635330200195  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.13150596618652344  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.14691448211669922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.14691448211669922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 337627
first layer output nodes number: 151848
edges number: 1465336
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.15124034881591797  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([337627, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.15124034881591797  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.15124034881591797  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21936607360839844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21936607360839844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3641796112060547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([151848, 256])
h_self size  torch.Size([151848, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3641796112060547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([151848, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5089931488037109  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3641796112060547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([151848, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5089931488037109  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.545196533203125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 151848
----------------output nodes number: 23856
----------------edges number: 568398
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5465059280395508  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5465059280395508  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5744719505310059  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5744719505310059  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5786490440368652  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23856, 47])
h_self size  torch.Size([23856, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5786490440368652  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23856, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.583000659942627  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5788235664367676  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23856, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5785703659057617  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5827484130859375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17384052276611328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 1 input nodes size: 535626
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.13125371932983398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.13125371932983398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.33079004287719727  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.33096790313720703  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20501375198364258  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22469186782836914  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22469186782836914  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 535626
first layer output nodes number: 208049
edges number: 2052141
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23029184341430664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([535626, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23029184341430664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23029184341430664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.32386207580566406  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.32386207580566406  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.522273063659668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([208049, 256])
h_self size  torch.Size([208049, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.522273063659668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([208049, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7206840515136719  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.522273063659668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([208049, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7206840515136719  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.770287036895752  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 208049
----------------output nodes number: 23861
----------------edges number: 588914
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7721004486083984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7721004486083984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8005561828613281  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8005561828613281  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8047971725463867  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23861, 47])
h_self size  torch.Size([23861, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8047971725463867  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23861, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8089752197265625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8047342300415039  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23861, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8047351837158203  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8089766502380371  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.25894594192504883  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 2 input nodes size: 433535
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20501470565795898  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20501470565795898  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3665194511413574  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.36670780181884766  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1669936180114746  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18495702743530273  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18495702743530273  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 433535
first layer output nodes number: 188440
edges number: 1801687
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19011640548706055  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([433535, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19011640548706055  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19011640548706055  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.274442195892334  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.274442195892334  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.45415258407592773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([188440, 256])
h_self size  torch.Size([188440, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.45415258407592773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([188440, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6338629722595215  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.45415258407592773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([188440, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6338629722595215  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6787905693054199  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 188440
----------------output nodes number: 25237
----------------edges number: 609253
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6810450553894043  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6810450553894043  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.709841251373291  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.709841251373291  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7142601013183594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25237, 47])
h_self size  torch.Size([25237, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7142601013183594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25237, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7187542915344238  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7143354415893555  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25237, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.714576244354248  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7189955711364746  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21661376953125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 3 input nodes size: 446017
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1672344207763672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1672344207763672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3333888053894043  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3335714340209961  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17187833786010742  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18931961059570312  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 446017
first layer output nodes number: 173611
edges number: 1673606
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19393682479858398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([446017, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19393682479858398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19393682479858398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2717294692993164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2717294692993164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4372978210449219  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([173611, 256])
h_self size  torch.Size([173611, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4372978210449219  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([173611, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6028661727905273  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4372978210449219  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([173611, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6028661727905273  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6442584991455078  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 173611
----------------output nodes number: 24468
----------------edges number: 594455
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6457962989807129  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6457962989807129  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6740865707397461  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6740865707397461  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6783709526062012  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([24468, 47])
h_self size  torch.Size([24468, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6783709526062012  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24468, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6826553344726562  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6783709526062012  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24468, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6782364845275879  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6826558113098145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2184123992919922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 4 input nodes size: 623686
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17174386978149414  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17174386978149414  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4040851593017578  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4042634963989258  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23792648315429688  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.25732898712158203  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.25732898712158203  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 623686
first layer output nodes number: 208709
edges number: 2049482
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.26378393173217773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([623686, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.26378393173217773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.26378393173217773  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3579368591308594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3579368591308594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5569772720336914  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([208709, 256])
h_self size  torch.Size([208709, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5569772720336914  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([208709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7560176849365234  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5569772720336914  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([208709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7560176849365234  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8057780265808105  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 208709
----------------output nodes number: 23878
----------------edges number: 554601
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8080878257751465  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8080878257751465  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.835235595703125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.835235595703125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.83941650390625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23878, 47])
h_self size  torch.Size([23878, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.83941650390625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23878, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.843597412109375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.83941650390625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23878, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8394784927368164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8437633514404297  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2919011116027832  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 5 input nodes size: 561963
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23798847198486328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23798847198486328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.44733619689941406  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4475240707397461  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21500444412231445  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23590898513793945  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23590898513793945  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 561963
first layer output nodes number: 220937
edges number: 2186615
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.24174261093139648  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([561963, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.24174261093139648  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.24174261093139648  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.34116363525390625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.34116363525390625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5518655776977539  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([220937, 256])
h_self size  torch.Size([220937, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5518655776977539  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([220937, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7625675201416016  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5518655776977539  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([220937, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7625675201416016  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8152432441711426  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 220937
----------------output nodes number: 25171
----------------edges number: 619025
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.81707763671875  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.81707763671875  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8458833694458008  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8458833694458008  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8502907752990723  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25171, 47])
h_self size  torch.Size([25171, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8502907752990723  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25171, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8546981811523438  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8502907752990723  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25171, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8503518104553223  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.854759693145752  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.27175474166870117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 6 input nodes size: 546861
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21506547927856445  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.21506547927856445  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.41878747940063477  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.418973445892334  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20943784713745117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2295546531677246  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2295546531677246  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 546861
first layer output nodes number: 206785
edges number: 2013732
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23531675338745117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([546861, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23531675338745117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23531675338745117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.328125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.328125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5253305435180664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([206785, 256])
h_self size  torch.Size([206785, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5253305435180664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([206785, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7225360870361328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5253305435180664  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([206785, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7225360870361328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7718377113342285  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 206785
----------------output nodes number: 24931
----------------edges number: 602832
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7738261222839355  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7738261222839355  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8022799491882324  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8022799491882324  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.806645393371582  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([24931, 47])
h_self size  torch.Size([24931, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.806645393371582  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24931, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8110108375549316  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.806645393371582  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24931, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8066034317016602  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.810969352722168  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.26288509368896484  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 7 input nodes size: 456963
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2093958854675293  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2093958854675293  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.37962818145751953  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.37981605529785156  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17590808868408203  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1957411766052246  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1957411766052246  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 456963
first layer output nodes number: 202901
edges number: 2005732
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20065832138061523  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([456963, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20065832138061523  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20065832138061523  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.29262638092041016  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.29262638092041016  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4861278533935547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([202901, 256])
h_self size  torch.Size([202901, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4861278533935547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([202901, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6796293258666992  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4861278533935547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([202901, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6796293258666992  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7280049324035645  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 202901
----------------output nodes number: 25169
----------------edges number: 626401
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7297048568725586  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7297048568725586  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7585630416870117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7585630416870117  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7638998031616211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25169, 47])
h_self size  torch.Size([25169, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7638998031616211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25169, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7683067321777344  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.762969970703125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25169, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7639412879943848  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7683486938476562  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22989559173583984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22989559173583984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22989559173583984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08155268430709839 |0.013741165399551392 |0.01609039306640625 |0.0001404285430908203 |0.0028805434703826904 |0.0022830963134765625 |
----------------------------------------------------------pseudo_mini_loss sum 2.049712896347046
Total (block generation + training)time/epoch 58.43494272232056
Training time/epoch 0.9469571113586426
Training time without block to device /epoch 0.8370277881622314
Training time without total dataloading part /epoch 0.15517401695251465
load block tensor time/epoch 0.6524214744567871
block to device time/epoch 0.10992932319641113
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5503558
Number of first layer input nodes during this epoch:  3942278
Number of first layer output nodes during this epoch:  1561280
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22989511489868164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.24684524536132812
global_2_local spend time (sec) 0.42719316482543945

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.916 seconds
Metis partitioning: 12.304 seconds
Split the graph: 1.849 seconds
Construct subgraphs: 0.050 seconds
24999
25171
25024
23854
24519
25268
23854
23882
REG metis partition end ----................................
the time spent:  26.162858247756958
total k batches seeds list generation spend  26.820899963378906
after graph partition
graph partition algorithm spend time 27.44526481628418

partition_len_list
[156709, 189304, 193861, 197431, 193525, 223563, 207415, 230918]
REG selection method  spend 28.07863187789917
check_connections_block*********************************
time for parepare 1: 0.21984577178955078
local_output_nid generation: 0.0064239501953125
local_in_edges_tensor generation: 0.007061004638671875
mini_batch_src_global generation: 0.02143549919128418

&&&&&&&&&&&&&&& before remove duplicate length: 597207
r_  generation: 0.20143532752990723

local_output_nid generation: 0.007521867752075195
local_in_edges_tensor generation: 0.00786590576171875
mini_batch_src_global generation: 0.027948379516601562

&&&&&&&&&&&&&&& before remove duplicate length: 622583
r_  generation: 0.2638895511627197

local_output_nid generation: 0.007631540298461914
local_in_edges_tensor generation: 0.014155864715576172
mini_batch_src_global generation: 0.026563167572021484

&&&&&&&&&&&&&&& before remove duplicate length: 604690
r_  generation: 0.28575706481933594

local_output_nid generation: 0.008561134338378906
local_in_edges_tensor generation: 0.014820098876953125
mini_batch_src_global generation: 0.032303571701049805

&&&&&&&&&&&&&&& before remove duplicate length: 577438
r_  generation: 0.27680325508117676

local_output_nid generation: 0.00913858413696289
local_in_edges_tensor generation: 0.008926630020141602
mini_batch_src_global generation: 0.030646324157714844

&&&&&&&&&&&&&&& before remove duplicate length: 593444
r_  generation: 0.2740333080291748

local_output_nid generation: 0.008900642395019531
local_in_edges_tensor generation: 0.010206460952758789
mini_batch_src_global generation: 0.029885053634643555

&&&&&&&&&&&&&&& before remove duplicate length: 628797
r_  generation: 0.29967188835144043

local_output_nid generation: 0.007486820220947266
local_in_edges_tensor generation: 0.008791446685791016
mini_batch_src_global generation: 0.029519081115722656

&&&&&&&&&&&&&&& before remove duplicate length: 583846
r_  generation: 0.2776162624359131

local_output_nid generation: 0.00744175910949707
local_in_edges_tensor generation: 0.006678342819213867
mini_batch_src_global generation: 0.027799367904663086

&&&&&&&&&&&&&&& before remove duplicate length: 555874
r_  generation: 0.2672309875488281


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8174192905426025
gen group dst list time:  0.0478816032409668
check_connections_block*********************************
time for parepare 1: 0.3945791721343994
local_output_nid generation: 0.0499272346496582
local_in_edges_tensor generation: 0.09755206108093262
mini_batch_src_global generation: 0.04604625701904297

&&&&&&&&&&&&&&& before remove duplicate length: 1514293
r_  generation: 0.6156110763549805

local_output_nid generation: 0.060365915298461914
local_in_edges_tensor generation: 0.05788612365722656
mini_batch_src_global generation: 0.07179450988769531

&&&&&&&&&&&&&&& before remove duplicate length: 1862142
r_  generation: 0.837608814239502

local_output_nid generation: 0.05406951904296875
local_in_edges_tensor generation: 0.05651736259460449
mini_batch_src_global generation: 0.0759284496307373

&&&&&&&&&&&&&&& before remove duplicate length: 1859914
r_  generation: 0.8722898960113525

local_output_nid generation: 0.05704617500305176
local_in_edges_tensor generation: 0.04758810997009277
mini_batch_src_global generation: 0.07275032997131348

&&&&&&&&&&&&&&& before remove duplicate length: 1910471
r_  generation: 0.9294638633728027

local_output_nid generation: 0.0528872013092041
local_in_edges_tensor generation: 0.045892953872680664
mini_batch_src_global generation: 0.0823216438293457

&&&&&&&&&&&&&&& before remove duplicate length: 1884069
r_  generation: 0.9078676700592041

local_output_nid generation: 0.06292867660522461
local_in_edges_tensor generation: 0.062087059020996094
mini_batch_src_global generation: 0.08689570426940918

&&&&&&&&&&&&&&& before remove duplicate length: 2213246
r_  generation: 1.1118495464324951

local_output_nid generation: 0.059160709381103516
local_in_edges_tensor generation: 0.08264446258544922
mini_batch_src_global generation: 0.08891749382019043

&&&&&&&&&&&&&&& before remove duplicate length: 2045928
r_  generation: 1.0278878211975098

local_output_nid generation: 0.06674003601074219
local_in_edges_tensor generation: 0.06985807418823242
mini_batch_src_global generation: 0.10119247436523438

&&&&&&&&&&&&&&& before remove duplicate length: 2272831
r_  generation: 1.1663627624511719


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22989511489868164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

connection checking time:  14.244146823883057
block generation total time  12.225004434585571
average batch blocks generation time:  1.5281255543231964
block dataloader generation time/epoch 56.99915027618408
pseudo mini batch 0 input nodes size: 344167
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1768784523010254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1768784523010254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.30509090423583984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.30527734756469727  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.134857177734375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1505899429321289  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1505899429321289  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 344167
first layer output nodes number: 156709
edges number: 1514293
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1552715301513672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([344167, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1552715301513672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1552715301513672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22551727294921875  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22551727294921875  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3749666213989258  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([156709, 256])
h_self size  torch.Size([156709, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3749666213989258  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([156709, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5244159698486328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3749666213989258  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([156709, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5244159698486328  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5617785453796387  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 156709
----------------output nodes number: 24999
----------------edges number: 597207
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5631327629089355  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5631327629089355  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5916104316711426  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5916104316711426  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5959877967834473  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([24999, 47])
h_self size  torch.Size([24999, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5959877967834473  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24999, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.600365161895752  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5959877967834473  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24999, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5950284004211426  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5994067192077637  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1774144172668457  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 1 input nodes size: 446595
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.13389873504638672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.13389873504638672  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.30026865005493164  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.30045652389526367  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1720576286315918  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19057035446166992  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19057035446166992  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 446595
first layer output nodes number: 189304
edges number: 1862142
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1954183578491211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([446595, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1954183578491211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1954183578491211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2805190086364746  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2805190086364746  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.46105337142944336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([189304, 256])
h_self size  torch.Size([189304, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.46105337142944336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([189304, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6415877342224121  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.46105337142944336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([189304, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6415877342224121  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6867213249206543  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 189304
----------------output nodes number: 25171
----------------edges number: 622583
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6886534690856934  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6886534690856934  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7182927131652832  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7182927131652832  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7233052253723145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25171, 47])
h_self size  torch.Size([25171, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7233052253723145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25171, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7277126312255859  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7227001190185547  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25171, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7233352661132812  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7286958694458008  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22382307052612305  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 2 input nodes size: 472215
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17269277572631836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17269277572631836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.34860658645629883  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.34879302978515625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1822352409362793  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2007136344909668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2007136344909668  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 472215
first layer output nodes number: 193861
edges number: 1859914
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20599937438964844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([472215, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20599937438964844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20599937438964844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2928452491760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2928452491760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4783921241760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([193861, 256])
h_self size  torch.Size([193861, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4783921241760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([193861, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6639389991760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4783921241760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([193861, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6639389991760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7101593017578125  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 193861
----------------output nodes number: 25024
----------------edges number: 604690
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7117905616760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7117905616760254  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7403483390808105  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7403483390808105  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7447299957275391  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25024, 47])
h_self size  torch.Size([25024, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7447299957275391  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25024, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7491116523742676  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7447299957275391  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25024, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7440991401672363  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7487297058105469  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23153209686279297  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 3 input nodes size: 537815
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18160438537597656  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.18160438537597656  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.38277626037597656  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.38295412063598633  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20685386657714844  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22539138793945312  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22539138793945312  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 537815
first layer output nodes number: 197431
edges number: 1910471
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23086977005004883  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([537815, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23086977005004883  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23086977005004883  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.31938886642456055  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.31938886642456055  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5076737403869629  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([197431, 256])
h_self size  torch.Size([197431, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5076737403869629  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([197431, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6959586143493652  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.5076737403869629  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([197431, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6959586143493652  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7430300712585449  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 197431
----------------output nodes number: 23854
----------------edges number: 577438
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7446789741516113  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7446789741516113  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7731728553771973  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7731728553771973  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7776732444763184  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23854, 47])
h_self size  torch.Size([23854, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7776732444763184  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23854, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7818498611450195  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7773494720458984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23854, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7771444320678711  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7816452980041504  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2581758499145508  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 4 input nodes size: 464326
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2066488265991211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2066488265991211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3796238899230957  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3798069953918457  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.17845726013183594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19700002670288086  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.19700002670288086  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 464326
first layer output nodes number: 193525
edges number: 1884069
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20255279541015625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([464326, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20255279541015625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20255279541015625  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2895774841308594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2895774841308594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4741373062133789  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([193525, 256])
h_self size  torch.Size([193525, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4741373062133789  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([193525, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6586971282958984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.4741373062133789  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([193525, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.6586971282958984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7048373222351074  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 193525
----------------output nodes number: 24519
----------------edges number: 593444
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7066073417663574  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7066073417663574  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7351269721984863  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7351269721984863  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7397623062133789  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([24519, 47])
h_self size  torch.Size([24519, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7397623062133789  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24519, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7440557479858398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7394204139709473  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([24519, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.739537239074707  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7441730499267578  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.2295999526977539  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 5 input nodes size: 536046
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1785740852355957  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.1785740852355957  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3782668113708496  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.37845516204833984  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.20529699325561523  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22721624374389648  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.22721624374389648  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 536046
first layer output nodes number: 223563
edges number: 2213246
----------------------------------------before model layer 0
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23287630081176758  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([536046, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23287630081176758  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.23287630081176758  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3334832191467285  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.3334832191467285  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.546689510345459  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([223563, 256])
h_self size  torch.Size([223563, 100])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.546689510345459  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([223563, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7598958015441895  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.546689510345459  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([223563, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.7598958015441895  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8131976127624512  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 223563
----------------output nodes number: 25268
----------------edges number: 628797
----------------------------------------before mean aggregator
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8150520324707031  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8150520324707031  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8442468643188477  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8442468643188477  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8486714363098145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([25268, 47])
h_self size  torch.Size([25268, 256])
----------------------------------------before rst
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8486714363098145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25268, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8538775444030762  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8494529724121094  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([25268, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8495841026306152  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.6893310546875 GB
    Memory Allocated: 0.8540091514587402  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.26270627975463867  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 6 input nodes size: 576825
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.2054281234741211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.2054281234741211  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.42031240463256836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.4204902648925781  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.22060918807983398  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.24042749404907227  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.24042749404907227  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 576825
first layer output nodes number: 207415
edges number: 2045928
----------------------------------------before model layer 0
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.24663782119750977  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([576825, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.24663782119750977  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.24663782119750977  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.340303897857666  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.340303897857666  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.5381102561950684  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([207415, 256])
h_self size  torch.Size([207415, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.5381102561950684  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([207415, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.7359166145324707  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.5381102561950684  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([207415, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.7359166145324707  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.7853684425354004  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 207415
----------------output nodes number: 23854
----------------edges number: 583846
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.7870917320251465  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.7870917320251465  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8143696784973145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8143696784973145  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8185462951660156  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23854, 47])
h_self size  torch.Size([23854, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8185462951660156  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23854, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8227229118347168  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8185462951660156  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23854, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.81829833984375  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.8224754333496094  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.2740745544433594  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

pseudo mini batch 7 input nodes size: 699982
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.22036123275756836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.9061279296875 GB
    Memory Allocated: 0.22036123275756836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.48207998275756836  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.48225831985473633  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.2671961784362793  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.2882723808288574  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.2882723808288574  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

first layer input nodes number: 699982
first layer output nodes number: 230918
edges number: 2272831
----------------------------------------before model layer 0
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.29543018341064453  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([699982, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.29543018341064453  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.1678466796875 GB
    Memory Allocated: 0.29543018341064453  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.1717529296875 GB
    Memory Allocated: 0.3992490768432617  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.1717529296875 GB
    Memory Allocated: 0.3992490768432617  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.1717529296875 GB
    Memory Allocated: 0.6194696426391602  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([230918, 256])
h_self size  torch.Size([230918, 100])
----------------------------------------before rst
 Nvidia-smi: 12.1717529296875 GB
    Memory Allocated: 0.6194696426391602  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([230918, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.8401727676391602  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.6199522018432617  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([230918, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.8406553268432617  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.8952279090881348  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------input nodes number: 230918
----------------output nodes number: 23882
----------------edges number: 555874
----------------------------------------before mean aggregator
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.8971271514892578  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.8971271514892578  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9242229461669922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9242229461669922  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9284048080444336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

h_neigh size torch.Size([23882, 47])
h_self size  torch.Size([23882, 256])
----------------------------------------before rst
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9284048080444336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23882, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.932586669921875  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9284048080444336  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

torch.Size([23882, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9284100532531738  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.6131591796875 GB
    Memory Allocated: 0.9335460662841797  GigaBytes
Max Memory Allocated: 1.253903865814209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32530832290649414  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32530832290649414  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32530832290649414  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09211418032646179 |0.01822793483734131 |0.016859233379364014 |0.0001411139965057373 |0.003932148218154907 |0.002302885055541992 |
----------------------------------------------------------pseudo_mini_loss sum 1.6230922937393188
Total (block generation + training)time/epoch 58.01231038570404
Training time/epoch 1.0788748264312744
Training time without block to device /epoch 0.933051347732544
Training time without total dataloading part /epoch 0.16976284980773926
load block tensor time/epoch 0.7369134426116943
block to device time/epoch 0.14582347869873047
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5670697
Number of first layer input nodes during this epoch:  4077971
Number of first layer output nodes during this epoch:  1592726
----------------------------------------before generate dataloader block 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32530784606933594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2563035488128662
global_2_local spend time (sec) 0.42708301544189453

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.134 seconds
Metis partitioning: 12.820 seconds
Split the graph: 1.839 seconds
Construct subgraphs: 0.068 seconds
23863
24960
23942
25121
24012
24207
25273
25193
REG metis partition end ----................................
the time spent:  26.934597492218018
total k batches seeds list generation spend  27.630558013916016
after graph partition
graph partition algorithm spend time 28.312293767929077

partition_len_list
[180625, 197012, 173153, 182972, 189432, 207086, 224513, 218268]
REG selection method  spend 28.952747344970703
check_connections_block*********************************
time for parepare 1: 0.23517203330993652
local_output_nid generation: 0.006252288818359375
local_in_edges_tensor generation: 0.007103443145751953
mini_batch_src_global generation: 0.021255970001220703

&&&&&&&&&&&&&&& before remove duplicate length: 566609
r_  generation: 0.21717548370361328

local_output_nid generation: 0.007544517517089844
local_in_edges_tensor generation: 0.007031440734863281
mini_batch_src_global generation: 0.02939319610595703

&&&&&&&&&&&&&&& before remove duplicate length: 616684
r_  generation: 0.26243019104003906

local_output_nid generation: 0.007367134094238281
local_in_edges_tensor generation: 0.010777711868286133
mini_batch_src_global generation: 0.024172306060791016

&&&&&&&&&&&&&&& before remove duplicate length: 581918
r_  generation: 0.24042510986328125

local_output_nid generation: 0.007855653762817383
local_in_edges_tensor generation: 0.011578559875488281
mini_batch_src_global generation: 0.02796626091003418

&&&&&&&&&&&&&&& before remove duplicate length: 606504
r_  generation: 0.2688634395599365

local_output_nid generation: 0.0074024200439453125
local_in_edges_tensor generation: 0.00840306282043457
mini_batch_src_global generation: 0.027413606643676758

&&&&&&&&&&&&&&& before remove duplicate length: 569942
r_  generation: 0.2574453353881836

local_output_nid generation: 0.007516145706176758
local_in_edges_tensor generation: 0.009655475616455078
mini_batch_src_global generation: 0.026927471160888672

&&&&&&&&&&&&&&& before remove duplicate length: 567252
r_  generation: 0.2682480812072754

local_output_nid generation: 0.007718563079833984
local_in_edges_tensor generation: 0.007923603057861328
mini_batch_src_global generation: 0.030743837356567383

&&&&&&&&&&&&&&& before remove duplicate length: 628135
r_  generation: 0.30347752571105957

local_output_nid generation: 0.007657527923583984
local_in_edges_tensor generation: 0.02310490608215332
mini_batch_src_global generation: 0.03040289878845215

&&&&&&&&&&&&&&& before remove duplicate length: 626835
r_  generation: 0.3200521469116211


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7635626792907715
gen group dst list time:  0.058800697326660156
check_connections_block*********************************
time for parepare 1: 0.3886988162994385
local_output_nid generation: 0.043819427490234375
local_in_edges_tensor generation: 0.13040947914123535
mini_batch_src_global generation: 0.06037163734436035

&&&&&&&&&&&&&&& before remove duplicate length: 1748339
r_  generation: 0.7800962924957275

local_output_nid generation: 0.06148505210876465
local_in_edges_tensor generation: 0.07460880279541016
mini_batch_src_global generation: 0.08093404769897461

&&&&&&&&&&&&&&& before remove duplicate length: 1941125
r_  generation: 0.9509880542755127

local_output_nid generation: 0.06505608558654785
local_in_edges_tensor generation: 0.06270623207092285
mini_batch_src_global generation: 0.06447243690490723

&&&&&&&&&&&&&&& before remove duplicate length: 1674674
r_  generation: 0.795680046081543

local_output_nid generation: 0.049410104751586914
local_in_edges_tensor generation: 0.05272793769836426
mini_batch_src_global generation: 0.06735897064208984

&&&&&&&&&&&&&&& before remove duplicate length: 1741470
r_  generation: 0.8555948734283447

local_output_nid generation: 0.05292177200317383
local_in_edges_tensor generation: 0.0637674331665039
mini_batch_src_global generation: 0.07635307312011719

&&&&&&&&&&&&&&& before remove duplicate length: 1840895
r_  generation: 0.911400318145752

local_output_nid generation: 0.057352304458618164
local_in_edges_tensor generation: 0.06605172157287598
mini_batch_src_global generation: 0.09870576858520508

&&&&&&&&&&&&&&& before remove duplicate length: 2038233
r_  generation: 1.0863831043243408

local_output_nid generation: 0.09802508354187012
local_in_edges_tensor generation: 0.10905766487121582
mini_batch_src_global generation: 0.09339618682861328

&&&&&&&&&&&&&&& before remove duplicate length: 2219973
r_  generation: 1.107318639755249

local_output_nid generation: 0.05977916717529297
local_in_edges_tensor generation: 0.05455279350280762
mini_batch_src_global generation: 0.0925893783569336

&&&&&&&&&&&&&&& before remove duplicate length: 2160890
r_  generation: 1.0834629535675049


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32530784606933594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

connection checking time:  14.422975063323975
block generation total time  12.654415130615234
average batch blocks generation time:  1.5818018913269043
block dataloader generation time/epoch 57.30666470527649
pseudo mini batch 0 input nodes size: 487283
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2672004699707031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2672004699707031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4487276077270508  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.44890546798706055  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18700838088989258  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2047443389892578  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2047443389892578  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 487283
first layer output nodes number: 180625
edges number: 1748339
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20987987518310547  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([487283, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20987987518310547  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20987987518310547  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.29086780548095703  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.29086780548095703  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.46312522888183594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([180625, 256])
h_self size  torch.Size([180625, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.46312522888183594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([180625, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6353826522827148  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.46312522888183594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([180625, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6353826522827148  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6784472465515137  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 180625
----------------output nodes number: 23863
----------------edges number: 566609
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6805338859558105  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6805338859558105  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7076916694641113  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7076916694641113  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7126688957214355  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([23863, 47])
h_self size  torch.Size([23863, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7126688957214355  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([23863, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7168474197387695  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7118701934814453  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([23863, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7118668556213379  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7168002128601074  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.23546838760375977  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 1 input nodes size: 482007
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18700599670410156  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18700599670410156  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.36656761169433594  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.36675357818603516  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18504858016967773  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20410680770874023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20410680770874023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 482007
first layer output nodes number: 197012
edges number: 1941125
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2095775604248047  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([482007, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2095775604248047  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2095775604248047  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2981681823730469  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2981681823730469  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.486053466796875  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([197012, 256])
h_self size  torch.Size([197012, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.486053466796875  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([197012, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6739387512207031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.486053466796875  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([197012, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6739387512207031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7209100723266602  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 197012
----------------output nodes number: 24960
----------------edges number: 616684
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7225642204284668  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7225642204284668  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7511491775512695  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7511491775512695  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7555193901062012  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([24960, 47])
h_self size  torch.Size([24960, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7555193901062012  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24960, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7598896026611328  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7555193901062012  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24960, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7557110786437988  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7600817680358887  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2368454933166504  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 2 input nodes size: 443928
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1852402687072754  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1852402687072754  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.350616455078125  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.35079526901245117  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.17104768753051758  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18849468231201172  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.18849468231201172  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 443928
first layer output nodes number: 173153
edges number: 1674674
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.19385290145874023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([443928, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.19385290145874023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.19385290145874023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2714805603027344  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2714805603027344  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4366121292114258  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([173153, 256])
h_self size  torch.Size([173153, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4366121292114258  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([173153, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6017436981201172  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4366121292114258  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([173153, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6017436981201172  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6430268287658691  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 173153
----------------output nodes number: 23942
----------------edges number: 581918
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6447277069091797  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6447277069091797  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6720762252807617  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6720762252807617  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6762685775756836  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([23942, 47])
h_self size  torch.Size([23942, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6762685775756836  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([23942, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6804609298706055  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6762685775756836  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([23942, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6760907173156738  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6802835464477539  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.21849918365478516  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 3 input nodes size: 422954
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1708698272705078  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1708698272705078  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.328432559967041  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32861995697021484  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.16306495666503906  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1809854507446289  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1809854507446289  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 422954
first layer output nodes number: 182972
edges number: 1741470
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1855001449584961  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([422954, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1855001449584961  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.1855001449584961  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2673201560974121  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2673201560974121  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4418158531188965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([182972, 256])
h_self size  torch.Size([182972, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4418158531188965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([182972, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6163115501403809  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4418158531188965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([182972, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6163115501403809  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.659935474395752  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 182972
----------------output nodes number: 25121
----------------edges number: 606504
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6614861488342285  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6614861488342285  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6906309127807617  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6906309127807617  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6952533721923828  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([25121, 47])
h_self size  torch.Size([25121, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6952533721923828  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25121, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6996521949768066  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6950297355651855  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25121, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6954598426818848  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7001447677612305  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.21143341064453125  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 4 input nodes size: 540361
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.16349506378173828  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.16349506378173828  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.3647956848144531  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.3649749755859375  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20722484588623047  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2251873016357422  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2251873016357422  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 540361
first layer output nodes number: 189432
edges number: 1840895
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.23123502731323242  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([540361, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.23123502731323242  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.23123502731323242  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.316225528717041  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.316225528717041  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.49688196182250977  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([189432, 256])
h_self size  torch.Size([189432, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.49688196182250977  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([189432, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6775383949279785  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.49688196182250977  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([189432, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.6775383949279785  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7227025032043457  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 189432
----------------output nodes number: 24012
----------------edges number: 569942
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7245783805847168  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7245783805847168  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7525477409362793  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7525477409362793  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7572884559631348  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([24012, 47])
h_self size  torch.Size([24012, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7572884559631348  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24012, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7614927291870117  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7567520141601562  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24012, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7568702697753906  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7614932060241699  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2582268714904785  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 5 input nodes size: 579867
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20734310150146484  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20734310150146484  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.42413997650146484  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.42432069778442383  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2228407859802246  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.24225378036499023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.24225378036499023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 579867
first layer output nodes number: 207086
edges number: 2038233
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.24817228317260742  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([579867, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.24817228317260742  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.24817228317260742  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.341275691986084  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.341275691986084  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5387682914733887  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([207086, 256])
h_self size  torch.Size([207086, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5387682914733887  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([207086, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7362608909606934  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5387682914733887  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([207086, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7362608909606934  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7856340408325195  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 207086
----------------output nodes number: 24207
----------------edges number: 567252
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7873578071594238  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7873578071594238  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8148741722106934  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8148741722106934  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8192191123962402  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([24207, 47])
h_self size  torch.Size([24207, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8192191123962402  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24207, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8234577178955078  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8191127777099609  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([24207, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.818610668182373  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8229560852050781  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.274808406829834  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 6 input nodes size: 524617
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22233867645263672  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22233867645263672  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.4177742004394531  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.41796255111694336  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.20098495483398438  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22220611572265625  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22220611572265625  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 524617
first layer output nodes number: 224513
edges number: 2219973
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22778844833374023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([524617, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22778844833374023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22778844833374023  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32880353927612305  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.32880353927612305  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.543647289276123  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([224513, 256])
h_self size  torch.Size([224513, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.543647289276123  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([224513, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7577595710754395  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5429158210754395  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([224513, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7577595710754395  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8112878799438477  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 224513
----------------output nodes number: 25273
----------------edges number: 628135
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8131494522094727  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8131494522094727  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8421211242675781  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8421211242675781  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8465461730957031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([25273, 47])
h_self size  torch.Size([25273, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8465461730957031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25273, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8509712219238281  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8465461730957031  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25273, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8467326164245605  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8511581420898438  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2578401565551758  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

pseudo mini batch 7 input nodes size: 522496
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2011713981628418  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2011713981628418  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.3958163261413574  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.39600419998168945  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2003803253173828  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22137165069580078  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22137165069580078  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

first layer input nodes number: 522496
first layer output nodes number: 218268
edges number: 2160890
----------------------------------------before model layer 0
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22712039947509766  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([522496, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22712039947509766  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.22712039947509766  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.3253450393676758  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.3253450393676758  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5335016250610352  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([218268, 256])
h_self size  torch.Size([218268, 100])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5335016250610352  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([218268, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7416582107543945  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.5335016250610352  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([218268, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7416582107543945  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7936973571777344  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------input nodes number: 218268
----------------output nodes number: 25193
----------------edges number: 626835
----------------------------------------before mean aggregator
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7955117225646973  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.7955117225646973  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8244595527648926  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8244595527648926  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8288707733154297  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

h_neigh size torch.Size([25193, 47])
h_self size  torch.Size([25193, 256])
----------------------------------------before rst
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8288707733154297  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25193, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8332819938659668  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8288707733154297  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

torch.Size([25193, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.8288569450378418  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.833282470703125  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2561469078063965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2561469078063965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.8397216796875 GB
    Memory Allocated: 0.2561469078063965  GigaBytes
Max Memory Allocated: 1.3487176895141602  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08291366696357727 |0.0158541202545166 |0.01673227548599243 |0.00014215707778930664 |0.002878546714782715 |0.0010781288146972656 |
----------------------------------------------------------pseudo_mini_loss sum 1.459796667098999
Total (block generation + training)time/epoch 58.310329357783
Training time/epoch 0.9843916893005371
Training time without block to device /epoch 0.8575587272644043
Training time without total dataloading part /epoch 0.1591019630432129
load block tensor time/epoch 0.6633093357086182
block to device time/epoch 0.1268329620361328
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5576574
Number of first layer input nodes during this epoch:  4003513
Number of first layer output nodes during this epoch:  1573061
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
