main start at this time 1660334025.9598117
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20169782638549805
global_2_local spend time (sec) 0.3738999366760254

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.977 seconds
Metis partitioning: 11.132 seconds
Split the graph: 5.455 seconds
Construct subgraphs: 0.052 seconds
98922
97649
REG metis partition end ----................................
the time spent:  28.56424570083618
total k batches seeds list generation spend  29.219263076782227
after graph partition
graph partition algorithm spend time 30.01247525215149

partition_len_list
[620441, 662466]
REG selection method  spend 30.547459363937378
check_connections_block*********************************
time for parepare 1: 0.23892998695373535
local_output_nid generation: 0.013178825378417969
local_in_edges_tensor generation: 0.028498172760009766
mini_batch_src_global generation: 0.07752728462219238

&&&&&&&&&&&&&&& before remove duplicate length: 2397756
r_  generation: 1.0928080081939697

local_output_nid generation: 0.015872955322265625
local_in_edges_tensor generation: 0.07833671569824219
mini_batch_src_global generation: 0.10033416748046875

&&&&&&&&&&&&&&& before remove duplicate length: 2366123
r_  generation: 1.1513471603393555


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6521916389465332
gen group dst list time:  0.03670787811279297
check_connections_block*********************************
time for parepare 1: 0.36982297897338867
local_output_nid generation: 0.10229706764221191
local_in_edges_tensor generation: 0.233781099319458
mini_batch_src_global generation: 0.19120335578918457

&&&&&&&&&&&&&&& before remove duplicate length: 5978043
r_  generation: 3.0105464458465576

local_output_nid generation: 0.12328219413757324
local_in_edges_tensor generation: 0.17562437057495117
mini_batch_src_global generation: 0.25167274475097656

&&&&&&&&&&&&&&& before remove duplicate length: 6493308
r_  generation: 3.4037582874298096


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

connection checking time:  12.20808219909668
block generation total time  12.635931730270386
average batch blocks generation time:  6.317965865135193
pseudo mini batch 0 input nodes size: 1113587
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.41512393951416016  GigaBytes
Max Memory Allocated: 0.41512393951416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.4158611297607422  GigaBytes
Max Memory Allocated: 0.4158611297607422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.4940185546875 GB
    Memory Allocated: 0.4158611297607422  GigaBytes
Max Memory Allocated: 0.4158611297607422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6248779296875 GB
    Memory Allocated: 0.47826671600341797  GigaBytes
Max Memory Allocated: 0.47826671600341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6248779296875 GB
    Memory Allocated: 0.47826671600341797  GigaBytes
Max Memory Allocated: 0.47826671600341797  GigaBytes

first layer input nodes number: 1113587
first layer output nodes number: 620441
edges number: 5978043
----------------------------------------before model layer 0
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49118661880493164  GigaBytes
Max Memory Allocated: 0.5134568214416504  GigaBytes

torch.Size([1113587, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49118661880493164  GigaBytes
Max Memory Allocated: 0.5134568214416504  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.49118661880493164  GigaBytes
Max Memory Allocated: 0.5134568214416504  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 0.7691712379455566  GigaBytes
Max Memory Allocated: 1.0026154518127441  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 0.7691712379455566  GigaBytes
Max Memory Allocated: 1.0026154518127441  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 1.3609681129455566  GigaBytes
Max Memory Allocated: 1.3609681129455566  GigaBytes

h_neigh size torch.Size([620441, 256])
h_self size  torch.Size([620441, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 1.3609681129455566  GigaBytes
Max Memory Allocated: 1.3609681129455566  GigaBytes

torch.Size([620441, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 1.9527649879455566  GigaBytes
Max Memory Allocated: 2.5445618629455566  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 1.3609681129455566  GigaBytes
Max Memory Allocated: 2.5445618629455566  GigaBytes

torch.Size([620441, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 1.9527649879455566  GigaBytes
Max Memory Allocated: 2.5445618629455566  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 2.1006898880004883  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------input nodes number: 620441
----------------output nodes number: 98922
----------------edges number: 2397756
----------------------------------------before mean aggregator
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 2.1060500144958496  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.5057373046875 GB
    Memory Allocated: 2.1060500144958496  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2199411392211914  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2199411392211914  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2372612953186035  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

h_neigh size torch.Size([98922, 47])
h_self size  torch.Size([98922, 256])
----------------------------------------before rst
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2372612953186035  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

torch.Size([98922, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2545814514160156  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2372612953186035  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

torch.Size([98922, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.2545814514160156  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5076904296875 GB
    Memory Allocated: 2.271902561187744  GigaBytes
Max Memory Allocated: 2.6924867630004883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.6003603935241699  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

pseudo mini batch 1 input nodes size: 1163585
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.43346261978149414  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.43346261978149414  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.8669319152832031  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.8676595687866211  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.45207881927490234  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.5180873870849609  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.5180873870849609  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

first layer input nodes number: 1163585
first layer output nodes number: 662466
edges number: 6493308
----------------------------------------before model layer 0
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.5316934585571289  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

torch.Size([1163585, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.5316934585571289  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.7186279296875 GB
    Memory Allocated: 0.5316934585571289  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 0.8293285369873047  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 0.8293285369873047  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.3670654296875 GB
    Memory Allocated: 1.4611053466796875  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

h_neigh size torch.Size([662466, 256])
h_self size  torch.Size([662466, 100])
----------------------------------------before rst
 Nvidia-smi: 12.3670654296875 GB
    Memory Allocated: 1.4611053466796875  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

torch.Size([662466, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.0928821563720703  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 1.4611053466796875  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

torch.Size([662466, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.0928821563720703  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.250826358795166  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------input nodes number: 662466
----------------output nodes number: 97649
----------------edges number: 2366123
----------------------------------------before mean aggregator
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.2564902305603027  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.2564902305603027  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.3679728507995605  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.3679728507995605  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.385070323944092  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

h_neigh size torch.Size([97649, 47])
h_self size  torch.Size([97649, 256])
----------------------------------------before rst
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.385070323944092  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

torch.Size([97649, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.402167797088623  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.385070323944092  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

torch.Size([97649, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.384847640991211  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.6326904296875 GB
    Memory Allocated: 2.4019455909729004  GigaBytes
Max Memory Allocated: 3.346414566040039  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.6268644332885742  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.6274251937866211  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.6274251937866211  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.17413413524627686 |0.2165241241455078 |0.4133484363555908 |0.00022470951080322266 |0.02171158790588379 |0.0031936168670654297 |
----------------------------------------------------------pseudo_mini_loss sum 6.264422416687012
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3560079
Number of first layer input nodes during this epoch:  2277172
Number of first layer output nodes during this epoch:  1282907
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.6274247169494629  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.26038098335266113
global_2_local spend time (sec) 0.3689596652984619

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.286 seconds
Metis partitioning: 11.913 seconds
Split the graph: 6.064 seconds
Construct subgraphs: 0.059 seconds
97380
99191
REG metis partition end ----................................
the time spent:  30.611210107803345
total k batches seeds list generation spend  31.280282497406006
after graph partition
graph partition algorithm spend time 32.04724979400635

partition_len_list
[605958, 674519]
REG selection method  spend 32.563958168029785
check_connections_block*********************************
time for parepare 1: 0.21717095375061035
local_output_nid generation: 0.013017654418945312
local_in_edges_tensor generation: 0.041205644607543945
mini_batch_src_global generation: 0.0694572925567627

&&&&&&&&&&&&&&& before remove duplicate length: 2358815
r_  generation: 1.0516026020050049

local_output_nid generation: 0.01592564582824707
local_in_edges_tensor generation: 0.07174897193908691
mini_batch_src_global generation: 0.1129612922668457

&&&&&&&&&&&&&&& before remove duplicate length: 2405064
r_  generation: 1.131972074508667


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7071325778961182
gen group dst list time:  0.037278175354003906
check_connections_block*********************************
time for parepare 1: 0.3560209274291992
local_output_nid generation: 0.09967947006225586
local_in_edges_tensor generation: 0.2362816333770752
mini_batch_src_global generation: 0.1822829246520996

&&&&&&&&&&&&&&& before remove duplicate length: 5835084
r_  generation: 2.8763558864593506

local_output_nid generation: 0.1277170181274414
local_in_edges_tensor generation: 0.2278602123260498
mini_batch_src_global generation: 0.2888307571411133

&&&&&&&&&&&&&&& before remove duplicate length: 6614524
r_  generation: 3.3955376148223877


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.6274247169494629  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

connection checking time:  12.06827998161316
block generation total time  11.397034883499146
average batch blocks generation time:  5.698517441749573
pseudo mini batch 0 input nodes size: 1087123
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.45241594314575195  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.45241594314575195  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.8574008941650391  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.8581266403198242  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.42392969131469727  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.48498010635375977  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.48498010635375977  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

first layer input nodes number: 1087123
first layer output nodes number: 605958
edges number: 5835084
----------------------------------------before model layer 0
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.49759531021118164  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([1087123, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.49759531021118164  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.49759531021118164  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.7694511413574219  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 0.7694511413574219  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 1.3473377227783203  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

h_neigh size torch.Size([605958, 256])
h_self size  torch.Size([605958, 100])
----------------------------------------before rst
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 1.3473377227783203  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([605958, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 1.9252243041992188  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 1.3473377227783203  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([605958, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 1.9252243041992188  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 2.0696959495544434  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------input nodes number: 605958
----------------output nodes number: 97380
----------------edges number: 2358815
----------------------------------------before mean aggregator
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 2.074936866760254  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.3065185546875 GB
    Memory Allocated: 2.074936866760254  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.1861066818237305  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.1861066818237305  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.2031569480895996  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

h_neigh size torch.Size([97380, 47])
h_self size  torch.Size([97380, 256])
----------------------------------------before rst
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.2031569480895996  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([97380, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.2202072143554688  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.2031569480895996  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([97380, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.2031097412109375  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 2.220160961151123  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5866799354553223  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

pseudo mini batch 1 input nodes size: 1178370
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.42388343811035156  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.42388343811035156  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.8628606796264648  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.8635997772216797  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.4578890800476074  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5250906944274902  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5250906944274902  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

first layer input nodes number: 1178370
first layer output nodes number: 674519
edges number: 6614524
----------------------------------------before model layer 0
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5388965606689453  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([1178370, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5388965606689453  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 0.5388965606689453  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.3123779296875 GB
    Memory Allocated: 0.8419694900512695  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.3123779296875 GB
    Memory Allocated: 0.8419694900512695  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.9569091796875 GB
    Memory Allocated: 1.4852409362792969  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

h_neigh size torch.Size([674519, 256])
h_self size  torch.Size([674519, 100])
----------------------------------------before rst
 Nvidia-smi: 14.9569091796875 GB
    Memory Allocated: 1.4852409362792969  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([674519, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.128512382507324  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 1.4852409362792969  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([674519, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.128512382507324  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.28933048248291  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------input nodes number: 674519
----------------output nodes number: 99191
----------------edges number: 2405064
----------------------------------------before mean aggregator
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.295095443725586  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.295095443725586  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.4083499908447266  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.4083499908447266  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.425717353820801  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

h_neigh size torch.Size([99191, 47])
h_self size  torch.Size([99191, 256])
----------------------------------------before rst
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.425717353820801  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([99191, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.443084716796875  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.425717353820801  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

torch.Size([99191, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.426034450531006  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2459716796875 GB
    Memory Allocated: 2.4434022903442383  GigaBytes
Max Memory Allocated: 3.558704376220703  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6358957290649414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6358957290649414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6358957290649414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14510774612426758 |0.04271209239959717 |0.04066824913024902 |0.00016951560974121094 |0.012179851531982422 |0.002299785614013672 |
----------------------------------------------------------pseudo_mini_loss sum 3.410747528076172
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  3545970
Number of first layer input nodes during this epoch:  2265493
Number of first layer output nodes during this epoch:  1280477
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6358952522277832  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2854928970336914
global_2_local spend time (sec) 0.40951037406921387

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.433 seconds
Metis partitioning: 11.739 seconds
Split the graph: 6.356 seconds
Construct subgraphs: 0.060 seconds
96338
100233
REG metis partition end ----................................
the time spent:  30.633848667144775
total k batches seeds list generation spend  31.26978087425232
after graph partition
graph partition algorithm spend time 32.05099964141846

partition_len_list
[653229, 630702]
REG selection method  spend 32.63259243965149
check_connections_block*********************************
time for parepare 1: 0.22514820098876953
local_output_nid generation: 0.013525009155273438
local_in_edges_tensor generation: 0.02271103858947754
mini_batch_src_global generation: 0.06901955604553223

&&&&&&&&&&&&&&& before remove duplicate length: 2332879
r_  generation: 1.019118070602417

local_output_nid generation: 0.015857219696044922
local_in_edges_tensor generation: 0.05482840538024902
mini_batch_src_global generation: 0.09719634056091309

&&&&&&&&&&&&&&& before remove duplicate length: 2431000
r_  generation: 1.2134153842926025


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.9095871448516846
gen group dst list time:  0.03620171546936035
check_connections_block*********************************
time for parepare 1: 0.39335107803344727
local_output_nid generation: 0.11271786689758301
local_in_edges_tensor generation: 0.21552467346191406
mini_batch_src_global generation: 0.20301508903503418

&&&&&&&&&&&&&&& before remove duplicate length: 6402027
r_  generation: 3.296908140182495

local_output_nid generation: 0.12393641471862793
local_in_edges_tensor generation: 0.17238664627075195
mini_batch_src_global generation: 0.23898959159851074

&&&&&&&&&&&&&&& before remove duplicate length: 6080149
r_  generation: 3.2656311988830566


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6358952522277832  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

connection checking time:  12.282669305801392
block generation total time  11.10108757019043
average batch blocks generation time:  5.550543785095215
block dataloader generation time/epoch 58.06458401679993
pseudo mini batch 0 input nodes size: 1153044
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4582052230834961  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4582052230834961  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8877477645874023  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8884658813476562  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4487495422363281  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5146217346191406  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5146217346191406  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

first layer input nodes number: 1153044
first layer output nodes number: 653229
edges number: 6402027
----------------------------------------before model layer 0
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5280799865722656  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([1153044, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5280799865722656  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5280799865722656  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8220396041870117  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8220396041870117  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.44500732421875  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([653229, 256])
h_self size  torch.Size([653229, 100])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.44500732421875  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([653229, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.0679750442504883  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.44500732421875  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([653229, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.0679750442504883  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.223717212677002  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------input nodes number: 653229
----------------output nodes number: 96338
----------------edges number: 2332879
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.229302406311035  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.229302406311035  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3392772674560547  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3392772674560547  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3561453819274902  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([96338, 47])
h_self size  torch.Size([96338, 256])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3561453819274902  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([96338, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.373013496398926  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3561453819274902  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([96338, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3556461334228516  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.373014450073242  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.621335506439209  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

pseudo mini batch 1 input nodes size: 1125298
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.44825124740600586  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.44825124740600586  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8674578666687012  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8682050704956055  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4379444122314453  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

first layer input nodes number: 1125298
first layer output nodes number: 630702
edges number: 6080149
----------------------------------------before model layer 0
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5160160064697266  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([1125298, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5160160064697266  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5160160064697266  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8001956939697266  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8001956939697266  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.4016799926757812  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([630702, 256])
h_self size  torch.Size([630702, 100])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.4016799926757812  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([630702, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.003164291381836  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.4016799926757812  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([630702, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.003164291381836  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1535353660583496  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------input nodes number: 630702
----------------output nodes number: 100233
----------------edges number: 2431000
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1589818000793457  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1589818000793457  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2734322547912598  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2734322547912598  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2915449142456055  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([100233, 47])
h_self size  torch.Size([100233, 256])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2915449142456055  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([100233, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.3090949058532715  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.290982246398926  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([100233, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.292226791381836  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.30977725982666  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6108818054199219  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6108818054199219  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6108818054199219  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1721268892288208 |0.0483851432800293 |0.038113951683044434 |0.00016820430755615234 |0.0028113126754760742 |0.0011303424835205078 |
----------------------------------------------------------pseudo_mini_loss sum 2.04215145111084
Total (block generation + training)time/epoch 58.635205030441284
Training time/epoch 0.5703706741333008
Training time without block to device /epoch 0.4736003875732422
Training time without total dataloading part /epoch 0.08331727981567383
load block tensor time/epoch 0.3442537784576416
block to device time/epoch 0.0967702865600586
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  3562273
Number of first layer input nodes during this epoch:  2278342
Number of first layer output nodes during this epoch:  1283931
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6108813285827637  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3457224369049072
global_2_local spend time (sec) 0.40602731704711914

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.976 seconds
Metis partitioning: 11.856 seconds
Split the graph: 6.097 seconds
Construct subgraphs: 0.064 seconds
96935
99636
REG metis partition end ----................................
the time spent:  30.46188497543335
total k batches seeds list generation spend  31.128841638565063
after graph partition
graph partition algorithm spend time 31.90723705291748

partition_len_list
[608520, 677474]
REG selection method  spend 32.491950273513794
check_connections_block*********************************
time for parepare 1: 0.21498656272888184
local_output_nid generation: 0.013829231262207031
local_in_edges_tensor generation: 0.02071857452392578
mini_batch_src_global generation: 0.08185935020446777

&&&&&&&&&&&&&&& before remove duplicate length: 2333017
r_  generation: 1.088879108428955

local_output_nid generation: 0.017027616500854492
local_in_edges_tensor generation: 0.06110215187072754
mini_batch_src_global generation: 0.10370826721191406

&&&&&&&&&&&&&&& before remove duplicate length: 2430862
r_  generation: 1.245056390762329


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8497118949890137
gen group dst list time:  0.05361533164978027
check_connections_block*********************************
time for parepare 1: 0.40290403366088867
local_output_nid generation: 0.10675692558288574
local_in_edges_tensor generation: 0.22048473358154297
mini_batch_src_global generation: 0.1897566318511963

&&&&&&&&&&&&&&& before remove duplicate length: 5835106
r_  generation: 2.9804635047912598

local_output_nid generation: 0.16158270835876465
local_in_edges_tensor generation: 0.1872713565826416
mini_batch_src_global generation: 0.25690627098083496

&&&&&&&&&&&&&&& before remove duplicate length: 6667583
r_  generation: 3.620612144470215


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6108813285827637  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

connection checking time:  12.700831413269043
block generation total time  12.09162425994873
average batch blocks generation time:  6.045812129974365
block dataloader generation time/epoch 58.7377405166626
pseudo mini batch 0 input nodes size: 1148678
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.43918800354003906  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.43918800354003906  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8671040534973145  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8678264617919922  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4478726387023926  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.508730411529541  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.508730411529541  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

first layer input nodes number: 1148678
first layer output nodes number: 608520
edges number: 5835106
----------------------------------------before model layer 0
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5218234062194824  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([1148678, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5218234062194824  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5218234062194824  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.7942714691162109  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.7942714691162109  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.3746013641357422  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([608520, 256])
h_self size  torch.Size([608520, 100])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.3746013641357422  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([608520, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.9549312591552734  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.3746013641357422  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([608520, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 1.9549312591552734  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1000137329101562  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------input nodes number: 608520
----------------output nodes number: 96935
----------------edges number: 2333017
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1052703857421875  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.1052703857421875  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2158203125  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2158203125  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.232792854309082  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([96935, 47])
h_self size  torch.Size([96935, 256])
----------------------------------------before rst
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.232792854309082  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([96935, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.249765396118164  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.232792854309082  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([96935, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.2316527366638184  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 2.248626232147217  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.6095995903015137  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

pseudo mini batch 1 input nodes size: 1153385
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4467334747314453  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.4467334747314453  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8764033317565918  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.8771457672119141  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.44850730895996094  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5162973403930664  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5162973403930664  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

first layer input nodes number: 1153385
first layer output nodes number: 677474
edges number: 6667583
----------------------------------------before model layer 0
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5299386978149414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([1153385, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5299386978149414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.5299386978149414  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 16.9041748046875 GB
    Memory Allocated: 0.8345193862915039  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 16.9041748046875 GB
    Memory Allocated: 0.8345193862915039  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 17.5506591796875 GB
    Memory Allocated: 1.481003761291504  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([677474, 256])
h_self size  torch.Size([677474, 100])
----------------------------------------before rst
 Nvidia-smi: 17.5506591796875 GB
    Memory Allocated: 1.481003761291504  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([677474, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.127488136291504  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 1.481003761291504  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([677474, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.127488136291504  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.289010524749756  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------input nodes number: 677474
----------------output nodes number: 99636
----------------edges number: 2430862
----------------------------------------before mean aggregator
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.2948007583618164  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.2948007583618164  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.4086761474609375  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.4086761474609375  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.426121711730957  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

h_neigh size torch.Size([99636, 47])
h_self size  torch.Size([99636, 256])
----------------------------------------before rst
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.426121711730957  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([99636, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.4435672760009766  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.426121711730957  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

torch.Size([99636, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.4265947341918945  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.8436279296875 GB
    Memory Allocated: 2.4440407752990723  GigaBytes
Max Memory Allocated: 3.6210780143737793  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6276369094848633  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6276369094848633  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6276369094848633  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14887285232543945 |0.047354698181152344 |0.04025673866271973 |0.00016891956329345703 |0.01204073429107666 |0.002302408218383789 |
----------------------------------------------------------pseudo_mini_loss sum 1.6207382678985596
Total (block generation + training)time/epoch 59.289034962654114
Training time/epoch 0.5317122936248779
Training time without block to device /epoch 0.43700289726257324
Training time without total dataloading part /epoch 0.10723519325256348
load block tensor time/epoch 0.2977457046508789
block to device time/epoch 0.09470939636230469
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  3588057
Number of first layer input nodes during this epoch:  2302063
Number of first layer output nodes during this epoch:  1285994
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6276364326477051  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.23634839057922363
global_2_local spend time (sec) 0.41359710693359375

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.200 seconds
Metis partitioning: 11.771 seconds
Split the graph: 5.916 seconds
Construct subgraphs: 0.054 seconds
99100
97471
REG metis partition end ----................................
the time spent:  30.197179794311523
total k batches seeds list generation spend  30.861833572387695
after graph partition
graph partition algorithm spend time 31.68880343437195

partition_len_list
[615957, 662763]
REG selection method  spend 32.28998589515686
check_connections_block*********************************
time for parepare 1: 0.23292040824890137
local_output_nid generation: 0.014141321182250977
local_in_edges_tensor generation: 0.023015499114990234
mini_batch_src_global generation: 0.10369610786437988

&&&&&&&&&&&&&&& before remove duplicate length: 2402576
r_  generation: 1.0857324600219727

local_output_nid generation: 0.01604437828063965
local_in_edges_tensor generation: 0.044756174087524414
mini_batch_src_global generation: 0.09729814529418945

&&&&&&&&&&&&&&& before remove duplicate length: 2361303
r_  generation: 1.2082161903381348


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7523181438446045
gen group dst list time:  0.039129018783569336
check_connections_block*********************************
time for parepare 1: 0.3588745594024658
local_output_nid generation: 0.10260701179504395
local_in_edges_tensor generation: 0.22848272323608398
mini_batch_src_global generation: 0.1983327865600586

&&&&&&&&&&&&&&& before remove duplicate length: 5931734
r_  generation: 3.1064798831939697

local_output_nid generation: 0.15636944770812988
local_in_edges_tensor generation: 0.21889066696166992
mini_batch_src_global generation: 0.24999403953552246

&&&&&&&&&&&&&&& before remove duplicate length: 6497959
r_  generation: 3.5392158031463623


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6276364326477051  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

connection checking time:  12.655397415161133
block generation total time  11.903552532196045
average batch blocks generation time:  5.9517762660980225
block dataloader generation time/epoch 58.73546806971232
pseudo mini batch 0 input nodes size: 1100827
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.44897937774658203  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.44897937774658203  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.85906982421875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.8598084449768066  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.4293961524963379  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.49149274826049805  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.49149274826049805  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

first layer input nodes number: 1100827
first layer output nodes number: 615957
edges number: 5931734
----------------------------------------before model layer 0
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5042843818664551  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([1100827, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5042843818664551  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5042843818664551  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.7805790901184082  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.7805790901184082  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.3680014610290527  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

h_neigh size torch.Size([615957, 256])
h_self size  torch.Size([615957, 100])
----------------------------------------before rst
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.3680014610290527  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([615957, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.9554238319396973  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.3680014610290527  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([615957, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.9554238319396973  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.1022796630859375  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------input nodes number: 615957
----------------output nodes number: 99100
----------------edges number: 2402576
----------------------------------------before mean aggregator
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.107607841491699  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.107607841491699  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.220757484436035  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.220757484436035  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.2381091117858887  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

h_neigh size torch.Size([99100, 47])
h_self size  torch.Size([99100, 256])
----------------------------------------before rst
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.2381091117858887  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([99100, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.255460739135742  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.2381091117858887  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([99100, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.2380151748657227  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.2553677558898926  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5954842567443848  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

pseudo mini batch 1 input nodes size: 1155842
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.4293031692504883  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.4293031692504883  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.8598880767822266  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.8606142997741699  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.4497852325439453  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5157928466796875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5157928466796875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

first layer input nodes number: 1155842
first layer output nodes number: 662763
edges number: 6497959
----------------------------------------before model layer 0
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5293431282043457  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([1155842, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5293431282043457  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.5293431282043457  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.8280191421508789  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.8280191421508789  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.460831642150879  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

h_neigh size torch.Size([662763, 256])
h_self size  torch.Size([662763, 100])
----------------------------------------before rst
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.460831642150879  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([662763, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.093644142150879  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 1.460831642150879  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([662763, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.093644142150879  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.251659393310547  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------input nodes number: 662763
----------------output nodes number: 97471
----------------edges number: 2361303
----------------------------------------before mean aggregator
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.257323741912842  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.257323741912842  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.3685994148254395  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.3685994148254395  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.3856658935546875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

h_neigh size torch.Size([97471, 47])
h_self size  torch.Size([97471, 256])
----------------------------------------before rst
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.3856658935546875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([97471, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.4027323722839355  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.3856658935546875  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

torch.Size([97471, 47])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.385380744934082  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 2.4027328491210938  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6251711845397949  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6251711845397949  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.4920654296875 GB
    Memory Allocated: 0.6251711845397949  GigaBytes
Max Memory Allocated: 3.627476215362549  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14920461177825928 |0.037226080894470215 |0.03845620155334473 |0.00016701221466064453 |0.003463268280029297 |0.0011301040649414062 |
----------------------------------------------------------pseudo_mini_loss sum 1.4537994861602783
Total (block generation + training)time/epoch 59.271817127863564
Training time/epoch 0.5062105655670166
Training time without block to device /epoch 0.43175840377807617
Training time without total dataloading part /epoch 0.08530306816101074
load block tensor time/epoch 0.29840922355651855
block to device time/epoch 0.07445216178894043
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  3535389
Number of first layer input nodes during this epoch:  2256669
Number of first layer output nodes during this epoch:  1278720
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  75264
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
