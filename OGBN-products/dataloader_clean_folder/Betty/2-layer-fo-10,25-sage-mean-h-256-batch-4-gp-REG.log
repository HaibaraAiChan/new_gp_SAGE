main start at this time 1660331600.097622
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2506380081176758
global_2_local spend time (sec) 0.38381147384643555

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.959 seconds
Metis partitioning: 11.724 seconds
Split the graph: 3.557 seconds
Construct subgraphs: 0.067 seconds
50510
48924
48041
49096
REG metis partition end ----................................
the time spent:  27.803800582885742
total k batches seeds list generation spend  28.4782452583313
after graph partition
graph partition algorithm spend time 29.209521293640137

partition_len_list
[343245, 319005, 378227, 358497]
REG selection method  spend 29.76579999923706
check_connections_block*********************************
time for parepare 1: 0.23834919929504395
local_output_nid generation: 0.008461952209472656
local_in_edges_tensor generation: 0.015051126480102539
mini_batch_src_global generation: 0.040839195251464844

&&&&&&&&&&&&&&& before remove duplicate length: 1228913
&&&&&&&&&&&&&&& after remove duplicate length: 340744

remove duplicate: 0.25066208839416504
r_  generation: 0.19971895217895508

local_output_nid generation: 0.009899139404296875
local_in_edges_tensor generation: 0.021860361099243164
mini_batch_src_global generation: 0.03660225868225098

&&&&&&&&&&&&&&& before remove duplicate length: 1182605
&&&&&&&&&&&&&&& after remove duplicate length: 316871

remove duplicate: 0.2675015926361084
r_  generation: 0.20374608039855957

local_output_nid generation: 0.009911775588989258
local_in_edges_tensor generation: 0.01698446273803711
mini_batch_src_global generation: 0.028164386749267578

&&&&&&&&&&&&&&& before remove duplicate length: 1133817
&&&&&&&&&&&&&&& after remove duplicate length: 371264

remove duplicate: 0.3038325309753418
r_  generation: 0.25154566764831543

local_output_nid generation: 0.009893417358398438
local_in_edges_tensor generation: 0.018363475799560547
mini_batch_src_global generation: 0.036200761795043945

&&&&&&&&&&&&&&& before remove duplicate length: 1218544
&&&&&&&&&&&&&&& after remove duplicate length: 356490

remove duplicate: 0.3511388301849365
r_  generation: 0.28000330924987793


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6973013877868652
gen group dst list time:  0.04559588432312012
check_connections_block*********************************
time for parepare 1: 0.3788182735443115
local_output_nid generation: 0.0673065185546875
local_in_edges_tensor generation: 0.14502525329589844
mini_batch_src_global generation: 0.10262465476989746

&&&&&&&&&&&&&&& before remove duplicate length: 3349051
&&&&&&&&&&&&&&& after remove duplicate length: 676446

remove duplicate: 0.7972583770751953
r_  generation: 0.6169075965881348

local_output_nid generation: 0.09862399101257324
local_in_edges_tensor generation: 0.1276857852935791
mini_batch_src_global generation: 0.07828783988952637

&&&&&&&&&&&&&&& before remove duplicate length: 3045026
&&&&&&&&&&&&&&& after remove duplicate length: 635507

remove duplicate: 0.7600018978118896
r_  generation: 0.6000916957855225

local_output_nid generation: 0.09273838996887207
local_in_edges_tensor generation: 0.11678028106689453
mini_batch_src_global generation: 0.10909748077392578

&&&&&&&&&&&&&&& before remove duplicate length: 3697654
&&&&&&&&&&&&&&& after remove duplicate length: 849461

remove duplicate: 1.086482286453247
r_  generation: 0.8517966270446777

local_output_nid generation: 0.10818696022033691
local_in_edges_tensor generation: 0.16376256942749023
mini_batch_src_global generation: 0.11119365692138672

&&&&&&&&&&&&&&& before remove duplicate length: 3537077
&&&&&&&&&&&&&&& after remove duplicate length: 677269

remove duplicate: 0.9548134803771973
r_  generation: 0.7137634754180908


connection checking time:  12.563296794891357
block generation total time  12.787609338760376
pseudo mini batch 0 input nodes size: 704565
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.26275157928466797  GigaBytes
Max Memory Allocated: 0.26275157928466797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3416748046875 GB
    Memory Allocated: 0.26312828063964844  GigaBytes
Max Memory Allocated: 0.26312828063964844  GigaBytes

first layer input nodes number: 704565
first layer output nodes number: 343245
edges number: 3349051
----------------------------------------before model layer 0
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

torch.Size([704565, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4666748046875 GB
    Memory Allocated: 0.30504465103149414  GigaBytes
Max Memory Allocated: 0.3175210952758789  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45914554595947266  GigaBytes
Max Memory Allocated: 0.5882935523986816  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1307373046875 GB
    Memory Allocated: 0.45914554595947266  GigaBytes
Max Memory Allocated: 0.5882935523986816  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 0.7872705459594727  GigaBytes

h_neigh size torch.Size([343245, 256])
h_self size  torch.Size([343245, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4588623046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 0.7872705459594727  GigaBytes

torch.Size([343245, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1153955459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 0.7872705459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

torch.Size([343245, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1153955459594727  GigaBytes
Max Memory Allocated: 1.4435205459594727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.1972317695617676  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------input nodes number: 343245
----------------output nodes number: 50510
----------------edges number: 1228913
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2001662254333496  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2001662254333496  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2578692436218262  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2578692436218262  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

h_neigh size torch.Size([50510, 47])
h_self size  torch.Size([50510, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

torch.Size([50510, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.275557041168213  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1151123046875 GB
    Memory Allocated: 1.2667131423950195  GigaBytes
Max Memory Allocated: 1.5253567695617676  GigaBytes

torch.Size([50510, 47])
pseudo mini batch 1 input nodes size: 663441
----------------------------------------before batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.27225351333618164  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5194048881530762  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.5197696685791016  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

first layer input nodes number: 663441
first layer output nodes number: 319005
edges number: 3045026
----------------------------------------before model layer 0
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([663441, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.2966618537902832  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4393773078918457  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.4393773078918457  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([319005, 256])
h_self size  torch.Size([319005, 100])
----------------------------------------before rst
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([319005, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0478310585021973  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 0.7436041831970215  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([319005, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.0478310585021973  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1238880157470703  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------input nodes number: 319005
----------------output nodes number: 48924
----------------edges number: 1182605
----------------------------------------before mean aggregator
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1266298294067383  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.7869873046875 GB
    Memory Allocated: 1.1266298294067383  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1829752922058105  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1829752922058105  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1917037963867188  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([48924, 47])
h_self size  torch.Size([48924, 256])
----------------------------------------before rst
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1917037963867188  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48924, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.200270175933838  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 1.1915416717529297  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48924, 47])
pseudo mini batch 2 input nodes size: 892931
----------------------------------------before batch input features to device
 Nvidia-smi: 10.0936279296875 GB
    Memory Allocated: 0.2568063735961914  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.589449405670166  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.5898075103759766  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

first layer input nodes number: 892931
first layer output nodes number: 378227
edges number: 3697654
----------------------------------------before model layer 0
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([892931, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 10.4276123046875 GB
    Memory Allocated: 0.38847970962524414  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 0.5584626197814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 10.4412841796875 GB
    Memory Allocated: 0.5584626197814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 10.8026123046875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([378227, 256])
h_self size  torch.Size([378227, 100])
----------------------------------------before rst
 Nvidia-smi: 10.8026123046875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([378227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.2811188697814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 0.9197907447814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([378227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.2811188697814941  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.37129545211792  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------input nodes number: 378227
----------------output nodes number: 48041
----------------edges number: 1133817
----------------------------------------before mean aggregator
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.374471664428711  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.374471664428711  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.429443359375  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.429443359375  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

h_neigh size torch.Size([48041, 47])
h_self size  torch.Size([48041, 256])
----------------------------------------before rst
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48041, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4462671279907227  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.5252685546875 GB
    Memory Allocated: 1.4378552436828613  GigaBytes
Max Memory Allocated: 1.8851408958435059  GigaBytes

torch.Size([48041, 47])
pseudo mini batch 3 input nodes size: 703937
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.34197473526000977  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6042118072509766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.6045780181884766  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 703937
first layer output nodes number: 358497
edges number: 3537077
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([703937, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3166365623474121  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4784708023071289  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4784708023071289  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([358497, 256])
h_self size  torch.Size([358497, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([358497, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1622495651245117  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.8203601837158203  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([358497, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1622495651245117  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2477221488952637  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 358497
----------------output nodes number: 49096
----------------edges number: 1218544
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2507596015930176  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2507596015930176  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3070263862609863  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3070263862609863  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49096, 47])
h_self size  torch.Size([49096, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49096, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3242192268371582  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.3156228065490723  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49096, 47])
Number of nodes for computation during this epoch:  4363848
Number of first layer input nodes during this epoch:  2964874
Number of first layer output nodes during this epoch:  1398974

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.30765748023986816
global_2_local spend time (sec) 0.4074218273162842

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.242 seconds
Metis partitioning: 12.113 seconds
Split the graph: 3.212 seconds
Construct subgraphs: 0.049 seconds
49807
49446
49569
47749
REG metis partition end ----................................
the time spent:  27.900136709213257
total k batches seeds list generation spend  28.538973331451416
after graph partition
graph partition algorithm spend time 29.24204421043396

partition_len_list
[336845, 328008, 380128, 376103]
REG selection method  spend 29.825730323791504
check_connections_block*********************************
time for parepare 1: 0.23637866973876953
local_output_nid generation: 0.011754035949707031
local_in_edges_tensor generation: 0.029013872146606445
mini_batch_src_global generation: 0.03786039352416992

&&&&&&&&&&&&&&& before remove duplicate length: 1211016
&&&&&&&&&&&&&&& after remove duplicate length: 334381

remove duplicate: 0.24065351486206055
r_  generation: 0.18723249435424805

local_output_nid generation: 0.0098876953125
local_in_edges_tensor generation: 0.0240170955657959
mini_batch_src_global generation: 0.03511190414428711

&&&&&&&&&&&&&&& before remove duplicate length: 1195784
&&&&&&&&&&&&&&& after remove duplicate length: 325788

remove duplicate: 0.26180481910705566
r_  generation: 0.20877766609191895

local_output_nid generation: 0.010025739669799805
local_in_edges_tensor generation: 0.02015089988708496
mini_batch_src_global generation: 0.03098273277282715

&&&&&&&&&&&&&&& before remove duplicate length: 1232488
&&&&&&&&&&&&&&& after remove duplicate length: 378269

remove duplicate: 0.3315107822418213
r_  generation: 0.26223301887512207

local_output_nid generation: 0.009923696517944336
local_in_edges_tensor generation: 0.015240907669067383
mini_batch_src_global generation: 0.033849239349365234

&&&&&&&&&&&&&&& before remove duplicate length: 1124591
&&&&&&&&&&&&&&& after remove duplicate length: 368402

remove duplicate: 0.3008441925048828
r_  generation: 0.262164831161499


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8790562152862549
gen group dst list time:  0.04166746139526367
check_connections_block*********************************
time for parepare 1: 0.39943957328796387
local_output_nid generation: 0.06630730628967285
local_in_edges_tensor generation: 0.16436028480529785
mini_batch_src_global generation: 0.10820651054382324

&&&&&&&&&&&&&&& before remove duplicate length: 3289162
&&&&&&&&&&&&&&& after remove duplicate length: 657347

remove duplicate: 0.7541463375091553
r_  generation: 0.5986809730529785

local_output_nid generation: 0.07873988151550293
local_in_edges_tensor generation: 0.0934300422668457
mini_batch_src_global generation: 0.08796477317810059

&&&&&&&&&&&&&&& before remove duplicate length: 3137010
&&&&&&&&&&&&&&& after remove duplicate length: 646848

remove duplicate: 0.8453748226165771
r_  generation: 0.6059927940368652

local_output_nid generation: 0.1123664379119873
local_in_edges_tensor generation: 0.33476686477661133
mini_batch_src_global generation: 0.1033773422241211

&&&&&&&&&&&&&&& before remove duplicate length: 3754387
&&&&&&&&&&&&&&& after remove duplicate length: 713295

remove duplicate: 1.600198745727539
r_  generation: 0.7800991535186768

local_output_nid generation: 0.09447669982910156
local_in_edges_tensor generation: 0.13705229759216309
mini_batch_src_global generation: 0.1305103302001953

&&&&&&&&&&&&&&& before remove duplicate length: 3671617
&&&&&&&&&&&&&&& after remove duplicate length: 886162

remove duplicate: 1.12544846534729
r_  generation: 0.8803670406341553


connection checking time:  13.667025566101074
block generation total time  12.007692337036133
pseudo mini batch 0 input nodes size: 683058
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.2723212242126465  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5267806053161621  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5271520614624023  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 683058
first layer output nodes number: 336845
edges number: 3289162
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3056783676147461  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([683058, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3056783676147461  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3056783676147461  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4570884704589844  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4570884704589844  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7783288955688477  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([336845, 256])
h_self size  torch.Size([336845, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7783288955688477  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([336845, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.099569320678711  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7783288955688477  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([336845, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.099569320678711  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1798796653747559  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 336845
----------------output nodes number: 49807
----------------edges number: 1211016
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1836724281311035  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1836724281311035  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.240567684173584  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.240567684173584  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.249288558959961  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49807, 47])
h_self size  torch.Size([49807, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.249288558959961  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49807, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.258009433746338  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.249288558959961  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49807, 47])
pseudo mini batch 1 input nodes size: 675367
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.26467418670654297  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.516268253326416  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.516636848449707  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 675367
first layer output nodes number: 328008
edges number: 3137010
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3019566535949707  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([675367, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3019566535949707  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3019566535949707  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4495077133178711  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.4495077133178711  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7623205184936523  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([328008, 256])
h_self size  torch.Size([328008, 100])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7623205184936523  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([328008, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.0751333236694336  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.7623205184936523  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([328008, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.0751333236694336  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.153336524963379  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 328008
----------------output nodes number: 49446
----------------edges number: 1195784
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1561493873596191  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.1561493873596191  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2125840187072754  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2125840187072754  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2214937210083008  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49446, 47])
h_self size  torch.Size([49446, 256])
----------------------------------------before rst
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2214937210083008  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49446, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2301511764526367  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 1.2212414741516113  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49446, 47])
pseudo mini batch 2 input nodes size: 741018
----------------------------------------before batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.2619948387145996  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5380458831787109  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5384154319763184  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 741018
first layer output nodes number: 380128
edges number: 3754387
----------------------------------------before model layer 0
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3329157829284668  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([741018, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3329157829284668  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.3329157829284668  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5043087005615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 11.9197998046875 GB
    Memory Allocated: 0.5043087005615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 12.2830810546875 GB
    Memory Allocated: 0.8675899505615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([380128, 256])
h_self size  torch.Size([380128, 100])
----------------------------------------before rst
 Nvidia-smi: 12.2830810546875 GB
    Memory Allocated: 0.8675899505615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([380128, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.2308712005615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 0.8675899505615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([380128, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.2308712005615234  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.3215007781982422  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 380128
----------------output nodes number: 49569
----------------edges number: 1232488
----------------------------------------before mean aggregator
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.324920654296875  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.324920654296875  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.3817462921142578  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.3817462921142578  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.390425682067871  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([49569, 47])
h_self size  torch.Size([49569, 256])
----------------------------------------before rst
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.390425682067871  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49569, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.3991050720214844  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.0096435546875 GB
    Memory Allocated: 1.390425682067871  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([49569, 47])
pseudo mini batch 3 input nodes size: 932575
----------------------------------------before batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.2862224578857422  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.633634090423584  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6339902877807617  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

first layer input nodes number: 932575
first layer output nodes number: 376103
edges number: 3671617
----------------------------------------before model layer 0
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.4040970802307129  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([932575, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.4040970802307129  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.4040970802307129  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5732264518737793  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5732264518737793  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.9319062232971191  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([376103, 256])
h_self size  torch.Size([376103, 100])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.9319062232971191  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([376103, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.290585994720459  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.9319062232971191  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([376103, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.290585994720459  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.380256175994873  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------input nodes number: 376103
----------------output nodes number: 47749
----------------edges number: 1124591
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3834147453308105  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3834147453308105  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4376873970031738  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4376873970031738  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4460477828979492  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

h_neigh size torch.Size([47749, 47])
h_self size  torch.Size([47749, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4460477828979492  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([47749, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4544081687927246  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4460477828979492  GigaBytes
Max Memory Allocated: 2.1163806915283203  GigaBytes

torch.Size([47749, 47])
Number of nodes for computation during this epoch:  4453102
Number of first layer input nodes during this epoch:  3032018
Number of first layer output nodes during this epoch:  1421084

-----------------------------------------------------------------------------epoch done
read pickle file
0.6924514770507812

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.21869611740112305
global_2_local spend time (sec) 0.4568331241607666

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.980 seconds
Metis partitioning: 11.817 seconds
Split the graph: 3.304 seconds
Construct subgraphs: 0.066 seconds
47805
50346
47859
50561
REG metis partition end ----................................
the time spent:  27.212923288345337
total k batches seeds list generation spend  27.857342004776
after graph partition
graph partition algorithm spend time 28.57548451423645

partition_len_list
[343103, 347654, 376130, 388645]
REG selection method  spend 29.22820734977722
check_connections_block*********************************
time for parepare 1: 0.22021961212158203
local_output_nid generation: 0.008669614791870117
local_in_edges_tensor generation: 0.014411687850952148
mini_batch_src_global generation: 0.039490699768066406

&&&&&&&&&&&&&&& before remove duplicate length: 1156329
&&&&&&&&&&&&&&& after remove duplicate length: 339734

remove duplicate: 0.23327159881591797
r_  generation: 0.19152116775512695

local_output_nid generation: 0.010527849197387695
local_in_edges_tensor generation: 0.017553329467773438
mini_batch_src_global generation: 0.0394289493560791

&&&&&&&&&&&&&&& before remove duplicate length: 1223241
&&&&&&&&&&&&&&& after remove duplicate length: 345484

remove duplicate: 0.2932605743408203
r_  generation: 0.2450263500213623

local_output_nid generation: 0.010303497314453125
local_in_edges_tensor generation: 0.0181121826171875
mini_batch_src_global generation: 0.029564857482910156

&&&&&&&&&&&&&&& before remove duplicate length: 1128085
&&&&&&&&&&&&&&& after remove duplicate length: 368628

remove duplicate: 0.3088414669036865
r_  generation: 0.26253199577331543

local_output_nid generation: 0.013135433197021484
local_in_edges_tensor generation: 0.013555765151977539
mini_batch_src_global generation: 0.0407252311706543

&&&&&&&&&&&&&&& before remove duplicate length: 1256224
&&&&&&&&&&&&&&& after remove duplicate length: 386609

remove duplicate: 0.3708913326263428
r_  generation: 0.2915494441986084


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7700629234313965
gen group dst list time:  0.05251121520996094
check_connections_block*********************************
time for parepare 1: 0.38611865043640137
local_output_nid generation: 0.07845330238342285
local_in_edges_tensor generation: 0.14396929740905762
mini_batch_src_global generation: 0.11740660667419434

&&&&&&&&&&&&&&& before remove duplicate length: 3340010
&&&&&&&&&&&&&&& after remove duplicate length: 735541

remove duplicate: 0.8045201301574707
r_  generation: 0.7243735790252686

local_output_nid generation: 0.11172151565551758
local_in_edges_tensor generation: 0.13857698440551758
mini_batch_src_global generation: 0.0892937183380127

&&&&&&&&&&&&&&& before remove duplicate length: 3340510
&&&&&&&&&&&&&&& after remove duplicate length: 709432

remove duplicate: 0.9277968406677246
r_  generation: 0.7215123176574707

local_output_nid generation: 0.09773755073547363
local_in_edges_tensor generation: 0.0935354232788086
mini_batch_src_global generation: 0.10788607597351074

&&&&&&&&&&&&&&& before remove duplicate length: 3676237
&&&&&&&&&&&&&&& after remove duplicate length: 876680

remove duplicate: 1.0845701694488525
r_  generation: 0.8913908004760742

local_output_nid generation: 0.1021738052368164
local_in_edges_tensor generation: 0.18182086944580078
mini_batch_src_global generation: 0.14853358268737793

&&&&&&&&&&&&&&& before remove duplicate length: 3837042
&&&&&&&&&&&&&&& after remove duplicate length: 725107

remove duplicate: 1.128730297088623
r_  generation: 0.8085498809814453


connection checking time:  13.607450008392334
block generation total time  12.17263388633728
block dataloader generation time/epoch 56.13547968864441
pseudo mini batch 0 input nodes size: 765964
----------------------------------------before batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.35724973678588867  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6425938606262207  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6429500579833984  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 765964
first layer output nodes number: 343103
edges number: 3340010
----------------------------------------before model layer 0
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33774232864379883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([765964, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33774232864379883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33774232864379883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.49172210693359375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.49172210693359375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8198471069335938  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([343103, 256])
h_self size  torch.Size([343103, 100])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8198471069335938  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([343103, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.1479721069335938  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8198471069335938  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([343103, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.1479721069335938  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2297744750976562  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 343103
----------------output nodes number: 47805
----------------edges number: 1156329
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.232686996459961  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.232686996459961  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2872495651245117  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2872495651245117  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2958650588989258  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([47805, 47])
h_self size  torch.Size([47805, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2958650588989258  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47805, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3042354583740234  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2956199645996094  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47805, 47])
pseudo mini batch 1 input nodes size: 739843
----------------------------------------before batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.2951931953430176  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5708065032958984  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5711817741394043  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 739843
first layer output nodes number: 347654
edges number: 3340510
----------------------------------------before model layer 0
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3275880813598633  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([739843, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3275880813598633  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3275880813598633  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.48384714126586914  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.48384714126586914  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8153958320617676  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([347654, 256])
h_self size  torch.Size([347654, 100])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8153958320617676  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([347654, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.146944522857666  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.8153958320617676  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([347654, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.146944522857666  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2298316955566406  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 347654
----------------output nodes number: 50346
----------------edges number: 1223241
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.232797622680664  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.232797622680664  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2903013229370117  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2903013229370117  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.299116611480713  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([50346, 47])
h_self size  torch.Size([50346, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.299116611480713  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([50346, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.307931900024414  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.299116611480713  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([50346, 47])
pseudo mini batch 2 input nodes size: 922105
----------------------------------------before batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.28592634201049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6294374465942383  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6297941207885742  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 922105
first layer output nodes number: 376130
edges number: 3676237
----------------------------------------before model layer 0
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3993520736694336  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([922105, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3993520736694336  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.3993520736694336  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5682635307312012  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.5682635307312012  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.926969051361084  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([376130, 256])
h_self size  torch.Size([376130, 100])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.926969051361084  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([376130, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2856745719909668  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.926969051361084  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([376130, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.2856745719909668  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3753509521484375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 376130
----------------output nodes number: 47859
----------------edges number: 1128085
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3785104751586914  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.3785104751586914  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4329147338867188  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4329147338867188  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4412946701049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([47859, 47])
h_self size  torch.Size([47859, 256])
----------------------------------------before rst
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4412946701049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47859, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4496746063232422  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 1.4412946701049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47859, 47])
pseudo mini batch 3 input nodes size: 752596
----------------------------------------before batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.35337018966674805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6337342262268066  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.6341114044189453  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 752596
first layer output nodes number: 388645
edges number: 3837042
----------------------------------------before model layer 0
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33767223358154297  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([752596, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33767223358154297  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 13.3748779296875 GB
    Memory Allocated: 0.33767223358154297  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 13.3787841796875 GB
    Memory Allocated: 0.5124902725219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 13.3787841796875 GB
    Memory Allocated: 0.5124902725219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 13.7498779296875 GB
    Memory Allocated: 0.8835840225219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([388645, 256])
h_self size  torch.Size([388645, 100])
----------------------------------------before rst
 Nvidia-smi: 13.7498779296875 GB
    Memory Allocated: 0.8835840225219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([388645, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.2546777725219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 0.8835840225219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([388645, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.2546777725219727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.3473381996154785  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 388645
----------------output nodes number: 50561
----------------edges number: 1256224
----------------------------------------before mean aggregator
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.350804328918457  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.350804328918457  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.4094300270080566  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.4094300270080566  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.4182829856872559  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([50561, 47])
h_self size  torch.Size([50561, 256])
----------------------------------------before rst
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.4182829856872559  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([50561, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.427135944366455  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.4920654296875 GB
    Memory Allocated: 1.4182829856872559  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([50561, 47])
Average training time/epoch 0.7781121730804443
Average Training time/epoch w/o nid counting 0.7777950763702393
Number of nodes for computation during this epoch:  4636040
Number of first layer input nodes during this epoch:  3180508
Number of first layer output nodes during this epoch:  1455532

-----------------------------------------------------------------------------epoch done
read pickle file
0.696868896484375

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.23032593727111816
global_2_local spend time (sec) 0.43921399116516113

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.095 seconds
Metis partitioning: 12.643 seconds
Split the graph: 3.108 seconds
Construct subgraphs: 0.066 seconds
49264
48964
47738
50605
REG metis partition end ----................................
the time spent:  27.956058979034424
total k batches seeds list generation spend  28.612680673599243
after graph partition
graph partition algorithm spend time 29.32742929458618

partition_len_list
[346684, 318842, 382271, 384212]
REG selection method  spend 29.982459545135498
check_connections_block*********************************
time for parepare 1: 0.22334957122802734
local_output_nid generation: 0.00946950912475586
local_in_edges_tensor generation: 0.012837886810302734
mini_batch_src_global generation: 0.04230093955993652

&&&&&&&&&&&&&&& before remove duplicate length: 1212900
&&&&&&&&&&&&&&& after remove duplicate length: 344869

remove duplicate: 0.276580810546875
r_  generation: 0.21078729629516602

local_output_nid generation: 0.013339519500732422
local_in_edges_tensor generation: 0.011582612991333008
mini_batch_src_global generation: 0.035706520080566406

&&&&&&&&&&&&&&& before remove duplicate length: 1169044
&&&&&&&&&&&&&&& after remove duplicate length: 315814

remove duplicate: 0.2589592933654785
r_  generation: 0.20360636711120605

local_output_nid generation: 0.010572195053100586
local_in_edges_tensor generation: 0.012594461441040039
mini_batch_src_global generation: 0.028700590133666992

&&&&&&&&&&&&&&& before remove duplicate length: 1125353
&&&&&&&&&&&&&&& after remove duplicate length: 374628

remove duplicate: 0.3080787658691406
r_  generation: 0.25661396980285645

local_output_nid generation: 0.010996818542480469
local_in_edges_tensor generation: 0.01258397102355957
mini_batch_src_global generation: 0.04190254211425781

&&&&&&&&&&&&&&& before remove duplicate length: 1256582
&&&&&&&&&&&&&&& after remove duplicate length: 382158

remove duplicate: 0.36312246322631836
r_  generation: 0.288785457611084


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7881557941436768
gen group dst list time:  0.04564476013183594
check_connections_block*********************************
time for parepare 1: 0.3431518077850342
local_output_nid generation: 0.0765538215637207
local_in_edges_tensor generation: 0.1536884307861328
mini_batch_src_global generation: 0.1111609935760498

&&&&&&&&&&&&&&& before remove duplicate length: 3391384
&&&&&&&&&&&&&&& after remove duplicate length: 720354

remove duplicate: 0.8153738975524902
r_  generation: 0.683478593826294

local_output_nid generation: 0.08255529403686523
local_in_edges_tensor generation: 0.08728480339050293
mini_batch_src_global generation: 0.08423304557800293

&&&&&&&&&&&&&&& before remove duplicate length: 3038474
&&&&&&&&&&&&&&& after remove duplicate length: 614305

remove duplicate: 0.7691202163696289
r_  generation: 0.597679615020752

local_output_nid generation: 0.09713459014892578
local_in_edges_tensor generation: 0.12226152420043945
mini_batch_src_global generation: 0.10204339027404785

&&&&&&&&&&&&&&& before remove duplicate length: 3736035
&&&&&&&&&&&&&&& after remove duplicate length: 893931

remove duplicate: 1.0702126026153564
r_  generation: 0.8311223983764648

local_output_nid generation: 0.08936476707458496
local_in_edges_tensor generation: 0.09559321403503418
mini_batch_src_global generation: 0.12737083435058594

&&&&&&&&&&&&&&& before remove duplicate length: 3793298
&&&&&&&&&&&&&&& after remove duplicate length: 718766

remove duplicate: 1.1518893241882324
r_  generation: 0.8102860450744629


connection checking time:  12.866893291473389
block generation total time  11.5288987159729
block dataloader generation time/epoch 55.835715889930725
pseudo mini batch 0 input nodes size: 750269
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.29071569442749023  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5702128410339355  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.570580005645752  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 750269
first layer output nodes number: 346684
edges number: 3391384
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.33261775970458984  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([750269, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.33261775970458984  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.33261775970458984  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4884500503540039  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4884500503540039  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8190736770629883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([346684, 256])
h_self size  torch.Size([346684, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8190736770629883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([346684, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1496973037719727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8190736770629883  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([346684, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1496973037719727  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2323532104492188  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 346684
----------------output nodes number: 49264
----------------edges number: 1212900
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2353034019470215  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2353034019470215  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2918548583984375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2918548583984375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3008918762207031  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([49264, 47])
h_self size  torch.Size([49264, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3008918762207031  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([49264, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3095178604125977  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.300480842590332  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([49264, 47])
pseudo mini batch 1 input nodes size: 640859
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.2900238037109375  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5287628173828125  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5291280746459961  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 640859
first layer output nodes number: 318842
edges number: 3038474
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.28809309005737305  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([640859, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.28809309005737305  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.28809309005737305  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4309654235839844  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4309654235839844  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7356529235839844  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([318842, 256])
h_self size  torch.Size([318842, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7356529235839844  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([318842, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.039724349975586  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7350368499755859  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([318842, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.039724349975586  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.115126132965088  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 318842
----------------output nodes number: 48964
----------------edges number: 1169044
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1178669929504395  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1178669929504395  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1736388206481934  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1736388206481934  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1822118759155273  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([48964, 47])
h_self size  torch.Size([48964, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1822118759155273  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([48964, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1907849311828613  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1822118759155273  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([48964, 47])
pseudo mini batch 2 input nodes size: 939322
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.24879980087280273  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5987248420715332  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5990805625915527  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

first layer input nodes number: 939322
first layer output nodes number: 382271
edges number: 3736035
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.40604352951049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([939322, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.40604352951049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.40604352951049805  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.577843189239502  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.577843189239502  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9424052238464355  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([382271, 256])
h_self size  torch.Size([382271, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9424052238464355  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([382271, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3069672584533691  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9424052238464355  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([382271, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3069672584533691  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3981080055236816  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------input nodes number: 382271
----------------output nodes number: 47738
----------------edges number: 1125353
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4013118743896484  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4013118743896484  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4555788040161133  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4555788040161133  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.463963508605957  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

h_neigh size torch.Size([47738, 47])
h_self size  torch.Size([47738, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.463963508605957  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47738, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4723219871520996  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4639372825622559  GigaBytes
Max Memory Allocated: 2.119093894958496  GigaBytes

torch.Size([47738, 47])
pseudo mini batch 3 input nodes size: 746546
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3597879409790039  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.6378984451293945  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.6382756233215332  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

first layer input nodes number: 746546
first layer output nodes number: 384212
edges number: 3793298
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3353700637817383  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([746546, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3353700637817383  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3353700637817383  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5081949234008789  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5081949234008789  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.874608039855957  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([384212, 256])
h_self size  torch.Size([384212, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.874608039855957  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([384212, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2410211563110352  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.874608039855957  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([384212, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2410211563110352  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3326244354248047  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------input nodes number: 384212
----------------output nodes number: 50605
----------------edges number: 1256582
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.335864543914795  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.335864543914795  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3938660621643066  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3938660621643066  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.402726650238037  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([50605, 47])
h_self size  torch.Size([50605, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.402726650238037  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50605, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4115872383117676  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.402726650238037  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50605, 47])
Average training time/epoch 0.7460490465164185
Average Training time/epoch w/o nid counting 0.7136197090148926
Number of nodes for computation during this epoch:  4509005
Number of first layer input nodes during this epoch:  3076996
Number of first layer output nodes during this epoch:  1432009

-----------------------------------------------------------------------------epoch done
read pickle file
0.7591774463653564

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.27831125259399414
global_2_local spend time (sec) 0.44051146507263184

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.071 seconds
Metis partitioning: 12.387 seconds
Split the graph: 3.201 seconds
Construct subgraphs: 0.046 seconds
50406
47838
47903
50424
REG metis partition end ----................................
the time spent:  28.0953471660614
total k batches seeds list generation spend  28.77408242225647
after graph partition
graph partition algorithm spend time 29.472431182861328

partition_len_list
[327852, 326370, 381386, 386881]
REG selection method  spend 30.12988042831421
check_connections_block*********************************
time for parepare 1: 0.21465468406677246
local_output_nid generation: 0.009470939636230469
local_in_edges_tensor generation: 0.013476371765136719
mini_batch_src_global generation: 0.040735483169555664

&&&&&&&&&&&&&&& before remove duplicate length: 1220106
&&&&&&&&&&&&&&& after remove duplicate length: 325598

remove duplicate: 0.2433176040649414
r_  generation: 0.19886469841003418

local_output_nid generation: 0.010656595230102539
local_in_edges_tensor generation: 0.012863636016845703
mini_batch_src_global generation: 0.0349273681640625

&&&&&&&&&&&&&&& before remove duplicate length: 1146960
&&&&&&&&&&&&&&& after remove duplicate length: 322983

remove duplicate: 0.2602536678314209
r_  generation: 0.21083927154541016

local_output_nid generation: 0.010677814483642578
local_in_edges_tensor generation: 0.018748998641967773
mini_batch_src_global generation: 0.029318809509277344

&&&&&&&&&&&&&&& before remove duplicate length: 1146489
&&&&&&&&&&&&&&& after remove duplicate length: 374481

remove duplicate: 0.3199503421783447
r_  generation: 0.26898837089538574

local_output_nid generation: 0.011047124862670898
local_in_edges_tensor generation: 0.013210773468017578
mini_batch_src_global generation: 0.039904117584228516

&&&&&&&&&&&&&&& before remove duplicate length: 1250324
&&&&&&&&&&&&&&& after remove duplicate length: 384864

remove duplicate: 0.3626129627227783
r_  generation: 0.2939870357513428


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7497320175170898
gen group dst list time:  0.041878700256347656
check_connections_block*********************************
time for parepare 1: 0.33867573738098145
local_output_nid generation: 0.06792092323303223
local_in_edges_tensor generation: 0.17334389686584473
mini_batch_src_global generation: 0.10322189331054688

&&&&&&&&&&&&&&& before remove duplicate length: 3128526
&&&&&&&&&&&&&&& after remove duplicate length: 661641

remove duplicate: 0.6989426612854004
r_  generation: 0.613767147064209

local_output_nid generation: 0.0882265567779541
local_in_edges_tensor generation: 0.1036839485168457
mini_batch_src_global generation: 0.09249210357666016

&&&&&&&&&&&&&&& before remove duplicate length: 3158487
&&&&&&&&&&&&&&& after remove duplicate length: 705930

remove duplicate: 0.8709087371826172
r_  generation: 0.7331461906433105

local_output_nid generation: 0.11234331130981445
local_in_edges_tensor generation: 0.17728924751281738
mini_batch_src_global generation: 0.11871099472045898

&&&&&&&&&&&&&&& before remove duplicate length: 3758526
&&&&&&&&&&&&&&& after remove duplicate length: 847351

remove duplicate: 1.1097731590270996
r_  generation: 0.8350460529327393

local_output_nid generation: 0.09392857551574707
local_in_edges_tensor generation: 0.08207273483276367
mini_batch_src_global generation: 0.12909936904907227

&&&&&&&&&&&&&&& before remove duplicate length: 3817998
&&&&&&&&&&&&&&& after remove duplicate length: 716529

remove duplicate: 1.1468253135681152
r_  generation: 0.8871233463287354


connection checking time:  13.177357196807861
block generation total time  11.893370151519775
block dataloader generation time/epoch 56.006503661473594
pseudo mini batch 0 input nodes size: 691500
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.2884697914123535  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5460739135742188  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5464496612548828  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

first layer input nodes number: 691500
first layer output nodes number: 327852
edges number: 3128526
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.30795812606811523  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([691500, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.30795812606811523  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.30795812606811523  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4549245834350586  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4549245834350586  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7675886154174805  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([327852, 256])
h_self size  torch.Size([327852, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7675886154174805  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([327852, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.0802526473999023  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7675886154174805  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([327852, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.0802526473999023  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1584186553955078  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------input nodes number: 327852
----------------output nodes number: 50406
----------------edges number: 1220106
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1612372398376465  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1612372398376465  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2187752723693848  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2187752723693848  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2276010513305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([50406, 47])
h_self size  torch.Size([50406, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2276010513305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50406, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.236426830291748  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2276010513305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50406, 47])
pseudo mini batch 1 input nodes size: 741472
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.2679281234741211  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5441479682922363  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5445046424865723  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

first layer input nodes number: 741472
first layer output nodes number: 326370
edges number: 3158487
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3268399238586426  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([741472, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3268399238586426  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3268399238586426  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4738130569458008  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.4738130569458008  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7850637435913086  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([326370, 256])
h_self size  torch.Size([326370, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7850637435913086  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([326370, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.0963144302368164  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.7850637435913086  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([326370, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.0963144302368164  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1741271018981934  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------input nodes number: 326370
----------------output nodes number: 47838
----------------edges number: 1146960
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1769156455993652  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.1769156455993652  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2314400672912598  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2314400672912598  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2398161888122559  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([47838, 47])
h_self size  torch.Size([47838, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2398161888122559  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([47838, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.248192310333252  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2398161888122559  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([47838, 47])
pseudo mini batch 2 input nodes size: 884558
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.2861971855163574  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.6157207489013672  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.6160778999328613  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

first layer input nodes number: 884558
first layer output nodes number: 381386
edges number: 3758526
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3856697082519531  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([884558, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3856697082519531  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3856697082519531  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5577068328857422  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.5577068328857422  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9214248657226562  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([381386, 256])
h_self size  torch.Size([381386, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9214248657226562  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([381386, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2851428985595703  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.9214248657226562  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([381386, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2851428985595703  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3760724067687988  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------input nodes number: 381386
----------------output nodes number: 47903
----------------edges number: 1146489
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3792715072631836  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3792715072631836  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4341177940368652  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4341177940368652  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4425053596496582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([47903, 47])
h_self size  torch.Size([47903, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4425053596496582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([47903, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4508929252624512  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4425053596496582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([47903, 47])
pseudo mini batch 3 input nodes size: 744450
----------------------------------------before batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.33939075469970703  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.6167201995849609  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.617095947265625  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

first layer input nodes number: 744450
first layer output nodes number: 386881
edges number: 3817998
----------------------------------------before model layer 0
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3350200653076172  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([744450, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3350200653076172  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.3350200653076172  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.509033203125  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.509033203125  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8779916763305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([386881, 256])
h_self size  torch.Size([386881, 100])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8779916763305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([386881, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2469501495361328  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 0.8779916763305664  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([386881, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.2469501495361328  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3391900062561035  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------input nodes number: 386881
----------------output nodes number: 50424
----------------edges number: 1250324
----------------------------------------before mean aggregator
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3424487113952637  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.3424487113952637  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4002289772033691  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4002289772033691  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4090580940246582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

h_neigh size torch.Size([50424, 47])
h_self size  torch.Size([50424, 256])
----------------------------------------before rst
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4090580940246582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50424, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4178872108459473  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8709716796875 GB
    Memory Allocated: 1.4090580940246582  GigaBytes
Max Memory Allocated: 2.1487317085266113  GigaBytes

torch.Size([50424, 47])
Average training time/epoch 0.7523488998413086
Average Training time/epoch w/o nid counting 0.7646732330322266
Number of nodes for computation during this epoch:  4484469
Number of first layer input nodes during this epoch:  3061980
Number of first layer output nodes during this epoch:  1422489

-----------------------------------------------------------------------------epoch done
