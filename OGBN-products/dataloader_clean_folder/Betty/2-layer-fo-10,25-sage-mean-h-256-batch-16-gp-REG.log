main start at this time 1660332232.9233453
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22310757637023926
global_2_local spend time (sec) 0.3595762252807617

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.907 seconds
Metis partitioning: 12.218 seconds
Split the graph: 1.017 seconds
Construct subgraphs: 0.228 seconds
12635
12397
12654
12561
12479
12608
12038
11927
12017
12031
12628
12604
11949
12122
11928
11993
REG metis partition end ----................................
the time spent:  25.22298765182495
total k batches seeds list generation spend  25.709710121154785
after graph partition
graph partition algorithm spend time 26.258476495742798

partition_len_list
[120206, 102501, 81708, 92586, 97732, 117471, 104661, 91797, 122727, 112307, 114854, 116486, 115959, 105227, 111880, 87241]
REG selection method  spend 26.793702363967896
check_connections_block*********************************
time for parepare 1: 0.2250809669494629
local_output_nid generation: 0.003856658935546875
local_in_edges_tensor generation: 0.004784345626831055
mini_batch_src_global generation: 0.009953737258911133

&&&&&&&&&&&&&&& before remove duplicate length: 313501
&&&&&&&&&&&&&&& after remove duplicate length: 119279

remove duplicate: 0.05108046531677246
r_  generation: 0.0505366325378418

local_output_nid generation: 0.004563570022583008
local_in_edges_tensor generation: 0.00539708137512207
mini_batch_src_global generation: 0.009845256805419922

&&&&&&&&&&&&&&& before remove duplicate length: 306184
&&&&&&&&&&&&&&& after remove duplicate length: 101890

remove duplicate: 0.05468034744262695
r_  generation: 0.04770803451538086

local_output_nid generation: 0.004667758941650391
local_in_edges_tensor generation: 0.004640340805053711
mini_batch_src_global generation: 0.006613969802856445

&&&&&&&&&&&&&&& before remove duplicate length: 298788
&&&&&&&&&&&&&&& after remove duplicate length: 80535

remove duplicate: 0.05226564407348633
r_  generation: 0.04506874084472656

local_output_nid generation: 0.004861593246459961
local_in_edges_tensor generation: 0.004824399948120117
mini_batch_src_global generation: 0.007790088653564453

&&&&&&&&&&&&&&& before remove duplicate length: 303852
&&&&&&&&&&&&&&& after remove duplicate length: 91603

remove duplicate: 0.06320405006408691
r_  generation: 0.047646522521972656

local_output_nid generation: 0.00461888313293457
local_in_edges_tensor generation: 0.004705190658569336
mini_batch_src_global generation: 0.008249044418334961

&&&&&&&&&&&&&&& before remove duplicate length: 301056
&&&&&&&&&&&&&&& after remove duplicate length: 96926

remove duplicate: 0.057096004486083984
r_  generation: 0.04964852333068848

local_output_nid generation: 0.004621982574462891
local_in_edges_tensor generation: 0.00471806526184082
mini_batch_src_global generation: 0.009190797805786133

&&&&&&&&&&&&&&& before remove duplicate length: 303801
&&&&&&&&&&&&&&& after remove duplicate length: 116278

remove duplicate: 0.0602262020111084
r_  generation: 0.057555437088012695

local_output_nid generation: 0.004520893096923828
local_in_edges_tensor generation: 0.0045795440673828125
mini_batch_src_global generation: 0.009374141693115234

&&&&&&&&&&&&&&& before remove duplicate length: 292289
&&&&&&&&&&&&&&& after remove duplicate length: 103401

remove duplicate: 0.0572359561920166
r_  generation: 0.05471444129943848

local_output_nid generation: 0.0044536590576171875
local_in_edges_tensor generation: 0.0045130252838134766
mini_batch_src_global generation: 0.00920557975769043

&&&&&&&&&&&&&&& before remove duplicate length: 287256
&&&&&&&&&&&&&&& after remove duplicate length: 90943

remove duplicate: 0.05597662925720215
r_  generation: 0.049479007720947266

local_output_nid generation: 0.004460811614990234
local_in_edges_tensor generation: 0.004576444625854492
mini_batch_src_global generation: 0.008912324905395508

&&&&&&&&&&&&&&& before remove duplicate length: 298835
&&&&&&&&&&&&&&& after remove duplicate length: 121442

remove duplicate: 0.06029701232910156
r_  generation: 0.060538291931152344

local_output_nid generation: 0.004482269287109375
local_in_edges_tensor generation: 0.004559516906738281
mini_batch_src_global generation: 0.009584188461303711

&&&&&&&&&&&&&&& before remove duplicate length: 298426
&&&&&&&&&&&&&&& after remove duplicate length: 111125

remove duplicate: 0.06047534942626953
r_  generation: 0.05810856819152832

local_output_nid generation: 0.00469207763671875
local_in_edges_tensor generation: 0.004766941070556641
mini_batch_src_global generation: 0.009943962097167969

&&&&&&&&&&&&&&& before remove duplicate length: 313446
&&&&&&&&&&&&&&& after remove duplicate length: 114208

remove duplicate: 0.06654119491577148
r_  generation: 0.06097865104675293

local_output_nid generation: 0.004640817642211914
local_in_edges_tensor generation: 0.0048372745513916016
mini_batch_src_global generation: 0.010205745697021484

&&&&&&&&&&&&&&& before remove duplicate length: 313364
&&&&&&&&&&&&&&& after remove duplicate length: 115735

remove duplicate: 0.06440067291259766
r_  generation: 0.06100130081176758

local_output_nid generation: 0.004521369934082031
local_in_edges_tensor generation: 0.004559040069580078
mini_batch_src_global generation: 0.009534597396850586

&&&&&&&&&&&&&&& before remove duplicate length: 287164
&&&&&&&&&&&&&&& after remove duplicate length: 114118

remove duplicate: 0.05852460861206055
r_  generation: 0.059935569763183594

local_output_nid generation: 0.004518747329711914
local_in_edges_tensor generation: 0.004598855972290039
mini_batch_src_global generation: 0.00986337661743164

&&&&&&&&&&&&&&& before remove duplicate length: 292883
&&&&&&&&&&&&&&& after remove duplicate length: 104193

remove duplicate: 0.060372352600097656
r_  generation: 0.05646157264709473

local_output_nid generation: 0.004477500915527344
local_in_edges_tensor generation: 0.0044901371002197266
mini_batch_src_global generation: 0.009007930755615234

&&&&&&&&&&&&&&& before remove duplicate length: 278668
&&&&&&&&&&&&&&& after remove duplicate length: 108827

remove duplicate: 0.05449724197387695
r_  generation: 0.054692983627319336

local_output_nid generation: 0.004477739334106445
local_in_edges_tensor generation: 0.004494905471801758
mini_batch_src_global generation: 0.009183168411254883

&&&&&&&&&&&&&&& before remove duplicate length: 274366
&&&&&&&&&&&&&&& after remove duplicate length: 84078

remove duplicate: 0.04594063758850098
r_  generation: 0.041037559509277344


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.778078556060791
gen group dst list time:  0.04588127136230469
check_connections_block*********************************
time for parepare 1: 0.3711073398590088
local_output_nid generation: 0.02836465835571289
local_in_edges_tensor generation: 0.09417152404785156
mini_batch_src_global generation: 0.03787636756896973

&&&&&&&&&&&&&&& before remove duplicate length: 1191518
&&&&&&&&&&&&&&& after remove duplicate length: 321552

remove duplicate: 0.2185049057006836
r_  generation: 0.21529245376586914

local_output_nid generation: 0.03108692169189453
local_in_edges_tensor generation: 0.0381474494934082
mini_batch_src_global generation: 0.02867913246154785

&&&&&&&&&&&&&&& before remove duplicate length: 1008150
&&&&&&&&&&&&&&& after remove duplicate length: 266222

remove duplicate: 0.20575475692749023
r_  generation: 0.19553685188293457

local_output_nid generation: 0.023310184478759766
local_in_edges_tensor generation: 0.022157669067382812
mini_batch_src_global generation: 0.02242588996887207

&&&&&&&&&&&&&&& before remove duplicate length: 788762
&&&&&&&&&&&&&&& after remove duplicate length: 170782

remove duplicate: 0.14645886421203613
r_  generation: 0.13301658630371094

local_output_nid generation: 0.026143789291381836
local_in_edges_tensor generation: 0.026838302612304688
mini_batch_src_global generation: 0.026441574096679688

&&&&&&&&&&&&&&& before remove duplicate length: 900567
&&&&&&&&&&&&&&& after remove duplicate length: 246083

remove duplicate: 0.20135068893432617
r_  generation: 0.17981195449829102

local_output_nid generation: 0.028279542922973633
local_in_edges_tensor generation: 0.029065847396850586
mini_batch_src_global generation: 0.02933335304260254

&&&&&&&&&&&&&&& before remove duplicate length: 934913
&&&&&&&&&&&&&&& after remove duplicate length: 259659

remove duplicate: 0.216780424118042
r_  generation: 0.21065711975097656

local_output_nid generation: 0.03266501426696777
local_in_edges_tensor generation: 0.04056835174560547
mini_batch_src_global generation: 0.03672647476196289

&&&&&&&&&&&&&&& before remove duplicate length: 1130110
&&&&&&&&&&&&&&& after remove duplicate length: 315152

remove duplicate: 0.25736522674560547
r_  generation: 0.24828386306762695

local_output_nid generation: 0.03098893165588379
local_in_edges_tensor generation: 0.030657529830932617
mini_batch_src_global generation: 0.0358729362487793

&&&&&&&&&&&&&&& before remove duplicate length: 1017919
&&&&&&&&&&&&&&& after remove duplicate length: 332634

remove duplicate: 0.24926519393920898
r_  generation: 0.2584407329559326

local_output_nid generation: 0.02715301513671875
local_in_edges_tensor generation: 0.025263071060180664
mini_batch_src_global generation: 0.032105207443237305

&&&&&&&&&&&&&&& before remove duplicate length: 882497
&&&&&&&&&&&&&&& after remove duplicate length: 245058

remove duplicate: 0.21327996253967285
r_  generation: 0.19910025596618652

local_output_nid generation: 0.03566718101501465
local_in_edges_tensor generation: 0.03915691375732422
mini_batch_src_global generation: 0.040349721908569336

&&&&&&&&&&&&&&& before remove duplicate length: 1215582
&&&&&&&&&&&&&&& after remove duplicate length: 359045

remove duplicate: 0.3225715160369873
r_  generation: 0.30839109420776367

local_output_nid generation: 0.0324711799621582
local_in_edges_tensor generation: 0.03586769104003906
mini_batch_src_global generation: 0.040225982666015625

&&&&&&&&&&&&&&& before remove duplicate length: 1111603
&&&&&&&&&&&&&&& after remove duplicate length: 302473

remove duplicate: 0.26038193702697754
r_  generation: 0.24486851692199707

local_output_nid generation: 0.03293967247009277
local_in_edges_tensor generation: 0.03115367889404297
mini_batch_src_global generation: 0.03933238983154297

&&&&&&&&&&&&&&& before remove duplicate length: 1133741
&&&&&&&&&&&&&&& after remove duplicate length: 302581

remove duplicate: 0.27510952949523926
r_  generation: 0.2469015121459961

local_output_nid generation: 0.03233170509338379
local_in_edges_tensor generation: 0.03170418739318848
mini_batch_src_global generation: 0.03966236114501953

&&&&&&&&&&&&&&& before remove duplicate length: 1153066
&&&&&&&&&&&&&&& after remove duplicate length: 319167

remove duplicate: 0.27640652656555176
r_  generation: 0.2629826068878174

local_output_nid generation: 0.033666133880615234
local_in_edges_tensor generation: 0.03493547439575195
mini_batch_src_global generation: 0.040952205657958984

&&&&&&&&&&&&&&& before remove duplicate length: 1136184
&&&&&&&&&&&&&&& after remove duplicate length: 383735

remove duplicate: 0.3104221820831299
r_  generation: 0.3167855739593506

local_output_nid generation: 0.029033660888671875
local_in_edges_tensor generation: 0.02673482894897461
mini_batch_src_global generation: 0.03968310356140137

&&&&&&&&&&&&&&& before remove duplicate length: 1024334
&&&&&&&&&&&&&&& after remove duplicate length: 289495

remove duplicate: 0.24625635147094727
r_  generation: 0.24526667594909668

local_output_nid generation: 0.032451629638671875
local_in_edges_tensor generation: 0.03136944770812988
mini_batch_src_global generation: 0.038311004638671875

&&&&&&&&&&&&&&& before remove duplicate length: 1099065
&&&&&&&&&&&&&&& after remove duplicate length: 369425

remove duplicate: 0.3047969341278076
r_  generation: 0.3146967887878418

local_output_nid generation: 0.026419639587402344
local_in_edges_tensor generation: 0.025135040283203125
mini_batch_src_global generation: 0.03363513946533203

&&&&&&&&&&&&&&& before remove duplicate length: 856117
&&&&&&&&&&&&&&& after remove duplicate length: 281683

remove duplicate: 0.21162700653076172
r_  generation: 0.2198467254638672


connection checking time:  14.130285739898682
block generation total time  12.837764024734497
pseudo mini batch 0 input nodes size: 334241
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0002803802490234375  GigaBytes
Max Memory Allocated: 0.0002803802490234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2030029296875 GB
    Memory Allocated: 0.12528038024902344  GigaBytes
Max Memory Allocated: 0.12528038024902344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2030029296875 GB
    Memory Allocated: 0.12537479400634766  GigaBytes
Max Memory Allocated: 0.12537479400634766  GigaBytes

first layer input nodes number: 334241
first layer output nodes number: 120206
edges number: 1191518
----------------------------------------before model layer 0
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

torch.Size([334241, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.2869873046875 GB
    Memory Allocated: 0.13997554779052734  GigaBytes
Max Memory Allocated: 0.14441442489624023  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6365966796875 GB
    Memory Allocated: 0.19422340393066406  GigaBytes
Max Memory Allocated: 0.239593505859375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6365966796875 GB
    Memory Allocated: 0.19422340393066406  GigaBytes
Max Memory Allocated: 0.239593505859375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.30945777893066406  GigaBytes

h_neigh size torch.Size([120206, 256])
h_self size  torch.Size([120206, 100])
----------------------------------------before rst
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.30945777893066406  GigaBytes

torch.Size([120206, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.42469215393066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.30945777893066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

torch.Size([120206, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.42469215393066406  GigaBytes
Max Memory Allocated: 0.5399265289306641  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4533514976501465  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------input nodes number: 120206
----------------output nodes number: 12635
----------------edges number: 313501
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4543418884277344  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4543418884277344  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4690418243408203  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4690418243408203  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

h_neigh size torch.Size([12635, 47])
h_self size  torch.Size([12635, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

torch.Size([12635, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4734668731689453  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 0.4712543487548828  GigaBytes
Max Memory Allocated: 0.5685858726501465  GigaBytes

torch.Size([12635, 47])
pseudo mini batch 1 input nodes size: 277455
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.12786865234375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.23122882843017578  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2313213348388672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 277455
first layer output nodes number: 102501
edges number: 1008150
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([277455, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11922454833984375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16530323028564453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16530323028564453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([102501, 256])
h_self size  torch.Size([102501, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([102501, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3608083724975586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.26305580139160156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([102501, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3608083724975586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38524675369262695  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 102501
----------------output nodes number: 12397
----------------edges number: 306184
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38610315322875977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38610315322875977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4003129005432129  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4003129005432129  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4024839401245117  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12397, 47])
h_self size  torch.Size([12397, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4024839401245117  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12397, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.404879093170166  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4027080535888672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12397, 47])
pseudo mini batch 2 input nodes size: 177678
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1061854362487793  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.17237567901611328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1724700927734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 177678
first layer output nodes number: 81708
edges number: 788762
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([177678, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.07956886291503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11618995666503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11618995666503906  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([81708, 256])
h_self size  torch.Size([81708, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([81708, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2720355987548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19411277770996094  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([81708, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2720355987548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2915668487548828  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 81708
----------------output nodes number: 12654
----------------edges number: 298788
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2922701835632324  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30838775634765625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30838775634765625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12654, 47])
h_self size  torch.Size([12654, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3108029365539551  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12654, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.313018798828125  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.31060361862182617  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12654, 47])
pseudo mini batch 3 input nodes size: 256513
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.0690622329711914  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16462087631225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.16471481323242188  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 256513
first layer output nodes number: 92586
edges number: 900567
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([256513, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11089515686035156  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.15244150161743164  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([92586, 256])
h_self size  torch.Size([92586, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([92586, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.32903528213500977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([92586, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.32903528213500977  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35110950469970703  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 92586
----------------output nodes number: 12561
----------------edges number: 303852
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35189342498779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.35189342498779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36623096466064453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36623096466064453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12561, 47])
h_self size  torch.Size([12561, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12561, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37063026428222656  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36843061447143555  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12561, 47])
pseudo mini batch 4 input nodes size: 271058
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.09841394424438477  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19939136505126953  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19948434829711914  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 271058
first layer output nodes number: 97732
edges number: 934913
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([271058, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.11621809005737305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1599574089050293  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.1599574089050293  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([97732, 256])
h_self size  torch.Size([97732, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([97732, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.34636640548706055  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2531619071960449  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([97732, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.34636640548706055  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.36966753005981445  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 97732
----------------output nodes number: 12479
----------------edges number: 301056
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37048912048339844  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.37048912048339844  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38535547256469727  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38535547256469727  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875460624694824  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12479, 47])
h_self size  torch.Size([12479, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875460624694824  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12479, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.38973140716552734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.3875408172607422  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12479, 47])
pseudo mini batch 5 input nodes size: 327912
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.10382270812988281  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.22597980499267578  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.2260737419128418  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 327912
first layer output nodes number: 117471
edges number: 1130110
----------------------------------------before model layer 0
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([327912, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.13977527618408203  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19276094436645508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.19276094436645508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([117471, 256])
h_self size  torch.Size([117471, 100])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([117471, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.41681909561157227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.30479001998901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([117471, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.41681909561157227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.444826602935791  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 117471
----------------output nodes number: 12608
----------------edges number: 303801
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.44579601287841797  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.44579601287841797  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4607853889465332  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.4607853889465332  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12608, 47])
h_self size  torch.Size([12608, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12608, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46520090103149414  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.46299314498901367  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12608, 47])
pseudo mini batch 6 input nodes size: 349139
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2166748046875 GB
    Memory Allocated: 0.12502050399780273  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.25587987899780273  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.2559700012207031  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 349139
first layer output nodes number: 104661
edges number: 1017919
----------------------------------------before model layer 0
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([349139, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.14686346054077148  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.19382762908935547  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.19382762908935547  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([104661, 256])
h_self size  torch.Size([104661, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([104661, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.39345264434814453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.29364013671875  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([104661, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.39345264434814453  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41840600967407227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 104661
----------------output nodes number: 12038
----------------edges number: 292289
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41927623748779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.41927623748779297  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4330253601074219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4330253601074219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351654052734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12038, 47])
h_self size  torch.Size([12038, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351654052734375  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12038, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4372735023498535  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.4351334571838379  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12038, 47])
pseudo mini batch 7 input nodes size: 256143
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1336512565612793  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.22907209396362305  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.22916126251220703  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 256143
first layer output nodes number: 91797
edges number: 882497
----------------------------------------before model layer 0
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([256143, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.10952138900756836  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1506366729736328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.1506366729736328  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([91797, 256])
h_self size  torch.Size([91797, 100])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([91797, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3257255554199219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.23818111419677734  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([91797, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3257255554199219  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3476119041442871  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 91797
----------------output nodes number: 11927
----------------edges number: 287256
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3483853340148926  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3483853340148926  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36338043212890625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36338043212890625  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.3675575256347656  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.36546897888183594  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 8 input nodes size: 374249
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 0.0981602668762207  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.237579345703125  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.2376689910888672  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

first layer input nodes number: 374249
first layer output nodes number: 122727
edges number: 1215582
----------------------------------------before model layer 0
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([374249, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.4881591796875 GB
    Memory Allocated: 0.15723848342895508  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.21247243881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.21247243881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.3295140266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([122727, 256])
h_self size  torch.Size([122727, 100])
----------------------------------------before rst
 Nvidia-smi: 8.4920654296875 GB
    Memory Allocated: 0.3295140266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([122727, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4467015266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.32965993881225586  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([122727, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4467015266418457  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47596216201782227  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------input nodes number: 122727
----------------output nodes number: 12017
----------------edges number: 298835
----------------------------------------before mean aggregator
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47696638107299805  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.47696638107299805  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4910469055175781  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4910469055175781  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4936485290527344  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

h_neigh size torch.Size([12017, 47])
h_self size  torch.Size([12017, 256])
----------------------------------------before rst
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4936485290527344  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12017, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.49575281143188477  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6092529296875 GB
    Memory Allocated: 0.4931511878967285  GigaBytes
Max Memory Allocated: 0.692875862121582  GigaBytes

torch.Size([12017, 47])
pseudo mini batch 9 input nodes size: 315330
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.14267206192016602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.26014184951782227  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.26023149490356445  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 315330
first layer output nodes number: 112307
edges number: 1111603
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([315330, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1344161033630371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18495512008666992  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([112307, 256])
h_self size  torch.Size([112307, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([112307, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.39916372299194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29205942153930664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([112307, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.39916372299194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.42594003677368164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 112307
----------------output nodes number: 12031
----------------edges number: 298426
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4268665313720703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4268665313720703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.440706729888916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.440706729888916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12031, 47])
h_self size  torch.Size([12031, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12031, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44492006301879883  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4428133964538574  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12031, 47])
pseudo mini batch 10 input nodes size: 315674
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12022781372070312  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.23782587051391602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.23792028427124023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 315674
first layer output nodes number: 114854
edges number: 1133741
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([315674, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.13466739654541016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18632984161376953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.18632984161376953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([114854, 256])
h_self size  torch.Size([114854, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114854, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4053964614868164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.29586315155029297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114854, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4053964614868164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.43277978897094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 114854
----------------output nodes number: 12628
----------------edges number: 313446
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4337301254272461  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4337301254272461  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4491705894470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4491705894470215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12628, 47])
h_self size  torch.Size([12628, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12628, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.45359277725219727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4513816833496094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12628, 47])
pseudo mini batch 11 input nodes size: 332416
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12046527862548828  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.24429988861083984  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.24439382553100586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 332416
first layer output nodes number: 116486
edges number: 1153066
----------------------------------------before model layer 0
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([332416, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.1410846710205078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.19350528717041016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.19350528717041016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3052496910095215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([116486, 256])
h_self size  torch.Size([116486, 100])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3052496910095215  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116486, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4163393974304199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.3045949935913086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([116486, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4163393974304199  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44345712661743164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 116486
----------------output nodes number: 12604
----------------edges number: 313364
----------------------------------------before mean aggregator
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44441938400268555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.44441938400268555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4592289924621582  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.4592289924621582  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12604, 47])
h_self size  torch.Size([12604, 256])
----------------------------------------before rst
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12604, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46364355087280273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.46143627166748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12604, 47])
pseudo mini batch 12 input nodes size: 403887
----------------------------------------before batch input features to device
 Nvidia-smi: 8.7283935546875 GB
    Memory Allocated: 0.12669754028320312  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2771573066711426  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27724647521972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 403887
first layer output nodes number: 115959
edges number: 1136184
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([403887, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1694784164428711  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2215743064880371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2215743064880371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33266401290893555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([115959, 256])
h_self size  torch.Size([115959, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33266401290893555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115959, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4432511329650879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33216142654418945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115959, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4432511329650879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.470395565032959  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 115959
----------------output nodes number: 11949
----------------edges number: 287164
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47134876251220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47134876251220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4856276512145996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4856276512145996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11949, 47])
h_self size  torch.Size([11949, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11949, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.48981237411499023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4877200126647949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11949, 47])
pseudo mini batch 13 input nodes size: 305133
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15366554260253906  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2673368453979492  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2674274444580078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 305133
first layer output nodes number: 105227
edges number: 1024334
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([305133, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13022327423095703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17789888381958008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17789888381958008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([105227, 256])
h_self size  torch.Size([105227, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.378603458404541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27825117111206055  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([105227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.378603458404541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40369176864624023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 105227
----------------output nodes number: 12122
----------------edges number: 292883
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40456676483154297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40456676483154297  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41840076446533203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41840076446533203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42052364349365234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12122, 47])
h_self size  torch.Size([12122, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42052364349365234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12122, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42311859130859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42099571228027344  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12122, 47])
pseudo mini batch 14 input nodes size: 387183
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11644649505615234  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.260683536529541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.260772705078125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 387183
first layer output nodes number: 111880
edges number: 1099065
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([387183, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21179914474487305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21179914474487305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([111880, 256])
h_self size  torch.Size([111880, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([111880, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42519330978393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3184962272644043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([111880, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42519330978393555  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45186758041381836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 111880
----------------output nodes number: 11928
----------------edges number: 278668
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4527907371520996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4527907371520996  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46642160415649414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46642160415649414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4686260223388672  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11928, 47])
h_self size  torch.Size([11928, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4686260223388672  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11928, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4707145690917969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46851015090942383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11928, 47])
pseudo mini batch 15 input nodes size: 296590
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14709234237670898  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2575807571411133  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.25767040252685547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 296590
first layer output nodes number: 87241
edges number: 856117
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([296590, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12516260147094727  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1643671989440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1643671989440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([87241, 256])
h_self size  torch.Size([87241, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([87241, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3307662010192871  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24756669998168945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([87241, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3307662010192871  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3515663146972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 87241
----------------output nodes number: 11993
----------------edges number: 274366
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3523063659667969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3523063659667969  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3658781051635742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3658781051635742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11993, 47])
h_self size  torch.Size([11993, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11993, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37007808685302734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3679780960083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11993, 47])
Number of nodes for computation during this epoch:  6675944
Number of first layer input nodes during this epoch:  4980601
Number of first layer output nodes during this epoch:  1695343

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3338601589202881
global_2_local spend time (sec) 0.4112977981567383

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.034 seconds
Metis partitioning: 13.060 seconds
Split the graph: 1.275 seconds
Construct subgraphs: 0.370 seconds
12529
12609
11927
12484
12183
12631
11951
12019
12513
11981
12330
12328
12614
12517
12006
11949
REG metis partition end ----................................
the time spent:  27.196081399917603
total k batches seeds list generation spend  27.727280855178833
after graph partition
graph partition algorithm spend time 28.300554990768433

partition_len_list
[102526, 115563, 90252, 80148, 109622, 106221, 89146, 102514, 114538, 118318, 99455, 115734, 124894, 87582, 109021, 113324]
REG selection method  spend 28.9108145236969
check_connections_block*********************************
time for parepare 1: 0.2578878402709961
local_output_nid generation: 0.0042150020599365234
local_in_edges_tensor generation: 0.004812717437744141
mini_batch_src_global generation: 0.010077714920043945

&&&&&&&&&&&&&&& before remove duplicate length: 309806
&&&&&&&&&&&&&&& after remove duplicate length: 101919

remove duplicate: 0.051878929138183594
r_  generation: 0.0454709529876709

local_output_nid generation: 0.004816770553588867
local_in_edges_tensor generation: 0.004660606384277344
mini_batch_src_global generation: 0.009952783584594727

&&&&&&&&&&&&&&& before remove duplicate length: 313186
&&&&&&&&&&&&&&& after remove duplicate length: 114759

remove duplicate: 0.05631446838378906
r_  generation: 0.054494619369506836

local_output_nid generation: 0.0047092437744140625
local_in_edges_tensor generation: 0.004780292510986328
mini_batch_src_global generation: 0.006829023361206055

&&&&&&&&&&&&&&& before remove duplicate length: 287091
&&&&&&&&&&&&&&& after remove duplicate length: 89179

remove duplicate: 0.05507016181945801
r_  generation: 0.049005985260009766

local_output_nid generation: 0.0048542022705078125
local_in_edges_tensor generation: 0.004831790924072266
mini_batch_src_global generation: 0.007325172424316406

&&&&&&&&&&&&&&& before remove duplicate length: 295001
&&&&&&&&&&&&&&& after remove duplicate length: 79042

remove duplicate: 0.04894304275512695
r_  generation: 0.04016423225402832

local_output_nid generation: 0.004675388336181641
local_in_edges_tensor generation: 0.004609346389770508
mini_batch_src_global generation: 0.007999658584594727

&&&&&&&&&&&&&&& before remove duplicate length: 293184
&&&&&&&&&&&&&&& after remove duplicate length: 108546

remove duplicate: 0.06117057800292969
r_  generation: 0.06637430191040039

local_output_nid generation: 0.004948616027832031
local_in_edges_tensor generation: 0.0047969818115234375
mini_batch_src_global generation: 0.009357690811157227

&&&&&&&&&&&&&&& before remove duplicate length: 305313
&&&&&&&&&&&&&&& after remove duplicate length: 105403

remove duplicate: 0.06294989585876465
r_  generation: 0.058387041091918945

local_output_nid generation: 0.004728555679321289
local_in_edges_tensor generation: 0.00474858283996582
mini_batch_src_global generation: 0.00908660888671875

&&&&&&&&&&&&&&& before remove duplicate length: 288013
&&&&&&&&&&&&&&& after remove duplicate length: 88408

remove duplicate: 0.05898404121398926
r_  generation: 0.05303001403808594

local_output_nid generation: 0.004709720611572266
local_in_edges_tensor generation: 0.00468897819519043
mini_batch_src_global generation: 0.009290456771850586

&&&&&&&&&&&&&&& before remove duplicate length: 291638
&&&&&&&&&&&&&&& after remove duplicate length: 101498

remove duplicate: 0.06067252159118652
r_  generation: 0.05800366401672363

local_output_nid generation: 0.004950761795043945
local_in_edges_tensor generation: 0.004827022552490234
mini_batch_src_global generation: 0.009885311126708984

&&&&&&&&&&&&&&& before remove duplicate length: 311546
&&&&&&&&&&&&&&& after remove duplicate length: 113924

remove duplicate: 0.06788468360900879
r_  generation: 0.06353020668029785

local_output_nid generation: 0.004767656326293945
local_in_edges_tensor generation: 0.0048329830169677734
mini_batch_src_global generation: 0.009979248046875

&&&&&&&&&&&&&&& before remove duplicate length: 297715
&&&&&&&&&&&&&&& after remove duplicate length: 117110

remove duplicate: 0.06672954559326172
r_  generation: 0.06711673736572266

local_output_nid generation: 0.0049626827239990234
local_in_edges_tensor generation: 0.004723072052001953
mini_batch_src_global generation: 0.01044917106628418

&&&&&&&&&&&&&&& before remove duplicate length: 303025
&&&&&&&&&&&&&&& after remove duplicate length: 98418

remove duplicate: 0.06654763221740723
r_  generation: 0.06190824508666992

local_output_nid generation: 0.004857301712036133
local_in_edges_tensor generation: 0.01191258430480957
mini_batch_src_global generation: 0.010564327239990234

&&&&&&&&&&&&&&& before remove duplicate length: 306104
&&&&&&&&&&&&&&& after remove duplicate length: 114706

remove duplicate: 0.06683516502380371
r_  generation: 0.06328153610229492

local_output_nid generation: 0.0049588680267333984
local_in_edges_tensor generation: 0.006373882293701172
mini_batch_src_global generation: 0.010946035385131836

&&&&&&&&&&&&&&& before remove duplicate length: 311803
&&&&&&&&&&&&&&& after remove duplicate length: 123857

remove duplicate: 0.06919503211975098
r_  generation: 0.06850886344909668

local_output_nid generation: 0.004906892776489258
local_in_edges_tensor generation: 0.00596928596496582
mini_batch_src_global generation: 0.010414600372314453

&&&&&&&&&&&&&&& before remove duplicate length: 296158
&&&&&&&&&&&&&&& after remove duplicate length: 86761

remove duplicate: 0.05386924743652344
r_  generation: 0.048410654067993164

local_output_nid generation: 0.00479435920715332
local_in_edges_tensor generation: 0.005441904067993164
mini_batch_src_global generation: 0.008764982223510742

&&&&&&&&&&&&&&& before remove duplicate length: 270637
&&&&&&&&&&&&&&& after remove duplicate length: 105825

remove duplicate: 0.056417226791381836
r_  generation: 0.05500960350036621

local_output_nid generation: 0.00472259521484375
local_in_edges_tensor generation: 0.00482940673828125
mini_batch_src_global generation: 0.009185552597045898

&&&&&&&&&&&&&&& before remove duplicate length: 283659
&&&&&&&&&&&&&&& after remove duplicate length: 109963

remove duplicate: 0.05857729911804199
r_  generation: 0.06091570854187012


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7674813270568848
gen group dst list time:  0.06983423233032227
check_connections_block*********************************
time for parepare 1: 0.4189879894256592
local_output_nid generation: 0.027768373489379883
local_in_edges_tensor generation: 0.08504104614257812
mini_batch_src_global generation: 0.032829999923706055

&&&&&&&&&&&&&&& before remove duplicate length: 1008839
&&&&&&&&&&&&&&& after remove duplicate length: 264642

remove duplicate: 0.19311881065368652
r_  generation: 0.18908119201660156

local_output_nid generation: 0.035312652587890625
local_in_edges_tensor generation: 0.04351997375488281
mini_batch_src_global generation: 0.038228750228881836

&&&&&&&&&&&&&&& before remove duplicate length: 1145453
&&&&&&&&&&&&&&& after remove duplicate length: 308914

remove duplicate: 0.24277257919311523
r_  generation: 0.2363755702972412

local_output_nid generation: 0.031220197677612305
local_in_edges_tensor generation: 0.04965710639953613
mini_batch_src_global generation: 0.02760028839111328

&&&&&&&&&&&&&&& before remove duplicate length: 877301
&&&&&&&&&&&&&&& after remove duplicate length: 246460

remove duplicate: 0.22828197479248047
r_  generation: 0.1925039291381836

local_output_nid generation: 0.047661542892456055
local_in_edges_tensor generation: 0.02727222442626953
mini_batch_src_global generation: 0.025001049041748047

&&&&&&&&&&&&&&& before remove duplicate length: 772861
&&&&&&&&&&&&&&& after remove duplicate length: 169908

remove duplicate: 0.15552568435668945
r_  generation: 0.14220809936523438

local_output_nid generation: 0.03431844711303711
local_in_edges_tensor generation: 0.036765336990356445
mini_batch_src_global generation: 0.03565835952758789

&&&&&&&&&&&&&&& before remove duplicate length: 1050711
&&&&&&&&&&&&&&& after remove duplicate length: 309449

remove duplicate: 0.2439415454864502
r_  generation: 0.2411966323852539

local_output_nid generation: 0.03251504898071289
local_in_edges_tensor generation: 0.036032915115356445
mini_batch_src_global generation: 0.03803133964538574

&&&&&&&&&&&&&&& before remove duplicate length: 1022150
&&&&&&&&&&&&&&& after remove duplicate length: 273754

remove duplicate: 0.23923134803771973
r_  generation: 0.22452068328857422

local_output_nid generation: 0.02758169174194336
local_in_edges_tensor generation: 0.0234832763671875
mini_batch_src_global generation: 0.032259225845336914

&&&&&&&&&&&&&&& before remove duplicate length: 856265
&&&&&&&&&&&&&&& after remove duplicate length: 231568

remove duplicate: 0.2077028751373291
r_  generation: 0.19184398651123047

local_output_nid generation: 0.0324397087097168
local_in_edges_tensor generation: 0.03081035614013672
mini_batch_src_global generation: 0.03570723533630371

&&&&&&&&&&&&&&& before remove duplicate length: 998469
&&&&&&&&&&&&&&& after remove duplicate length: 316215

remove duplicate: 0.24993133544921875
r_  generation: 0.2467505931854248

local_output_nid generation: 0.03421783447265625
local_in_edges_tensor generation: 0.03519082069396973
mini_batch_src_global generation: 0.0439145565032959

&&&&&&&&&&&&&&& before remove duplicate length: 1135366
&&&&&&&&&&&&&&& after remove duplicate length: 308353

remove duplicate: 0.27317333221435547
r_  generation: 0.2627899646759033

local_output_nid generation: 0.03682589530944824
local_in_edges_tensor generation: 0.03572273254394531
mini_batch_src_global generation: 0.04511070251464844

&&&&&&&&&&&&&&& before remove duplicate length: 1171587
&&&&&&&&&&&&&&& after remove duplicate length: 347278

remove duplicate: 0.3001859188079834
r_  generation: 0.30659008026123047

local_output_nid generation: 0.031958818435668945
local_in_edges_tensor generation: 0.026859283447265625
mini_batch_src_global generation: 0.03989386558532715

&&&&&&&&&&&&&&& before remove duplicate length: 979648
&&&&&&&&&&&&&&& after remove duplicate length: 263846

remove duplicate: 0.26646852493286133
r_  generation: 0.241135835647583

local_output_nid generation: 0.03454709053039551
local_in_edges_tensor generation: 0.09763145446777344
mini_batch_src_global generation: 0.04111981391906738

&&&&&&&&&&&&&&& before remove duplicate length: 1145515
&&&&&&&&&&&&&&& after remove duplicate length: 304440

remove duplicate: 0.31002211570739746
r_  generation: 0.2742481231689453

local_output_nid generation: 0.05889391899108887
local_in_edges_tensor generation: 0.05128145217895508
mini_batch_src_global generation: 0.04648447036743164

&&&&&&&&&&&&&&& before remove duplicate length: 1231806
&&&&&&&&&&&&&&& after remove duplicate length: 335078

remove duplicate: 0.2977588176727295
r_  generation: 0.28467535972595215

local_output_nid generation: 0.025695323944091797
local_in_edges_tensor generation: 0.02270054817199707
mini_batch_src_global generation: 0.0354306697845459

&&&&&&&&&&&&&&& before remove duplicate length: 839595
&&&&&&&&&&&&&&& after remove duplicate length: 221723

remove duplicate: 0.20048141479492188
r_  generation: 0.19542622566223145

local_output_nid generation: 0.03267645835876465
local_in_edges_tensor generation: 0.030486583709716797
mini_batch_src_global generation: 0.04098987579345703

&&&&&&&&&&&&&&& before remove duplicate length: 1067491
&&&&&&&&&&&&&&& after remove duplicate length: 353864

remove duplicate: 0.3143002986907959
r_  generation: 0.3080766201019287

local_output_nid generation: 0.035904645919799805
local_in_edges_tensor generation: 0.0344390869140625
mini_batch_src_global generation: 0.04313206672668457

&&&&&&&&&&&&&&& before remove duplicate length: 1119799
&&&&&&&&&&&&&&& after remove duplicate length: 394210

remove duplicate: 0.3235435485839844
r_  generation: 0.3383502960205078


connection checking time:  14.882031440734863
block generation total time  12.658769130706787
pseudo mini batch 0 input nodes size: 275588
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1137995719909668  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21646451950073242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21655797958374023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 275588
first layer output nodes number: 102526
edges number: 1008839
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11926698684692383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([275588, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11926698684692383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11926698684692383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1653599739074707  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1653599739074707  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2631363868713379  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([102526, 256])
h_self size  torch.Size([102526, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2631363868713379  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([102526, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3609127998352051  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2631363868713379  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([102526, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3609127998352051  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3853569030761719  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 102526
----------------output nodes number: 12529
----------------edges number: 309806
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3862142562866211  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3862142562866211  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4011812210083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4011812210083008  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40337514877319336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12529, 47])
h_self size  torch.Size([12529, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40337514877319336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12529, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4057149887084961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4035210609436035  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12529, 47])
pseudo mini batch 1 input nodes size: 321063
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10607481002807617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22568035125732422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22577476501464844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 321063
first layer output nodes number: 115563
edges number: 1145453
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374044418334961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([321063, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374044418334961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374044418334961  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18942022323608398  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18942022323608398  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29962968826293945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([115563, 256])
h_self size  torch.Size([115563, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29962968826293945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115563, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4098391532897949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29962968826293945  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115563, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4098391532897949  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4373917579650879  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 115563
----------------output nodes number: 12609
----------------edges number: 313186
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43834733963012695  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43834733963012695  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.453157901763916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.453157901763916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4553656578063965  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12609, 47])
h_self size  torch.Size([12609, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4553656578063965  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12609, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45757341384887695  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4553656578063965  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12609, 47])
pseudo mini batch 2 input nodes size: 256974
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12303018569946289  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21876049041748047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21884965896606445  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 256974
first layer output nodes number: 90252
edges number: 877301
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11109113693237305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([256974, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11109113693237305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11109113693237305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15158605575561523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15158605575561523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2376570701599121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([90252, 256])
h_self size  torch.Size([90252, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2376570701599121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([90252, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.323728084564209  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2376570701599121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([90252, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.323728084564209  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3452458381652832  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 90252
----------------output nodes number: 11927
----------------edges number: 287091
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3460078239440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3460078239440918  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.359652042388916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.359652042388916  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3624114990234375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3624114990234375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36460113525390625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.36184167861938477  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 3 input nodes size: 176739
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.0990304946899414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1648712158203125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1649646759033203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 176739
first layer output nodes number: 80148
edges number: 772861
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.079437255859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([176739, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.079437255859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.079437255859375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11535215377807617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11535215377807617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1917872428894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([80148, 256])
h_self size  torch.Size([80148, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1917872428894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([80148, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2682223320007324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1917872428894043  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([80148, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2682223320007324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2877535820007324  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 80148
----------------output nodes number: 12484
----------------edges number: 295001
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.28844451904296875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.28844451904296875  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30353260040283203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30353260040283203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30571842193603516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12484, 47])
h_self size  torch.Size([12484, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30571842193603516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12484, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3079042434692383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.30571842193603516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12484, 47])
pseudo mini batch 4 input nodes size: 323073
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.06924247741699219  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18959665298461914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18968772888183594  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 323073
first layer output nodes number: 109622
edges number: 1050711
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13815593719482422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([323073, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13815593719482422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13815593719482422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18740081787109375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18740081787109375  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2919445037841797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([109622, 256])
h_self size  torch.Size([109622, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2919445037841797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([109622, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3964881896972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2919445037841797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([109622, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3964881896972656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4226241111755371  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 109622
----------------output nodes number: 12183
----------------edges number: 293184
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42353200912475586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42353200912475586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4383254051208496  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4383254051208496  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4404587745666504  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12183, 47])
h_self size  torch.Size([12183, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4404587745666504  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12183, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44281673431396484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.44068336486816406  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12183, 47])
pseudo mini batch 5 input nodes size: 284649
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12370109558105469  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22974157333374023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22983598709106445  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 284649
first layer output nodes number: 106221
edges number: 1022150
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12219476699829102  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([284649, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12219476699829102  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12219476699829102  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17026853561401367  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.17026853561401367  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27156877517700195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([106221, 256])
h_self size  torch.Size([106221, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27156877517700195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([106221, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37286901473999023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.27156877517700195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([106221, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37286901473999023  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3981943130493164  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 106221
----------------output nodes number: 12631
----------------edges number: 305313
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3990802764892578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3990802764892578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41443967819213867  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41443967819213867  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41665124893188477  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12631, 47])
h_self size  torch.Size([12631, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41665124893188477  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12631, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41979074478149414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.41757917404174805  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12631, 47])
pseudo mini batch 6 input nodes size: 242107
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10946893692016602  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1996612548828125  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.19975042343139648  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 242107
first layer output nodes number: 89146
edges number: 856265
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([242107, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10461044311523438  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1445326805114746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1445326805114746  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22954893112182617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([89146, 256])
h_self size  torch.Size([89146, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22954893112182617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([89146, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.31456518173217773  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22954893112182617  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([89146, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.31456518173217773  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3358192443847656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 89146
----------------output nodes number: 11951
----------------edges number: 288013
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33657264709472656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.33657264709472656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3502063751220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3502063751220703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35229921340942383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11951, 47])
h_self size  torch.Size([11951, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35229921340942383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11951, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35439205169677734  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.35229921340942383  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11951, 47])
pseudo mini batch 7 input nodes size: 330045
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.09349679946899414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.21644830703735352  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2165379524230957  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 330045
first layer output nodes number: 102514
edges number: 998469
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14101266860961914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([330045, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14101266860961914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.14101266860961914  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18702411651611328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18702411651611328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2847890853881836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([102514, 256])
h_self size  torch.Size([102514, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2847890853881836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([102514, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3825540542602539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2847890853881836  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([102514, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3825540542602539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4069952964782715  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 102514
----------------output nodes number: 12019
----------------edges number: 291638
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4078488349914551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4078488349914551  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42226219177246094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42226219177246094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4252743721008301  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12019, 47])
h_self size  torch.Size([12019, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4252743721008301  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12019, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42737913131713867  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.42436695098876953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12019, 47])
pseudo mini batch 8 input nodes size: 320409
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1262683868408203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24563026428222656  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24572372436523438  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 320409
first layer output nodes number: 114538
edges number: 1135366
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374211311340332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([320409, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374211311340332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1374211311340332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18897676467895508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18897676467895508  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29820871353149414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([114538, 256])
h_self size  torch.Size([114538, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29820871353149414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114538, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4074406623840332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.29820871353149414  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([114538, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4074406623840332  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43474864959716797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 114538
----------------output nodes number: 12513
----------------edges number: 311546
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4356956481933594  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4356956481933594  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45039796829223633  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45039796829223633  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45300960540771484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12513, 47])
h_self size  torch.Size([12513, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45300960540771484  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12513, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4552006721496582  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4525890350341797  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12513, 47])
pseudo mini batch 9 input nodes size: 361841
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12318944931030273  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.25798606872558594  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2580757141113281  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 361841
first layer output nodes number: 118318
edges number: 1171587
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15350055694580078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([361841, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15350055694580078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.15350055694580078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2076129913330078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2076129913330078  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3204498291015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([118318, 256])
h_self size  torch.Size([118318, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3204498291015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([118318, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4332866668701172  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3204498291015625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([118318, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4332866668701172  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.46149587631225586  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 118318
----------------output nodes number: 11981
----------------edges number: 297715
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4624671936035156  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4624671936035156  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4763803482055664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4763803482055664  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4787778854370117  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([11981, 47])
h_self size  torch.Size([11981, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4787778854370117  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11981, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.48087596893310547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47847843170166016  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([11981, 47])
pseudo mini batch 10 input nodes size: 275710
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1381068229675293  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24081707000732422  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.24090909957885742  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 275710
first layer output nodes number: 99455
edges number: 979648
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11847496032714844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([275710, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11847496032714844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.11847496032714844  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16319513320922852  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.16319513320922852  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2580428123474121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([99455, 256])
h_self size  torch.Size([99455, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2580428123474121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([99455, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3528904914855957  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2580428123474121  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([99455, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3528904914855957  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3766026496887207  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 99455
----------------output nodes number: 12330
----------------edges number: 303025
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37743568420410156  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.37743568420410156  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3924884796142578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3924884796142578  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3955812454223633  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12330, 47])
h_self size  torch.Size([12330, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3955812454223633  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12330, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39774036407470703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.39464759826660156  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12330, 47])
pseudo mini batch 11 input nodes size: 317445
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.10608386993408203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22434139251708984  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.22443342208862305  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 317445
first layer output nodes number: 115734
edges number: 1145515
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13598012924194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([317445, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13598012924194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.13598012924194336  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18806171417236328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.18806171417236328  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2984342575073242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([115734, 256])
h_self size  torch.Size([115734, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2984342575073242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115734, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40880680084228516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2984342575073242  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([115734, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.40880680084228516  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4363999366760254  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 115734
----------------output nodes number: 12328
----------------edges number: 306104
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43735456466674805  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.43735456466674805  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4516787528991699  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4516787528991699  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45383739471435547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12328, 47])
h_self size  torch.Size([12328, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45383739471435547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12328, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.455996036529541  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.45383739471435547  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12328, 47])
pseudo mini batch 12 input nodes size: 351777
----------------------------------------before batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.12217521667480469  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2532224655151367  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.25331687927246094  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

first layer input nodes number: 351777
first layer output nodes number: 124894
edges number: 1231806
----------------------------------------before model layer 0
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1504201889038086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([351777, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1504201889038086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.1504201889038086  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2065906524658203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.2065906524658203  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3256988525390625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([124894, 256])
h_self size  torch.Size([124894, 100])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3256988525390625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([124894, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4448070526123047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.3256988525390625  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([124894, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4448070526123047  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47458410263061523  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------input nodes number: 124894
----------------output nodes number: 12614
----------------edges number: 311803
----------------------------------------before mean aggregator
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47560930252075195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.47560930252075195  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49081897735595703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49081897735595703  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49314212799072266  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

h_neigh size torch.Size([12614, 47])
h_self size  torch.Size([12614, 256])
----------------------------------------before rst
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49314212799072266  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12614, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.49535083770751953  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8807373046875 GB
    Memory Allocated: 0.4930276870727539  GigaBytes
Max Memory Allocated: 0.7170991897583008  GigaBytes

torch.Size([12614, 47])
pseudo mini batch 13 input nodes size: 235604
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.13458728790283203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22235679626464844  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22245025634765625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 235604
first layer output nodes number: 87582
edges number: 839595
----------------------------------------before model layer 0
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.10300064086914062  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([235604, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.10300064086914062  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.10300064086914062  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.1422104835510254  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.1422104835510254  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22573518753051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([87582, 256])
h_self size  torch.Size([87582, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22573518753051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([87582, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.30925989151000977  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22573518753051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([87582, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.30925989151000977  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3301410675048828  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 87582
----------------output nodes number: 12517
----------------edges number: 296158
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3308873176574707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3308873176574707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3459587097167969  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3459587097167969  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.34815073013305664  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12517, 47])
h_self size  torch.Size([12517, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.34815073013305664  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12517, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.35035037994384766  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3481583595275879  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12517, 47])
pseudo mini batch 14 input nodes size: 370985
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.09117746353149414  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22938060760498047  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.22947025299072266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 370985
first layer output nodes number: 109021
edges number: 1067491
----------------------------------------before model layer 0
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([370985, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.1559743881225586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.20527935028076172  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.20527935028076172  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3092498779296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([109021, 256])
h_self size  torch.Size([109021, 100])
----------------------------------------before rst
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3092498779296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([109021, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.4132204055786133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.3092498779296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([109021, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.4132204055786133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.43921327590942383  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 109021
----------------output nodes number: 12006
----------------edges number: 270637
----------------------------------------before mean aggregator
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.44011545181274414  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.44011545181274414  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.453671932220459  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.453671932220459  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.45577430725097656  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12006, 47])
h_self size  torch.Size([12006, 256])
----------------------------------------before rst
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.45577430725097656  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12006, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.45787668228149414  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.45577430725097656  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12006, 47])
pseudo mini batch 15 input nodes size: 413655
----------------------------------------before batch input features to device
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 0.14151763916015625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.29581451416015625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.29590368270874023  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 413655
first layer output nodes number: 113324
edges number: 1119799
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1720871925354004  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([413655, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1720871925354004  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1720871925354004  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2230701446533203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2230701446533203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3311443328857422  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([113324, 256])
h_self size  torch.Size([113324, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3311443328857422  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([113324, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43921852111816406  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3311443328857422  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([113324, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43921852111816406  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.46623706817626953  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 113324
----------------output nodes number: 11949
----------------edges number: 283659
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.46717071533203125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.46717071533203125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.48085546493530273  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.48085546493530273  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4836997985839844  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([11949, 47])
h_self size  torch.Size([11949, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4836997985839844  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11949, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4857921600341797  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.48294782638549805  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11949, 47])
Number of nodes for computation during this epoch:  6536522
Number of first layer input nodes during this epoch:  4857664
Number of first layer output nodes during this epoch:  1678858

-----------------------------------------------------------------------------epoch done
read pickle file
0.8117589950561523

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.32927680015563965
global_2_local spend time (sec) 0.5038745403289795

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.074 seconds
Metis partitioning: 13.686 seconds
Split the graph: 1.142 seconds
Construct subgraphs: 0.051 seconds
12635
12384
12595
12109
11935
12185
12433
12644
11927
12201
11947
12026
12226
12620
12365
12339
REG metis partition end ----................................
the time spent:  27.544349670410156
total k batches seeds list generation spend  28.064091682434082
after graph partition
graph partition algorithm spend time 28.64555811882019

partition_len_list
[90336, 110554, 115904, 93921, 90790, 89280, 119778, 97433, 130650, 77765, 111366, 109883, 115634, 115088, 111154, 119379]
REG selection method  spend 29.369834899902344
check_connections_block*********************************
time for parepare 1: 0.24541831016540527
local_output_nid generation: 0.005969047546386719
local_in_edges_tensor generation: 0.01775217056274414
mini_batch_src_global generation: 0.011773109436035156

&&&&&&&&&&&&&&& before remove duplicate length: 299141
&&&&&&&&&&&&&&& after remove duplicate length: 89415

remove duplicate: 0.0522613525390625
r_  generation: 0.04006814956665039

local_output_nid generation: 0.004808902740478516
local_in_edges_tensor generation: 0.007611513137817383
mini_batch_src_global generation: 0.010790109634399414

&&&&&&&&&&&&&&& before remove duplicate length: 304356
&&&&&&&&&&&&&&& after remove duplicate length: 109705

remove duplicate: 0.05961751937866211
r_  generation: 0.0545501708984375

local_output_nid generation: 0.0056264400482177734
local_in_edges_tensor generation: 0.0062139034271240234
mini_batch_src_global generation: 0.011180400848388672

&&&&&&&&&&&&&&& before remove duplicate length: 313046
&&&&&&&&&&&&&&& after remove duplicate length: 115008

remove duplicate: 0.06331539154052734
r_  generation: 0.05818462371826172

local_output_nid generation: 0.004780769348144531
local_in_edges_tensor generation: 0.004685401916503906
mini_batch_src_global generation: 0.013922691345214844

&&&&&&&&&&&&&&& before remove duplicate length: 297853
&&&&&&&&&&&&&&& after remove duplicate length: 93104

remove duplicate: 0.059988975524902344
r_  generation: 0.05114603042602539

local_output_nid generation: 0.00511622428894043
local_in_edges_tensor generation: 0.004370689392089844
mini_batch_src_global generation: 0.009606599807739258

&&&&&&&&&&&&&&& before remove duplicate length: 287520
&&&&&&&&&&&&&&& after remove duplicate length: 90006

remove duplicate: 0.0603029727935791
r_  generation: 0.04990434646606445

local_output_nid generation: 0.004770994186401367
local_in_edges_tensor generation: 0.004355430603027344
mini_batch_src_global generation: 0.010727405548095703

&&&&&&&&&&&&&&& before remove duplicate length: 298476
&&&&&&&&&&&&&&& after remove duplicate length: 88633

remove duplicate: 0.060665130615234375
r_  generation: 0.050559043884277344

local_output_nid generation: 0.00489044189453125
local_in_edges_tensor generation: 0.005367279052734375
mini_batch_src_global generation: 0.011035680770874023

&&&&&&&&&&&&&&& before remove duplicate length: 299633
&&&&&&&&&&&&&&& after remove duplicate length: 118553

remove duplicate: 0.06569600105285645
r_  generation: 0.06195831298828125

local_output_nid generation: 0.00491786003112793
local_in_edges_tensor generation: 0.005288362503051758
mini_batch_src_global generation: 0.012314319610595703

&&&&&&&&&&&&&&& before remove duplicate length: 305019
&&&&&&&&&&&&&&& after remove duplicate length: 96736

remove duplicate: 0.06437873840332031
r_  generation: 0.05500149726867676

local_output_nid generation: 0.004719972610473633
local_in_edges_tensor generation: 0.005159616470336914
mini_batch_src_global generation: 0.011072397232055664

&&&&&&&&&&&&&&& before remove duplicate length: 285101
&&&&&&&&&&&&&&& after remove duplicate length: 127731

remove duplicate: 0.0641326904296875
r_  generation: 0.06484341621398926

local_output_nid generation: 0.004812002182006836
local_in_edges_tensor generation: 0.00429534912109375
mini_batch_src_global generation: 0.01200103759765625

&&&&&&&&&&&&&&& before remove duplicate length: 289011
&&&&&&&&&&&&&&& after remove duplicate length: 76691

remove duplicate: 0.06561541557312012
r_  generation: 0.04251527786254883

local_output_nid generation: 0.004846096038818359
local_in_edges_tensor generation: 0.004868268966674805
mini_batch_src_global generation: 0.010556221008300781

&&&&&&&&&&&&&&& before remove duplicate length: 272355
&&&&&&&&&&&&&&& after remove duplicate length: 107778

remove duplicate: 0.0573728084564209
r_  generation: 0.053458213806152344

local_output_nid generation: 0.004780769348144531
local_in_edges_tensor generation: 0.005057334899902344
mini_batch_src_global generation: 0.011114358901977539

&&&&&&&&&&&&&&& before remove duplicate length: 281148
&&&&&&&&&&&&&&& after remove duplicate length: 106846

remove duplicate: 0.061450958251953125
r_  generation: 0.0571744441986084

local_output_nid generation: 0.004790067672729492
local_in_edges_tensor generation: 0.011795759201049805
mini_batch_src_global generation: 0.012616872787475586

&&&&&&&&&&&&&&& before remove duplicate length: 302770
&&&&&&&&&&&&&&& after remove duplicate length: 114876

remove duplicate: 0.06746268272399902
r_  generation: 0.06271171569824219

local_output_nid generation: 0.004855632781982422
local_in_edges_tensor generation: 0.009450435638427734
mini_batch_src_global generation: 0.01365518569946289

&&&&&&&&&&&&&&& before remove duplicate length: 314250
&&&&&&&&&&&&&&& after remove duplicate length: 114412

remove duplicate: 0.06895732879638672
r_  generation: 0.06299495697021484

local_output_nid generation: 0.0049703121185302734
local_in_edges_tensor generation: 0.005385637283325195
mini_batch_src_global generation: 0.012696027755737305

&&&&&&&&&&&&&&& before remove duplicate length: 307660
&&&&&&&&&&&&&&& after remove duplicate length: 110347

remove duplicate: 0.06677532196044922
r_  generation: 0.06171298027038574

local_output_nid generation: 0.004866600036621094
local_in_edges_tensor generation: 0.005368709564208984
mini_batch_src_global generation: 0.012877702713012695

&&&&&&&&&&&&&&& before remove duplicate length: 306540
&&&&&&&&&&&&&&& after remove duplicate length: 118287

remove duplicate: 0.06735587120056152
r_  generation: 0.06424331665039062


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7858371734619141
gen group dst list time:  0.0644693374633789
check_connections_block*********************************
time for parepare 1: 0.4013941287994385
local_output_nid generation: 0.022527694702148438
local_in_edges_tensor generation: 0.08849978446960449
mini_batch_src_global generation: 0.028576135635375977

&&&&&&&&&&&&&&& before remove duplicate length: 866588
&&&&&&&&&&&&&&& after remove duplicate length: 229771

remove duplicate: 0.16066646575927734
r_  generation: 0.15640950202941895

local_output_nid generation: 0.057804107666015625
local_in_edges_tensor generation: 0.03177332878112793
mini_batch_src_global generation: 0.03573012351989746

&&&&&&&&&&&&&&& before remove duplicate length: 1086244
&&&&&&&&&&&&&&& after remove duplicate length: 284282

remove duplicate: 0.22926115989685059
r_  generation: 0.2214984893798828

local_output_nid generation: 0.036525726318359375
local_in_edges_tensor generation: 0.05316448211669922
mini_batch_src_global generation: 0.031987905502319336

&&&&&&&&&&&&&&& before remove duplicate length: 1147889
&&&&&&&&&&&&&&& after remove duplicate length: 298371

remove duplicate: 0.2682161331176758
r_  generation: 0.23912715911865234

local_output_nid generation: 0.029063701629638672
local_in_edges_tensor generation: 0.024769306182861328
mini_batch_src_global generation: 0.028009414672851562

&&&&&&&&&&&&&&& before remove duplicate length: 920172
&&&&&&&&&&&&&&& after remove duplicate length: 273089

remove duplicate: 0.2312462329864502
r_  generation: 0.22800469398498535

local_output_nid generation: 0.028538942337036133
local_in_edges_tensor generation: 0.02794504165649414
mini_batch_src_global generation: 0.03155827522277832

&&&&&&&&&&&&&&& before remove duplicate length: 872064
&&&&&&&&&&&&&&& after remove duplicate length: 239187

remove duplicate: 0.21059155464172363
r_  generation: 0.19951701164245605

local_output_nid generation: 0.02908492088317871
local_in_edges_tensor generation: 0.026584148406982422
mini_batch_src_global generation: 0.034105539321899414

&&&&&&&&&&&&&&& before remove duplicate length: 869169
&&&&&&&&&&&&&&& after remove duplicate length: 260096

remove duplicate: 0.22055912017822266
r_  generation: 0.2157301902770996

local_output_nid generation: 0.0373682975769043
local_in_edges_tensor generation: 0.03947329521179199
mini_batch_src_global generation: 0.0420985221862793

&&&&&&&&&&&&&&& before remove duplicate length: 1152613
&&&&&&&&&&&&&&& after remove duplicate length: 327864

remove duplicate: 0.2889852523803711
r_  generation: 0.282085657119751

local_output_nid generation: 0.030162811279296875
local_in_edges_tensor generation: 0.02790665626525879
mini_batch_src_global generation: 0.03453707695007324

&&&&&&&&&&&&&&& before remove duplicate length: 932763
&&&&&&&&&&&&&&& after remove duplicate length: 246380

remove duplicate: 0.2432689666748047
r_  generation: 0.22684526443481445

local_output_nid generation: 0.04131126403808594
local_in_edges_tensor generation: 0.04124760627746582
mini_batch_src_global generation: 0.04708242416381836

&&&&&&&&&&&&&&& before remove duplicate length: 1285731
&&&&&&&&&&&&&&& after remove duplicate length: 446859

remove duplicate: 0.3690152168273926
r_  generation: 0.3749232292175293

local_output_nid generation: 0.023500919342041016
local_in_edges_tensor generation: 0.04338526725769043
mini_batch_src_global generation: 0.03280210494995117

&&&&&&&&&&&&&&& before remove duplicate length: 750488
&&&&&&&&&&&&&&& after remove duplicate length: 163145

remove duplicate: 0.17969846725463867
r_  generation: 0.15626955032348633

local_output_nid generation: 0.06127119064331055
local_in_edges_tensor generation: 0.047598838806152344
mini_batch_src_global generation: 0.03493976593017578

&&&&&&&&&&&&&&& before remove duplicate length: 1094751
&&&&&&&&&&&&&&& after remove duplicate length: 402153

remove duplicate: 0.30683374404907227
r_  generation: 0.3174154758453369

local_output_nid generation: 0.03322553634643555
local_in_edges_tensor generation: 0.02993464469909668
mini_batch_src_global generation: 0.04128694534301758

&&&&&&&&&&&&&&& before remove duplicate length: 1078880
&&&&&&&&&&&&&&& after remove duplicate length: 343659

remove duplicate: 0.2931044101715088
r_  generation: 0.3012204170227051

local_output_nid generation: 0.03574013710021973
local_in_edges_tensor generation: 0.03203988075256348
mini_batch_src_global generation: 0.04132080078125

&&&&&&&&&&&&&&& before remove duplicate length: 1141603
&&&&&&&&&&&&&&& after remove duplicate length: 336244

remove duplicate: 0.29778432846069336
r_  generation: 0.297743558883667

local_output_nid generation: 0.03397035598754883
local_in_edges_tensor generation: 0.03776288032531738
mini_batch_src_global generation: 0.0406496524810791

&&&&&&&&&&&&&&& before remove duplicate length: 1140767
&&&&&&&&&&&&&&& after remove duplicate length: 302379

remove duplicate: 0.298351526260376
r_  generation: 0.2692534923553467

local_output_nid generation: 0.03396487236022949
local_in_edges_tensor generation: 0.032216787338256836
mini_batch_src_global generation: 0.0597233772277832

&&&&&&&&&&&&&&& before remove duplicate length: 1099296
&&&&&&&&&&&&&&& after remove duplicate length: 274626

remove duplicate: 0.27540135383605957
r_  generation: 0.25959134101867676

local_output_nid generation: 0.04911327362060547
local_in_edges_tensor generation: 0.10557699203491211
mini_batch_src_global generation: 0.04198718070983887

&&&&&&&&&&&&&&& before remove duplicate length: 1182258
&&&&&&&&&&&&&&& after remove duplicate length: 340914

remove duplicate: 0.3072824478149414
r_  generation: 0.2945873737335205


connection checking time:  15.437732458114624
block generation total time  13.238081693649292
block dataloader generation time/epoch 59.310490131378174
pseudo mini batch 0 input nodes size: 243921
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.15759992599487305  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24846792221069336  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24856233596801758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 243921
first layer output nodes number: 90336
edges number: 866588
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1060786247253418  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([243921, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1060786247253418  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1060786247253418  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14652538299560547  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14652538299560547  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23267650604248047  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([90336, 256])
h_self size  torch.Size([90336, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23267650604248047  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([90336, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.31882762908935547  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23267650604248047  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([90336, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.31882762908935547  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3403654098510742  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 90336
----------------output nodes number: 12635
----------------edges number: 299141
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34113311767578125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34113311767578125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.35550689697265625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.35550689697265625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3578648567199707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12635, 47])
h_self size  torch.Size([12635, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3578648567199707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12635, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3600773811340332  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.35771942138671875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12635, 47])
pseudo mini batch 1 input nodes size: 298437
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.09429740905761719  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2054738998413086  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.20556640625  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 298437
first layer output nodes number: 110554
edges number: 1086244
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12811279296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([298437, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12811279296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12811279296875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.17840147018432617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.17840147018432617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.28383398056030273  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([110554, 256])
h_self size  torch.Size([110554, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.28383398056030273  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([110554, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3892664909362793  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.28383398056030273  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([110554, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3892664909362793  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.41562461853027344  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 110554
----------------output nodes number: 12384
----------------edges number: 304356
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.41654109954833984  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.41654109954833984  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4307117462158203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4307117462158203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4328804016113281  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12384, 47])
h_self size  torch.Size([12384, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4328804016113281  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12384, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43504905700683594  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4328804016113281  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12384, 47])
pseudo mini batch 2 input nodes size: 310457
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11456012725830078  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23021459579467773  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23030853271484375  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 310457
first layer output nodes number: 115904
edges number: 1147889
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.13357782363891602  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([310457, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.13357782363891602  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.13357782363891602  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.18668460845947266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.18668460845947266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.29721927642822266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([115904, 256])
h_self size  torch.Size([115904, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.29721927642822266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([115904, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.40775394439697266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.29721927642822266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([115904, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.40775394439697266  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43538761138916016  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 115904
----------------output nodes number: 12595
----------------edges number: 313046
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43634510040283203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.43634510040283203  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4508180618286133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4508180618286133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45315074920654297  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12595, 47])
h_self size  torch.Size([12595, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45315074920654297  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12595, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4556450843811035  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45331239700317383  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12595, 47])
pseudo mini batch 3 input nodes size: 284999
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11907625198364258  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.22524690628051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.22533750534057617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 284999
first layer output nodes number: 93921
edges number: 920172
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12269926071166992  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([284999, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12269926071166992  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.12269926071166992  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1651611328125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1651611328125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2547311782836914  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([93921, 256])
h_self size  torch.Size([93921, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2547311782836914  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([93921, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3443012237548828  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.2547311782836914  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([93921, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3443012237548828  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36669397354125977  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 93921
----------------output nodes number: 12109
----------------edges number: 297853
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36748456954956055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36748456954956055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38154077529907227  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38154077529907227  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38366127014160156  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12109, 47])
h_self size  torch.Size([12109, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38366127014160156  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12109, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38597917556762695  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38385868072509766  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12109, 47])
pseudo mini batch 4 input nodes size: 250146
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.10950422286987305  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.20269107818603516  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.20278024673461914  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 250146
first layer output nodes number: 90790
edges number: 872064
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.10852384567260742  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([250146, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.10852384567260742  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.10852384567260742  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14918184280395508  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14918184280395508  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23576593399047852  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([90790, 256])
h_self size  torch.Size([90790, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23576593399047852  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([90790, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.32235002517700195  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23576593399047852  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([90790, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.32235002517700195  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34439754486083984  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 90790
----------------output nodes number: 11935
----------------edges number: 287520
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34516334533691406  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34516334533691406  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.35888671875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.35888671875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36172056198120117  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([11935, 47])
h_self size  torch.Size([11935, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36172056198120117  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11935, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36391544342041016  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.361081600189209  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11935, 47])
pseudo mini batch 5 input nodes size: 271358
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.09648847579956055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.19757747650146484  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.19766855239868164  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 271358
first layer output nodes number: 89280
edges number: 869169
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11591672897338867  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([271358, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11591672897338867  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11591672897338867  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.15609121322631836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.15609121322631836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24123525619506836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([89280, 256])
h_self size  torch.Size([89280, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24123525619506836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([89280, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.32637929916381836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24123525619506836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([89280, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.32637929916381836  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.34766530990600586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 89280
----------------output nodes number: 12185
----------------edges number: 298476
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.348421573638916  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.348421573638916  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36235761642456055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36235761642456055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3648824691772461  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12185, 47])
h_self size  torch.Size([12185, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3648824691772461  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12185, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3670163154602051  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36449146270751953  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12185, 47])
pseudo mini batch 6 input nodes size: 341241
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.10443639755249023  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23155879974365234  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.23165178298950195  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 341241
first layer output nodes number: 119778
edges number: 1152613
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14487981796264648  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([341241, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14487981796264648  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.14487981796264648  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1988358497619629  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1988358497619629  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3130650520324707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([119778, 256])
h_self size  torch.Size([119778, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3130650520324707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([119778, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4272942543029785  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3130650520324707  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([119778, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4272942543029785  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45585155487060547  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 119778
----------------output nodes number: 12433
----------------edges number: 299633
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45683717727661133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.45683717727661133  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4714083671569824  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4714083671569824  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4735856056213379  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12433, 47])
h_self size  torch.Size([12433, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4735856056213379  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12433, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.47576284408569336  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.4735856056213379  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12433, 47])
pseudo mini batch 7 input nodes size: 256824
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.13051509857177734  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.22618961334228516  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.22628402709960938  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 256824
first layer output nodes number: 97433
edges number: 932763
----------------------------------------before model layer 0
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11098909378051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([256824, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11098909378051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.11098909378051758  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1552419662475586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.1552419662475586  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24816131591796875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([97433, 256])
h_self size  torch.Size([97433, 100])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24816131591796875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([97433, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3410806655883789  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.24816131591796875  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([97433, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3410806655883789  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.36431074142456055  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 97433
----------------output nodes number: 12644
----------------edges number: 305019
----------------------------------------before mean aggregator
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3651313781738281  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3651313781738281  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.37955665588378906  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.37955665588378906  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38177061080932617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([12644, 47])
h_self size  torch.Size([12644, 256])
----------------------------------------before rst
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38177061080932617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12644, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.3839845657348633  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.38177061080932617  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([12644, 47])
pseudo mini batch 8 input nodes size: 466903
----------------------------------------before batch input features to device
 Nvidia-smi: 9.1561279296875 GB
    Memory Allocated: 0.0991053581237793  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3319091796875 GB
    Memory Allocated: 0.2730402946472168  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3319091796875 GB
    Memory Allocated: 0.2731294631958008  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

first layer input nodes number: 466903
first layer output nodes number: 130650
edges number: 1285731
----------------------------------------before model layer 0
 Nvidia-smi: 9.3319091796875 GB
    Memory Allocated: 0.19477081298828125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([466903, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3319091796875 GB
    Memory Allocated: 0.19477081298828125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3319091796875 GB
    Memory Allocated: 0.19477081298828125  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.25388050079345703  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.25388050079345703  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.37888050079345703  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([130650, 256])
h_self size  torch.Size([130650, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.37888050079345703  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([130650, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5034780502319336  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.3784780502319336  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([130650, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5034780502319336  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5342249870300293  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------input nodes number: 130650
----------------output nodes number: 11927
----------------edges number: 285101
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5352878570556641  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5352878570556641  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5491499900817871  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5491499900817871  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5518770217895508  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5518770217895508  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5539655685424805  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3338623046875 GB
    Memory Allocated: 0.5512385368347168  GigaBytes
Max Memory Allocated: 0.7193999290466309  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 9 input nodes size: 169679
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1778736114501953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24108409881591797  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24117517471313477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 169679
first layer output nodes number: 77765
edges number: 750488
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.077545166015625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([169679, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.077545166015625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.077545166015625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1123971939086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1123971939086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18655967712402344  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([77765, 256])
h_self size  torch.Size([77765, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18655967712402344  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([77765, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26072216033935547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18655967712402344  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([77765, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26072216033935547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2792630195617676  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 77765
----------------output nodes number: 12201
----------------edges number: 289011
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2799339294433594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2799339294433594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29413557052612305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29413557052612305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29627227783203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12201, 47])
h_self size  torch.Size([12201, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29627227783203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12201, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29840898513793945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29627227783203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12201, 47])
pseudo mini batch 10 input nodes size: 422747
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.06656074523925781  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2240467071533203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2241358757019043  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 422747
first layer output nodes number: 111366
edges number: 1094751
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17566633224487305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([422747, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17566633224487305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17566633224487305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22572565078735352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22572565078735352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.33193254470825195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([111366, 256])
h_self size  torch.Size([111366, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.33193254470825195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111366, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4381394386291504  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.33193254470825195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111366, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4381394386291504  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.464691162109375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 111366
----------------output nodes number: 11947
----------------edges number: 272355
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4656105041503906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4656105041503906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4791231155395508  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4791231155395508  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4819464683532715  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11947, 47])
h_self size  torch.Size([11947, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4819464683532715  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11947, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4840383529663086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4812150001525879  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11947, 47])
pseudo mini batch 11 input nodes size: 360184
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16152095794677734  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2957000732421875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2957897186279297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 360184
first layer output nodes number: 109883
edges number: 1078880
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15218210220336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([360184, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15218210220336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15218210220336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20156526565551758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20156526565551758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30635786056518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([109883, 256])
h_self size  torch.Size([109883, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30635786056518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109883, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4111504554748535  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30635786056518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109883, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4111504554748535  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4373488426208496  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 109883
----------------output nodes number: 12026
----------------edges number: 281148
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43825721740722656  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43825721740722656  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45191097259521484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45191097259521484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45401668548583984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12026, 47])
h_self size  torch.Size([12026, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45401668548583984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12026, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45612239837646484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45401668548583984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12026, 47])
pseudo mini batch 12 input nodes size: 349713
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1374969482421875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2683563232421875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2684478759765625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 349713
first layer output nodes number: 115634
edges number: 1141603
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14883661270141602  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([349713, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14883661270141602  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14883661270141602  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2008509635925293  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2008509635925293  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3111281394958496  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([115634, 256])
h_self size  torch.Size([115634, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3111281394958496  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115634, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4214053153991699  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3111281394958496  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115634, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4214053153991699  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.448974609375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 115634
----------------output nodes number: 12226
----------------edges number: 302770
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44992780685424805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44992780685424805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46465158462524414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46465158462524414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46715307235717773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12226, 47])
h_self size  torch.Size([12226, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46715307235717773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12226, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46929407119750977  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46679258346557617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12226, 47])
pseudo mini batch 13 input nodes size: 315149
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13457489013671875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.25197744369506836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2520718574523926  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 315149
first layer output nodes number: 115088
edges number: 1140767
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1362762451171875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([315149, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1362762451171875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1362762451171875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18829965591430664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18829965591430664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29805612564086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([115088, 256])
h_self size  torch.Size([115088, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29805612564086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115088, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.40781259536743164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29805612564086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.40781259536743164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43525171279907227  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 115088
----------------output nodes number: 12620
----------------edges number: 314250
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4362039566040039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4362039566040039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45146989822387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45146989822387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4538116455078125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12620, 47])
h_self size  torch.Size([12620, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4538116455078125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12620, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4560213088989258  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45367956161499023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12620, 47])
pseudo mini batch 14 input nodes size: 286379
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12082910537719727  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22751379013061523  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22760629653930664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 286379
first layer output nodes number: 111154
edges number: 1099296
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12433433532714844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([286379, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12433433532714844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12433433532714844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1743483543395996  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1743483543395996  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2803530693054199  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([111154, 256])
h_self size  torch.Size([111154, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2803530693054199  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111154, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.38635778427124023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2803530693054199  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111154, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.38635778427124023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4128589630126953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 111154
----------------output nodes number: 12365
----------------edges number: 307660
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41377973556518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41377973556518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42881345748901367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42881345748901367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43097877502441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12365, 47])
h_self size  torch.Size([12365, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43097877502441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12365, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43314409255981445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43097877502441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12365, 47])
pseudo mini batch 15 input nodes size: 355086
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11006498336791992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24234485626220703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24243688583374023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 355086
first layer output nodes number: 119379
edges number: 1182258
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1504683494567871  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([355086, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1504683494567871  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1504683494567871  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20464420318603516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20464420318603516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3184928894042969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([119379, 256])
h_self size  torch.Size([119379, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3184928894042969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([119379, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4323415756225586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3184928894042969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([119379, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4323415756225586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4608039855957031  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 119379
----------------output nodes number: 12339
----------------edges number: 306540
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46178579330444336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46178579330444336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47641706466674805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47641706466674805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4785776138305664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12339, 47])
h_self size  torch.Size([12339, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4785776138305664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12339, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.48073816299438477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4785776138305664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12339, 47])
Average training time/epoch 1.2662930488586426
Average Training time/epoch w/o nid counting 1.2643458843231201
Number of nodes for computation during this epoch:  6682138
Number of first layer input nodes during this epoch:  4983223
Number of first layer output nodes during this epoch:  1698915

-----------------------------------------------------------------------------epoch done
read pickle file
0.780752420425415

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.23393464088439941
global_2_local spend time (sec) 0.4397704601287842

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.987 seconds
Metis partitioning: 13.295 seconds
Split the graph: 1.259 seconds
Construct subgraphs: 0.045 seconds
11929
12593
12151
12604
12081
12065
12186
11954
12035
12583
12473
11927
12617
12247
12586
12540
REG metis partition end ----................................
the time spent:  27.071720361709595
total k batches seeds list generation spend  27.66121745109558
after graph partition
graph partition algorithm spend time 28.26885461807251

partition_len_list
[108564, 90213, 116416, 119855, 105121, 110874, 112949, 120946, 90030, 117371, 80564, 91485, 123444, 96389, 96186, 115078]
REG selection method  spend 28.914952039718628
check_connections_block*********************************
time for parepare 1: 0.22292661666870117
local_output_nid generation: 0.004002809524536133
local_in_edges_tensor generation: 0.004812002182006836
mini_batch_src_global generation: 0.011552095413208008

&&&&&&&&&&&&&&& before remove duplicate length: 292133
&&&&&&&&&&&&&&& after remove duplicate length: 106761

remove duplicate: 0.05318784713745117
r_  generation: 0.04606032371520996

local_output_nid generation: 0.004872798919677734
local_in_edges_tensor generation: 0.004885196685791016
mini_batch_src_global generation: 0.01128840446472168

&&&&&&&&&&&&&&& before remove duplicate length: 298112
&&&&&&&&&&&&&&& after remove duplicate length: 89228

remove duplicate: 0.056648969650268555
r_  generation: 0.045296430587768555

local_output_nid generation: 0.00477147102355957
local_in_edges_tensor generation: 0.005502939224243164
mini_batch_src_global generation: 0.008127689361572266

&&&&&&&&&&&&&&& before remove duplicate length: 300574
&&&&&&&&&&&&&&& after remove duplicate length: 115178

remove duplicate: 0.061296701431274414
r_  generation: 0.05652737617492676

local_output_nid generation: 0.00495147705078125
local_in_edges_tensor generation: 0.005789518356323242
mini_batch_src_global generation: 0.010574579238891602

&&&&&&&&&&&&&&& before remove duplicate length: 313819
&&&&&&&&&&&&&&& after remove duplicate length: 119041

remove duplicate: 0.06673955917358398
r_  generation: 0.062018394470214844

local_output_nid generation: 0.004819631576538086
local_in_edges_tensor generation: 0.00438380241394043
mini_batch_src_global generation: 0.009863853454589844

&&&&&&&&&&&&&&& before remove duplicate length: 279648
&&&&&&&&&&&&&&& after remove duplicate length: 102481

remove duplicate: 0.05890154838562012
r_  generation: 0.05580449104309082

local_output_nid generation: 0.004769802093505859
local_in_edges_tensor generation: 0.004529476165771484
mini_batch_src_global generation: 0.014419794082641602

&&&&&&&&&&&&&&& before remove duplicate length: 298720
&&&&&&&&&&&&&&& after remove duplicate length: 110179

remove duplicate: 0.06604647636413574
r_  generation: 0.06012892723083496

local_output_nid generation: 0.004827737808227539
local_in_edges_tensor generation: 0.0046539306640625
mini_batch_src_global generation: 0.011322736740112305

&&&&&&&&&&&&&&& before remove duplicate length: 301191
&&&&&&&&&&&&&&& after remove duplicate length: 111574

remove duplicate: 0.07343626022338867
r_  generation: 0.06228828430175781

local_output_nid generation: 0.00478816032409668
local_in_edges_tensor generation: 0.004532337188720703
mini_batch_src_global generation: 0.010927438735961914

&&&&&&&&&&&&&&& before remove duplicate length: 277109
&&&&&&&&&&&&&&& after remove duplicate length: 117821

remove duplicate: 0.06461596488952637
r_  generation: 0.06383728981018066

local_output_nid generation: 0.004840373992919922
local_in_edges_tensor generation: 0.0046100616455078125
mini_batch_src_global generation: 0.011927127838134766

&&&&&&&&&&&&&&& before remove duplicate length: 294224
&&&&&&&&&&&&&&& after remove duplicate length: 89305

remove duplicate: 0.06348657608032227
r_  generation: 0.05569744110107422

local_output_nid generation: 0.004934549331665039
local_in_edges_tensor generation: 0.00600433349609375
mini_batch_src_global generation: 0.012332439422607422

&&&&&&&&&&&&&&& before remove duplicate length: 312103
&&&&&&&&&&&&&&& after remove duplicate length: 116567

remove duplicate: 0.07104802131652832
r_  generation: 0.06417059898376465

local_output_nid generation: 0.00501561164855957
local_in_edges_tensor generation: 0.0045888423919677734
mini_batch_src_global generation: 0.013425111770629883

&&&&&&&&&&&&&&& before remove duplicate length: 294516
&&&&&&&&&&&&&&& after remove duplicate length: 79440

remove duplicate: 0.0554203987121582
r_  generation: 0.04297590255737305

local_output_nid generation: 0.004775047302246094
local_in_edges_tensor generation: 0.004851341247558594
mini_batch_src_global generation: 0.010761022567749023

&&&&&&&&&&&&&&& before remove duplicate length: 287424
&&&&&&&&&&&&&&& after remove duplicate length: 90402

remove duplicate: 0.061455726623535156
r_  generation: 0.04922628402709961

local_output_nid generation: 0.0050013065338134766
local_in_edges_tensor generation: 0.00463557243347168
mini_batch_src_global generation: 0.01197052001953125

&&&&&&&&&&&&&&& before remove duplicate length: 312598
&&&&&&&&&&&&&&& after remove duplicate length: 122429

remove duplicate: 0.07299184799194336
r_  generation: 0.06343531608581543

local_output_nid generation: 0.004926919937133789
local_in_edges_tensor generation: 0.004873991012573242
mini_batch_src_global generation: 0.012248754501342773

&&&&&&&&&&&&&&& before remove duplicate length: 295293
&&&&&&&&&&&&&&& after remove duplicate length: 95478

remove duplicate: 0.06379079818725586
r_  generation: 0.05608177185058594

local_output_nid generation: 0.005002021789550781
local_in_edges_tensor generation: 0.00458216667175293
mini_batch_src_global generation: 0.012037277221679688

&&&&&&&&&&&&&&& before remove duplicate length: 303832
&&&&&&&&&&&&&&& after remove duplicate length: 95388

remove duplicate: 0.0662386417388916
r_  generation: 0.053571224212646484

local_output_nid generation: 0.00499725341796875
local_in_edges_tensor generation: 0.00444340705871582
mini_batch_src_global generation: 0.012072563171386719

&&&&&&&&&&&&&&& before remove duplicate length: 302583
&&&&&&&&&&&&&&& after remove duplicate length: 113941

remove duplicate: 0.07065486907958984
r_  generation: 0.06131267547607422


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.768989086151123
gen group dst list time:  0.05682086944580078
check_connections_block*********************************
time for parepare 1: 0.3744802474975586
local_output_nid generation: 0.02894878387451172
local_in_edges_tensor generation: 0.0942223072052002
mini_batch_src_global generation: 0.03574848175048828

&&&&&&&&&&&&&&& before remove duplicate length: 1071981
&&&&&&&&&&&&&&& after remove duplicate length: 330666

remove duplicate: 0.20213890075683594
r_  generation: 0.23482990264892578

local_output_nid generation: 0.02698683738708496
local_in_edges_tensor generation: 0.0243837833404541
mini_batch_src_global generation: 0.027342796325683594

&&&&&&&&&&&&&&& before remove duplicate length: 865740
&&&&&&&&&&&&&&& after remove duplicate length: 229696

remove duplicate: 0.1826171875
r_  generation: 0.1809241771697998

local_output_nid generation: 0.036072731018066406
local_in_edges_tensor generation: 0.06207585334777832
mini_batch_src_global generation: 0.03181099891662598

&&&&&&&&&&&&&&& before remove duplicate length: 1151780
&&&&&&&&&&&&&&& after remove duplicate length: 338313

remove duplicate: 0.2839348316192627
r_  generation: 0.27282118797302246

local_output_nid generation: 0.03525900840759277
local_in_edges_tensor generation: 0.03530406951904297
mini_batch_src_global generation: 0.04072284698486328

&&&&&&&&&&&&&&& before remove duplicate length: 1188160
&&&&&&&&&&&&&&& after remove duplicate length: 316544

remove duplicate: 0.2812223434448242
r_  generation: 0.2730388641357422

local_output_nid generation: 0.032885074615478516
local_in_edges_tensor generation: 0.03164339065551758
mini_batch_src_global generation: 0.03601527214050293

&&&&&&&&&&&&&&& before remove duplicate length: 1035101
&&&&&&&&&&&&&&& after remove duplicate length: 343239

remove duplicate: 0.27807164192199707
r_  generation: 0.27710938453674316

local_output_nid generation: 0.059557437896728516
local_in_edges_tensor generation: 0.04433631896972656
mini_batch_src_global generation: 0.03909802436828613

&&&&&&&&&&&&&&& before remove duplicate length: 1091293
&&&&&&&&&&&&&&& after remove duplicate length: 305957

remove duplicate: 0.2743375301361084
r_  generation: 0.2673797607421875

local_output_nid generation: 0.03430008888244629
local_in_edges_tensor generation: 0.04962921142578125
mini_batch_src_global generation: 0.03825664520263672

&&&&&&&&&&&&&&& before remove duplicate length: 1119171
&&&&&&&&&&&&&&& after remove duplicate length: 330549

remove duplicate: 0.2785685062408447
r_  generation: 0.2722163200378418

local_output_nid generation: 0.03686237335205078
local_in_edges_tensor generation: 0.03408193588256836
mini_batch_src_global generation: 0.044045448303222656

&&&&&&&&&&&&&&& before remove duplicate length: 1185222
&&&&&&&&&&&&&&& after remove duplicate length: 410659

remove duplicate: 0.3370232582092285
r_  generation: 0.35982465744018555

local_output_nid generation: 0.029584407806396484
local_in_edges_tensor generation: 0.024679183959960938
mini_batch_src_global generation: 0.03507876396179199

&&&&&&&&&&&&&&& before remove duplicate length: 875097
&&&&&&&&&&&&&&& after remove duplicate length: 267920

remove duplicate: 0.23126649856567383
r_  generation: 0.2322981357574463

local_output_nid generation: 0.03551149368286133
local_in_edges_tensor generation: 0.050000667572021484
mini_batch_src_global generation: 0.040326595306396484

&&&&&&&&&&&&&&& before remove duplicate length: 1161720
&&&&&&&&&&&&&&& after remove duplicate length: 329664

remove duplicate: 0.2918055057525635
r_  generation: 0.27612924575805664

local_output_nid generation: 0.023795127868652344
local_in_edges_tensor generation: 0.024419069290161133
mini_batch_src_global generation: 0.032633066177368164

&&&&&&&&&&&&&&& before remove duplicate length: 776507
&&&&&&&&&&&&&&& after remove duplicate length: 171995

remove duplicate: 0.16473841667175293
r_  generation: 0.15410065650939941

local_output_nid generation: 0.04483461380004883
local_in_edges_tensor generation: 0.023495197296142578
mini_batch_src_global generation: 0.02987194061279297

&&&&&&&&&&&&&&& before remove duplicate length: 888959
&&&&&&&&&&&&&&& after remove duplicate length: 246094

remove duplicate: 0.22324347496032715
r_  generation: 0.20380043983459473

local_output_nid generation: 0.04755067825317383
local_in_edges_tensor generation: 0.06890034675598145
mini_batch_src_global generation: 0.04597806930541992

&&&&&&&&&&&&&&& before remove duplicate length: 1220453
&&&&&&&&&&&&&&& after remove duplicate length: 357602

remove duplicate: 0.3399081230163574
r_  generation: 0.3200979232788086

local_output_nid generation: 0.03813910484313965
local_in_edges_tensor generation: 0.031867265701293945
mini_batch_src_global generation: 0.039633989334106445

&&&&&&&&&&&&&&& before remove duplicate length: 928691
&&&&&&&&&&&&&&& after remove duplicate length: 252242

remove duplicate: 0.23371338844299316
r_  generation: 0.2212672233581543

local_output_nid generation: 0.03006911277770996
local_in_edges_tensor generation: 0.024639129638671875
mini_batch_src_global generation: 0.03290724754333496

&&&&&&&&&&&&&&& before remove duplicate length: 920354
&&&&&&&&&&&&&&& after remove duplicate length: 244447

remove duplicate: 0.22566938400268555
r_  generation: 0.20656132698059082

local_output_nid generation: 0.03453254699707031
local_in_edges_tensor generation: 0.02784252166748047
mini_batch_src_global generation: 0.03806042671203613

&&&&&&&&&&&&&&& before remove duplicate length: 1107618
&&&&&&&&&&&&&&& after remove duplicate length: 300234

remove duplicate: 0.27131080627441406
r_  generation: 0.25462889671325684


connection checking time:  15.124357461929321
block generation total time  13.195271015167236
block dataloader generation time/epoch 58.84841775894165
pseudo mini batch 0 input nodes size: 346828
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13565397262573242  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26485776901245117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26494693756103516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 346828
first layer output nodes number: 108564
edges number: 1071981
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1466999053955078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([346828, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1466999053955078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1466999053955078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19602012634277344  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19602012634277344  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29955482482910156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([108564, 256])
h_self size  torch.Size([108564, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29955482482910156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([108564, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4030895233154297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29955482482910156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([108564, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4030895233154297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4289731979370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 108564
----------------output nodes number: 11929
----------------edges number: 292133
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4298715591430664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4298715591430664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44419240951538086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44419240951538086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44628143310546875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11929, 47])
h_self size  torch.Size([11929, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44628143310546875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11929, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44837045669555664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44628143310546875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11929, 47])
pseudo mini batch 1 input nodes size: 243915
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13250446319580078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22337007522583008  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2234640121459961  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 243915
first layer output nodes number: 90213
edges number: 865740
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10627174377441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([243915, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10627174377441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10627174377441406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1466655731201172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1466655731201172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23269939422607422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([90213, 256])
h_self size  torch.Size([90213, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23269939422607422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90213, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31873321533203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23269939422607422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90213, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31873321533203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3402419090270996  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 90213
----------------output nodes number: 12593
----------------edges number: 298112
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34100818634033203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34100818634033203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3553333282470703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3553333282470703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35753822326660156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12593, 47])
h_self size  torch.Size([12593, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35753822326660156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12593, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36065006256103516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3584451675415039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12593, 47])
pseudo mini batch 2 input nodes size: 352518
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.09428691864013672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22561025619506836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22570085525512695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 352518
first layer output nodes number: 116416
edges number: 1151780
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1492013931274414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([352518, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1492013931274414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1492013931274414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2015857696533203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2015857696533203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3126087188720703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([116416, 256])
h_self size  torch.Size([116416, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3126087188720703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([116416, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4236316680908203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3126087188720703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([116416, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4236316680908203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4513874053955078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 116416
----------------output nodes number: 12151
----------------edges number: 300574
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4523453712463379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4523453712463379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46669769287109375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46669769287109375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4688253402709961  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12151, 47])
h_self size  torch.Size([12151, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4688253402709961  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12151, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47095298767089844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4688253402709961  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12151, 47])
pseudo mini batch 3 input nodes size: 328405
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13466405868530273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2570047378540039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2570986747741699  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 328405
first layer output nodes number: 119855
edges number: 1188160
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14036989212036133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([328405, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14036989212036133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14036989212036133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1943192481994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1943192481994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3095536231994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([119855, 256])
h_self size  torch.Size([119855, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3095536231994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([119855, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4247879981994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3095536231994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([119855, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4247879981994629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45336389541625977  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 119855
----------------output nodes number: 12604
----------------edges number: 313819
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45435094833374023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45435094833374023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46978139877319336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46978139877319336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4719886779785156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12604, 47])
h_self size  torch.Size([12604, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4719886779785156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12604, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4750852584838867  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47287797927856445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12604, 47])
pseudo mini batch 4 input nodes size: 359824
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1257643699645996  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2598094940185547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2598996162414551  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 359824
first layer output nodes number: 105121
edges number: 1035101
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15113162994384766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([359824, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15113162994384766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15113162994384766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19864702224731445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19864702224731445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29889822006225586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([105121, 256])
h_self size  torch.Size([105121, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29889822006225586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([105121, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39914941787719727  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29889822006225586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([105121, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39914941787719727  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4242124557495117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 105121
----------------output nodes number: 12081
----------------edges number: 279648
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42508602142333984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42508602142333984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4390549659729004  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4390549659729004  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44117021560668945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12081, 47])
h_self size  torch.Size([12081, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44117021560668945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12081, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4432854652404785  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44117021560668945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12081, 47])
pseudo mini batch 5 input nodes size: 320591
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1373729705810547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2568025588989258  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.25689268112182617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 320591
first layer output nodes number: 110874
edges number: 1091293
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13672161102294922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([320591, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13672161102294922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13672161102294922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18692874908447266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18692874908447266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2926664352416992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([110874, 256])
h_self size  torch.Size([110874, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2926664352416992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([110874, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3984041213989258  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2926664352416992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([110874, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3984041213989258  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4248385429382324  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 110874
----------------output nodes number: 12065
----------------edges number: 298720
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42575502395629883  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42575502395629883  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43982362747192383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43982362747192383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44232845306396484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12065, 47])
h_self size  torch.Size([12065, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44232845306396484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12065, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4444413185119629  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4419364929199219  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12065, 47])
pseudo mini batch 6 input nodes size: 345752
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12275505065917969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2515578269958496  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2516489028930664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 345752
first layer output nodes number: 112949
edges number: 1119171
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14768552780151367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([345752, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14768552780151367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14768552780151367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1991133689880371  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1991133689880371  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30682992935180664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([112949, 256])
h_self size  torch.Size([112949, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30682992935180664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112949, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41454648971557617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30682992935180664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112949, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41454648971557617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44147586822509766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 112949
----------------output nodes number: 12186
----------------edges number: 301191
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44240856170654297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44240856170654297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4569664001464844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4569664001464844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45910024642944336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12186, 47])
h_self size  torch.Size([12186, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45910024642944336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12186, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.461855411529541  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45972156524658203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12186, 47])
pseudo mini batch 7 input nodes size: 430158
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13215017318725586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29239654541015625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29248571395874023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 430158
first layer output nodes number: 120946
edges number: 1185222
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17906761169433594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([430158, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17906761169433594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17906761169433594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23340559005737305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23340559005737305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34874868392944336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([120946, 256])
h_self size  torch.Size([120946, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34874868392944336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([120946, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46409177780151367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34874868392944336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([120946, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46409177780151367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49292755126953125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 120946
----------------output nodes number: 11954
----------------edges number: 277109
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49391794204711914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49391794204711914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5074725151062012  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5074725151062012  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5102953910827637  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11954, 47])
h_self size  torch.Size([11954, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5102953910827637  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11954, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5123887062072754  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.5095658302307129  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11954, 47])
pseudo mini batch 8 input nodes size: 279714
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16355133056640625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26775312423706055  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26784324645996094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 279714
first layer output nodes number: 90030
edges number: 875097
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11922979354858398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([279714, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11922979354858398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11922979354858398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15962457656860352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15962457656860352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2454838752746582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([90030, 256])
h_self size  torch.Size([90030, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2454838752746582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90030, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3313431739807129  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2454838752746582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90030, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3313431739807129  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35280799865722656  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 90030
----------------output nodes number: 12035
----------------edges number: 294224
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35356903076171875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35356903076171875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3675651550292969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3675651550292969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3696727752685547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12035, 47])
h_self size  torch.Size([12035, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3696727752685547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12035, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3717803955078125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3696727752685547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12035, 47])
pseudo mini batch 9 input nodes size: 342615
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10752201080322266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23515605926513672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23524999618530273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 342615
first layer output nodes number: 117371
edges number: 1161720
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14632177352905273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([342615, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14632177352905273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14632177352905273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19913911819458008  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19913911819458008  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31107282638549805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([117371, 256])
h_self size  torch.Size([117371, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31107282638549805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([117371, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.423006534576416  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31107282638549805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([117371, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.423006534576416  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4509902000427246  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 117371
----------------output nodes number: 12583
----------------edges number: 312103
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45195865631103516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45195865631103516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46708250045776367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46708250045776367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4692859649658203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12583, 47])
h_self size  torch.Size([12583, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4692859649658203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12583, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47148942947387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4692859649658203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12583, 47])
pseudo mini batch 10 input nodes size: 178843
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13105392456054688  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1976785659790039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19777154922485352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 178843
first layer output nodes number: 80564
edges number: 776507
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.0799570083618164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([178843, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.0799570083618164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.0799570083618164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11605596542358398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11605596542358398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1928877830505371  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([80564, 256])
h_self size  torch.Size([80564, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1928877830505371  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([80564, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26971960067749023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1928877830505371  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([80564, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26971960067749023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.28925085067749023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 80564
----------------output nodes number: 12473
----------------edges number: 294516
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2899441719055176  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2899441719055176  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3049468994140625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3049468994140625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3071308135986328  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12473, 47])
h_self size  torch.Size([12473, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3071308135986328  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12473, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3093147277832031  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3071308135986328  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12473, 47])
pseudo mini batch 11 input nodes size: 256642
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.07002401351928711  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16563081741333008  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16571998596191406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 256642
first layer output nodes number: 91485
edges number: 888959
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11036205291748047  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([256642, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11036205291748047  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11036205291748047  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15140724182128906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15140724182128906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23865413665771484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([91485, 256])
h_self size  torch.Size([91485, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23865413665771484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([91485, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3259010314941406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23865413665771484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([91485, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3259010314941406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.34771299362182617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 91485
----------------output nodes number: 11927
----------------edges number: 287424
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3484840393066406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3484840393066406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36214542388916016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36214542388916016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36423397064208984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36423397064208984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36632251739501953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36423397064208984  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 12 input nodes size: 372849
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.0989069938659668  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23780441284179688  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2378988265991211  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 372849
first layer output nodes number: 123444
edges number: 1220453
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1588292121887207  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([372849, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1588292121887207  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1588292121887207  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2143692970275879  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2143692970275879  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.332094669342041  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([123444, 256])
h_self size  torch.Size([123444, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.332094669342041  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([123444, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44982004165649414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.332094669342041  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([123444, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44982004165649414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4792513847351074  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 123444
----------------output nodes number: 12617
----------------edges number: 312598
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.48026561737060547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.48026561737060547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4949021339416504  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4949021339416504  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49720096588134766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12617, 47])
h_self size  torch.Size([12617, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49720096588134766  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12617, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49941015243530273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49711132049560547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12617, 47])
pseudo mini batch 13 input nodes size: 263622
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14232349395751953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24053049087524414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24062204360961914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 263622
first layer output nodes number: 96389
edges number: 928691
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11393880844116211  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([263622, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11393880844116211  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11393880844116211  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15712594985961914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15712594985961914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24904966354370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([96389, 256])
h_self size  torch.Size([96389, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24904966354370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([96389, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3409733772277832  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24904966354370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([96389, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3409733772277832  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36428403854370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 96389
----------------output nodes number: 12247
----------------edges number: 295293
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3650941848754883  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3650941848754883  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37921667098999023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37921667098999023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3813610076904297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12247, 47])
h_self size  torch.Size([12247, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3813610076904297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12247, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.38350534439086914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3813610076904297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12247, 47])
pseudo mini batch 14 input nodes size: 255096
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10156536102294922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1965961456298828  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.19669008255004883  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 255096
first layer output nodes number: 96186
edges number: 920354
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11014509201049805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([255096, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11014509201049805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11014509201049805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15319395065307617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15319395065307617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24492406845092773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([96186, 256])
h_self size  torch.Size([96186, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24492406845092773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([96186, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3366541862487793  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24492406845092773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([96186, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3366541862487793  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36015844345092773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 96186
----------------output nodes number: 12586
----------------edges number: 303832
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36096906661987305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36096906661987305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37533092498779297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37533092498779297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3775348663330078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12586, 47])
h_self size  torch.Size([12586, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3775348663330078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12586, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37973880767822266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3775348663330078  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12586, 47])
pseudo mini batch 15 input nodes size: 312295
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.09845113754272461  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2156386375427246  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.21573209762573242  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 312295
first layer output nodes number: 115078
edges number: 1107618
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13429975509643555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([312295, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13429975509643555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13429975509643555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18585205078125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18585205078125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29559898376464844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([115078, 256])
h_self size  torch.Size([115078, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29559898376464844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115078, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4053459167480469  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29559898376464844  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115078, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4053459167480469  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4327826499938965  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 115078
----------------output nodes number: 12540
----------------edges number: 302583
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4337339401245117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4337339401245117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4489908218383789  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4489908218383789  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45201635360717773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12540, 47])
h_self size  torch.Size([12540, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45201635360717773  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12540, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4542121887207031  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4511866569519043  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12540, 47])
Average training time/epoch 1.251002311706543
Average Training time/epoch w/o nid counting 1.23378324508667
Number of nodes for computation during this epoch:  6685152
Number of first layer input nodes during this epoch:  4989667
Number of first layer output nodes during this epoch:  1695485

-----------------------------------------------------------------------------epoch done
read pickle file
0.8363165855407715

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.24659204483032227
global_2_local spend time (sec) 0.452007532119751

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.938 seconds
Metis partitioning: 12.993 seconds
Split the graph: 1.104 seconds
Construct subgraphs: 0.038 seconds
12245
11927
11949
12347
12349
12513
12464
12623
12256
12641
11927
11927
11953
12650
12507
12293
REG metis partition end ----................................
the time spent:  26.730544090270996
total k batches seeds list generation spend  27.324734449386597
after graph partition
graph partition algorithm spend time 27.918286561965942

partition_len_list
[78658, 102920, 90097, 92240, 109646, 123135, 111679, 125011, 112836, 99373, 112762, 113947, 109669, 92795, 115388, 124248]
REG selection method  spend 28.583900928497314
check_connections_block*********************************
time for parepare 1: 0.23050427436828613
local_output_nid generation: 0.004050493240356445
local_in_edges_tensor generation: 0.00429844856262207
mini_batch_src_global generation: 0.011620759963989258

&&&&&&&&&&&&&&& before remove duplicate length: 289274
&&&&&&&&&&&&&&& after remove duplicate length: 77533

remove duplicate: 0.04394674301147461
r_  generation: 0.031107664108276367

local_output_nid generation: 0.004636049270629883
local_in_edges_tensor generation: 0.0041620731353759766
mini_batch_src_global generation: 0.009785890579223633

&&&&&&&&&&&&&&& before remove duplicate length: 288168
&&&&&&&&&&&&&&& after remove duplicate length: 101658

remove duplicate: 0.05464529991149902
r_  generation: 0.0466923713684082

local_output_nid generation: 0.004700183868408203
local_in_edges_tensor generation: 0.004290342330932617
mini_batch_src_global generation: 0.008996725082397461

&&&&&&&&&&&&&&& before remove duplicate length: 290753
&&&&&&&&&&&&&&& after remove duplicate length: 89359

remove duplicate: 0.06639385223388672
r_  generation: 0.04490947723388672

local_output_nid generation: 0.004788875579833984
local_in_edges_tensor generation: 0.0043485164642333984
mini_batch_src_global generation: 0.0113525390625

&&&&&&&&&&&&&&& before remove duplicate length: 303979
&&&&&&&&&&&&&&& after remove duplicate length: 91589

remove duplicate: 0.06343770027160645
r_  generation: 0.04763031005859375

local_output_nid generation: 0.004841804504394531
local_in_edges_tensor generation: 0.005230903625488281
mini_batch_src_global generation: 0.010384082794189453

&&&&&&&&&&&&&&& before remove duplicate length: 307047
&&&&&&&&&&&&&&& after remove duplicate length: 108819

remove duplicate: 0.0663609504699707
r_  generation: 0.056072235107421875

local_output_nid generation: 0.004914283752441406
local_in_edges_tensor generation: 0.006310462951660156
mini_batch_src_global generation: 0.011547565460205078

&&&&&&&&&&&&&&& before remove duplicate length: 308606
&&&&&&&&&&&&&&& after remove duplicate length: 121699

remove duplicate: 0.06640815734863281
r_  generation: 0.0626671314239502

local_output_nid generation: 0.00493311882019043
local_in_edges_tensor generation: 0.0061321258544921875
mini_batch_src_global generation: 0.012542724609375

&&&&&&&&&&&&&&& before remove duplicate length: 279775
&&&&&&&&&&&&&&& after remove duplicate length: 108126

remove duplicate: 0.058907270431518555
r_  generation: 0.05958199501037598

local_output_nid generation: 0.00492405891418457
local_in_edges_tensor generation: 0.0045299530029296875
mini_batch_src_global generation: 0.01219630241394043

&&&&&&&&&&&&&&& before remove duplicate length: 313811
&&&&&&&&&&&&&&& after remove duplicate length: 124211

remove duplicate: 0.06851553916931152
r_  generation: 0.06674003601074219

local_output_nid generation: 0.004815816879272461
local_in_edges_tensor generation: 0.004867076873779297
mini_batch_src_global generation: 0.0127410888671875

&&&&&&&&&&&&&&& before remove duplicate length: 295898
&&&&&&&&&&&&&&& after remove duplicate length: 111702

remove duplicate: 0.06471562385559082
r_  generation: 0.06179642677307129

local_output_nid generation: 0.004941463470458984
local_in_edges_tensor generation: 0.004470109939575195
mini_batch_src_global generation: 0.012372732162475586

&&&&&&&&&&&&&&& before remove duplicate length: 304919
&&&&&&&&&&&&&&& after remove duplicate length: 98603

remove duplicate: 0.06406331062316895
r_  generation: 0.055846214294433594

local_output_nid generation: 0.0046961307525634766
local_in_edges_tensor generation: 0.0042989253997802734
mini_batch_src_global generation: 0.011448144912719727

&&&&&&&&&&&&&&& before remove duplicate length: 290441
&&&&&&&&&&&&&&& after remove duplicate length: 111422

remove duplicate: 0.06362438201904297
r_  generation: 0.058701515197753906

local_output_nid generation: 0.004741668701171875
local_in_edges_tensor generation: 0.004288911819458008
mini_batch_src_global generation: 0.01140737533569336

&&&&&&&&&&&&&&& before remove duplicate length: 289743
&&&&&&&&&&&&&&& after remove duplicate length: 112569

remove duplicate: 0.06380367279052734
r_  generation: 0.060906410217285156

local_output_nid generation: 0.0047075748443603516
local_in_edges_tensor generation: 0.015286445617675781
mini_batch_src_global generation: 0.01175689697265625

&&&&&&&&&&&&&&& before remove duplicate length: 284998
&&&&&&&&&&&&&&& after remove duplicate length: 106625

remove duplicate: 0.0599210262298584
r_  generation: 0.056992292404174805

local_output_nid generation: 0.004903078079223633
local_in_edges_tensor generation: 0.008278369903564453
mini_batch_src_global generation: 0.013209104537963867

&&&&&&&&&&&&&&& before remove duplicate length: 299205
&&&&&&&&&&&&&&& after remove duplicate length: 91769

remove duplicate: 0.06177353858947754
r_  generation: 0.052252769470214844

local_output_nid generation: 0.004931926727294922
local_in_edges_tensor generation: 0.005867719650268555
mini_batch_src_global generation: 0.011940717697143555

&&&&&&&&&&&&&&& before remove duplicate length: 311682
&&&&&&&&&&&&&&& after remove duplicate length: 114599

remove duplicate: 0.06690120697021484
r_  generation: 0.06047248840332031

local_output_nid generation: 0.004808664321899414
local_in_edges_tensor generation: 0.005338191986083984
mini_batch_src_global generation: 0.012302398681640625

&&&&&&&&&&&&&&& before remove duplicate length: 305580
&&&&&&&&&&&&&&& after remove duplicate length: 122963

remove duplicate: 0.06745743751525879
r_  generation: 0.06493568420410156


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8133723735809326
gen group dst list time:  0.05119776725769043
check_connections_block*********************************
time for parepare 1: 0.3800220489501953
local_output_nid generation: 0.01969146728515625
local_in_edges_tensor generation: 0.08760571479797363
mini_batch_src_global generation: 0.023781538009643555

&&&&&&&&&&&&&&& before remove duplicate length: 758862
&&&&&&&&&&&&&&& after remove duplicate length: 166233

remove duplicate: 0.11207127571105957
r_  generation: 0.11996817588806152

local_output_nid generation: 0.03110957145690918
local_in_edges_tensor generation: 0.031987905502319336
mini_batch_src_global generation: 0.029715538024902344

&&&&&&&&&&&&&&& before remove duplicate length: 1006960
&&&&&&&&&&&&&&& after remove duplicate length: 290627

remove duplicate: 0.1990363597869873
r_  generation: 0.21036601066589355

local_output_nid generation: 0.028754472732543945
local_in_edges_tensor generation: 0.034197330474853516
mini_batch_src_global generation: 0.02785491943359375

&&&&&&&&&&&&&&& before remove duplicate length: 874621
&&&&&&&&&&&&&&& after remove duplicate length: 260490

remove duplicate: 0.2063915729522705
r_  generation: 0.20243024826049805

local_output_nid generation: 0.027169227600097656
local_in_edges_tensor generation: 0.0272979736328125
mini_batch_src_global generation: 0.029924631118774414

&&&&&&&&&&&&&&& before remove duplicate length: 904508
&&&&&&&&&&&&&&& after remove duplicate length: 257449

remove duplicate: 0.2126927375793457
r_  generation: 0.20891475677490234

local_output_nid generation: 0.032474517822265625
local_in_edges_tensor generation: 0.10501623153686523
mini_batch_src_global generation: 0.03541088104248047

&&&&&&&&&&&&&&& before remove duplicate length: 1085466
&&&&&&&&&&&&&&& after remove duplicate length: 306612

remove duplicate: 0.257901668548584
r_  generation: 0.2502458095550537

local_output_nid generation: 0.03602433204650879
local_in_edges_tensor generation: 0.05756378173828125
mini_batch_src_global generation: 0.04352569580078125

&&&&&&&&&&&&&&& before remove duplicate length: 1219553
&&&&&&&&&&&&&&& after remove duplicate length: 356182

remove duplicate: 0.32741785049438477
r_  generation: 0.33107471466064453

local_output_nid generation: 0.057643890380859375
local_in_edges_tensor generation: 0.03196287155151367
mini_batch_src_global generation: 0.040006399154663086

&&&&&&&&&&&&&&& before remove duplicate length: 1095991
&&&&&&&&&&&&&&& after remove duplicate length: 349697

remove duplicate: 0.3145933151245117
r_  generation: 0.31624412536621094

local_output_nid generation: 0.037250518798828125
local_in_edges_tensor generation: 0.03125262260437012
mini_batch_src_global generation: 0.0419313907623291

&&&&&&&&&&&&&&& before remove duplicate length: 1238145
&&&&&&&&&&&&&&& after remove duplicate length: 333299

remove duplicate: 0.2998952865600586
r_  generation: 0.284717321395874

local_output_nid generation: 0.03440523147583008
local_in_edges_tensor generation: 0.02805781364440918
mini_batch_src_global generation: 0.038028717041015625

&&&&&&&&&&&&&&& before remove duplicate length: 1088078
&&&&&&&&&&&&&&& after remove duplicate length: 304252

remove duplicate: 0.2719614505767822
r_  generation: 0.2574276924133301

local_output_nid generation: 0.030432462692260742
local_in_edges_tensor generation: 0.026160717010498047
mini_batch_src_global generation: 0.033382415771484375

&&&&&&&&&&&&&&& before remove duplicate length: 951972
&&&&&&&&&&&&&&& after remove duplicate length: 252699

remove duplicate: 0.23572683334350586
r_  generation: 0.21938443183898926

local_output_nid generation: 0.035741329193115234
local_in_edges_tensor generation: 0.03740215301513672
mini_batch_src_global generation: 0.04454445838928223

&&&&&&&&&&&&&&& before remove duplicate length: 1094782
&&&&&&&&&&&&&&& after remove duplicate length: 346141

remove duplicate: 0.27794766426086426
r_  generation: 0.2766087055206299

local_output_nid generation: 0.035816192626953125
local_in_edges_tensor generation: 0.033394575119018555
mini_batch_src_global generation: 0.04001355171203613

&&&&&&&&&&&&&&& before remove duplicate length: 1110315
&&&&&&&&&&&&&&& after remove duplicate length: 348371

remove duplicate: 0.2844676971435547
r_  generation: 0.29854440689086914

local_output_nid generation: 0.03547310829162598
local_in_edges_tensor generation: 0.046233415603637695
mini_batch_src_global generation: 0.04088854789733887

&&&&&&&&&&&&&&& before remove duplicate length: 1081980
&&&&&&&&&&&&&&& after remove duplicate length: 372066

remove duplicate: 0.3330729007720947
r_  generation: 0.33798718452453613

local_output_nid generation: 0.05047321319580078
local_in_edges_tensor generation: 0.03764748573303223
mini_batch_src_global generation: 0.03717613220214844

&&&&&&&&&&&&&&& before remove duplicate length: 890332
&&&&&&&&&&&&&&& after remove duplicate length: 236040

remove duplicate: 0.21593523025512695
r_  generation: 0.20715832710266113

local_output_nid generation: 0.03512072563171387
local_in_edges_tensor generation: 0.037459611892700195
mini_batch_src_global generation: 0.04260754585266113

&&&&&&&&&&&&&&& before remove duplicate length: 1142603
&&&&&&&&&&&&&&& after remove duplicate length: 272468

remove duplicate: 0.26790332794189453
r_  generation: 0.23836159706115723

local_output_nid generation: 0.03844738006591797
local_in_edges_tensor generation: 0.03732013702392578
mini_batch_src_global generation: 0.04788947105407715

&&&&&&&&&&&&&&& before remove duplicate length: 1230980
&&&&&&&&&&&&&&& after remove duplicate length: 355693

remove duplicate: 0.34011173248291016
r_  generation: 0.32025790214538574


connection checking time:  15.320672273635864
block generation total time  13.152769804000854
block dataloader generation time/epoch 58.652354876200356
pseudo mini batch 0 input nodes size: 172888
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12142801284790039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18583393096923828  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18592548370361328  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 172888
first layer output nodes number: 78658
edges number: 758862
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.07832908630371094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([172888, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.07832908630371094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.07832908630371094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11357927322387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11357927322387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18859338760375977  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([78658, 256])
h_self size  torch.Size([78658, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18859338760375977  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([78658, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2636075019836426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18859338760375977  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([78658, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2636075019836426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2831387519836426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 78658
----------------output nodes number: 12245
----------------edges number: 289274
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2838168144226074  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2838168144226074  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2984170913696289  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2984170913696289  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3012809753417969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12245, 47])
h_self size  torch.Size([12245, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3012809753417969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12245, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30342531204223633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.30056142807006836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12245, 47])
pseudo mini batch 1 input nodes size: 304627
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.0677642822265625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18124675750732422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1813359260559082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 304627
first layer output nodes number: 102920
edges number: 1006960
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1310877799987793  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([304627, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1310877799987793  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1310877799987793  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17731523513793945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17731523513793945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2754673957824707  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([102920, 256])
h_self size  torch.Size([102920, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2754673957824707  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([102920, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37361955642700195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2754673957824707  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([102920, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37361955642700195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39815759658813477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 102920
----------------output nodes number: 11927
----------------edges number: 288168
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3990139961242676  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3990139961242676  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41345739364624023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41345739364624023  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4162869453430176  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4162869453430176  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41837549209594727  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4155459403991699  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 2 input nodes size: 272197
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11678266525268555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2181839942932129  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.21827316284179688  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 272197
first layer output nodes number: 90097
edges number: 874621
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11711740493774414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([272197, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11711740493774414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11711740493774414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1575336456298828  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1575336456298828  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24345684051513672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([90097, 256])
h_self size  torch.Size([90097, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24345684051513672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90097, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3293800354003906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24345684051513672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([90097, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3293800354003906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3508610725402832  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 90097
----------------output nodes number: 11949
----------------edges number: 290753
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3516216278076172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3516216278076172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36527347564697266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36527347564697266  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.367948055267334  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11949, 47])
h_self size  torch.Size([11949, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.367948055267334  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11949, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3700404167175293  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36736583709716797  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11949, 47])
pseudo mini batch 3 input nodes size: 268501
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1047053337097168  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20473003387451172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20482206344604492  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 268501
first layer output nodes number: 92240
edges number: 904508
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1151275634765625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([268501, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1151275634765625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1151275634765625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15657329559326172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15657329559326172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24454021453857422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([92240, 256])
h_self size  torch.Size([92240, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24454021453857422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([92240, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3325071334838867  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24454021453857422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([92240, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3325071334838867  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35449886322021484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 92240
----------------output nodes number: 12347
----------------edges number: 303979
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35527849197387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35527849197387695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3710331916809082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3710331916809082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37319517135620117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12347, 47])
h_self size  torch.Size([12347, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37319517135620117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12347, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37535715103149414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37319517135620117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12347, 47])
pseudo mini batch 4 input nodes size: 319815
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10340118408203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22254180908203125  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.22263383865356445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 319815
first layer output nodes number: 109646
edges number: 1085466
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13691949844360352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([319815, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13691949844360352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13691949844360352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1862940788269043  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1862940788269043  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.290860652923584  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([109646, 256])
h_self size  torch.Size([109646, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.290860652923584  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109646, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39542722702026367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.290860652923584  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109646, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39542722702026367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4215688705444336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 109646
----------------output nodes number: 12349
----------------edges number: 307047
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42247819900512695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42247819900512695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43727540969848633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43727540969848633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4394378662109375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12349, 47])
h_self size  torch.Size([12349, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4394378662109375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12349, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.442291259765625  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44012880325317383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12349, 47])
pseudo mini batch 5 input nodes size: 371238
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12251758575439453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2608146667480469  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2609081268310547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 371238
first layer output nodes number: 123135
edges number: 1219553
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1568608283996582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([371238, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1568608283996582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1568608283996582  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2131633758544922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2131633758544922  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3305940628051758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([123135, 256])
h_self size  torch.Size([123135, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3305940628051758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([123135, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4480247497558594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3305940628051758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([123135, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4480247497558594  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4773826599121094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 123135
----------------output nodes number: 12513
----------------edges number: 308606
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4783935546875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4783935546875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49321842193603516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49321842193603516  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4954094886779785  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12513, 47])
h_self size  torch.Size([12513, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4954094886779785  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12513, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4978170394897461  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49562597274780273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12513, 47])
pseudo mini batch 6 input nodes size: 366274
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14170408248901367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2781519889831543  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2782449722290039  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 366274
first layer output nodes number: 111679
edges number: 1095991
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15366697311401367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([366274, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15366697311401367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15366697311401367  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20385360717773438  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20385360717773438  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31035900115966797  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([111679, 256])
h_self size  torch.Size([111679, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31035900115966797  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111679, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41686439514160156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31035900115966797  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([111679, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.41686439514160156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44349098205566406  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 111679
----------------output nodes number: 12464
----------------edges number: 279775
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4444160461425781  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4444160461425781  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4584808349609375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4584808349609375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4612150192260742  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12464, 47])
h_self size  torch.Size([12464, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4612150192260742  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12464, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4633975028991699  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4606633186340332  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12464, 47])
pseudo mini batch 7 input nodes size: 346445
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1398458480834961  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2689070701599121  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.26900148391723633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 346445
first layer output nodes number: 125011
edges number: 1238145
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1490163803100586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([346445, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1490163803100586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1490163803100586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2052783966064453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2052783966064453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.32449817657470703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([125011, 256])
h_self size  torch.Size([125011, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.32449817657470703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([125011, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44371795654296875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.32449817657470703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([125011, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44371795654296875  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4735231399536133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 125011
----------------output nodes number: 12623
----------------edges number: 313811
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4745492935180664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4745492935180664  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.48902034759521484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.48902034759521484  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4919004440307617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12623, 47])
h_self size  torch.Size([12623, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4919004440307617  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12623, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4941110610961914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49123096466064453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12623, 47])
pseudo mini batch 8 input nodes size: 316565
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13315820693969727  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.25108814239501953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.25117969512939453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 316565
first layer output nodes number: 112836
edges number: 1088078
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13564443588256836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([316565, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13564443588256836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13564443588256836  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18620729446411133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.18620729446411133  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29381608963012695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([112836, 256])
h_self size  torch.Size([112836, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29381608963012695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112836, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4014248847961426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.29381608963012695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112836, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4014248847961426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4283270835876465  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 112836
----------------output nodes number: 12256
----------------edges number: 295898
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4292597770690918  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4292597770690918  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4439263343811035  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4439263343811035  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4460725784301758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12256, 47])
h_self size  torch.Size([12256, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4460725784301758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12256, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44915056228637695  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4470043182373047  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12256, 47])
pseudo mini batch 9 input nodes size: 263333
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12129020690917969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2193894386291504  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2194838523864746  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 263333
first layer output nodes number: 99373
edges number: 951972
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11407232284545898  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([263333, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11407232284545898  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.11407232284545898  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1585559844970703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1585559844970703  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2533254623413086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([99373, 256])
h_self size  torch.Size([99373, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2533254623413086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([99373, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3480949401855469  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2533254623413086  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([99373, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3480949401855469  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.37178754806518555  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 99373
----------------output nodes number: 12641
----------------edges number: 304919
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3726224899291992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3726224899291992  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3880128860473633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3880128860473633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3902263641357422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12641, 47])
h_self size  torch.Size([12641, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3902263641357422  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12641, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39309263229370117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39087915420532227  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12641, 47])
pseudo mini batch 10 input nodes size: 362310
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10152959823608398  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23650074005126953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23658990859985352  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 362310
first layer output nodes number: 112762
edges number: 1094782
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15275096893310547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([362310, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15275096893310547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15275096893310547  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20333528518676758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.20333528518676758  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31087350845336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([112762, 256])
h_self size  torch.Size([112762, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31087350845336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112762, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4184117317199707  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.31087350845336914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([112762, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4184117317199707  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4452962875366211  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 112762
----------------output nodes number: 11927
----------------edges number: 290441
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.446225643157959  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.446225643157959  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4605560302734375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4605560302734375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4626445770263672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4626445770263672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4647331237792969  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4626445770263672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 11 input nodes size: 364409
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13827133178710938  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.27402448654174805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.27411365509033203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 364409
first layer output nodes number: 113947
edges number: 1110315
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1533985137939453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([364409, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1533985137939453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1533985137939453  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2045454978942871  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2045454978942871  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3132138252258301  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([113947, 256])
h_self size  torch.Size([113947, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3132138252258301  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([113947, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42188215255737305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3132138252258301  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([113947, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42188215255737305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4490494728088379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 113947
----------------output nodes number: 11927
----------------edges number: 289743
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44998788833618164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44998788833618164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4639248847961426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4639248847961426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46691036224365234  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11927, 47])
h_self size  torch.Size([11927, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46691036224365234  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46899890899658203  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46601343154907227  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11927, 47])
pseudo mini batch 12 input nodes size: 390761
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.13995027542114258  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2855205535888672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.28560972213745117  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 390761
first layer output nodes number: 109669
edges number: 1081980
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16434669494628906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([390761, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16434669494628906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.16434669494628906  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.21370792388916016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.21370792388916016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3182964324951172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([109669, 256])
h_self size  torch.Size([109669, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3182964324951172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109669, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4228849411010742  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3182964324951172  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([109669, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4228849411010742  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4490323066711426  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 109669
----------------output nodes number: 11953
----------------edges number: 284998
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4499387741088867  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4499387741088867  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46355152130126953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46355152130126953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46564435958862305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([11953, 47])
h_self size  torch.Size([11953, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46564435958862305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11953, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46773719787597656  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.46564435958862305  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([11953, 47])
pseudo mini batch 13 input nodes size: 250806
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.14887475967407227  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2423076629638672  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2424020767211914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 250806
first layer output nodes number: 92795
edges number: 890332
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10878992080688477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([250806, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10878992080688477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.10878992080688477  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15033864974975586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.15033864974975586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23883485794067383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([92795, 256])
h_self size  torch.Size([92795, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23883485794067383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([92795, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3273310661315918  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.23883485794067383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([92795, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3273310661315918  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3494553565979004  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 92795
----------------output nodes number: 12650
----------------edges number: 299205
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35024118423461914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.35024118423461914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36478376388549805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36478376388549805  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36701345443725586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12650, 47])
h_self size  torch.Size([12650, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36701345443725586  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12650, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3692283630371094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.36699867248535156  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12650, 47])
pseudo mini batch 14 input nodes size: 283723
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.09687948226928711  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2025747299194336  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2026681900024414  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 283723
first layer output nodes number: 115388
edges number: 1142603
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12368106842041016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([283723, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12368106842041016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.12368106842041016  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17561006546020508  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.17561006546020508  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.28565263748168945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([115388, 256])
h_self size  torch.Size([115388, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.28565263748168945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115388, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39569520950317383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.28565263748168945  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([115388, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.39569520950317383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4232058525085449  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 115388
----------------output nodes number: 12507
----------------edges number: 311682
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42415904998779297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.42415904998779297  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43904924392700195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.43904924392700195  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4413719177246094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12507, 47])
h_self size  torch.Size([12507, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4413719177246094  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12507, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4438285827636719  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.44150590896606445  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12507, 47])
pseudo mini batch 15 input nodes size: 370329
----------------------------------------before batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1091012954711914  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24705982208251953  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.24715185165405273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

first layer input nodes number: 370329
first layer output nodes number: 124248
edges number: 1230980
----------------------------------------before model layer 0
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1566777229309082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([370329, 100])
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1566777229309082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.1566777229309082  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2125992774963379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.2125992774963379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3317399024963379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([124248, 256])
h_self size  torch.Size([124248, 100])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.3317399024963379  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([124248, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45023202896118164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.33109140396118164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([124248, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.45023202896118164  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.47920656204223633  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------input nodes number: 124248
----------------output nodes number: 12293
----------------edges number: 305580
----------------------------------------before mean aggregator
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.480224609375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.480224609375  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4943661689758301  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.4943661689758301  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49731874465942383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

h_neigh size torch.Size([12293, 47])
h_self size  torch.Size([12293, 256])
----------------------------------------before rst
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49731874465942383  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12293, 47])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.49947118759155273  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.3397216796875 GB
    Memory Allocated: 0.496518611907959  GigaBytes
Max Memory Allocated: 0.7905426025390625  GigaBytes

torch.Size([12293, 47])
Average training time/epoch 1.2403254508972168
Average Training time/epoch w/o nid counting 1.2173209190368652
Number of nodes for computation during this epoch:  6738625
Number of first layer input nodes during this epoch:  5024221
Number of first layer output nodes during this epoch:  1714404

-----------------------------------------------------------------------------epoch done
