main start at this time 1660939668.1812098
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033287763595581055
global_2_local spend time (sec) 0.03344869613647461

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.217 seconds
Metis partitioning: 4.772 seconds
Split the graph: 3.296 seconds
Construct subgraphs: 0.015 seconds
23068
22740
22500
22633
REG metis partition end ----................................
the time spent:  12.384575366973877
REG construction  time spent:  3.0718753337860107
pure dgl.metis_partition the time spent:  9.312700033187866
total k batches seeds list generation spend  12.558515310287476
after graph partition
graph partition algorithm spend time 12.639423370361328

partition_len_list
[37024, 35442, 52586, 68183]
REG selection method  spend 12.695260047912598
check_connections_block*********************************
time for parepare 1: 0.014672994613647461
local_output_nid generation: 0.002904653549194336
local_in_edges_tensor generation: 0.0035097599029541016
mini_batch_src_global generation: 0.004698276519775391

&&&&&&&&&&&&&&& before remove duplicate length: 143850
&&&&&&&&&&&&&&& after remove duplicate length: 35216

r_  generation: 0.024333953857421875

local_output_nid generation: 0.0038530826568603516
local_in_edges_tensor generation: 0.00391387939453125
mini_batch_src_global generation: 0.005399227142333984

&&&&&&&&&&&&&&& before remove duplicate length: 189232
&&&&&&&&&&&&&&& after remove duplicate length: 33854

r_  generation: 0.02258753776550293

local_output_nid generation: 0.003942728042602539
local_in_edges_tensor generation: 0.0034036636352539062
mini_batch_src_global generation: 0.003468036651611328

&&&&&&&&&&&&&&& before remove duplicate length: 149896
&&&&&&&&&&&&&&& after remove duplicate length: 48639

r_  generation: 0.02617931365966797

local_output_nid generation: 0.00400996208190918
local_in_edges_tensor generation: 0.0054585933685302734
mini_batch_src_global generation: 0.007479429244995117

&&&&&&&&&&&&&&& before remove duplicate length: 261272
&&&&&&&&&&&&&&& after remove duplicate length: 63813

r_  generation: 0.03273487091064453


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.026875734329223633
gen group dst list time:  0.005230903625488281
check_connections_block*********************************
time for parepare 1: 0.018489599227905273
local_output_nid generation: 0.0052945613861083984
local_in_edges_tensor generation: 0.010823965072631836
mini_batch_src_global generation: 0.006345272064208984

&&&&&&&&&&&&&&& before remove duplicate length: 195999
&&&&&&&&&&&&&&& after remove duplicate length: 51932

r_  generation: 0.032881975173950195

local_output_nid generation: 0.007383108139038086
local_in_edges_tensor generation: 0.005942106246948242
mini_batch_src_global generation: 0.005854606628417969

&&&&&&&&&&&&&&& before remove duplicate length: 217548
&&&&&&&&&&&&&&& after remove duplicate length: 48139

r_  generation: 0.03220701217651367

local_output_nid generation: 0.013154268264770508
local_in_edges_tensor generation: 0.010498046875
mini_batch_src_global generation: 0.009237289428710938

&&&&&&&&&&&&&&& before remove duplicate length: 332340
&&&&&&&&&&&&&&& after remove duplicate length: 89104

r_  generation: 0.05845236778259277

local_output_nid generation: 0.011771678924560547
local_in_edges_tensor generation: 0.014711380004882812
mini_batch_src_global generation: 0.015706300735473633

&&&&&&&&&&&&&&& before remove duplicate length: 528704
&&&&&&&&&&&&&&& after remove duplicate length: 86317

r_  generation: 0.06445908546447754


connection checking time:  0.95200514793396
block generation total time  0.9162371158599854
pseudo mini batch 0 input nodes size: 53368
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1053466796875 GB
    Memory Allocated: 0.025768280029296875  GigaBytes
Max Memory Allocated: 0.025768280029296875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1053466796875 GB
    Memory Allocated: 0.025940418243408203  GigaBytes
Max Memory Allocated: 0.025940418243408203  GigaBytes

first layer input nodes number: 53368
first layer output nodes number: 37024
edges number: 195999
----------------------------------------before model layer 0
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 0.02914714813232422  GigaBytes
Max Memory Allocated: 0.029877662658691406  GigaBytes

torch.Size([53368, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 0.02914714813232422  GigaBytes
Max Memory Allocated: 0.029877662658691406  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.1737060546875 GB
    Memory Allocated: 0.02914714813232422  GigaBytes
Max Memory Allocated: 0.029877662658691406  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 0.04840087890625  GigaBytes
Max Memory Allocated: 0.0661935806274414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 0.04840087890625  GigaBytes
Max Memory Allocated: 0.0661935806274414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.083709716796875  GigaBytes
Max Memory Allocated: 0.083709716796875  GigaBytes

h_neigh size torch.Size([37024, 256])
h_self size  torch.Size([37024, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4354248046875 GB
    Memory Allocated: 0.083709716796875  GigaBytes
Max Memory Allocated: 0.083709716796875  GigaBytes

torch.Size([37024, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.1190185546875  GigaBytes
Max Memory Allocated: 0.154327392578125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.083709716796875  GigaBytes
Max Memory Allocated: 0.154327392578125  GigaBytes

torch.Size([37024, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.1190185546875  GigaBytes
Max Memory Allocated: 0.154327392578125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.12784576416015625  GigaBytes
Max Memory Allocated: 0.16315460205078125  GigaBytes

----------------input nodes number: 37024
----------------output nodes number: 23068
----------------edges number: 143850
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.1282939910888672  GigaBytes
Max Memory Allocated: 0.16315460205078125  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.1282939910888672  GigaBytes
Max Memory Allocated: 0.16315460205078125  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.15153789520263672  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.15153789520263672  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.15497541427612305  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

h_neigh size torch.Size([23068, 40])
h_self size  torch.Size([23068, 256])
----------------------------------------before rst
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.15497541427612305  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

torch.Size([23068, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.15880441665649414  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 0.1553668975830078  GigaBytes
Max Memory Allocated: 0.1735372543334961  GigaBytes

torch.Size([23068, 40])
pseudo mini batch 1 input nodes size: 49970
----------------------------------------before batch input features to device
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.029699325561523438  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.053526878356933594  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.053696632385253906  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

first layer input nodes number: 49970
first layer output nodes number: 35442
edges number: 217548
----------------------------------------before model layer 0
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.031744956970214844  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([49970, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.031744956970214844  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.031744956970214844  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.05039834976196289  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.05039834976196289  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.0841984748840332  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

h_neigh size torch.Size([35442, 256])
h_self size  torch.Size([35442, 128])
----------------------------------------before rst
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.0841984748840332  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([35442, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.11799860000610352  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.0841984748840332  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([35442, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.11799860000610352  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.12682580947875977  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------input nodes number: 35442
----------------output nodes number: 22740
----------------edges number: 189232
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1272597312927246  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1272597312927246  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1505265235900879  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1505265235900879  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1539154052734375  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

h_neigh size torch.Size([22740, 40])
h_self size  torch.Size([22740, 256])
----------------------------------------before rst
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1539154052734375  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([22740, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1577930450439453  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 0.1544041633605957  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([22740, 40])
pseudo mini batch 2 input nodes size: 92528
----------------------------------------before batch input features to device
 Nvidia-smi: 7.6522216796875 GB
    Memory Allocated: 0.028028011322021484  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.07294988632202148  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.07311773300170898  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

first layer input nodes number: 92528
first layer output nodes number: 52586
edges number: 332340
----------------------------------------before model layer 0
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.05379629135131836  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([92528, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.05379629135131836  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6971435546875 GB
    Memory Allocated: 0.05379629135131836  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6990966796875 GB
    Memory Allocated: 0.08170652389526367  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6990966796875 GB
    Memory Allocated: 0.08170652389526367  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7498779296875 GB
    Memory Allocated: 0.13248777389526367  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

h_neigh size torch.Size([52586, 256])
h_self size  torch.Size([52586, 128])
----------------------------------------before rst
 Nvidia-smi: 7.7498779296875 GB
    Memory Allocated: 0.13248777389526367  GigaBytes
Max Memory Allocated: 0.20479536056518555  GigaBytes

torch.Size([52586, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.18326902389526367  GigaBytes
Max Memory Allocated: 0.23405027389526367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.13248777389526367  GigaBytes
Max Memory Allocated: 0.23405027389526367  GigaBytes

torch.Size([52586, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.18326902389526367  GigaBytes
Max Memory Allocated: 0.23405027389526367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.19580650329589844  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------input nodes number: 52586
----------------output nodes number: 22500
----------------edges number: 149896
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.1963663101196289  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.1963663101196289  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.21910953521728516  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.21910953521728516  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.22272682189941406  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

h_neigh size torch.Size([22500, 40])
h_self size  torch.Size([22500, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.22272682189941406  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

torch.Size([22500, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.22636747360229492  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8514404296875 GB
    Memory Allocated: 0.22275018692016602  GigaBytes
Max Memory Allocated: 0.24658775329589844  GigaBytes

torch.Size([22500, 40])
pseudo mini batch 3 input nodes size: 91707
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.04908466339111328  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.09281396865844727  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.09298276901245117  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

first layer input nodes number: 91707
first layer output nodes number: 68183
edges number: 528704
----------------------------------------before model layer 0
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.05497169494628906  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

torch.Size([91707, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.05497169494628906  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9158935546875 GB
    Memory Allocated: 0.05497169494628906  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9237060546875 GB
    Memory Allocated: 0.09235191345214844  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9237060546875 GB
    Memory Allocated: 0.09235191345214844  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.15737628936767578  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

h_neigh size torch.Size([68183, 256])
h_self size  torch.Size([68183, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9901123046875 GB
    Memory Allocated: 0.15737628936767578  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

torch.Size([68183, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.22240066528320312  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.15737628936767578  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

torch.Size([68183, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.22240066528320312  GigaBytes
Max Memory Allocated: 0.30040884017944336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.23865699768066406  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------input nodes number: 68183
----------------output nodes number: 22633
----------------edges number: 261272
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.2393341064453125  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.2393341064453125  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.2630348205566406  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.2630348205566406  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.26640748977661133  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

h_neigh size torch.Size([22633, 40])
h_self size  torch.Size([22633, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.26640748977661133  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

torch.Size([22633, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.26978015899658203  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1229248046875 GB
    Memory Allocated: 0.26640748977661133  GigaBytes
Max Memory Allocated: 0.3036813735961914  GigaBytes

torch.Size([22633, 40])
Number of nodes for computation during this epoch:  480808
Number of first layer input nodes during this epoch:  287573
Number of first layer output nodes during this epoch:  193235

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01697373390197754
global_2_local spend time (sec) 0.03844022750854492

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.274 seconds
Metis partitioning: 4.920 seconds
Split the graph: 3.397 seconds
Construct subgraphs: 0.057 seconds
23239
22763
22371
22568
REG metis partition end ----................................
the time spent:  12.758328437805176
REG construction  time spent:  3.096989154815674
pure dgl.metis_partition the time spent:  9.661339282989502
total k batches seeds list generation spend  12.9556725025177
after graph partition
graph partition algorithm spend time 13.047041416168213

partition_len_list
[40636, 35770, 51776, 68481]
REG selection method  spend 13.11089015007019
check_connections_block*********************************
time for parepare 1: 0.015439748764038086
local_output_nid generation: 0.0030968189239501953
local_in_edges_tensor generation: 0.004093647003173828
mini_batch_src_global generation: 0.005976676940917969

&&&&&&&&&&&&&&& before remove duplicate length: 164971
&&&&&&&&&&&&&&& after remove duplicate length: 38692

r_  generation: 0.023070573806762695

local_output_nid generation: 0.0040361881256103516
local_in_edges_tensor generation: 0.003942251205444336
mini_batch_src_global generation: 0.004892587661743164

&&&&&&&&&&&&&&& before remove duplicate length: 181428
&&&&&&&&&&&&&&& after remove duplicate length: 34036

r_  generation: 0.02251434326171875

local_output_nid generation: 0.004172563552856445
local_in_edges_tensor generation: 0.0034530162811279297
mini_batch_src_global generation: 0.0035102367401123047

&&&&&&&&&&&&&&& before remove duplicate length: 140844
&&&&&&&&&&&&&&& after remove duplicate length: 47855

r_  generation: 0.025979995727539062

local_output_nid generation: 0.004137516021728516
local_in_edges_tensor generation: 0.005816221237182617
mini_batch_src_global generation: 0.014198064804077148

&&&&&&&&&&&&&&& before remove duplicate length: 257007
&&&&&&&&&&&&&&& after remove duplicate length: 64111

r_  generation: 0.031967878341674805


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04471874237060547
gen group dst list time:  0.005860328674316406
check_connections_block*********************************
time for parepare 1: 0.02150583267211914
local_output_nid generation: 0.005825996398925781
local_in_edges_tensor generation: 0.017482280731201172
mini_batch_src_global generation: 0.008155345916748047

&&&&&&&&&&&&&&& before remove duplicate length: 235140
&&&&&&&&&&&&&&& after remove duplicate length: 61400

r_  generation: 0.038175106048583984

local_output_nid generation: 0.00758671760559082
local_in_edges_tensor generation: 0.005675315856933594
mini_batch_src_global generation: 0.005721569061279297

&&&&&&&&&&&&&&& before remove duplicate length: 214264
&&&&&&&&&&&&&&& after remove duplicate length: 49014

r_  generation: 0.03324460983276367

local_output_nid generation: 0.011148929595947266
local_in_edges_tensor generation: 0.014258146286010742
mini_batch_src_global generation: 0.015700340270996094

&&&&&&&&&&&&&&& before remove duplicate length: 323689
&&&&&&&&&&&&&&& after remove duplicate length: 87935

r_  generation: 0.05869412422180176

local_output_nid generation: 0.012231826782226562
local_in_edges_tensor generation: 0.013164997100830078
mini_batch_src_global generation: 0.01709771156311035

&&&&&&&&&&&&&&& before remove duplicate length: 528915
&&&&&&&&&&&&&&& after remove duplicate length: 87992

r_  generation: 0.06885933876037598


connection checking time:  1.0361440181732178
block generation total time  0.9507782459259033
pseudo mini batch 0 input nodes size: 63263
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.048552513122558594  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.07871866226196289  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.07889223098754883  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

first layer input nodes number: 63263
first layer output nodes number: 40636
edges number: 235140
----------------------------------------before model layer 0
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.038750648498535156  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([63263, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.038750648498535156  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.038750648498535156  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.06018638610839844  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.06018638610839844  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.09893989562988281  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([40636, 256])
h_self size  torch.Size([40636, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.09893989562988281  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([40636, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.1376934051513672  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.09893989562988281  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([40636, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.1376934051513672  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.14738178253173828  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------input nodes number: 40636
----------------output nodes number: 23239
----------------edges number: 164971
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.1478581428527832  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.1478581428527832  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17142343521118164  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17142343521118164  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17488670349121094  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([23239, 40])
h_self size  torch.Size([23239, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17488670349121094  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([23239, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17834997177124023  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2049560546875 GB
    Memory Allocated: 0.17488670349121094  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([23239, 40])
pseudo mini batch 1 input nodes size: 50744
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03508567810058594  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05928230285644531  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.059452056884765625  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

first layer input nodes number: 50744
first layer output nodes number: 35770
edges number: 214264
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03270578384399414  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([50744, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03270578384399414  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03270578384399414  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05149221420288086  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05149221420288086  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08560514450073242  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([35770, 256])
h_self size  torch.Size([35770, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08560514450073242  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([35770, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.11971807479858398  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08560514450073242  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([35770, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.11971807479858398  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1282825469970703  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------input nodes number: 35770
----------------output nodes number: 22763
----------------edges number: 181428
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12871885299682617  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12871885299682617  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15194940567016602  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15194940567016602  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15534162521362305  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([22763, 40])
h_self size  torch.Size([22763, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15534162521362305  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22763, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15873384475708008  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15534162521362305  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22763, 40])
pseudo mini batch 2 input nodes size: 91402
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.029041290283203125  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07262516021728516  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07279205322265625  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

first layer input nodes number: 91402
first layer output nodes number: 51776
edges number: 323689
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05308675765991211  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([91402, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05308675765991211  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05308675765991211  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08062362670898438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08062362670898438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13000106811523438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([51776, 256])
h_self size  torch.Size([51776, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13000106811523438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([51776, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17937850952148438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13000106811523438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([51776, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17937850952148438  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19179916381835938  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------input nodes number: 51776
----------------output nodes number: 22371
----------------edges number: 140844
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1923518180847168  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1923518180847168  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2149033546447754  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2149033546447754  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([22371, 40])
h_self size  torch.Size([22371, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22371, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22157049179077148  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22371, 40])
pseudo mini batch 3 input nodes size: 93335
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.04836702346801758  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09287261962890625  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09304094314575195  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

first layer input nodes number: 93335
first layer output nodes number: 68481
edges number: 528915
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.056353092193603516  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([93335, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.056353092193603516  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.056353092193603516  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09371805191040039  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09371805191040039  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1590266227722168  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([68481, 256])
h_self size  torch.Size([68481, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1590266227722168  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([68481, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2243351936340332  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1590266227722168  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([68481, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2243351936340332  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2406625747680664  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------input nodes number: 68481
----------------output nodes number: 22568
----------------edges number: 257007
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24134159088134766  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24134159088134766  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.26494789123535156  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.26494789123535156  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2683110237121582  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

h_neigh size torch.Size([22568, 40])
h_self size  torch.Size([22568, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2683110237121582  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22568, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.27167415618896484  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2683110237121582  GigaBytes
Max Memory Allocated: 0.37363624572753906  GigaBytes

torch.Size([22568, 40])
Number of nodes for computation during this epoch:  495407
Number of first layer input nodes during this epoch:  298744
Number of first layer output nodes during this epoch:  196663

-----------------------------------------------------------------------------epoch done
read pickle file
0.045708656311035156

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01878523826599121
global_2_local spend time (sec) 0.04260563850402832

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.190 seconds
Metis partitioning: 4.910 seconds
Split the graph: 3.533 seconds
Construct subgraphs: 0.056 seconds
23139
22779
22071
22952
REG metis partition end ----................................
the time spent:  12.768653869628906
REG construction  time spent:  3.0661323070526123
pure dgl.metis_partition the time spent:  9.702521562576294
total k batches seeds list generation spend  12.965385675430298
after graph partition
graph partition algorithm spend time 13.099469900131226

partition_len_list
[41040, 36403, 52368, 69342]
REG selection method  spend 13.169318199157715
check_connections_block*********************************
time for parepare 1: 0.014861583709716797
local_output_nid generation: 0.0032727718353271484
local_in_edges_tensor generation: 0.004053831100463867
mini_batch_src_global generation: 0.00606083869934082

&&&&&&&&&&&&&&& before remove duplicate length: 158928
&&&&&&&&&&&&&&& after remove duplicate length: 38812

r_  generation: 0.022819995880126953

local_output_nid generation: 0.00426936149597168
local_in_edges_tensor generation: 0.004055023193359375
mini_batch_src_global generation: 0.007763385772705078

&&&&&&&&&&&&&&& before remove duplicate length: 184401
&&&&&&&&&&&&&&& after remove duplicate length: 34656

r_  generation: 0.022444725036621094

local_output_nid generation: 0.004419565200805664
local_in_edges_tensor generation: 0.003603219985961914
mini_batch_src_global generation: 0.0033910274505615234

&&&&&&&&&&&&&&& before remove duplicate length: 136472
&&&&&&&&&&&&&&& after remove duplicate length: 48121

r_  generation: 0.025831937789916992

local_output_nid generation: 0.004354715347290039
local_in_edges_tensor generation: 0.004739522933959961
mini_batch_src_global generation: 0.007930994033813477

&&&&&&&&&&&&&&& before remove duplicate length: 264449
&&&&&&&&&&&&&&& after remove duplicate length: 64886

r_  generation: 0.03421425819396973


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04435110092163086
gen group dst list time:  0.005897045135498047
check_connections_block*********************************
time for parepare 1: 0.023680925369262695
local_output_nid generation: 0.00647735595703125
local_in_edges_tensor generation: 0.018334627151489258
mini_batch_src_global generation: 0.007646083831787109

&&&&&&&&&&&&&&& before remove duplicate length: 234616
&&&&&&&&&&&&&&& after remove duplicate length: 62775

r_  generation: 0.038507699966430664

local_output_nid generation: 0.008089303970336914
local_in_edges_tensor generation: 0.021446704864501953
mini_batch_src_global generation: 0.005730152130126953

&&&&&&&&&&&&&&& before remove duplicate length: 220234
&&&&&&&&&&&&&&& after remove duplicate length: 50222

r_  generation: 0.03409981727600098

local_output_nid generation: 0.011157035827636719
local_in_edges_tensor generation: 0.012902498245239258
mini_batch_src_global generation: 0.009063005447387695

&&&&&&&&&&&&&&& before remove duplicate length: 325254
&&&&&&&&&&&&&&& after remove duplicate length: 90545

r_  generation: 0.05717277526855469

local_output_nid generation: 0.01270151138305664
local_in_edges_tensor generation: 0.01418924331665039
mini_batch_src_global generation: 0.019164323806762695

&&&&&&&&&&&&&&& before remove duplicate length: 536364
&&&&&&&&&&&&&&& after remove duplicate length: 88004

r_  generation: 0.07058978080749512


connection checking time:  1.038367509841919
block generation total time  0.9346411228179932
block dataloader generation time/epoch 15.219151496887207
pseudo mini batch 0 input nodes size: 64703
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.049318790435791016  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08017158508300781  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08034420013427734  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

first layer input nodes number: 64703
first layer output nodes number: 41040
edges number: 234616
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03939104080200195  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([64703, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03939104080200195  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03939104080200195  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06086158752441406  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06086158752441406  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10000038146972656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([41040, 256])
h_self size  torch.Size([41040, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10000038146972656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([41040, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13913917541503906  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10000038146972656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([41040, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13913917541503906  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1489238739013672  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------input nodes number: 41040
----------------output nodes number: 23139
----------------edges number: 158928
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14940261840820312  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14940261840820312  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17282676696777344  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17282676696777344  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17627477645874023  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([23139, 40])
h_self size  torch.Size([23139, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17627477645874023  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([23139, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17972278594970703  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17627477645874023  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([23139, 40])
pseudo mini batch 1 input nodes size: 51929
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03575611114501953  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06051778793334961  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06068754196166992  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

first layer input nodes number: 51929
first layer output nodes number: 36403
edges number: 220234
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03333616256713867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([51929, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03333616256713867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03333616256713867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05247163772583008  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05247163772583008  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0871882438659668  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([36403, 256])
h_self size  torch.Size([36403, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0871882438659668  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([36403, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12190485000610352  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0871882438659668  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([36403, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12190485000610352  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1305842399597168  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------input nodes number: 36403
----------------output nodes number: 22779
----------------edges number: 184401
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1310253143310547  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1310253143310547  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15429306030273438  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15429306030273438  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15861940383911133  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([22779, 40])
h_self size  torch.Size([22779, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15861940383911133  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22779, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.16201400756835938  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15768766403198242  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22779, 40])
pseudo mini batch 2 input nodes size: 93841
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.029608726501464844  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07453060150146484  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07469511032104492  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

first layer input nodes number: 93841
first layer output nodes number: 52368
edges number: 325254
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05429553985595703  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([93841, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05429553985595703  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05429553985595703  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08188629150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08188629150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13266754150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([52368, 256])
h_self size  torch.Size([52368, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13266754150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([52368, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18344879150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13266754150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([52368, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18344879150390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19593429565429688  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------input nodes number: 52368
----------------output nodes number: 22071
----------------edges number: 136472
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1964893341064453  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1964893341064453  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2187204360961914  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2187204360961914  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22200965881347656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([22071, 40])
h_self size  torch.Size([22071, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22200965881347656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22071, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22529888153076172  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22200965881347656  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22071, 40])
pseudo mini batch 3 input nodes size: 93262
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.050351619720458984  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09482240676879883  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09499359130859375  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

first layer input nodes number: 93262
first layer output nodes number: 69342
edges number: 536364
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05738401412963867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([93262, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05738401412963867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05738401412963867  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0951395034790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0951395034790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1615457534790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([69342, 256])
h_self size  torch.Size([69342, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1615457534790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([69342, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2279520034790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1615457534790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([69342, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2279520034790039  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24448442459106445  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------input nodes number: 69342
----------------output nodes number: 22952
----------------edges number: 264449
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24517250061035156  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24517250061035156  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2698698043823242  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2698698043823242  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.27329015731811523  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

h_neigh size torch.Size([22952, 40])
h_self size  torch.Size([22952, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.27329015731811523  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22952, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.27671051025390625  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.27329015731811523  GigaBytes
Max Memory Allocated: 0.3761587142944336  GigaBytes

torch.Size([22952, 40])
Average training time/epoch 0.14497947692871094
Average Training time/epoch w/o nid counting 0.14458084106445312
Number of nodes for computation during this epoch:  502888
Number of first layer input nodes during this epoch:  303735
Number of first layer output nodes during this epoch:  199153

-----------------------------------------------------------------------------epoch done
read pickle file
0.04503941535949707

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0180966854095459
global_2_local spend time (sec) 0.045152902603149414

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.204 seconds
Metis partitioning: 4.872 seconds
Split the graph: 3.204 seconds
Construct subgraphs: 0.044 seconds
23162
22877
22449
22453
REG metis partition end ----................................
the time spent:  12.413447618484497
REG construction  time spent:  3.0771560668945312
pure dgl.metis_partition the time spent:  9.336291551589966
total k batches seeds list generation spend  12.597497463226318
after graph partition
graph partition algorithm spend time 12.688243627548218

partition_len_list
[40711, 34924, 52518, 67585]
REG selection method  spend 12.761025190353394
check_connections_block*********************************
time for parepare 1: 0.01525115966796875
local_output_nid generation: 0.0032706260681152344
local_in_edges_tensor generation: 0.003760099411010742
mini_batch_src_global generation: 0.005700111389160156

&&&&&&&&&&&&&&& before remove duplicate length: 165193
&&&&&&&&&&&&&&& after remove duplicate length: 38722

r_  generation: 0.023882627487182617

local_output_nid generation: 0.004313945770263672
local_in_edges_tensor generation: 0.004106998443603516
mini_batch_src_global generation: 0.006540536880493164

&&&&&&&&&&&&&&& before remove duplicate length: 181783
&&&&&&&&&&&&&&& after remove duplicate length: 33382

r_  generation: 0.02256011962890625

local_output_nid generation: 0.004292964935302734
local_in_edges_tensor generation: 0.003767251968383789
mini_batch_src_global generation: 0.0034942626953125

&&&&&&&&&&&&&&& before remove duplicate length: 142178
&&&&&&&&&&&&&&& after remove duplicate length: 48520

r_  generation: 0.02681875228881836

local_output_nid generation: 0.004386186599731445
local_in_edges_tensor generation: 0.004693269729614258
mini_batch_src_global generation: 0.0077342987060546875

&&&&&&&&&&&&&&& before remove duplicate length: 255096
&&&&&&&&&&&&&&& after remove duplicate length: 63338

r_  generation: 0.03216266632080078


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04076051712036133
gen group dst list time:  0.005577802658081055
check_connections_block*********************************
time for parepare 1: 0.01760268211364746
local_output_nid generation: 0.0061647891998291016
local_in_edges_tensor generation: 0.011679887771606445
mini_batch_src_global generation: 0.007767677307128906

&&&&&&&&&&&&&&& before remove duplicate length: 237569
&&&&&&&&&&&&&&& after remove duplicate length: 62502

r_  generation: 0.03735089302062988

local_output_nid generation: 0.007474422454833984
local_in_edges_tensor generation: 0.005458831787109375
mini_batch_src_global generation: 0.005766630172729492

&&&&&&&&&&&&&&& before remove duplicate length: 208835
&&&&&&&&&&&&&&& after remove duplicate length: 47477

r_  generation: 0.03192949295043945

local_output_nid generation: 0.011255979537963867
local_in_edges_tensor generation: 0.010966300964355469
mini_batch_src_global generation: 0.01018381118774414

&&&&&&&&&&&&&&& before remove duplicate length: 326903
&&&&&&&&&&&&&&& after remove duplicate length: 87534

r_  generation: 0.056594133377075195

local_output_nid generation: 0.012055635452270508
local_in_edges_tensor generation: 0.02673959732055664
mini_batch_src_global generation: 0.016788959503173828

&&&&&&&&&&&&&&& before remove duplicate length: 523364
&&&&&&&&&&&&&&& after remove duplicate length: 86552

r_  generation: 0.06745338439941406


connection checking time:  1.004396915435791
block generation total time  0.9223997592926025
block dataloader generation time/epoch 14.98983895778656
pseudo mini batch 0 input nodes size: 64387
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.04934406280517578  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08004617691040039  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08021879196166992  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 64387
first layer output nodes number: 40711
edges number: 237569
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03936290740966797  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([64387, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03936290740966797  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03936290740966797  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.060698509216308594  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.060698509216308594  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09952354431152344  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([40711, 256])
h_self size  torch.Size([40711, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09952354431152344  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([40711, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13834857940673828  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09952354431152344  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([40711, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13834857940673828  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1480550765991211  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 40711
----------------output nodes number: 23162
----------------edges number: 165193
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14853143692016602  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14853143692016602  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17202425003051758  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17202425003051758  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17604923248291016  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([23162, 40])
h_self size  torch.Size([23162, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17604923248291016  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23162, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17950105667114258  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17547607421875  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23162, 40])
pseudo mini batch 1 input nodes size: 49103
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.036182403564453125  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05959653854370117  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05976724624633789  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 49103
first layer output nodes number: 34924
edges number: 208835
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03243064880371094  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([49103, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03243064880371094  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.03243064880371094  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05077028274536133  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05077028274536133  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0840764045715332  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([34924, 256])
h_self size  torch.Size([34924, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0840764045715332  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([34924, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.11738252639770508  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0840764045715332  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([34924, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.11738252639770508  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12570905685424805  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 34924
----------------output nodes number: 22877
----------------edges number: 181783
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12614011764526367  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12614011764526367  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14948320388793945  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14948320388793945  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15328645706176758  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([22877, 40])
h_self size  torch.Size([22877, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15328645706176758  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22877, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.15721607208251953  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1534128189086914  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22877, 40])
pseudo mini batch 2 input nodes size: 90988
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.028670787811279297  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07205724716186523  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07222461700439453  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 90988
first layer output nodes number: 52518
edges number: 326903
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05352210998535156  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([90988, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05352210998535156  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05352210998535156  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08119630813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08119630813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13197755813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([52518, 256])
h_self size  torch.Size([52518, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13197755813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([52518, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18275880813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13197755813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([52518, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18275880813598633  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1952800750732422  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 52518
----------------output nodes number: 22449
----------------edges number: 142178
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19583892822265625  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19583892822265625  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.218475341796875  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.218475341796875  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2221088409423828  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([22449, 40])
h_self size  torch.Size([22449, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2221088409423828  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22449, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22545433044433594  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22182083129882812  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22449, 40])
pseudo mini batch 3 input nodes size: 91733
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.04847002029418945  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09221172332763672  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09237909317016602  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 91733
first layer output nodes number: 67585
edges number: 523364
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05616474151611328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([91733, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05616474151611328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05616474151611328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0925436019897461  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.0925436019897461  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1569976806640625  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([67585, 256])
h_self size  torch.Size([67585, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1569976806640625  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([67585, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2214517593383789  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1569976806640625  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([67585, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2214517593383789  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2375655174255371  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 67585
----------------output nodes number: 22453
----------------edges number: 255096
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2382369041442871  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2382369041442871  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2617182731628418  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2617182731628418  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2651357650756836  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([22453, 40])
h_self size  torch.Size([22453, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2651357650756836  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22453, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2684817314147949  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2650642395019531  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22453, 40])
Average training time/epoch 0.14137792587280273
Average Training time/epoch w/o nid counting 0.13729095458984375
Number of nodes for computation during this epoch:  491949
Number of first layer input nodes during this epoch:  296211
Number of first layer output nodes during this epoch:  195738

-----------------------------------------------------------------------------epoch done
read pickle file
0.04000663757324219

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016229867935180664
global_2_local spend time (sec) 0.04442930221557617

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.189 seconds
Metis partitioning: 4.836 seconds
Split the graph: 3.278 seconds
Construct subgraphs: 0.047 seconds
23202
22202
22271
23266
REG metis partition end ----................................
the time spent:  12.334385871887207
REG construction  time spent:  2.969001054763794
pure dgl.metis_partition the time spent:  9.365384817123413
total k batches seeds list generation spend  12.559454679489136
after graph partition
graph partition algorithm spend time 12.656805038452148

partition_len_list
[41128, 33764, 51487, 69474]
REG selection method  spend 12.729419946670532
check_connections_block*********************************
time for parepare 1: 0.015113353729248047
local_output_nid generation: 0.0033223628997802734
local_in_edges_tensor generation: 0.0039844512939453125
mini_batch_src_global generation: 0.0051572322845458984

&&&&&&&&&&&&&&& before remove duplicate length: 155794
&&&&&&&&&&&&&&& after remove duplicate length: 39038

r_  generation: 0.024070262908935547

local_output_nid generation: 0.004237174987792969
local_in_edges_tensor generation: 0.00431060791015625
mini_batch_src_global generation: 0.004958152770996094

&&&&&&&&&&&&&&& before remove duplicate length: 175726
&&&&&&&&&&&&&&& after remove duplicate length: 32116

r_  generation: 0.021830081939697266

local_output_nid generation: 0.004243612289428711
local_in_edges_tensor generation: 0.003796100616455078
mini_batch_src_global generation: 0.0037512779235839844

&&&&&&&&&&&&&&& before remove duplicate length: 148304
&&&&&&&&&&&&&&& after remove duplicate length: 47623

r_  generation: 0.026027441024780273

local_output_nid generation: 0.005005836486816406
local_in_edges_tensor generation: 0.005406379699707031
mini_batch_src_global generation: 0.008879661560058594

&&&&&&&&&&&&&&& before remove duplicate length: 264426
&&&&&&&&&&&&&&& after remove duplicate length: 65017

r_  generation: 0.03394937515258789


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06397461891174316
gen group dst list time:  0.006430387496948242
check_connections_block*********************************
time for parepare 1: 0.02282857894897461
local_output_nid generation: 0.006719350814819336
local_in_edges_tensor generation: 0.0270540714263916
mini_batch_src_global generation: 0.008070945739746094

&&&&&&&&&&&&&&& before remove duplicate length: 233973
&&&&&&&&&&&&&&& after remove duplicate length: 62938

r_  generation: 0.04000353813171387

local_output_nid generation: 0.007653474807739258
local_in_edges_tensor generation: 0.006302595138549805
mini_batch_src_global generation: 0.005649566650390625

&&&&&&&&&&&&&&& before remove duplicate length: 200958
&&&&&&&&&&&&&&& after remove duplicate length: 45755

r_  generation: 0.03304743766784668

local_output_nid generation: 0.011440515518188477
local_in_edges_tensor generation: 0.00978541374206543
mini_batch_src_global generation: 0.009472846984863281

&&&&&&&&&&&&&&& before remove duplicate length: 322857
&&&&&&&&&&&&&&& after remove duplicate length: 88882

r_  generation: 0.059502601623535156

local_output_nid generation: 0.012763023376464844
local_in_edges_tensor generation: 0.013486862182617188
mini_batch_src_global generation: 0.017180919647216797

&&&&&&&&&&&&&&& before remove duplicate length: 534540
&&&&&&&&&&&&&&& after remove duplicate length: 87794

r_  generation: 0.0728158950805664


connection checking time:  1.0501453876495361
block generation total time  0.9330875873565674
block dataloader generation time/epoch 14.930229107538858
pseudo mini batch 0 input nodes size: 64725
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.04860830307006836  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07947158813476562  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07964468002319336  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 64725
first layer output nodes number: 41128
edges number: 233973
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.039429664611816406  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([64725, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.039429664611816406  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.039429664611816406  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06093788146972656  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.06093788146972656  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10016059875488281  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([41128, 256])
h_self size  torch.Size([41128, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10016059875488281  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([41128, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13938331604003906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.10016059875488281  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([41128, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13938331604003906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14918899536132812  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 41128
----------------output nodes number: 23202
----------------edges number: 155794
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14966869354248047  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14966869354248047  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17313098907470703  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17313098907470703  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17742395401000977  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([23202, 40])
h_self size  torch.Size([23202, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17742395401000977  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23202, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18169879913330078  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.17740583419799805  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23202, 40])
pseudo mini batch 1 input nodes size: 47357
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.035776615142822266  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.059214115142822266  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05937957763671875  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 47357
first layer output nodes number: 33764
edges number: 200958
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.031754493713378906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([47357, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.031754493713378906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.031754493713378906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.049477577209472656  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.049477577209472656  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08167743682861328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([33764, 256])
h_self size  torch.Size([33764, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08167743682861328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([33764, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1138772964477539  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08167743682861328  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([33764, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1138772964477539  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.12192726135253906  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 33764
----------------output nodes number: 22202
----------------edges number: 175726
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1223444938659668  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1223444938659668  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14499330520629883  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14499330520629883  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14842462539672852  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([22202, 40])
h_self size  torch.Size([22202, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.14842462539672852  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22202, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1517333984375  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.1483020782470703  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22202, 40])
pseudo mini batch 2 input nodes size: 92307
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.028316974639892578  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07323884963989258  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.07340478897094727  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 92307
first layer output nodes number: 51487
edges number: 322857
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05438518524169922  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([92307, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05438518524169922  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05438518524169922  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08192110061645508  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.08192110061645508  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13102293014526367  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([51487, 256])
h_self size  torch.Size([51487, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13102293014526367  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([51487, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18012475967407227  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.13102293014526367  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([51487, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.18012475967407227  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19240045547485352  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 51487
----------------output nodes number: 22271
----------------edges number: 148304
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19295024871826172  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.19295024871826172  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21546077728271484  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21546077728271484  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2187795639038086  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([22271, 40])
h_self size  torch.Size([22271, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2187795639038086  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22271, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2227473258972168  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.21942853927612305  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([22271, 40])
pseudo mini batch 3 input nodes size: 93151
----------------------------------------before batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.049689292907714844  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09410715103149414  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09428071975708008  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

first layer input nodes number: 93151
first layer output nodes number: 69474
edges number: 534540
----------------------------------------before model layer 0
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05676841735839844  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([93151, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05676841735839844  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.05676841735839844  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.09413862228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.16054487228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([69474, 256])
h_self size  torch.Size([69474, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.16054487228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([69474, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22695112228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.16054487228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([69474, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.22695112228393555  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2435150146484375  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------input nodes number: 69474
----------------output nodes number: 23266
----------------edges number: 264426
----------------------------------------before mean aggregator
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24420642852783203  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.24420642852783203  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2685384750366211  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2685384750366211  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2725200653076172  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

h_neigh size torch.Size([23266, 40])
h_self size  torch.Size([23266, 256])
----------------------------------------before rst
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2725200653076172  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23266, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.2759871482849121  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2069091796875 GB
    Memory Allocated: 0.272005558013916  GigaBytes
Max Memory Allocated: 0.38237571716308594  GigaBytes

torch.Size([23266, 40])
Average training time/epoch 0.14870929718017578
Average Training time/epoch w/o nid counting 0.1630568504333496
Number of nodes for computation during this epoch:  493393
Number of first layer input nodes during this epoch:  297540
Number of first layer output nodes during this epoch:  195853

-----------------------------------------------------------------------------epoch done
