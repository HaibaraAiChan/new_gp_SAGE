main start at this time 1660939833.7786996
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0283660888671875
global_2_local spend time (sec) 0.031966447830200195

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.211 seconds
Metis partitioning: 5.356 seconds
Split the graph: 1.058 seconds
Construct subgraphs: 0.046 seconds
5789
5753
5854
5659
5755
5799
5810
5784
5633
5697
5520
5565
5541
5517
5517
5748
REG metis partition end ----................................
the time spent:  10.733250141143799
REG construction  time spent:  3.0491573810577393
pure dgl.metis_partition the time spent:  7.68409276008606
total k batches seeds list generation spend  10.900870323181152
after graph partition
graph partition algorithm spend time 10.97824478149414

partition_len_list
[10552, 10560, 12659, 12153, 10993, 13500, 13802, 9538, 13032, 14917, 25354, 17734, 30477, 27084, 28312, 28437]
REG selection method  spend 11.036191940307617
check_connections_block*********************************
time for parepare 1: 0.015928268432617188
local_output_nid generation: 0.0012662410736083984
local_in_edges_tensor generation: 0.0014100074768066406
mini_batch_src_global generation: 0.0017852783203125

&&&&&&&&&&&&&&& before remove duplicate length: 48753
&&&&&&&&&&&&&&& after remove duplicate length: 10125

r_  generation: 0.009352922439575195

local_output_nid generation: 0.001401662826538086
local_in_edges_tensor generation: 0.0012814998626708984
mini_batch_src_global generation: 0.0009143352508544922

&&&&&&&&&&&&&&& before remove duplicate length: 41430
&&&&&&&&&&&&&&& after remove duplicate length: 9955

r_  generation: 0.007351875305175781

local_output_nid generation: 0.0015459060668945312
local_in_edges_tensor generation: 0.0013434886932373047
mini_batch_src_global generation: 0.0012786388397216797

&&&&&&&&&&&&&&& before remove duplicate length: 53352
&&&&&&&&&&&&&&& after remove duplicate length: 12031

r_  generation: 0.006830453872680664

local_output_nid generation: 0.0014925003051757812
local_in_edges_tensor generation: 0.0011875629425048828
mini_batch_src_global generation: 0.0010552406311035156

&&&&&&&&&&&&&&& before remove duplicate length: 41302
&&&&&&&&&&&&&&& after remove duplicate length: 11333

r_  generation: 0.006498813629150391

local_output_nid generation: 0.0015268325805664062
local_in_edges_tensor generation: 0.0011973381042480469
mini_batch_src_global generation: 0.0009515285491943359

&&&&&&&&&&&&&&& before remove duplicate length: 39995
&&&&&&&&&&&&&&& after remove duplicate length: 10400

r_  generation: 0.006255388259887695

local_output_nid generation: 0.0015347003936767578
local_in_edges_tensor generation: 0.001180410385131836
mini_batch_src_global generation: 0.0009732246398925781

&&&&&&&&&&&&&&& before remove duplicate length: 47327
&&&&&&&&&&&&&&& after remove duplicate length: 12680

r_  generation: 0.006917238235473633

local_output_nid generation: 0.0015285015106201172
local_in_edges_tensor generation: 0.0012013912200927734
mini_batch_src_global generation: 0.0011124610900878906

&&&&&&&&&&&&&&& before remove duplicate length: 43166
&&&&&&&&&&&&&&& after remove duplicate length: 12893

r_  generation: 0.007021903991699219

local_output_nid generation: 0.001542806625366211
local_in_edges_tensor generation: 0.0011219978332519531
mini_batch_src_global generation: 0.0010309219360351562

&&&&&&&&&&&&&&& before remove duplicate length: 29858
&&&&&&&&&&&&&&& after remove duplicate length: 8913

r_  generation: 0.005324363708496094

local_output_nid generation: 0.0015208721160888672
local_in_edges_tensor generation: 0.0010585784912109375
mini_batch_src_global generation: 0.0009243488311767578

&&&&&&&&&&&&&&& before remove duplicate length: 32939
&&&&&&&&&&&&&&& after remove duplicate length: 12016

r_  generation: 0.00650334358215332

local_output_nid generation: 0.0014934539794921875
local_in_edges_tensor generation: 0.0011260509490966797
mini_batch_src_global generation: 0.0008451938629150391

&&&&&&&&&&&&&&& before remove duplicate length: 36445
&&&&&&&&&&&&&&& after remove duplicate length: 13628

r_  generation: 0.006943464279174805

local_output_nid generation: 0.0014238357543945312
local_in_edges_tensor generation: 0.0011560916900634766
mini_batch_src_global generation: 0.0011687278747558594

&&&&&&&&&&&&&&& before remove duplicate length: 52271
&&&&&&&&&&&&&&& after remove duplicate length: 23360

r_  generation: 0.010054588317871094

local_output_nid generation: 0.001584768295288086
local_in_edges_tensor generation: 0.0011723041534423828
mini_batch_src_global generation: 0.0010428428649902344

&&&&&&&&&&&&&&& before remove duplicate length: 38695
&&&&&&&&&&&&&&& after remove duplicate length: 16070

r_  generation: 0.007692813873291016

local_output_nid generation: 0.0015919208526611328
local_in_edges_tensor generation: 0.0011987686157226562
mini_batch_src_global generation: 0.0011758804321289062

&&&&&&&&&&&&&&& before remove duplicate length: 56150
&&&&&&&&&&&&&&& after remove duplicate length: 27972

r_  generation: 0.01112985610961914

local_output_nid generation: 0.0022826194763183594
local_in_edges_tensor generation: 0.0037508010864257812
mini_batch_src_global generation: 0.002118825912475586

&&&&&&&&&&&&&&& before remove duplicate length: 46284
&&&&&&&&&&&&&&& after remove duplicate length: 24543

r_  generation: 0.010358095169067383

local_output_nid generation: 0.0016560554504394531
local_in_edges_tensor generation: 0.0013287067413330078
mini_batch_src_global generation: 0.0013463497161865234

&&&&&&&&&&&&&&& before remove duplicate length: 56775
&&&&&&&&&&&&&&& after remove duplicate length: 25975

r_  generation: 0.010896444320678711

local_output_nid generation: 0.0018000602722167969
local_in_edges_tensor generation: 0.0015909671783447266
mini_batch_src_global generation: 0.002164125442504883

&&&&&&&&&&&&&&& before remove duplicate length: 79508
&&&&&&&&&&&&&&& after remove duplicate length: 26708

r_  generation: 0.013776302337646484


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04312777519226074
gen group dst list time:  0.008302688598632812
check_connections_block*********************************
time for parepare 1: 0.023144245147705078
local_output_nid generation: 0.016959428787231445
local_in_edges_tensor generation: 0.018889188766479492
mini_batch_src_global generation: 0.0023174285888671875

&&&&&&&&&&&&&&& before remove duplicate length: 70907
&&&&&&&&&&&&&&& after remove duplicate length: 19672

r_  generation: 0.01063847541809082

local_output_nid generation: 0.0031011104583740234
local_in_edges_tensor generation: 0.002325773239135742
mini_batch_src_global generation: 0.0015344619750976562

&&&&&&&&&&&&&&& before remove duplicate length: 61899
&&&&&&&&&&&&&&& after remove duplicate length: 18786

r_  generation: 0.010819196701049805

local_output_nid generation: 0.0034356117248535156
local_in_edges_tensor generation: 0.002858877182006836
mini_batch_src_global generation: 0.0019321441650390625

&&&&&&&&&&&&&&& before remove duplicate length: 86700
&&&&&&&&&&&&&&& after remove duplicate length: 20968

r_  generation: 0.012227058410644531

local_output_nid generation: 0.003359556198120117
local_in_edges_tensor generation: 0.0026276111602783203
mini_batch_src_global generation: 0.0015859603881835938

&&&&&&&&&&&&&&& before remove duplicate length: 75251
&&&&&&&&&&&&&&& after remove duplicate length: 23828

r_  generation: 0.013558626174926758

local_output_nid generation: 0.003157377243041992
local_in_edges_tensor generation: 0.002359628677368164
mini_batch_src_global generation: 0.0014507770538330078

&&&&&&&&&&&&&&& before remove duplicate length: 64081
&&&&&&&&&&&&&&& after remove duplicate length: 19072

r_  generation: 0.011472702026367188

local_output_nid generation: 0.0037398338317871094
local_in_edges_tensor generation: 0.002825021743774414
mini_batch_src_global generation: 0.0022745132446289062

&&&&&&&&&&&&&&& before remove duplicate length: 90436
&&&&&&&&&&&&&&& after remove duplicate length: 30164

r_  generation: 0.015643835067749023

local_output_nid generation: 0.003856658935546875
local_in_edges_tensor generation: 0.0029201507568359375
mini_batch_src_global generation: 0.0021283626556396484

&&&&&&&&&&&&&&& before remove duplicate length: 86598
&&&&&&&&&&&&&&& after remove duplicate length: 28712

r_  generation: 0.015478372573852539

local_output_nid generation: 0.0026786327362060547
local_in_edges_tensor generation: 0.0020029544830322266
mini_batch_src_global generation: 0.0012054443359375

&&&&&&&&&&&&&&& before remove duplicate length: 44719
&&&&&&&&&&&&&&& after remove duplicate length: 14351

r_  generation: 0.015787124633789062

local_output_nid generation: 0.0037026405334472656
local_in_edges_tensor generation: 0.0028657913208007812
mini_batch_src_global generation: 0.0018837451934814453

&&&&&&&&&&&&&&& before remove duplicate length: 75629
&&&&&&&&&&&&&&& after remove duplicate length: 29901

r_  generation: 0.014960050582885742

local_output_nid generation: 0.004051923751831055
local_in_edges_tensor generation: 0.0031359195709228516
mini_batch_src_global generation: 0.0023033618927001953

&&&&&&&&&&&&&&& before remove duplicate length: 91771
&&&&&&&&&&&&&&& after remove duplicate length: 33495

r_  generation: 0.01701664924621582

local_output_nid generation: 0.006650447845458984
local_in_edges_tensor generation: 0.008959770202636719
mini_batch_src_global generation: 0.008853912353515625

&&&&&&&&&&&&&&& before remove duplicate length: 200423
&&&&&&&&&&&&&&& after remove duplicate length: 57392

r_  generation: 0.028516292572021484

local_output_nid generation: 0.006151914596557617
local_in_edges_tensor generation: 0.006696224212646484
mini_batch_src_global generation: 0.003988504409790039

&&&&&&&&&&&&&&& before remove duplicate length: 123716
&&&&&&&&&&&&&&& after remove duplicate length: 38132

r_  generation: 0.020390987396240234

local_output_nid generation: 0.007940053939819336
local_in_edges_tensor generation: 0.010959148406982422
mini_batch_src_global generation: 0.008849620819091797

&&&&&&&&&&&&&&& before remove duplicate length: 247166
&&&&&&&&&&&&&&& after remove duplicate length: 64761

r_  generation: 0.033991336822509766

local_output_nid generation: 0.007884979248046875
local_in_edges_tensor generation: 0.00862264633178711
mini_batch_src_global generation: 0.006374359130859375

&&&&&&&&&&&&&&& before remove duplicate length: 210783
&&&&&&&&&&&&&&& after remove duplicate length: 65084

r_  generation: 0.033445119857788086

local_output_nid generation: 0.009230852127075195
local_in_edges_tensor generation: 0.007741451263427734
mini_batch_src_global generation: 0.013150215148925781

&&&&&&&&&&&&&&& before remove duplicate length: 233283
&&&&&&&&&&&&&&& after remove duplicate length: 58330

r_  generation: 0.032773494720458984

local_output_nid generation: 0.007761478424072266
local_in_edges_tensor generation: 0.007729530334472656
mini_batch_src_global generation: 0.007654666900634766

&&&&&&&&&&&&&&& before remove duplicate length: 247185
&&&&&&&&&&&&&&& after remove duplicate length: 49435

r_  generation: 0.030483722686767578


connection checking time:  1.4401192665100098
block generation total time  1.2764167785644531
pseudo mini batch 0 input nodes size: 20210
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0975341796875 GB
    Memory Allocated: 0.009957313537597656  GigaBytes
Max Memory Allocated: 0.009957313537597656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0975341796875 GB
    Memory Allocated: 0.01000070571899414  GigaBytes
Max Memory Allocated: 0.01000070571899414  GigaBytes

first layer input nodes number: 20210
first layer output nodes number: 10552
edges number: 70907
----------------------------------------before model layer 0
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.011121749877929688  GigaBytes
Max Memory Allocated: 0.011385917663574219  GigaBytes

torch.Size([20210, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.011121749877929688  GigaBytes
Max Memory Allocated: 0.011385917663574219  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.011121749877929688  GigaBytes
Max Memory Allocated: 0.011385917663574219  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.3494873046875 GB
    Memory Allocated: 0.016721248626708984  GigaBytes
Max Memory Allocated: 0.02179241180419922  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.3494873046875 GB
    Memory Allocated: 0.016721248626708984  GigaBytes
Max Memory Allocated: 0.02179241180419922  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.3494873046875 GB
    Memory Allocated: 0.026784420013427734  GigaBytes
Max Memory Allocated: 0.026784420013427734  GigaBytes

h_neigh size torch.Size([10552, 256])
h_self size  torch.Size([10552, 128])
----------------------------------------before rst
 Nvidia-smi: 7.3494873046875 GB
    Memory Allocated: 0.026784420013427734  GigaBytes
Max Memory Allocated: 0.026784420013427734  GigaBytes

torch.Size([10552, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.036847591400146484  GigaBytes
Max Memory Allocated: 0.046910762786865234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.026784420013427734  GigaBytes
Max Memory Allocated: 0.046910762786865234  GigaBytes

torch.Size([10552, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.036847591400146484  GigaBytes
Max Memory Allocated: 0.046910762786865234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.03936338424682617  GigaBytes
Max Memory Allocated: 0.04942655563354492  GigaBytes

----------------input nodes number: 10552
----------------output nodes number: 5789
----------------edges number: 48753
----------------------------------------before mean aggregator
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.03948545455932617  GigaBytes
Max Memory Allocated: 0.04942655563354492  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.03948545455932617  GigaBytes
Max Memory Allocated: 0.04942655563354492  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04541349411010742  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04541349411010742  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04627656936645508  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

h_neigh size torch.Size([5789, 40])
h_self size  torch.Size([5789, 256])
----------------------------------------before rst
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04627656936645508  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

torch.Size([5789, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 0.047139644622802734  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 0.04627656936645508  GigaBytes
Max Memory Allocated: 0.0509343147277832  GigaBytes

torch.Size([5789, 40])
pseudo mini batch 1 input nodes size: 19285
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.011185169219970703  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.021079540252685547  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.021122455596923828  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

first layer input nodes number: 19285
first layer output nodes number: 10560
edges number: 61899
----------------------------------------before model layer 0
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.012435436248779297  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

torch.Size([19285, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.012435436248779297  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.012435436248779297  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.01797199249267578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.01797199249267578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.02804279327392578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

h_neigh size torch.Size([10560, 256])
h_self size  torch.Size([10560, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.02804279327392578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

torch.Size([10560, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.03811359405517578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.02804279327392578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

torch.Size([10560, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.03811359405517578  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04063129425048828  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------input nodes number: 10560
----------------output nodes number: 5753
----------------edges number: 41430
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04075288772583008  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04075288772583008  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04659128189086914  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04659128189086914  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04744863510131836  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

h_neigh size torch.Size([5753, 40])
h_self size  torch.Size([5753, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04744863510131836  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

torch.Size([5753, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04830598831176758  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4022216796875 GB
    Memory Allocated: 0.04744863510131836  GigaBytes
Max Memory Allocated: 0.0613408088684082  GigaBytes

torch.Size([5753, 40])
pseudo mini batch 2 input nodes size: 21634
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.01143646240234375  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.021752357482910156  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.021796226501464844  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

first layer input nodes number: 21634
first layer output nodes number: 12659
edges number: 86700
----------------------------------------before model layer 0
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.01315927505493164  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

torch.Size([21634, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.01315927505493164  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4158935546875 GB
    Memory Allocated: 0.01315927505493164  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4178466796875 GB
    Memory Allocated: 0.019889354705810547  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4178466796875 GB
    Memory Allocated: 0.019889354705810547  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4178466796875 GB
    Memory Allocated: 0.031961917877197266  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

h_neigh size torch.Size([12659, 256])
h_self size  torch.Size([12659, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4178466796875 GB
    Memory Allocated: 0.031961917877197266  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

torch.Size([12659, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.044034481048583984  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.031961917877197266  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

torch.Size([12659, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.044034481048583984  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.047052860260009766  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------input nodes number: 12659
----------------output nodes number: 5854
----------------edges number: 53352
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.04719114303588867  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.04719114303588867  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05321550369262695  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05321550369262695  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05408811569213867  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05408811569213867  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05496072769165039  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4315185546875 GB
    Memory Allocated: 0.05408811569213867  GigaBytes
Max Memory Allocated: 0.061568260192871094  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 3 input nodes size: 24500
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.011874198913574219  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.02359294891357422  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.023635387420654297  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

first layer input nodes number: 24500
first layer output nodes number: 12153
edges number: 75251
----------------------------------------before model layer 0
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.014417648315429688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([24500, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.014417648315429688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.014417648315429688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.02094745635986328  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.02094745635986328  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03266620635986328  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([12153, 256])
h_self size  torch.Size([12153, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03266620635986328  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([12153, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.04425621032714844  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03253746032714844  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([12153, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.04425621032714844  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.04715394973754883  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------input nodes number: 12153
----------------output nodes number: 5659
----------------edges number: 41302
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0472869873046875  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0472869873046875  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05395984649658203  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05395984649658203  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05480337142944336  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([5659, 40])
h_self size  torch.Size([5659, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05480337142944336  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5659, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05564689636230469  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05480337142944336  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5659, 40])
pseudo mini batch 4 input nodes size: 19467
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.013246536254882812  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.022529125213623047  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.022572040557861328  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

first layer input nodes number: 19467
first layer output nodes number: 10993
edges number: 64081
----------------------------------------before model layer 0
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.011814594268798828  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([19467, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.011814594268798828  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.011814594268798828  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.01757526397705078  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.01757526397705078  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.028059005737304688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([10993, 256])
h_self size  torch.Size([10993, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.028059005737304688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([10993, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.038542747497558594  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.028059005737304688  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([10993, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.038542747497558594  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.04173088073730469  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------input nodes number: 10993
----------------output nodes number: 5755
----------------edges number: 39995
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.041855812072753906  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.041855812072753906  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.048427581787109375  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.048427581787109375  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0492854118347168  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([5755, 40])
h_self size  torch.Size([5755, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0492854118347168  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5755, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05014324188232422  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0492854118347168  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5755, 40])
pseudo mini batch 5 input nodes size: 31128
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.010825157165527344  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.02566814422607422  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.025711536407470703  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

first layer input nodes number: 31128
first layer output nodes number: 13500
edges number: 90436
----------------------------------------before model layer 0
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([31128, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.0177459716796875  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.024908065795898438  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.024908065795898438  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03857994079589844  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([13500, 256])
h_self size  torch.Size([13500, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03857994079589844  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([13500, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05145454406738281  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.03778266906738281  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([13500, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05145454406738281  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.054673194885253906  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------input nodes number: 13500
----------------output nodes number: 5799
----------------edges number: 47327
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05481719970703125  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.05481719970703125  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.060744285583496094  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.060744285583496094  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.06160879135131836  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

h_neigh size torch.Size([5799, 40])
h_self size  torch.Size([5799, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.06160879135131836  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5799, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.062473297119140625  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4471435546875 GB
    Memory Allocated: 0.06160879135131836  GigaBytes
Max Memory Allocated: 0.07221651077270508  GigaBytes

torch.Size([5799, 40])
pseudo mini batch 6 input nodes size: 29485
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.01639270782470703  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.030452251434326172  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.030495643615722656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

first layer input nodes number: 29485
first layer output nodes number: 13802
edges number: 86598
----------------------------------------before model layer 0
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.016900062561035156  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([29485, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.016900062561035156  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.016900062561035156  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.024178504943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.024178504943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.037850379943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([13802, 256])
h_self size  torch.Size([13802, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.037850379943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([13802, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.051522254943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.037850379943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([13802, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.051522254943847656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05481290817260742  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------input nodes number: 13802
----------------output nodes number: 5810
----------------edges number: 43166
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05495929718017578  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05495929718017578  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.06150341033935547  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.06150341033935547  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.062369346618652344  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([5810, 40])
h_self size  torch.Size([5810, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.062369346618652344  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5810, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.06323528289794922  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.062369346618652344  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5810, 40])
pseudo mini batch 7 input nodes size: 14683
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.015610694885253906  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.02261209487915039  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.022655487060546875  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

first layer input nodes number: 14683
first layer output nodes number: 9538
edges number: 44719
----------------------------------------before model layer 0
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.009290695190429688  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([14683, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.009290695190429688  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.009290695190429688  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.014208316802978516  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.014208316802978516  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.023304462432861328  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([9538, 256])
h_self size  torch.Size([9538, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.023304462432861328  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([9538, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03240060806274414  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.023304462432861328  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([9538, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03240060806274414  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03502321243286133  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------input nodes number: 9538
----------------output nodes number: 5784
----------------edges number: 29858
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03513813018798828  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03513813018798828  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04092121124267578  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04092121124267578  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04178333282470703  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([5784, 40])
h_self size  torch.Size([5784, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04178333282470703  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5784, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04264545440673828  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04178333282470703  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5784, 40])
pseudo mini batch 8 input nodes size: 30732
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.008548736572265625  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.023202896118164062  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.02324533462524414  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

first layer input nodes number: 30732
first layer output nodes number: 13032
edges number: 75629
----------------------------------------before model layer 0
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.01733684539794922  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([30732, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.01733684539794922  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.01733684539794922  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.024163246154785156  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.024163246154785156  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([13032, 256])
h_self size  torch.Size([13032, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([13032, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.049019813537597656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.036591529846191406  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([13032, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.049019813537597656  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05212688446044922  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------input nodes number: 13032
----------------output nodes number: 5633
----------------edges number: 32939
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.052266597747802734  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.052266597747802734  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.057927608489990234  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.057927608489990234  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05876731872558594  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([5633, 40])
h_self size  torch.Size([5633, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05876731872558594  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5633, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05960702896118164  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.05876731872558594  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5633, 40])
pseudo mini batch 9 input nodes size: 34437
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.016178131103515625  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03259897232055664  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.03264188766479492  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

first layer input nodes number: 34437
first layer output nodes number: 14917
edges number: 91771
----------------------------------------before model layer 0
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.019269466400146484  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([34437, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.019269466400146484  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.019269466400146484  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.027122020721435547  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.027122020721435547  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([14917, 256])
h_self size  torch.Size([14917, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4608154296875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([14917, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.05557394027709961  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.04134798049926758  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([14917, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.05557394027709961  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.05913066864013672  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------input nodes number: 14917
----------------output nodes number: 5697
----------------edges number: 36445
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.05928516387939453  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.05928516387939453  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06588554382324219  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06588554382324219  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06673479080200195  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

h_neigh size torch.Size([5697, 40])
h_self size  torch.Size([5697, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06673479080200195  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5697, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06758403778076172  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4920654296875 GB
    Memory Allocated: 0.06673479080200195  GigaBytes
Max Memory Allocated: 0.0829463005065918  GigaBytes

torch.Size([5697, 40])
pseudo mini batch 10 input nodes size: 59859
----------------------------------------before batch input features to device
 Nvidia-smi: 7.5096435546875 GB
    Memory Allocated: 0.01795482635498047  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.04725170135498047  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.04729318618774414  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

first layer input nodes number: 59859
first layer output nodes number: 25354
edges number: 200423
----------------------------------------before model layer 0
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.03334856033325195  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

torch.Size([59859, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.03334856033325195  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5389404296875 GB
    Memory Allocated: 0.03334856033325195  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5447998046875 GB
    Memory Allocated: 0.047026634216308594  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5447998046875 GB
    Memory Allocated: 0.047026634216308594  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5701904296875 GB
    Memory Allocated: 0.07120609283447266  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

h_neigh size torch.Size([25354, 256])
h_self size  torch.Size([25354, 128])
----------------------------------------before rst
 Nvidia-smi: 7.5701904296875 GB
    Memory Allocated: 0.07120609283447266  GigaBytes
Max Memory Allocated: 0.08836793899536133  GigaBytes

torch.Size([25354, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.09538555145263672  GigaBytes
Max Memory Allocated: 0.11956501007080078  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.07120609283447266  GigaBytes
Max Memory Allocated: 0.11956501007080078  GigaBytes

torch.Size([25354, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.09538555145263672  GigaBytes
Max Memory Allocated: 0.11956501007080078  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10143041610717773  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------input nodes number: 25354
----------------output nodes number: 5520
----------------edges number: 52271
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10166120529174805  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10166120529174805  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10735750198364258  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10735750198364258  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10818004608154297  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

h_neigh size torch.Size([5520, 40])
h_self size  torch.Size([5520, 256])
----------------------------------------before rst
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10818004608154297  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

torch.Size([5520, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10900259017944336  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6209716796875 GB
    Memory Allocated: 0.10818004608154297  GigaBytes
Max Memory Allocated: 0.1256098747253418  GigaBytes

torch.Size([5520, 40])
pseudo mini batch 11 input nodes size: 39909
----------------------------------------before batch input features to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.03080272674560547  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.05033397674560547  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.05037546157836914  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

first layer input nodes number: 39909
first layer output nodes number: 17734
edges number: 123716
----------------------------------------before model layer 0
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.022678375244140625  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([39909, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.022678375244140625  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.022678375244140625  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.03212308883666992  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.03212308883666992  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.04903554916381836  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

h_neigh size torch.Size([17734, 256])
h_self size  torch.Size([17734, 128])
----------------------------------------before rst
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.04903554916381836  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([17734, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0659480094909668  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.04903554916381836  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([17734, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0659480094909668  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0701761245727539  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------input nodes number: 17734
----------------output nodes number: 5565
----------------edges number: 38695
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07035017013549805  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07035017013549805  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0759882926940918  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.0759882926940918  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07681798934936523  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

h_neigh size torch.Size([5565, 40])
h_self size  torch.Size([5565, 256])
----------------------------------------before rst
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07681798934936523  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([5565, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07764768600463867  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.07681798934936523  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([5565, 40])
pseudo mini batch 12 input nodes size: 67654
----------------------------------------before batch input features to device
 Nvidia-smi: 7.6580810546875 GB
    Memory Allocated: 0.021044254302978516  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6912841796875 GB
    Memory Allocated: 0.054247379302978516  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6912841796875 GB
    Memory Allocated: 0.05428886413574219  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

first layer input nodes number: 67654
first layer output nodes number: 30477
edges number: 247166
----------------------------------------before model layer 0
 Nvidia-smi: 7.6912841796875 GB
    Memory Allocated: 0.037708282470703125  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([67654, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6912841796875 GB
    Memory Allocated: 0.037708282470703125  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6912841796875 GB
    Memory Allocated: 0.037708282470703125  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6932373046875 GB
    Memory Allocated: 0.05419635772705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6932373046875 GB
    Memory Allocated: 0.05419635772705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6932373046875 GB
    Memory Allocated: 0.08349323272705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

h_neigh size torch.Size([30477, 256])
h_self size  torch.Size([30477, 128])
----------------------------------------before rst
 Nvidia-smi: 7.6932373046875 GB
    Memory Allocated: 0.08349323272705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([30477, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.11279010772705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.08349323272705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([30477, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.11279010772705078  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.1200566291809082  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------input nodes number: 30477
----------------output nodes number: 5541
----------------edges number: 56150
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12032556533813477  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12032556533813477  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12607049942016602  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12607049942016602  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12689638137817383  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

h_neigh size torch.Size([5541, 40])
h_self size  torch.Size([5541, 256])
----------------------------------------before rst
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12689638137817383  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([5541, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12772226333618164  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 0.12689638137817383  GigaBytes
Max Memory Allocated: 0.15088987350463867  GigaBytes

torch.Size([5541, 40])
pseudo mini batch 13 input nodes size: 67825
----------------------------------------before batch input features to device
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 0.03471231460571289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.06791543960571289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.06795692443847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 67825
first layer output nodes number: 27084
edges number: 210783
----------------------------------------before model layer 0
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.037335872650146484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([67825, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.037335872650146484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.037335872650146484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.05267953872680664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.05267953872680664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07850885391235352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([27084, 256])
h_self size  torch.Size([27084, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07850885391235352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27084, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10433816909790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07850885391235352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27084, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10433816909790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11079549789428711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 27084
----------------output nodes number: 5517
----------------edges number: 46284
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1110391616821289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1110391616821289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11668777465820312  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11668777465820312  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11751031875610352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11751031875610352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1183328628540039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11751031875610352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 14 input nodes size: 61146
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.03470897674560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.06400585174560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.06404733657836914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 61146
first layer output nodes number: 28312
edges number: 233283
----------------------------------------before model layer 0
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.03363180160522461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([61146, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.03363180160522461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.03363180160522461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.0491480827331543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.0491480827331543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07614850997924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([28312, 256])
h_self size  torch.Size([28312, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07614850997924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28312, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1031489372253418  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07614850997924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28312, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1031489372253418  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10989904403686523  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 28312
----------------output nodes number: 5517
----------------edges number: 56775
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11015176773071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11015176773071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11587858200073242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11587858200073242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11670112609863281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11670112609863281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.1175236701965332  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11670112609863281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 15 input nodes size: 52269
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.03080272674560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.05619335174560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.05623626708984375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 52269
first layer output nodes number: 28437
edges number: 247185
----------------------------------------before model layer 0
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.029935359954833984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([52269, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.029935359954833984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.029935359954833984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.045556068420410156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.045556068420410156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07267570495605469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([28437, 256])
h_self size  torch.Size([28437, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07267570495605469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28437, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.07267570495605469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.09979534149169922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10657548904418945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 28437
----------------output nodes number: 5748
----------------edges number: 79508
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.10683059692382812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11370372772216797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11370372772216797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11456060409545898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5748, 40])
h_self size  torch.Size([5748, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11456060409545898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5748, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11541748046875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8182373046875 GB
    Memory Allocated: 0.11456060409545898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5748, 40])
Number of nodes for computation during this epoch:  873327
Number of first layer input nodes during this epoch:  594223
Number of first layer output nodes during this epoch:  279104

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024885177612304688
global_2_local spend time (sec) 0.041900634765625

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.271 seconds
Metis partitioning: 5.504 seconds
Split the graph: 1.533 seconds
Construct subgraphs: 0.089 seconds
5854
5854
5837
5558
5747
5854
5854
5720
5517
5708
5553
5517
5801
5517
5517
5533
REG metis partition end ----................................
the time spent:  11.445156574249268
REG construction  time spent:  3.034893035888672
pure dgl.metis_partition the time spent:  8.410263538360596
total k batches seeds list generation spend  11.611091375350952
after graph partition
graph partition algorithm spend time 11.70063328742981

partition_len_list
[13987, 12562, 9884, 11490, 11309, 10682, 12247, 12292, 16831, 13943, 12959, 19963, 29205, 24973, 28338, 27468]
REG selection method  spend 11.771876573562622
check_connections_block*********************************
time for parepare 1: 0.014955997467041016
local_output_nid generation: 0.0012319087982177734
local_in_edges_tensor generation: 0.0015869140625
mini_batch_src_global generation: 0.001833200454711914

&&&&&&&&&&&&&&& before remove duplicate length: 51202
&&&&&&&&&&&&&&& after remove duplicate length: 13254

r_  generation: 0.006951332092285156

local_output_nid generation: 0.0014791488647460938
local_in_edges_tensor generation: 0.0013909339904785156
mini_batch_src_global generation: 0.001031637191772461

&&&&&&&&&&&&&&& before remove duplicate length: 43429
&&&&&&&&&&&&&&& after remove duplicate length: 11958

r_  generation: 0.006849765777587891

local_output_nid generation: 0.001501321792602539
local_in_edges_tensor generation: 0.0012712478637695312
mini_batch_src_global generation: 0.0011315345764160156

&&&&&&&&&&&&&&& before remove duplicate length: 32088
&&&&&&&&&&&&&&& after remove duplicate length: 9347

r_  generation: 0.005453586578369141

local_output_nid generation: 0.0014722347259521484
local_in_edges_tensor generation: 0.0011653900146484375
mini_batch_src_global generation: 0.0009245872497558594

&&&&&&&&&&&&&&& before remove duplicate length: 38425
&&&&&&&&&&&&&&& after remove duplicate length: 10739

r_  generation: 0.006772518157958984

local_output_nid generation: 0.0028312206268310547
local_in_edges_tensor generation: 0.0012717247009277344
mini_batch_src_global generation: 0.0009202957153320312

&&&&&&&&&&&&&&& before remove duplicate length: 43392
&&&&&&&&&&&&&&& after remove duplicate length: 10684

r_  generation: 0.006333351135253906

local_output_nid generation: 0.0015444755554199219
local_in_edges_tensor generation: 0.0012819766998291016
mini_batch_src_global generation: 0.0010876655578613281

&&&&&&&&&&&&&&& before remove duplicate length: 51194
&&&&&&&&&&&&&&& after remove duplicate length: 10296

r_  generation: 0.006372928619384766

local_output_nid generation: 0.0015981197357177734
local_in_edges_tensor generation: 0.0012941360473632812
mini_batch_src_global generation: 0.0012850761413574219

&&&&&&&&&&&&&&& before remove duplicate length: 53780
&&&&&&&&&&&&&&& after remove duplicate length: 11679

r_  generation: 0.00682377815246582

local_output_nid generation: 0.0016307830810546875
local_in_edges_tensor generation: 0.001272439956665039
mini_batch_src_global generation: 0.0009620189666748047

&&&&&&&&&&&&&&& before remove duplicate length: 38429
&&&&&&&&&&&&&&& after remove duplicate length: 11438

r_  generation: 0.006546497344970703

local_output_nid generation: 0.0015707015991210938
local_in_edges_tensor generation: 0.001157522201538086
mini_batch_src_global generation: 0.0008001327514648438

&&&&&&&&&&&&&&& before remove duplicate length: 33498
&&&&&&&&&&&&&&& after remove duplicate length: 15038

r_  generation: 0.007038116455078125

local_output_nid generation: 0.001596212387084961
local_in_edges_tensor generation: 0.00119781494140625
mini_batch_src_global generation: 0.0008819103240966797

&&&&&&&&&&&&&&& before remove duplicate length: 34807
&&&&&&&&&&&&&&& after remove duplicate length: 12937

r_  generation: 0.007025480270385742

local_output_nid generation: 0.0015265941619873047
local_in_edges_tensor generation: 0.0011510848999023438
mini_batch_src_global generation: 0.0010688304901123047

&&&&&&&&&&&&&&& before remove duplicate length: 29803
&&&&&&&&&&&&&&& after remove duplicate length: 11675

r_  generation: 0.005750179290771484

local_output_nid generation: 0.0015568733215332031
local_in_edges_tensor generation: 0.0011224746704101562
mini_batch_src_global generation: 0.0009975433349609375

&&&&&&&&&&&&&&& before remove duplicate length: 40587
&&&&&&&&&&&&&&& after remove duplicate length: 18069

r_  generation: 0.007830381393432617

local_output_nid generation: 0.0015802383422851562
local_in_edges_tensor generation: 0.0017101764678955078
mini_batch_src_global generation: 0.0030481815338134766

&&&&&&&&&&&&&&& before remove duplicate length: 77360
&&&&&&&&&&&&&&& after remove duplicate length: 27357

r_  generation: 0.010939359664916992

local_output_nid generation: 0.0017328262329101562
local_in_edges_tensor generation: 0.0013492107391357422
mini_batch_src_global generation: 0.0014765262603759766

&&&&&&&&&&&&&&& before remove duplicate length: 59115
&&&&&&&&&&&&&&& after remove duplicate length: 23150

r_  generation: 0.010418891906738281

local_output_nid generation: 0.001767873764038086
local_in_edges_tensor generation: 0.0016028881072998047
mini_batch_src_global generation: 0.0015211105346679688

&&&&&&&&&&&&&&& before remove duplicate length: 66897
&&&&&&&&&&&&&&& after remove duplicate length: 26269

r_  generation: 0.011000633239746094

local_output_nid generation: 0.0017888545989990234
local_in_edges_tensor generation: 0.0014085769653320312
mini_batch_src_global generation: 0.0012710094451904297

&&&&&&&&&&&&&&& before remove duplicate length: 50244
&&&&&&&&&&&&&&& after remove duplicate length: 25175

r_  generation: 0.010728120803833008


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0369868278503418
gen group dst list time:  0.0077669620513916016
check_connections_block*********************************
time for parepare 1: 0.02090597152709961
local_output_nid generation: 0.0026988983154296875
local_in_edges_tensor generation: 0.007463932037353516
mini_batch_src_global generation: 0.0031812191009521484

&&&&&&&&&&&&&&& before remove duplicate length: 96912
&&&&&&&&&&&&&&& after remove duplicate length: 31975

r_  generation: 0.015693187713623047

local_output_nid generation: 0.0037217140197753906
local_in_edges_tensor generation: 0.002826690673828125
mini_batch_src_global generation: 0.002061605453491211

&&&&&&&&&&&&&&& before remove duplicate length: 76437
&&&&&&&&&&&&&&& after remove duplicate length: 23592

r_  generation: 0.013918399810791016

local_output_nid generation: 0.002896547317504883
local_in_edges_tensor generation: 0.0022149085998535156
mini_batch_src_global generation: 0.0012967586517333984

&&&&&&&&&&&&&&& before remove duplicate length: 48620
&&&&&&&&&&&&&&& after remove duplicate length: 15807

r_  generation: 0.009980440139770508

local_output_nid generation: 0.0032286643981933594
local_in_edges_tensor generation: 0.0024750232696533203
mini_batch_src_global generation: 0.0013699531555175781

&&&&&&&&&&&&&&& before remove duplicate length: 68373
&&&&&&&&&&&&&&& after remove duplicate length: 24352

r_  generation: 0.02321457862854004

local_output_nid generation: 0.0032188892364501953
local_in_edges_tensor generation: 0.0024154186248779297
mini_batch_src_global generation: 0.0015988349914550781

&&&&&&&&&&&&&&& before remove duplicate length: 68323
&&&&&&&&&&&&&&& after remove duplicate length: 21942

r_  generation: 0.013234376907348633

local_output_nid generation: 0.0030477046966552734
local_in_edges_tensor generation: 0.002307891845703125
mini_batch_src_global generation: 0.0018000602722167969

&&&&&&&&&&&&&&& before remove duplicate length: 72281
&&&&&&&&&&&&&&& after remove duplicate length: 19795

r_  generation: 0.011395931243896484

local_output_nid generation: 0.0031762123107910156
local_in_edges_tensor generation: 0.0025904178619384766
mini_batch_src_global generation: 0.001970052719116211

&&&&&&&&&&&&&&& before remove duplicate length: 84736
&&&&&&&&&&&&&&& after remove duplicate length: 19896

r_  generation: 0.011930465698242188

local_output_nid generation: 0.0032265186309814453
local_in_edges_tensor generation: 0.00273895263671875
mini_batch_src_global generation: 0.00164794921875

&&&&&&&&&&&&&&& before remove duplicate length: 73338
&&&&&&&&&&&&&&& after remove duplicate length: 23943

r_  generation: 0.013571500778198242

local_output_nid generation: 0.0044519901275634766
local_in_edges_tensor generation: 0.004289150238037109
mini_batch_src_global generation: 0.002992868423461914

&&&&&&&&&&&&&&& before remove duplicate length: 106737
&&&&&&&&&&&&&&& after remove duplicate length: 40962

r_  generation: 0.022893905639648438

local_output_nid generation: 0.0039904117584228516
local_in_edges_tensor generation: 0.005215883255004883
mini_batch_src_global generation: 0.002489805221557617

&&&&&&&&&&&&&&& before remove duplicate length: 83179
&&&&&&&&&&&&&&& after remove duplicate length: 31929

r_  generation: 0.01713871955871582

local_output_nid generation: 0.0036385059356689453
local_in_edges_tensor generation: 0.0028066635131835938
mini_batch_src_global generation: 0.0017871856689453125

&&&&&&&&&&&&&&& before remove duplicate length: 70405
&&&&&&&&&&&&&&& after remove duplicate length: 27823

r_  generation: 0.01534271240234375

local_output_nid generation: 0.005306243896484375
local_in_edges_tensor generation: 0.004965066909790039
mini_batch_src_global generation: 0.00397944450378418

&&&&&&&&&&&&&&& before remove duplicate length: 145266
&&&&&&&&&&&&&&& after remove duplicate length: 45129

r_  generation: 0.02299666404724121

local_output_nid generation: 0.007361412048339844
local_in_edges_tensor generation: 0.009459257125854492
mini_batch_src_global generation: 0.008333206176757812

&&&&&&&&&&&&&&& before remove duplicate length: 252270
&&&&&&&&&&&&&&& after remove duplicate length: 52325

r_  generation: 0.030247926712036133

local_output_nid generation: 0.0068819522857666016
local_in_edges_tensor generation: 0.005334138870239258
mini_batch_src_global generation: 0.00561976432800293

&&&&&&&&&&&&&&& before remove duplicate length: 205309
&&&&&&&&&&&&&&& after remove duplicate length: 47401

r_  generation: 0.027184009552001953

local_output_nid generation: 0.0074443817138671875
local_in_edges_tensor generation: 0.006515026092529297
mini_batch_src_global generation: 0.0064280033111572266

&&&&&&&&&&&&&&& before remove duplicate length: 239360
&&&&&&&&&&&&&&& after remove duplicate length: 55444

r_  generation: 0.031850576400756836

local_output_nid generation: 0.007806062698364258
local_in_edges_tensor generation: 0.006228208541870117
mini_batch_src_global generation: 0.006189823150634766

&&&&&&&&&&&&&&& before remove duplicate length: 218860
&&&&&&&&&&&&&&& after remove duplicate length: 63027

r_  generation: 0.033910512924194336


connection checking time:  1.325845718383789
block generation total time  1.196526050567627
pseudo mini batch 0 input nodes size: 33006
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.027572154998779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04331064224243164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04335451126098633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 33006
first layer output nodes number: 13987
edges number: 96912
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.019376754760742188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([33006, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.019376754760742188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.019376754760742188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026821613311767578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026821613311767578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04049348831176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13987, 256])
h_self size  torch.Size([13987, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04049348831176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13987, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05416536331176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04049348831176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13987, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05416536331176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.057958126068115234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13987
----------------output nodes number: 5854
----------------edges number: 51202
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.058106422424316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.058106422424316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06466865539550781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06466865539550781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06554126739501953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06554126739501953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06641387939453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06554126739501953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 1 input nodes size: 24198
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.017937660217285156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.029656410217285156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.029700279235839844  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 24198
first layer output nodes number: 12562
edges number: 76437
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015087127685546875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24198, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015087127685546875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015087127685546875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021694660186767578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021694660186767578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03367471694946289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12562, 256])
h_self size  torch.Size([12562, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03367471694946289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12562, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0456547737121582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03367471694946289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12562, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0456547737121582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04864978790283203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12562
----------------output nodes number: 5854
----------------edges number: 43429
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048787593841552734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048787593841552734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05529165267944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05529165267944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05616426467895508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05616426467895508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0570368766784668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05616426467895508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 2 input nodes size: 16165
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013917922973632812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021625995635986328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021669864654541016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 16165
first layer output nodes number: 9884
edges number: 48620
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.010703563690185547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([16165, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.010703563690185547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.010703563690185547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015816211700439453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015816211700439453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.025242328643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([9884, 256])
h_self size  torch.Size([9884, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.025242328643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([9884, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0346684455871582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.025242328643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([9884, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0346684455871582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03702497482299805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 9884
----------------output nodes number: 5837
----------------edges number: 32088
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03714275360107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03714275360107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043578147888183594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043578147888183594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0444483757019043  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5837, 40])
h_self size  torch.Size([5837, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0444483757019043  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5837, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.045318603515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0444483757019043  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5837, 40])
pseudo mini batch 3 input nodes size: 24931
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.009904861450195312  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021792888641357422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021834373474121094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 24931
first layer output nodes number: 11490
edges number: 68373
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015151500701904297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24931, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015151500701904297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015151500701904297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021944522857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021944522857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.033663272857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11490, 256])
h_self size  torch.Size([11490, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.033663272857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11490, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.045382022857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.033663272857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11490, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.045382022857666016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04812145233154297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11490
----------------output nodes number: 5558
----------------edges number: 38425
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0482487678527832  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0482487678527832  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0538783073425293  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0538783073425293  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054706573486328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5558, 40])
h_self size  torch.Size([5558, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054706573486328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5558, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05553483963012695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054706573486328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5558, 40])
pseudo mini batch 4 input nodes size: 22441
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.014040470123291016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.024741172790527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.024784088134765625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 22441
first layer output nodes number: 11309
edges number: 68323
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01393890380859375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([22441, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01393890380859375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01393890380859375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.020816802978515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.020816802978515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.032535552978515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11309, 256])
h_self size  torch.Size([11309, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.032535552978515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11309, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043320655822753906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.031601905822753906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11309, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043320655822753906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.046207427978515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11309
----------------output nodes number: 5747
----------------edges number: 43392
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04633474349975586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05293893814086914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05293893814086914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05379533767700195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5747, 40])
h_self size  torch.Size([5747, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05379533767700195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5747, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054651737213134766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05379533767700195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5747, 40])
pseudo mini batch 5 input nodes size: 20321
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.012882709503173828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.02257251739501953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.02261638641357422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 20321
first layer output nodes number: 10682
edges number: 72281
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013024330139160156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([20321, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013024330139160156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013024330139160156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01869678497314453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01869678497314453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.028883934020996094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([10682, 256])
h_self size  torch.Size([10682, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.028883934020996094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10682, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.039071083068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.028883934020996094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10682, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.039071083068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.042555809020996094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 10682
----------------output nodes number: 5854
----------------edges number: 51194
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0426793098449707  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0426793098449707  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0492405891418457  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0492405891418457  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05011320114135742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05011320114135742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05098581314086914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05011320114135742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 6 input nodes size: 20575
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.011888980865478516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021699905395507812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0217437744140625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 20575
first layer output nodes number: 12247
edges number: 84736
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013288021087646484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([20575, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013288021087646484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013288021087646484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01984405517578125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01984405517578125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03156280517578125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12247, 256])
h_self size  torch.Size([12247, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03156280517578125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12247, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043242454528808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.031523704528808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12247, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.043242454528808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04616260528564453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12247
----------------output nodes number: 5854
----------------edges number: 53780
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04629802703857422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04629802703857422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05287933349609375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05287933349609375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05375194549560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05375194549560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05462455749511719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05375194549560547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 7 input nodes size: 24596
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01201009750366211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023738384246826172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023781299591064453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 24596
first layer output nodes number: 12292
edges number: 73338
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015035629272460938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24596, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015035629272460938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015035629272460938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021489620208740234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.021489620208740234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03321218490600586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12292, 256])
h_self size  torch.Size([12292, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03321218490600586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12292, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.044934749603271484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03321218490600586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12292, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.044934749603271484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04883718490600586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12292
----------------output nodes number: 5720
----------------edges number: 38429
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048972129821777344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048972129821777344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054757118225097656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.054757118225097656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5720, 40])
h_self size  torch.Size([5720, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5720, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05646228790283203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.055609703063964844  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5720, 40])
pseudo mini batch 8 input nodes size: 42251
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.013906478881835938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03405332565307617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.034094810485839844  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 42251
first layer output nodes number: 16831
edges number: 106737
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023809432983398438  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([42251, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023809432983398438  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023809432983398438  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03269338607788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03269338607788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04874467849731445  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([16831, 256])
h_self size  torch.Size([16831, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04874467849731445  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([16831, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06479597091674805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04874467849731445  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([16831, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06479597091674805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06880903244018555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 16831
----------------output nodes number: 5517
----------------edges number: 33498
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06897592544555664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06897592544555664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07452917098999023  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07452917098999023  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07535171508789062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07535171508789062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07617425918579102  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07535171508789062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 9 input nodes size: 32924
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.022293567657470703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03799295425415039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03803586959838867  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 32924
first layer output nodes number: 13943
edges number: 83179
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([32924, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01907634735107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026396751403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026396751403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.040068626403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13943, 256])
h_self size  torch.Size([13943, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.040068626403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13943, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.053740501403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.040068626403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13943, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.053740501403808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.057572364807128906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13943
----------------output nodes number: 5708
----------------edges number: 34807
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05771923065185547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05771923065185547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06429672241210938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06429672241210938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06514739990234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5708, 40])
h_self size  torch.Size([5708, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06514739990234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5708, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06599807739257812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.06514739990234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5708, 40])
pseudo mini batch 10 input nodes size: 28635
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.01787567138671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03154754638671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03158903121948242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 28635
first layer output nodes number: 12959
edges number: 70405
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.016904830932617188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28635, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.016904830932617188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.016904830932617188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023658275604248047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.023658275604248047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03601694107055664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12959, 256])
h_self size  torch.Size([12959, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03601694107055664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12959, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048375606536865234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03601694107055664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12959, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.048375606536865234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05164194107055664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12959
----------------output nodes number: 5553
----------------edges number: 29803
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05178022384643555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05178022384643555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.057340145111083984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.057340145111083984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05816793441772461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5553, 40])
h_self size  torch.Size([5553, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05816793441772461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5553, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.058995723724365234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05816793441772461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5553, 40])
pseudo mini batch 11 input nodes size: 47077
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.015823841094970703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03827190399169922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03831338882446289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 47077
first layer output nodes number: 19963
edges number: 145266
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026485443115234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([47077, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026485443115234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.026485443115234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03716135025024414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03716135025024414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05669260025024414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([19963, 256])
h_self size  torch.Size([19963, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05669260025024414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([19963, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07573080062866211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05619955062866211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([19963, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07573080062866211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0804905891418457  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 19963
----------------output nodes number: 5517
----------------edges number: 40587
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08068084716796875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08068084716796875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0862874984741211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.0862874984741211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08711004257202148  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08711004257202148  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08793258666992188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.08711004257202148  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 12 input nodes size: 55164
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.024594783782958984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.05089902877807617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.050942420959472656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 55164
first layer output nodes number: 29205
edges number: 252270
----------------------------------------before model layer 0
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03153848648071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([55164, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03153848648071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.03153848648071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04745340347290039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.04745340347290039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07530546188354492  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([29205, 256])
h_self size  torch.Size([29205, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07530546188354492  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([29205, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.10315752029418945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.07530546188354492  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([29205, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.10315752029418945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11012077331542969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 29205
----------------output nodes number: 5801
----------------edges number: 77360
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.110382080078125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.110382080078125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11718940734863281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11718940734863281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11805391311645508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5801, 40])
h_self size  torch.Size([5801, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11805391311645508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5801, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11891841888427734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8201904296875 GB
    Memory Allocated: 0.11805391311645508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5801, 40])
pseudo mini batch 13 input nodes size: 49956
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.028494834899902344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.052315711975097656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05235719680786133  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 49956
first layer output nodes number: 24973
edges number: 205309
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02853870391845703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([49956, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02853870391845703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02853870391845703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04206991195678711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04206991195678711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06588602066040039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([24973, 256])
h_self size  torch.Size([24973, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06588602066040039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24973, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08970212936401367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06588602066040039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24973, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08970212936401367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0956563949584961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 24973
----------------output nodes number: 5517
----------------edges number: 59115
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09588432312011719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09588432312011719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10162830352783203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10162830352783203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10245084762573242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10245084762573242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10327339172363281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10245084762573242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 14 input nodes size: 58256
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02596759796142578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05374622344970703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0537877082824707  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 58256
first layer output nodes number: 28338
edges number: 239360
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032853126525878906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([58256, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032853126525878906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032853126525878906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04841423034667969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04841423034667969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.075439453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([28338, 256])
h_self size  torch.Size([28338, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.075439453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28338, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10246467590332031  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.075439453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28338, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10246467590332031  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10922098159790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 28338
----------------output nodes number: 5517
----------------edges number: 66897
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10947370529174805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10947370529174805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11527585983276367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11527585983276367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11609840393066406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11609840393066406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11692094802856445  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11609840393066406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 15 input nodes size: 65836
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02992534637451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.061318397521972656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06135988235473633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 65836
first layer output nodes number: 27468
edges number: 218860
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624105453491211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([65836, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624105453491211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624105453491211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05164623260498047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05164623260498047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([27468, 256])
h_self size  torch.Size([27468, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27468, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10403728485107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07784175872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27468, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10403728485107422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11058616638183594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 27468
----------------output nodes number: 5533
----------------edges number: 50244
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11083269119262695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11083269119262695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11652612686157227  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11652612686157227  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11735105514526367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5533, 40])
h_self size  torch.Size([5533, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11735105514526367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5533, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11817598342895508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11735105514526367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5533, 40])
Number of nodes for computation during this epoch:  834465
Number of first layer input nodes during this epoch:  566332
Number of first layer output nodes during this epoch:  268133

-----------------------------------------------------------------------------epoch done
read pickle file
0.05115199089050293

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0445711612701416
global_2_local spend time (sec) 0.04664111137390137

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.208 seconds
Metis partitioning: 5.640 seconds
Split the graph: 1.250 seconds
Construct subgraphs: 0.160 seconds
5854
5854
5812
5840
5610
5517
5770
5772
5854
5838
5517
5517
5517
5634
5517
5518
REG metis partition end ----................................
the time spent:  11.491894960403442
REG construction  time spent:  3.218057632446289
pure dgl.metis_partition the time spent:  8.273837327957153
total k batches seeds list generation spend  11.668851613998413
after graph partition
graph partition algorithm spend time 11.758289098739624

partition_len_list
[10465, 11275, 11655, 12522, 12619, 11569, 13575, 10830, 13897, 13714, 18239, 23821, 25136, 28662, 25200, 27732]
REG selection method  spend 11.836148977279663
check_connections_block*********************************
time for parepare 1: 0.015078306198120117
local_output_nid generation: 0.0012903213500976562
local_in_edges_tensor generation: 0.0015153884887695312
mini_batch_src_global generation: 0.0014910697937011719

&&&&&&&&&&&&&&& before remove duplicate length: 31353
&&&&&&&&&&&&&&& after remove duplicate length: 9805

r_  generation: 0.005472660064697266

local_output_nid generation: 0.0014178752899169922
local_in_edges_tensor generation: 0.0014166831970214844
mini_batch_src_global generation: 0.001177072525024414

&&&&&&&&&&&&&&& before remove duplicate length: 37573
&&&&&&&&&&&&&&& after remove duplicate length: 10680

r_  generation: 0.006366252899169922

local_output_nid generation: 0.0015072822570800781
local_in_edges_tensor generation: 0.0014035701751708984
mini_batch_src_global generation: 0.0008466243743896484

&&&&&&&&&&&&&&& before remove duplicate length: 40060
&&&&&&&&&&&&&&& after remove duplicate length: 11045

r_  generation: 0.00664520263671875

local_output_nid generation: 0.0015304088592529297
local_in_edges_tensor generation: 0.0013737678527832031
mini_batch_src_global generation: 0.0008790493011474609

&&&&&&&&&&&&&&& before remove duplicate length: 41937
&&&&&&&&&&&&&&& after remove duplicate length: 11774

r_  generation: 0.006788015365600586

local_output_nid generation: 0.0015282630920410156
local_in_edges_tensor generation: 0.0013630390167236328
mini_batch_src_global generation: 0.0010714530944824219

&&&&&&&&&&&&&&& before remove duplicate length: 43432
&&&&&&&&&&&&&&& after remove duplicate length: 11812

r_  generation: 0.006742715835571289

local_output_nid generation: 0.0015850067138671875
local_in_edges_tensor generation: 0.0013420581817626953
mini_batch_src_global generation: 0.0010416507720947266

&&&&&&&&&&&&&&& before remove duplicate length: 42662
&&&&&&&&&&&&&&& after remove duplicate length: 10774

r_  generation: 0.006224393844604492

local_output_nid generation: 0.0016405582427978516
local_in_edges_tensor generation: 0.001682281494140625
mini_batch_src_global generation: 0.0010046958923339844

&&&&&&&&&&&&&&& before remove duplicate length: 45284
&&&&&&&&&&&&&&& after remove duplicate length: 12763

r_  generation: 0.007912158966064453

local_output_nid generation: 0.002974987030029297
local_in_edges_tensor generation: 0.0014331340789794922
mini_batch_src_global generation: 0.0013706684112548828

&&&&&&&&&&&&&&& before remove duplicate length: 52903
&&&&&&&&&&&&&&& after remove duplicate length: 10410

r_  generation: 0.0064716339111328125

local_output_nid generation: 0.0017442703247070312
local_in_edges_tensor generation: 0.001432657241821289
mini_batch_src_global generation: 0.001108407974243164

&&&&&&&&&&&&&&& before remove duplicate length: 51184
&&&&&&&&&&&&&&& after remove duplicate length: 13200

r_  generation: 0.007233858108520508

local_output_nid generation: 0.0017704963684082031
local_in_edges_tensor generation: 0.0013298988342285156
mini_batch_src_global generation: 0.00092315673828125

&&&&&&&&&&&&&&& before remove duplicate length: 36410
&&&&&&&&&&&&&&& after remove duplicate length: 12665

r_  generation: 0.007005453109741211

local_output_nid generation: 0.0016503334045410156
local_in_edges_tensor generation: 0.0013077259063720703
mini_batch_src_global generation: 0.0009839534759521484

&&&&&&&&&&&&&&& before remove duplicate length: 38945
&&&&&&&&&&&&&&& after remove duplicate length: 16546

r_  generation: 0.00758814811706543

local_output_nid generation: 0.0017240047454833984
local_in_edges_tensor generation: 0.0013315677642822266
mini_batch_src_global generation: 0.001234292984008789

&&&&&&&&&&&&&&& before remove duplicate length: 50885
&&&&&&&&&&&&&&& after remove duplicate length: 21873

r_  generation: 0.009684562683105469

local_output_nid generation: 0.0018613338470458984
local_in_edges_tensor generation: 0.0014598369598388672
mini_batch_src_global generation: 0.0015740394592285156

&&&&&&&&&&&&&&& before remove duplicate length: 58756
&&&&&&&&&&&&&&& after remove duplicate length: 23201

r_  generation: 0.01022481918334961

local_output_nid generation: 0.0019168853759765625
local_in_edges_tensor generation: 0.0016031265258789062
mini_batch_src_global generation: 0.0017628669738769531

&&&&&&&&&&&&&&& before remove duplicate length: 74945
&&&&&&&&&&&&&&& after remove duplicate length: 26763

r_  generation: 0.011069297790527344

local_output_nid generation: 0.0019617080688476562
local_in_edges_tensor generation: 0.001422882080078125
mini_batch_src_global generation: 0.0010943412780761719

&&&&&&&&&&&&&&& before remove duplicate length: 41937
&&&&&&&&&&&&&&& after remove duplicate length: 22731

r_  generation: 0.009994745254516602

local_output_nid generation: 0.001968860626220703
local_in_edges_tensor generation: 0.0015110969543457031
mini_batch_src_global generation: 0.00128173828125

&&&&&&&&&&&&&&& before remove duplicate length: 55984
&&&&&&&&&&&&&&& after remove duplicate length: 25460

r_  generation: 0.01076197624206543


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0405733585357666
gen group dst list time:  0.007912635803222656
check_connections_block*********************************
time for parepare 1: 0.01973867416381836
local_output_nid generation: 0.002018451690673828
local_in_edges_tensor generation: 0.010019302368164062
mini_batch_src_global generation: 0.0018208026885986328

&&&&&&&&&&&&&&& before remove duplicate length: 52238
&&&&&&&&&&&&&&& after remove duplicate length: 18320

r_  generation: 0.010549068450927734

local_output_nid generation: 0.003255128860473633
local_in_edges_tensor generation: 0.0027112960815429688
mini_batch_src_global generation: 0.0017502307891845703

&&&&&&&&&&&&&&& before remove duplicate length: 62609
&&&&&&&&&&&&&&& after remove duplicate length: 21151

r_  generation: 0.01179194450378418

local_output_nid generation: 0.0032227039337158203
local_in_edges_tensor generation: 0.0025458335876464844
mini_batch_src_global generation: 0.0015039443969726562

&&&&&&&&&&&&&&& before remove duplicate length: 69051
&&&&&&&&&&&&&&& after remove duplicate length: 21903

r_  generation: 0.012771844863891602

local_output_nid generation: 0.0035440921783447266
local_in_edges_tensor generation: 0.0026884078979492188
mini_batch_src_global generation: 0.0016937255859375

&&&&&&&&&&&&&&& before remove duplicate length: 76370
&&&&&&&&&&&&&&& after remove duplicate length: 25882

r_  generation: 0.014653921127319336

local_output_nid generation: 0.003621339797973633
local_in_edges_tensor generation: 0.0027849674224853516
mini_batch_src_global generation: 0.0019097328186035156

&&&&&&&&&&&&&&& before remove duplicate length: 81549
&&&&&&&&&&&&&&& after remove duplicate length: 22577

r_  generation: 0.013727188110351562

local_output_nid generation: 0.0031785964965820312
local_in_edges_tensor generation: 0.002567291259765625
mini_batch_src_global generation: 0.0016884803771972656

&&&&&&&&&&&&&&& before remove duplicate length: 73663
&&&&&&&&&&&&&&& after remove duplicate length: 20826

r_  generation: 0.012331724166870117

local_output_nid generation: 0.003654003143310547
local_in_edges_tensor generation: 0.0029582977294921875
mini_batch_src_global generation: 0.0019915103912353516

&&&&&&&&&&&&&&& before remove duplicate length: 86903
&&&&&&&&&&&&&&& after remove duplicate length: 28600

r_  generation: 0.015271902084350586

local_output_nid generation: 0.003052234649658203
local_in_edges_tensor generation: 0.0026061534881591797
mini_batch_src_global generation: 0.0020389556884765625

&&&&&&&&&&&&&&& before remove duplicate length: 73966
&&&&&&&&&&&&&&& after remove duplicate length: 19964

r_  generation: 0.011763334274291992

local_output_nid generation: 0.003823995590209961
local_in_edges_tensor generation: 0.0031609535217285156
mini_batch_src_global generation: 0.0021834373474121094

&&&&&&&&&&&&&&& before remove duplicate length: 96072
&&&&&&&&&&&&&&& after remove duplicate length: 32026

r_  generation: 0.01645684242248535

local_output_nid generation: 0.0038547515869140625
local_in_edges_tensor generation: 0.003310680389404297
mini_batch_src_global generation: 0.0020818710327148438

&&&&&&&&&&&&&&& before remove duplicate length: 79920
&&&&&&&&&&&&&&& after remove duplicate length: 29901

r_  generation: 0.016214609146118164

local_output_nid generation: 0.004971027374267578
local_in_edges_tensor generation: 0.0053060054779052734
mini_batch_src_global generation: 0.003901958465576172

&&&&&&&&&&&&&&& before remove duplicate length: 129230
&&&&&&&&&&&&&&& after remove duplicate length: 39422

r_  generation: 0.020069599151611328

local_output_nid generation: 0.006316423416137695
local_in_edges_tensor generation: 0.005494117736816406
mini_batch_src_global generation: 0.00553584098815918

&&&&&&&&&&&&&&& before remove duplicate length: 185635
&&&&&&&&&&&&&&& after remove duplicate length: 52408

r_  generation: 0.027642011642456055

local_output_nid generation: 0.007037162780761719
local_in_edges_tensor generation: 0.006276845932006836
mini_batch_src_global generation: 0.0061190128326416016

&&&&&&&&&&&&&&& before remove duplicate length: 206231
&&&&&&&&&&&&&&& after remove duplicate length: 48921

r_  generation: 0.027782440185546875

local_output_nid generation: 0.0075626373291015625
local_in_edges_tensor generation: 0.007938385009765625
mini_batch_src_global generation: 0.007534980773925781

&&&&&&&&&&&&&&& before remove duplicate length: 248639
&&&&&&&&&&&&&&& after remove duplicate length: 52114

r_  generation: 0.03110480308532715

local_output_nid generation: 0.007326841354370117
local_in_edges_tensor generation: 0.006403207778930664
mini_batch_src_global generation: 0.0056955814361572266

&&&&&&&&&&&&&&& before remove duplicate length: 190090
&&&&&&&&&&&&&&& after remove duplicate length: 61952

r_  generation: 0.031992435455322266

local_output_nid generation: 0.0076198577880859375
local_in_edges_tensor generation: 0.006376504898071289
mini_batch_src_global generation: 0.0067746639251708984

&&&&&&&&&&&&&&& before remove duplicate length: 224848
&&&&&&&&&&&&&&& after remove duplicate length: 58076

r_  generation: 0.033771514892578125


connection checking time:  1.366919755935669
block generation total time  1.2165734767913818
block dataloader generation time/epoch 14.529285907745361
pseudo mini batch 0 input nodes size: 18791
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.033541202545166016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04250144958496094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.042545318603515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 18791
first layer output nodes number: 10465
edges number: 52238
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011952877044677734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([18791, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011952877044677734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011952877044677734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01737213134765625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01737213134765625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([10465, 256])
h_self size  torch.Size([10465, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10465, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03733253479003906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027352333068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10465, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03733253479003906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04009103775024414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 10465
----------------output nodes number: 5854
----------------edges number: 31353
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04021310806274414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04021310806274414  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04662656784057617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04662656784057617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04749917984008789  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04749917984008789  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04837179183959961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04749917984008789  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 1 input nodes size: 21675
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011159420013427734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02149486541748047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.021538734436035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 21675
first layer output nodes number: 11275
edges number: 62609
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01352834701538086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([21675, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01352834701538086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01352834701538086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.020380496978759766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.020380496978759766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032099246978759766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11275, 256])
h_self size  torch.Size([11275, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032099246978759766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11275, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.042851924896240234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031133174896240234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11275, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.042851924896240234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.045771121978759766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11275
----------------output nodes number: 5854
----------------edges number: 37573
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.045899391174316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.045899391174316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.052359580993652344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.052359580993652344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05323219299316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05323219299316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05410480499267578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05323219299316406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 2 input nodes size: 22398
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.012534618377685547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02321481704711914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.023258209228515625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 22398
first layer output nodes number: 11655
edges number: 69051
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013946533203125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([22398, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013946533203125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013946533203125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02066659927368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02066659927368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03238534927368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11655, 256])
h_self size  torch.Size([11655, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03238534927368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11655, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043500423431396484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031781673431396484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11655, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043500423431396484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0462794303894043  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11655
----------------output nodes number: 5812
----------------edges number: 40060
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04641008377075195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04641008377075195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05292844772338867  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05292844772338867  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05379486083984375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5812, 40])
h_self size  torch.Size([5812, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05379486083984375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5812, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05466127395629883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05379486083984375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5812, 40])
pseudo mini batch 3 input nodes size: 26614
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.012872695922851562  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02556324005126953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02560710906982422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 26614
first layer output nodes number: 12522
edges number: 76370
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.016057491302490234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([26614, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.016057491302490234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.016057491302490234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022644519805908203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022644519805908203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034586429595947266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12522, 256])
h_self size  torch.Size([12522, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034586429595947266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12522, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04652833938598633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034586429595947266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12522, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04652833938598633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050211429595947266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12522
----------------output nodes number: 5840
----------------edges number: 41937
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050348758697509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050348758697509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0562748908996582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0562748908996582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057145118713378906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5840, 40])
h_self size  torch.Size([5840, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057145118713378906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5840, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05801534652709961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057145118713378906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5840, 40])
pseudo mini batch 4 input nodes size: 23221
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.014887332916259766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026606082916259766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02664804458618164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 23221
first layer output nodes number: 12619
edges number: 81549
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01511383056640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([23221, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01511383056640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01511383056640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02178668975830078  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02178668975830078  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03382110595703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12619, 256])
h_self size  torch.Size([12619, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03382110595703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12619, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04585552215576172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03382110595703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12619, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04585552215576172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04886436462402344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12619
----------------output nodes number: 5610
----------------edges number: 43432
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04900074005126953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04900074005126953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054717063903808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054717063903808594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055553436279296875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5610, 40])
h_self size  torch.Size([5610, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055553436279296875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5610, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.056389808654785156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055553436279296875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5610, 40])
pseudo mini batch 5 input nodes size: 21422
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013879776000976562  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.024094581604003906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.024136066436767578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 21422
first layer output nodes number: 11569
edges number: 73663
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013489246368408203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([21422, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013489246368408203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013489246368408203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.020284175872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.020284175872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032002925872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11569, 256])
h_self size  torch.Size([11569, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.032002925872802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11569, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04303598403930664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03131723403930664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11569, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04303598403930664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04579448699951172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11569
----------------output nodes number: 5517
----------------edges number: 42662
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.045922279357910156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.045922279357910156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.051544189453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.051544189453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05236673355102539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05236673355102539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05318927764892578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05236673355102539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 6 input nodes size: 29355
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.012361526489257812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026359081268310547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02640247344970703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 29355
first layer output nodes number: 13575
edges number: 86903
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.017451763153076172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([29355, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.017451763153076172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.017451763153076172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.024623394012451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.024623394012451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03829526901245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13575, 256])
h_self size  torch.Size([13575, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03829526901245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13575, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05196714401245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03829526901245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05196714401245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055203914642333984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13575
----------------output nodes number: 5770
----------------edges number: 45284
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055348873138427734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055348873138427734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06194639205932617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06194639205932617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06280660629272461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5770, 40])
h_self size  torch.Size([5770, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06280660629272461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5770, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06366682052612305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06280660629272461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5770, 40])
pseudo mini batch 7 input nodes size: 20465
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.016183853149414062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.025942325592041016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0259857177734375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 20465
first layer output nodes number: 10830
edges number: 73966
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013124465942382812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([20465, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013124465942382812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013124465942382812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.018880367279052734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.018880367279052734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.029208660125732422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([10830, 256])
h_self size  torch.Size([10830, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.029208660125732422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10830, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03953695297241211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.029208660125732422  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10830, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03953695297241211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04288053512573242  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 10830
----------------output nodes number: 5772
----------------edges number: 52903
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04300498962402344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04300498962402344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04965782165527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04965782165527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5772, 40])
h_self size  torch.Size([5772, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5772, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05137825012207031  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5772, 40])
pseudo mini batch 8 input nodes size: 33153
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011944770812988281  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027753353118896484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027797222137451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 33153
first layer output nodes number: 13897
edges number: 96072
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01944446563720703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([33153, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01944446563720703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01944446563720703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026839256286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026839256286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13897, 256])
h_self size  torch.Size([13897, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13897, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054183006286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040511131286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13897, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054183006286621094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05790567398071289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13897
----------------output nodes number: 5854
----------------edges number: 51184
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05805349349975586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05805349349975586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06461477279663086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06461477279663086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06548738479614258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5854, 40])
h_self size  torch.Size([5854, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06548738479614258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0663599967956543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06548738479614258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5854, 40])
pseudo mini batch 9 input nodes size: 30841
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.018007755279541016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.033632755279541016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0336766242980957  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 30841
first layer output nodes number: 13714
edges number: 79920
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019024372100830078  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([30841, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019024372100830078  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019024372100830078  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026211261749267578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026211261749267578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03988313674926758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13714, 256])
h_self size  torch.Size([13714, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03988313674926758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13714, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05355501174926758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03988313674926758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13714, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05355501174926758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.056824684143066406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13714
----------------output nodes number: 5838
----------------edges number: 36410
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.056971073150634766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.056971073150634766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06343793869018555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06343793869018555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06430816650390625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5838, 40])
h_self size  torch.Size([5838, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06430816650390625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5838, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06517839431762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06430816650390625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5838, 40])
pseudo mini batch 10 input nodes size: 41062
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.017821788787841797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.037401676177978516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03744316101074219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 41062
first layer output nodes number: 18239
edges number: 129230
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.023470401763916016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([41062, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.023470401763916016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.023470401763916016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03319883346557617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03319883346557617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050592899322509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([18239, 256])
h_self size  torch.Size([18239, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050592899322509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([18239, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06798696517944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050592899322509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([18239, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06798696517944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07233572006225586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 18239
----------------output nodes number: 5517
----------------edges number: 38945
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07251310348510742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07251310348510742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07810735702514648  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07810735702514648  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07892990112304688  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07892990112304688  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07975244522094727  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07892990112304688  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 11 input nodes size: 54717
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.021726608276367188  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04781770706176758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04785919189453125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 54717
first layer output nodes number: 23821
edges number: 185635
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030586719512939453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([54717, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030586719512939453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030586719512939453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043778419494628906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043778419494628906  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06649589538574219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([23821, 256])
h_self size  torch.Size([23821, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06649589538574219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([23821, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08921337127685547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06649589538574219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([23821, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08921337127685547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09489297866821289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 23821
----------------output nodes number: 5517
----------------edges number: 50885
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09511232376098633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09511232376098633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10079526901245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10079526901245117  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10161781311035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10161781311035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10244035720825195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10161781311035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 12 input nodes size: 51291
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02823781967163086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05362844467163086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05366992950439453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 51291
first layer output nodes number: 25136
edges number: 206231
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030083179473876953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([51291, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030083179473876953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030083179473876953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043700218200683594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043700218200683594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0676717758178711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([25136, 256])
h_self size  torch.Size([25136, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0676717758178711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25136, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0916433334350586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0676717758178711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25136, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0916433334350586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09763622283935547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 25136
----------------output nodes number: 5517
----------------edges number: 58756
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09786510467529297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09786510467529297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.103607177734375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.103607177734375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10442972183227539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10442972183227539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10525226593017578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10442972183227539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 13 input nodes size: 54915
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02753734588623047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05372285842895508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.053765296936035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 54915
first layer output nodes number: 28662
edges number: 248639
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031368255615234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([54915, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031368255615234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031368255615234375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04699993133544922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04699993133544922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07433414459228516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([28662, 256])
h_self size  torch.Size([28662, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07433414459228516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28662, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1016683578491211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07433414459228516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28662, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1016683578491211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10850191116333008  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 28662
----------------output nodes number: 5634
----------------edges number: 74945
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10875797271728516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10875797271728516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11570549011230469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11570549011230469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11654520034790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5634, 40])
h_self size  torch.Size([5634, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11654520034790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5634, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1173849105834961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11654520034790039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5634, 40])
pseudo mini batch 14 input nodes size: 64358
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.028350353240966797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.059038639068603516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05908012390136719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 64358
first layer output nodes number: 25200
edges number: 190090
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03524971008300781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([64358, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03524971008300781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03524971008300781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.048777103424072266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.048777103424072266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07280969619750977  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([25200, 256])
h_self size  torch.Size([25200, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07280969619750977  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25200, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09684228897094727  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07280969619750977  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25200, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09684228897094727  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10285043716430664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 25200
----------------output nodes number: 5517
----------------edges number: 41937
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10307979583740234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10307979583740234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10869598388671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10869598388671875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10951852798461914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10951852798461914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11034107208251953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10951852798461914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 15 input nodes size: 60715
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03283500671386719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06213188171386719  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06217336654663086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 60715
first layer output nodes number: 27732
edges number: 224848
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03419637680053711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([60715, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03419637680053711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03419637680053711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04964733123779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04964733123779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0760946273803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([27732, 256])
h_self size  torch.Size([27732, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0760946273803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27732, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10254192352294922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0760946273803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27732, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10254192352294922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10915374755859375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 27732
----------------output nodes number: 5518
----------------edges number: 55984
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10940217971801758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10940217971801758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11512422561645508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11512422561645508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11594676971435547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5518, 40])
h_self size  torch.Size([5518, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11594676971435547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5518, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11676931381225586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11594676971435547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5518, 40])
Average training time/epoch 0.39920997619628906
Average Training time/epoch w/o nid counting 0.3976564407348633
Number of nodes for computation during this epoch:  845904
Number of first layer input nodes during this epoch:  574993
Number of first layer output nodes during this epoch:  270911

-----------------------------------------------------------------------------epoch done
read pickle file
0.050382375717163086

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02184152603149414
global_2_local spend time (sec) 0.05005049705505371

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.217 seconds
Metis partitioning: 5.448 seconds
Split the graph: 0.995 seconds
Construct subgraphs: 0.069 seconds
5809
5794
5608
5545
5782
5809
5809
5840
5592
5519
5714
5517
5517
5572
5775
5739
REG metis partition end ----................................
the time spent:  10.772121906280518
REG construction  time spent:  3.0306501388549805
pure dgl.metis_partition the time spent:  7.741471767425537
total k batches seeds list generation spend  10.946365356445312
after graph partition
graph partition algorithm spend time 11.04100489616394

partition_len_list
[10848, 11221, 13077, 12427, 12604, 10688, 11554, 14218, 28991, 25648, 26017, 29192, 24238, 18450, 13853, 14458]
REG selection method  spend 11.121451616287231
check_connections_block*********************************
time for parepare 1: 0.014485836029052734
local_output_nid generation: 0.0013127326965332031
local_in_edges_tensor generation: 0.0015451908111572266
mini_batch_src_global generation: 0.002239227294921875

&&&&&&&&&&&&&&& before remove duplicate length: 50357
&&&&&&&&&&&&&&& after remove duplicate length: 10443

r_  generation: 0.007904529571533203

local_output_nid generation: 0.001508951187133789
local_in_edges_tensor generation: 0.0014240741729736328
mini_batch_src_global generation: 0.0010302066802978516

&&&&&&&&&&&&&&& before remove duplicate length: 39301
&&&&&&&&&&&&&&& after remove duplicate length: 10502

r_  generation: 0.007837057113647461

local_output_nid generation: 0.0016982555389404297
local_in_edges_tensor generation: 0.0012865066528320312
mini_batch_src_global generation: 0.0013990402221679688

&&&&&&&&&&&&&&& before remove duplicate length: 44719
&&&&&&&&&&&&&&& after remove duplicate length: 12244

r_  generation: 0.008338451385498047

local_output_nid generation: 0.0015718936920166016
local_in_edges_tensor generation: 0.0013203620910644531
mini_batch_src_global generation: 0.0012738704681396484

&&&&&&&&&&&&&&& before remove duplicate length: 44475
&&&&&&&&&&&&&&& after remove duplicate length: 11567

r_  generation: 0.008168935775756836

local_output_nid generation: 0.001706838607788086
local_in_edges_tensor generation: 0.001308441162109375
mini_batch_src_global generation: 0.0012218952178955078

&&&&&&&&&&&&&&& before remove duplicate length: 41672
&&&&&&&&&&&&&&& after remove duplicate length: 11881

r_  generation: 0.0069086551666259766

local_output_nid generation: 0.0016870498657226562
local_in_edges_tensor generation: 0.0013737678527832031
mini_batch_src_global generation: 0.0010073184967041016

&&&&&&&&&&&&&&& before remove duplicate length: 36903
&&&&&&&&&&&&&&& after remove duplicate length: 10043

r_  generation: 0.0062618255615234375

local_output_nid generation: 0.0016939640045166016
local_in_edges_tensor generation: 0.0013031959533691406
mini_batch_src_global generation: 0.0008301734924316406

&&&&&&&&&&&&&&& before remove duplicate length: 39405
&&&&&&&&&&&&&&& after remove duplicate length: 10901

r_  generation: 0.006479740142822266

local_output_nid generation: 0.0016186237335205078
local_in_edges_tensor generation: 0.0013127326965332031
mini_batch_src_global generation: 0.0010712146759033203

&&&&&&&&&&&&&&& before remove duplicate length: 49687
&&&&&&&&&&&&&&& after remove duplicate length: 13408

r_  generation: 0.007264375686645508

local_output_nid generation: 0.0016918182373046875
local_in_edges_tensor generation: 0.0013518333435058594
mini_batch_src_global generation: 0.0012793540954589844

&&&&&&&&&&&&&&& before remove duplicate length: 54730
&&&&&&&&&&&&&&& after remove duplicate length: 26584

r_  generation: 0.010468006134033203

local_output_nid generation: 0.0018885135650634766
local_in_edges_tensor generation: 0.0013191699981689453
mini_batch_src_global generation: 0.001272439956665039

&&&&&&&&&&&&&&& before remove duplicate length: 43832
&&&&&&&&&&&&&&& after remove duplicate length: 23325

r_  generation: 0.01031041145324707

local_output_nid generation: 0.0019073486328125
local_in_edges_tensor generation: 0.0014574527740478516
mini_batch_src_global generation: 0.0016438961029052734

&&&&&&&&&&&&&&& before remove duplicate length: 68946
&&&&&&&&&&&&&&& after remove duplicate length: 24340

r_  generation: 0.010811328887939453

local_output_nid generation: 0.0018532276153564453
local_in_edges_tensor generation: 0.0015761852264404297
mini_batch_src_global generation: 0.0014739036560058594

&&&&&&&&&&&&&&& before remove duplicate length: 67880
&&&&&&&&&&&&&&& after remove duplicate length: 27161

r_  generation: 0.011370420455932617

local_output_nid generation: 0.0019431114196777344
local_in_edges_tensor generation: 0.0014073848724365234
mini_batch_src_global generation: 0.001230001449584961

&&&&&&&&&&&&&&& before remove duplicate length: 51332
&&&&&&&&&&&&&&& after remove duplicate length: 22344

r_  generation: 0.010461091995239258

local_output_nid generation: 0.0018863677978515625
local_in_edges_tensor generation: 0.0013737678527832031
mini_batch_src_global generation: 0.0010461807250976562

&&&&&&&&&&&&&&& before remove duplicate length: 39520
&&&&&&&&&&&&&&& after remove duplicate length: 16830

r_  generation: 0.008074283599853516

local_output_nid generation: 0.0018877983093261719
local_in_edges_tensor generation: 0.001341104507446289
mini_batch_src_global generation: 0.0009002685546875

&&&&&&&&&&&&&&& before remove duplicate length: 34992
&&&&&&&&&&&&&&& after remove duplicate length: 12730

r_  generation: 0.007133960723876953

local_output_nid generation: 0.001802206039428711
local_in_edges_tensor generation: 0.001338958740234375
mini_batch_src_global generation: 0.0009465217590332031

&&&&&&&&&&&&&&& before remove duplicate length: 36499
&&&&&&&&&&&&&&& after remove duplicate length: 13395

r_  generation: 0.0071871280670166016


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038137197494506836
gen group dst list time:  0.007958412170410156
check_connections_block*********************************
time for parepare 1: 0.017076969146728516
local_output_nid generation: 0.0022001266479492188
local_in_edges_tensor generation: 0.00634455680847168
mini_batch_src_global generation: 0.002434253692626953

&&&&&&&&&&&&&&& before remove duplicate length: 73586
&&&&&&&&&&&&&&& after remove duplicate length: 19899

r_  generation: 0.011103391647338867

local_output_nid generation: 0.003169536590576172
local_in_edges_tensor generation: 0.0027027130126953125
mini_batch_src_global generation: 0.0015106201171875

&&&&&&&&&&&&&&& before remove duplicate length: 63282
&&&&&&&&&&&&&&& after remove duplicate length: 21081

r_  generation: 0.011899471282958984

local_output_nid generation: 0.0035796165466308594
local_in_edges_tensor generation: 0.002861499786376953
mini_batch_src_global generation: 0.0020291805267333984

&&&&&&&&&&&&&&& before remove duplicate length: 86981
&&&&&&&&&&&&&&& after remove duplicate length: 23375

r_  generation: 0.014211416244506836

local_output_nid generation: 0.0036139488220214844
local_in_edges_tensor generation: 0.0026671886444091797
mini_batch_src_global generation: 0.0016722679138183594

&&&&&&&&&&&&&&& before remove duplicate length: 79931
&&&&&&&&&&&&&&& after remove duplicate length: 22830

r_  generation: 0.013654470443725586

local_output_nid generation: 0.003595590591430664
local_in_edges_tensor generation: 0.0027129650115966797
mini_batch_src_global generation: 0.001683950424194336

&&&&&&&&&&&&&&& before remove duplicate length: 76062
&&&&&&&&&&&&&&& after remove duplicate length: 25086

r_  generation: 0.014334678649902344

local_output_nid generation: 0.003130197525024414
local_in_edges_tensor generation: 0.0025870800018310547
mini_batch_src_global generation: 0.0013606548309326172

&&&&&&&&&&&&&&& before remove duplicate length: 58096
&&&&&&&&&&&&&&& after remove duplicate length: 18624

r_  generation: 0.011439323425292969

local_output_nid generation: 0.0032935142517089844
local_in_edges_tensor generation: 0.00240325927734375
mini_batch_src_global generation: 0.0015490055084228516

&&&&&&&&&&&&&&& before remove duplicate length: 67970
&&&&&&&&&&&&&&& after remove duplicate length: 21167

r_  generation: 0.012386322021484375

local_output_nid generation: 0.004394054412841797
local_in_edges_tensor generation: 0.0031921863555908203
mini_batch_src_global generation: 0.0025081634521484375

&&&&&&&&&&&&&&& before remove duplicate length: 97924
&&&&&&&&&&&&&&& after remove duplicate length: 32466

r_  generation: 0.017050743103027344

local_output_nid generation: 0.007845401763916016
local_in_edges_tensor generation: 0.010490179061889648
mini_batch_src_global generation: 0.008162975311279297

&&&&&&&&&&&&&&& before remove duplicate length: 234027
&&&&&&&&&&&&&&& after remove duplicate length: 61978

r_  generation: 0.032855987548828125

local_output_nid generation: 0.008019685745239258
local_in_edges_tensor generation: 0.006819725036621094
mini_batch_src_global generation: 0.005524635314941406

&&&&&&&&&&&&&&& before remove duplicate length: 197055
&&&&&&&&&&&&&&& after remove duplicate length: 63635

r_  generation: 0.03259015083312988

local_output_nid generation: 0.00813603401184082
local_in_edges_tensor generation: 0.007089853286743164
mini_batch_src_global generation: 0.008970499038696289

&&&&&&&&&&&&&&& before remove duplicate length: 219905
&&&&&&&&&&&&&&& after remove duplicate length: 49266

r_  generation: 0.02906942367553711

local_output_nid generation: 0.008068323135375977
local_in_edges_tensor generation: 0.007536411285400391
mini_batch_src_global generation: 0.0070171356201171875

&&&&&&&&&&&&&&& before remove duplicate length: 248212
&&&&&&&&&&&&&&& after remove duplicate length: 54129

r_  generation: 0.033174753189086914

local_output_nid generation: 0.0070989131927490234
local_in_edges_tensor generation: 0.005707740783691406
mini_batch_src_global generation: 0.00577545166015625

&&&&&&&&&&&&&&& before remove duplicate length: 189899
&&&&&&&&&&&&&&& after remove duplicate length: 53115

r_  generation: 0.029407501220703125

local_output_nid generation: 0.005675315856933594
local_in_edges_tensor generation: 0.004281520843505859
mini_batch_src_global generation: 0.003863096237182617

&&&&&&&&&&&&&&& before remove duplicate length: 130381
&&&&&&&&&&&&&&& after remove duplicate length: 40631

r_  generation: 0.02164769172668457

local_output_nid generation: 0.004242897033691406
local_in_edges_tensor generation: 0.0032050609588623047
mini_batch_src_global generation: 0.0023794174194335938

&&&&&&&&&&&&&&& before remove duplicate length: 81366
&&&&&&&&&&&&&&& after remove duplicate length: 30610

r_  generation: 0.01709437370300293

local_output_nid generation: 0.004273414611816406
local_in_edges_tensor generation: 0.0032806396484375
mini_batch_src_global generation: 0.002254962921142578

&&&&&&&&&&&&&&& before remove duplicate length: 90135
&&&&&&&&&&&&&&& after remove duplicate length: 33317

r_  generation: 0.0178067684173584


connection checking time:  1.3963465690612793
block generation total time  1.220656156539917
block dataloader generation time/epoch 14.173430919647217
pseudo mini batch 0 input nodes size: 20400
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03144264221191406  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04117012023925781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0412135124206543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 20400
first layer output nodes number: 10848
edges number: 73586
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01303243637084961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([20400, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01303243637084961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01303243637084961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01879405975341797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01879405975341797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02913951873779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([10848, 256])
h_self size  torch.Size([10848, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02913951873779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10848, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03948497772216797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02913951873779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10848, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03948497772216797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04281139373779297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 10848
----------------output nodes number: 5809
----------------edges number: 50357
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.042935848236083984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.042935848236083984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04953432083129883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04953432083129883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0504002571105957  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5809, 40])
h_self size  torch.Size([5809, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0504002571105957  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05126619338989258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0504002571105957  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
pseudo mini batch 1 input nodes size: 21643
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.011919498443603516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02223968505859375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022283077239990234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 21643
first layer output nodes number: 11221
edges number: 63282
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013523578643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([21643, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013523578643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013523578643798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019388198852539062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019388198852539062  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030089378356933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11221, 256])
h_self size  torch.Size([11221, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030089378356933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11221, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040790557861328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030089378356933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11221, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040790557861328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043761253356933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11221
----------------output nodes number: 5794
----------------edges number: 39301
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04388856887817383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04388856887817383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05041933059692383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05041933059692383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05128288269042969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5794, 40])
h_self size  torch.Size([5794, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05128288269042969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5794, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05214643478393555  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05128288269042969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5794, 40])
pseudo mini batch 2 input nodes size: 24068
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.012509822845458984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.024228572845458984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02427053451538086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 24068
first layer output nodes number: 13077
edges number: 86981
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015166759490966797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24068, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015166759490966797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015166759490966797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022099971771240234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022099971771240234  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034571170806884766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13077, 256])
h_self size  torch.Size([13077, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034571170806884766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13077, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0470423698425293  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.034571170806884766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13077, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0470423698425293  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05016040802001953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13077
----------------output nodes number: 5608
----------------edges number: 44719
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05030012130737305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05030012130737305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05602407455444336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05602407455444336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05685997009277344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5608, 40])
h_self size  torch.Size([5608, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05685997009277344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5608, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057695865631103516  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05685997009277344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5608, 40])
pseudo mini batch 3 input nodes size: 23484
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01387929916381836  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02559804916381836  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02563953399658203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 23484
first layer output nodes number: 12427
edges number: 79931
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015074729919433594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([23484, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015074729919433594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015074729919433594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02164316177368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02164316177368164  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03349447250366211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12427, 256])
h_self size  torch.Size([12427, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03349447250366211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12427, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04534578323364258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03349447250366211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12427, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04534578323364258  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0483088493347168  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12427
----------------output nodes number: 5545
----------------edges number: 44475
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04844331741333008  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04844331741333008  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054105281829833984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054105281829833984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054931640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5545, 40])
h_self size  torch.Size([5545, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054931640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5545, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055757999420166016  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.054931640625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5545, 40])
pseudo mini batch 4 input nodes size: 25726
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013869285583496094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026136398315429688  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026179790496826172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 25726
first layer output nodes number: 12604
edges number: 76062
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015583515167236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25726, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015583515167236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.015583515167236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022208213806152344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.022208213806152344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03422832489013672  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([12604, 256])
h_self size  torch.Size([12604, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03422832489013672  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12604, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.046248435974121094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03422832489013672  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([12604, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.046248435974121094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04985332489013672  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 12604
----------------output nodes number: 5782
----------------edges number: 41672
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04999065399169922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04999065399169922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05585956573486328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05585956573486328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05672121047973633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5782, 40])
h_self size  torch.Size([5782, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05672121047973633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5782, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057582855224609375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05672121047973633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5782, 40])
pseudo mini batch 5 input nodes size: 19016
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.014454841613769531  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.023522377014160156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02356576919555664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 19016
first layer output nodes number: 10688
edges number: 58096
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01218557357788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([19016, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01218557357788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01218557357788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01775503158569336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01775503158569336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02794790267944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([10688, 256])
h_self size  torch.Size([10688, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02794790267944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10688, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03814077377319336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02794790267944336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([10688, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03814077377319336  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.040791988372802734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 10688
----------------output nodes number: 5809
----------------edges number: 36903
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04091501235961914  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04741334915161133  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04741334915161133  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0482792854309082  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5809, 40])
h_self size  torch.Size([5809, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0482792854309082  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04914522171020508  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0482792854309082  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
pseudo mini batch 6 input nodes size: 21629
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01125955581665039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02157306671142578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.021616458892822266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 21629
first layer output nodes number: 11554
edges number: 67970
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013554096221923828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([21629, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013554096221923828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.013554096221923828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02031421661376953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02031421661376953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03203296661376953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([11554, 256])
h_self size  torch.Size([11554, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03203296661376953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11554, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043051719665527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031332969665527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([11554, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.043051719665527344  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0458064079284668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 11554
----------------output nodes number: 5809
----------------edges number: 39405
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04593610763549805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04593610763549805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05245256423950195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05245256423950195  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5809, 40])
h_self size  torch.Size([5809, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0541844367980957  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05331850051879883  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5809, 40])
pseudo mini batch 7 input nodes size: 33474
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.012505531311035156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.028467178344726562  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02851104736328125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 33474
first layer output nodes number: 14218
edges number: 97924
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019611835479736328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([33474, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019611835479736328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.019611835479736328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027175426483154297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.027175426483154297  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0408473014831543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([14218, 256])
h_self size  torch.Size([14218, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0408473014831543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([14218, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0545191764831543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0408473014831543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([14218, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0545191764831543  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05808877944946289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 14218
----------------output nodes number: 5840
----------------edges number: 49687
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.058238983154296875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.058238983154296875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0648031234741211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0648031234741211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0656733512878418  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5840, 40])
h_self size  torch.Size([5840, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0656733512878418  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5840, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0665435791015625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0656733512878418  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5840, 40])
pseudo mini batch 8 input nodes size: 64764
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.018158435821533203  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04904031753540039  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.049082279205322266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 64764
first layer output nodes number: 28991
edges number: 234027
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.035927772521972656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([64764, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.035927772521972656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.035927772521972656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.051604270935058594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.051604270935058594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07925224304199219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([28991, 256])
h_self size  torch.Size([28991, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07925224304199219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28991, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10690021514892578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07925224304199219  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([28991, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10690021514892578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11381244659423828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 28991
----------------output nodes number: 5592
----------------edges number: 54730
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11407041549682617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11407041549682617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11985349655151367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11985349655151367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.12068700790405273  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5592, 40])
h_self size  torch.Size([5592, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.12068700790405273  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5592, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1215205192565918  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.12068700790405273  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5592, 40])
pseudo mini batch 9 input nodes size: 66288
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03304004669189453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06464862823486328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06469011306762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 66288
first layer output nodes number: 25648
edges number: 197055
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624725341796875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([66288, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624725341796875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03624725341796875  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05004167556762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05004167556762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07543230056762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([25648, 256])
h_self size  torch.Size([25648, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07543230056762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25648, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10082292556762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07543230056762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([25648, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10082292556762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10693788528442383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 25648
----------------output nodes number: 5519
----------------edges number: 43832
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10717058181762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10717058181762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11280298233032227  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11280298233032227  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11362552642822266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5519, 40])
h_self size  torch.Size([5519, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11362552642822266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5519, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11444807052612305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11362552642822266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5519, 40])
pseudo mini batch 10 input nodes size: 51877
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03375530242919922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05914592742919922  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0591888427734375  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 51877
first layer output nodes number: 26017
edges number: 219905
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030272960662841797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([51877, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030272960662841797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.030272960662841797  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04441547393798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04441547393798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06980609893798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([26017, 256])
h_self size  torch.Size([26017, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06980609893798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([26017, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09519672393798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06980609893798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([26017, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09519672393798828  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10139989852905273  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 26017
----------------output nodes number: 5714
----------------edges number: 68946
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10163688659667969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10163688659667969  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10764312744140625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10764312744140625  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10849475860595703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5714, 40])
h_self size  torch.Size([5714, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10849475860595703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5714, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10934638977050781  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10849475860595703  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5714, 40])
pseudo mini batch 11 input nodes size: 56967
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02756786346435547  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05473184585571289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05477333068847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 56967
first layer output nodes number: 29192
edges number: 248212
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03233909606933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([56967, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03233909606933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03233909606933594  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0482182502746582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0482182502746582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07605791091918945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([29192, 256])
h_self size  torch.Size([29192, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07605791091918945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([29192, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1038975715637207  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07605791091918945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([29192, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1038975715637207  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11085748672485352  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 29192
----------------output nodes number: 5517
----------------edges number: 67880
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11111688613891602  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11111688613891602  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11692667007446289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11692667007446289  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11774921417236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11774921417236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11857175827026367  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11774921417236328  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 12 input nodes size: 55552
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02931070327758789  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05579996109008789  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05584144592285156  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 55552
first layer output nodes number: 24238
edges number: 189899
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031029224395751953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([55552, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031029224395751953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.031029224395751953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04425382614135742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04425382614135742  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06736898422241211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([24238, 256])
h_self size  torch.Size([24238, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06736898422241211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24238, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0904841423034668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06736898422241211  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([24238, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0904841423034668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09626293182373047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 24238
----------------output nodes number: 5517
----------------edges number: 51332
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09648513793945312  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.09648513793945312  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1021718978881836  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1021718978881836  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10299444198608398  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10299444198608398  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10381698608398438  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10299444198608398  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 13 input nodes size: 42514
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02863597869873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.048908233642578125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0489501953125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 42514
first layer output nodes number: 18450
edges number: 130381
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02414083480834961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([42514, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02414083480834961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02414083480834961  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03397941589355469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03397941589355469  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05157470703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([18450, 256])
h_self size  torch.Size([18450, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05157470703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([18450, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06916999816894531  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05157470703125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([18450, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06916999816894531  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07428836822509766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 18450
----------------output nodes number: 5572
----------------edges number: 39520
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07446813583374023  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07446813583374023  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08011865615844727  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08011865615844727  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08094930648803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5572, 40])
h_self size  torch.Size([5572, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08094930648803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5572, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08177995681762695  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08094930648803711  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5572, 40])
pseudo mini batch 14 input nodes size: 31525
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02242755889892578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03805255889892578  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.038095951080322266  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 31525
first layer output nodes number: 13853
edges number: 81366
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01898813247680664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([31525, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01898813247680664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01898813247680664  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026252269744873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.026252269744873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03992414474487305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([13853, 256])
h_self size  torch.Size([13853, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03992414474487305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13853, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05359601974487305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03992414474487305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([13853, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05359601974487305  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.056899070739746094  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 13853
----------------output nodes number: 5775
----------------edges number: 34992
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057045936584472656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.057045936584472656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06356239318847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06356239318847656  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0644230842590332  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5775, 40])
h_self size  torch.Size([5775, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0644230842590332  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5775, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06528377532958984  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0644230842590332  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5775, 40])
pseudo mini batch 15 input nodes size: 34293
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01781177520751953  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0341639518737793  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03420686721801758  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 34293
first layer output nodes number: 14458
edges number: 90135
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01984691619873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([34293, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01984691619873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.01984691619873047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02746725082397461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.02746725082397461  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04125547409057617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([14458, 256])
h_self size  torch.Size([14458, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04125547409057617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([14458, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055043697357177734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.04125547409057617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([14458, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055043697357177734  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.058490753173828125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 14458
----------------output nodes number: 5739
----------------edges number: 36499
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05864143371582031  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05864143371582031  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06520271301269531  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06520271301269531  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06605815887451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5739, 40])
h_self size  torch.Size([5739, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06605815887451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5739, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06691360473632812  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06605815887451172  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5739, 40])
Average training time/epoch 0.37575864791870117
Average Training time/epoch w/o nid counting 0.3514273166656494
Number of nodes for computation during this epoch:  870704
Number of first layer input nodes during this epoch:  593220
Number of first layer output nodes during this epoch:  277484

-----------------------------------------------------------------------------epoch done
read pickle file
0.048436880111694336

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01746082305908203
global_2_local spend time (sec) 0.06732988357543945

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.242 seconds
Metis partitioning: 5.483 seconds
Split the graph: 1.072 seconds
Construct subgraphs: 0.091 seconds
5533
5520
5722
5517
5521
5608
5836
5802
5760
5799
5795
5800
5814
5847
5550
5517
REG metis partition end ----................................
the time spent:  11.120039939880371
REG construction  time spent:  3.219322919845581
pure dgl.metis_partition the time spent:  7.90071702003479
total k batches seeds list generation spend  11.29640507698059
after graph partition
graph partition algorithm spend time 11.388813972473145

partition_len_list
[27225, 31872, 27836, 26237, 20907, 23622, 14558, 13638, 12893, 10575, 13834, 11834, 10331, 11427, 13100, 12437]
REG selection method  spend 11.489103555679321
check_connections_block*********************************
time for parepare 1: 0.015604734420776367
local_output_nid generation: 0.0012483596801757812
local_in_edges_tensor generation: 0.0015826225280761719
mini_batch_src_global generation: 0.0017936229705810547

&&&&&&&&&&&&&&& before remove duplicate length: 47107
&&&&&&&&&&&&&&& after remove duplicate length: 24676

r_  generation: 0.009717941284179688

local_output_nid generation: 0.0016727447509765625
local_in_edges_tensor generation: 0.0015552043914794922
mini_batch_src_global generation: 0.0022857189178466797

&&&&&&&&&&&&&&& before remove duplicate length: 65971
&&&&&&&&&&&&&&& after remove duplicate length: 29548

r_  generation: 0.011213541030883789

local_output_nid generation: 0.0021009445190429688
local_in_edges_tensor generation: 0.0016391277313232422
mini_batch_src_global generation: 0.0016994476318359375

&&&&&&&&&&&&&&& before remove duplicate length: 73535
&&&&&&&&&&&&&&& after remove duplicate length: 26080

r_  generation: 0.011156082153320312

local_output_nid generation: 0.0021893978118896484
local_in_edges_tensor generation: 0.001470327377319336
mini_batch_src_global generation: 0.00121307373046875

&&&&&&&&&&&&&&& before remove duplicate length: 52822
&&&&&&&&&&&&&&& after remove duplicate length: 24017

r_  generation: 0.01025390625

local_output_nid generation: 0.0021657943725585938
local_in_edges_tensor generation: 0.0014755725860595703
mini_batch_src_global generation: 0.0012068748474121094

&&&&&&&&&&&&&&& before remove duplicate length: 42580
&&&&&&&&&&&&&&& after remove duplicate length: 19025

r_  generation: 0.00852656364440918

local_output_nid generation: 0.0021305084228515625
local_in_edges_tensor generation: 0.0014014244079589844
mini_batch_src_global generation: 0.0010640621185302734

&&&&&&&&&&&&&&& before remove duplicate length: 45595
&&&&&&&&&&&&&&& after remove duplicate length: 21443

r_  generation: 0.009061098098754883

local_output_nid generation: 0.0021867752075195312
local_in_edges_tensor generation: 0.001359701156616211
mini_batch_src_global generation: 0.0009469985961914062

&&&&&&&&&&&&&&& before remove duplicate length: 37147
&&&&&&&&&&&&&&& after remove duplicate length: 13491

r_  generation: 0.007473468780517578

local_output_nid generation: 0.002053976058959961
local_in_edges_tensor generation: 0.0013442039489746094
mini_batch_src_global generation: 0.0008089542388916016

&&&&&&&&&&&&&&& before remove duplicate length: 36116
&&&&&&&&&&&&&&& after remove duplicate length: 12582

r_  generation: 0.006949186325073242

local_output_nid generation: 0.0019412040710449219
local_in_edges_tensor generation: 0.0013377666473388672
mini_batch_src_global generation: 0.001055002212524414

&&&&&&&&&&&&&&& before remove duplicate length: 42486
&&&&&&&&&&&&&&& after remove duplicate length: 12091

r_  generation: 0.006880521774291992

local_output_nid generation: 0.0019958019256591797
local_in_edges_tensor generation: 0.0013446807861328125
mini_batch_src_global generation: 0.0009272098541259766

&&&&&&&&&&&&&&& before remove duplicate length: 35876
&&&&&&&&&&&&&&& after remove duplicate length: 9956

r_  generation: 0.006260871887207031

local_output_nid generation: 0.0019066333770751953
local_in_edges_tensor generation: 0.0015039443969726562
mini_batch_src_global generation: 0.0012099742889404297

&&&&&&&&&&&&&&& before remove duplicate length: 48015
&&&&&&&&&&&&&&& after remove duplicate length: 13042

r_  generation: 0.007069826126098633

local_output_nid generation: 0.0019214153289794922
local_in_edges_tensor generation: 0.0013241767883300781
mini_batch_src_global generation: 0.0010373592376708984

&&&&&&&&&&&&&&& before remove duplicate length: 39709
&&&&&&&&&&&&&&& after remove duplicate length: 11177

r_  generation: 0.006788015365600586

local_output_nid generation: 0.0020699501037597656
local_in_edges_tensor generation: 0.0026314258575439453
mini_batch_src_global generation: 0.0010426044464111328

&&&&&&&&&&&&&&& before remove duplicate length: 41839
&&&&&&&&&&&&&&& after remove duplicate length: 9787

r_  generation: 0.006200551986694336

local_output_nid generation: 0.0019876956939697266
local_in_edges_tensor generation: 0.0014350414276123047
mini_batch_src_global generation: 0.001125335693359375

&&&&&&&&&&&&&&& before remove duplicate length: 52073
&&&&&&&&&&&&&&& after remove duplicate length: 10920

r_  generation: 0.006527423858642578

local_output_nid generation: 0.0019030570983886719
local_in_edges_tensor generation: 0.0013642311096191406
mini_batch_src_global generation: 0.0011997222900390625

&&&&&&&&&&&&&&& before remove duplicate length: 45733
&&&&&&&&&&&&&&& after remove duplicate length: 12271

r_  generation: 0.006737232208251953

local_output_nid generation: 0.0018711090087890625
local_in_edges_tensor generation: 0.001299142837524414
mini_batch_src_global generation: 0.0009655952453613281

&&&&&&&&&&&&&&& before remove duplicate length: 37646
&&&&&&&&&&&&&&& after remove duplicate length: 11385

r_  generation: 0.0064084529876708984


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05008554458618164
gen group dst list time:  0.008131265640258789
check_connections_block*********************************
time for parepare 1: 0.01817607879638672
local_output_nid generation: 0.005338191986083984
local_in_edges_tensor generation: 0.01806163787841797
mini_batch_src_global generation: 0.007571697235107422

&&&&&&&&&&&&&&& before remove duplicate length: 212384
&&&&&&&&&&&&&&& after remove duplicate length: 63585

r_  generation: 0.03161120414733887

local_output_nid generation: 0.010516881942749023
local_in_edges_tensor generation: 0.010033130645751953
mini_batch_src_global generation: 0.008539438247680664

&&&&&&&&&&&&&&& before remove duplicate length: 268961
&&&&&&&&&&&&&&& after remove duplicate length: 62707

r_  generation: 0.03670358657836914

local_output_nid generation: 0.009253501892089844
local_in_edges_tensor generation: 0.008364677429199219
mini_batch_src_global generation: 0.005789518356323242

&&&&&&&&&&&&&&& before remove duplicate length: 238855
&&&&&&&&&&&&&&& after remove duplicate length: 49541

r_  generation: 0.030205965042114258

local_output_nid generation: 0.009471416473388672
local_in_edges_tensor generation: 0.005970478057861328
mini_batch_src_global generation: 0.0056269168853759766

&&&&&&&&&&&&&&& before remove duplicate length: 212265
&&&&&&&&&&&&&&& after remove duplicate length: 56035

r_  generation: 0.030919790267944336

local_output_nid generation: 0.007688760757446289
local_in_edges_tensor generation: 0.006335735321044922
mini_batch_src_global generation: 0.00495147705078125

&&&&&&&&&&&&&&& before remove duplicate length: 155350
&&&&&&&&&&&&&&& after remove duplicate length: 47217

r_  generation: 0.02653360366821289

local_output_nid generation: 0.00986790657043457
local_in_edges_tensor generation: 0.005858421325683594
mini_batch_src_global generation: 0.0051882266998291016

&&&&&&&&&&&&&&& before remove duplicate length: 179412
&&&&&&&&&&&&&&& after remove duplicate length: 54373

r_  generation: 0.029766559600830078

local_output_nid generation: 0.005418300628662109
local_in_edges_tensor generation: 0.0035109519958496094
mini_batch_src_global generation: 0.003838777542114258

&&&&&&&&&&&&&&& before remove duplicate length: 88198
&&&&&&&&&&&&&&& after remove duplicate length: 32578

r_  generation: 0.018041610717773438

local_output_nid generation: 0.005631923675537109
local_in_edges_tensor generation: 0.003258943557739258
mini_batch_src_global generation: 0.002148151397705078

&&&&&&&&&&&&&&& before remove duplicate length: 80139
&&&&&&&&&&&&&&& after remove duplicate length: 28824

r_  generation: 0.016063928604125977

local_output_nid generation: 0.0045623779296875
local_in_edges_tensor generation: 0.0029273033142089844
mini_batch_src_global generation: 0.0019505023956298828

&&&&&&&&&&&&&&& before remove duplicate length: 79507
&&&&&&&&&&&&&&& after remove duplicate length: 26899

r_  generation: 0.014993667602539062

local_output_nid generation: 0.0037322044372558594
local_in_edges_tensor generation: 0.0023937225341796875
mini_batch_src_global generation: 0.0014069080352783203

&&&&&&&&&&&&&&& before remove duplicate length: 57547
&&&&&&&&&&&&&&& after remove duplicate length: 19057

r_  generation: 0.011406898498535156

local_output_nid generation: 0.00458526611328125
local_in_edges_tensor generation: 0.0031812191009521484
mini_batch_src_global generation: 0.0021615028381347656

&&&&&&&&&&&&&&& before remove duplicate length: 93454
&&&&&&&&&&&&&&& after remove duplicate length: 31444

r_  generation: 0.016196489334106445

local_output_nid generation: 0.004106998443603516
local_in_edges_tensor generation: 0.00261688232421875
mini_batch_src_global generation: 0.0017352104187011719

&&&&&&&&&&&&&&& before remove duplicate length: 69725
&&&&&&&&&&&&&&& after remove duplicate length: 21845

r_  generation: 0.013051986694335938

local_output_nid generation: 0.0034842491149902344
local_in_edges_tensor generation: 0.0023577213287353516
mini_batch_src_global generation: 0.0015954971313476562

&&&&&&&&&&&&&&& before remove duplicate length: 61121
&&&&&&&&&&&&&&& after remove duplicate length: 18284

r_  generation: 0.010933637619018555

local_output_nid generation: 0.0037300586700439453
local_in_edges_tensor generation: 0.002424001693725586
mini_batch_src_global generation: 0.0017457008361816406

&&&&&&&&&&&&&&& before remove duplicate length: 78013
&&&&&&&&&&&&&&& after remove duplicate length: 20353

r_  generation: 0.011822700500488281

local_output_nid generation: 0.004200935363769531
local_in_edges_tensor generation: 0.0027856826782226562
mini_batch_src_global generation: 0.0020608901977539062

&&&&&&&&&&&&&&& before remove duplicate length: 89923
&&&&&&&&&&&&&&& after remove duplicate length: 23325

r_  generation: 0.014090538024902344

local_output_nid generation: 0.004258155822753906
local_in_edges_tensor generation: 0.002669095993041992
mini_batch_src_global generation: 0.0017330646514892578

&&&&&&&&&&&&&&& before remove duplicate length: 74389
&&&&&&&&&&&&&&& after remove duplicate length: 23999

r_  generation: 0.014139413833618164


connection checking time:  1.4139823913574219
block generation total time  1.247145652770996
block dataloader generation time/epoch 14.194596290588379
pseudo mini batch 0 input nodes size: 66368
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.018532276153564453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05017900466918945  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.050220489501953125  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 66368
first layer output nodes number: 27225
edges number: 212384
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03645801544189453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([66368, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03645801544189453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03645801544189453  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05181455612182617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.05181455612182617  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07777833938598633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([27225, 256])
h_self size  torch.Size([27225, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07777833938598633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27225, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10374212265014648  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.07777833938598633  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([27225, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.10374212265014648  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11023330688476562  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 27225
----------------output nodes number: 5533
----------------edges number: 47107
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11047792434692383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11047792434692383  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11614847183227539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.11614847183227539  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1169734001159668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5533, 40])
h_self size  torch.Size([5533, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1169734001159668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5533, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1177983283996582  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.1169734001159668  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5533, 40])
pseudo mini batch 1 input nodes size: 65764
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.033795833587646484  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.0651545524597168  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.06519603729248047  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

first layer input nodes number: 65764
first layer output nodes number: 31872
edges number: 268961
----------------------------------------before model layer 0
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03757429122924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([65764, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03757429122924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.03757429122924805  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.055323123931884766  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08571863174438477  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([31872, 256])
h_self size  torch.Size([31872, 128])
----------------------------------------before rst
 Nvidia-smi: 7.8221435546875 GB
    Memory Allocated: 0.08571863174438477  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([31872, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.11696863174438477  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.08657312393188477  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([31872, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.11782312393188477  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.12456750869750977  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------input nodes number: 31872
----------------output nodes number: 5520
----------------edges number: 65971
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.1248464584350586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.1248464584350586  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.1306447982788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.1306447982788086  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.13146734237670898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

h_neigh size torch.Size([5520, 40])
h_self size  torch.Size([5520, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.13146734237670898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5520, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.13228988647460938  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8846435546875 GB
    Memory Allocated: 0.13146734237670898  GigaBytes
Max Memory Allocated: 0.17988824844360352  GigaBytes

torch.Size([5520, 40])
pseudo mini batch 2 input nodes size: 52277
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03350543975830078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05889606475830078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05893898010253906  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 52277
first layer output nodes number: 27836
edges number: 238855
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030464649200439453  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([52277, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030464649200439453  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030464649200439453  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0460209846496582  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0460209846496582  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07256746292114258  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([27836, 256])
h_self size  torch.Size([27836, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07256746292114258  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([27836, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09911394119262695  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07256746292114258  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([27836, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09911394119262695  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10575056076049805  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 27836
----------------output nodes number: 5722
----------------edges number: 73535
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10600090026855469  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10600090026855469  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11285400390625  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11285400390625  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11370706558227539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5722, 40])
h_self size  torch.Size([5722, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11370706558227539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5722, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11456012725830078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11370706558227539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5722, 40])
pseudo mini batch 3 input nodes size: 58559
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027569293975830078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.055492401123046875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05553388595581055  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 58559
first layer output nodes number: 26237
edges number: 212265
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([58559, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.032708168029785156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046898841857910156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046898841857910156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07228946685791016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([26237, 256])
h_self size  torch.Size([26237, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07228946685791016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([26237, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09768009185791016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07228946685791016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([26237, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09768009185791016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10393571853637695  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 26237
----------------output nodes number: 5517
----------------edges number: 52822
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.1041727066040039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.1041727066040039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10986995697021484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10986995697021484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11069250106811523  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11069250106811523  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11151504516601562  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.11069250106811523  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5517, 40])
pseudo mini batch 4 input nodes size: 49255
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030069828033447266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05355644226074219  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05359792709350586  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 49255
first layer output nodes number: 20907
edges number: 155350
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027631759643554688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([49255, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027631759643554688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027631759643554688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03883695602416992  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03883695602416992  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05877542495727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([20907, 256])
h_self size  torch.Size([20907, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05877542495727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([20907, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07871389389038086  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05877542495727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([20907, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.07871389389038086  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.08416604995727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 20907
----------------output nodes number: 5521
----------------edges number: 42580
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.08436346054077148  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.08436346054077148  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09017515182495117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09017515182495117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09099817276000977  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5521, 40])
h_self size  torch.Size([5521, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09099817276000977  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5521, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09182119369506836  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09099817276000977  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5521, 40])
pseudo mini batch 5 input nodes size: 56474
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.025633811950683594  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.052562713623046875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05260467529296875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 56474
first layer output nodes number: 23622
edges number: 179412
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.031351566314697266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([56474, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.031351566314697266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.031351566314697266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.044495582580566406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.044495582580566406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06702327728271484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([23622, 256])
h_self size  torch.Size([23622, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06702327728271484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([23622, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.08955097198486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06702327728271484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([23622, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.08955097198486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09518289566040039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 23622
----------------output nodes number: 5608
----------------edges number: 45595
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09540128707885742  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.09540128707885742  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10113191604614258  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10113191604614258  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10196781158447266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5608, 40])
h_self size  torch.Size([5608, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10196781158447266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5608, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10280370712280273  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.10196781158447266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5608, 40])
pseudo mini batch 6 input nodes size: 33604
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02908945083618164  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04511308670043945  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04515695571899414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 33604
first layer output nodes number: 14558
edges number: 88198
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.019481182098388672  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([33604, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.019481182098388672  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.019481182098388672  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027135372161865234  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027135372161865234  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04101896286010742  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([14558, 256])
h_self size  torch.Size([14558, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04101896286010742  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([14558, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05490255355834961  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04101896286010742  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([14558, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05490255355834961  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0584101676940918  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 14558
----------------output nodes number: 5836
----------------edges number: 37147
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0585627555847168  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0585627555847168  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06503725051879883  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06503725051879883  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06590700149536133  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5836, 40])
h_self size  torch.Size([5836, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06590700149536133  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5836, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06677675247192383  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06590700149536133  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5836, 40])
pseudo mini batch 7 input nodes size: 29729
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.018219947814941406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03239583969116211  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.032439231872558594  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 29729
first layer output nodes number: 13638
edges number: 80139
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017563343048095703  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([29729, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017563343048095703  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017563343048095703  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.024715423583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.024715423583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.038387298583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([13638, 256])
h_self size  torch.Size([13638, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.038387298583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13638, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.052059173583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.038387298583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13638, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.052059173583984375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.055310726165771484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 13638
----------------output nodes number: 5802
----------------edges number: 36116
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05545616149902344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05545616149902344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06195545196533203  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06195545196533203  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0628204345703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5802, 40])
h_self size  torch.Size([5802, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0628204345703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5802, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06368541717529297  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0628204345703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5802, 40])
pseudo mini batch 8 input nodes size: 27534
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.016366958618164062  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030038833618164062  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.030081748962402344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 27534
first layer output nodes number: 12893
edges number: 79507
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017074108123779297  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([27534, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017074108123779297  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.017074108123779297  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02386331558227539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02386331558227539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03615903854370117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([12893, 256])
h_self size  torch.Size([12893, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03615903854370117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([12893, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04845476150512695  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03615903854370117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([12893, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04845476150512695  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05178403854370117  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 12893
----------------output nodes number: 5760
----------------edges number: 42486
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.051923274993896484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.051923274993896484  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.057776451110839844  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.057776451110839844  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05863475799560547  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5760, 40])
h_self size  torch.Size([5760, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05863475799560547  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5760, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.059493064880371094  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05863475799560547  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5760, 40])
pseudo mini batch 9 input nodes size: 19502
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015855789184570312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.025155067443847656  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02519845962524414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 19502
first layer output nodes number: 10575
edges number: 57547
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0124053955078125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([19502, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0124053955078125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0124053955078125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01791667938232422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01791667938232422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.028001785278320312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([10575, 256])
h_self size  torch.Size([10575, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.028001785278320312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([10575, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.038086891174316406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.028001785278320312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([10575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.038086891174316406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04060840606689453  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 10575
----------------output nodes number: 5799
----------------edges number: 35876
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.040730953216552734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.040730953216552734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.047231197357177734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.047231197357177734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.048095703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5799, 40])
h_self size  torch.Size([5799, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.048095703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5799, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.048960208892822266  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.048095703125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5799, 40])
pseudo mini batch 10 input nodes size: 32511
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0114898681640625  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0271148681640625  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.027158260345458984  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 32511
first layer output nodes number: 13834
edges number: 93454
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01921701431274414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([32511, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01921701431274414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01921701431274414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02656269073486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02656269073486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04023456573486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([13834, 256])
h_self size  torch.Size([13834, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04023456573486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13834, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05390644073486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04023456573486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13834, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05390644073486328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0572047233581543  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 13834
----------------output nodes number: 5795
----------------edges number: 48015
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05735158920288086  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05735158920288086  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06394624710083008  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06394624710083008  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06480979919433594  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5795, 40])
h_self size  torch.Size([5795, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06480979919433594  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5795, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0656733512878418  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.06480979919433594  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5795, 40])
pseudo mini batch 11 input nodes size: 22318
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01781463623046875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.028456687927246094  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.028500080108642578  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 22318
first layer output nodes number: 11834
edges number: 69725
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013902664184570312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([22318, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013902664184570312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013902664184570312  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.020542621612548828  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.020542621612548828  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03226137161254883  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([11834, 256])
h_self size  torch.Size([11834, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03226137161254883  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([11834, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04354715347290039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03182840347290039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([11834, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04354715347290039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04636859893798828  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 11834
----------------output nodes number: 5800
----------------edges number: 39709
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046500205993652344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046500205993652344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.053028106689453125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.053028106689453125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05389261245727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5800, 40])
h_self size  torch.Size([5800, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05389261245727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5800, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.054757118225097656  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05389261245727539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5800, 40])
pseudo mini batch 12 input nodes size: 18690
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0128326416015625  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.021744728088378906  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02178812026977539  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 18690
first layer output nodes number: 10331
edges number: 61121
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.012087345123291016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([18690, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.012087345123291016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.012087345123291016  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01750802993774414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01750802993774414  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02736043930053711  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([10331, 256])
h_self size  torch.Size([10331, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02736043930053711  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([10331, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03721284866333008  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02736043930053711  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([10331, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03721284866333008  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04001951217651367  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 10331
----------------output nodes number: 5814
----------------edges number: 41839
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04014015197753906  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04014015197753906  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046669960021972656  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.046669960021972656  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.047536373138427734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5814, 40])
h_self size  torch.Size([5814, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.047536373138427734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5814, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04840278625488281  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.047536373138427734  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5814, 40])
pseudo mini batch 13 input nodes size: 20923
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.011104583740234375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02108144760131836  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.021125316619873047  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 20923
first layer output nodes number: 11427
edges number: 78013
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013381004333496094  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([20923, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013381004333496094  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.013381004333496094  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.020275592803955078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.020275592803955078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03199434280395508  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([11427, 256])
h_self size  torch.Size([11427, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03199434280395508  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([11427, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0428919792175293  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.031173229217529297  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([11427, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0428919792175293  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04566621780395508  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 11427
----------------output nodes number: 5847
----------------edges number: 52073
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.045795440673828125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.045795440673828125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05237007141113281  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05237007141113281  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.053241729736328125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5847, 40])
h_self size  torch.Size([5847, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.053241729736328125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5847, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05411338806152344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.053241729736328125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5847, 40])
pseudo mini batch 14 input nodes size: 23993
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.01217508316040039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02389383316040039  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.023935317993164062  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 23993
first layer output nodes number: 13100
edges number: 89923
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015202999114990234  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([23993, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015202999114990234  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015202999114990234  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.022169113159179688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.022169113159179688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03466224670410156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([13100, 256])
h_self size  torch.Size([13100, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03466224670410156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13100, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04715538024902344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03466224670410156  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([13100, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04715538024902344  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.050278663635253906  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 13100
----------------output nodes number: 5550
----------------edges number: 45733
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05041790008544922  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05041790008544922  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05609416961669922  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05609416961669922  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05692148208618164  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5550, 40])
h_self size  torch.Size([5550, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05692148208618164  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5550, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05774879455566406  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05692148208618164  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5550, 40])
pseudo mini batch 15 input nodes size: 24666
----------------------------------------before batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0138702392578125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.02563190460205078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.025673389434814453  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

first layer input nodes number: 24666
first layer output nodes number: 12437
edges number: 74389
----------------------------------------before model layer 0
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([24666, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.015026569366455078  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.021558761596679688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.021558761596679688  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03341960906982422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([12437, 256])
h_self size  torch.Size([12437, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03341960906982422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([12437, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.03341960906982422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([12437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04528045654296875  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.04904460906982422  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------input nodes number: 12437
----------------output nodes number: 5517
----------------edges number: 37646
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0491790771484375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0491790771484375  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0547637939453125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.0547637939453125  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05558633804321289  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

h_neigh size torch.Size([5517, 40])
h_self size  torch.Size([5517, 256])
----------------------------------------before rst
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05558633804321289  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5517, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05640888214111328  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9178466796875 GB
    Memory Allocated: 0.05558633804321289  GigaBytes
Max Memory Allocated: 0.18846893310546875  GigaBytes

torch.Size([5517, 40])
Average training time/epoch 0.3716588815053304
Average Training time/epoch w/o nid counting 0.36212897300720215
Number of nodes for computation during this epoch:  884493
Number of first layer input nodes during this epoch:  602167
Number of first layer output nodes during this epoch:  282326

-----------------------------------------------------------------------------epoch done
