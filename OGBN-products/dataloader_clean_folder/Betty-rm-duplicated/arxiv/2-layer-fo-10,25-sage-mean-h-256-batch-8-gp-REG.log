main start at this time 1660939752.4345086
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.036101341247558594
global_2_local spend time (sec) 0.034351348876953125

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.231 seconds
Metis partitioning: 5.063 seconds
Split the graph: 1.862 seconds
Construct subgraphs: 0.052 seconds
11553
11538
11526
11321
11321
11124
11035
11523
REG metis partition end ----................................
the time spent:  11.233288526535034
REG construction  time spent:  3.01263427734375
pure dgl.metis_partition the time spent:  8.220654249191284
total k batches seeds list generation spend  11.401478052139282
after graph partition
graph partition algorithm spend time 11.50197172164917

partition_len_list
[20365, 21274, 21259, 20664, 27248, 32491, 46898, 42113]
REG selection method  spend 11.561922550201416
check_connections_block*********************************
time for parepare 1: 0.014183521270751953
local_output_nid generation: 0.0019559860229492188
local_in_edges_tensor generation: 0.002341032028198242
mini_batch_src_global generation: 0.0025811195373535156

&&&&&&&&&&&&&&& before remove duplicate length: 72670
&&&&&&&&&&&&&&& after remove duplicate length: 19226

r_  generation: 0.01688694953918457

local_output_nid generation: 0.003452301025390625
local_in_edges_tensor generation: 0.0026929378509521484
mini_batch_src_global generation: 0.003965854644775391

&&&&&&&&&&&&&&& before remove duplicate length: 83042
&&&&&&&&&&&&&&& after remove duplicate length: 20162

r_  generation: 0.011859893798828125

local_output_nid generation: 0.002413034439086914
local_in_edges_tensor generation: 0.0027353763580322266
mini_batch_src_global generation: 0.0023682117462158203

&&&&&&&&&&&&&&& before remove duplicate length: 88400
&&&&&&&&&&&&&&& after remove duplicate length: 20124

r_  generation: 0.011928558349609375

local_output_nid generation: 0.0024712085723876953
local_in_edges_tensor generation: 0.0025055408477783203
mini_batch_src_global generation: 0.002487659454345703

&&&&&&&&&&&&&&& before remove duplicate length: 92173
&&&&&&&&&&&&&&& after remove duplicate length: 19485

r_  generation: 0.013584613800048828

local_output_nid generation: 0.002635955810546875
local_in_edges_tensor generation: 0.0022199153900146484
mini_batch_src_global generation: 0.0019402503967285156

&&&&&&&&&&&&&&& before remove duplicate length: 77176
&&&&&&&&&&&&&&& after remove duplicate length: 25159

r_  generation: 0.013536930084228516

local_output_nid generation: 0.0025207996368408203
local_in_edges_tensor generation: 0.0025517940521240234
mini_batch_src_global generation: 0.001987457275390625

&&&&&&&&&&&&&&& before remove duplicate length: 78683
&&&&&&&&&&&&&&& after remove duplicate length: 29863

r_  generation: 0.01463627815246582

local_output_nid generation: 0.0025942325592041016
local_in_edges_tensor generation: 0.003229856491088867
mini_batch_src_global generation: 0.0032095909118652344

&&&&&&&&&&&&&&& before remove duplicate length: 109746
&&&&&&&&&&&&&&& after remove duplicate length: 43191

r_  generation: 0.017263412475585938

local_output_nid generation: 0.0027840137481689453
local_in_edges_tensor generation: 0.003993988037109375
mini_batch_src_global generation: 0.005518436431884766

&&&&&&&&&&&&&&& before remove duplicate length: 142360
&&&&&&&&&&&&&&& after remove duplicate length: 39553

r_  generation: 0.017416954040527344


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04531264305114746
gen group dst list time:  0.006445169448852539
check_connections_block*********************************
time for parepare 1: 0.020600080490112305
local_output_nid generation: 0.0034437179565429688
local_in_edges_tensor generation: 0.02556896209716797
mini_batch_src_global generation: 0.0037124156951904297

&&&&&&&&&&&&&&& before remove duplicate length: 110195
&&&&&&&&&&&&&&& after remove duplicate length: 33235

r_  generation: 0.019327163696289062

local_output_nid generation: 0.005509138107299805
local_in_edges_tensor generation: 0.0043621063232421875
mini_batch_src_global generation: 0.0044858455657958984

&&&&&&&&&&&&&&& before remove duplicate length: 123442
&&&&&&&&&&&&&&& after remove duplicate length: 34851

r_  generation: 0.020444869995117188

local_output_nid generation: 0.005593538284301758
local_in_edges_tensor generation: 0.004678249359130859
mini_batch_src_global generation: 0.003238201141357422

&&&&&&&&&&&&&&& before remove duplicate length: 132255
&&&&&&&&&&&&&&& after remove duplicate length: 37159

r_  generation: 0.021458864212036133

local_output_nid generation: 0.005348920822143555
local_in_edges_tensor generation: 0.0040531158447265625
mini_batch_src_global generation: 0.002999544143676758

&&&&&&&&&&&&&&& before remove duplicate length: 127893
&&&&&&&&&&&&&&& after remove duplicate length: 31358

r_  generation: 0.019794702529907227

local_output_nid generation: 0.007018327713012695
local_in_edges_tensor generation: 0.005462169647216797
mini_batch_src_global generation: 0.004639863967895508

&&&&&&&&&&&&&&& before remove duplicate length: 170297
&&&&&&&&&&&&&&& after remove duplicate length: 55074

r_  generation: 0.030079126358032227

local_output_nid generation: 0.008265972137451172
local_in_edges_tensor generation: 0.007532835006713867
mini_batch_src_global generation: 0.007233858108520508

&&&&&&&&&&&&&&& before remove duplicate length: 224681
&&&&&&&&&&&&&&& after remove duplicate length: 61782

r_  generation: 0.034818172454833984

local_output_nid generation: 0.011615514755249023
local_in_edges_tensor generation: 0.012204647064208984
mini_batch_src_global generation: 0.01153421401977539

&&&&&&&&&&&&&&& before remove duplicate length: 367193
&&&&&&&&&&&&&&& after remove duplicate length: 81012

r_  generation: 0.04924607276916504

local_output_nid generation: 0.009674310684204102
local_in_edges_tensor generation: 0.008965730667114258
mini_batch_src_global generation: 0.010077714920043945

&&&&&&&&&&&&&&& before remove duplicate length: 345889
&&&&&&&&&&&&&&& after remove duplicate length: 63941

r_  generation: 0.04180264472961426


connection checking time:  1.1665642261505127
block generation total time  1.0413997173309326
pseudo mini batch 0 input nodes size: 34096
----------------------------------------before batch input features to device
 Nvidia-smi: 7.0780029296875 GB
    Memory Allocated: 0.0003204345703125  GigaBytes
Max Memory Allocated: 0.0003204345703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.01657867431640625  GigaBytes
Max Memory Allocated: 0.01657867431640625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0955810546875 GB
    Memory Allocated: 0.016664981842041016  GigaBytes
Max Memory Allocated: 0.016664981842041016  GigaBytes

first layer input nodes number: 34096
first layer output nodes number: 20365
edges number: 110195
----------------------------------------before model layer 0
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.01843404769897461  GigaBytes
Max Memory Allocated: 0.0188446044921875  GigaBytes

torch.Size([34096, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.01843404769897461  GigaBytes
Max Memory Allocated: 0.0188446044921875  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.1619873046875 GB
    Memory Allocated: 0.01843404769897461  GigaBytes
Max Memory Allocated: 0.0188446044921875  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 0.02915191650390625  GigaBytes
Max Memory Allocated: 0.03893899917602539  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 0.02915191650390625  GigaBytes
Max Memory Allocated: 0.03893899917602539  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04868316650390625  GigaBytes
Max Memory Allocated: 0.04868316650390625  GigaBytes

h_neigh size torch.Size([20365, 256])
h_self size  torch.Size([20365, 128])
----------------------------------------before rst
 Nvidia-smi: 7.3729248046875 GB
    Memory Allocated: 0.04868316650390625  GigaBytes
Max Memory Allocated: 0.04868316650390625  GigaBytes

torch.Size([20365, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.06821441650390625  GigaBytes
Max Memory Allocated: 0.08774566650390625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.04868316650390625  GigaBytes
Max Memory Allocated: 0.08774566650390625  GigaBytes

torch.Size([20365, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.06821441650390625  GigaBytes
Max Memory Allocated: 0.08774566650390625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.07307004928588867  GigaBytes
Max Memory Allocated: 0.09260129928588867  GigaBytes

----------------input nodes number: 20365
----------------output nodes number: 11553
----------------edges number: 72670
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.07330846786499023  GigaBytes
Max Memory Allocated: 0.09260129928588867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4119873046875 GB
    Memory Allocated: 0.07330846786499023  GigaBytes
Max Memory Allocated: 0.09260129928588867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08565568923950195  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08565568923950195  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08737754821777344  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

h_neigh size torch.Size([11553, 40])
h_self size  torch.Size([11553, 256])
----------------------------------------before rst
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08737754821777344  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

torch.Size([11553, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08909940719604492  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.4256591796875 GB
    Memory Allocated: 0.08737754821777344  GigaBytes
Max Memory Allocated: 0.09667348861694336  GigaBytes

torch.Size([11553, 40])
pseudo mini batch 1 input nodes size: 35743
----------------------------------------before batch input features to device
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.018708229064941406  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.0357518196105957  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.03583812713623047  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

first layer input nodes number: 35743
first layer output nodes number: 21274
edges number: 123442
----------------------------------------before model layer 0
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.021458148956298828  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

torch.Size([35743, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.021458148956298828  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.021458148956298828  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.03260231018066406  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.03260231018066406  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 0.052890777587890625  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

h_neigh size torch.Size([21274, 256])
h_self size  torch.Size([21274, 128])
----------------------------------------before rst
 Nvidia-smi: 7.4901123046875 GB
    Memory Allocated: 0.052890777587890625  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

torch.Size([21274, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.07317924499511719  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.052890777587890625  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

torch.Size([21274, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.07317924499511719  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.07825136184692383  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------input nodes number: 21274
----------------output nodes number: 11538
----------------edges number: 83042
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.07849645614624023  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.07849645614624023  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09020566940307617  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09020566940307617  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09269332885742188  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

h_neigh size torch.Size([11538, 40])
h_self size  torch.Size([11538, 256])
----------------------------------------before rst
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09269332885742188  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

torch.Size([11538, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09441280364990234  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5330810546875 GB
    Memory Allocated: 0.09192514419555664  GigaBytes
Max Memory Allocated: 0.11537361145019531  GigaBytes

torch.Size([11538, 40])
pseudo mini batch 2 input nodes size: 38345
----------------------------------------before batch input features to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.020259380340576172  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.038543701171875  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.038630008697509766  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

first layer input nodes number: 38345
first layer output nodes number: 21259
edges number: 132255
----------------------------------------before model layer 0
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.023590087890625  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

torch.Size([38345, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.023590087890625  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.023590087890625  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.03479290008544922  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.03479290008544922  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.05506706237792969  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

h_neigh size torch.Size([21259, 256])
h_self size  torch.Size([21259, 128])
----------------------------------------before rst
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.05506706237792969  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

torch.Size([21259, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07534122467041016  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.05506706237792969  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

torch.Size([21259, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07534122467041016  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08041000366210938  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------input nodes number: 21259
----------------output nodes number: 11526
----------------edges number: 88400
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08065509796142578  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08065509796142578  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.0923929214477539  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.0923929214477539  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.09423065185546875  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

h_neigh size torch.Size([11526, 40])
h_self size  torch.Size([11526, 256])
----------------------------------------before rst
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.09423065185546875  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

torch.Size([11526, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.0959482192993164  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.09411048889160156  GigaBytes
Max Memory Allocated: 0.1212005615234375  GigaBytes

torch.Size([11526, 40])
pseudo mini batch 3 input nodes size: 32393
----------------------------------------before batch input features to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.020730018615722656  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.036176204681396484  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.03626060485839844  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

first layer input nodes number: 32393
first layer output nodes number: 20664
edges number: 127893
----------------------------------------before model layer 0
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.019927024841308594  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([32393, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.019927024841308594  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.019927024841308594  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.030811309814453125  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.030811309814453125  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

h_neigh size torch.Size([20664, 256])
h_self size  torch.Size([20664, 128])
----------------------------------------before rst
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([20664, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07022476196289062  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.050518035888671875  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([20664, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07022476196289062  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07515144348144531  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------input nodes number: 20664
----------------output nodes number: 11321
----------------edges number: 92173
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07538986206054688  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.07538986206054688  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.0869588851928711  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.0869588851928711  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08873653411865234  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

h_neigh size torch.Size([11321, 40])
h_self size  torch.Size([11321, 256])
----------------------------------------before rst
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08873653411865234  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([11321, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.09060192108154297  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.08882427215576172  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([11321, 40])
pseudo mini batch 4 input nodes size: 56805
----------------------------------------before batch input features to device
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 0.017950057983398438  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 0.04529380798339844  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 0.04537820816040039  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

first layer input nodes number: 56805
first layer output nodes number: 27248
edges number: 170297
----------------------------------------before model layer 0
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 0.0323185920715332  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([56805, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 0.0323185920715332  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 0.0323185920715332  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04668235778808594  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.5858154296875 GB
    Memory Allocated: 0.04668235778808594  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6131591796875 GB
    Memory Allocated: 0.07266807556152344  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

h_neigh size torch.Size([27248, 256])
h_self size  torch.Size([27248, 128])
----------------------------------------before rst
 Nvidia-smi: 7.6131591796875 GB
    Memory Allocated: 0.07266807556152344  GigaBytes
Max Memory Allocated: 0.12187480926513672  GigaBytes

torch.Size([27248, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.09865379333496094  GigaBytes
Max Memory Allocated: 0.12463951110839844  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.07266807556152344  GigaBytes
Max Memory Allocated: 0.12463951110839844  GigaBytes

torch.Size([27248, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.09865379333496094  GigaBytes
Max Memory Allocated: 0.12463951110839844  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.10519218444824219  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------input nodes number: 27248
----------------output nodes number: 11321
----------------edges number: 77176
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.10547971725463867  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.10547971725463867  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.11693620681762695  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.11693620681762695  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.11862325668334961  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

h_neigh size torch.Size([11321, 40])
h_self size  torch.Size([11321, 256])
----------------------------------------before rst
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.11862325668334961  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

torch.Size([11321, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.12031030654907227  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 0.11862325668334961  GigaBytes
Max Memory Allocated: 0.1311779022216797  GigaBytes

torch.Size([11321, 40])
pseudo mini batch 5 input nodes size: 64595
----------------------------------------before batch input features to device
 Nvidia-smi: 7.7030029296875 GB
    Memory Allocated: 0.029790401458740234  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.7342529296875 GB
    Memory Allocated: 0.061040401458740234  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.7342529296875 GB
    Memory Allocated: 0.06112337112426758  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

first layer input nodes number: 64595
first layer output nodes number: 32491
edges number: 224681
----------------------------------------before model layer 0
 Nvidia-smi: 7.7342529296875 GB
    Memory Allocated: 0.03668022155761719  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

torch.Size([64595, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.7342529296875 GB
    Memory Allocated: 0.03668022155761719  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.7342529296875 GB
    Memory Allocated: 0.03668022155761719  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.7362060546875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.7362060546875 GB
    Memory Allocated: 0.05396890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 0.08521890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

h_neigh size torch.Size([32491, 256])
h_self size  torch.Size([32491, 128])
----------------------------------------before rst
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 0.08521890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

torch.Size([32491, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.11646890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.08521890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

torch.Size([32491, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.11646890640258789  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.12421560287475586  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------input nodes number: 32491
----------------output nodes number: 11124
----------------edges number: 78683
----------------------------------------before mean aggregator
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.12454080581665039  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.12454080581665039  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.1358189582824707  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.1358189582824707  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.13747692108154297  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

h_neigh size torch.Size([11124, 40])
h_self size  torch.Size([11124, 256])
----------------------------------------before rst
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.13747692108154297  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

torch.Size([11124, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.13913488388061523  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8299560546875 GB
    Memory Allocated: 0.13747692108154297  GigaBytes
Max Memory Allocated: 0.15868854522705078  GigaBytes

torch.Size([11124, 40])
pseudo mini batch 6 input nodes size: 84796
----------------------------------------before batch input features to device
 Nvidia-smi: 7.8651123046875 GB
    Memory Allocated: 0.03435516357421875  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 0.07537078857421875  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 0.07545328140258789  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

first layer input nodes number: 84796
first layer output nodes number: 46898
edges number: 367193
----------------------------------------before model layer 0
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 0.04865598678588867  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

torch.Size([84796, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 0.04865598678588867  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 7.9061279296875 GB
    Memory Allocated: 0.04865598678588867  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 7.9139404296875 GB
    Memory Allocated: 0.0739297866821289  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 7.9139404296875 GB
    Memory Allocated: 0.0739297866821289  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.1188516616821289  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

h_neigh size torch.Size([46898, 256])
h_self size  torch.Size([46898, 128])
----------------------------------------before rst
 Nvidia-smi: 7.9588623046875 GB
    Memory Allocated: 0.1188516616821289  GigaBytes
Max Memory Allocated: 0.18903684616088867  GigaBytes

torch.Size([46898, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1637735366821289  GigaBytes
Max Memory Allocated: 0.2086954116821289  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1188516616821289  GigaBytes
Max Memory Allocated: 0.2086954116821289  GigaBytes

torch.Size([46898, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1637735366821289  GigaBytes
Max Memory Allocated: 0.2086954116821289  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.17495489120483398  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------input nodes number: 46898
----------------output nodes number: 11035
----------------edges number: 109746
----------------------------------------before mean aggregator
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.17538690567016602  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.17538690567016602  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1868119239807129  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1868119239807129  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1890568733215332  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

h_neigh size torch.Size([11035, 40])
h_self size  torch.Size([11035, 256])
----------------------------------------before rst
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.1890568733215332  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

torch.Size([11035, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.19070148468017578  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0487060546875 GB
    Memory Allocated: 0.18845653533935547  GigaBytes
Max Memory Allocated: 0.21987676620483398  GigaBytes

torch.Size([11035, 40])
pseudo mini batch 7 input nodes size: 67769
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.043384552001953125  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0756993293762207  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07578563690185547  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

first layer input nodes number: 67769
first layer output nodes number: 42113
edges number: 345889
----------------------------------------before model layer 0
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03990459442138672  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([67769, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03990459442138672  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03990459442138672  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0628352165222168  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0628352165222168  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1038508415222168  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([42113, 256])
h_self size  torch.Size([42113, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1038508415222168  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([42113, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1440129280090332  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1029973030090332  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([42113, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1440129280090332  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.15358924865722656  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------input nodes number: 42113
----------------output nodes number: 11523
----------------edges number: 142360
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1539897918701172  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1539897918701172  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16612720489501953  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16612720489501953  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16784429550170898  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([11523, 40])
h_self size  torch.Size([11523, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16784429550170898  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11523, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16956138610839844  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16784429550170898  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11523, 40])
Number of nodes for computation during this epoch:  646854
Number of first layer input nodes during this epoch:  414542
Number of first layer output nodes during this epoch:  232312

-----------------------------------------------------------------------------epoch done
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026402711868286133
global_2_local spend time (sec) 0.04382443428039551

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.230 seconds
Metis partitioning: 5.222 seconds
Split the graph: 2.206 seconds
Construct subgraphs: 0.047 seconds
11196
11132
11351
11035
11551
11596
11539
11541
REG metis partition end ----................................
the time spent:  11.749055624008179
REG construction  time spent:  3.0311191082000732
pure dgl.metis_partition the time spent:  8.717936515808105
total k batches seeds list generation spend  11.936649560928345
after graph partition
graph partition algorithm spend time 12.06057357788086

partition_len_list
[27426, 30427, 41028, 46285, 21109, 20905, 20777, 20573]
REG selection method  spend 12.135878324508667
check_connections_block*********************************
time for parepare 1: 0.015341997146606445
local_output_nid generation: 0.002134084701538086
local_in_edges_tensor generation: 0.002748250961303711
mini_batch_src_global generation: 0.006899595260620117

&&&&&&&&&&&&&&& before remove duplicate length: 75661
&&&&&&&&&&&&&&& after remove duplicate length: 25400

r_  generation: 0.013194799423217773

local_output_nid generation: 0.002657651901245117
local_in_edges_tensor generation: 0.002013683319091797
mini_batch_src_global generation: 0.0021486282348632812

&&&&&&&&&&&&&&& before remove duplicate length: 73234
&&&&&&&&&&&&&&& after remove duplicate length: 27937

r_  generation: 0.013864755630493164

local_output_nid generation: 0.0028226375579833984
local_in_edges_tensor generation: 0.003033161163330078
mini_batch_src_global generation: 0.004036664962768555

&&&&&&&&&&&&&&& before remove duplicate length: 138207
&&&&&&&&&&&&&&& after remove duplicate length: 38505

r_  generation: 0.01647806167602539

local_output_nid generation: 0.0030062198638916016
local_in_edges_tensor generation: 0.002323150634765625
mini_batch_src_global generation: 0.0026998519897460938

&&&&&&&&&&&&&&& before remove duplicate length: 117198
&&&&&&&&&&&&&&& after remove duplicate length: 42824

r_  generation: 0.018557310104370117

local_output_nid generation: 0.003246307373046875
local_in_edges_tensor generation: 0.002405881881713867
mini_batch_src_global generation: 0.001978635787963867

&&&&&&&&&&&&&&& before remove duplicate length: 75464
&&&&&&&&&&&&&&& after remove duplicate length: 19875

r_  generation: 0.013227462768554688

local_output_nid generation: 0.0029611587524414062
local_in_edges_tensor generation: 0.002175569534301758
mini_batch_src_global generation: 0.0035479068756103516

&&&&&&&&&&&&&&& before remove duplicate length: 78064
&&&&&&&&&&&&&&& after remove duplicate length: 19799

r_  generation: 0.017547130584716797

local_output_nid generation: 0.0038704872131347656
local_in_edges_tensor generation: 0.002313852310180664
mini_batch_src_global generation: 0.003094911575317383

&&&&&&&&&&&&&&& before remove duplicate length: 89970
&&&&&&&&&&&&&&& after remove duplicate length: 19793

r_  generation: 0.012514829635620117

local_output_nid generation: 0.0028829574584960938
local_in_edges_tensor generation: 0.002138853073120117
mini_batch_src_global generation: 0.002797842025756836

&&&&&&&&&&&&&&& before remove duplicate length: 96452
&&&&&&&&&&&&&&& after remove duplicate length: 19491

r_  generation: 0.011877775192260742


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05010986328125
gen group dst list time:  0.007313251495361328
check_connections_block*********************************
time for parepare 1: 0.02209782600402832
local_output_nid generation: 0.007396697998046875
local_in_edges_tensor generation: 0.015404701232910156
mini_batch_src_global generation: 0.007551908493041992

&&&&&&&&&&&&&&& before remove duplicate length: 171656
&&&&&&&&&&&&&&& after remove duplicate length: 54846

r_  generation: 0.02866983413696289

local_output_nid generation: 0.009894609451293945
local_in_edges_tensor generation: 0.008011102676391602
mini_batch_src_global generation: 0.010934591293334961

&&&&&&&&&&&&&&& before remove duplicate length: 201622
&&&&&&&&&&&&&&& after remove duplicate length: 60598

r_  generation: 0.03271746635437012

local_output_nid generation: 0.012185096740722656
local_in_edges_tensor generation: 0.011318445205688477
mini_batch_src_global generation: 0.009591341018676758

&&&&&&&&&&&&&&& before remove duplicate length: 335170
&&&&&&&&&&&&&&& after remove duplicate length: 63117

r_  generation: 0.04057621955871582

local_output_nid generation: 0.013679265975952148
local_in_edges_tensor generation: 0.012787342071533203
mini_batch_src_global generation: 0.010732889175415039

&&&&&&&&&&&&&&& before remove duplicate length: 367151
&&&&&&&&&&&&&&& after remove duplicate length: 76931

r_  generation: 0.04755997657775879

local_output_nid generation: 0.007361173629760742
local_in_edges_tensor generation: 0.006365776062011719
mini_batch_src_global generation: 0.004214048385620117

&&&&&&&&&&&&&&& before remove duplicate length: 117459
&&&&&&&&&&&&&&& after remove duplicate length: 35992

r_  generation: 0.022809267044067383

local_output_nid generation: 0.006579160690307617
local_in_edges_tensor generation: 0.004265546798706055
mini_batch_src_global generation: 0.0032329559326171875

&&&&&&&&&&&&&&& before remove duplicate length: 117969
&&&&&&&&&&&&&&& after remove duplicate length: 33988

r_  generation: 0.02048349380493164

local_output_nid generation: 0.006581306457519531
local_in_edges_tensor generation: 0.004246950149536133
mini_batch_src_global generation: 0.0034880638122558594

&&&&&&&&&&&&&&& before remove duplicate length: 131993
&&&&&&&&&&&&&&& after remove duplicate length: 36935

r_  generation: 0.020856142044067383

local_output_nid generation: 0.0060656070709228516
local_in_edges_tensor generation: 0.004012346267700195
mini_batch_src_global generation: 0.003462076187133789

&&&&&&&&&&&&&&& before remove duplicate length: 129052
&&&&&&&&&&&&&&& after remove duplicate length: 30893

r_  generation: 0.019448518753051758


connection checking time:  1.2314774990081787
block generation total time  1.0640044212341309
pseudo mini batch 0 input nodes size: 56638
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0353999137878418  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0627436637878418  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.06282711029052734  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

first layer input nodes number: 56638
first layer output nodes number: 27426
edges number: 171656
----------------------------------------before model layer 0
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.032896995544433594  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([56638, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.032896995544433594  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.032896995544433594  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.04735708236694336  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.04735708236694336  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07351255416870117  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([27426, 256])
h_self size  torch.Size([27426, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07351255416870117  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([27426, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.09966802597045898  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07351255416870117  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([27426, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.09966802597045898  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10620689392089844  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------input nodes number: 27426
----------------output nodes number: 11196
----------------edges number: 75661
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10649490356445312  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10649490356445312  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11782073974609375  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11782073974609375  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11948919296264648  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([11196, 40])
h_self size  torch.Size([11196, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11948919296264648  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11196, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.12133216857910156  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11966371536254883  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11196, 40])
pseudo mini batch 1 input nodes size: 63272
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.030378341674804688  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.06054878234863281  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.060631752014160156  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

first layer input nodes number: 63272
first layer output nodes number: 30427
edges number: 201622
----------------------------------------before model layer 0
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03595256805419922  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([63272, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03595256805419922  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03595256805419922  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0520777702331543  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0520777702331543  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.08109521865844727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([30427, 256])
h_self size  torch.Size([30427, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.08109521865844727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([30427, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11011266708374023  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.08109521865844727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([30427, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11011266708374023  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11736726760864258  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------input nodes number: 30427
----------------output nodes number: 11132
----------------edges number: 73234
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11767721176147461  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11767721176147461  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1289229393005371  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1289229393005371  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.13115549087524414  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([11132, 40])
h_self size  torch.Size([11132, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.13115549087524414  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11132, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1328144073486328  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.13058185577392578  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11132, 40])
pseudo mini batch 2 input nodes size: 66885
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.033388614654541016  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.06528186798095703  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.06536674499511719  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

first layer input nodes number: 66885
first layer output nodes number: 41028
edges number: 335170
----------------------------------------before model layer 0
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([66885, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.03944587707519531  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0627126693725586  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.0627126693725586  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10184001922607422  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([41028, 256])
h_self size  torch.Size([41028, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10184001922607422  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([41028, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.14096736907958984  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.10184001922607422  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([41028, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.14096736907958984  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1508336067199707  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------input nodes number: 41028
----------------output nodes number: 11351
----------------edges number: 138207
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.15122461318969727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.15122461318969727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16316461563110352  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16316461563110352  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1650853157043457  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([11351, 40])
h_self size  torch.Size([11351, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1650853157043457  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11351, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1667771339416504  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1648564338684082  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11351, 40])
pseudo mini batch 3 input nodes size: 80723
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.034952640533447266  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07344436645507812  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07352685928344727  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

first layer input nodes number: 80723
first layer output nodes number: 46285
edges number: 367151
----------------------------------------before model layer 0
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.046105384826660156  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([80723, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.046105384826660156  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.046105384826660156  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07287168502807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.07287168502807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11779356002807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([46285, 256])
h_self size  torch.Size([46285, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11779356002807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([46285, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16271543502807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.11779356002807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([46285, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.16271543502807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.17443418502807617  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------input nodes number: 46285
----------------output nodes number: 11035
----------------edges number: 117198
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.17486190795898438  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.17486190795898438  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1863422393798828  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1863422393798828  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1879868507385254  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

h_neigh size torch.Size([11035, 40])
h_self size  torch.Size([11035, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1879868507385254  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11035, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.18963146209716797  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1072998046875 GB
    Memory Allocated: 0.1879868507385254  GigaBytes
Max Memory Allocated: 0.26634836196899414  GigaBytes

torch.Size([11035, 40])
pseudo mini batch 4 input nodes size: 36931
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.041501522064208984  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.059111595153808594  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05919790267944336  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 36931
first layer output nodes number: 21109
edges number: 117459
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.022494792938232422  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([36931, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.022494792938232422  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.022494792938232422  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03351449966430664  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03351449966430664  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05364561080932617  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([21109, 256])
h_self size  torch.Size([21109, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05364561080932617  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([21109, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0737767219543457  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05364561080932617  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([21109, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0737767219543457  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07880973815917969  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 21109
----------------output nodes number: 11551
----------------edges number: 75464
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09071874618530273  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09071874618530273  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09263992309570312  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11551, 40])
h_self size  torch.Size([11551, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09263992309570312  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11551, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09511947631835938  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09319829940795898  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11551, 40])
pseudo mini batch 5 input nodes size: 34784
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.020900249481201172  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03748655319213867  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03757333755493164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 34784
first layer output nodes number: 20905
edges number: 117969
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.021753311157226562  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([34784, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.021753311157226562  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.021753311157226562  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.032679080963134766  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.032679080963134766  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05261564254760742  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([20905, 256])
h_self size  torch.Size([20905, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05261564254760742  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20905, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07255220413208008  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05261564254760742  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20905, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07255220413208008  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07753658294677734  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 20905
----------------output nodes number: 11596
----------------edges number: 78064
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07777929306030273  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07777929306030273  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08950662612915039  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08950662612915039  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0921640396118164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11596, 40])
h_self size  torch.Size([11596, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0921640396118164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11596, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09389209747314453  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09123468399047852  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11596, 40])
pseudo mini batch 6 input nodes size: 38025
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.019683837890625  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03781557083129883  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.037901878356933594  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 38025
first layer output nodes number: 20777
edges number: 131993
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.023322105407714844  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([38025, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.023322105407714844  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.023322105407714844  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03429126739501953  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03429126739501953  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05410575866699219  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([20777, 256])
h_self size  torch.Size([20777, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05410575866699219  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20777, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07392024993896484  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05410575866699219  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20777, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07392024993896484  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07887411117553711  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 20777
----------------output nodes number: 11539
----------------edges number: 89970
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07911539077758789  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07911539077758789  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09087705612182617  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09087705612182617  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0926675796508789  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11539, 40])
h_self size  torch.Size([11539, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0926675796508789  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11539, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09438705444335938  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11539, 40])
pseudo mini batch 7 input nodes size: 31983
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.021291255950927734  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03654193878173828  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03662824630737305  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 31983
first layer output nodes number: 20573
edges number: 129052
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.02048349380493164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([31983, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.02048349380493164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.02048349380493164  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03133249282836914  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03133249282836914  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05095243453979492  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([20573, 256])
h_self size  torch.Size([20573, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05095243453979492  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20573, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0705723762512207  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05095243453979492  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([20573, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0705723762512207  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07547760009765625  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 20573
----------------output nodes number: 11541
----------------edges number: 96452
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07571744918823242  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07571744918823242  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08752965927124023  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08752965927124023  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08939409255981445  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11541, 40])
h_self size  torch.Size([11541, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08939409255981445  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11541, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0917215347290039  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.08985710144042969  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11541, 40])
Number of nodes for computation during this epoch:  637771
Number of first layer input nodes during this epoch:  409241
Number of first layer output nodes during this epoch:  228530

-----------------------------------------------------------------------------epoch done
read pickle file
0.04765820503234863

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024019241333007812
global_2_local spend time (sec) 0.04703974723815918

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.226 seconds
Metis partitioning: 5.276 seconds
Split the graph: 1.915 seconds
Construct subgraphs: 0.057 seconds
11656
11035
11148
11515
11302
11227
11542
11516
REG metis partition end ----................................
the time spent:  11.590839147567749
REG construction  time spent:  3.1043784618377686
pure dgl.metis_partition the time spent:  8.48646068572998
total k batches seeds list generation spend  11.776052713394165
after graph partition
graph partition algorithm spend time 11.87833857536316

partition_len_list
[43232, 46199, 33813, 26710, 19948, 20032, 19089, 23227]
REG selection method  spend 11.953076601028442
check_connections_block*********************************
time for parepare 1: 0.014321088790893555
local_output_nid generation: 0.0020864009857177734
local_in_edges_tensor generation: 0.002851724624633789
mini_batch_src_global generation: 0.00583648681640625

&&&&&&&&&&&&&&& before remove duplicate length: 145154
&&&&&&&&&&&&&&& after remove duplicate length: 40647

r_  generation: 0.016901016235351562

local_output_nid generation: 0.0035991668701171875
local_in_edges_tensor generation: 0.0023589134216308594
mini_batch_src_global generation: 0.0029969215393066406

&&&&&&&&&&&&&&& before remove duplicate length: 97791
&&&&&&&&&&&&&&& after remove duplicate length: 42266

r_  generation: 0.017377376556396484

local_output_nid generation: 0.003016233444213867
local_in_edges_tensor generation: 0.002384185791015625
mini_batch_src_global generation: 0.0025246143341064453

&&&&&&&&&&&&&&& before remove duplicate length: 87906
&&&&&&&&&&&&&&& after remove duplicate length: 31135

r_  generation: 0.016025543212890625

local_output_nid generation: 0.0029761791229248047
local_in_edges_tensor generation: 0.0025849342346191406
mini_batch_src_global generation: 0.002011537551879883

&&&&&&&&&&&&&&& before remove duplicate length: 86526
&&&&&&&&&&&&&&& after remove duplicate length: 24873

r_  generation: 0.014262676239013672

local_output_nid generation: 0.002811431884765625
local_in_edges_tensor generation: 0.0023660659790039062
mini_batch_src_global generation: 0.002132415771484375

&&&&&&&&&&&&&&& before remove duplicate length: 86607
&&&&&&&&&&&&&&& after remove duplicate length: 18865

r_  generation: 0.012149810791015625

local_output_nid generation: 0.002763509750366211
local_in_edges_tensor generation: 0.0021948814392089844
mini_batch_src_global generation: 0.0022039413452148438

&&&&&&&&&&&&&&& before remove duplicate length: 90159
&&&&&&&&&&&&&&& after remove duplicate length: 18879

r_  generation: 0.01203298568725586

local_output_nid generation: 0.0027968883514404297
local_in_edges_tensor generation: 0.0021696090698242188
mini_batch_src_global generation: 0.0017650127410888672

&&&&&&&&&&&&&&& before remove duplicate length: 66150
&&&&&&&&&&&&&&& after remove duplicate length: 17964

r_  generation: 0.011789798736572266

local_output_nid generation: 0.0026869773864746094
local_in_edges_tensor generation: 0.002137899398803711
mini_batch_src_global generation: 0.0020821094512939453

&&&&&&&&&&&&&&& before remove duplicate length: 83957
&&&&&&&&&&&&&&& after remove duplicate length: 21974

r_  generation: 0.013498544692993164


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04520583152770996
gen group dst list time:  0.0068302154541015625
check_connections_block*********************************
time for parepare 1: 0.018953323364257812
local_output_nid generation: 0.0074999332427978516
local_in_edges_tensor generation: 0.033745527267456055
mini_batch_src_global generation: 0.011748075485229492

&&&&&&&&&&&&&&& before remove duplicate length: 354385
&&&&&&&&&&&&&&& after remove duplicate length: 65734

r_  generation: 0.04037761688232422

local_output_nid generation: 0.012131690979003906
local_in_edges_tensor generation: 0.01103973388671875
mini_batch_src_global generation: 0.0089111328125

&&&&&&&&&&&&&&& before remove duplicate length: 353751
&&&&&&&&&&&&&&& after remove duplicate length: 82949

r_  generation: 0.05130314826965332

local_output_nid generation: 0.00872182846069336
local_in_edges_tensor generation: 0.006769418716430664
mini_batch_src_global generation: 0.006844282150268555

&&&&&&&&&&&&&&& before remove duplicate length: 240973
&&&&&&&&&&&&&&& after remove duplicate length: 61451

r_  generation: 0.04197812080383301

local_output_nid generation: 0.00941610336303711
local_in_edges_tensor generation: 0.0056188106536865234
mini_batch_src_global generation: 0.0050067901611328125

&&&&&&&&&&&&&&& before remove duplicate length: 170130
&&&&&&&&&&&&&&& after remove duplicate length: 53919

r_  generation: 0.030259132385253906

local_output_nid generation: 0.00538945198059082
local_in_edges_tensor generation: 0.004281520843505859
mini_batch_src_global generation: 0.0034410953521728516

&&&&&&&&&&&&&&& before remove duplicate length: 120411
&&&&&&&&&&&&&&& after remove duplicate length: 33086

r_  generation: 0.020484209060668945

local_output_nid generation: 0.005004167556762695
local_in_edges_tensor generation: 0.003819704055786133
mini_batch_src_global generation: 0.003170013427734375

&&&&&&&&&&&&&&& before remove duplicate length: 123569
&&&&&&&&&&&&&&& after remove duplicate length: 30143

r_  generation: 0.018930435180664062

local_output_nid generation: 0.004765748977661133
local_in_edges_tensor generation: 0.0036809444427490234
mini_batch_src_global generation: 0.0025043487548828125

&&&&&&&&&&&&&&& before remove duplicate length: 97431
&&&&&&&&&&&&&&& after remove duplicate length: 29255

r_  generation: 0.018649816513061523

local_output_nid generation: 0.005613803863525391
local_in_edges_tensor generation: 0.0043714046478271484
mini_batch_src_global generation: 0.003612518310546875

&&&&&&&&&&&&&&& before remove duplicate length: 140373
&&&&&&&&&&&&&&& after remove duplicate length: 40727

r_  generation: 0.022829771041870117


connection checking time:  1.1602404117584229
block generation total time  1.071526050567627
block dataloader generation time/epoch 14.268152713775635
pseudo mini batch 0 input nodes size: 69564
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.01848316192626953  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05165386199951172  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.05174112319946289  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 69564
first layer output nodes number: 43232
edges number: 354385
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04096794128417969  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([69564, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04096794128417969  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04096794128417969  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.06525421142578125  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.06525421142578125  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.10648345947265625  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([43232, 256])
h_self size  torch.Size([43232, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.10648345947265625  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([43232, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.14771270751953125  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.10648345947265625  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([43232, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.14771270751953125  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.15802001953125  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 43232
----------------output nodes number: 11656
----------------edges number: 145154
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.15842962265014648  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.15842962265014648  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1707158088684082  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1707158088684082  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1732792854309082  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11656, 40])
h_self size  torch.Size([11656, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1732792854309082  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11656, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.17523479461669922  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.17267131805419922  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11656, 40])
pseudo mini batch 1 input nodes size: 86584
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.03627777099609375  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07756423950195312  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.07764673233032227  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

first layer input nodes number: 86584
first layer output nodes number: 46199
edges number: 353751
----------------------------------------before model layer 0
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04938030242919922  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([86584, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04938030242919922  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.04938030242919922  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0742177963256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.0742177963256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1191396713256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([46199, 256])
h_self size  torch.Size([46199, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1191396713256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([46199, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1640615463256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1191396713256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([46199, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1640615463256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1757802963256836  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------input nodes number: 46199
----------------output nodes number: 11035
----------------edges number: 97791
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1762070655822754  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.1762070655822754  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.18754243850708008  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.18754243850708008  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.18918704986572266  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

h_neigh size torch.Size([11035, 40])
h_self size  torch.Size([11035, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.18918704986572266  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11035, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.19083166122436523  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1522216796875 GB
    Memory Allocated: 0.18918704986572266  GigaBytes
Max Memory Allocated: 0.2666201591491699  GigaBytes

torch.Size([11035, 40])
pseudo mini batch 2 input nodes size: 64361
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.0442962646484375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.0755462646484375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.07562971115112305  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 64361
first layer output nodes number: 33813
edges number: 240973
----------------------------------------before model layer 0
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.03744363784790039  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([64361, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.03744363784790039  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.03744363784790039  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.05548906326293945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.05548906326293945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.08773565292358398  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([33813, 256])
h_self size  torch.Size([33813, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.08773565292358398  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([33813, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.11998224258422852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.08773565292358398  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([33813, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.11998224258422852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.12875127792358398  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 33813
----------------output nodes number: 11148
----------------edges number: 87906
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.12908697128295898  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1971435546875 GB
    Memory Allocated: 0.12908697128295898  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1404576301574707  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1404576301574707  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.14248275756835938  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11148, 40])
h_self size  torch.Size([11148, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.14248275756835938  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11148, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.14414405822753906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1421189308166504  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11148, 40])
pseudo mini batch 3 input nodes size: 55756
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03436279296875  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06170654296875  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06179237365722656  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 55756
first layer output nodes number: 26710
edges number: 170130
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.032987117767333984  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([55756, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.032987117767333984  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.032987117767333984  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04709148406982422  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04709148406982422  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07256412506103516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([26710, 256])
h_self size  torch.Size([26710, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07256412506103516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([26710, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0980367660522461  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07256412506103516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([26710, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0980367660522461  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10440492630004883  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 26710
----------------output nodes number: 11515
----------------edges number: 86526
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1046900749206543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1046900749206543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.11640214920043945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.11640214920043945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.11827325820922852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11515, 40])
h_self size  torch.Size([11515, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.11827325820922852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11515, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.11998939514160156  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.1181182861328125  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11515, 40])
pseudo mini batch 4 input nodes size: 33993
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03058338165283203  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04679250717163086  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04687690734863281  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 33993
first layer output nodes number: 19948
edges number: 120411
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.021392822265625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([33993, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.021392822265625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.021392822265625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.031876564025878906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.031876564025878906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051407814025878906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([19948, 256])
h_self size  torch.Size([19948, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051407814025878906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([19948, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0709390640258789  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051407814025878906  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([19948, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0709390640258789  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07569503784179688  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 19948
----------------output nodes number: 11302
----------------edges number: 86607
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0759282112121582  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0759282112121582  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08743715286254883  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08743715286254883  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08912134170532227  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11302, 40])
h_self size  torch.Size([11302, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08912134170532227  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11302, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09101629257202148  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08933210372924805  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11302, 40])
pseudo mini batch 5 input nodes size: 31127
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.019260406494140625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0341029167175293  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03418684005737305  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 31127
first layer output nodes number: 20032
edges number: 123569
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01986837387084961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([31127, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01986837387084961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01986837387084961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.030416488647460938  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.030416488647460938  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04994773864746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([20032, 256])
h_self size  torch.Size([20032, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04994773864746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20032, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06947898864746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04994773864746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20032, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06947898864746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07425498962402344  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 20032
----------------output nodes number: 11227
----------------edges number: 90159
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07448816299438477  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08595132827758789  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08595132827758789  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08762454986572266  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11227, 40])
h_self size  torch.Size([11227, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08762454986572266  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11227, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08929777145385742  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08762454986572266  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11227, 40])
pseudo mini batch 6 input nodes size: 29971
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.017882347106933594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03217363357543945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03225994110107422  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 29971
first layer output nodes number: 19089
edges number: 97431
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01891946792602539  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([29971, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01891946792602539  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.01891946792602539  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.028820037841796875  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.028820037841796875  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04702472686767578  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([19089, 256])
h_self size  torch.Size([19089, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04702472686767578  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([19089, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06522941589355469  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04702472686767578  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([19089, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06522941589355469  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06978082656860352  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 19089
----------------output nodes number: 11542
----------------edges number: 66150
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07000970840454102  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07000970840454102  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08159685134887695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08159685134887695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11542, 40])
h_self size  torch.Size([11542, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11542, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0850367546081543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08331680297851562  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11542, 40])
pseudo mini batch 7 input nodes size: 41782
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.017380237579345703  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03730344772338867  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.037389278411865234  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 41782
first layer output nodes number: 23227
edges number: 140373
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02516794204711914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([41782, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02516794204711914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02516794204711914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03737640380859375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03737640380859375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.05952739715576172  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([23227, 256])
h_self size  torch.Size([23227, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.05952739715576172  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([23227, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08167839050292969  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.05952739715576172  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([23227, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08167839050292969  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08721637725830078  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 23227
----------------output nodes number: 11516
----------------edges number: 83957
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08747529983520508  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08747529983520508  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09916925430297852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09916925430297852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10174751281738281  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11516, 40])
h_self size  torch.Size([11516, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10174751281738281  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11516, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10418891906738281  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10161066055297852  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11516, 40])
Average training time/epoch 0.24314379692077637
Average Training time/epoch w/o nid counting 0.2423563003540039
Number of nodes for computation during this epoch:  645388
Number of first layer input nodes during this epoch:  413138
Number of first layer output nodes during this epoch:  232250

-----------------------------------------------------------------------------epoch done
read pickle file
0.04054760932922363

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024382829666137695
global_2_local spend time (sec) 0.047121286392211914

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.208 seconds
Metis partitioning: 5.128 seconds
Split the graph: 2.018 seconds
Construct subgraphs: 0.031 seconds
11640
11627
11630
11539
11036
11242
11158
11069
REG metis partition end ----................................
the time spent:  11.457970142364502
REG construction  time spent:  3.0594840049743652
pure dgl.metis_partition the time spent:  8.398486137390137
total k batches seeds list generation spend  11.65082311630249
after graph partition
graph partition algorithm spend time 11.739497184753418

partition_len_list
[23874, 21229, 20449, 20871, 47918, 41382, 27647, 34614]
REG selection method  spend 11.813762426376343
check_connections_block*********************************
time for parepare 1: 0.013953447341918945
local_output_nid generation: 0.002091646194458008
local_in_edges_tensor generation: 0.002285003662109375
mini_batch_src_global generation: 0.003088712692260742

&&&&&&&&&&&&&&& before remove duplicate length: 89363
&&&&&&&&&&&&&&& after remove duplicate length: 22602

r_  generation: 0.013431549072265625

local_output_nid generation: 0.0026998519897460938
local_in_edges_tensor generation: 0.002065420150756836
mini_batch_src_global generation: 0.002000570297241211

&&&&&&&&&&&&&&& before remove duplicate length: 75131
&&&&&&&&&&&&&&& after remove duplicate length: 20048

r_  generation: 0.01239323616027832

local_output_nid generation: 0.002676725387573242
local_in_edges_tensor generation: 0.0020475387573242188
mini_batch_src_global generation: 0.002069711685180664

&&&&&&&&&&&&&&& before remove duplicate length: 89141
&&&&&&&&&&&&&&& after remove duplicate length: 19522

r_  generation: 0.012035608291625977

local_output_nid generation: 0.0026280879974365234
local_in_edges_tensor generation: 0.002318859100341797
mini_batch_src_global generation: 0.002239704132080078

&&&&&&&&&&&&&&& before remove duplicate length: 92682
&&&&&&&&&&&&&&& after remove duplicate length: 19711

r_  generation: 0.012181282043457031

local_output_nid generation: 0.002645254135131836
local_in_edges_tensor generation: 0.0023522377014160156
mini_batch_src_global generation: 0.0026051998138427734

&&&&&&&&&&&&&&& before remove duplicate length: 107940
&&&&&&&&&&&&&&& after remove duplicate length: 44092

r_  generation: 0.01808762550354004

local_output_nid generation: 0.0031096935272216797
local_in_edges_tensor generation: 0.00421142578125
mini_batch_src_global generation: 0.004122734069824219

&&&&&&&&&&&&&&& before remove duplicate length: 133552
&&&&&&&&&&&&&&& after remove duplicate length: 38662

r_  generation: 0.01665663719177246

local_output_nid generation: 0.0030891895294189453
local_in_edges_tensor generation: 0.002164602279663086
mini_batch_src_global generation: 0.0018186569213867188

&&&&&&&&&&&&&&& before remove duplicate length: 68633
&&&&&&&&&&&&&&& after remove duplicate length: 25362

r_  generation: 0.014023542404174805

local_output_nid generation: 0.0028738975524902344
local_in_edges_tensor generation: 0.0020945072174072266
mini_batch_src_global generation: 0.002071380615234375

&&&&&&&&&&&&&&& before remove duplicate length: 87808
&&&&&&&&&&&&&&& after remove duplicate length: 32007

r_  generation: 0.015185117721557617


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.031534671783447266
gen group dst list time:  0.006906986236572266
check_connections_block*********************************
time for parepare 1: 0.017941713333129883
local_output_nid generation: 0.004121303558349609
local_in_edges_tensor generation: 0.009896039962768555
mini_batch_src_global generation: 0.004694461822509766

&&&&&&&&&&&&&&& before remove duplicate length: 149796
&&&&&&&&&&&&&&& after remove duplicate length: 43958

r_  generation: 0.024334430694580078

local_output_nid generation: 0.005685567855834961
local_in_edges_tensor generation: 0.004025459289550781
mini_batch_src_global generation: 0.0030024051666259766

&&&&&&&&&&&&&&& before remove duplicate length: 117990
&&&&&&&&&&&&&&& after remove duplicate length: 34331

r_  generation: 0.022458314895629883

local_output_nid generation: 0.0054645538330078125
local_in_edges_tensor generation: 0.005580902099609375
mini_batch_src_global generation: 0.004324913024902344

&&&&&&&&&&&&&&& before remove duplicate length: 124428
&&&&&&&&&&&&&&& after remove duplicate length: 33713

r_  generation: 0.020178794860839844

local_output_nid generation: 0.005217552185058594
local_in_edges_tensor generation: 0.0038988590240478516
mini_batch_src_global generation: 0.0029404163360595703

&&&&&&&&&&&&&&& before remove duplicate length: 129451
&&&&&&&&&&&&&&& after remove duplicate length: 31751

r_  generation: 0.019639968872070312

local_output_nid generation: 0.011673688888549805
local_in_edges_tensor generation: 0.010665178298950195
mini_batch_src_global generation: 0.012117147445678711

&&&&&&&&&&&&&&& before remove duplicate length: 376489
&&&&&&&&&&&&&&& after remove duplicate length: 82729

r_  generation: 0.04957127571105957

local_output_nid generation: 0.009806156158447266
local_in_edges_tensor generation: 0.00933218002319336
mini_batch_src_global generation: 0.01051020622253418

&&&&&&&&&&&&&&& before remove duplicate length: 335734
&&&&&&&&&&&&&&& after remove duplicate length: 65211

r_  generation: 0.043150901794433594

local_output_nid generation: 0.007589578628540039
local_in_edges_tensor generation: 0.005247354507446289
mini_batch_src_global generation: 0.0049746036529541016

&&&&&&&&&&&&&&& before remove duplicate length: 169552
&&&&&&&&&&&&&&& after remove duplicate length: 58303

r_  generation: 0.0321652889251709

local_output_nid generation: 0.00879979133605957
local_in_edges_tensor generation: 0.006453752517700195
mini_batch_src_global generation: 0.007042884826660156

&&&&&&&&&&&&&&& before remove duplicate length: 249389
&&&&&&&&&&&&&&& after remove duplicate length: 64771

r_  generation: 0.03779244422912598


connection checking time:  1.1776318550109863
block generation total time  1.081923007965088
block dataloader generation time/epoch 14.205800771713257
pseudo mini batch 0 input nodes size: 45209
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.023006916046142578  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.044564247131347656  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.044651031494140625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 45209
first layer output nodes number: 23874
edges number: 149796
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02694082260131836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([45209, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02694082260131836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02694082260131836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03953075408935547  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03953075408935547  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([23874, 256])
h_self size  torch.Size([23874, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([23874, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0850667953491211  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([23874, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0850667953491211  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09085321426391602  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 23874
----------------output nodes number: 11640
----------------edges number: 89363
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09111833572387695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09111833572387695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10297250747680664  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10297250747680664  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10541391372680664  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11640, 40])
h_self size  torch.Size([11640, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10541391372680664  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11640, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10766887664794922  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.10522747039794922  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11640, 40])
pseudo mini batch 1 input nodes size: 35186
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.024661540985107422  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04223966598510742  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04232645034790039  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 35186
first layer output nodes number: 21229
edges number: 117990
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02254199981689453  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([35186, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02254199981689453  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02254199981689453  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03362321853637695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03362321853637695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.053868770599365234  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([21229, 256])
h_self size  torch.Size([21229, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.053868770599365234  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([21229, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07411432266235352  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.053868770599365234  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([21229, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07411432266235352  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07917594909667969  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 21229
----------------output nodes number: 11627
----------------edges number: 75131
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0794210433959961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0794210433959961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.091156005859375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.091156005859375  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09288883209228516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11627, 40])
h_self size  torch.Size([11627, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09288883209228516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11627, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09462165832519531  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09288883209228516  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11627, 40])
pseudo mini batch 2 input nodes size: 34649
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02068042755126953  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03720235824584961  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03728914260864258  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 34649
first layer output nodes number: 20449
edges number: 124428
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02162790298461914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([34649, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02162790298461914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.02162790298461914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.032382965087890625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.032382965087890625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051914215087890625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([20449, 256])
h_self size  torch.Size([20449, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051914215087890625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20449, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07144546508789062  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.051914215087890625  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20449, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07144546508789062  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07632112503051758  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 20449
----------------output nodes number: 11630
----------------edges number: 89141
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07656049728393555  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07656049728393555  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08840322494506836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08840322494506836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09013652801513672  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11630, 40])
h_self size  torch.Size([11630, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09013652801513672  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11630, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09186983108520508  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09013652801513672  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11630, 40])
pseudo mini batch 3 input nodes size: 32826
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.019624710083007812  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.035277366638183594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03536367416381836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 32826
first layer output nodes number: 20871
edges number: 129451
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.020812034606933594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([32826, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.020812034606933594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.020812034606933594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03180742263793945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.03180742263793945  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0517115592956543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([20871, 256])
h_self size  torch.Size([20871, 128])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0517115592956543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20871, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07161569595336914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.0517115592956543  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([20871, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07161569595336914  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07659196853637695  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 20871
----------------output nodes number: 11539
----------------edges number: 92682
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07683420181274414  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07683420181274414  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08861684799194336  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.08861684799194336  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09038352966308594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11539, 40])
h_self size  torch.Size([11539, 256])
----------------------------------------before rst
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09038352966308594  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11539, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09254264831542969  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.09077596664428711  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11539, 40])
pseudo mini batch 4 input nodes size: 86389
----------------------------------------before batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.018741130828857422  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.05993461608886719  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.06001710891723633  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

first layer input nodes number: 86389
first layer output nodes number: 47918
edges number: 376489
----------------------------------------before model layer 0
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04964590072631836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([86389, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04964590072631836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.04964590072631836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07640218734741211  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.1990966796875 GB
    Memory Allocated: 0.07640218734741211  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.2459716796875 GB
    Memory Allocated: 0.1221003532409668  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([47918, 256])
h_self size  torch.Size([47918, 128])
----------------------------------------before rst
 Nvidia-smi: 8.2459716796875 GB
    Memory Allocated: 0.1221003532409668  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([47918, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.16779851913452148  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.1221003532409668  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([47918, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.16779851913452148  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.17951726913452148  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------input nodes number: 47918
----------------output nodes number: 11036
----------------edges number: 107940
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.17995691299438477  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.17995691299438477  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19136953353881836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19136953353881836  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19301414489746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

h_neigh size torch.Size([11036, 40])
h_self size  torch.Size([11036, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19301414489746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11036, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19465875625610352  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19301414489746094  GigaBytes
Max Memory Allocated: 0.26762962341308594  GigaBytes

torch.Size([11036, 40])
pseudo mini batch 5 input nodes size: 68907
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04420328140258789  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07706069946289062  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07714462280273438  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 68907
first layer output nodes number: 41382
edges number: 335734
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04053640365600586  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([68907, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04053640365600586  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04053640365600586  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06342601776123047  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06342601776123047  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1028909683227539  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([41382, 256])
h_self size  torch.Size([41382, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1028909683227539  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([41382, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14235591888427734  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1028909683227539  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([41382, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14235591888427734  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1522221565246582  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 41382
----------------output nodes number: 11242
----------------edges number: 133552
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.15261459350585938  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.15261459350585938  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1644153594970703  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1644153594970703  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1661672592163086  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11242, 40])
h_self size  torch.Size([11242, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1661672592163086  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11242, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16784286499023438  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1660909652709961  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11242, 40])
pseudo mini batch 6 input nodes size: 60115
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03597593307495117  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06464099884033203  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06472444534301758  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 60115
first layer output nodes number: 27647
edges number: 169552
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03421306610107422  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([60115, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03421306610107422  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03421306610107422  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04876279830932617  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04876279830932617  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07512903213500977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([27647, 256])
h_self size  torch.Size([27647, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07512903213500977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([27647, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10149526596069336  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07512903213500977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([27647, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10149526596069336  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10808706283569336  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 27647
----------------output nodes number: 11158
----------------edges number: 68633
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10837650299072266  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10837650299072266  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1196136474609375  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1196136474609375  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12219858169555664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11158, 40])
h_self size  torch.Size([11158, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12219858169555664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11158, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12386131286621094  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1212763786315918  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11158, 40])
pseudo mini batch 7 input nodes size: 67854
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03169393539428711  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06404924392700195  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0641317367553711  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 67854
first layer output nodes number: 34614
edges number: 249389
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03866004943847656  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([67854, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03866004943847656  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03866004943847656  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.05715322494506836  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.05715322494506836  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0901637077331543  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([34614, 256])
h_self size  torch.Size([34614, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0901637077331543  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([34614, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12317419052124023  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0901637077331543  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([34614, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12317419052124023  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1318345069885254  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 34614
----------------output nodes number: 11069
----------------edges number: 87808
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.13217496871948242  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.13217496871948242  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14346837997436523  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14346837997436523  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14511823654174805  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11069, 40])
h_self size  torch.Size([11069, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14511823654174805  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11069, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14693260192871094  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14528274536132812  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11069, 40])
Average training time/epoch 0.23127233982086182
Average Training time/epoch w/o nid counting 0.21875524520874023
Number of nodes for computation during this epoch:  669119
Number of first layer input nodes during this epoch:  431135
Number of first layer output nodes during this epoch:  237984

-----------------------------------------------------------------------------epoch done
read pickle file
0.05964064598083496

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016424179077148438
global_2_local spend time (sec) 0.04706883430480957

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 1.238 seconds
Metis partitioning: 5.271 seconds
Split the graph: 1.903 seconds
Construct subgraphs: 0.033 seconds
11035
11224
11427
11035
11513
11540
11596
11571
REG metis partition end ----................................
the time spent:  11.726160049438477
REG construction  time spent:  3.267899513244629
pure dgl.metis_partition the time spent:  8.458260536193848
total k batches seeds list generation spend  11.916280031204224
after graph partition
graph partition algorithm spend time 12.000038623809814

partition_len_list
[34249, 25617, 41144, 48043, 19090, 20617, 24771, 22085]
REG selection method  spend 12.074978351593018
check_connections_block*********************************
time for parepare 1: 0.014541864395141602
local_output_nid generation: 0.002030611038208008
local_in_edges_tensor generation: 0.002155780792236328
mini_batch_src_global generation: 0.0028324127197265625

&&&&&&&&&&&&&&& before remove duplicate length: 79515
&&&&&&&&&&&&&&& after remove duplicate length: 31275

r_  generation: 0.014482975006103516

local_output_nid generation: 0.0033712387084960938
local_in_edges_tensor generation: 0.002191781997680664
mini_batch_src_global generation: 0.0021293163299560547

&&&&&&&&&&&&&&& before remove duplicate length: 64024
&&&&&&&&&&&&&&& after remove duplicate length: 23461

r_  generation: 0.013067245483398438

local_output_nid generation: 0.002772092819213867
local_in_edges_tensor generation: 0.002313852310180664
mini_batch_src_global generation: 0.003616809844970703

&&&&&&&&&&&&&&& before remove duplicate length: 136349
&&&&&&&&&&&&&&& after remove duplicate length: 38538

r_  generation: 0.01643204689025879

local_output_nid generation: 0.0030329227447509766
local_in_edges_tensor generation: 0.0025005340576171875
mini_batch_src_global generation: 0.002813577651977539

&&&&&&&&&&&&&&& before remove duplicate length: 116591
&&&&&&&&&&&&&&& after remove duplicate length: 44393

r_  generation: 0.01935577392578125

local_output_nid generation: 0.003225564956665039
local_in_edges_tensor generation: 0.0023026466369628906
mini_batch_src_global generation: 0.002653837203979492

&&&&&&&&&&&&&&& before remove duplicate length: 92710
&&&&&&&&&&&&&&& after remove duplicate length: 18276

r_  generation: 0.012655258178710938

local_output_nid generation: 0.0031054019927978516
local_in_edges_tensor generation: 0.0021855831146240234
mini_batch_src_global generation: 0.002124309539794922

&&&&&&&&&&&&&&& before remove duplicate length: 90967
&&&&&&&&&&&&&&& after remove duplicate length: 19431

r_  generation: 0.012390851974487305

local_output_nid generation: 0.0029354095458984375
local_in_edges_tensor generation: 0.002101898193359375
mini_batch_src_global generation: 0.001988649368286133

&&&&&&&&&&&&&&& before remove duplicate length: 83971
&&&&&&&&&&&&&&& after remove duplicate length: 23260

r_  generation: 0.013735771179199219

local_output_nid generation: 0.0028777122497558594
local_in_edges_tensor generation: 0.002063751220703125
mini_batch_src_global generation: 0.0019447803497314453

&&&&&&&&&&&&&&& before remove duplicate length: 80123
&&&&&&&&&&&&&&& after remove duplicate length: 20890

r_  generation: 0.012762784957885742


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04261326789855957
gen group dst list time:  0.006785869598388672
check_connections_block*********************************
time for parepare 1: 0.018721580505371094
local_output_nid generation: 0.005980253219604492
local_in_edges_tensor generation: 0.014595746994018555
mini_batch_src_global generation: 0.007879495620727539

&&&&&&&&&&&&&&& before remove duplicate length: 238314
&&&&&&&&&&&&&&& after remove duplicate length: 67456

r_  generation: 0.03705596923828125

local_output_nid generation: 0.00755620002746582
local_in_edges_tensor generation: 0.005837202072143555
mini_batch_src_global generation: 0.004019260406494141

&&&&&&&&&&&&&&& before remove duplicate length: 148328
&&&&&&&&&&&&&&& after remove duplicate length: 53260

r_  generation: 0.028812408447265625

local_output_nid generation: 0.009550094604492188
local_in_edges_tensor generation: 0.011871099472045898
mini_batch_src_global generation: 0.011218786239624023

&&&&&&&&&&&&&&& before remove duplicate length: 333579
&&&&&&&&&&&&&&& after remove duplicate length: 63564

r_  generation: 0.04066801071166992

local_output_nid generation: 0.01151418685913086
local_in_edges_tensor generation: 0.011265754699707031
mini_batch_src_global generation: 0.011651992797851562

&&&&&&&&&&&&&&& before remove duplicate length: 382503
&&&&&&&&&&&&&&& after remove duplicate length: 81366

r_  generation: 0.05082511901855469

local_output_nid generation: 0.0053746700286865234
local_in_edges_tensor generation: 0.004266500473022461
mini_batch_src_global generation: 0.00417637825012207

&&&&&&&&&&&&&&& before remove duplicate length: 119940
&&&&&&&&&&&&&&& after remove duplicate length: 31204

r_  generation: 0.02072739601135254

local_output_nid generation: 0.005170345306396484
local_in_edges_tensor generation: 0.004030466079711914
mini_batch_src_global generation: 0.0032966136932373047

&&&&&&&&&&&&&&& before remove duplicate length: 126075
&&&&&&&&&&&&&&& after remove duplicate length: 31365

r_  generation: 0.019660472869873047

local_output_nid generation: 0.006140708923339844
local_in_edges_tensor generation: 0.004866361618041992
mini_batch_src_global generation: 0.00406646728515625

&&&&&&&&&&&&&&& before remove duplicate length: 152418
&&&&&&&&&&&&&&& after remove duplicate length: 47561

r_  generation: 0.02886199951171875

local_output_nid generation: 0.005706310272216797
local_in_edges_tensor generation: 0.004304409027099609
mini_batch_src_global generation: 0.015502214431762695

&&&&&&&&&&&&&&& before remove duplicate length: 128446
&&&&&&&&&&&&&&& after remove duplicate length: 36427

r_  generation: 0.022144317626953125


connection checking time:  1.1822147369384766
block generation total time  1.0702338218688965
block dataloader generation time/epoch 14.273059050242106
pseudo mini batch 0 input nodes size: 70282
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0353693962097168  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06888246536254883  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06896495819091797  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 70282
first layer output nodes number: 34249
edges number: 238314
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03967571258544922  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([70282, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03967571258544922  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03967571258544922  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.05791044235229492  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.05791044235229492  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09057283401489258  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([34249, 256])
h_self size  torch.Size([34249, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09057283401489258  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([34249, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12323522567749023  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09057283401489258  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([34249, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12323522567749023  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.13148975372314453  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 34249
----------------output nodes number: 11035
----------------edges number: 79515
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.13182783126831055  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.13182783126831055  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14302778244018555  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14302778244018555  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14476346969604492  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11035, 40])
h_self size  torch.Size([11035, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14476346969604492  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11035, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1464080810546875  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.14467239379882812  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11035, 40])
pseudo mini batch 1 input nodes size: 54975
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03661394119262695  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06282806396484375  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0629119873046875  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 54975
first layer output nodes number: 25617
edges number: 148328
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03150033950805664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([54975, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03150033950805664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03150033950805664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.044916629791259766  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.044916629791259766  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06934690475463867  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([25617, 256])
h_self size  torch.Size([25617, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06934690475463867  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([25617, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09377717971801758  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06934690475463867  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([25617, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09377717971801758  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0998849868774414  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 25617
----------------output nodes number: 11224
----------------edges number: 64024
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10016012191772461  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10016012191772461  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.11142587661743164  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.11142587661743164  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1130986213684082  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11224, 40])
h_self size  torch.Size([11224, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1130986213684082  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11224, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.11477136611938477  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1130986213684082  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11224, 40])
pseudo mini batch 2 input nodes size: 67279
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.029253482818603516  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06133460998535156  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06141996383666992  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 67279
first layer output nodes number: 41144
edges number: 333579
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03943300247192383  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([67279, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03943300247192383  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03943300247192383  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06254720687866211  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06254720687866211  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10178518295288086  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([41144, 256])
h_self size  torch.Size([41144, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10178518295288086  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([41144, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1410231590270996  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10178518295288086  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([41144, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1410231590270996  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1508326530456543  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 41144
----------------output nodes number: 11427
----------------edges number: 136349
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.15122461318969727  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.15122461318969727  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1632246971130371  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1632246971130371  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16509008407592773  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11427, 40])
h_self size  torch.Size([11427, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16509008407592773  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11427, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1667928695678711  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16492748260498047  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11427, 40])
pseudo mini batch 3 input nodes size: 85132
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03531455993652344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07590866088867188  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07599115371704102  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 85132
first layer output nodes number: 48043
edges number: 382503
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04853677749633789  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([85132, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04853677749633789  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04853677749633789  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07452726364135742  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07452726364135742  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12034463882446289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([48043, 256])
h_self size  torch.Size([48043, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12034463882446289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([48043, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16616201400756836  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.12034463882446289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([48043, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.16616201400756836  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.17788076400756836  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 48043
----------------output nodes number: 11035
----------------edges number: 116591
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.17832136154174805  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.17832136154174805  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.18979692459106445  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.18979692459106445  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.19144153594970703  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11035, 40])
h_self size  torch.Size([11035, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.19144153594970703  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11035, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.1930861473083496  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.19144153594970703  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11035, 40])
pseudo mini batch 4 input nodes size: 31981
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04360389709472656  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0588536262512207  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.058939456939697266  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 31981
first layer output nodes number: 19090
edges number: 119940
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.020229816436767578  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([31981, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.020229816436767578  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.020229816436767578  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.030298709869384766  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.030298709869384766  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([19090, 256])
h_self size  torch.Size([19090, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([19090, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06670999526977539  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04850435256958008  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([19090, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06670999526977539  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07126140594482422  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 19090
----------------output nodes number: 11513
----------------edges number: 92710
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07148981094360352  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07148981094360352  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08324670791625977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08324670791625977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08557510375976562  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11513, 40])
h_self size  torch.Size([11513, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08557510375976562  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11513, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08729076385498047  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08496236801147461  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11513, 40])
pseudo mini batch 5 input nodes size: 32451
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.01894664764404297  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03442049026489258  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.034506797790527344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 32451
first layer output nodes number: 20617
edges number: 126075
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.021184921264648438  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([32451, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.021184921264648438  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.021184921264648438  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03203248977661133  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.03203248977661133  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.051694393157958984  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([20617, 256])
h_self size  torch.Size([20617, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.051694393157958984  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([20617, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07135629653930664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.051694393157958984  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([20617, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07135629653930664  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07677507400512695  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 20617
----------------output nodes number: 11540
----------------edges number: 90967
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07701539993286133  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07701539993286133  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08878564834594727  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08878564834594727  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09060811996459961  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11540, 40])
h_self size  torch.Size([11540, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09060811996459961  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11540, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09232807159423828  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09050559997558594  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11540, 40])
pseudo mini batch 6 input nodes size: 48965
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.018665313720703125  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04201364517211914  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04210042953491211  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 48965
first layer output nodes number: 24771
edges number: 152418
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.02885293960571289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([48965, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.02885293960571289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.02885293960571289  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04189300537109375  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04189300537109375  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06551647186279297  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([24771, 256])
h_self size  torch.Size([24771, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06551647186279297  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([24771, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.06551647186279297  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([24771, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08913993835449219  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0950460433959961  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 24771
----------------output nodes number: 11596
----------------edges number: 83971
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09531784057617188  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09531784057617188  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10708999633789062  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10708999633789062  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10890340805053711  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11596, 40])
h_self size  torch.Size([11596, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10890340805053711  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11596, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.11089563369750977  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.10908222198486328  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11596, 40])
pseudo mini batch 7 input nodes size: 37351
----------------------------------------before batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.026445865631103516  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.04425621032714844  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0443425178527832  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

first layer input nodes number: 37351
first layer output nodes number: 22085
edges number: 128446
----------------------------------------before model layer 0
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.022905349731445312  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([37351, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.022905349731445312  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.022905349731445312  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.034476280212402344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.034476280212402344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.055960655212402344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([22085, 256])
h_self size  torch.Size([22085, 128])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.055960655212402344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([22085, 256])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07744503021240234  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.055960655212402344  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([22085, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.07744503021240234  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.08271074295043945  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------input nodes number: 22085
----------------output nodes number: 11571
----------------edges number: 80123
----------------------------------------before mean aggregator
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0829620361328125  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.srcdata['h'] =  feat_src-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0829620361328125  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------graph.update_all(msg_fn, fn.mean('m', 'neigh'))-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0946807861328125  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------h_neigh = graph.dstdata['neigh']-------
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.0946807861328125  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------after mean aggregator-------h_neigh = self.fc_neigh(h_neigh)-
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09646224975585938  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

h_neigh size torch.Size([11571, 40])
h_self size  torch.Size([11571, 256])
----------------------------------------before rst
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09646224975585938  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11571, 40])
----------------------------------------after rst (rst = self.fc_self(h_self) + h_neigh)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.09818649291992188  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3885498046875 GB
    Memory Allocated: 0.096405029296875  GigaBytes
Max Memory Allocated: 0.27310895919799805  GigaBytes

torch.Size([11571, 40])
Average training time/epoch 0.2286409536997477
Average Training time/epoch w/o nid counting 0.2229297161102295
Number of nodes for computation during this epoch:  664032
Number of first layer input nodes during this epoch:  428416
Number of first layer output nodes during this epoch:  235616

-----------------------------------------------------------------------------epoch done
