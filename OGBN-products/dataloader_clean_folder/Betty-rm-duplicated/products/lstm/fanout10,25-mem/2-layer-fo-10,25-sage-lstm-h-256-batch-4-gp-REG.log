main start at this time 1661484853.6580932
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22316861152648926
global_2_local spend time (sec) 0.36264634132385254

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 2.903 seconds
Metis partitioning: 11.293 seconds
Split the graph: 3.062 seconds
Construct subgraphs: 0.046 seconds
50528
49061
48060
48922
REG metis partition end ----................................
the time spent:  26.14005970954895
REG construction  time spent:  8.814592838287354
pure dgl.metis_partition the time spent:  17.325466871261597
total k batches seeds list generation spend  26.746784925460815
after graph partition
graph partition algorithm spend time 27.455971002578735

partition_len_list
[343475, 320201, 375919, 358918]
REG selection method  spend 27.986311197280884
check_connections_block*********************************
time for parepare 1: 0.22580838203430176
local_output_nid generation: 0.008056402206420898
local_in_edges_tensor generation: 0.016626358032226562

&&&&&&&&&&&&&&& before remove duplicate length: 1229642
remove duplicated spend time : 0.25692057609558105

&&&&&&&&&&&&&&& after remove duplicate length: 340959

mini_batch_src_global generation: 0.0224764347076416
r_  generation: 0.34307122230529785

local_output_nid generation: 0.013330698013305664
local_in_edges_tensor generation: 0.05837583541870117

&&&&&&&&&&&&&&& before remove duplicate length: 1185867
remove duplicated spend time : 0.2655608654022217

&&&&&&&&&&&&&&& after remove duplicate length: 318055

mini_batch_src_global generation: 0.03325366973876953
r_  generation: 0.20746636390686035

local_output_nid generation: 0.009550333023071289
local_in_edges_tensor generation: 0.015281915664672852

&&&&&&&&&&&&&&& before remove duplicate length: 1133922
remove duplicated spend time : 0.2796018123626709

&&&&&&&&&&&&&&& after remove duplicate length: 368966

mini_batch_src_global generation: 0.036453962326049805
r_  generation: 0.2688016891479492

local_output_nid generation: 0.009737014770507812
local_in_edges_tensor generation: 0.015729665756225586

&&&&&&&&&&&&&&& before remove duplicate length: 1214448
remove duplicated spend time : 0.3088569641113281

&&&&&&&&&&&&&&& after remove duplicate length: 356941

mini_batch_src_global generation: 0.04350543022155762
r_  generation: 0.28120994567871094


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6366808414459229
gen group dst list time:  0.05536389350891113
check_connections_block*********************************
time for parepare 1: 0.370877742767334
local_output_nid generation: 0.0663447380065918
local_in_edges_tensor generation: 0.15565848350524902

&&&&&&&&&&&&&&& before remove duplicate length: 3351580
remove duplicated spend time : 0.8037519454956055

&&&&&&&&&&&&&&& after remove duplicate length: 676958

mini_batch_src_global generation: 0.051987648010253906
r_  generation: 0.589432954788208

local_output_nid generation: 0.08292770385742188
local_in_edges_tensor generation: 0.13768863677978516

&&&&&&&&&&&&&&& before remove duplicate length: 3056449
remove duplicated spend time : 0.7751040458679199

&&&&&&&&&&&&&&& after remove duplicate length: 638122

mini_batch_src_global generation: 0.07070112228393555
r_  generation: 0.6275498867034912

local_output_nid generation: 0.09926009178161621
local_in_edges_tensor generation: 0.16531753540039062

&&&&&&&&&&&&&&& before remove duplicate length: 3674322
remove duplicated spend time : 0.9927206039428711

&&&&&&&&&&&&&&& after remove duplicate length: 843395

mini_batch_src_global generation: 0.09485530853271484
r_  generation: 0.8419272899627686

local_output_nid generation: 0.101470947265625
local_in_edges_tensor generation: 0.11479043960571289

&&&&&&&&&&&&&&& before remove duplicate length: 3541961
remove duplicated spend time : 0.9536523818969727

&&&&&&&&&&&&&&& after remove duplicate length: 678176

mini_batch_src_global generation: 0.09306716918945312
r_  generation: 0.7315037250518799


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3436279296875 GB
    Memory Allocated: 0.2652254104614258  GigaBytes
Max Memory Allocated: 0.2652254104614258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3436279296875 GB
    Memory Allocated: 0.26560211181640625  GigaBytes
Max Memory Allocated: 0.26560211181640625  GigaBytes

first layer input nodes number: 705131
first layer output nodes number: 343475
edges number: 3351580
----------------------------------------before model layer 0
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.30754899978637695  GigaBytes
Max Memory Allocated: 0.3200349807739258  GigaBytes

torch.Size([705131, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.4686279296875 GB
    Memory Allocated: 0.30754899978637695  GigaBytes
Max Memory Allocated: 0.3200349807739258  GigaBytes

m.shape torch.Size([714, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.9354248046875 GB
    Memory Allocated: 1.5918259620666504  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9354248046875 GB
    Memory Allocated: 1.5918259620666504  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

 h.shape torch.Size([1, 714, 100]), torch.Size([1, 714, 100])
----------------------------------------3
 Nvidia-smi: 8.9373779296875 GB
    Memory Allocated: 1.592358112335205  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9393310546875 GB
    Memory Allocated: 1.596980094909668  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

rst.shape  torch.Size([1, 714, 100])
m.shape torch.Size([1220, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.9412841796875 GB
    Memory Allocated: 1.597623348236084  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9412841796875 GB
    Memory Allocated: 1.597623348236084  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

 h.shape torch.Size([1, 1220, 100]), torch.Size([1, 1220, 100])
----------------------------------------3
 Nvidia-smi: 8.9412841796875 GB
    Memory Allocated: 1.5985331535339355  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9451904296875 GB
    Memory Allocated: 1.612959861755371  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

rst.shape  torch.Size([1, 1220, 100])
m.shape torch.Size([1496, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.9451904296875 GB
    Memory Allocated: 1.6141772270202637  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9451904296875 GB
    Memory Allocated: 1.6141772270202637  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

 h.shape torch.Size([1, 1496, 100]), torch.Size([1, 1496, 100])
----------------------------------------3
 Nvidia-smi: 8.9451904296875 GB
    Memory Allocated: 1.6152920722961426  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 1.640244483947754  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

rst.shape  torch.Size([1, 1496, 100])
m.shape torch.Size([2128, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 1.6428580284118652  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 1.6428580284118652  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

 h.shape torch.Size([1, 2128, 100]), torch.Size([1, 2128, 100])
----------------------------------------3
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 1.6444439888000488  GigaBytes
Max Memory Allocated: 1.6457881927490234  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9998779296875 GB
    Memory Allocated: 1.6918954849243164  GigaBytes
Max Memory Allocated: 1.6950664520263672  GigaBytes

rst.shape  torch.Size([1, 2128, 100])
m.shape torch.Size([2558, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.9998779296875 GB
    Memory Allocated: 1.6958675384521484  GigaBytes
Max Memory Allocated: 1.6960105895996094  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9998779296875 GB
    Memory Allocated: 1.6958675384521484  GigaBytes
Max Memory Allocated: 1.6960105895996094  GigaBytes

 h.shape torch.Size([1, 2558, 100]), torch.Size([1, 2558, 100])
----------------------------------------3
 Nvidia-smi: 9.0018310546875 GB
    Memory Allocated: 1.6977739334106445  GigaBytes
Max Memory Allocated: 1.6977739334106445  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 1.767333984375  GigaBytes
Max Memory Allocated: 1.7720990180969238  GigaBytes

rst.shape  torch.Size([1, 2558, 100])
m.shape torch.Size([2866, 6, 100])
----------------------------------------1
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 1.772787094116211  GigaBytes
Max Memory Allocated: 1.772979736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 1.772787094116211  GigaBytes
Max Memory Allocated: 1.772979736328125  GigaBytes

 h.shape torch.Size([1, 2866, 100]), torch.Size([1, 2866, 100])
----------------------------------------3
 Nvidia-smi: 9.0721435546875 GB
    Memory Allocated: 1.7753148078918457  GigaBytes
Max Memory Allocated: 1.7753148078918457  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1697998046875 GB
    Memory Allocated: 1.8686790466308594  GigaBytes
Max Memory Allocated: 1.8750853538513184  GigaBytes

rst.shape  torch.Size([1, 2866, 100])
m.shape torch.Size([3103, 7, 100])
----------------------------------------1
 Nvidia-smi: 9.1893310546875 GB
    Memory Allocated: 1.8757028579711914  GigaBytes
Max Memory Allocated: 1.875946044921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1893310546875 GB
    Memory Allocated: 1.8757028579711914  GigaBytes
Max Memory Allocated: 1.875946044921875  GigaBytes

 h.shape torch.Size([1, 3103, 100]), torch.Size([1, 3103, 100])
----------------------------------------3
 Nvidia-smi: 9.1893310546875 GB
    Memory Allocated: 1.8780155181884766  GigaBytes
Max Memory Allocated: 1.8780155181884766  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3065185546875 GB
    Memory Allocated: 1.9950923919677734  GigaBytes
Max Memory Allocated: 2.0031843185424805  GigaBytes

rst.shape  torch.Size([1, 3103, 100])
m.shape torch.Size([3374, 8, 100])
----------------------------------------1
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 2.0039916038513184  GigaBytes
Max Memory Allocated: 2.004293441772461  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 2.0039916038513184  GigaBytes
Max Memory Allocated: 2.004293441772461  GigaBytes

 h.shape torch.Size([1, 3374, 100]), torch.Size([1, 3374, 100])
----------------------------------------3
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 2.0069117546081543  GigaBytes
Max Memory Allocated: 2.0069117546081543  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4744873046875 GB
    Memory Allocated: 2.153689384460449  GigaBytes
Max Memory Allocated: 2.1637449264526367  GigaBytes

rst.shape  torch.Size([1, 3374, 100])
m.shape torch.Size([3433, 9, 100])
----------------------------------------1
 Nvidia-smi: 9.4862060546875 GB
    Memory Allocated: 2.1634740829467773  GigaBytes
Max Memory Allocated: 2.1638197898864746  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4862060546875 GB
    Memory Allocated: 2.1634740829467773  GigaBytes
Max Memory Allocated: 2.1638197898864746  GigaBytes

 h.shape torch.Size([1, 3433, 100]), torch.Size([1, 3433, 100])
----------------------------------------3
 Nvidia-smi: 9.4862060546875 GB
    Memory Allocated: 2.166687488555908  GigaBytes
Max Memory Allocated: 2.166687488555908  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6737060546875 GB
    Memory Allocated: 2.333374500274658  GigaBytes
Max Memory Allocated: 2.345093250274658  GigaBytes

rst.shape  torch.Size([1, 3433, 100])
m.shape torch.Size([322583, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.9569091796875 GB
    Memory Allocated: 3.5334653854370117  GigaBytes
Max Memory Allocated: 3.569517135620117  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9569091796875 GB
    Memory Allocated: 3.5334653854370117  GigaBytes
Max Memory Allocated: 3.569517135620117  GigaBytes

 h.shape torch.Size([1, 322583, 100]), torch.Size([1, 322583, 100])
----------------------------------------3
 Nvidia-smi: 11.1990966796875 GB
    Memory Allocated: 3.7756528854370117  GigaBytes
Max Memory Allocated: 3.7756528854370117  GigaBytes

