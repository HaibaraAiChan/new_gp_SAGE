main start at this time 1661484766.2006826
-----------------------------------------before load data 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 6.2322998046875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22586464881896973
global_2_local spend time (sec) 0.379472017288208

----------------------------  graph partition start---------------------
REG start----................................
Convert a graph into a bidirected graph: 3.250 seconds
Metis partitioning: 11.567 seconds
Split the graph: 6.503 seconds
Construct subgraphs: 0.049 seconds
98922
97649
REG metis partition end ----................................
the time spent:  30.735554933547974
REG construction  time spent:  9.34338903427124
pure dgl.metis_partition the time spent:  21.392165899276733
total k batches seeds list generation spend  31.415173530578613
after graph partition
graph partition algorithm spend time 32.20616555213928

partition_len_list
[620441, 662466]
REG selection method  spend 32.74487042427063
check_connections_block*********************************
time for parepare 1: 0.21971726417541504
local_output_nid generation: 0.012950897216796875
local_in_edges_tensor generation: 0.029354572296142578

&&&&&&&&&&&&&&& before remove duplicate length: 2397756
remove duplicated spend time : 0.5669209957122803

&&&&&&&&&&&&&&& after remove duplicate length: 616278

mini_batch_src_global generation: 0.04075479507446289
r_  generation: 0.38733410835266113

local_output_nid generation: 0.014619112014770508
local_in_edges_tensor generation: 0.047037363052368164

&&&&&&&&&&&&&&& before remove duplicate length: 2366123
remove duplicated spend time : 0.6120529174804688

&&&&&&&&&&&&&&& after remove duplicate length: 655492

mini_batch_src_global generation: 0.06962919235229492
r_  generation: 0.4740419387817383


The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7455642223358154
gen group dst list time:  0.051676034927368164
check_connections_block*********************************
time for parepare 1: 0.3620753288269043
local_output_nid generation: 0.09938168525695801
local_in_edges_tensor generation: 0.23082780838012695

&&&&&&&&&&&&&&& before remove duplicate length: 5978043
remove duplicated spend time : 1.592581033706665

&&&&&&&&&&&&&&& after remove duplicate length: 1067901

mini_batch_src_global generation: 0.08329105377197266
r_  generation: 1.0417993068695068

local_output_nid generation: 0.14451217651367188
local_in_edges_tensor generation: 0.21565937995910645

&&&&&&&&&&&&&&& before remove duplicate length: 6493308
remove duplicated spend time : 1.8550450801849365

&&&&&&&&&&&&&&& after remove duplicate length: 1111795

mini_batch_src_global generation: 0.12315702438354492
r_  generation: 1.1953511238098145


-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0799560546875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.4959716796875 GB
    Memory Allocated: 0.4173870086669922  GigaBytes
Max Memory Allocated: 0.4173870086669922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.4959716796875 GB
    Memory Allocated: 0.4181241989135742  GigaBytes
Max Memory Allocated: 0.4181241989135742  GigaBytes

first layer input nodes number: 1113587
first layer output nodes number: 620441
edges number: 5978043
----------------------------------------before model layer 0
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.49344968795776367  GigaBytes
Max Memory Allocated: 0.5157198905944824  GigaBytes

torch.Size([1113587, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.49344968795776367  GigaBytes
Max Memory Allocated: 0.5157198905944824  GigaBytes

m.shape torch.Size([2108, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.2049560546875 GB
    Memory Allocated: 2.7842702865600586  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2049560546875 GB
    Memory Allocated: 2.7842702865600586  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

 h.shape torch.Size([1, 2108, 100]), torch.Size([1, 2108, 100])
----------------------------------------3
 Nvidia-smi: 10.2069091796875 GB
    Memory Allocated: 2.7858409881591797  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.7995710372924805  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

rst.shape  torch.Size([1, 2108, 100])
m.shape torch.Size([3480, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.8013787269592285  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.8013787269592285  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

 h.shape torch.Size([1, 3480, 100]), torch.Size([1, 3480, 100])
----------------------------------------3
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.8045654296875  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.844149589538574  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

rst.shape  torch.Size([1, 3480, 100])
m.shape torch.Size([4419, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.847792148590088  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.847792148590088  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

 h.shape torch.Size([1, 4419, 100]), torch.Size([1, 4419, 100])
----------------------------------------3
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 2.8515782356262207  GigaBytes
Max Memory Allocated: 2.879410743713379  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2537841796875 GB
    Memory Allocated: 2.925084114074707  GigaBytes
Max Memory Allocated: 2.930023193359375  GigaBytes

rst.shape  torch.Size([1, 4419, 100])
m.shape torch.Size([5850, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.2733154296875 GB
    Memory Allocated: 2.932155132293701  GigaBytes
Max Memory Allocated: 2.9324169158935547  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2733154296875 GB
    Memory Allocated: 2.932155132293701  GigaBytes
Max Memory Allocated: 2.9324169158935547  GigaBytes

 h.shape torch.Size([1, 5850, 100]), torch.Size([1, 5850, 100])
----------------------------------------3
 Nvidia-smi: 10.2733154296875 GB
    Memory Allocated: 2.936514377593994  GigaBytes
Max Memory Allocated: 2.936514377593994  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 3.0629210472106934  GigaBytes
Max Memory Allocated: 3.071638584136963  GigaBytes

rst.shape  torch.Size([1, 5850, 100])
m.shape torch.Size([6946, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 3.0736794471740723  GigaBytes
Max Memory Allocated: 3.074068069458008  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 3.0736794471740723  GigaBytes
Max Memory Allocated: 3.074068069458008  GigaBytes

 h.shape torch.Size([1, 6946, 100]), torch.Size([1, 6946, 100])
----------------------------------------3
 Nvidia-smi: 10.4295654296875 GB
    Memory Allocated: 3.078855037689209  GigaBytes
Max Memory Allocated: 3.078855037689209  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6600341796875 GB
    Memory Allocated: 3.265631675720215  GigaBytes
Max Memory Allocated: 3.2785696983337402  GigaBytes

rst.shape  torch.Size([1, 6946, 100])
m.shape torch.Size([7517, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.6776123046875 GB
    Memory Allocated: 3.2806220054626465  GigaBytes
Max Memory Allocated: 3.2811264991760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6776123046875 GB
    Memory Allocated: 3.2806220054626465  GigaBytes
Max Memory Allocated: 3.2811264991760254  GigaBytes

 h.shape torch.Size([1, 7517, 100]), torch.Size([1, 7517, 100])
----------------------------------------3
 Nvidia-smi: 10.6776123046875 GB
    Memory Allocated: 3.2862229347229004  GigaBytes
Max Memory Allocated: 3.2862229347229004  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9373779296875 GB
    Memory Allocated: 3.5350046157836914  GigaBytes
Max Memory Allocated: 3.5525827407836914  GigaBytes

rst.shape  torch.Size([1, 7517, 100])
m.shape torch.Size([8010, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.9588623046875 GB
    Memory Allocated: 3.5536885261535645  GigaBytes
Max Memory Allocated: 3.5543160438537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9588623046875 GB
    Memory Allocated: 3.5536885261535645  GigaBytes
Max Memory Allocated: 3.5543160438537598  GigaBytes

 h.shape torch.Size([1, 8010, 100]), torch.Size([1, 8010, 100])
----------------------------------------3
 Nvidia-smi: 10.9588623046875 GB
    Memory Allocated: 3.5596566200256348  GigaBytes
Max Memory Allocated: 3.5596566200256348  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3084716796875 GB
    Memory Allocated: 3.8580613136291504  GigaBytes
Max Memory Allocated: 3.8795456886291504  GigaBytes

rst.shape  torch.Size([1, 8010, 100])
m.shape torch.Size([8240, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.3338623046875 GB
    Memory Allocated: 3.8804678916931152  GigaBytes
Max Memory Allocated: 3.881204605102539  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3338623046875 GB
    Memory Allocated: 3.8804678916931152  GigaBytes
Max Memory Allocated: 3.881204605102539  GigaBytes

 h.shape torch.Size([1, 8240, 100]), torch.Size([1, 8240, 100])
----------------------------------------3
 Nvidia-smi: 11.3338623046875 GB
    Memory Allocated: 3.8866076469421387  GigaBytes
Max Memory Allocated: 3.8866076469421387  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7283935546875 GB
    Memory Allocated: 4.236550807952881  GigaBytes
Max Memory Allocated: 4.261941432952881  GigaBytes

rst.shape  torch.Size([1, 8240, 100])
m.shape torch.Size([8214, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.7576904296875 GB
    Memory Allocated: 4.261020660400391  GigaBytes
Max Memory Allocated: 4.261941432952881  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7576904296875 GB
    Memory Allocated: 4.261020660400391  GigaBytes
Max Memory Allocated: 4.261941432952881  GigaBytes

 h.shape torch.Size([1, 8214, 100]), torch.Size([1, 8214, 100])
----------------------------------------3
 Nvidia-smi: 11.7576904296875 GB
    Memory Allocated: 4.267156600952148  GigaBytes
Max Memory Allocated: 4.267156600952148  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1893310546875 GB
    Memory Allocated: 4.659752368927002  GigaBytes
Max Memory Allocated: 4.687292098999023  GigaBytes

rst.shape  torch.Size([1, 8214, 100])
m.shape torch.Size([565657, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 6.764113903045654  GigaBytes
Max Memory Allocated: 6.828567028045654  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 6.764113903045654  GigaBytes
Max Memory Allocated: 6.828567028045654  GigaBytes

 h.shape torch.Size([1, 565657, 100]), torch.Size([1, 565657, 100])
----------------------------------------3
 Nvidia-smi: 14.8260498046875 GB
    Memory Allocated: 7.185988903045654  GigaBytes
Max Memory Allocated: 7.185988903045654  GigaBytes

